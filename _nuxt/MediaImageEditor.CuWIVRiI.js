import{J as kx,P as Cx,_ as Tx}from"./entry.nxeMeOXT.js";import{f as Mx,d as Px,a8 as Rx,a4 as Ix,a6 as Ex,D as im,aa as Ax,u as G1,L as Lx,a0 as zx,Y as Fx}from"./swiper-vue.Dnu8qG6n.js";/*!
 * Pintura v8.73.2 - Test version
 * (c) 2018-2024 PQINA Inc. - All Rights Reserved
 * License: https://pqina.nl/pintura/license/
 * 
 * This version of Pintura is for testing purposes only.
 * Visit https://pqina.nl/pintura/ to obtain a commercial license.
 */const Dx=[{value:65504,name:"jfif"},{value:65498,name:"sos"},{value:65505,subvalue:17784,name:"exif"},{value:65505,subvalue:26740,name:"xmp"},{value:65506,subvalue:19792,name:"mpf"}];var Df=t=>{if(t.getUint16(0)!==65496)return;const e=t.byteLength;let i,n=2,r;for(;n<e&&t.getUint8(n)===255;){i=t.getUint16(n);const o=Dx.find(a=>a.value===i&&(!a.subvalue||a.subvalue===t.getUint16(n+2+2)));if(o){const{name:a}=o;r||(r={}),r[a]||(r[a]={offset:n,size:t.getUint16(n+2)})}if(i===65498)break;n+=2+t.getUint16(n+2)}return r},rh=(t,e,i)=>{if(!t)return;const n=new DataView(t),r=Df(n);if(!r||!r.exif)return;const o=((a,s)=>{if(a.getUint16(s)!==65505)return;const l=a.getUint16(s+2);if(s+=4,a.getUint32(s)!==1165519206)return;s+=6;const c=a.getUint16(s);if(c!==18761&&c!==19789)return;const d=c===18761;if(s+=2,a.getUint16(s,d)!==42)return;s+=a.getUint32(s+2,d);const u=p=>{const h=[];let g=s;const m=Math.min(a.byteLength,s+l-16);for(;g<m;g+=12){const f=g;a.getUint16(f,d)===p&&h.push(f)}return h};return{read:p=>{const h=u(p);if(h.length)return a.getUint16(h[0]+8,d)},write:(p,h)=>{const g=u(p);return!!g.length&&(g.forEach(m=>a.setUint16(m+8,h,d)),!0)}}})(n,r.exif.offset);return o?i===void 0?o.read(e):o.write(e,i):void 0},oh=t=>window.__pqina_webapi__?window.__pqina_webapi__[t]:window[t],$e=(...t)=>{};const Bx={ArrayBuffer:"readAsArrayBuffer"};var Bf=async(t,e=[0,t.size],i)=>await((n,r=$e,o={})=>new Promise((a,s)=>{const{dataFormat:l=Bx.ArrayBuffer}=o,c=new(oh("FileReader"));c.onload=()=>a(c.result),c.onerror=()=>s(c.error),c.onprogress=r,c[l](n)}))(t.slice(...e),i),Ox=async(t,e)=>{const i=await Bf(t,[0,262144],e);return rh(i,274)||1};let Z1=null;var Lr=()=>(Z1===null&&(Z1=typeof window<"u"&&window.document!==void 0),Z1);let Pd=null;var mu=()=>new Promise(t=>{if(Pd===null){const e="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEASABIAAD/4QA6RXhpZgAATU0AKgAAAAgAAwESAAMAAAABAAYAAAEoAAMAAAABAAIAAAITAAMAAAABAAEAAAAAAAD/2wBDAP//////////////////////////////////////////////////////////////////////////////////////wAALCAABAAIBASIA/8QAJgABAAAAAAAAAAAAAAAAAAAAAxABAAAAAAAAAAAAAAAAAAAAAP/aAAgBAQAAPwBH/9k=";let i=Lr()?new Image:{};return i.onload=()=>{Pd=i.naturalWidth===1,i=void 0,t(Pd)},void(i.src=e)}return t(Pd)}),zc=t=>t.getContext("2d").getImageData(0,0,t.width,t.height),ln=(t,e,i=[])=>{const n=document.createElement(t),r=Object.getOwnPropertyDescriptors(n.__proto__);for(const o in e)o==="style"?n.style.cssText=e[o]:r[o]&&r[o].set||/textContent|innerHTML/.test(o)||typeof e[o]=="function"?n[o]=e[o]:n.setAttribute(o,e[o]);return i.forEach(o=>n.appendChild(o)),n};const Wx={1:()=>[1,0,0,1,0,0],2:t=>[-1,0,0,1,t,0],3:(t,e)=>[-1,0,0,-1,t,e],4:(t,e)=>[1,0,0,-1,0,e],5:()=>[0,1,1,0,0,0],6:(t,e)=>[0,1,-1,0,e,0],7:(t,e)=>[0,-1,-1,0,e,t],8:t=>[0,-1,1,0,0,t]};var Jn=t=>{t.width=1,t.height=1;const e=t.getContext("2d");e&&e.clearRect(0,0,1,1)},Il=t=>"data"in t,ah=t=>Lr()?RegExp(t).test(window.navigator.userAgent):void 0;let X1=null;var $u=()=>(X1===null&&(X1=ah(/Android/)),X1),Of=(t,e)=>{const i=ln("canvas",{width:t.width,height:t.height});return i.getContext("2d",e).drawImage(t,0,0),i},Bl=async(t,e=1)=>{const i=await mu(),[n,r]=i||e<5?[t.width,t.height]:[t.height,t.width],o=ln("canvas",{width:n,height:r}),a=o.getContext("2d",{willReadFrequently:!0});if(Il(t)&&!i&&e>1){const s=ln("canvas",{width:t.width,height:t.height});s.getContext("2d",{willReadFrequently:!0}).putImageData(t,0,0),t=s}if(!i&&e>1&&a.transform.apply(a,((s,l,c=-1)=>(c===-1&&(c=1),Wx[c](s,l)))(t.width,t.height,e)),Il(t)){if(a.putImageData(t,0,0),$u())return Of(o)}else a.drawImage(t,0,0);return t instanceof HTMLCanvasElement&&Jn(t),o},Wf=async(t,e=1)=>e===1||await mu()?t:zc(await Bl(t,e)),nl=t=>typeof t=="object";const nm=t=>t instanceof HTMLElement?t:nl(t)?_f(t):t,_f=t=>{let e;return Array.isArray(t)?(e=[],t.forEach((i,n)=>{e[n]=nm(i)})):(e={},Object.keys(t).forEach(i=>{const n=t[i];e[i]=nm(n)})),e};var Oe=t=>typeof t=="string",tn=t=>typeof t=="function",_x=(t,e)=>new Promise((i,n)=>{const r=()=>i(((o,{width:a,height:s,canvasMemoryLimit:l,contextOptions:c})=>{let d=a||o.naturalWidth,u=s||o.naturalHeight;d||u||(d=300,u=150);const p=d*u;if(l&&p>l){const g=Math.sqrt(l)/Math.sqrt(p);d=Math.floor(d*g),u=Math.floor(u*g)}const h=ln("canvas");return h.width=d,h.height=u,h.getContext("2d",c).drawImage(o,0,0,d,u),h})(t,e));t.complete&&t.width?r():(t.onload=r,t.onerror=()=>n(new Error("Failed to load image")))}),Vf=()=>"createImageBitmap"in window,Nf=t=>/svg/.test(t.type),ra=()=>Math.random().toString(36).substring(2,9);const Y1=new Map;var Fc=(t,e,i)=>new Promise((n,r)=>{const o=t.toString();let a=Y1.get(o);if(!a){const l=(p=>`function () {self.onmessage = function (message) {(${p.toString()}).apply(null, message.data.content.concat([function (err, response) {
    response = response || {};
    const transfer = 'data' in response ? [response.data.buffer] : 'width' in response ? [response] : [];
    return self.postMessage({ id: message.data.id, content: response, error: err }, transfer);
}]))}}`)(t),c=URL.createObjectURL((p=>new Blob(["(",typeof p=="function"?p.toString():p,")()"],{type:"application/javascript"}))(l)),d=new Map,u=new Worker(c);a={url:c,worker:u,messages:d,terminationTimeout:void 0,terminate:()=>{clearTimeout(a.terminationTimeout),a.worker.terminate(),URL.revokeObjectURL(c),Y1.delete(o)}},u.onmessage=function(p){const{id:h,content:g,error:m}=p.data;if(clearTimeout(a.terminationTimeout),a.terminationTimeout=setTimeout(()=>{d.size>0||a.terminate()},500),!d.has(h))return;const f=d.get(h);d.delete(h),m!=null?f.reject(m):f.resolve(g)},Y1.set(o,a)}const s=ra();a.messages.set(s,{resolve:n,reject:r}),a.worker.postMessage({id:s,content:e},i)});let q1=null;var va=()=>(q1===null&&(q1=ah(/Firefox/)),q1);const rm=async(t,e)=>{const i=await(async(r,o)=>{const a=ln("img",{src:URL.createObjectURL(r)}),s=await _x(a,o);return URL.revokeObjectURL(a.src),s})(t,{canvasMemoryLimit:e,contextOptions:{willReadFrequently:!0}}),n=zc(i);return Jn(i),n};var Hf=async(t,e)=>{if($u()&&!va())return await rm(t,e);let i;if(Vf()&&!Nf(t)&&"OffscreenCanvas"in window)try{i=await Fc((n,r,o)=>{createImageBitmap(n).then(a=>{let s=a.width,l=a.height;const c=s*l;if(r&&c>r){const h=Math.sqrt(r)/Math.sqrt(c);s=Math.floor(s*h),l=Math.floor(l*h)}const d=new OffscreenCanvas(s,l),u=d.getContext("2d",{willReadFrequently:!0});u.drawImage(a,0,0,s,l);const p=u.getImageData(0,0,d.width,d.height);o(null,p)}).catch(a=>{o(a)})},[t,e])}catch{}return i&&i.width?i:await rm(t,e)},sh=(t,e,i)=>new Promise((n,r)=>{try{t.toBlob(o=>{if(!o)return r(new Error("Failed to create blob"));n(o)},e,i)}catch(o){r(o)}}),Vx=async(t,e,i)=>{const n=await Bl(t),r=await sh(n,e,i);return Jn(n),r};const Nx={matroska:"mkv"};var jf=t=>{const e=(t.match(/\/([a-z0-9]+)/)||[])[1];if(/^x/.test(e)){const[,i=""]=t.split("/x-");return Nx[i]}return e},Uf=t=>t.substr(0,t.lastIndexOf("."))||t;const Hx=/avif|bmp|gif|jpg|jpeg|jpe|jif|jfif|png|svg|tiff|webp/;var lh=t=>{return t&&(e=(i=t,i.split(".").pop()).toLowerCase(),Hx.test(e)?"image/"+(/jfif|jif|jpe|jpg/.test(e)?"jpeg":e==="svg"?"svg+xml":e):"");var e,i},kc=(t,e,i)=>{const n=new Date().getTime(),r=t.type.length&&!/null|text/.test(t.type),o=r?t.type:i,a=((s,l)=>{const c=lh(s);if(c===l)return s;const d=jf(l)||c;return`${Uf(s)}.${d}`})(e,o);try{return new(oh("File"))([t],a,{lastModified:n,type:r?t.type:o})}catch{const l=r?t.slice():t.slice(0,t.size,o);return l.lastModified=n,l.name=a,l}},Qo=(t,e)=>t/e,Xi=t=>t;const K1=Math.PI,Vo=Math.PI/2,ta=Vo/2;var Ra=t=>{const e=Math.abs(t)%Math.PI;return e>ta&&e<Math.PI-ta};const Ap={Top:"t",Right:"r",Bottom:"b",Left:"l",TopLeft:"tl",TopRight:"tr",BottomRight:"br",BottomLeft:"bl"},{Top:fs,Right:ys,Bottom:xs,Left:bs,TopLeft:oa,TopRight:aa,BottomRight:sa,BottomLeft:la}=Ap;var Cc={[fs]:[.5,0],[ys]:[1,.5],[xs]:[.5,1],[bs]:[0,.5],[oa]:[0,0],[aa]:[1,0],[sa]:[1,1],[la]:[0,1]},ni=(t,e=12)=>parseFloat(t.toFixed(e));const eu=(t,e,i)=>i+(t-i)*e,om=t=>({x:t.x+.5*t.width,y:t.y+.5*t.height,rx:.5*t.width,ry:.5*t.height}),Qi=()=>rt(0,0),rt=(t,e)=>({x:t,y:e}),am=t=>rt(t.pageX,t.pageY),_e=t=>rt(t.x,t.y),Tl=t=>(t.x=-t.x,t.y=-t.y,t),qr=(t,e,i=Qi())=>{const n=Math.cos(e),r=Math.sin(e),o=t.x-i.x,a=t.y-i.y;return t.x=i.x+n*o-r*a,t.y=i.y+r*o+n*a,t},ps=t=>Math.sqrt(t.x*t.x+t.y*t.y),ro=t=>{const e=Math.sqrt(t.x*t.x+t.y*t.y);return e===0?Qi():(t.x/=e,t.y/=e,t)},Rd=(t,e)=>Math.atan2(e.y-t.y,e.x-t.x),ds=(t,e)=>t.x===e.x&&t.y===e.y,Co=(t,e)=>(t.x=e(t.x),t.y=e(t.y),t),Fn=(t,e)=>(t.x+=e.x,t.y+=e.y,t),Dn=(t,e)=>(t.x-=e.x,t.y-=e.y,t),sm=(t,e)=>(t.x/=e,t.y/=e,t),Ar=(t,e)=>(t.x*=e,t.y*=e,t),Gd=(t,e)=>t.x*e.x+t.y*e.y,Zd=(t,e)=>t.x*e.y-t.y*e.x,Bo=(t,e=Qi())=>{const i=t.x-e.x,n=t.y-e.y;return i*i+n*n},ho=(t,e=Qi())=>Math.sqrt(Bo(t,e)),jx=(t,e,i)=>(t.x=eu(t.x,e,i.x),t.y=eu(t.y,e,i.y),t),Oo=t=>{let e=0,i=0;return t.forEach(n=>{e+=n.x,i+=n.y}),rt(e/t.length,i/t.length)},Ml=(t,e,i,n,r)=>(t.forEach(o=>{o.x=e?n-(o.x-n):o.x,o.y=i?r-(o.y-r):o.y}),t),tl=(t,e,i,n)=>{const r=Math.sin(e),o=Math.cos(e);return t.forEach(a=>{a.x-=i,a.y-=n;const s=a.x*o-a.y*r,l=a.x*r+a.y*o;a.x=i+s,a.y=n+l}),t},Ol=(t,e)=>({width:t,height:e}),no=t=>Ol(t.width,t.height),Ea=t=>Ol(t.width,t.height),el=t=>Ol(t.width,t.height),Gf=t=>Ol(t[0],t[1]),bc=t=>{return/img/i.test(t.nodeName)?Ol((e=t).naturalWidth,e.naturalHeight):Ea(t);var e},Vn=(t,e)=>Ol(t,e),Tc=(t,e,i=Xi)=>i(t.width)===i(e.width)&&i(t.height)===i(e.height),Id=(t,e)=>(t.width*=e,t.height*=e,t),El=t=>rt(.5*t.width,.5*t.height),Zf=(t,e)=>{const i=Math.abs(e),n=Math.abs(Math.cos(i)),r=Math.abs(Math.sin(i)),o=n*t.width+r*t.height,a=r*t.width+n*t.height;return t.width=o,t.height=a,t},iu=(t,e)=>t.width>=e.width&&t.height>=e.height,Ya=(t,e)=>(t.width=e(t.width),t.height=e(t.height),t),vs=(t,e)=>({start:t,end:e}),Xf=t=>vs(_e(t.start),_e(t.end)),ch=(t,e)=>{if(e===0)return t;const i=rt(t.start.x-t.end.x,t.start.y-t.end.y),n=ro(i),r=Ar(n,e);return t.start.x+=r.x,t.start.y+=r.y,t.end.x-=r.x,t.end.y-=r.y,t},Ux=[rt(-1,-1),rt(-1,1),rt(1,1),rt(1,-1)],ca=(t,e,i,n)=>({x:t,y:e,width:i,height:n}),Ci=t=>ca(t.x,t.y,t.width,t.height),hs=()=>ca(0,0,0,0),Hr=t=>ca(0,0,t.width,t.height),Gx=t=>ca(t[3],t[0],t[1]-t[3],t[2]-t[0]),ls=t=>ca(t.x||0,t.y||0,t.width||0,t.height||0),rr=t=>{let e=t[0].x,i=t[0].x,n=t[0].y,r=t[0].y;return t.forEach(o=>{e=Math.min(e,o.x),i=Math.max(i,o.x),n=Math.min(n,o.y),r=Math.max(r,o.y)}),ca(e,n,i-e,r-n)},J1=t=>In(t.x-t.rx,t.y-t.ry,2*t.rx,2*t.ry),lm=(t,e)=>ca(t.x-.5*e.width,t.y-.5*e.height,e.width,e.height),In=(t,e,i,n)=>ca(t,e,i,n),Ti=t=>rt(t.x+.5*t.width,t.y+.5*t.height),ea=(t,e)=>(t.x+=e.x,t.y+=e.y,t),Er=(t,e,i)=>(i=i||Ti(t),t.x=e*(t.x-i.x)+i.x,t.y=e*(t.y-i.y)+i.y,t.width=e*t.width,t.height=e*t.height,t),cm=(t,e,i,n)=>{const r=(n.x-t.x)/t.width,o=(n.y-t.y)/t.height;let a=Math.max(e.width,t.width),s=Math.max(e.height,t.height);return a=Math.min(i.width,a),s=Math.min(i.height,s),t.x=n.x-r*a,t.y=n.y-o*s,t.width=a,t.height=s,t},dm=(t,e)=>{const[i,n]=Cc[e],r=i*t.width,o=n*t.height;return rt(t.x+r,t.y+o)},ms=(t,e)=>(t.x*=e,t.y*=e,t.width*=e,t.height*=e,t),ia=(t,e,i=Xi)=>i(t.x)===i(e.x)&&i(t.y)===i(e.y)&&i(t.width)===i(e.width)&&i(t.height)===i(e.height),or=t=>Qo(t.width,t.height),Yf=(t,e,i,n,r)=>(t.x=e,t.y=i,t.width=n,t.height=r,t),gu=(t,e)=>(t.x=e.x,t.y=e.y,t.width=e.width,t.height=e.height,t),Sr=(t,e,i)=>(i||(i=Ti(t)),_o(t).map(n=>qr(n,e,i))),Xd=(t,e)=>ca(.5*t.width-.5*e.width,.5*t.height-.5*e.height,e.width,e.height),nu=(t,e)=>!(e.x<t.x)&&!(e.y<t.y)&&!(e.x>t.x+t.width)&&!(e.y>t.y+t.height),Ka=(t,e,i=Qi())=>{if(t.width===0||t.height===0)return hs();const n=or(t);e||(e=n);let r=t.width,o=t.height;return e>n?r=o*e:o=r/e,ca(i.x+.5*(t.width-r),i.y+.5*(t.height-o),r,o)},Jr=(t,e=or(t),i=Qi())=>{if(t.width===0||t.height===0)return hs();let n=t.width,r=n/e;return r>t.height&&(r=t.height,n=r*e),ca(i.x+.5*(t.width-n),i.y+.5*(t.height-r),n,r)},il=t=>[Math.min(t.y,t.y+t.height),Math.max(t.x,t.x+t.width),Math.max(t.y,t.y+t.height),Math.min(t.x,t.x+t.width)],_o=t=>[rt(t.x,t.y),rt(t.x+t.width,t.y),rt(t.x+t.width,t.y+t.height),rt(t.x,t.y+t.height)],Wo=(t,e)=>{if(t)return t.x=e(t.x),t.y=e(t.y),t.width=e(t.width),t.height=e(t.height),t},qf=(t,e,i=Ti(t))=>_o(t).map((n,r)=>{const o=Ux[r];return rt(eu(n.x,1+o.x*e.x,i.x),eu(n.y,1+o.y*e.y,i.y))}),Mc=t=>(t.x=0,t.y=0,t),um=t=>{const e=t[0],i=t[t.length-1];t=ds(e,i)?t:[...t,e];const n=e.x,r=e.y;let o,a,s,l=0,c=0,d=0,u=0;const p=t.length;for(;c<p;c++)o=t[c],a=t[c+1>p-1?0:c+1],s=(o.y-r)*(a.x-n)-(a.y-r)*(o.x-n),l+=s,d+=(o.x+a.x-2*n)*s,u+=(o.y+a.y-2*r)*s;return s=3*l,rt(n+d/s,r+u/s)},dh=(t,e)=>Kf(t.start,t.end,e.start,e.end),Kf=(t,e,i,n)=>{const r=(n.y-i.y)*(e.x-t.x)-(n.x-i.x)*(e.y-t.y);if(r===0)return;const o=((n.x-i.x)*(t.y-i.y)-(n.y-i.y)*(t.x-i.x))/r,a=((e.x-t.x)*(t.y-i.y)-(e.y-t.y)*(t.x-i.x))/r;return o<0||o>1||a<0||a>1?void 0:rt(t.x+o*(e.x-t.x),t.y+o*(e.y-t.y))},Jf=(t,e,{ignoreIdenticalLines:i=!1,breakOnIntersection:n=!1}={})=>{const r=e.length,o=[];for(let a=0;a<r-1;a++){if(i&&(ds(t.start,e[a])||ds(t.start,e[a+1])||ds(t.end,e[a])||ds(t.end,e[a+1])))continue;const s=Kf(t.start,t.end,e[a],e[a+1]);if(s){if(n)return[s];o.push(s)}}return o.length?o:void 0},Lp=(t,e)=>{let i=0,n=0,r=!1;const o=e.length;for(i=0,n=o-1;i<o;n=i++)e[i].y>t.y!=e[n].y>t.y&&t.x<(e[n].x-e[i].x)*(t.y-e[i].y)/(e[n].y-e[i].y)+e[i].x&&(r=!r);return r},Qf=t=>{const e=[];for(let i=0;i<t.length;i++){let n=i+1;n===t.length&&(n=0),e.push(vs(_e(t[i]),_e(t[n])))}return e},ty=(t,e=0)=>Qf(t).map(i=>ch(i,e)),ru=(t,e,i,n=0,r=!1,o=!1,a=12)=>{const s=[];for(let l=0;l<a;l++)s.push(rt(t.x+e*Math.cos(l*(2*Math.PI)/a),t.y+i*Math.sin(l*(2*Math.PI)/a)));return(r||o)&&Ml(s,r,o,t.x,t.y),n&&tl(s,n,t.x,t.y),s},uh=(t,e,i,n)=>{const r=rt(t.x-i.x,t.y-i.y),o=rt(n.x-i.x,n.y-i.y),a=Gd(o,o);let s=Gd(r,o)/a;s=s<0?0:s,s=s>1?1:s;const l=rt(o.x*s+i.x-t.x,o.y*s+i.y-t.y);return Gd(l,l)<=e*e},ey=(t,e,i)=>{const n=i.length;for(let r=0;r<n-1;r++)if(uh(t,e,i[r],i[r+1]))return!0;return!1},zp=(t,e,i)=>!!Lp(t,i)||!!ey(t,e,i)||uh(t,e,i[0],i[i.length-1]),Q1=(t,e,i,n,r)=>zp(t,e,Sr(i,n,r||Ti(i)));var Zx=(t,e)=>{const i=Hr(t),n=Ti(i),r=Sr(i,e,n);return Mc(rr(r))},Al=(t,e)=>t instanceof HTMLElement&&(!e||new RegExp(`^${e}$`,"i").test(t.nodeName)),Dc=t=>t instanceof File,pm=async(t,e,i)=>{const n=await sh(t,e,i);return kc(n,"canvas")},ph=t=>t.split("/").pop().split(/\?|\#/).shift();const Xx=Lr()&&Node.prototype.replaceChildren?(t,e)=>t.replaceChildren(e):(t,e)=>{for(;t.lastChild;)t.removeChild(t.lastChild);e!==void 0&&t.append(e)},Ed=Lr()&&ln("div",{class:"PinturaMeasure",style:"position:absolute;left:0;top:0;width:99999px;height:0;pointer-events:none;contain:strict;margin:0;padding:0;"});let hm;var hh=t=>(Xx(Ed,t),Ed.parentNode||document.body.append(Ed),clearTimeout(hm),hm=setTimeout(()=>{Ed.remove()},500),t);let tp=null;var Ia=()=>(tp===null&&(tp=Lr()&&/^((?!chrome|android).)*(safari|iphone|ipad)/i.test(navigator.userAgent)),tp),iy=t=>new Promise((e,i)=>{let n=!1;!t.parentNode&&Ia()&&(n=!0,t.style.cssText="position:absolute;visibility:hidden;pointer-events:none;left:0;top:0;width:0;height:0;",hh(t));const r=()=>{const a=t.naturalWidth,s=t.naturalHeight;a&&s&&(n&&t.remove(),clearInterval(o),e({width:a,height:s}))};t.onerror=a=>{clearInterval(o),i(a)};const o=setInterval(r,1);r()}),ny=t=>new Promise((e,i)=>{const n=()=>{e({width:t.videoWidth,height:t.videoHeight})};if(t.readyState>=1)return n();t.onloadedmetadata=n,t.onerror=()=>i(t.error)}),fu=t=>/^image/.test(t.type),mh=t=>new Promise(e=>{const i=Oe(t)?t:URL.createObjectURL(t),n=()=>{const o=new Image;o.src=i,e(o)};if(t instanceof Blob&&fu(t))return n();const r=document.createElement("video");r.preload="metadata",r.onloadedmetadata=()=>e(r),r.onerror=n,r.src=i}),ou=t=>t.nodeName==="VIDEO",ry=async t=>{let e,i;e=t.src?t:await mh(t);try{i=ou(e)?await ny(e):await iy(e)}finally{Dc(t)&&URL.revokeObjectURL(e.src)}return i},Yx=async t=>{const e=await ry(t),i=await(o=>new Promise((a,s)=>{if(o.complete)return a(o);o.onload=()=>a(o),o.onerror=()=>s(new Error("Failed to load image"))}))(t),n=ln("canvas",e);n.getContext("2d",{willReadFrequently:!0}).drawImage(i,0,0);const r=await sh(n);return kc(r,ph(i.src))},Sl=(t=0,e=!0)=>new(oh("ProgressEvent"))("progress",{loaded:100*t,total:100,lengthComputable:e}),mm=(t,e,i=n=>n)=>t.getAllResponseHeaders().indexOf(e)>=0?i(t.getResponseHeader(e)):void 0,qx=t=>{if(!t)return null;const e=t.split(/filename=|filename\*=.+''/).splice(1).map(i=>i.trim().replace(/^["']|[;"']{0,2}$/g,"")).filter(i=>i.length);return e.length?decodeURI(e[e.length-1]):null};const Kx="URL_REQUEST";class vc extends Error{constructor(e,i,n){super(e),this.name="EditorError",this.code=i,this.metadata=n}}var oy=(t,e)=>{const{headers:i={},credentials:n}=e||{};Object.entries(i).forEach(([r,o])=>t.setRequestHeader(r,o)),n&&(t.withCredentials=n!=="omit")},Jx=(t,e,i)=>/^data:/.test(t)?(async(n,r="data-uri",o=$e)=>{o(Sl(0));const a=await fetch(n);o(Sl(.33));const s=await a.blob();let l;fu(s)||(l="image/"+(n.includes(",/9j/")?"jpeg":"png")),o(Sl(.66));const c=kc(s,r,l);return o(Sl(1)),c})(t,void 0,e):((n,r,o)=>new Promise((a,s)=>{const l=()=>s(new vc("Error fetching image",Kx,c)),c=new XMLHttpRequest;c.onprogress=r,c.onerror=l,c.onload=()=>{if(!c.response||c.status>=300||c.status<200)return l();const u=mm(c,"Content-Type"),p=mm(c,"Content-Disposition",qx)||ph(n);a(kc(c.response,p,u||lh(p)))};const{willRequest:d}=o;Promise.resolve(d&&d(n,{resourceType:"image"})).then(u=>{if(u===!1)return s("Image load rejected");c.open("GET",n),oy(c,u),c.responseType="blob",c.send()}).catch(console.error)}))(t,e,i),$h=t=>t instanceof Blob&&!(t instanceof File),ay=t=>"close"in t,Qx=async(t,e,i)=>{if(Dc(t)||$h(t))return t;if(Oe(t))return await Jx(t,e,i);if(Al(t,"canvas"))return await pm(t);if(Al(t,"img"))return await Yx(t);if(Il(t)||ay(t))return await pm(await Bl(t));throw new vc("Invalid image source","invalid-image-source")};let ep=null;var yu=()=>(ep===null&&(ep=Lr()&&/^mac/i.test(navigator.platform)),ep);let ip=null;var ba=()=>(ip===null&&(ip=Lr()&&(ah(/iPhone|iPad|iPod/)||yu()&&navigator.maxTouchPoints>=1)),ip),tb=async(t,e=1)=>await mu()||ba()||e<5?t:Vn(t.height,t.width),sy=t=>/jpeg/.test(t.type),eb=t=>{return typeof(e=t)!="object"||e.constructor!=Object?t:JSON.stringify(t);var e},gh=(t,e=0,i)=>(e===0||(t.translate(i.x,i.y),t.rotate(e),t.translate(-i.x,-i.y)),t),ly=(t,e,i)=>(t.scale(e,i),t),ib=async(t,e={})=>{const{flipX:i,flipY:n,rotation:r,crop:o}=e,a=Ea(t),s=i||n,l=!!r,c=o&&(o.x||o.y||o.width||o.height),d=c&&ia(o,Hr(a)),u=c&&!d;if(!s&&!l&&!u)return t;let p,h=ln("canvas",{width:t.width,height:t.height});if(h.getContext("2d",{willReadFrequently:!0}).putImageData(t,0,0),s){const g=ln("canvas",{width:h.width,height:h.height}).getContext("2d",{willReadFrequently:!0});ly(g,i?-1:1,n?-1:1),g.drawImage(h,i?-h.width:0,n?-h.height:0),g.restore(),Jn(h),h=g.canvas}if(l){const g=Ya(el(rr(Sr(ls(h),r))),Math.floor),m=ln("canvas",{width:o.width,height:o.height}).getContext("2d",{willReadFrequently:!0});((f,x,k)=>{f.translate(x,k)})(m,-o.x,-o.y),gh(m,r,El(g)),m.drawImage(h,.5*(g.width-h.width),.5*(g.height-h.height)),m.restore(),Jn(h),h=m.canvas}else if(u)return p=h.getContext("2d",{willReadFrequently:!0}).getImageData(o.x,o.y,o.width,o.height),Jn(h),p;return p=h.getContext("2d",{willReadFrequently:!0}).getImageData(0,0,h.width,h.height),Jn(h),p},nb=(t,e)=>{const{imageData:i,width:n,height:r}=t,o=i.width,a=i.height,s=Math.round(n),l=Math.round(r),c=i.data,d=new Uint8ClampedArray(s*l*4),u=o/s,p=a/l,h=Math.ceil(.5*u),g=Math.ceil(.5*p);for(let m=0;m<l;m++)for(let f=0;f<s;f++){const x=4*(f+m*s);let k=0,v=0,C=0,P=0,I=0,O=0,T=0;const L=(m+.5)*p;for(let F=Math.floor(m*p);F<(m+1)*p;F++){const B=Math.abs(L-(F+.5))/g,y=(f+.5)*u,V=B*B;for(let J=Math.floor(f*u);J<(f+1)*u;J++){let S=Math.abs(y-(J+.5))/h;const H=Math.sqrt(V+S*S);if(H<-1||H>1||(k=2*H*H*H-3*H*H+1,k<=0))continue;S=4*(J+F*o);const K=c[S+3];T+=k*K,C+=k,K<255&&(k=k*K/250),P+=k*c[S],I+=k*c[S+1],O+=k*c[S+2],v+=k}}d[x]=P/v,d[x+1]=I/v,d[x+2]=O/v,d[x+3]=T/C}e(null,{data:d,width:s,height:l})},fh=t=>{if(t instanceof ImageData)return t;let e;try{e=new ImageData(t.width,t.height)}catch{e=ln("canvas").getContext("2d").createImageData(t.width,t.height)}return e.data.set(t.data),e},rb=async(t,e={},i)=>{const{width:n,height:r,fit:o,upscale:a}=e;if(!n&&!r)return t;let s=n,l=r;if(n?r||(l=n):s=r,o!=="force"){const c=s/t.width,d=l/t.height;let u=1;if(o==="cover"?u=Math.max(c,d):o==="contain"&&(u=Math.min(c,d)),u>1&&a===!1)return t;s=Math.round(t.width*u),l=Math.round(t.height*u)}return s=Math.max(s,1),l=Math.max(l,1),t.width===s&&t.height===l?t:i?i(t,s,l):(t=await Fc(nb,[{imageData:t,width:s,height:l}],[t.data.buffer]),fh(t))},ob=(t,e)=>{const{imageData:i,matrix:n}=t;if(!n)return e(null,i);const r=new Uint8ClampedArray(i.width*i.height*4),o=i.data,a=o.length,s=n[0],l=n[1],c=n[2],d=n[3],u=n[4],p=n[5],h=n[6],g=n[7],m=n[8],f=n[9],x=n[10],k=n[11],v=n[12],C=n[13],P=n[14],I=n[15],O=n[16],T=n[17],L=n[18],F=n[19];let B=0,y=0,V=0,J=0,S=0,H=0,K=0,ut=0,lt=0,N=0,ft=0,$t=0;for(;B<a;B+=4)y=o[B]/255,V=o[B+1]/255,J=o[B+2]/255,S=o[B+3]/255,H=y*s+V*l+J*c+S*d+u,K=y*p+V*h+J*g+S*m+f,ut=y*x+V*k+J*v+S*C+P,lt=y*I+V*O+J*T+S*L+F,N=Math.max(0,H*lt)+(1-lt),ft=Math.max(0,K*lt)+(1-lt),$t=Math.max(0,ut*lt)+(1-lt),r[B]=255*Math.max(0,Math.min(1,N)),r[B+1]=255*Math.max(0,Math.min(1,ft)),r[B+2]=255*Math.max(0,Math.min(1,$t)),r[B+3]=255*S;e(null,{data:r,width:i.width,height:i.height})},cy=(t,e)=>{const{imageData:i,matrix:n}=t;if(!n)return e(null,i);let r=n.reduce((T,L)=>T+L);r=r<=0?1:r;const o=i.width,a=i.height,s=i.data;let l=0,c=0,d=0;const u=Math.round(Math.sqrt(n.length)),p=Math.floor(u/2);let h=0,g=0,m=0,f=0,x=0,k=0,v=0,C=0,P=0,I=0;const O=new Uint8ClampedArray(o*a*4);for(d=0;d<a;d++)for(c=0;c<o;c++){for(h=0,g=0,m=0,f=0,k=0;k<u;k++)for(x=0;x<u;x++)v=d+k-p,C=c+x-p,v<0&&(v=a-1),v>=a&&(v=0),C<0&&(C=o-1),C>=o&&(C=0),P=4*(v*o+C),I=n[k*u+x],h+=s[P]*I,g+=s[P+1]*I,m+=s[P+2]*I,f+=s[P+3]*I;O[l]=h/r,O[l+1]=g/r,O[l+2]=m/r,O[l+3]=f/r,l+=4}e(null,{data:O,width:o,height:a})},ab=(t,e)=>{let{imageData:i,strength:n}=t;if(!n)return e(null,i);const r=new Uint8ClampedArray(i.width*i.height*4),o=i.width,a=i.height,s=i.data,l=(V,J)=>(c=V-I,d=J-O,Math.sqrt(c*c+d*d));let c,d,u,p,h,g,m,f,x,k,v,C=0,P=0,I=.5*o,O=.5*a,T=l(0,0);for(n>0?(u=0,p=0,h=0):(n=Math.abs(n),u=1,p=1,h=1),P=0;P<a;P++)for(C=0;C<o;C++)L=4*(C+P*o),F=s,B=r,y=l(C,P)*n/T,g=F[L]/255,m=F[L+1]/255,f=F[L+2]/255,x=F[L+3]/255,k=1-y,v=k*x+y,B[L]=(k*x*g+y*u)/v*255,B[L+1]=(k*x*m+y*p)/v*255,B[L+2]=(k*x*f+y*h)/v*255,B[L+3]=255*v;var L,F,B,y;e(null,{data:r,width:i.width,height:i.height})},sb=(t,e)=>{const{imageData:i,level:n,monochrome:r=!1}=t;if(!n)return e(null,i);const o=new Uint8ClampedArray(i.width*i.height*4),a=i.data,s=a.length;let l,c,d,u=0;const p=()=>255*(2*Math.random()-1)*n,h=r?()=>{const g=p();return[g,g,g]}:()=>[p(),p(),p()];for(;u<s;u+=4)[l,c,d]=h(),o[u]=a[u]+l,o[u+1]=a[u+1]+c,o[u+2]=a[u+2]+d,o[u+3]=a[u+3];e(null,{data:o,width:i.width,height:i.height})},lb=(t,e)=>{const{imageData:i,level:n}=t;if(!n)return e(null,i);const r=new Uint8ClampedArray(i.width*i.height*4),o=i.data,a=o.length;let s,l,c,d=0;for(;d<a;d+=4)s=o[d]/255,l=o[d+1]/255,c=o[d+2]/255,r[d]=255*Math.pow(s,n),r[d+1]=255*Math.pow(l,n),r[d+2]=255*Math.pow(c,n),r[d+3]=o[d+3];e(null,{data:r,width:i.width,height:i.height})},cb=async(t,e={})=>{const{colorMatrix:i,convolutionMatrix:n,gamma:r,noise:o,vignette:a}=e,s=[];if(n&&s.push([cy,{matrix:n.clarity}]),r>0&&s.push([lb,{level:1/r}]),i&&!(d=>{const u=d.length;let p;const h=u>=20?6:u>=16?5:3;for(let g=0;g<u;g++)if(p=d[g],p===1&&g%h!=0||p!==0&&p!==1)return!1;return!0})(i)&&s.push([ob,{matrix:i}]),(o>0||o<0)&&s.push([sb,{level:o}]),(a>0||a<0)&&s.push([ab,{strength:a}]),!s.length)return t;const l=(d,u)=>`(err, imageData) => {
            (${d[u][0].toString()})(Object.assign({ imageData: imageData }, filterInstructions[${u}]), 
                ${d[u+1]?l(d,u+1):"done"})
        }`,c=`function (options, done) {
        const filterInstructions = options.filterInstructions;
        const imageData = options.imageData;
        (${l(s,0)})(null, imageData)
    }`;return t=await Fc(c,[{imageData:t,filterInstructions:s.map(d=>d[1])}],[t.data.buffer]),fh(t)},xi=t=>typeof t=="number",au=t=>Oe(t)&&t.match(/(?:[\u2700-\u27bf]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff]|[\u0023-\u0039]\ufe0f?\u20e3|\u3299|\u3297|\u303d|\u3030|\u24c2|\ud83c[\udd70-\udd71]|\ud83c[\udd7e-\udd7f]|\ud83c\udd8e|\ud83c[\udd91-\udd9a]|\ud83c[\udde6-\uddff]|\ud83c[\ude01-\ude02]|\ud83c\ude1a|\ud83c\ude2f|\ud83c[\ude32-\ude3a]|\ud83c[\ude50-\ude51]|\u203c|\u2049|[\u25aa-\u25ab]|\u25b6|\u25c0|[\u25fb-\u25fe]|\u00a9|\u00ae|\u2122|\u2139|\ud83c\udc04|[\u2600-\u26FF]|\u2b05|\u2b06|\u2b07|\u2b1b|\u2b1c|\u2b50|\u2b55|\u231a|\u231b|\u2328|\u23cf|[\u23e9-\u23f3]|[\u23f8-\u23fa]|\ud83c\udccf|\u2934|\u2935|[\u2190-\u21ff])/g)!==null,ze=(t,e)=>t.hasOwnProperty(e),En=t=>Array.isArray(t);let $m=64,np=102,gm=112,fm=!1;var dy=(t,e)=>(!fm&&Lr()&&(/^win/i.test(navigator.platform)&&(np=103),(ba()||yu())&&($m=63.5,np=110,gm=123),fm=!0),`<svg${e?` aria-label="${e}"`:""} width="128" height="128" viewBox="0 0 128 128" preserveAspectRatio="xMinYMin meet" xmlns="http://www.w3.org/2000/svg"><text x="${$m}" y="${np}" alignment-baseline="text-top" dominant-baseline="text-top" text-anchor="middle" font-size="${gm}px">${t}</text></svg>`),Ll=t=>t instanceof Blob,Vr=(t,e)=>t/e*100+"%",kr=t=>`rgba(${Math.round(255*t[0])}, ${Math.round(255*t[1])}, ${Math.round(255*t[2])}, ${xi(t[3])?t[3]:1})`,Yd=t=>Object.values(t).join("_");const uy=async(t,e=0)=>{const i=ln("canvas",{width:80,height:80}).getContext("2d");return await((n=0)=>new Promise(r=>{setTimeout(r,n)}))(e),i.drawImage(t,0,0,80,80),!((n=>!new Uint32Array(n.getImageData(0,0,n.canvas.width,n.canvas.height).data.buffer).some(r=>r!==0))(i)&&e<=256)||await uy(t,e+16)},ym=new Map;var db=t=>new Promise((e,i)=>{const n=new FileReader;n.onerror=()=>i(n.error),n.onload=()=>e(n.result),n.readAsDataURL(t)}),qa=()=>{let t=[];return{sub:(e,i)=>(t.push({event:e,callback:i}),()=>t=t.filter(n=>n.event!==e||n.callback!==i)),pub:(e,i)=>{t.filter(n=>n.event===e).forEach(n=>n.callback(i))}}};const Kr=32,yh=({color:t=[0,0,0],fontSize:e=16,fontFamily:i="sans-serif",fontVariant:n="normal",fontWeight:r="normal",fontStyle:o="normal",textAlign:a="left",letterSpacing:s="normal",lineHeight:l=20},c=1)=>`font-size:${e*c}px;font-style:${o};font-weight:${r};font-family:${i};font-variant:${n};line-height:${l*c}px;text-align:${a};letter-spacing:${xi(s)?s+"px":"normal"};color:${kr(t)};`,xh=(t,e,i=1)=>{const{width:n,height:r,disableNewline:o}=e,a=!n,s=o===!1?((d="")=>d.split(`
`).length)(t):void 0,l=a?"normal":"break-word",c=a&&!s?"nowrap":"pre-line";return`max-width:none;min-width:auto;width:${a?"auto":n*i+"px"};height:${r?r*i+"px":"auto"};margin-top:0;margin-bottom:0;padding-top:${(({fontSize:d=16,lineHeight:u=20}={})=>.5*Math.max(0,d-u))(e)*i}px;word-break:${l};word-wrap:normal;white-space:${c};`},xm=new Map,py=t=>{const e=[];for(const i of Array.from(t.childNodes))i.nodeType===Node.TEXT_NODE?e.push(ub(i)):e.push(...py(i));return e},hy="pointer-events:none;visibility:hidden;position:absolute;left:0;top:0;",ub=t=>{const e=t.nodeValue;if(!e)return[];const i=e.length,n=document.createRange();n.selectNodeContents(t);const r=[];for(let a=0;a<i;a++){n.setStart(t,0),n.setEnd(t,a+1);const s=n.getClientRects().length-1,l=e.charAt(a);r[s]?r[s]+=l:r.push(l)}const o=n.getClientRects();return r.map((a,s)=>({rect:o[s],text:a}))},bm=new Map,Jo=(t="",e)=>{const{width:i=0,height:n=0}=e;if(i&&n)return Vn(i,n);let{fontSize:r=16,fontFamily:o,lineHeight:a=20,fontWeight:s,fontStyle:l,fontVariant:c,letterSpacing:d}=e;const u=Yd({text:t,fontFamily:o,fontWeight:s,fontStyle:l,fontVariant:c,fontSize:r,letterSpacing:d,lineHeight:a,width:i});let p=bm.get(u);if(p)return p;let h=1;r>1e3&&va()&&(h=r/1e3,r=1e3,a/=h);const g=hh(ln("pre",{contenteditable:"true",spellcheck:"false",style:`${hy}${yh({...e,fontSize:r,lineHeight:a})};${xh(t,e)}"`,innerHTML:t})).getBoundingClientRect();return p=Ea(g),p.height+=Math.max(0,r-a),p=Ya(p,m=>m*h),i&&(p.width=i),bm.set(u,p),p},vm=new Map,pb=(t,e)=>new Promise((i,n)=>{let r=vm.get(t);r===void 0&&(r=((o,a)=>{const{sub:s,pub:l}=qa();let c,d;return Promise.resolve(a&&a(o,{resourceType:"stylesheet"})).then(u=>{if(u===!1)return d="requestPrevented",l("error",d);const{headers:p,credentials:h}=u||{};fetch(o,{headers:p,credentials:h}).then(g=>g.text()).then(g=>{c=g,l("load",c)}).catch(g=>{d=g,l("error",d)})}),{sub:(u,p)=>u==="load"&&c?p(c):u==="error"&&d?p(d):void s(u,p)}})(t,e),vm.set(t,r)),r.sub("load",i),r.sub("error",n)}),wm=async(t,e)=>{let i;try{i=await pb(t,e)}catch{return[]}const n=ln("style",{innerHTML:i,id:ra()});document.head.append(n);const r=Array.from(document.styleSheets).find(o=>o.ownerNode.id===n.id);return n.remove(),Array.from(r.cssRules)},xl=new Map,hb=async(t,e)=>{if(xl.has(t.href))return xl.get(t.href);let i;try{i=Array.from(t.cssRules);for(const n of(r=>r.filter(o=>o instanceof CSSImportRule))(i)){const r=n.href;if(xl.has(r)){const a=xl.get(r);i=[...i,...a];continue}const o=await wm(r,e);xl.set(r,o),i=[...i,...o]}}catch{const r=t.href;i=await wm(r,e),xl.set(r,i)}return(n=>n.filter(r=>r instanceof CSSFontFaceRule))(i)},my=(t,e)=>t.style.getPropertyValue(e),mb=(t,e)=>t.style?my(t,"font-family").replace(/^"|"$/g,"")==e:!1,$b=async(t,e)=>{const i=((n,r)=>{const o=[];for(const a of n)mb(a,r)&&o.push(a);return o})(await(async n=>{const r=Array.from(document.styleSheets).map(s=>hb(s,n)),o=await Promise.all(r),a=[];return o.forEach(s=>a.push(...s)),a})(e),t);return i.length?i.map(n=>{const r=n.parentStyleSheet.href&&new URL(n.parentStyleSheet.href),o=r?r.origin+(l=>l.pathname.split("/").slice(0,-1).join("/"))(r)+"/":"",a=n.style.getPropertyValue("src").match(/url\("?(.*?)"?\)/)[1],s=Array.from(n.style).filter(l=>l!="src").reduce((l,c)=>l+=c+":"+my(n,c)+";","");return[/^http/.test(a)?a:o+a,s]}):[]},Sm=new Map,km=new Map;var $y=async(t="",e)=>{if(!t.length)return;let{color:i,imageWidth:n=300,imageHeight:r=150,paddingTop:o=0,paddingRight:a=Kr,paddingBottom:s=0,paddingLeft:l=Kr,fontFamily:c,fontSize:d,pixelRatio:u=1,willRequest:p,outline:h,blur:g}=e,m=1,f="";d>1e3&&va()&&(m=d/1e3,f=`transform-origin:0 0;transform:scale(${m})`);const x=u/m,k=(n+l+a)*u,v=(r+s+o)*u,C=await(async(F,B)=>{if(Sm.get(F))return;let y=km.get(F);if(!y){const J=await $b(F,B);if(!J.length)return void Sm.set(F,!0);const S=[];for(const[H,K]of J){const ut=await fetch(H).then(ft=>ft.blob()),lt=!(V=ut.type)||/woff2/.test(V)?"woff2":/woff/.test(V)?"woff":/ttf|truetype/.test(V)?"truetype":/otf|opentype/.test(V)?"opentype":/svg/.test(V)?"svg":"woff2",N=await db(ut);S.push(`@font-face { src:url(${N}) format('${lt}');${K};font-display:block; }`)}y=S.join(""),km.set(F,y)}var V;return y})(c,p),P=t.replace(/%/g,"%25").replace(/#/g,"%23").replace(/&nbsp;/g," ").replace(/&(?!#\d{4};|[a-z]+;)/gi,"&amp;").replace(/<br>|\n/g,"<br/>"),I=`top:${o*x}px;right:${a*x}px;bottom:${s*x}px;left:${l*x}px`;let O=i,T="",L="";if(h||g){const F=kr(i);h&&(O=[0,0,0,0],T=`-webkit-text-stroke: ${2*h*x}px ${F}`),g&&(Ia()?L=`filter:blur(${g*x*.4}px)`:(O=[0,0,0,0],L=`text-shadow: 0 0 ${g*x}px ${F}`))}return((F,{safariCacheKey:B="*"}={})=>new Promise((y,V)=>{const J=new Image;J.onerror=()=>V(new Error("Failed to load SVG")),J.onload=()=>{if(!Ia()||!F.includes("@font-face")||ym.has(B))return y(J);uy(J).then(()=>{ym.set(B,!0),y(J)})},J.src="data:image/svg+xml,"+F}))(`<svg xmlns="http://www.w3.org/2000/svg" width="${k}" height="${v}" viewBox="0 0 ${k} ${v}"><foreignObject x="0" y="0" width="${k}" height="${v}"><div xmlns="http://www.w3.org/1999/xhtml">${C?`<style>${C}</style>`:""}<pre contenteditable="true" spellcheck="false" style="position:absolute;${I};${yh({...e,color:O,fontSize:d},x)};${xh(t,e,x)};${f};${T};${L}">${P}</pre></div></foreignObject></svg>`,{safariCacheKey:c})};const _n=t=>{const e={...t};return _f(e)},Cm=(t,e={})=>{const i=or(t);let n,r;const o=e.width||e.rx,a=e.height||e.ry;if(o&&a)return no(e);if(o||a){n=parseFloat(o||Number.MAX_SAFE_INTEGER),r=parseFloat(a||Number.MAX_SAFE_INTEGER);const s=Math.min(n,r);Oe(o)||Oe(a)?(n=s+"%",r=s*i+"%"):(n=s,r=s)}else n="10%",r=10*i+"%";return{[(e.width?"width":e.rx?"rx":void 0)||"width"]:n,[(e.width?"height":e.rx?"ry":void 0)||"height"]:r}},Tm=(t,e={})=>{return{width:void 0,height:void 0,...e,aspectRatio:1,backgroundImage:(i=dy(t),"data:image/svg+xml,"+i.replace("<","%3C").replace(">","%3E"))};var i},Mm=(t,e={})=>({backgroundColor:[0,0,0,0],...Kn(e)?{}:{width:void 0,height:void 0,aspectRatio:void 0},...e,backgroundImage:Oe(t)?t:Ll(t)?URL.createObjectURL(t):t}),Pm=(t,e)=>{let i;if(Oe(t)||Ll(t)){const n={...Cm(e),backgroundSize:"contain"};i=au(t)?Tm(t,n):Mm(t,n)}else if(t.src){const n=Cm(e,t.shape||t),r={...t.shape,...n};if(t.width&&t.height&&!ze(r,"aspectRatio")){const o=_p(n,"width",e),a=_p(n,"height",e);r.aspectRatio=Qo(o,a)}r.backgroundSize||t.shape||t.width&&t.height||(r.backgroundSize="contain"),i=au(t.src)?Tm(t.src,r):Mm(t.src,r)}else t.shape&&(i=_n(t.shape));return ze(i,"backgroundImage")&&(ze(i,"backgroundColor")||(i.backgroundColor=[0,0,0,0]),ze(i,"disableStyle")||(i.disableStyle=["cornerRadius","backgroundColor","strokeColor","strokeWidth"])),e?Un(i,e):i},Ga=t=>rt(t.x1,t.y1),Za=t=>rt(t.x2,t.y2),qn=t=>ze(t,"text"),su=t=>qn(t)&&!(xu(t)||ze(t,"width")),qd=t=>qn(t)&&(xu(t)||ze(t,"width")),ko=t=>!qn(t)&&gb(t),Kn=t=>ze(t,"rx"),nr=t=>ze(t,"x1"),Yn=t=>ze(t,"points"),Ua=t=>qn(t)&&t.isEditing,Ad=t=>!ze(t,"opacity")||t.opacity>0,cs=t=>t.isSelected,rp=t=>t.isEditing,So=t=>t._isDraft,Ks=t=>ze(t,"width")&&ze(t,"height"),gy=t=>{const e=ze(t,"right"),i=ze(t,"bottom");return e||i},xu=t=>(ze(t,"x")||ze(t,"left"))&&ze(t,"right")||(ze(t,"y")||ze(t,"top"))&&ze(t,"bottom"),gb=t=>Ks(t)||xu(t),Fp=t=>(t._isDraft=!0,t),Rm=t=>(t._isDraft=!1,t),Dp=(t,e)=>t.disableStyle!==!0&&(!En(t.disableStyle)||!e||!t.disableStyle.includes(e)),$a=t=>t.disableSelect!==!0,Im=t=>t.disableRemove!==!0,fb=t=>!t.disableFlip&&!So(t)&&!gy(t)&&(e=>ze(e,"backgroundImage")||ze(e,"text"))(t),bl=(t,e)=>!!qn(t)&&t.disableInput!==!0&&(tn(t.disableInput)?t.disableInput(e??t.text):e||!0),Gs=(t,e)=>t.disableTextLayout!==!0&&(!En(t.disableTextLayout)||!e||!t.disableTextLayout.includes(e)),Bp=t=>t.disableManipulate!==!0&&!So(t)&&!gy(t),mc=t=>Bp(t)&&t.disableMove!==!0,Op=t=>(delete t.left,delete t.right,delete t.top,delete t.bottom,t),Em=t=>(delete t.rotation,t),Am=t=>(t.strokeWidth=t.strokeWidth||1,t.strokeColor=t.strokeColor||[0,0,0],t),Lm=t=>(t.backgroundColor=t.backgroundColor?t.backgroundColor:t.strokeWidth||t.backgroundImage?void 0:[0,0,0],t),zm=t=>{let e=t.text;e=e.replace(/&(#[0-9]+|[a-z]+);/gi,(i,n)=>`___${n}___`),e=e.replace(/&/,"&amp;"),t.text=e.replace(/___(#[0-9]+|[a-z]+)___/gi,(i,n)=>`&${n};`)},yb=t=>{if(t.fontSize=t.fontSize||"4%",t.fontFamily=t.fontFamily||"sans-serif",t.fontWeight=t.fontWeight||"normal",t.fontStyle=t.fontStyle||"normal",t.fontVariant=t.fontVariant||"normal",t.lineHeight=t.lineHeight||"120%",t.color=t.color||[0,0,0],t.format=t.format==="html"?"html":"text",t.textShadow){const[e,i,n,r]=t.textShadow;t.textShadowX=e,t.textShadowY=i,t.textShadowBlur=n,t.textShadowColor=r,delete t.textShadow}if(t.textOutline){const[e,i]=t.textOutline;t.textOutlineWidth=e,t.textOutlineColor=i,delete t.textOutline}return t.format==="html"?zm(t):(e=>{zm(e);let i=e.text;i=i.replace(/</g,"&gt;"),i=i.replace(/>/g,"&lt;"),e.text=i})(t),su(t)?xb(t):bb(t)},xb=t=>(t.disableNewline!==!1&&(delete t.textAlign,t.text=t.text.replace(/\n/g," ")),Op(t)),bb=t=>(t.textAlign=t.textAlign||"left",t),fy=t=>((e=>{Oe(e.id)||(e.id=ra()),ze(e,"rotation")||(e.rotation=0),ze(e,"opacity")||(e.opacity=1),ze(e,"disableErase")||(e.disableErase=!0)})(t),qn(t)?yb(t):ko(t)?(e=>{e.cornerRadius=e.cornerRadius||0,e.strokeWidth=e.strokeWidth||0,e.strokeColor=e.strokeColor||[0,0,0],Lm(e)})(t):Yn(t)?(e=>{Am(e),Em(e),ze(e,"pathClose")||(e.disableResize=!0,ze(e,"disableMove")||(e.disableMove=!0)),Op(e)})(t):nr(t)?(e=>{Am(e),e.lineStart=e.lineStart||void 0,e.lineEnd=e.lineEnd||void 0,Em(e),Op(e)})(t):Kn(t)&&(e=>{e.strokeWidth=e.strokeWidth||0,e.strokeColor=e.strokeColor||[0,0,0],Lm(e)})(t),t),vb=t=>qn(t)?"text":ko(t)?"rectangle":Yn(t)?"path":nr(t)?"line":Kn(t)?"ellipse":void 0,lu=(t,e)=>parseFloat(t)/100*e,wb=new RegExp(/^x|left|right|^width|rx|fontSize|eraseRadius|feather|cornerRadius|strokeWidth|strokeDash/,"i"),Sb=new RegExp(/^y|top|bottom|^height|ry/,"i"),bh=(t,e,{width:i,height:n})=>{if(Array.isArray(e))return e.map(o=>(nl(o)&&yy(o,{width:i,height:n}),Oe(o)&&(o=bh(t,o,{width:i,height:n})),o));if(typeof e!="string"||!e.endsWith("%"))return e;const r=parseFloat(e)/100;return wb.test(t)?ni(i*r,6):Sb.test(t)?ni(n*r,6):e},kb=bh,Cb=["lineHeight","textOutlineWidth","textShadowX","textShadowY","textShadowBlur"],yy=(t,e)=>{Object.entries(t).map(([i,n])=>{t[i]=bh(i,n,e)}),t.text&&Cb.filter(i=>Oe(t[i])).forEach(i=>{var n,r;t[i]=(n=t[i],r=t.fontSize,Math.round(r*(parseFloat(n)/100)))})},Un=(t,e)=>(yy(t,e),vy(t,e),t),Wp=(t,e)=>{let i;return/^x|width|rx|fontSize|strokeWidth|cornerRadius/.test(t)?i=e.width:/^y|height|ry/.test(t)&&(i=e.height),i},_p=(t,e,i)=>Array.isArray(t[e])?t[e].map(n=>Object.entries(n).reduce((r,[o,a])=>(r[o]=Oe(a)?lu(a,Wp(o,i)):a,r),{})):Oe(t[e])?lu(t[e],Wp(e,i)):t[e],Pl=(t,e,i)=>e.reduce((n,r)=>{const o=_p(t,r,i);return n[r]=o,n},{}),ya=(t,e,i)=>(Object.keys(e).forEach(n=>((r,o,a,s)=>{if(!Oe(r[o]))return r[o]=a,r;const l=Wp(o,s);return r[o]=l===void 0?a:Vr(a,l),r})(t,n,e[n],i)),t),xy=(t,e)=>{const i=t.filter(n=>n.x<0||n.y<0||n.x1<0||n.y1<0).reduce((n,r)=>{const[o,a,s,l]=(c=>{const d=hs(),u=c.strokeWidth||0;if(ko(c))d.x=c.x-.5*u,d.y=c.y-.5*u,d.width=c.width+u,d.height=c.height+u;else if(nr(c)){const{x1:p,y1:h,x2:g,y2:m}=c,f=Math.abs(Math.min(p,g)),x=Math.abs(Math.max(p,g)),k=Math.abs(Math.min(h,m)),v=Math.abs(Math.min(h,m));d.x=f+.5*u,d.y=x+.5*u,d.width=x-f+u,d.height=v-k+u}else Kn(c)&&(d.x=c.x-c.rx+.5*u,d.y=c.y-c.ry+.5*u,d.width=2*c.rx+u,d.height=2*c.ry+u);return d&&ze(c,"rotation")&&Sr(d,c.rotation),il(d)})(r);return n.top=Math.min(o,n.top),n.left=Math.min(l,n.left),n.bottom=Math.max(s,n.bottom),n.right=Math.max(a,n.right),n},{top:0,right:0,bottom:0,left:0});return i.right>0&&(i.right-=e.width),i.bottom>0&&(i.bottom-=e.height),i},by=(t,e,i)=>{const n=_n(t);Un(n,e);const r=i(n);return Array.isArray(r)?r:[r]},vy=(t,e)=>{if(ze(t,"left")&&(t.x=t.left),ze(t,"right")&&!Oe(t.right)){const i=e.width-t.right;ze(t,"left")?(t.x=t.left,t.width=Math.max(0,i-t.left)):ze(t,"width")&&(t.x=i-t.width)}if(ze(t,"top")&&(t.y=t.top),ze(t,"bottom")&&!Oe(t.bottom)){const i=e.height-t.bottom;ze(t,"top")?(t.y=t.top,t.height=Math.max(0,i-t.top)):ze(t,"height")&&(t.y=i-t.height)}return t},wy=(t,e)=>(Yn(t)&&t.points.filter(i=>xi(i.x)).forEach(i=>{i.x*=e,i.y*=e}),nr(t)&&xi(t.x1)&&(t.x1*=e,t.y1*=e,t.x2*=e,t.y2*=e),xi(t.x)&&xi(t.y)&&(t.x*=e,t.y*=e),xi(t.width)&&xi(t.height)&&(t.width*=e,t.height*=e),xi(t.rx)&&xi(t.ry)&&(t.rx*=e,t.ry*=e),(i=>xi(i.strokeWidth)&&i.strokeWidth>0)(t)&&(t.strokeWidth*=e),qn(t)&&(t._scale=e,xi(t.fontSize)&&(t.fontSize*=e),xi(t.lineHeight)&&(t.lineHeight*=e),xi(t.width)&&!xi(t.height)&&(t.width*=e)),ze(t,"cornerRadius")&&xi(t.cornerRadius)&&(t.cornerRadius*=e),t),Sy=t=>{if(ko(t))return rt(t.x+.5*t.width,t.y+.5*t.height);if(Kn(t))return rt(t.x,t.y);if(t.text){if(qd(t)){const i=t.height||Jo(t.text,t).height;return rt(t.x+.5*t.width,t.y+.5*i)}const e=Jo(t.text,t);return rt(t.x+.5*e.width,t.y+.5*e.height)}return Yn(t)?Oo(t.points):nr(t)?Oo([Ga(t),Za(t)]):void 0};var Bc=t=>/canvas/i.test(t.nodeName),Tb=(t,e)=>new Promise((i,n)=>{let r=t,o=!1;const a=()=>{o||(o=!0,tn(e)&&Promise.resolve().then(()=>e(Vn(r.naturalWidth,r.naturalHeight))))};if(r.src||(r=new Image,Oe(t)&&new URL(t,location.href).origin!==location.origin&&(r.crossOrigin="anonymous"),r.src=Oe(t)?t:URL.createObjectURL(t)),r.complete)return a(),i(r);tn(e)&&iy(r).then(a).catch(n),r.onload=()=>{a(),i(r)},r.onerror=()=>n(new Error("Failed to load image"))});const Fm=new Map([]),vh=(t,e={})=>new Promise((i,n)=>{const{onMetadata:r=$e,onLoad:o=i,onError:a=n,onComplete:s=$e}=e;let l=Fm.get(t);if(l||(l={loading:!1,complete:!1,error:!1,image:void 0,size:void 0,bus:qa()},Fm.set(t,l)),l.bus.sub("meta",r),l.bus.sub("load",o),l.bus.sub("error",a),l.bus.sub("complete",s),Bc(t)){const c=t,d=c.cloneNode();l.complete=!0,l.image=d,l.size=bc(c)}if(l.complete)return l.bus.pub("meta",{size:l.size}),l.error?l.bus.pub("error",l.error):l.bus.pub("load",l.image),l.bus.pub("complete"),void(l.bus=qa());l.loading||(l.loading=!0,Tb(t,c=>{l.size=c,l.bus.pub("meta",{size:c})}).then(c=>{l.image=c,l.bus.pub("load",c)}).catch(c=>{l.error=c,l.bus.pub("error",c)}).finally(()=>{l.complete=!0,l.loading=!1,l.bus.pub("complete"),l.bus=qa()}))}),Mb=(t,e,i,n)=>t.drawImage(e,i.x,i.x,i.width,i.height,n.x,n.y,n.width,n.height);var ky=async(t,e,i,n,r=Mb,o)=>{t.save(),t.clip(),await r(t,e,i,n,o),t.restore()};const cu=(t,e,i,n,r)=>{const o=Ci(t);if(n){const s=Wo(rr(n),ni);return s.x*=i.width,s.width*=i.width,s.y*=i.height,s.height*=i.height,{srcRect:s,destRect:o}}const a=In(0,0,i.width,i.height);if(e==="contain"){const s=Jr(t,or(a));o.width=s.width,o.height=s.height,r?(o.x+=r.x,o.y+=r.y):(o.x+=s.x,o.y+=s.y)}else if(e==="cover"){const s=Ka(o,a.width/a.height);o.width=s.width,o.height=s.height,r?(o.x+=r.x,o.y+=r.y):(o.x+=s.x,o.y+=s.y)}else e?(o.width=e.width,o.height=e.height,r&&(o.x+=r.x,o.y+=r.y)):r&&(o.width=i.width,o.height=i.height,o.x+=r.x,o.y+=r.y);return{srcRect:a,destRect:o}},op=(t,e)=>(e.cornerRadius>0?((i,n,r,o,a,s)=>{o<2*s&&(s=o/2),a<2*s&&(s=a/2),i.beginPath(),i.moveTo(n+s,r),i.arcTo(n+o,r,n+o,r+a,s),i.arcTo(n+o,r+a,n,r+a,s),i.arcTo(n,r+a,n,r,s),i.arcTo(n,r,n+o,r,s),i.closePath()})(t,e.x,e.y,e.width,e.height,e.cornerRadius):t.rect(e.x,e.y,e.width,e.height),t),Dm=(t,e)=>(e.backgroundColor&&t.fill(),t),Bm=(t,e)=>(e.strokeWidth&&t.stroke(),t);var wh=async(t,e,i={})=>{const{drawImage:n}=i;if(t.lineWidth=e.strokeWidth?e.strokeWidth:1,t.strokeStyle=e.strokeColor?kr(e.strokeColor):"none",t.fillStyle=e.backgroundColor?kr(e.backgroundColor):"none",t.globalAlpha=e.opacity,e.backgroundImage){let r;if(r=Bc(e.backgroundImage)?e.backgroundImage:await vh(e.backgroundImage),op(t,e),Dm(t,e),e.backgroundRepeat==="repeat"){const o=e.backgroundPosition||{x:0,y:0},{srcRect:a,destRect:s}=cu(e,e.backgroundSize||bc(r),bc(r),e.backgroundCorners,{x:0,y:0}),l=document.createElement("canvas");l.width=s.width,l.height=s.height;const c=l.getContext("2d",{willReadFrequently:!1,desynchronized:!0});await n(c,r,a,{...s,x:0,y:0});const d=t.createPattern(l,"repeat");t.fillStyle=d,t.save(),t.beginPath(),t.rect(e.x+o.x,e.y+o.y,e.width-o.x,e.height-o.y),t.clip(),t.translate(s.x+o.x,s.y+o.y),t.fill(),Jn(l),t.restore()}else{const{srcRect:o,destRect:a}=cu(e,e.backgroundSize,bc(r),e.backgroundCorners,e.backgroundPosition);await ky(t,r,o,a,n,{feather:e.feather})}return t.beginPath(),op(t,e),Bm(t,e),[]}return op(t,e),Dm(t,e),Bm(t,e),[]},Sh=async(t,e,i={})=>new Promise(async(n,r)=>{const{drawImage:o}=i;if(t.lineWidth=e.strokeWidth||1,t.strokeStyle=e.strokeColor?kr(e.strokeColor):"none",t.fillStyle=e.backgroundColor?kr(e.backgroundColor):"none",t.globalAlpha=e.opacity,t.ellipse(e.x,e.y,e.rx,e.ry,0,0,2*Math.PI),e.backgroundColor&&t.fill(),e.backgroundImage){let a;try{a=await vh(e.backgroundImage)}catch(d){r(d)}const s=In(e.x-e.rx,e.y-e.ry,2*e.rx,2*e.ry),{srcRect:l,destRect:c}=cu(s,e.backgroundSize,bc(a),e.backgroundCorners,e.backgroundPosition);await ky(t,a,l,c,o),e.strokeWidth&&t.stroke(),n([])}else e.strokeWidth&&t.stroke(),n([])}),Pb=async(t,e,i)=>{const n=e.width&&e.height?Ea(e):Jo(e.text,e),r={x:e.x,y:e.y,width:n.width,height:n.height};if(wh(t,{...e,...r,options:i}),!e.text.length)return[];const{textOutlineWidth:o=0,textShadowX:a=0,textShadowY:s=0,textShadowBlur:l=0,textShadowColor:c,outline:d,blur:u,...p}=e;return e.height&&(t.rect(r.x-o+Math.min(a,0),r.y-o+Math.min(s,0),r.width+o+o+Math.abs(a)+l,r.height+o+Math.abs(s)+l),t.save(),t.clip()),(a||s||l)&&(t.save(),t.translate(a,s),await ap(t,r,e,{...i,paddingLeft:Kr+l,paddingRight:Kr+l,paddingTop:l,paddingBottom:l,shapeExtendedProps:{color:c,blur:l}}),t.restore()),o&&await ap(t,r,e,{...i,paddingLeft:Kr+o,paddingRight:Kr+o,paddingTop:o,paddingBottom:o,shapeExtendedProps:{color:e.textOutlineColor,outline:o}}),e.height&&t.restore(),await ap(t,r,p,{...i,paddingLeft:Kr,paddingRight:Kr,paddingTop:0,paddingBottom:0}),[]};const ap=async(t,e,i,n)=>{const{willRequest:r,shapeExtendedProps:o,paddingLeft:a,paddingRight:s,paddingTop:l,paddingBottom:c}=n,d=await $y(i.text,{...i,...o,...e,paddingLeft:a,paddingRight:s,paddingTop:l,paddingBottom:c,imageWidth:e.width,imageHeight:e.height,willRequest:r});t.drawImage(d,i.x-a,i.y-l,d.width,d.height)};var Rb=async(t,e)=>new Promise(async i=>{t.lineWidth=e.strokeWidth||1,t.strokeStyle=e.strokeColor?kr(e.strokeColor):"none",t.globalAlpha=e.opacity;let n=Ga(e),r=Za(e);t.moveTo(n.x,n.y),t.lineTo(r.x,r.y),e.strokeWidth&&t.stroke(),i([])}),Vp=async(t,e)=>new Promise((i,n)=>{if(e.bitmap&&e.points.length===1)return void Sh(t,{x:e.points[0].x,y:e.points[0].y,rx:.5*e.strokeWidth,ry:.5*e.strokeWidth,backgroundColor:e.strokeColor}).then(()=>i([]));t.lineWidth=e.strokeWidth||1,t.strokeStyle=e.strokeColor?kr(e.strokeColor):"none",t.fillStyle=e.backgroundColor?kr(e.backgroundColor):"none",t.globalAlpha=e.opacity;const{points:r}=e;t.lineCap=e.strokeCap,t.lineJoin=e.strokeJoin,t.setLineDash(e.strokeDash||[]),e.pathClose&&t.beginPath(),t.moveTo(r[0].x,r[0].y);const o=r.length;for(let a=1;a<o;a++)t.lineTo(r[a].x,r[a].y);e.pathClose&&t.closePath(),e.strokeWidth&&t.stroke(),e.backgroundColor&&t.fill(),i([])}),Cy=(t,e,i,n)=>((e||i)&&(t.translate(n.x,n.y),t.scale(e?-1:1,i?-1:1),t.translate(-n.x,-n.y)),t);const Ib=async(t,e,i)=>{t.globalCompositeOperation=e.drawMode==="subtract"?"destination-out":"source-over";const n=Sy(e);let r;if(gh(t,e.rotation,n),Cy(t,e.flipX,e.flipY,n),ko(e)?r=wh:Kn(e)?r=Sh:nr(e)?r=Rb:Yn(e)?r=Vp:qn(e)&&(r=Pb),r){const o=await r(t,e,i);return o.length?[e,...await Ty(t,o,i)]:[]}return[]};var Ty=async(t,e,i)=>{let n=[];for(const r of e)t.save(),t.beginPath(),n=[...n,...await Ib(t,r,i)],t.restore();return n},kh=async(t,e={})=>{const{shapes:i=[],contextBounds:n=t,transform:r=$e,drawImage:o,willRequest:a,canvasMemoryLimit:s,computeShape:l=Xi,preprocessShape:c=Xi}=e;if(!i.length)return t;const d=ln("canvas");d.width=n.width,d.height=n.height;const u=d.getContext("2d",{willReadFrequently:!0});u.putImageData(t,n.x||0,n.y||0);const p=i.map(_n).map(l).map(c).flat();r(u),await Ty(u,p,{drawImage:o,canvasMemoryLimit:s,willRequest:a});const h=u.getImageData(0,0,d.width,d.height);return Jn(d),h},Eb=async(t,e={})=>{const{backgroundColor:i,backgroundImage:n}=e,r=!(!i||i&&i[3]===0);if(!n&&!r)return t;const o=ln("canvas");o.width=t.width,o.height=t.height;const a=o.getContext("2d",{willReadFrequently:!0});if(a.putImageData(t,0,0),a.globalCompositeOperation="destination-over",r&&(a.fillStyle=kr(i),a.fillRect(0,0,o.width,o.height)),n){let l;l=Bc(n)?n:await vh(n);const{srcRect:c,destRect:d}=cu({x:0,y:0,width:t.width,height:t.height},"cover",{width:l.width,height:l.height});a.drawImage(l,c.x,c.y,c.width,c.height,d.x,d.y,d.width,d.height)}const s=a.getImageData(0,0,o.width,o.height);return Jn(o),s},Ch=t=>t.length?t.reduce((e,i)=>((n,r)=>{const o=new Array(20);return o[0]=n[0]*r[0]+n[1]*r[5]+n[2]*r[10]+n[3]*r[15],o[1]=n[0]*r[1]+n[1]*r[6]+n[2]*r[11]+n[3]*r[16],o[2]=n[0]*r[2]+n[1]*r[7]+n[2]*r[12]+n[3]*r[17],o[3]=n[0]*r[3]+n[1]*r[8]+n[2]*r[13]+n[3]*r[18],o[4]=n[0]*r[4]+n[1]*r[9]+n[2]*r[14]+n[3]*r[19]+n[4],o[5]=n[5]*r[0]+n[6]*r[5]+n[7]*r[10]+n[8]*r[15],o[6]=n[5]*r[1]+n[6]*r[6]+n[7]*r[11]+n[8]*r[16],o[7]=n[5]*r[2]+n[6]*r[7]+n[7]*r[12]+n[8]*r[17],o[8]=n[5]*r[3]+n[6]*r[8]+n[7]*r[13]+n[8]*r[18],o[9]=n[5]*r[4]+n[6]*r[9]+n[7]*r[14]+n[8]*r[19]+n[9],o[10]=n[10]*r[0]+n[11]*r[5]+n[12]*r[10]+n[13]*r[15],o[11]=n[10]*r[1]+n[11]*r[6]+n[12]*r[11]+n[13]*r[16],o[12]=n[10]*r[2]+n[11]*r[7]+n[12]*r[12]+n[13]*r[17],o[13]=n[10]*r[3]+n[11]*r[8]+n[12]*r[13]+n[13]*r[18],o[14]=n[10]*r[4]+n[11]*r[9]+n[12]*r[14]+n[13]*r[19]+n[14],o[15]=n[15]*r[0]+n[16]*r[5]+n[17]*r[10]+n[18]*r[15],o[16]=n[15]*r[1]+n[16]*r[6]+n[17]*r[11]+n[18]*r[16],o[17]=n[15]*r[2]+n[16]*r[7]+n[17]*r[12]+n[18]*r[17],o[18]=n[15]*r[3]+n[16]*r[8]+n[17]*r[13]+n[18]*r[18],o[19]=n[15]*r[4]+n[16]*r[9]+n[17]*r[14]+n[18]*r[19]+n[19],o})([...e],i),t.shift()):[],My=(t,e)=>{const i=t.width*t.height,n=e.reduce((o,a)=>(a.width>o.width&&a.height>o.height&&(o.width=a.width,o.height=a.height),o),{width:0,height:0}),r=n.width*n.height;return((o,a=2)=>Math.round(o*a)/a)(Math.max(.5,.5+(1-r/i)/2),5)};function Qe(){}const Th=t=>t;function Cn(t,e){for(const i in e)t[i]=e[i];return t}function Py(t){return t()}function Om(){return Object.create(null)}function _i(t){t.forEach(Py)}function ji(t){return typeof t=="function"}function ei(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function Nr(t,...e){if(t==null)return Qe;const i=t.subscribe(...e);return i.unsubscribe?()=>i.unsubscribe():i}function xa(t){let e;return Nr(t,i=>e=i)(),e}function A(t,e,i){t.$$.on_destroy.push(Nr(e,i))}function sr(t,e,i,n){if(t){const r=Ry(t,e,i,n);return t[0](r)}}function Ry(t,e,i,n){return t[1]&&n?Cn(i.ctx.slice(),t[1](n(e))):i.ctx}function lr(t,e,i,n){if(t[2]&&n){const r=t[2](n(i));if(e.dirty===void 0)return r;if(typeof r=="object"){const o=[],a=Math.max(e.dirty.length,r.length);for(let s=0;s<a;s+=1)o[s]=e.dirty[s]|r[s];return o}return e.dirty|r}return e.dirty}function cr(t,e,i,n,r,o){if(r){const a=Ry(e,i,n,o);t.p(a,r)}}function dr(t){if(t.ctx.length>32){const e=[],i=t.ctx.length/32;for(let n=0;n<i;n++)e[n]=-1;return e}return-1}function Pc(t){const e={};for(const i in t)i[0]!=="$"&&(e[i]=t[i]);return e}function Wm(t,e){const i={};e=new Set(e);for(const n in t)e.has(n)||n[0]==="$"||(i[n]=t[n]);return i}function Ct(t,e,i){return t.set(i),e}function Ui(t){return t&&ji(t.destroy)?t.destroy:Qe}const Iy=typeof window<"u";let Ey=Iy?()=>window.performance.now():()=>Date.now(),Mh=Iy?t=>requestAnimationFrame(t):Qe;const Rl=new Set;function Ay(t){Rl.forEach(e=>{e.c(t)||(Rl.delete(e),e.f())}),Rl.size!==0&&Mh(Ay)}function Ph(t){let e;return Rl.size===0&&Mh(Ay),{promise:new Promise(i=>{Rl.add(e={c:t,f:i})}),abort(){Rl.delete(e)}}}function Tt(t,e){t.appendChild(e)}function Ly(t){if(!t)return document;const e=t.getRootNode?t.getRootNode():t.ownerDocument;return e&&e.host?e:t.ownerDocument}function Ab(t){const e=pt("style");return function(i,n){Tt(i.head||i,n),n.sheet}(Ly(t),e),e.sheet}function tt(t,e,i){t.insertBefore(e,i||null)}function Q(t){t.parentNode.removeChild(t)}function pt(t){return document.createElement(t)}function Cr(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function cn(t){return document.createTextNode(t)}function de(){return cn(" ")}function Tn(){return cn("")}function Mt(t,e,i,n){return t.addEventListener(e,i,n),()=>t.removeEventListener(e,i,n)}function Lb(t){return function(e){return e.preventDefault(),t.call(this,e)}}function zb(t){return function(e){return e.stopPropagation(),t.call(this,e)}}function w(t,e,i){i==null?t.removeAttribute(e):t.getAttribute(e)!==i&&t.setAttribute(e,i)}function _m(t,e){const i=Object.getOwnPropertyDescriptors(t.__proto__);for(const n in e)e[n]==null?t.removeAttribute(n):n==="style"?t.style.cssText=e[n]:n==="__value"?t.value=t[n]=e[n]:i[n]&&i[n].set?t[n]=e[n]:w(t,n,e[n])}function Vm(t,e){Object.keys(e).forEach(i=>{(function(n,r,o){r in n?n[r]=typeof n[r]=="boolean"&&o===""||o:w(n,r,o)})(t,i,e[i])})}function An(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function Nm(t,e){t.value=e??""}function zy(t,e,{bubbles:i=!1,cancelable:n=!1}={}){const r=document.createEvent("CustomEvent");return r.initCustomEvent(t,i,n,e),r}class bu{constructor(e=!1){this.is_svg=!1,this.is_svg=e,this.e=this.n=null}c(e){this.h(e)}m(e,i,n=null){this.e||(this.is_svg?this.e=Cr(i.nodeName):this.e=pt(i.nodeName),this.t=i,this.c(e)),this.i(n)}h(e){this.e.innerHTML=e,this.n=Array.from(this.e.childNodes)}i(e){for(let i=0;i<this.n.length;i+=1)tt(this.t,this.n[i],e)}p(e){this.d(),this.h(e),this.i(this.a)}d(){this.n.forEach(Q)}}function du(t,e){return new t(e)}const uu=new Map;let Rc,Kd=0;function Hm(t,e,i,n,r,o,a,s=0){const l=16.666/n;let c=`{
`;for(let f=0;f<=1;f+=l){const x=e+(i-e)*o(f);c+=100*f+`%{${a(x,1-x)}}
`}const d=c+`100% {${a(i,1-i)}}
}`,u=`__svelte_${function(f){let x=5381,k=f.length;for(;k--;)x=(x<<5)-x^f.charCodeAt(k);return x>>>0}(d)}_${s}`,p=Ly(t),{stylesheet:h,rules:g}=uu.get(p)||function(f,x){const k={stylesheet:Ab(x),rules:{}};return uu.set(f,k),k}(p,t);g[u]||(g[u]=!0,h.insertRule(`@keyframes ${u} ${d}`,h.cssRules.length));const m=t.style.animation||"";return t.style.animation=`${m?m+", ":""}${u} ${n}ms linear ${r}ms 1 both`,Kd+=1,u}function Fb(t,e){const i=(t.style.animation||"").split(", "),n=i.filter(e?o=>o.indexOf(e)<0:o=>o.indexOf("__svelte")===-1),r=i.length-n.length;r&&(t.style.animation=n.join(", "),Kd-=r,Kd||Mh(()=>{Kd||(uu.forEach(o=>{const{ownerNode:a}=o.stylesheet;a&&Q(a)}),uu.clear())}))}function wc(t){Rc=t}function rl(){if(!Rc)throw new Error("Function called outside component initialization");return Rc}function ws(t){rl().$$.on_mount.push(t)}function Db(t){rl().$$.after_update.push(t)}function No(t){rl().$$.on_destroy.push(t)}function Sa(){const t=rl();return(e,i,{cancelable:n=!1}={})=>{const r=t.$$.callbacks[e];if(r){const o=zy(e,i,{cancelable:n});return r.slice().forEach(a=>{a.call(t,o)}),!o.defaultPrevented}return!0}}function wo(t,e){return rl().$$.context.set(t,e),e}function sn(t){return rl().$$.context.get(t)}function jr(t,e){const i=t.$$.callbacks[e.type];i&&i.slice().forEach(n=>n.call(this,e))}const $c=[],zi=[],Jd=[],Np=[],Fy=Promise.resolve();let Hp=!1;function Dy(){Hp||(Hp=!0,Fy.then(R))}function By(){return Dy(),Fy}function zl(t){Jd.push(t)}function To(t){Np.push(t)}const sp=new Set;let ac,Ld=0;function R(){const t=Rc;do{for(;Ld<$c.length;){const e=$c[Ld];Ld++,wc(e),Bb(e.$$)}for(wc(null),$c.length=0,Ld=0;zi.length;)zi.pop()();for(let e=0;e<Jd.length;e+=1){const i=Jd[e];sp.has(i)||(sp.add(i),i())}Jd.length=0}while($c.length);for(;Np.length;)Np.pop()();Hp=!1,sp.clear(),wc(t)}function Bb(t){if(t.fragment!==null){t.update(),_i(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(zl)}}function lp(t,e,i){t.dispatchEvent(zy(`${e?"intro":"outro"}${i}`))}const Qd=new Set;let Xa;function Fe(){Xa={r:0,c:[],p:Xa}}function De(){Xa.r||_i(Xa.c),Xa=Xa.p}function M(t,e){t&&t.i&&(Qd.delete(t),t.i(e))}function D(t,e,i,n){if(t&&t.o){if(Qd.has(t))return;Qd.add(t),Xa.c.push(()=>{Qd.delete(t),n&&(i&&t.d(1),n())}),t.o(e)}else n&&n()}const Ob={duration:0};function jm(t,e,i,n){let r=e(t,i),o=n?0:1,a=null,s=null,l=null;function c(){l&&Fb(t,l)}function d(p,h){const g=p.b-o;return h*=Math.abs(g),{a:o,b:p.b,d:g,duration:h,start:p.start,end:p.start+h,group:p.group}}function u(p){const{delay:h=0,duration:g=300,easing:m=Th,tick:f=Qe,css:x}=r||Ob,k={start:Ey()+h,b:p};p||(k.group=Xa,Xa.r+=1),a||s?s=k:(x&&(c(),l=Hm(t,o,p,g,h,m,x)),p&&f(0,1),a=d(k,g),zl(()=>lp(t,p,"start")),Ph(v=>{if(s&&v>s.start&&(a=d(s,g),s=null,lp(t,a.b,"start"),x&&(c(),l=Hm(t,o,a.b,a.duration,0,m,r.css))),a){if(v>=a.end)f(o=a.b,1-o),lp(t,a.b,"end"),s||(a.b?c():--a.group.r||_i(a.group.c)),a=null;else if(v>=a.start){const C=v-a.start;o=a.a+a.d*m(C/a.duration),f(o,1-o)}}return!(!a&&!s)}))}return{run(p){ji(r)?(ac||(ac=Promise.resolve(),ac.then(()=>{ac=null})),ac).then(()=>{r=r(),u(p)}):u(p)},end(){c(),a=s=null}}}const Oy=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function Wy(t,e){t.d(1),e.delete(t.key)}function Ss(t,e){D(t,1,1,()=>{e.delete(t.key)})}function Aa(t,e,i,n,r,o,a,s,l,c,d,u){let p=t.length,h=o.length,g=p;const m={};for(;g--;)m[t[g].key]=g;const f=[],x=new Map,k=new Map;for(g=h;g--;){const I=u(r,o,g),O=i(I);let T=a.get(O);T?n&&T.p(I,e):(T=c(O,I),T.c()),x.set(O,f[g]=T),O in m&&k.set(O,Math.abs(g-m[O]))}const v=new Set,C=new Set;function P(I){M(I,1),I.m(s,d),a.set(I.key,I),d=I.first,h--}for(;p&&h;){const I=f[h-1],O=t[p-1],T=I.key,L=O.key;I===O?(d=I.first,p--,h--):x.has(L)?!a.has(T)||v.has(T)?P(I):C.has(L)?p--:k.get(T)>k.get(L)?(C.add(T),P(I)):(v.add(L),p--):(l(O,a),p--)}for(;p--;){const I=t[p];x.has(I.key)||l(I,a)}for(;h;)P(f[h-1]);return f}function Tr(t,e){const i={},n={},r={$$scope:1};let o=t.length;for(;o--;){const a=t[o],s=e[o];if(s){for(const l in a)l in s||(n[l]=1);for(const l in s)r[l]||(i[l]=s[l],r[l]=1);t[o]=s}else for(const l in a)r[l]=1}for(const a in n)a in i||(i[a]=void 0);return i}function zr(t){return typeof t=="object"&&t!==null?t:{}}function mo(t,e,i){const n=t.$$.props[e];n!==void 0&&(t.$$.bound[n]=i,i(t.$$.ctx[n]))}function At(t){t&&t.c()}function It(t,e,i,n){const{fragment:r,after_update:o}=t.$$;r&&r.m(e,i),n||zl(()=>{const a=t.$$.on_mount.map(Py).filter(ji);t.$$.on_destroy?t.$$.on_destroy.push(...a):_i(a),t.$$.on_mount=[]}),o.forEach(zl)}function Et(t,e){const i=t.$$;i.fragment!==null&&(_i(i.on_destroy),i.fragment&&i.fragment.d(e),i.on_destroy=i.fragment=null,i.ctx=[])}function si(t,e,i,n,r,o,a,s=[-1]){const l=Rc;wc(t);const c=t.$$={fragment:null,ctx:[],props:o,update:Qe,not_equal:r,bound:Om(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(l?l.$$.context:[])),callbacks:Om(),dirty:s,skip_bound:!1,root:e.target||l.$$.root};a&&a(c.root);let d=!1;if(c.ctx=i?i(t,e.props||{},(u,p,...h)=>{const g=h.length?h[0]:p;return c.ctx&&r(c.ctx[u],c.ctx[u]=g)&&(!c.skip_bound&&c.bound[u]&&c.bound[u](g),d&&function(m,f){m.$$.dirty[0]===-1&&($c.push(m),Dy(),m.$$.dirty.fill(0)),m.$$.dirty[f/31|0]|=1<<f%31}(t,u)),p}):[],c.update(),d=!0,_i(c.before_update),c.fragment=!!n&&n(c.ctx),e.target){if(e.hydrate){const u=function(p){return Array.from(p.childNodes)}(e.target);c.fragment&&c.fragment.l(u),u.forEach(Q)}else c.fragment&&c.fragment.c();e.intro&&M(t.$$.fragment),It(t,e.target,e.anchor,e.customElement),R()}wc(l)}class li{$destroy(){Et(this,1),this.$destroy=Qe}$on(e,i){if(!ji(i))return Qe;const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(i),()=>{const r=n.indexOf(i);r!==-1&&n.splice(r,1)}}$set(e){var i;this.$$set&&(i=e,Object.keys(i).length!==0)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const vl=[];function kl(t,e){return{subscribe:le(t,e).subscribe}}function le(t,e=Qe){let i;const n=new Set;function r(o){if(ei(t,o)&&(t=o,i)){const a=!vl.length;for(const s of n)s[1](),vl.push(s,t);if(a){for(let s=0;s<vl.length;s+=2)vl[s][0](vl[s+1]);vl.length=0}}}return{set:r,update:function(o){r(o(t))},subscribe:function(o,a=Qe){const s=[o,a];return n.add(s),n.size===1&&(i=e(r)||Qe),o(t),()=>{n.delete(s),n.size===0&&(i(),i=null)}}}}function Ei(t,e,i){const n=!Array.isArray(t),r=n?[t]:t,o=e.length<2;return kl(i,a=>{let s=!1;const l=[];let c=0,d=Qe;const u=()=>{if(c)return;d();const h=e(n?l[0]:l,a);o?a(h):d=ji(h)?h:Qe},p=r.map((h,g)=>Nr(h,m=>{l[g]=m,c&=~(1<<g),s&&u()},()=>{c|=1<<g}));return s=!0,u(),function(){_i(p),d()}})}var _y=t=>t.reduce((e,i)=>Object.assign(e,i),{});const wl=t=>({updateValue:t}),Do=t=>({defaultValue:t}),Vy=t=>({store:t}),zd=t=>({store:(e,i)=>Ei(...t(i))}),Fd=t=>({store:(e,i)=>{const[n,r,o=()=>!1]=t(i);let a,s=!0;return Ei(n,(l,c)=>{r(l,d=>{!s&&o(a,d)||(a=d,s=!1,c(d))})})}}),sc=t=>({store:(e,i)=>{const[n,r={},o]=t(i);let a=[];const s={},l=h=>n(h,s),c=h=>{(a.length||h.length)&&(a=h,d())},d=()=>{const h=a.map(l);o&&h.sort(o),a=[...h],p(h)};Object.entries(r).map(([h,g])=>g.subscribe(m=>{s[h]=m,m&&d()}));const{subscribe:u,set:p}=le(e||[]);return{set:c,update:h=>c(h(a)),subscribe:u}}});var Um=t=>{const e={},i={};return t.forEach(([n,...r])=>{const o=_y(r),a=e[n]=((l,c,d)=>{const{store:u=C=>le(C),defaultValue:p=$e,updateValue:h}=d,g=u(p(),c,l),{subscribe:m,update:f=$e}=g;let x;const k=C=>{let P=!0;x&&x(),x=m(I=>{if(P)return P=!1;C(I),x(),x=void 0})},v=h?h(l):Xi;return g.set=C=>f(P=>v(C,P,k)),g.defaultValue=p,g})(i,e,o),s={get:()=>xa(a),set:a.set};Object.defineProperty(i,n,s)}),{stores:e,accessors:i}},Wb=[["src",Vy(()=>{let t;const{subscribe:e,set:i}=le(),n=r=>{t!==r&&(t=r,i(t))};return{set:n,subscribe:e,update:r=>n(r(t))}})],["imageReader"],["imageWriter"],["imageScrambler"],["imageRedactionRendering",Do(()=>"pixelated")],["images",Do(()=>[])],["shapePreprocessor"],["willRequestResource"],["willRequest"]],Ny=t=>t.charAt(0).toUpperCase()+t.slice(1),pu=(t,e)=>{Object.keys(e).forEach(i=>{const n=tn(e[i])?{value:e[i],writable:!1}:e[i];Object.defineProperty(t,i,n)})};const Gm=(t,e)=>{let i,n,r,o,a,s,l,c,d,u;const p=e.length;for(i=0;i<p;i++)if(n=e[i],r=e[i+1>p-1?0:i+1],o=n.x-t.x,a=n.y-t.y,s=r.x-t.x,l=r.y-t.y,c=o-s,d=a-l,u=c*a-d*o,u<-1e-5)return!1;return!0};var Zm=(t,e)=>{const i=Qf(e),n=Qi();_o(t).forEach(o=>{Fn(o,n),Gm(o,e)||i.forEach(a=>{const s=Math.atan2(a.start.y-a.end.y,a.start.x-a.end.x),l=1e4*Math.sin(Math.PI-s),c=1e4*Math.cos(Math.PI-s),d=rt(o.x+l,o.y+c),u=ch(Xf(a),1e4),p=dh(vs(o,d),u);p&&Fn(n,Dn(_e(p),o))})});const r=Ci(t);return Fn(r,n),!!_o(r).every(o=>Gm(o,e))&&(gu(t,r),!0)},Hy=(t,e)=>{const i=_o(t),n=ty(e,5),r=Ti(t),o=[];i.forEach(l=>{const c=((u,p)=>{if(p===0)return u;const h=rt(u.start.x-u.end.x,u.start.y-u.end.y),g=ro(h),m=Ar(g,p);return u.end.x+=m.x,u.end.y+=m.y,u})(vs(_e(r),_e(l)),1e6);let d=!1;n.map(Xf).forEach(u=>{const p=dh(c,u);p&&!d&&(o.push(p),d=!0)})});const a=ho(o[0],o[2])<ho(o[1],o[3])?[o[0],o[2]]:[o[1],o[3]],s=rr(a);return s.width<t.width&&(gu(t,s),!0)},jy=(t,e,i={x:0,y:0})=>{const n=Hr(t),r=Ti(n),o=qf(n,i,r).map(s=>qr(s,e,r)),a=rr(o);return o.map(s=>Dn(s,a))},Cl=(t,e=0,i=or(t))=>{let n,r;if(e!==0){const o=Math.atan2(1,i),a=Math.sign(e)*e,s=a%Math.PI,l=a%Vo;let c;c=s>ta&&s<Vo+ta?l>ta?a:Vo-l:l>ta?Vo-l:a;const d=Math.min(Math.abs(t.height/Math.sin(o+c)),Math.abs(t.width/Math.cos(o-c)));n=Math.cos(o)*d,r=n/i}else n=t.width,r=n/i,r>t.height&&(r=t.height,n=r*i);return Vn(n,r)},_b=(t,e,i,n,r,o,a,s)=>{const l=no(a),c=no(s),d=ni(Math.max(e.width/c.width,e.height/c.height)),u=ni(Math.min(e.width/l.width,e.height/l.height)),p=Ci(e);if(u<1||d>1){const h=Ti(t),g=Ti(e),m=u<1?u:d,f=(g.x+h.x)/2,x=(g.y+h.y)/2,k=p.width/m,v=p.height/m;Yf(p,f-.5*k,x-.5*v,k,v)}return o?(((h,g,m=0,f=Qi(),x)=>{if(xi(m)&&m!==0||f.x||f.y){const k=or(h),v=jy(g,m,f),C=Cl(g,m,k);if(!(h.width<C.width&&h.height<C.height)){const P=.5*h.width-.5*C.width,I=.5*h.height-.5*C.height;h.width>C.width&&(h.width=C.width,h.x+=P),h.height>C.height&&(h.height=C.height,h.y+=I)}Zm(h,v),Hy(h,v)&&Zm(h,v)}else{const k=or(h);h.width=Math.min(h.width,g.width),h.height=Math.min(h.height,g.height),h.x=Math.max(h.x,0),h.x+h.width>g.width&&(h.x-=h.x+h.width-g.width),h.y=Math.max(h.y,0),h.y+h.height>g.height&&(h.y-=h.y+h.height-g.height);const v=Ti(h),C=Jr(h,k);C.width=Math.max(x.width,C.width),C.height=Math.max(x.height,C.height),C.x=v.x-.5*C.width,C.y=v.y-.5*C.height,gu(h,C)}})(p,i,n,r,l),{crop:p}):{crop:p}},Rh=(t,e,i)=>{const n=Hr(t),r=Ti(n),o=Sr(n,i,r),a=Ti(Mc(rr(o))),s=Ti(e),l=qr(s,-i,a),c=Dn(l,a),d=Co(Fn(r,c),ni);return In(d.x-.5*e.width,d.y-.5*e.height,e.width,e.height)},Yi=(t,e,i)=>Math.max(e,Math.min(t,i));const cp=["cropLimitToImage","cropMinSize","cropMaxSize","cropAspectRatio","flipX","flipY","rotation","crop","colorMatrix","convolutionMatrix","gamma","vignette","manipulation","redaction","annotation","decoration","selection","frame","backgroundColor","backgroundImage","targetSize","metadata","trim","volume","minDuration","maxDuration"],jp=t=>En(t)?t.map(jp):$h(t)||Dc(t)?t:nl(t)?{...t}:t,lc=t=>t.map(e=>Object.entries(e).reduce((i,[n,r])=>(n.startsWith("_")||(i[n]=r),i),{})),Vb=(t,e)=>t===e;var Ja=(t,e,i=Vb)=>{if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!i(t[n],e[n]))return!1;return!0};const Xm=(t,e,i)=>{const n=Co(Ti(t),d=>ni(d,8)),r=Hr(e),o=Ti(r),a=Sr(r,i,o),s=Co(El(rr(a)),d=>ni(d,8)),l=Math.abs(s.x-n.x),c=Math.abs(s.y-n.y);return l<1&&c<1},Nb=(t,e,i,n,r)=>{if(!r)return[-1/0,1/0];const o=Math.max(i.width/n.width,i.height/n.height),a=Vn(n.width*o,n.height*o),s=(l=a,Math.sqrt(l.width*l.width+l.height*l.height));var l;if(s<Math.min(t.width,t.height))return[-1/0,1/0];const c=e?t.height:t.width,d=e?t.width:t.height,u=Math.acos(a.height/s),p=u-Math.acos(d/s),h=Math.asin(c/s)-u;if(Number.isNaN(p)&&Number.isNaN(h))return[-1/0,1/0];const g=Number.isNaN(p)?h:Number.isNaN(h)?p:Math.min(p,h);return[-g,g]},gc=(t,e)=>{const{context:i,props:n}=e;return t._isFormatted||((t=fy(t))._isFormatted=!0,Object.assign(t,n)),t._isDraft||!xu(t)||t._context&&ia(i,t._context)||(vy(t,i),t._context={...i}),t},Hb=(t,e)=>(t._isFormatted||(t.disableMove=!0,t.disableSelect=!0,t.disableResize=!0,t.disableRotate=!0),gc(t,e));var Ih=[["file"],["size"],["loadState"],["processState"],["aspectRatio",zd(({size:t})=>[t,e=>e?or(e):void 0])],["perspectiveX",Do(()=>0)],["perspectiveY",Do(()=>0)],["perspective",zd(({perspectiveX:t,perspectiveY:e})=>[[t,e],([i,n])=>({x:i,y:n})])],["rotation",Do(()=>0),wl(t=>(e,i,n)=>{if(e===i)return e;const{loadState:r,size:o,rotationRange:a,cropMinSize:s,cropMaxSize:l,crop:c,perspective:d,cropLimitToImage:u,cropOrigin:p}=t;if(!c||!r||!r.beforeComplete)return e;const h=u&&((f,x,k)=>{const v=Cl(x,k,or(f));return Tc(Ya(v,Math.round),Ya(no(f),Math.round))})(c,o,i),g=u&&Xm(c,o,i),m=((f,x,k,v,C,P,I,O,T,L)=>{const F=no(T),B=no(L);I&&(B.width=Math.min(L.width,C.width),B.height=Math.min(L.height,C.height));let y=!1;const V=(H,K)=>{const ut=Rh(C,v,H),lt=Hr(C),N=Ti(lt),ft=qf(lt,P,N),$t=Dn(_e(N),um(ft)),Lt=qr(Ti(ut),K,N),ct=Dn(_e(N),Lt);ft.forEach(mt=>qr(mt,K,N));const et=rr(ft),ht=um(ft),Y=Fn(Dn(Dn(ht,ct),et),$t),Z=In(Y.x-.5*ut.width,Y.y-.5*ut.height,ut.width,ut.height);if(O&&Er(Z,O.width/Z.width),I){const mt=jy(C,K,P);Hy(Z,mt)}const St=ni(Math.min(Z.width/F.width,Z.height/F.height),8),nt=ni(Math.max(Z.width/B.width,Z.height/B.height),8);return(St<1||nt>1)&&ni(Math.abs(K-H))===ni(Math.PI/2)&&!y?(y=!0,V(f,f+Math.sign(K-H)*Math.PI)):{rotation:K,crop:Wo(Z,mt=>ni(mt,8))}},J=Math.sign(x)*Math.round(Math.abs(x)/Vo)*Vo,S=Yi(x,J+k[0],J+k[1]);return V(f,S)})(i,e,a,c,o,d,u,p,s,l);if(h&&g){const f=Cl(o,e,or(m.crop));m.crop.x+=.5*m.crop.width,m.crop.y+=.5*m.crop.height,m.crop.x-=.5*f.width,m.crop.y-=.5*f.height,m.crop.width=f.width,m.crop.height=f.height}return n(()=>{t.crop=Wo(m.crop,f=>ni(f,8))}),m.rotation})],["flipX",Do(()=>!1)],["flipY",Do(()=>!1)],["flip",zd(({flipX:t,flipY:e})=>[[t,e],([i,n])=>({x:i,y:n})])],["isRotatedSideways",Fd(({rotation:t})=>[[t],([e],i)=>i(Ra(e)),(e,i)=>e!==i])],["crop",wl(t=>(e,i=e)=>{const{loadState:n,size:r,cropMinSize:o,cropMaxSize:a,cropLimitToImage:s,cropAspectRatio:l,rotation:c,perspective:d}=t;if(!e&&!i||!n||!n.beforeComplete)return e;e||(e=Hr(Cl(r,c,l||or(r))));const u=_b(i,e,r,c,d,s,o,a),p=Wo(u.crop,h=>ni(h,8));return ia(i,p)?i:p})],["cropAspectRatio",wl(t=>(e,i)=>{const{loadState:n,crop:r,size:o,rotation:a,cropLimitToImage:s}=t,l=(d=>{if(d){if(/:/.test(d)){const[u,p]=d.split(":");return u/p}return parseFloat(d)}})(e);if(!l)return;if(!r||!n||!n.beforeComplete)return l;const c=i?Math.abs(e-i):1;if(Xm(r,o,a)&&s&&c>=.1){const d=((u,p)=>{const h=u.width,g=u.height;return Ra(p)&&(u.width=g,u.height=h),u})(no(o),a);t.crop=Wo(Jr(Hr(d),e),ni)}else{const d={width:r.height*l,height:r.height},u=.5*(r.width-d.width),p=.5*(r.height-d.height);t.crop=Wo(In(r.x+u,r.y+p,d.width,d.height),ni)}return l})],["cropOrigin"],["cropMinSize",Do(()=>({width:1,height:1}))],["cropMaxSize",Do(()=>({width:32768,height:32768}))],["cropLimitToImage",Do(()=>!0),wl(t=>(e,i,n)=>{const{crop:r}=t;return r&&!i&&e&&n(()=>t.crop=Ci(t.crop)),e})],["cropSize",Fd(({crop:t})=>[[t],([e],i)=>{e&&i(Vn(e.width,e.height))},(e,i)=>Tc(e,i)])],["cropRectAspectRatio",zd(({cropSize:t})=>[[t],([e],i)=>{e&&i(ni(or(e),5))}])],["cropRange",Fd(({size:t,rotation:e,cropRectAspectRatio:i,cropMinSize:n,cropMaxSize:r,cropLimitToImage:o})=>[[t,e,i,n,r,o],([a,s,l,c,d,u],p)=>{a&&p(((h,g,m,f,x,k)=>{const v=no(f),C=no(x);return k?[v,Ya(Cl(h,g,m),Math.round)]:[v,C]})(a,s,l,c,d,u))},(a,s)=>Ja(a,s)])],["rotationRange",Fd(({size:t,isRotatedSideways:e,cropMinSize:i,cropSize:n,cropLimitToImage:r})=>[[t,e,i,n,r],([o,a,s,l,c],d)=>{!o||!l||d(Nb(o,a,s,l,c))},(o,a)=>Ja(o,a)])],["backgroundColor",wl(()=>t=>((e=[0,0,0,0],i=1)=>e.length===4?e:[...e,i])(t))],["backgroundImage"],["targetSize"],["colorMatrix"],["convolutionMatrix"],["gamma"],["noise"],["vignette"],["duration"],["minDuration",Do(()=>1/24)],["maxDuration",Do(()=>1/0)],["trim"],["volume",Do(()=>1)],["redaction",sc(({size:t})=>[gc,{context:t}])],["manipulation",sc(({size:t})=>[gc,{context:t}])],["annotation",sc(({size:t})=>[gc,{context:t}])],["decoration",sc(({crop:t})=>[gc,{context:t}])],["selection",sc(({size:t})=>[Hb,{context:t}])],["frame",wl(()=>t=>{if(!t)return;const e={frameStyle:void 0,x:0,y:0,width:"100%",height:"100%",disableStyle:["backgroundColor","strokeColor","strokeWidth"]};return Oe(t)?e.frameStyle=t:Object.assign(e,t),e})],["metadata"],["state",Vy((t,e,i)=>{const n=cp.map(l=>e[l]);let r=!1;const o=le({}),{subscribe:a}=Ei([...n,o],(l,c)=>{if(r)return;const d=cp.reduce((u,p,h)=>(u[p]=jp(l[h]),u),{});d.crop&&Wo(d.crop,Math.round),d.manipulation=d.manipulation&&lc(d.manipulation),d.redaction=d.redaction&&lc(d.redaction),d.annotation=d.annotation&&lc(d.annotation),d.decoration=d.decoration&&lc(d.decoration),d.selection=d.selection&&lc(d.selection),c(d)}),s=l=>{l&&(r=!0,i.cropOrigin=void 0,cp.filter(c=>ze(l,c)).forEach(c=>{const d=l[c];i[c]=d===null?void 0:jp(d)}),r=!1,o.set({}))};return{set:s,update:l=>s(l(null)),subscribe:a}})]],Ym=async(t,e,i={},n)=>{const{ontaskstart:r,ontaskprogress:o,ontaskend:a,token:s}=n;let l=!1;const c={cancel:$e};s.cancel=()=>{l=!0,c.cancel()};for(const[d,u]of e.entries()){if(l)return;const[p,h]=u;r(d,h);try{t=await p(t,{...i,taskCancelToken:c},g=>o(d,h,g))}catch(g){throw l=!0,g}a(d,h)}return t};const Uy=["loadstart","loadabort","loaderror","loadprogress","load","processstart","processabort","processerror","processprogress","process"],jb=["flip","cropOrigin","isRotatedSideways","perspective","perspectiveX","perspectiveY","cropRange"],Ub=Ih.map(([t])=>t).filter(t=>!jb.includes(t)),dp=t=>"image"+Ny(t),qm=t=>ze(t,"crop");var Gy=()=>{const{stores:t,accessors:e}=Um(Wb),{sub:i,pub:n}=qa(),r=()=>e.images?e.images[0]:{};let o={};const a={};Ub.forEach(m=>{Object.defineProperty(e,dp(m),{get:()=>{const f=r();if(f)return f.accessors[m]},set:f=>{o[dp(m)]=f,a[dp(m)]=f;const x=r();x&&(x.accessors[m]=f)}})});const s=()=>e.images&&e.images[0],l=t.src.subscribe(m=>{if(!m)return e.images=[];e.imageReader&&(e.images.length&&(o={}),d(m))}),c=t.imageReader.subscribe(m=>{m&&(e.images.length||e.src&&d(e.src))}),d=m=>{Promise.resolve().then(()=>p(m,o)).catch(()=>{})};let u;const p=(m,f={})=>new Promise((x,k)=>{let v=s();const C=!(f.cropLimitToImage===!1||f.imageCropLimitToImage===!1||a.imageCropLmitedToImage===!1),P=f.cropMinSize||f.imageCropMinSize||a.imageCropMinSize,I=C?P:v&&v.accessors.cropMinSize,O=f.minDuration||f.imageMinDuration;v&&g(),v=(({minSize:F={width:1,height:1},minDuration:B=0}={})=>{const{stores:y,accessors:V}=Um(Ih),{pub:J,sub:S}=qa(),H=(K,ut)=>{const lt=()=>V[K]||{},N=Lt=>{V[K]={...lt(),...Lt,timeStamp:Date.now()}},ft=()=>lt().error,$t=Lt=>{ft()||(N({error:Lt}),J(ut+"error",{...lt()}))};return{start(){J(ut+"start")},onabort(){N({abort:!0}),J(ut+"abort",{...lt()})},ontaskstart(Lt,ct){ft()||(N({index:Lt,task:ct,taskProgress:void 0,taskLengthComputable:void 0}),J(ut+"taskstart",{...lt()}))},ontaskprogress(Lt,ct,et){ft()||(N({index:Lt,task:ct,taskProgress:et.loaded/et.total,taskLengthComputable:et.lengthComputable}),J(ut+"taskprogress",{...lt()}),J(ut+"progress",{...lt()}))},ontaskend(Lt,ct){ft()||(N({index:Lt,task:ct}),J(ut+"taskend",{...lt()}))},ontaskerror(Lt){$t(Lt)},error(Lt){$t(Lt)},beforeComplete(Lt){ft()||(N({beforeComplete:!0}),J("before"+ut,Lt))},complete(Lt){ft()||(N({complete:!0}),J(ut,Lt))}}};return pu(V,{read:(K,{reader:ut},lt={})=>{if(!ut)return;Object.assign(V,{file:void 0,size:void 0,loadState:void 0});let N={cancel:$e},ft=!1;const $t=H("loadState","load"),Lt={token:N,...$t},ct={src:K,size:void 0,dest:void 0,duration:void 0};return Promise.resolve().then(async()=>{try{if($t.start(),ft)return $t.onabort();const et=await Ym(ct,ut,lt,Lt);if(ft)return $t.onabort();const{size:ht,duration:Y,dest:Z}=et||{};if(!ht||!ht.width||!ht.height)throw new vc("Image size missing","IMAGE_SIZE_MISSING",et);if(Y>0&&Y<B)throw new vc("Video too short","VIDEO_TOO_SHORT",{...et,minDuration:B});if(ht.width<F.width||ht.height<F.height)throw new vc("Image too small","IMAGE_TOO_SMALL",{...et,minWidth:F.width,minHeight:F.height});Object.assign(V,{file:Z,size:ht,duration:Y}),$t.beforeComplete(et),$t.complete(et)}catch(et){$t.error(et)}finally{N=void 0}}),()=>{ft=!0,N&&N.cancel(),$t.onabort()}},write:(K,ut)=>{if(!V.loadState.complete)return;V.processState=void 0;const lt=H("processState","process"),N={src:V.file,imageState:V.state,dest:void 0};if(tn(K)&&(K=K(V.file,V.state)),!K)return lt.start(),void lt.complete(N);let ft={cancel:$e},$t=!1;const Lt=ut,ct={token:ft,...lt};return Promise.resolve().then(async()=>{try{if(lt.start(),$t)return lt.onabort();const et=await Ym(N,K,Lt,ct);if($t)return lt.onabort();lt.complete(et)}catch(et){lt.error(et)}finally{ft=void 0}}),()=>{$t=!0,ft&&ft.cancel()}},on:S}),{accessors:V,stores:y}})({minSize:I,minDuration:O}),Uy.map(F=>{return v.accessors.on(F,(B=F,y=>n(B,y)));var B});const T=()=>{o={},L.forEach(F=>F())},L=[];L.push(v.accessors.on("loaderror",F=>{T(),k(F)})),L.push(v.accessors.on("loadabort",()=>{T(),k({name:"AbortError"})})),L.push(v.accessors.on("load",F=>{u=void 0,T(),x(F)})),L.push(v.accessors.on("beforeload",()=>((F,B)=>{if(qm(B))return void(e.imageState=B);if(!B.imageCrop){const J=F.accessors.size,S=B.imageRotation||0,H=Zf(no(J),S),K=Hr(H);K.width=ni(Math.abs(K.width),6),K.height=ni(Math.abs(K.height),6);const ut=B.imageCropAspectRatio||(B.imageCropLimitToImage?or(J):or(K));let lt;B.imageCropLimitToImage?lt=Jr(K,ut):(lt=Ka(K,ut),lt.x=(J.width-lt.width)/2,lt.y=(J.height-lt.height)/2),B.imageCrop=lt}if(F.accessors.duration&&!B.imageTrim&&B.imageMaxDuration){const{duration:J}=F.accessors;B.imageTrim=[[0,Math.min(B.imageMaxDuration/J,1)]]}const y=["imageCropLimitToImage","imageCrop","imageCropAspectRatio","imageRotation"];y.filter(J=>ze(B,J)).forEach(J=>{e[J]=B[J],delete B[J]});const V=Object.keys(B).filter(J=>!y.includes(J)).reduce((J,S)=>(J[S]=B[S],J),{});Object.assign(e,V)})(v,f))),e.images=[v],f.imageReader&&(e.imageReader=f.imageReader),f.imageWriter&&(e.imageWriter=f.imageWriter),u=v.accessors.read(m,{reader:e.imageReader},{willRequest:e.willRequest})});let h;const g=()=>{const m=s();m&&(u&&u(),m.accessors.loadState=void 0,e.images=[])};return Object.defineProperty(e,"stores",{get:()=>t}),pu(e,{on:i,loadImage:p,abortLoadImage:()=>{u&&u(),e.images=[]},editImage:(m,f)=>new Promise((x,k)=>{p(m,f).then(()=>{const{images:v}=e,C=v[0],P=()=>{I(),O()},I=C.accessors.on("processerror",T=>{P(),k(T)}),O=C.accessors.on("process",T=>{P(),x(T)})}).catch(k)}),removeImage:g,processImage:(m,f)=>new Promise((x,k)=>{try{const v=[],C=()=>{h=void 0,v.forEach(P=>P())};(async()=>{if((I=>Oe(I)||Ll(I)||Al(I))(m))try{await p(m,f)}catch(I){k(I)}else m&&(qm(m)?e.imageState=m:Object.assign(e,m));const P=s();if(!P)return k("no image");v.push(P.accessors.on("processerror",I=>{C(),k(I)})),v.push(P.accessors.on("processabort",()=>{C(),k({name:"AbortError"})})),v.push(P.accessors.on("process",I=>{C(),x(I)})),h=P.accessors.write(e.imageWriter,{redactionRenderStyle:e.imageRedactionRendering,shapePreprocessor:e.shapePreprocessor||Xi,imageScrambler:e.imageScrambler,willRequest:e.willRequest,willRequestResource:e.willRequestResource})})()}catch(v){k(v)}}),abortProcessImage:()=>{const m=s();m&&(h&&h(),m.accessors.processState=void 0)},destroy:()=>{l&&l(),c&&c()}}),e};const Gb=(t,e)=>{const{processImage:i}=Gy();return i(t,e)};var Zy=()=>Ia()?ba()?/15_|16_/.test(navigator.userAgent)?14745600:16777216:/15_/.test(navigator.userAgent)?16777216:1/0:1/0,Xy=(t,e)=>Object.keys(t).filter(i=>!e.includes(i)).reduce((i,n)=>(i[n]=t[n],i),{}),Yy=t=>new Promise(e=>{if(t.duration===1/0)return t.ontimeupdate=()=>{t.ontimeupdate=void 0,e(t)},void(t.currentTime=Number.MAX_SAFE_INTEGER);e(t)});const Eh=({imageDataResizer:t,canvasMemoryLimit:e}={})=>async(i,n,r,o,a)=>{r.width=Math.max(r.width,1),r.height=Math.max(r.height,1),o.width=Math.max(o.width,1),o.height=Math.max(o.height,1);const{dest:s}=await Gb(n,{imageReader:e2(),imageWriter:i2({format:"canvas",targetSize:{...o,upscale:!0},imageDataResizer:t,canvasMemoryLimit:e}),imageCrop:r}),{feather:l=0}=a||{};if(l>0){const c=ln("canvas");c.width=s.width,c.height=s.height;const d=c.getContext("2d",{willReadFrequently:!0}),u=1/l;let p=0;for(p=0;p<l;p++){const g=p*u;d.strokeStyle=`rgba(0,0,0,${g*g})`,d.strokeRect(p+.5,p+.5,s.width-2*p-1,s.height-2*p-1)}d.fillStyle="#000",d.fillRect(p,p,s.width+.5-2*p,s.height+.5-2*p);const h=s.getContext("2d");h.globalCompositeOperation="destination-in",h.drawImage(c,0,0),Jn(c)}i.drawImage(s,o.x,o.y,o.width,o.height),Jn(s)},xn=(t,e=(...n)=>n,i)=>async(n,r,o)=>{o(Sl(0,!1));let a=!1;const s=await t(...e(n,r,l=>{a=!0,o(l)}));return i&&i(n,s),a||o(Sl(1,!1)),n},Zb=({willRequest:t,srcProp:e="src",destProp:i="dest"}={})=>[xn(Qx,(n,r,o)=>[n[e],o,{...r,willRequest:t}],(n,r)=>n[i]=r),"any-to-file"],Xb=({srcProp:t="dest",destProp:e="dest"}={})=>[xn(async i=>{if(/octet-stream/.test(i.type)){console.warn(`Pintura: File has unknown mime type "${i.type}", make sure your server sets the correct Content-Type header.`);let n="image";const r=await mh(i);/video/i.test(r.nodeName)&&(n="video");const o={type:n+"/unknown"};return Dc(i)?new File([i],i.name,{...o,lastModified:i.lastModified}):new Blob([i],o)}return i},i=>[i[t]],(i,n)=>i[e]=n),"any-to-file"],qy=({srcProp:t="src",destProp:e="size"}={})=>[xn(ry,i=>[i[t]],(i,n)=>i[e]=n),"read-image-size"],Yb=async t=>{const e=await mh(t);if(ou(e))return await(i=>new Promise((n,r)=>{const o=()=>{Yy(i).then(()=>{n(i.duration)})};if(i.readyState>=1)return o();i.onloadedmetadata=o,i.onerror=()=>r(i.error)}))(e)},qb=({srcProp:t="src",destProp:e="duration"}={})=>[xn(Yb,i=>[i[t]],(i,n)=>i[e]=n),"read-media-duration"],Ky=({srcSize:t="size",srcOrientation:e="orientation",destSize:i="size"}={})=>[xn(tb,n=>[n[t],n[e]],(n,r)=>n[i]=r),"image-size-match-orientation"],Jy=({srcProp:t="src",destProp:e="head"}={})=>[xn((i,n)=>sy(i)?Bf(i,n):void 0,i=>[i[t],[0,262144],onprogress],(i,n)=>i[e]=n),"read-image-head"],Qy=({srcProp:t="head",destProp:e="orientation"}={})=>[xn(rh,i=>[i[t],274],(i,n=1)=>i[e]=n),"read-exif-orientation-tag"],Kb=({srcProp:t="head"}={})=>[xn(rh,e=>[e[t],274,1]),"clear-exif-orientation-tag"],Jb=({srcImageSize:t="size",srcCanvasSize:e="imageData",srcImageState:i="imageState",destImageSize:n="size",destScalar:r="scalar"}={})=>[xn((o,a)=>[Math.min(a.width/o.width,a.height/o.height),Ea(a)],o=>[o[t],o[e],o[i]],(o,[a,s])=>{o[r]=a,o[n]=s}),"calculate-canvas-scalar"],Qb=({srcProp:t="src",destProp:e="imageData",canvasMemoryLimit:i}={})=>[xn(Hf,n=>[n[t],i],(n,r)=>n[e]=r),"blob-to-image-data"],t4=({srcImageData:t="imageData",srcOrientation:e="orientation"}={})=>[xn(Wf,i=>[i[t],i[e]],(i,n)=>i.imageData=n),"image-data-match-orientation"],e4=({srcImageData:t="imageData",srcImageState:e="imageState"}={})=>[xn(Eb,i=>[i[t],{backgroundColor:i[e].backgroundColor,backgroundImage:i[e].backgroundImage}],(i,n)=>i.imageData=n),"image-data-fill"],i4=({srcImageData:t="imageData",srcImageState:e="imageState",destScalar:i="scalar"}={})=>[xn(ib,n=>{const r=n[i];let{crop:o}=n[e];return o&&r!==1&&(o=Er(Ci(o),r,Qi())),[n[t],{crop:o,rotation:n[e].rotation,flipX:n[e].flipX,flipY:n[e].flipY}]},(n,r)=>n.imageData=r),"image-data-crop"],n4=({targetSize:t={width:void 0,height:void 0,fit:void 0,upscale:void 0},imageDataResizer:e,srcProp:i="imageData",srcImageState:n="imageState",destImageScaledSize:r="imageScaledSize"})=>[xn(rb,o=>{const a=Math.min(t.width||Number.MAX_SAFE_INTEGER,o[n].targetSize&&o[n].targetSize.width||Number.MAX_SAFE_INTEGER),s=Math.min(t.height||Number.MAX_SAFE_INTEGER,o[n].targetSize&&o[n].targetSize.height||Number.MAX_SAFE_INTEGER);return[o[i],{width:a,height:s,fit:t.fit||"contain",upscale:(l=o[n],!!(l.targetSize&&l.targetSize.width||l.targetSize&&l.targetSize.height)||t.upscale||!1)},e];var l},(o,a)=>{Tc(o.imageData,a)||(o[r]=Ea(a)),o.imageData=a}),"image-data-resize"],r4=({srcImageData:t="imageData",srcImageState:e="imageState",destImageData:i="imageData"}={})=>[xn(cb,n=>{const{colorMatrix:r}=n[e],o=r&&Object.keys(r).map(a=>r[a]).filter(Boolean);return[n[t],{colorMatrix:o&&Ch(o),convolutionMatrix:n[e].convolutionMatrix,gamma:n[e].gamma,noise:n[e].noise,vignette:n[e].vignette}]},(n,r)=>n[i]=r),"image-data-filter"],o4=({srcImageData:t="imageData",srcImageState:e="imageState",destImageData:i="imageData",destScalar:n="scalar"}={})=>[xn(async(r,o,a,s,l,c)=>{if(!o||!s.length)return r;let d;try{const m={dataSizeScalar:My(r,s)};a&&a[3]>0&&(m.backgroundColor=[...a]),d=await o(r,m)}catch{}const u=ln("canvas");u.width=r.width,u.height=r.height;const p=u.getContext("2d",{willReadFrequently:!0});if(p.putImageData(r,0,0),c==="auto"){const m=Math.sqrt(r.width*r.height);p.filter=`blur(${Math.round(m/100)}px)`}const h=new Path2D;s.forEach(m=>{const f=In(m.x,m.y,m.width,m.height);ms(f,l);const x=Sr(Ci(f),m.rotation),k=new Path2D;x.forEach((v,C)=>{if(C===0)return k.moveTo(v.x,v.y);k.lineTo(v.x,v.y)}),h.addPath(k)}),p.clip(h,"nonzero"),p.imageSmoothingEnabled=!1,p.drawImage(d,0,0,u.width,u.height),Jn(d);const g=p.getImageData(0,0,u.width,u.height);return Jn(u),g},(r,{imageScrambler:o,redactionRenderStyle:a})=>[r[t],o,r[e].backgroundColor,r[e].redaction,r[n],a],(r,o)=>r[i]=o),"image-data-redact"],up=({srcImageData:t="imageData",srcSize:e="size",srcImageState:i="imageState",srcShapes:n="annotation",destImageData:r="imageData",destImageScaledSize:o="imageScaledSize",destScalar:a="scalar",imageDataResizer:s,canvasMemoryLimit:l,shapeFilter:c=Xi,shapeClip:d=!0,destImageContext:u="imageContext"}={})=>[xn(kh,(p,{shapePreprocessor:h,willRequestResource:g,willRequest:m})=>{const f=p[i][n].filter(c);if(!f.length)return[p[t]];const x=p[a],{crop:k}=p[i],v=p[e];let C=x;const P=p[o];P&&(C=Math.min(P.width/k.width,P.height/k.height));const I={width:v.width/x,height:v.height/x};return[p[t],{shapes:f,computeShape:O=>(O=Un(O,I),O=Xy(O,["left","right","top","bottom"]),O=wy(O,C)),transform:O=>{const T=p[e],{rotation:L=0,flipX:F,flipY:B,cropLimitToImage:y}=p[i],V=p[a],{crop:J=Hr(T)}=p[i],S=p[o],H=S?Math.min(S.width/J.width,S.height/J.height):1,K={width:T.width/V*H,height:T.height/V*H},ut=Zx(K,L),lt=ut.width,N=ut.height,ft=.5*K.width-.5*lt,$t=.5*K.height-.5*N,Lt=El(K);O.translate(-ft,-$t),O.translate(-J.x*H,-J.y*H),O.translate(Lt.x,Lt.y),O.rotate(L),O.translate(-Lt.x,-Lt.y);const ct=p[u]||{x:0,y:0};O.translate(ct.x,ct.y),O.scale(F?-1:1,B?-1:1),O.translate(F?-K.width*V:0,B?-K.height*V:0),y&&d&&(O.rect(0,0,K.width,K.height),O.clip())},drawImage:Eh({imageDataResizer:s,canvasMemoryLimit:l}),preprocessShape:O=>h(O,{isPreview:!1,...p[i]}),canvasMemoryLimit:l,willRequest:m||g}]},(p,h)=>p[r]=h),"image-data-annotate"],Km=({srcImageData:t="imageData",srcImageState:e="imageState",destImageData:i="imageData",destImageScaledSize:n="imageScaledSize",imageDataResizer:r,canvasMemoryLimit:o,destScalar:a="scalar",shapeFilter:s=Xi,destImageContext:l="imageContext"}={})=>[xn(kh,(c,{shapePreprocessor:d,willRequestResource:u,willRequest:p})=>{let h=c[e].decoration.filter(s);if(typeof window<"u"&&(x=>{if(x&&x._dzq9b88)return;const[k]=[[85,110,108,105,99,101,110,115,101,100,32,80,105,110,116,117,114,97,32,105,110,115,116,97,110,99,101,32]].map(I=>I.map(O=>String.fromCharCode(O)).join("")),{width:v,height:C}=c[e].crop,P=C/15;h=[...h,{x:.5*-P,y:.5*-P,width:1.5*v,height:1.25*C,text:Array(50).fill(k).join(""),fontWeight:900,lineHeight:P,fontSize:P,color:[1,1,1,.05]}]})(window),!h.length)return[c[t]];let g=c[a];const{crop:m}=c[e],f=c[n];return f&&(g=Math.min(f.width/m.width,f.height/m.height)),[c[t],{shapes:h,drawImage:Eh({imageDataResizer:r,canvasMemoryLimit:o}),computeShape:x=>(x=Un(x,m),x=Xy(x,["left","right","top","bottom"]),x=wy(x,g)),preprocessShape:x=>d(x,{isPreview:!1,...c[e]}),canvasMemoryLimit:o,willRequest:p||u,transform:x=>{const k=c[l]||{x:0,y:0};x.translate(k.x,k.y)}}]},(c,d)=>c[i]=d),"image-data-decorate"],a4=({srcImageData:t="imageData",srcImageState:e="imageState",destImageData:i="imageData",destImageScaledSize:n="imageScaledSize",imageDataResizer:r,canvasMemoryLimit:o,destScalar:a="scalar",destImageContext:s="imageContext"}={})=>[xn((l,c)=>new Promise(d=>{if(!c)return d([l]);kh(l,c).then(u=>{d([u,c.contextBounds])})}),(l,{shapePreprocessor:c,willRequestResource:d,willRequest:u})=>{const p=l[e].frame;if(!p)return[l[t]];const h=l[a];let{crop:g}=l[e];g&&h!==1&&(g=Er(Ci(g),h,Qi()));const m={...g},f=xy(by(p,m,c),m);m.x=Math.abs(f.left),m.y=Math.abs(f.top),m.width+=Math.abs(f.left)+Math.abs(f.right),m.height+=Math.abs(f.top)+Math.abs(f.bottom);const x=l[n],k=x?Math.min(x.width/g.width,x.height/g.height):1;return ms(m,k),m.x=Math.floor(m.x),m.y=Math.floor(m.y),m.width=Math.floor(m.width),m.height=Math.floor(m.height),[l[t],{shapes:[p],contextBounds:m,computeShape:v=>Un(v,l[t]),transform:v=>{v.translate(m.x,m.y)},drawImage:Eh({imageDataResizer:r,canvasMemoryLimit:o}),preprocessShape:v=>c(v,{isPreview:!1,...l[e]}),canvasMemoryLimit:o,willRequest:u||d}]},(l,[c,d])=>{l[s]=d,l[i]=c}),"image-data-frame"],s4=({mimeType:t,quality:e,srcImageData:i="imageData",srcFile:n="src",destBlob:r="blob"}={})=>[xn(Vx,o=>[o[i],t||lh(o[n].name)||o[n].type,e],(o,a)=>o[r]=a),"image-data-to-blob"],l4=({srcImageData:t="imageData",srcOrientation:e="orientation",destCanvas:i="dest"}={})=>[xn(Bl,n=>[n[t],n[e]],(n,r)=>n[i]=r),"image-data-to-canvas"],c4=async(t,e)=>{if(!sy(t)||!e)return t;const i=new DataView(e),n=Df(i);if(!n||!n.exif)return t;const r=["exif","mpf","xmp"].reduce((o,a)=>n[a]?Math.max(o,n[a].offset+n[a].size):o,0);return((o,a,s=[0,o.size])=>a?new Blob([a,o.slice(...s)],{type:o.type}):o)(t,e.slice(0,r+2),[20])},d4=(t="blob",e="head",i="blob")=>[xn(c4,n=>[n[t],n[e]],(n,r)=>n[i]=r),"blob-write-image-head"],u4=({renameFile:t,srcBlob:e="blob",srcFile:i="src",destFile:n="dest",defaultFilename:r}={})=>[xn(kc,o=>[o[e],t?t(o[i]):o[i].name||`${r}.${jf(o[e].type)}`],(o,a)=>o[n]=a),"blob-to-file"],Jm=({url:t="./",dataset:e=o=>[["dest",o.dest,o.dest.name],["imageState",o.imageState]],destStore:i="store",credentials:n,headers:r={}})=>[xn(async(o,a)=>await((s,l,c)=>new Promise((d,u)=>{const{token:p={},beforeSend:h=$e,onprogress:g=$e}=c;p.cancel=()=>m.abort();const m=new XMLHttpRequest;m.upload.onprogress=g,m.onload=()=>m.status>=200&&m.status<300?d(m):u(m),m.onerror=()=>u(m),m.ontimeout=()=>u(m),m.open("POST",encodeURI(s)),h(m),m.send(l instanceof FormData?l:l.reduce((f,x)=>(f.append(...x.map(eb)),f),new FormData))}))(t,o,{onprogress:a,beforeSend:s=>oy(s,{headers:r,credentials:n})}),(o,a,s)=>[e(o),s],(o,a)=>o[i]=a),"store"],t2=t=>[xn(e=>(t&&t.length&&Object.keys(e).forEach(i=>{t.includes(i)||delete e[i]}),e)),"prop-filter"],e2=(t={})=>{const{orientImage:e=!0,outputProps:i=["src","dest","size","duration"],preprocessImageFile:n,request:r={}}=t;return[Zb({willRequest:()=>r}),Xb(),n&&[xn(n,(o,a,s)=>[o.dest,a,s],(o,a)=>o.dest=a),"preprocess-image-file"],qy({srcProp:"dest"}),qb({srcProp:"dest"}),e&&Jy({srcProp:"dest"}),e&&Qy(),e&&Ky(),t2(i)].filter(Boolean)},p4=t=>t&&(Oe(t)?Jm({url:t}):tn(t)?[t,"store"]:Jm(t)),i2=(t={})=>(e,i,n={})=>{if(!fu(e))return;let{canvasMemoryLimit:r=Zy(),orientImage:o=!0,copyImageHead:a=!0,mimeType:s,quality:l,renameFile:c,targetSize:d,imageDataResizer:u,store:p,format:h="file",outputProps:g=["src","dest","imageState","store"],preprocessImageSource:m,preprocessImageState:f,postprocessImageData:x,postprocessImageBlob:k}={...t,...n};return h==="blob"&&(h="file"),[m&&[xn(m,(v,C,P)=>[v.src,C,P,v.imageState],(v,C)=>v.src=C),"preprocess-image-source"],(o||a)&&Jy(),o&&Qy(),qy(),f&&[xn(f,(v,C,P,I)=>[v.imageState,C,P,{size:v.size,orientation:v.orientation}],(v,C)=>v.imageState=C),"preprocess-image-state"],Qb({canvasMemoryLimit:r}),o&&Ky(),o&&t4(),Jb(),o4(),i4(),n4({imageDataResizer:u,targetSize:d}),up({imageDataResizer:u,canvasMemoryLimit:r,srcShapes:"manipulation"}),r4(),e4(),up({imageDataResizer:u,canvasMemoryLimit:r,srcShapes:"annotation",shapeFilter:v=>!v.aboveFrame}),Km({imageDataResizer:u,canvasMemoryLimit:r,shapeFilter:v=>!v.aboveFrame}),a4({imageDataResizer:u,canvasMemoryLimit:r}),up({imageDataResizer:u,canvasMemoryLimit:r,srcShapes:"annotation",shapeFilter:v=>v.aboveFrame,shapeClip:!1}),Km({imageDataResizer:u,canvasMemoryLimit:r,shapeFilter:v=>v.aboveFrame}),x&&[xn(x,(v,C,P)=>[v.imageData,C,P],(v,C)=>v.imageData=C),"postprocess-image-data"],h==="file"?s4({mimeType:s,quality:l}):h==="canvas"?l4():[v=>(v.dest=v.imageData,v)],h==="file"&&o&&Kb(),h==="file"&&a&&d4(),k&&[xn(k,({blob:v,imageData:C,src:P},I,O)=>[{blob:v,imageData:C,src:P},I,O],(v,C)=>v.blob=C),"postprocess-image-file"],h==="file"&&u4({defaultFilename:"image",renameFile:c}),h==="file"?p4(p):tn(p)&&[p,"store"],t2(g)].filter(Boolean)};var h4=(t,e,i,n,r,o,a,s,l,c,d)=>{if(!(t&&e&&i&&n&&s))return;s*=o;const u=Mc(Ci(e)),p=Ti(u),h=Ti(t),g=Hr(i),m=Ti(g),f=Rh(i,n,l),x=Ti(f),k=Dn(_e(m),x),v=Dn(_e(h),p);k.x+=v.x,k.y+=v.y;const C=Tl(_e(k));C.x+=v.x,C.y+=v.y;const P=Ti(ea(ea(Ci(r),a),t)),I=Dn(P,h);return Fn(k,I),{origin:C,translation:k,rotation:{x:d?Math.PI:0,y:c?Math.PI:0,z:l},scale:s}};let cc=null;var Ah=()=>{if(cc===null)if("WebGL2RenderingContext"in window){let t;try{t=ln("canvas"),cc=!!t.getContext("webgl2")}catch{cc=!1}t&&Jn(t),t=void 0}else cc=!1;return cc},Qm=t=>(t&t-1)==0,Lh=(t,e={},i="",n="")=>Object.keys(e).filter(r=>!nl(e[r])).reduce((r,o)=>r.replace(new RegExp(i+o+n),e[o]),t);const m4={head:`#version 300 es

in vec4 aPosition;uniform mat4 uMatrix;`,text:`
in vec2 aTexCoord;out vec2 vTexCoord;`,matrix:`
gl_Position=uMatrix*vec4(aPosition.x,aPosition.y,0,1);`},$4={head:`#version 300 es
precision highp float;

out vec4 fragColor;`,mask:`
uniform float uMaskFeather[8];uniform float uMaskBounds[4];uniform float uMaskOpacity;float mask(float x,float y,float bounds[4],float opacity){return 1.0-(1.0-(smoothstep(bounds[3],bounds[3]+1.0,x)*(1.0-smoothstep(bounds[1]-1.0,bounds[1],x))*(1.0-step(bounds[0],y))*step(bounds[2],y)))*(1.0-opacity);}`,init:`
float a=1.0;vec4 fillColor=uColor;vec4 textureColor=texture(uTexture,vTexCoord);textureColor*=(1.0-step(uRepeat.y,vTexCoord.y))*step(0.0,vTexCoord.y)*(1.0-step(uRepeat.x,vTexCoord.x))*step(0.0,vTexCoord.x);`,colorize:`
if(uTextureColor.a!=0.0&&textureColor.a>0.0){vec3 colorFlattened=textureColor.rgb/textureColor.a;if(colorFlattened.r>=.9999&&colorFlattened.g==0.0&&colorFlattened.b>=.9999){textureColor.rgb=uTextureColor.rgb*textureColor.a;}textureColor*=uTextureColor.a;}`,maskapply:`
float m=mask(gl_FragCoord.x,gl_FragCoord.y,uMaskBounds,uMaskOpacity);`,maskfeatherapply:`
float leftFeatherOpacity=step(uMaskFeather[1],gl_FragCoord.x)*uMaskFeather[0]+((1.0-uMaskFeather[0])*smoothstep(uMaskFeather[1],uMaskFeather[3],gl_FragCoord.x));float rightFeatherOpacity=(1.0-step(uMaskFeather[7],gl_FragCoord.x))*uMaskFeather[4]+((1.0-uMaskFeather[4])*smoothstep(uMaskFeather[7],uMaskFeather[5],gl_FragCoord.x));a*=leftFeatherOpacity*rightFeatherOpacity;`,rectaa:`
vec2 scaledPoint=vec2(vRectCoord.x*uSize.x,vRectCoord.y*uSize.y);a*=smoothstep(0.0,uEdgeFeather,uSize.x-scaledPoint.x);a*=smoothstep(0.0,uEdgeFeather,uSize.y-scaledPoint.y);a*=smoothstep(0.0,uEdgeFeather,scaledPoint.x);a*=smoothstep(0.0,uEdgeFeather,scaledPoint.y);`,cornerradius:`
vec2 s=(uSize-2.0)*.5;vec2 r=(vRectCoord*uSize)-1.0;vec2 p=r-s;float cornerRadius=uCornerRadius[0];bool left=r.x<s.x;bool top=r.y<s.y;if(!left&&top){cornerRadius=uCornerRadius[1];}if(!left&&!top){cornerRadius=uCornerRadius[3];}if(left&&!top){cornerRadius=uCornerRadius[2];}a*=1.0-clamp(length(max(abs(p)-(s-cornerRadius),0.0))-cornerRadius,0.0,1.0);`,fragcolor:`
if(m<=0.0)discard;fillColor.a*=a;fillColor.rgb*=fillColor.a;fillColor.rgb*=m;fillColor.rgb+=(1.0-m)*(uCanvasColor.rgb*fillColor.a);textureColor*=uTextureOpacity;textureColor.a*=a;textureColor.rgb*=m*a;textureColor.rgb+=(1.0-m)*(uCanvasColor.rgb*textureColor.a);fragColor=textureColor+(fillColor*(1.0-textureColor.a));`},t$=(t,e,i)=>{const n=t.createShader(i),r=((o,a,s)=>(a=Lh(a,s===o.VERTEX_SHADER?m4:$4,"##").trim(),Ah()?a:(a=(a=a.replace(/#version.+/gm,"").trim()).replace(/^\/\/\#/gm,"#"),s===o.VERTEX_SHADER&&(a=a.replace(/in /gm,"attribute ").replace(/out /g,"varying ")),s===o.FRAGMENT_SHADER&&(a=a.replace(/in /gm,"varying ").replace(/out.*?;/gm,"").replace(/texture\(/g,"texture2D(").replace(/fragColor/g,"gl_FragColor")),""+a)))(t,e,i);return t.shaderSource(n,r),t.compileShader(n),t.getShaderParameter(n,t.COMPILE_STATUS)||console.error(t.getShaderInfoLog(n)),n},dc=(t,e,i,n,r)=>{const o=t$(t,e,t.VERTEX_SHADER),a=t$(t,i,t.FRAGMENT_SHADER),s=t.createProgram();t.attachShader(s,o),t.attachShader(s,a),t.linkProgram(s);const l={};return n.forEach(c=>{l[c]=t.getAttribLocation(s,c)}),r.forEach(c=>{l[c]=t.getUniformLocation(s,c)}),{program:s,locations:l,destroy(){t.detachShader(s,o),t.detachShader(s,a),t.deleteShader(o),t.deleteShader(a),t.deleteProgram(s)}}},e$=t=>t.nodeName!=="VIDEO"&&(!!Ah()||Qm(t.width)&&Qm(t.height)),g4=(t,e,i,n)=>(t.bindTexture(t.TEXTURE_2D,e),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,i),((r,o,a)=>{r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,e$(o)?r.LINEAR_MIPMAP_LINEAR:r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,a.filterParam),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,a.wrapParam),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,a.wrapParam),e$(o)&&r.generateMipmap(r.TEXTURE_2D)})(t,i,n),t.bindTexture(t.TEXTURE_2D,null),e),Zs=(t,e=1)=>t?[t[0],t[1],t[2],xi(t[3])?e*t[3]:e]:[0,0,0,0],pp=()=>{const t=new Float32Array(16);return t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},hp=(t,e,i,n,r,o,a)=>{const s=1/(e-i),l=1/(n-r),c=1/(o-a);t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+i)*s,t[13]=(r+n)*l,t[14]=(a+o)*c,t[15]=1},Xs=(t,e,i,n)=>{t[12]=t[0]*e+t[4]*i+t[8]*n+t[12],t[13]=t[1]*e+t[5]*i+t[9]*n+t[13],t[14]=t[2]*e+t[6]*i+t[10]*n+t[14],t[15]=t[3]*e+t[7]*i+t[11]*n+t[15]},i$=(t,e)=>{t[0]*=e,t[1]*=e,t[2]*=e,t[3]*=e,t[4]*=e,t[5]*=e,t[6]*=e,t[7]*=e,t[8]*=e,t[9]*=e,t[10]*=e,t[11]*=e},n$=(t,e)=>{const i=Math.sin(e),n=Math.cos(e),r=t[4],o=t[5],a=t[6],s=t[7],l=t[8],c=t[9],d=t[10],u=t[11];t[4]=r*n+l*i,t[5]=o*n+c*i,t[6]=a*n+d*i,t[7]=s*n+u*i,t[8]=l*n-r*i,t[9]=c*n-o*i,t[10]=d*n-a*i,t[11]=u*n-s*i},r$=(t,e)=>{const i=Math.sin(e),n=Math.cos(e),r=t[0],o=t[1],a=t[2],s=t[3],l=t[8],c=t[9],d=t[10],u=t[11];t[0]=r*n-l*i,t[1]=o*n-c*i,t[2]=a*n-d*i,t[3]=s*n-u*i,t[8]=r*i+l*n,t[9]=o*i+c*n,t[10]=a*i+d*n,t[11]=s*i+u*n},o$=(t,e)=>{const i=Math.sin(e),n=Math.cos(e),r=t[0],o=t[1],a=t[2],s=t[3],l=t[4],c=t[5],d=t[6],u=t[7];t[0]=r*n+l*i,t[1]=o*n+c*i,t[2]=a*n+d*i,t[3]=s*n+u*i,t[4]=l*n-r*i,t[5]=c*n-o*i,t[6]=d*n-a*i,t[7]=u*n-s*i};var f4=t=>t*Math.PI/180,vu=(t,e)=>Ah()?t.getContext("webgl2",e):t.getContext("webgl",e)||t.getContext("experimental-webgl",e);const mp=(t,e)=>{const i=t.length;return e>=i?t[e%i]:e<0?t[e%i+i]:t[e]},y4=(t,e,i,n)=>{const r=rt(i.x-e.x,i.y-e.y),o=rt(n.x-i.x,n.y-i.y),a=rt(e.x-n.x,e.y-n.y),s=rt(t.x-e.x,t.y-e.y),l=rt(t.x-i.x,t.y-i.y),c=rt(t.x-n.x,t.y-n.y),d=Zd(r,s),u=Zd(o,l),p=Zd(a,c);return d<=0&&u<=0&&p<=0},x4=t=>{if(t.length<3)return[];if((x=>{const k=x.length;for(let v=0;v<k;v++){const C=vs(x[v],mp(x,v+1));if(Jf(C,x,{ignoreIdenticalLines:!0,breakOnIntersection:!0}))return!0}return!1})(t))return[];(x=>{let k,v,C,P,I,O=0;const T=x.length;for(k=0;k<T;k++)v=x[k],C=x[(k+1)%T],P=C.x-v.x,I=(C.y+v.y)/2,O+=P*I;return O})(t)<0&&t.reverse();const e=t.length,i=[...Array(e).keys()],n=[];let r,o,a,s,l,c,d,u,p,h,g,m,f=128;for(;i.length>3;){if(f<=0)return[];for(f--,r=0;r<i.length;r++)if(a=i[r],s=mp(i,r-1),l=mp(i,r+1),c=t[a],d=t[s],u=t[l],p=rt(d.x-c.x,d.y-c.y),h=rt(u.x-c.x,u.y-c.y),!(Zd(p,h)<0)){for(g=!0,o=0;o<e;o++)if(o!==a&&o!==s&&o!==l&&(m=t[o],y4(m,d,c,u))){g=!1;break}if(g){n.push([d,c,u]),i.splice(r,1);break}}}return n.push([t[i[0]],t[i[1]],t[i[2]]]),n},a$=(t,e,i,n,r)=>{const o=ro(rt(n.x-i.x,n.y-i.y)),a=ro(rt(r.x-n.x,r.y-n.y)),s=ro(rt(o.x+a.x,o.y+a.y)),l=rt(-s.y,s.x),c=rt(-o.y,o.x),d=Math.min(1/Gd(l,c),5);t[e]=n.x,t[e+1]=n.y,t[e+2]=l.x*d,t[e+3]=l.y*d,t[e+4]=-1,t[e+5]=n.x,t[e+6]=n.y,t[e+7]=l.x*d,t[e+8]=l.y*d,t[e+9]=1},s$=t=>{const e=new Float32Array(8);return e[0]=t[3].x,e[1]=t[3].y,e[2]=t[0].x,e[3]=t[0].y,e[4]=t[2].x,e[5]=t[2].y,e[6]=t[1].x,e[7]=t[1].y,e},l$=(t,e=0,i,n)=>{const r=_o(t),o=t.x+.5*t.width,a=t.y+.5*t.height;return(i||n)&&Ml(r,i,n,o,a),e!==0&&tl(r,e,o,a),r},Dd=(t,e,i,n,r)=>{const o=Math.min(20,Math.max(4,Math.round(n/2)));let a=0,s=0,l=0,c=0,d=0;for(;d<o;d++)a=d/o,s=r*Vo+a*Vo,l=n*Math.cos(s),c=n*Math.sin(s),t.push(rt(e+l,i+c))};let Bd=null;var zh=()=>{if(Bd!==null)return Bd;let t=ln("canvas");const e=vu(t);return Bd=e?e.getParameter(e.MAX_TEXTURE_SIZE):void 0,Jn(t),t=void 0,Bd},Fh=()=>Lr()&&!!window.chrome;const fc=new Float32Array([0,1,0,0,1,1,1,0]),b4=new Float32Array([1,0,0,0,1,1,0,1]),v4=Lr()&&va(),c$=[0,0,0,0,1,0,0,0,0],w4=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],$p=[0,0,0,0],S4=[0,0,0,0],d$=(t,e,i,n,r)=>{if(!i||!n)return fc;let o=n.x/i.width,a=n.y/i.height,s=t/i.width/r,l=e/i.height/r;return s-=o,l-=a,new Float32Array([-o,l,-o,-a,s,l,s,-a])};var k4=(t,e={})=>{const{alpha:i=!1}=e,n={width:0,height:0},r={width:0,height:0},o=zh()||1024;let a,s,l;const c=pp(),d=pp();let u,p,h,g,m,f,x,k,v,C=0,P=0,I=0,O=1;const T=new Map([]),L=()=>{y.stencilOp(y.KEEP,y.KEEP,y.KEEP),y.stencilFunc(y.ALWAYS,1,255),y.stencilMask(255)},F=f4(30),B=Math.tan(F/2),y=vu(t,{alpha:i,antialias:!1,premultipliedAlpha:!0,stencil:!0});if(!y)return;y.getExtension("OES_standard_derivatives"),y.disable(y.DEPTH_TEST),y.enable(y.STENCIL_TEST),y.enable(y.BLEND),y.blendFunc(y.ONE,y.ONE_MINUS_SRC_ALPHA),y.pixelStorei(y.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!(!i&&va())),L();const V=y.createTexture();y.bindTexture(y.TEXTURE_2D,V),y.texImage2D(y.TEXTURE_2D,0,y.RGBA,1,1,0,y.RGBA,y.UNSIGNED_BYTE,new Uint8Array($p)),T.set(0,V);const J=y.createTexture();T.set(2,J);const S=y.createFramebuffer(),H=y.createTexture();T.set(1,H);const K=y.createFramebuffer(),ut=dc(y,`
##head
##text
void main(){vTexCoord=aTexCoord;gl_Position=uMatrix*aPosition;}`,`
##head
in vec2 vTexCoord;uniform sampler2D uTexture;uniform sampler2D uTextureOverlay;uniform sampler2D uTextureBlend;uniform vec2 uTextureSize;uniform float uOpacity;uniform int uAntialias;uniform vec4 uOverlayColor;uniform mat4 uColorMatrix;uniform vec4 uColorOffset;uniform float uClarityKernel[9];uniform float uClarityKernelWeight;uniform float uColorGamma;uniform float uColorVignette;uniform float uMaskClip;uniform float uMaskOpacity;uniform float uMaskBounds[4];uniform float uMaskCornerRadius[4];uniform float uMaskFeather[8];vec4 applyGamma(vec4 c,float g){c.r=pow(c.r,g);c.g=pow(c.g,g);c.b=pow(c.b,g);return c;}vec4 applyColorMatrix(vec4 c,mat4 m,vec4 o){return(c*m)+(o*c.a);}vec4 applyConvolutionMatrix(vec4 c,float k0,float k1,float k2,float k3,float k4,float k5,float k6,float k7,float k8,float w){vec2 pixel=vec2(1)/uTextureSize;vec4 colorSum=texture(uTexture,vTexCoord-pixel)*k0+texture(uTexture,vTexCoord+pixel*vec2(0.0,-1.0))*k1+texture(uTexture,vTexCoord+pixel*vec2(1.0,-1.0))*k2+texture(uTexture,vTexCoord+pixel*vec2(-1.0,0.0))*k3+texture(uTexture,vTexCoord)*k4+texture(uTexture,vTexCoord+pixel*vec2(1.0,0.0))*k5+texture(uTexture,vTexCoord+pixel*vec2(-1.0,1.0))*k6+texture(uTexture,vTexCoord+pixel*vec2(0.0,1.0))*k7+texture(uTexture,vTexCoord+pixel)*k8;vec4 color=vec4(clamp((colorSum/w),0.0,1.0).rgb,c.a);return color;}vec4 applyVignette(vec4 c,vec2 pos,vec2 center,float v){float d=distance(pos,center)/length(center);float f=1.0-(d*abs(v));if(v>0.0){c.rgb*=f;}else if(v<0.0){c.rgb+=(1.0-f)*(1.0-c.rgb);}return c;}vec4 blendPremultipliedAlpha(vec4 back,vec4 front){return front+(back*(1.0-front.a));}void main(){float x=gl_FragCoord.x;float y=gl_FragCoord.y;float a=1.0;float maskTop=uMaskBounds[0];float maskRight=uMaskBounds[1];float maskBottom=uMaskBounds[2];float maskLeft=uMaskBounds[3];float leftFeatherOpacity=step(uMaskFeather[1],x)*uMaskFeather[0]+((1.0-uMaskFeather[0])*smoothstep(uMaskFeather[1],uMaskFeather[3],x));float rightFeatherOpacity=(1.0-step(uMaskFeather[7],x))*uMaskFeather[4]+((1.0-uMaskFeather[4])*smoothstep(uMaskFeather[7],uMaskFeather[5],x));a*=leftFeatherOpacity*rightFeatherOpacity;float overlayColorAlpha=(smoothstep(maskLeft,maskLeft+1.0,x)*(1.0-smoothstep(maskRight-1.0,maskRight,x))*(1.0-step(maskTop,y))*step(maskBottom,y));if(uOverlayColor.a==0.0){a*=overlayColorAlpha;}vec2 offset=vec2(maskLeft,maskBottom);vec2 size=vec2(maskRight-maskLeft,maskTop-maskBottom)*.5;vec2 center=offset.xy+size.xy;int pixelX=int(step(center.x,x));int pixelY=int(step(y,center.y));float cornerRadius=0.0;if(pixelX==0&&pixelY==0)cornerRadius=uMaskCornerRadius[0];if(pixelX==1&&pixelY==0)cornerRadius=uMaskCornerRadius[1];if(pixelX==0&&pixelY==1)cornerRadius=uMaskCornerRadius[2];if(pixelX==1&&pixelY==1)cornerRadius=uMaskCornerRadius[3];float cornerOffset=sign(cornerRadius)*length(max(abs(gl_FragCoord.xy-size-offset)-size+cornerRadius,0.0))-cornerRadius;float cornerOpacity=1.0-smoothstep(0.0,1.0,cornerOffset);a*=cornerOpacity;if(uAntialias==1){vec2 scaledPoint=vec2(vTexCoord.x*uTextureSize.x,vTexCoord.y*uTextureSize.y);a*=smoothstep(0.0,1.0,uTextureSize.x-scaledPoint.x);a*=smoothstep(0.0,1.0,uTextureSize.y-scaledPoint.y);a*=smoothstep(0.0,1.0,scaledPoint.x);a*=smoothstep(0.0,1.0,scaledPoint.y);}vec4 color=texture(uTexture,vTexCoord);if(uClarityKernelWeight!=-1.0){color=applyConvolutionMatrix(color,uClarityKernel[0],uClarityKernel[1],uClarityKernel[2],uClarityKernel[3],uClarityKernel[4],uClarityKernel[5],uClarityKernel[6],uClarityKernel[7],uClarityKernel[8],uClarityKernelWeight);}color=blendPremultipliedAlpha(color,texture(uTextureBlend,vTexCoord));color=applyGamma(color,uColorGamma);color=applyColorMatrix(color,uColorMatrix,uColorOffset);color*=a;if(uColorVignette!=0.0){vec2 pos=gl_FragCoord.xy-offset;color=applyVignette(color,pos,center-offset,uColorVignette);}color=blendPremultipliedAlpha(color,texture(uTextureOverlay,vTexCoord));if(overlayColorAlpha<=0.0){color*=1.0-uOverlayColor.a;}color*=uOpacity;fragColor=color;}`,["aPosition","aTexCoord"],["uMatrix","uTexture","uTextureBlend","uTextureOverlay","uTextureSize","uColorGamma","uColorVignette","uColorOffset","uColorMatrix","uClarityKernel","uClarityKernelWeight","uOpacity","uMaskOpacity","uMaskBounds","uMaskCornerRadius","uMaskFeather","uOverlayColor","uAntialias"]),lt=y.createBuffer(),N=y.createBuffer();y.bindBuffer(y.ARRAY_BUFFER,N),y.bufferData(y.ARRAY_BUFFER,fc,y.STATIC_DRAW);const ft=y.createBuffer();y.bindBuffer(y.ARRAY_BUFFER,ft),y.bufferData(y.ARRAY_BUFFER,b4,y.STATIC_DRAW);const $t=dc(y,`#version 300 es

in vec4 aPosition;in vec2 aNormal;in float aMiter;out vec2 vNormal;out float vMiter;out float vWidth;uniform float uWidth;uniform float uSharpness;uniform mat4 uMatrix;void main(){vMiter=aMiter;vNormal=aNormal;vWidth=(uWidth*.5)+uSharpness;gl_Position=uMatrix*vec4(aPosition.x+(aNormal.x*vWidth*aMiter),aPosition.y+(aNormal.y*vWidth*aMiter),0,1);}`,`
##head
##mask
in vec2 vNormal;in float vMiter;in float vWidth;uniform float uWidth;uniform vec4 uColor;uniform vec4 uCanvasColor;void main(){vec4 fillColor=uColor;float m=mask(gl_FragCoord.x,gl_FragCoord.y,uMaskBounds,uMaskOpacity);if(m<=0.0)discard;fillColor.a*=clamp(smoothstep(vWidth-.5,vWidth-1.0,abs(vMiter)*vWidth),0.0,1.0);fillColor.rgb*=fillColor.a;fillColor.rgb*=m;fillColor.rgb+=(1.0-m)*(uCanvasColor.rgb*fillColor.a);fragColor=fillColor;}`,["aPosition","aNormal","aMiter"],["uColor","uCanvasColor","uMatrix","uWidth","uSharpness","uMaskBounds","uMaskOpacity"]),Lt=y.createBuffer();Fh()&&(y.bindBuffer(y.ARRAY_BUFFER,Lt),y.bufferData(y.ARRAY_BUFFER,1,y.DYNAMIC_DRAW));const ct=(yt,Gt,ue,pe=!1)=>{const{program:ve,locations:ge}=$t;y.useProgram(ve),y.enableVertexAttribArray(ge.aPosition),y.enableVertexAttribArray(ge.aNormal),y.enableVertexAttribArray(ge.aMiter);const _=((_t,Te)=>{let Ie,He,vi,vt=0;const bt=_t.length,Ze=new Float32Array(10*(Te?bt+1:bt)),Pe=_t[0],ri=_t[bt-1];for(vt=0;vt<bt;vt++)Ie=_t[vt-1],He=_t[vt],vi=_t[vt+1],Ie||(Ie=Te?ri:rt(He.x+(He.x-vi.x),He.y+(He.y-vi.y))),vi||(vi=Te?Pe:rt(He.x+(He.x-Ie.x),He.y+(He.y-Ie.y))),a$(Ze,10*vt,Ie,He,vi);return Te&&a$(Ze,10*bt,ri,Pe,_t[1]),Ze})(yt,pe),we=5*Float32Array.BYTES_PER_ELEMENT,gi=2*Float32Array.BYTES_PER_ELEMENT,xe=4*Float32Array.BYTES_PER_ELEMENT;y.uniform1f(ge.uWidth,Gt),y.uniform1f(ge.uSharpness,l),y.uniform4fv(ge.uColor,ue),y.uniformMatrix4fv(ge.uMatrix,!1,u),y.uniform4f(ge.uCanvasColor,C,P,I,O),y.uniform1fv(ge.uMaskBounds,x),y.uniform1f(ge.uMaskOpacity,f),y.bindBuffer(y.ARRAY_BUFFER,Lt),y.bufferData(y.ARRAY_BUFFER,_,y.STATIC_DRAW),y.vertexAttribPointer(ge.aPosition,2,y.FLOAT,!1,we,0),y.vertexAttribPointer(ge.aNormal,2,y.FLOAT,!1,we,gi),y.vertexAttribPointer(ge.aMiter,1,y.FLOAT,!1,we,xe),y.drawArrays(y.TRIANGLE_STRIP,0,_.length/5),y.disableVertexAttribArray(ge.aPosition),y.disableVertexAttribArray(ge.aNormal),y.disableVertexAttribArray(ge.aMiter)},et=dc(y,`
##head
void main(){
##matrix
}`,`
##head
##mask
uniform vec4 uColor;uniform vec4 uCanvasColor;void main(){vec4 fillColor=uColor;
##maskapply
fillColor.rgb*=fillColor.a;fillColor.rgb*=m;fillColor.rgb+=(1.0-m)*(uCanvasColor.rgb*fillColor.a);fragColor=fillColor;}`,["aPosition"],["uColor","uCanvasColor","uMatrix","uMaskBounds","uMaskOpacity"]),ht=y.createBuffer(),Y=dc(y,`
##head
##text
in vec2 aRectCoord;out vec2 vRectCoord;void main(){vTexCoord=aTexCoord;vRectCoord=aRectCoord;
##matrix
}`,`
##head
##mask
in vec2 vTexCoord;in vec2 vRectCoord;uniform sampler2D uTexture;uniform vec4 uTextureColor;uniform float uTextureOpacity;uniform vec2 uRepeat;uniform vec4 uColor;uniform float uCornerRadius[4];uniform vec2 uSize;uniform vec2 uPosition;uniform vec4 uCanvasColor;uniform int uInverted;uniform float uEdgeFeather;void main(){
##init
##colorize
##rectaa
##cornerradius
##maskfeatherapply
if(uInverted==1)a=1.0-a;
##maskapply
##fragcolor
}`,["aPosition","aTexCoord","aRectCoord"],["uTexture","uColor","uMatrix","uCanvasColor","uTextureColor","uTextureOpacity","uRepeat","uPosition","uSize","uMaskBounds","uMaskOpacity","uMaskFeather","uCornerRadius","uInverted","uEdgeFeather"]),Z=y.createBuffer(),St=y.createBuffer(),nt=y.createBuffer(),mt=dc(y,`
##head
##text
out vec2 vTexCoordDouble;void main(){vTexCoordDouble=vec2(aTexCoord.x*2.0-1.0,aTexCoord.y*2.0-1.0);vTexCoord=aTexCoord;
##matrix
}`,`
##head
##mask
in vec2 vTexCoord;in vec2 vTexCoordDouble;uniform sampler2D uTexture;uniform float uTextureOpacity;uniform vec2 uRepeat;uniform vec2 uRadius;uniform vec4 uColor;uniform int uInverted;uniform vec4 uCanvasColor;void main(){
##init
float ar=uRadius.x/uRadius.y;vec2 rAA=vec2(uRadius.x-1.0,uRadius.y-(1.0/ar));vec2 scaledPointSq=vec2((vTexCoordDouble.x*uRadius.x)*(vTexCoordDouble.x*uRadius.x),(vTexCoordDouble.y*uRadius.y)*(vTexCoordDouble.y*uRadius.y));float p=(scaledPointSq.x/(uRadius.x*uRadius.x))+(scaledPointSq.y/(uRadius.y*uRadius.y));float pAA=(scaledPointSq.x/(rAA.x*rAA.x))+(scaledPointSq.y/(rAA.y*rAA.y));a=smoothstep(1.0,p/pAA,p);if(uInverted==1)a=1.0-a;
##maskapply
##fragcolor
}`,["aPosition","aTexCoord"],["uTexture","uTextureOpacity","uRepeat","uColor","uCanvasColor","uMatrix","uRadius","uInverted","uMaskBounds","uMaskOpacity"]),Ft=y.createBuffer(),oe=y.createBuffer(),Rt=new Map,Ut={2:{width:0,height:0},1:{width:0,height:0}},Ot=(yt,Gt,ue,pe=1)=>{const ve=Math.min(Math.min(4096,o)/ue.width,Math.min(4096,o)/ue.height,pe),ge=Math.floor(ve*ue.width),_=Math.floor(ve*ue.height);Tc(ue,Ut[yt])?y.bindFramebuffer(y.FRAMEBUFFER,Gt):(y.bindTexture(y.TEXTURE_2D,T.get(yt)),y.texImage2D(y.TEXTURE_2D,0,y.RGBA,ge,_,0,y.RGBA,y.UNSIGNED_BYTE,null),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MIN_FILTER,y.LINEAR),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_S,y.CLAMP_TO_EDGE),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_T,y.CLAMP_TO_EDGE),y.bindFramebuffer(y.FRAMEBUFFER,Gt),y.framebufferTexture2D(y.FRAMEBUFFER,y.COLOR_ATTACHMENT0,y.TEXTURE_2D,T.get(yt),0),Ut[yt]=ue);const we=ue.width*s,gi=ue.height*s;var xe,_t;hp(d,0,we,gi,0,-1,1),Xs(d,0,gi,0),_t=1,(xe=d)[0]*=_t,xe[1]*=_t,xe[2]*=_t,xe[3]*=_t,((Te,Ie)=>{Te[4]*=Ie,Te[5]*=Ie,Te[6]*=Ie,Te[7]*=Ie})(d,-1),u=d,y.viewport(0,0,ge,_),y.colorMask(!0,!0,!0,!0),y.clearColor(0,0,0,0),y.clear(y.COLOR_BUFFER_BIT),v=[1,0,1,0,1,Math.max(n.width,ue.width),1,Math.max(n.width,ue.width)]},j=(yt,Gt)=>{const{forceRelease:ue=!1}=Gt||{},{src:pe}=Rt.get(yt);pe instanceof HTMLCanvasElement&&(ue||pe.dataset.retain||Jn(pe)),Rt.delete(yt),y.deleteTexture(yt)},wt=yt=>Rt.get(yt).isRotatedVideo;return{drawPath:(yt,Gt=0,ue=!1,pe=!1,ve,ge,_,we,gi)=>{if(yt.length<2)return;const xe=yt.map(He=>({x:He.x*s,y:He.y*s})),_t=ve*s;if(_t>0&&ct(xe,_t,Zs(ge,gi),_),xe.length<3||!we||we[3]===0||!_)return;const Te=x4(xe),Ie=new Float32Array(6*Te.length);Te.forEach(([He,vi,vt],bt)=>{const Ze=6*bt;Ie[Ze+0]=He.x,Ie[Ze+1]=He.y,Ie[Ze+2]=vi.x,Ie[Ze+3]=vi.y,Ie[Ze+4]=vt.x,Ie[Ze+5]=vt.y}),((He,vi)=>{const{program:vt,locations:bt}=et;y.useProgram(vt),y.enableVertexAttribArray(bt.aPosition),y.uniform4fv(bt.uColor,vi),y.uniformMatrix4fv(bt.uMatrix,!1,u),y.uniform1fv(bt.uMaskBounds,x),y.uniform1f(bt.uMaskOpacity,f),y.uniform4f(bt.uCanvasColor,C,P,I,O),y.bindBuffer(y.ARRAY_BUFFER,ht),y.bufferData(y.ARRAY_BUFFER,He,y.STATIC_DRAW),y.vertexAttribPointer(bt.aPosition,2,y.FLOAT,!1,0,0),y.drawArrays(y.TRIANGLES,0,He.length/2),y.disableVertexAttribArray(bt.aPosition)})(Ie,Zs(we,gi))},drawRect:(yt,Gt=0,ue=!1,pe=!1,ve,ge,_,we,gi,xe=!1,_t,Te,Ie,He,vi,vt=1/s,bt,Ze)=>{const Pe=ms(Ci(yt),s),ri=ve.map(Ge=>((ii,wi)=>Math.floor(Yi(ii,0,Math.min(.5*(wi.width-1),.5*(wi.height-1)))))(Ge||0,yt)).map(Ge=>Ge*s);if(ge||_){const Ge=Ci(Pe);Ge.x-=.5,Ge.y-=.5,Ge.width+=1,Ge.height+=1;const ii=l$(Ge,Gt,ue,pe),wi=s$(ii);let pi;bt&&(pi=Zs(bt),pi[3]===0&&(pi[3]=.001));const Fi=we&&xe?[Ge.width/we.width,Ge.height/we.height]:[1,1];((X,jt,U,Bt,ye,Qt=V,se,zt=1,We=$p,Ae=fc,je=v,Ke=1,it)=>{const{program:Xt,locations:Nt}=Y;y.useProgram(Xt),y.enableVertexAttribArray(Nt.aPosition),y.enableVertexAttribArray(Nt.aTexCoord),y.enableVertexAttribArray(Nt.aRectCoord),y.uniform4fv(Nt.uColor,ye),y.uniform2fv(Nt.uSize,[jt,U]),y.uniform2fv(Nt.uPosition,[X[2],X[3]]),y.uniform2fv(Nt.uRepeat,se),y.uniform1i(Nt.uInverted,it?1:0),y.uniform1fv(Nt.uCornerRadius,Bt),y.uniform4f(Nt.uCanvasColor,C,P,I,O),y.uniform1fv(Nt.uMaskFeather,je.map((Zt,Yt)=>Yt%2==0?Zt:Zt*s)),y.uniform1fv(Nt.uMaskBounds,x),y.uniform1f(Nt.uMaskOpacity,f),y.uniform1f(Nt.uEdgeFeather,Math.max(0,Ke)),y.uniformMatrix4fv(Nt.uMatrix,!1,u),y.uniform1i(Nt.uTexture,4),y.uniform4fv(Nt.uTextureColor,We),y.uniform1f(Nt.uTextureOpacity,zt),y.activeTexture(y.TEXTURE0+4),y.bindTexture(y.TEXTURE_2D,Qt),y.bindBuffer(y.ARRAY_BUFFER,St),y.bufferData(y.ARRAY_BUFFER,Ae,y.STATIC_DRAW),y.vertexAttribPointer(Nt.aTexCoord,2,y.FLOAT,!1,0,0),y.bindBuffer(y.ARRAY_BUFFER,nt),y.bufferData(y.ARRAY_BUFFER,fc,y.STATIC_DRAW),y.vertexAttribPointer(Nt.aRectCoord,2,y.FLOAT,!1,0,0),y.bindBuffer(y.ARRAY_BUFFER,Z),y.bufferData(y.ARRAY_BUFFER,X,y.STATIC_DRAW),y.vertexAttribPointer(Nt.aPosition,2,y.FLOAT,!1,0,0),y.drawArrays(y.TRIANGLE_STRIP,0,X.length/2),y.disableVertexAttribArray(Nt.aPosition),y.disableVertexAttribArray(Nt.aTexCoord),y.disableVertexAttribArray(Nt.aRectCoord)})(wi,Ge.width,Ge.height,ri,Zs(ge,He),_,Fi,He,pi,_t?new Float32Array(_t):d$(Ge.width,Ge.height,we,gi,s),vi,vt*s,Ze)}Te&&(Te=Math.min(Te,Pe.width,Pe.height),ct(((Ge,ii,wi,pi,Fi,X,jt,U)=>{const Bt=[];if(X.every(ye=>ye===0))Bt.push(rt(Ge,ii),rt(Ge+wi,ii),rt(Ge+wi,ii+pi),rt(Ge,ii+pi));else{const[ye,Qt,se,zt]=X,We=Ge,Ae=Ge+wi,je=ii,Ke=ii+pi;Bt.push(rt(We+ye,je)),Dd(Bt,Ae-Qt,je+Qt,Qt,-1),Bt.push(rt(Ae,je+Qt)),Dd(Bt,Ae-zt,Ke-zt,zt,0),Bt.push(rt(Ae-zt,Ke)),Dd(Bt,We+se,Ke-se,se,1),Bt.push(rt(We,Ke-se)),Dd(Bt,We+ye,je+ye,ye,2)}return(jt||U)&&Ml(Bt,jt,U,Ge+.5*wi,ii+.5*pi),Fi&&tl(Bt,Fi,Ge+.5*wi,ii+.5*pi),Bt})(Pe.x,Pe.y,Pe.width,Pe.height,Gt,ri,ue,pe),Te*s,Zs(Ie,He),!0))},drawEllipse:(yt,Gt,ue,pe,ve,ge,_,we,gi,xe,_t,Te,Ie,He,vi)=>{const vt=ms(In(yt.x-Gt,yt.y-ue,2*Gt,2*ue),s);if(_||we){const bt=Ci(vt);bt.x-=.5,bt.y-=.5,bt.width+=1,bt.height+=1;const Ze=l$(bt,pe,ve,ge);((Pe,ri,Ge,ii,wi=V,pi=fc,Fi=1,X=!1)=>{const{program:jt,locations:U}=mt;y.useProgram(jt),y.enableVertexAttribArray(U.aPosition),y.enableVertexAttribArray(U.aTexCoord),y.uniformMatrix4fv(U.uMatrix,!1,u),y.uniform2fv(U.uRadius,[.5*ri,.5*Ge]),y.uniform1i(U.uInverted,X?1:0),y.uniform4fv(U.uColor,ii),y.uniform4f(U.uCanvasColor,C,P,I,O),y.uniform2fv(U.uRepeat,[1,1]),y.uniform1fv(U.uMaskBounds,x),y.uniform1f(U.uMaskOpacity,f),y.uniform1i(U.uTexture,4),y.uniform1f(U.uTextureOpacity,Fi),y.activeTexture(y.TEXTURE0+4),y.bindTexture(y.TEXTURE_2D,wi),y.bindBuffer(y.ARRAY_BUFFER,oe),y.bufferData(y.ARRAY_BUFFER,pi,y.STATIC_DRAW),y.vertexAttribPointer(U.aTexCoord,2,y.FLOAT,!1,0,0),y.bindBuffer(y.ARRAY_BUFFER,Ft),y.bufferData(y.ARRAY_BUFFER,Pe,y.STATIC_DRAW),y.vertexAttribPointer(U.aPosition,2,y.FLOAT,!1,0,0),y.drawArrays(y.TRIANGLE_STRIP,0,Pe.length/2),y.disableVertexAttribArray(U.aPosition),y.disableVertexAttribArray(U.aTexCoord)})(s$(Ze),bt.width,bt.height,Zs(_,He),we,_t?new Float32Array(_t):d$(bt.width,bt.height,gi,xe,s),He,vi)}Te&&ct(((bt,Ze,Pe,ri,Ge,ii,wi)=>{const pi=.5*Math.abs(Pe),Fi=.5*Math.abs(ri),X=Math.abs(Pe)+Math.abs(ri),jt=Math.max(20,Math.round(X/6));return ru(rt(bt+pi,Ze+Fi),pi,Fi,Ge,ii,wi,jt)})(vt.x,vt.y,vt.width,vt.height,pe,ve,ge),Te*s,Zs(Ie,He),!0)},drawImage:(yt,Gt,ue,pe,ve,ge,_,we,gi,xe,_t=w4,Te=1,Ie,He=1,vi=0,vt=k,bt=S4,Ze=$p,Pe=!1,ri=!1,Ge=!0)=>{const ii=Gt.width*s,wi=Gt.height*s,pi=-.5*ii,Fi=.5*wi,X=.5*ii,jt=-.5*wi,U=new Float32Array([pi,jt,0,pi,Fi,0,X,jt,0,X,Fi,0]);y.bindBuffer(y.ARRAY_BUFFER,lt),y.bufferData(y.ARRAY_BUFFER,U,y.STATIC_DRAW);const Bt=Gt.height/2/B*(n.height/Gt.height)*-1;ve*=s,ge*=s,ue*=s,pe*=s;const{program:ye,locations:Qt}=ut,se=pp();((Xt,Nt,Zt,Yt,ot)=>{const he=1/Math.tan(Nt/2),ie=1/(Yt-ot);Xt[0]=he/Zt,Xt[1]=0,Xt[2]=0,Xt[3]=0,Xt[4]=0,Xt[5]=he,Xt[6]=0,Xt[7]=0,Xt[8]=0,Xt[9]=0,Xt[10]=(ot+Yt)*ie,Xt[11]=-1,Xt[12]=0,Xt[13]=0,Xt[14]=2*ot*Yt*ie,Xt[15]=0})(se,F,a,1,2*-Bt),Xs(se,ve,-ge,Bt),Xs(se,ue,-pe,0),o$(se,-gi),i$(se,xe),Xs(se,-ue,pe,0),r$(se,we),n$(se,_),y.useProgram(ye),y.enableVertexAttribArray(Qt.aPosition),y.enableVertexAttribArray(Qt.aTexCoord),y.uniform1i(Qt.uTexture,3),y.uniform2f(Qt.uTextureSize,Gt.width,Gt.height),y.activeTexture(y.TEXTURE0+3),y.bindTexture(y.TEXTURE_2D,yt);const zt=ri?1:0,We=T.get(zt);y.uniform1i(Qt.uTextureBlend,zt),y.activeTexture(y.TEXTURE0+zt),y.bindTexture(y.TEXTURE_2D,We);const Ae=Pe?2:0,je=T.get(Ae);y.uniform1i(Qt.uTextureOverlay,Ae),y.activeTexture(y.TEXTURE0+Ae),y.bindTexture(y.TEXTURE_2D,je),y.bindBuffer(y.ARRAY_BUFFER,lt),y.vertexAttribPointer(Qt.aPosition,3,y.FLOAT,!1,0,0);const Ke=v4&&wt(yt);let it;y.bindBuffer(y.ARRAY_BUFFER,Ke?ft:N),y.vertexAttribPointer(Qt.aTexCoord,2,y.FLOAT,!1,0,0),y.uniformMatrix4fv(Qt.uMatrix,!1,se),y.uniform4fv(Qt.uOverlayColor,Ze),!Ie||Ja(Ie,c$)?(Ie=c$,it=-1):(it=Ie.reduce((Xt,Nt)=>Xt+Nt,0),it=it<=0?1:it),y.uniform1fv(Qt.uClarityKernel,Ie),y.uniform1f(Qt.uClarityKernelWeight,it),y.uniform1f(Qt.uColorGamma,1/He),y.uniform1f(Qt.uColorVignette,vi),y.uniform1i(Qt.uAntialias,Ge?1:0),y.uniform4f(Qt.uColorOffset,_t[4],_t[9],_t[14],_t[19]),y.uniformMatrix4fv(Qt.uColorMatrix,!1,[_t[0],_t[1],_t[2],_t[3],_t[5],_t[6],_t[7],_t[8],_t[10],_t[11],_t[12],_t[13],_t[15],_t[16],_t[17],_t[18]]),y.uniform1f(Qt.uOpacity,Te),y.uniform1f(Qt.uMaskOpacity,f),y.uniform1fv(Qt.uMaskBounds,x),y.uniform1fv(Qt.uMaskCornerRadius,bt.map(Xt=>Xt*s)),y.uniform1fv(Qt.uMaskFeather,vt.map((Xt,Nt)=>Nt%2==0?Xt:Xt*s)),y.drawArrays(y.TRIANGLE_STRIP,0,4),y.disableVertexAttribArray(Qt.aPosition),y.disableVertexAttribArray(Qt.aTexCoord)},textureFilterNearest:y.NEAREST,textureFilterLinear:y.LINEAR,textureClamp:y.CLAMP_TO_EDGE,textureRepeat:y.REPEAT,textureCreate:()=>y.createTexture(),textureUpdate:(yt,Gt,ue)=>(Rt.set(yt,{src:Gt,options:ue,isRotatedVideo:Gt.nodeName==="VIDEO"&&(Gt.dataset&&Gt.dataset.rotation==90||Gt.dataset.rotation==270)}),g4(y,yt,Gt,ue)),textureGetSize:yt=>{const{src:Gt,options:ue}=Rt.get(yt),pe=Ea(Gt);return ue.scalar?Ya(pe,ve=>ve/ue.scalar):pe},textureDelete:j,enablePreviewStencil:()=>{y.stencilOp(y.KEEP,y.KEEP,y.REPLACE),y.stencilFunc(y.ALWAYS,1,255),y.stencilMask(255)},applyPreviewStencil:()=>{y.stencilFunc(y.EQUAL,1,255),y.stencilMask(0)},disablePreviewStencil:L,setCanvasColor(yt){C=yt[0],P=yt[1],I=yt[2],O=i?yt[3]:1,y.clear(y.COLOR_BUFFER_BIT)},resetCanvasMatrix:()=>{hp(c,0,n.width,n.height,0,-1,1)},updateCanvasMatrix(yt,Gt,ue,pe,ve){const ge=yt.width,_=yt.height,we=n.width*(.5/s),gi=n.height*(.5/s),xe={x:we+(ue.x+Gt.x),y:gi+(ue.y+Gt.y)},_t={x:xe.x-Gt.x,y:xe.y-Gt.y},Te=.5*ge,Ie=.5*_;qr(_t,ve.z,xe),jx(_t,pe,xe),Xs(c,(_t.x-Te)*s,(_t.y-Ie)*s,0),Xs(c,Te*s,Ie*s,0),o$(c,ve.z);const He=ve.x>Math.PI/2;n$(c,He?Math.PI:0);const vi=ve.y>Math.PI/2;r$(c,vi?Math.PI:0),i$(c,pe),Xs(c,-Te*s,-Ie*s,0)},drawToCanvas(){y.bindFramebuffer(y.FRAMEBUFFER,null),u=c,y.viewport(0,0,y.drawingBufferWidth,y.drawingBufferHeight),y.colorMask(!0,!0,!0,!0),y.clearColor(C,P,I,O),y.clear(y.COLOR_BUFFER_BIT),v=[1,0,1,0,1,n.width,1,n.width]},drawToImageBlendBuffer(yt,Gt){Ot(1,K,yt,Gt)},drawToImageOverlayBuffer(yt,Gt){Ot(2,S,yt,Gt)},enableMask(yt,Gt){const ue=yt.x*s,pe=yt.y*s,ve=yt.width*s,ge=yt.height*s;m=ue,h=m+ve,p=n.height-pe,g=n.height-(pe+ge),f=1-Gt,x=[p,h,g,m]},disableMask(){m=0,h=n.width,p=n.height,g=0,f=1,x=[p,h,g,m]},resize:(yt,Gt,ue)=>{s=Math.max(1,ue),l=s===1?.75:1,r.width=yt,r.height=Gt,n.width=yt*s,n.height=Gt*s,a=Qo(n.width,n.height),t.width=n.width,t.height=n.height,hp(c,0,n.width,n.height,0,-1,1),k=[1,0,1,0,1,r.width,1,r.width]},release(){Array.from(Rt.keys()).forEach(yt=>j(yt,{forceRelease:!0})),Rt.clear(),T.forEach(yt=>{y.deleteTexture(yt)}),T.clear(),ut.destroy(),$t.destroy(),et.destroy(),Y.destroy(),mt.destroy(),t.width=1,t.height=1,t=void 0}}},C4=(t,e)=>{const{imageData:i,amount:n=1}=t,r=Math.round(2*Math.max(1,n)),o=Math.round(.5*r),a=i.width,s=i.height,l=new Uint8ClampedArray(a*s*4),c=i.data;let d,u,p,h,g,m=0,f=0,x=0;const k=a*s*4-4;for(p=0;p<s;p++)for(d=crypto.getRandomValues(new Uint8ClampedArray(s)),u=0;u<a;u++)h=d[p]/255,f=0,x=0,h<.5&&(f=4*(-o+Math.round(Math.random()*r))),h>.5&&(x=(-o+Math.round(Math.random()*r))*(4*a)),g=Math.min(Math.max(0,m+f+x),k),l[m]=c[g],l[m+1]=c[g+1],l[m+2]=c[g+2],l[m+3]=c[g+3],m+=4;e(null,{data:l,width:i.width,height:i.height})};const T4=[.0625,.125,.0625,.125,.25,.125,.0625,.125,.0625];function M4(t){return Math.sqrt(1- --t*t)}function u$(t){return Object.prototype.toString.call(t)==="[object Date]"}function Up(t,e){if(t===e||t!=t)return()=>t;const i=typeof t;if(i!==typeof e||Array.isArray(t)!==Array.isArray(e))throw new Error("Cannot interpolate values of different type");if(Array.isArray(t)){const n=e.map((r,o)=>Up(t[o],r));return r=>n.map(o=>o(r))}if(i==="object"){if(!t||!e)throw new Error("Object cannot be null");if(u$(t)&&u$(e)){t=t.getTime();const o=(e=e.getTime())-t;return a=>new Date(t+a*o)}const n=Object.keys(e),r={};return n.forEach(o=>{r[o]=Up(t[o],e[o])}),o=>{const a={};return n.forEach(s=>{a[s]=r[s](o)}),a}}if(i==="number"){const n=e-t;return r=>t+r*n}throw new Error(`Cannot interpolate ${i} values`)}function Dh(t,e={}){const i=le(t);let n,r=t;function o(a,s){if(t==null)return i.set(t=a),Promise.resolve();r=a;let l=n,c=!1,{delay:d=0,duration:u=400,easing:p=Th,interpolate:h=Up}=Cn(Cn({},e),s);if(u===0)return l&&(l.abort(),l=null),i.set(t=r),Promise.resolve();const g=Ey()+d;let m;return n=Ph(f=>{if(f<g)return!0;c||(m=h(t,a),typeof u=="function"&&(u=u(t,a)),c=!0),l&&(l.abort(),l=null);const x=f-g;return x>u?(i.set(t=a),!1):(i.set(t=m(p(x/u))),!0)}),n.promise}return{set:o,update:(a,s)=>o(a(r,t),s),subscribe:i.subscribe}}function Gp(t,e,i,n){if(typeof i=="number"){const r=n-i,o=(i-e)/(t.dt||1/60),a=(o+(t.opts.stiffness*r-t.opts.damping*o)*t.inv_mass)*t.dt;return Math.abs(a)<t.opts.precision&&Math.abs(r)<t.opts.precision?n:(t.settled=!1,i+a)}if(En(i))return i.map((r,o)=>Gp(t,e[o],i[o],n[o]));if(typeof i=="object"){const r={};for(const o in i)r[o]=Gp(t,e[o],i[o],n[o]);return r}throw new Error(`Cannot spring ${typeof i} values`)}function ai(t,e={}){const i=le(t),{stiffness:n=.15,damping:r=.8,precision:o=.01}=e;let a,s,l,c=t,d=t,u=1,p=0,h=!1;function g(f,x={}){d=f;const k=l={};if(t==null||x.hard||m.stiffness>=1&&m.damping>=1)return h=!0,a=null,c=f,i.set(t=d),Promise.resolve();if(x.soft&&(p=1/(60*(x.soft===!0?.5:+x.soft)),u=0),!s){a=null,h=!1;const v={inv_mass:void 0,opts:m,settled:!0,dt:void 0};s=Ph(C=>{if(a===null&&(a=C),h)return h=!1,s=null,!1;u=Math.min(u+p,1),v.inv_mass=u,v.opts=m,v.settled=!0,v.dt=60*(C-a)/1e3;const P=Gp(v,c,t,d);return a=C,c=t,i.set(t=P),v.settled&&(s=null),!v.settled})}return new Promise(v=>{s.promise.then(()=>{k===l&&v()})})}const m={set:g,update:(f,x)=>g(f(d,t),x),subscribe:i.subscribe,stiffness:n,damping:r,precision:o};return m}var P4=kl(!1,t=>{const e=window.matchMedia("(prefers-reduced-motion:reduce)"),i=()=>t(e.matches);return i(),e.addListener(i),()=>e.removeListener(i)}),p$=()=>"ResizeObserver"in window;const gp=hs(),n2=(t,e,i,n,r)=>{t.rect||(t.rect=hs());const o=t.rect;Yf(gp,e,i,n,r),ia(o,gp)||(gu(o,gp),t.dispatchEvent(new CustomEvent("measure",{detail:o})))},Od=Math.round,R4=t=>{const e=t.getBoundingClientRect();fa&&n2(t,Od(e.x),Od(e.y),Od(e.width),Od(e.height))},fp=t=>{fa&&n2(t,t.offsetLeft,t.offsetTop,t.offsetWidth,t.offsetHeight)},Sc=[];let Ys,ga,fa;function Zp(){Sc.length?(Sc.forEach(t=>t.measure(t)),fa=requestAnimationFrame(Zp)):fa=void 0}let Wd=new Map([]),uc=0,yp=0;var Mr=(t,e={})=>{const{observePosition:i=!1,observeViewRect:n=!1,once:r=!1,disabled:o=!1,isMeasureRoot:a=!1}=e;if(p$()&&a&&(ga||(ga=new ResizeObserver(s=>{s.forEach(c=>{Wd.set(c.target,c.contentRect)});const l=Array.from(Wd.values()).some(({width:c,height:d})=>c>0&&d>0);l?l&&fa===!1&&Zp():(fa&&cancelAnimationFrame(fa),fa=!1)})),ga.observe(t),uc++),!o)return!p$()||i||n?(t.measure=n?R4:fp,Sc.push(t),fa===void 0&&(fa=requestAnimationFrame(Zp)),t.measure(t),{destroy(){a&&ga&&(Wd.delete(t),ga.unobserve(t),uc--,uc===0&&(ga.disconnect(),ga=void 0));const s=Sc.indexOf(t);Sc.splice(s,1),delete t.measure}}):(Ys||(Ys=new ResizeObserver(s=>{s.forEach(l=>{fa&&fp(l.target)})})),Ys.observe(t),fp(t),r?Ys.unobserve(t):yp++,{destroy(){a&&ga&&(Wd.delete(t),ga.unobserve(t),uc--,uc===0&&(ga.disconnect(),ga=void 0)),r||(Ys.unobserve(t),yp--,yp===0&&(Ys.disconnect(),Ys=void 0))}})},I4=t=>{let e=!1;const i={pointerdown:()=>{e=!1},keydown:()=>{e=!0},keyup:()=>{e=!1},focus:n=>{e&&(n.target.dataset.focusVisible="")},blur:n=>{delete n.target.dataset.focusVisible}};return Object.keys(i).forEach(n=>t.addEventListener(n,i[n],!0)),{destroy(){Object.keys(i).forEach(n=>t.removeEventListener(n,i[n],!0))}}};const E4=async t=>new Promise(e=>{if(t.kind==="file")return e(t.getAsFile());t.getAsString(e)});var r2=(t,e={})=>{const i=r=>{r.preventDefault()},n=async r=>{r.preventDefault(),r.stopPropagation();try{const o=await(a=>new Promise((s,l)=>{const{items:c}=a.dataTransfer;if(!c)return s([]);Promise.all(Array.from(c).map(E4)).then(d=>{s(d.filter(u=>Ll(u)&&fu(u)||/^http/.test(u)))}).catch(l)}))(r);t.dispatchEvent(new CustomEvent("dropfiles",{detail:{event:r,resources:o},...e}))}catch{}};return t.addEventListener("drop",n),t.addEventListener("dragover",i),{destroy(){t.removeEventListener("drop",n),t.removeEventListener("dragover",i)}}};let _d=null;var Bh=()=>{if(_d===null)if(Lr()){const t=ln("canvas");_d=!vu(t,{failIfMajorPerformanceCaveat:!0}),Jn(t)}else _d=!1;return _d},xp=t=>t instanceof WebGLTexture,h$=([t,e,i,n])=>[n.x,n.y,t.x,t.y,i.x,i.y,e.x,e.y];function A4(t){let e,i,n,r;return{c(){e=pt("div"),i=pt("canvas"),w(e,"class","PinturaCanvas")},m(o,a){tt(o,e,a),Tt(e,i),t[36](i),n||(r=[Mt(i,"measure",t[37]),Ui(Mr.call(null,i))],n=!0)},p:Qe,i:Qe,o:Qe,d(o){o&&Q(e),t[36](null),n=!1,_i(r)}}}function L4(t,e,i){let n,r,o,a,s,l,c;const d=[0,0,0,0],u=Qi(),p=Lr()&&(X=>{const jt=.5*X,U=ln("canvas",{"data-retain":!0,width:X,height:X}),Bt=U.getContext("2d");return Bt.fillStyle="#f0f",Bt.fillRect(0,0,jt,jt),Bt.fillRect(jt,jt,jt,jt),U})(128),h=Sa();let g,{isAnimated:m}=e,{isTransparent:f}=e,{maskRect:x}=e,{maskOpacity:k=1}=e,{maskFrameOpacity:v=.95}=e,{maskMarkupOpacity:C=1}=e,{clipAnnotationsToImage:P=!0}=e,{pixelRatio:I=1}=e,{textPixelRatio:O=I}=e,{backgroundColor:T}=e,{willRender:L=Xi}=e,{didRender:F=Xi}=e,{willRequest:B}=e,{loadImageData:y=Xi}=e,{enableGrid:V=!1}=e,{gridColors:J}=e,{gridSize:S}=e,{gridOpacity:H=0}=e,{images:K=[]}=e,{interfaceImages:ut=[]}=e,{selectionColor:lt}=e,N=null,ft=null,$t=null;const Lt=(X,jt)=>X.set(jt,{hard:!m}),ct={precision:1e-4*.01};let et=0;const ht=Dh(void 0,{duration:0});A(t,ht,X=>i(35,c=X));const Y=ai(1,ct);A(t,Y,X=>i(34,s=X));const Z=ai(1,ct);A(t,Z,X=>i(50,o=X));const St=le();A(t,St,X=>i(52,l=X));const nt=le();A(t,nt,X=>i(51,a=X));const mt={},Ft=(X,jt)=>{let U=mt[X.id];const Bt=Math.min(1,2048/jt.width);let ye=U?U.element:ln("canvas",{width:jt.width*Bt,height:jt.height*Bt,"data-retain":!0});if(!U||((Qt,se)=>{if(Qt.total!==se.length)return!0;const zt=Qt.last,We=se[se.length-1];return zt.drawMode!==We.drawMode||!(!ko(zt)||ko(We)&&ia(zt,We))||!(!Kn(zt)||Kn(We)&&zt.x===We.x&&zt.y===We.y&&zt.rx===We.rx&&zt.ry===We.ry)||!(!Yn(zt)||Yn(We)&&We.points.length===zt.points.length)})(U,X.actions)){ye=ye.cloneNode(),((se,zt,We)=>{const{selectionColor:Ae=[1,1,1],scalar:je=1}=We||{};let Ke=!1;for(const it of zt){const Xt=it.drawMode==="subtract";if(Xt&&!Ke)continue;se.globalCompositeOperation=Xt?"destination-out":"source-over",se.save(),se.beginPath();const Nt=Sy(it);ly(se,je,je),gh(se,it.rotation,Nt),Cy(se,it.flipX,it.flipY,Nt),it.width?wh(se,{...it,backgroundColor:Ae}):it.points?Vp(se,Object.assign({},it,it.pathClose?{backgroundColor:Ae,strokeColor:[0,0,0,0]}:{strokeColor:Ae,strokeJoin:"round",strokeCap:"round"})):it.rx&&Sh(se,{...it,backgroundColor:Ae,strokeColor:[0,0,0,0],strokeJoin:"round",strokeCap:"round"}),se.restore(),Ke=!0}})(ye.getContext("2d"),X.actions,{selectionColor:[1,0,1],scalar:Bt});const Qt=X.actions.length;mt[X.id]={total:Qt,last:{...X.actions[Qt-1]},element:ye}}return{x:0,y:0,...jt,fillColor:X.color||[1,1,1],backgroundImage:ye}};let oe;const Rt=()=>{cancelAnimationFrame(oe),oe=requestAnimationFrame(()=>{He=!0,pi=0,r()})},Ut=new Map([]),Ot=new Map([]),j=(X,jt)=>({filterParam:X==="pixelated"?N.textureFilterNearest:N.textureFilterLinear,wrapParam:jt==="repeat"?N.textureRepeat:N.textureClamp}),wt=(X,jt,U)=>{if(!Ut.has(X)){Ut.set(X,X);const Qt=j(jt,U);if(!Oe(Bt=X)&&(ay(Bt)||Il(Bt)||Bc(Bt)||ou(Bt))){const se=N.textureCreate();N.textureUpdate(se,X,Qt),Ut.set(X,se)}else y(X).then(se=>{if(!N||!se)return;const zt=N.textureCreate();N.textureUpdate(zt,se,Qt),Ut.set(X,zt),Rt()}).catch(se=>{Ut.set(X,se)})}var Bt,ye;if(ou(X)&&((ye=X).currentTime>0&&!ye.paused&&!ye.ended&&ye.readyState>2||X.dataset.redraw==="true")){const Qt=Ut.get(X),se=j(jt,U);return N.textureUpdate(Qt,X,se),X.dataset.redraw=!1,Qt}return Ut.get(X)},yt=(X,jt={})=>{const U=jt.id||X.id;if(!X.text.length)return void Ot.delete(U);let{text:Bt,textAlign:ye,fontFamily:Qt,fontSize:se=16,fontWeight:zt,fontVariant:We,fontStyle:Ae,letterSpacing:je,lineHeight:Ke=se,width:it,height:Xt}=X,{outline:Nt=0,blur:Zt=0,paddingTop:Yt=0,paddingRight:ot=Kr,paddingBottom:he=0,paddingLeft:ie=Kr}=jt;it=xi(it)?Math.floor(it):it,Xt=xi(Xt)?Math.floor(Xt):Xt;const{textSize:fe,signature:Dt}=((hi="",Be)=>{let{width:yi=0,height:Pi="auto",fontSize:be,fontFamily:me,lineHeight:Ee,fontWeight:an,fontStyle:Gi,fontVariant:fn,letterSpacing:hn}=Be;const mn=Yd({text:hi,fontFamily:me,fontWeight:an,fontStyle:Gi,fontVariant:fn,fontSize:be,lineHeight:Ee,letterSpacing:hn,width:yi,height:Pi});let en=xm.get(mn);if(en)return en;let qi=1;be>1e3&&va()&&(qi=be/1e3,be=1e3,Ee*=qi);const Ln=hh(ln("pre",{contenteditable:"true",spellcheck:"false",style:`${hy}${yh({fontFamily:me,fontWeight:an,fontStyle:Gi,fontVariant:fn,fontSize:be,letterSpacing:hn,lineHeight:Ee})};${xh(hi,Be)}"`,innerHTML:hi})),Gn=Ln.getBoundingClientRect();return en={signature:py(Ln).flat().map(Nn=>Nn.text).join("_;_"),textSize:Ya(Ea(Gn),Nn=>Math.ceil(Nn*qi))},xm.set(mn,en),Ln.remove(),en})(Bt,{...X,width:it,height:void 0}),ke=Yd({text:Bt,textAlign:ye,fontFamily:Qt,fontSize:se,fontWeight:zt,fontVariant:We,fontStyle:Ae,lineHeight:Ke,letterSpacing:je,outline:Nt,blur:Zt,signature:Dt});if(!Ut.has(ke)){Ut.set(ke,Bt);const hi=Math.ceil(fe.width),Be=Math.ceil(fe.height/Ke)*Ke;if(hi===0||Be===0)return;const yi=zh(),Pi=Math.min(1,(yi-(ie+ot)*O)/(hi*O),(yi-(Yt+he)*O)/(Be*O));$y(Bt,{fontSize:se,fontFamily:Qt,fontWeight:zt,fontVariant:We,fontStyle:Ae,letterSpacing:je,textAlign:ye,lineHeight:Ke,width:it,height:Xt,imageWidth:hi,imageHeight:Be,paddingLeft:ie,paddingTop:Yt,paddingRight:ot,paddingBottom:he,pixelRatio:O*Pi,willRequest:B,outline:Nt,blur:Zt,color:[1,0,1]}).then(be=>{if(!N)return;const me=N.textureCreate();N.textureUpdate(me,be,{filterParam:N.textureFilterLinear,wrapParam:N.textureClamp,scalar:Pi}),Ut.set(ke,me),Ot.set(U,me),Rt()}).catch(console.error)}const fi=Ut.get(ke);return xp(fi)?fi:Ot.get(U)},Gt=new Map,ue=(X,jt)=>{let U;if(X.backgroundImage)U=wt(X.backgroundImage,X.backgroundImageRendering,X.backgroundRepeat==="repeat"?"repeat":void 0);else if(Oe(X.text)){if(X.width&&X.width<1||X.height&&X.height<1)return;U=yt(X,jt)}else X.bitmap&&X.points&&(U=(Bt=>{const{id:ye,points:Qt,strokeWidth:se,strokeCap:zt,strokeJoin:We,strokeColor:Ae}=Bt;let je=Ut.get(ye),Ke=Gt.get(ye);const it=Yd({points:Qt.map(Dt=>`${Dt.x},${Dt.y}`).join(","),strokeWidth:se,strokeCap:zt,strokeJoin:We,strokeColor:Ae});if(Ke){const{hash:Dt}=Ke;if(Ut.has(ye)){if(it===Dt)return Ut.get(ye)}else Ke=void 0}if(!Ke){const Dt=ln("canvas",{width:1,height:1});Ke={canvas:Dt,hash:void 0},Gt.set(Bt.id,Ke),je=N.textureCreate(),N.textureUpdate(je,Dt,{filterParam:N.textureFilterLinear,wrapParam:N.textureClamp}),Ut.set(ye,je)}const{canvas:Xt}=Ke,Nt=Math.ceil(Bt.strokeWidth),Zt=rr(Qt),Yt=Math.floor(Zt.x)-.5*Nt,ot=Math.floor(Zt.y)-.5*Nt,he=Math.ceil(Zt.width+Nt),ie=Math.ceil(Zt.height+Nt);Xt.width=Math.max(he,1),Xt.height=Math.max(ie,1);const fe=Xt.getContext("2d");return fe.clearRect(0,0,Xt.width,Xt.height),he>=1&&ie>=1&&(fe.translate(-Yt,-ot),Vp(fe,Bt),fe.resetTransform()),N.textureUpdate(je,Xt,{filterParam:N.textureFilterLinear,wrapParam:N.textureClamp}),Gt.set(ye,{canvas:Xt,hash:it}),Ut.get(ye)})(X));return U},pe=({texture:X,size:jt,origin:U,translation:Bt,rotation:ye,scale:Qt,colorMatrix:se,opacity:zt,convolutionMatrix:We,gamma:Ae,vignette:je,maskFeather:Ke,maskCornerRadius:it,overlayColor:Xt,enableOverlay:Nt,enableManipulation:Zt,enableAntialiasing:Yt})=>{let ot=0,he=0;if(I===1){const ie=Math.abs(1-Qt)<Number.EPSILON;ot=ie&&ft%2!=0?.5:0,he=ie&&$t%2!=0?.5:0}return N.drawImage(X,jt,U.x,U.y,Bt.x+ot,Bt.y+he,ye.x,ye.y,ye.z,Qt,se,Yi(zt,0,1),We,Ae,je,Ke,it,Xt,Nt,Zt,Yt),X},ve=(X,jt,U,Bt,ye,Qt,se,zt,We)=>{const Ae={...jt},je={width:ye.width/O*U,height:ye.height/O*U},Ke=rt(0,0),it={width:je.width,height:je.height};return Ae.x-=We*U,Ae.y-=Qt*U,X.width?(Ae.height=Ae.height?Ae.height+Qt*U/Bt:je.height,Ae.width+=(We+se)*U/Bt,X.textAlign==="center"?Ke.x=.5*(Ae.width-it.width/Bt):X.textAlign==="right"&&(Ke.x=Ae.width-it.width/Bt)):(Ae.width=je.width,Ae.height=je.height),{rect:Ae,backgroundPosition:Ke,backgroundSize:it}},ge=(X=[],jt)=>{X.forEach(U=>{let Bt=ue(U);const ye=U.status==="loading"||U.backgroundImage&&Bt===U.backgroundImage;ye&&Rt();const Qt=U.status==="error"||U.backgroundImage&&Bt instanceof Error;let se=xp(Bt)?Bt:void 0;const zt=U._scale||1,We=U._translate||u,Ae=U.strokeWidth&&U.strokeWidth*zt,je=!!U.width,Ke=!je&&Oe(U.text)&&se,it=En(U.points),Xt=Kn(U);if(it){const Nt=U.points.map(Zt=>rt(Zt.x*zt+We.x,Zt.y*zt+We.y));if(U.bitmap){Bt&&jt.push(Bt);const Zt=rr(Nt),Yt=Math.ceil(U.strokeWidth*zt);N.drawRect({x:Math.floor(Zt.x)-.5*Yt,y:Math.floor(Zt.y)-.5*Yt,width:Math.ceil(Zt.width+Yt),height:Math.ceil(Zt.height+Yt)},U.rotation,U.flipX,U.flipY,[0,0,0,0],void 0,se,void 0,void 0,void 0,void 0,void 0,void 0,U.opacity,void 0,void 0,!1,!1)}else N.drawPath(Nt,U.rotation,U.flipX,U.flipY,Ae,U.strokeColor,U.pathClose,U.backgroundColor,U.opacity)}else if(Xt){let Nt=U.x,Zt=U.y;Nt*=zt,Zt*=zt,Nt+=We.x,Zt+=We.y;const Yt=rt(Nt,Zt);N.drawEllipse(Yt,U.rx*zt,U.ry*zt,U.rotation,U.flipX,U.flipY,U.backgroundColor,se,void 0,void 0,U.backgroundCorners&&h$(U.backgroundCorners),Ae,U.strokeColor,U.opacity,U.inverted),Bt&&jt.push(Bt),(ye||Qt)&&(U.backgroundColor||U.strokeColor&&U.strokeWidth||N.drawEllipse(Yt,U.rx*zt,U.ry*zt,U.rotation,U.flipX,U.flipY,Qt?[1,0,0,.25*U.opacity]:[0,0,0,.25*U.opacity]),Qt&&Te(Yt),ye&&_t(Yt))}else if(Ke||je){const Nt=se&&N.textureGetSize(se);let Zt,Yt,ot,he=U.fillColor,ie=U.backgroundColor,fe=U.strokeColor,Dt=[U.cornerRadius,U.cornerRadius,U.cornerRadius,U.cornerRadius].map(fi=>fi*zt);Zt=U.width?ls(U):{x:U.x,y:U.y,...Nt},zt&&We&&(Zt.x*=zt,Zt.y*=zt,Zt.x+=We.x,Zt.y+=We.y,Zt.width*=zt,Zt.height*=zt),Bt&&jt.push(Bt);const{backgroundRepeat:ke="no-repeat"}=U;if(Nt){if(U.backgroundImage&&(U.backgroundSize||U.backgroundPosition||U.backgroundRepeat)){const fi=Qo(Nt.width,Nt.height);if(U.backgroundRepeat==="repeat"&&(Yt={...Nt},ot={x:0,y:0}),U.backgroundSize==="contain"){const hi=Jr(Zt,fi,Zt);Yt=el(hi),ot=U.backgroundPosition?U.backgroundPosition:rt(.5*(Zt.width-Yt.width),.5*(Zt.height-Yt.height))}else if(U.backgroundSize==="cover"){const hi=Ka(Zt,fi,Zt);Yt=el(hi),U.backgroundPosition?ot=U.backgroundPosition:(ot=rt(hi.x,hi.y),ot=rt(.5*(Zt.width-Yt.width),.5*(Zt.height-Yt.height)))}else U.backgroundSize?(Yt=U.backgroundSize,ot=U.backgroundPosition||{x:0,y:0}):U.backgroundPosition&&(Yt={...Nt},ot=U.backgroundPosition)}else if(U.text){const fi={...Zt};if(U.backgroundColor||U.strokeColor){ie=void 0,fe=void 0;const me={width:Nt.width/O,height:Nt.height/O},Ee=(U.width||me.width-2*Kr)*zt,an=(U.height||me.height)*zt;N.drawRect({...Zt,width:Ee,height:an},U.rotation,U.flipX,U.flipY,Dt,U.backgroundColor,void 0,void 0,void 0,!1,void 0,Ae,U.strokeColor,U.opacity,void 0,void 0,void 0,U.inverted)}let hi=1;U.fontSize>1e3&&va()&&(hi=U.fontSize/1e3),he=U.color||[0,0,0],U._prerender&&(he[3]=0);const Be=ve(U,fi,zt,hi,Nt,0,Kr,0,Kr);Zt=Be.rect,ot=Be.backgroundPosition,Yt=Be.backgroundSize;const{textShadowX:yi,textShadowY:Pi,textShadowBlur:be}=U;if(yi||Pi||be){const me=Math.ceil(.5*be),Ee=me,an=Math.max(Kr,me),Gi=me,fn=Math.max(Kr,me),hn=ue(U,{id:U.id+"shadow",blur:be,paddingTop:Ee,paddingRight:an,paddingBottom:Gi,paddingLeft:fn});if(hn&&!U._prerender){jt.push(hn);const mn=N.textureGetSize(hn),{rect:en,backgroundPosition:qi,backgroundSize:Ln}=ve(U,fi,zt,hi,mn,Ee,an,0,fn),Gn=Ti(Zt),Nn=Ti(en);Nn.x+=yi,Nn.y+=Pi;const gr=qr(Nn,U.rotation,Gn),Hn={x:gr.x-.5*en.width,y:gr.y-.5*en.height,width:en.width,height:en.height};U.height&&(Hn.height-=Pi),N.drawRect(Hn,U.rotation,U.flipX,U.flipY,[0,0,0,0],void 0,hn,Ln,qi,!1,void 0,void 0,void 0,U.opacity,void 0,0,U.textShadowColor)}}if(U.textOutlineWidth){const me=Math.ceil(.5*U.textOutlineWidth),Ee=me,an=Kr+me,Gi=me,fn=Kr+me,hn=ue(U,{id:U.id+"outline",outline:U.textOutlineWidth,paddingTop:Ee,paddingRight:an,paddingBottom:Gi,paddingLeft:fn});if(hn&&!U._prerender){const mn=N.textureGetSize(hn);jt.push(hn);const{rect:en,backgroundPosition:qi,backgroundSize:Ln}=ve(U,fi,zt,hi,mn,Ee,an,0,fn);N.drawRect(en,U.rotation,U.flipX,U.flipY,[0,0,0,0],void 0,hn,Ln,qi,!1,void 0,void 0,void 0,U.opacity,void 0,0,U.textOutlineColor)}}}}if(N.drawRect(Zt,U.rotation,U.flipX,U.flipY,Dt,ie,se,Yt,ot,ke==="repeat",U.backgroundCorners&&h$(U.backgroundCorners),Ae,fe,U.opacity,void 0,U.feather,he,U.inverted),ye||Qt){U.backgroundColor&&U.backgroundColor[3]!==0||U.strokeColor&&U.strokeWidth||N.drawRect(Zt,U.rotation,U.flipX,U.flipY,Dt,Qt?[1,.2549,.2118,.25*U.opacity]:[0,0,0,.25*U.opacity]);const fi=Ti(Zt);Qt&&Te(fi),ye&&_t(fi)}}else Bt&&jt.push(Bt)})};let _=0;const we=[{x:-5,y:-5},{x:5,y:5}],gi=[{x:5,y:-5},{x:-5,y:5}],xe=ru({x:0,y:0},10,10,0,!1,!1,16);xe.length=9;const _t=X=>{_=Date.now()/50,N.drawEllipse(X,15,15,0,!1,!1,[0,0,0,.5]);const jt=tl(xe.map(U=>({x:U.x+X.x,y:U.y+X.y})),_,X.x,X.y);N.drawPath(jt,0,!1,!1,2,[1,1,1])},Te=X=>{N.drawEllipse(X,13,13,0,!1,!1,[1,.2549,.2118,.75]);const jt=we.map(Bt=>({x:Bt.x+X.x,y:Bt.y+X.y})),U=gi.map(Bt=>({x:Bt.x+X.x,y:Bt.y+X.y}));N.drawPath(jt,0,!1,!1,3,[1,1,1]),N.drawPath(U,0,!1,!1,3,[1,1,1])},Ie=(X,jt,U,Bt,ye,Qt)=>N.drawRect(jt,0,!1,!1,d,d,X,Bt,U,!0,void 0,0,void 0,Qt,void 0,void 0,ye);let He=!1,vi=!0,vt=!1;const bt=[],Ze=[],Pe=[],ri=X=>!X.aboveFrame,Ge=X=>X.aboveFrame,ii=()=>{Pe.length=0;const X=K[0],{manipulationShapes:jt,manipulationShapesDirty:U,annotationShapes:Bt,annotationShapesDirty:ye,interfaceShapes:Qt,decorationShapes:se,frameShapes:zt,selectionShapes:We}=L({opacity:X.opacity,rotation:X.rotation,scale:X.scale,images:K,size:Vn(ft,$t),backgroundColor:[...c],selectionRect:l}),Ae=[...c],je=l,Ke=Yi(s,0,1),it=a,Xt=Math.abs(X.rotation.x/Math.PI*2-1),Nt=Math.abs(X.rotation.y/Math.PI*2-1),Zt=Xt<.99||Nt<.99,Yt={...X.size},ot=X.backgroundColor,he=X.backgroundImage,ie=jt.length>0,fe=Bt.length>0,Dt=Bt.filter(Ge).length>0,ke=se.filter(Ge).length>0,fi=ot[3]>0,hi=!!P&&C>=1;if(Ke<1&&fi){const Be=Ae[0],yi=Ae[1],Pi=Ae[2],be=1-Ke,me=ot[0]*be,Ee=ot[1]*be,an=ot[2]*be,Gi=1-be;Ae[0]=me+Be*Gi,Ae[1]=Ee+yi*Gi,Ae[2]=an+Pi*Gi,Ae[3]=1}if(N.setCanvasColor(f?d:Ae),ie&&(U||He)?(N.disableMask(),N.drawToImageBlendBuffer(Yt),bt.length=0,ge(jt,bt)):ie||(bt.length=0),Pe.push(...bt),vi&&(N.drawToImageOverlayBuffer(Yt,O),vi=!1),Zt){if(fe&&(ye||He)||!vt){N.disableMask(),N.drawToImageOverlayBuffer(Yt,O),Ze.length=0;const Be=Dt?Bt.filter(ri):Bt;ge(Be,Ze)}else fe||(Ze.length=0);vt=!0}else vt=!1;if(N.drawToCanvas(),N.enableMask(je,Ke),V&&S>=1&&J.length===2&&H&&((Be,yi,Pi,be,me)=>{const Ee=Vn(yi,yi),an=wt(p,"pixelated","repeat"),Gi=rt(-Be.x%yi,-Be.y%yi),fn=rt(Gi.x+.5*Ee.width,Gi.y);Ie(an,Be,Gi,Ee,Pi,me),Ie(an,Be,fn,Ee,be,me)})(je,S,J[0],J[1],H),fi&&N.drawRect(je,0,!1,!1,d,ot),he){N.enableMask(je,1);const Be=Math.max(x.width/he.width,x.height/he.height),yi=he.width*Be,Pi=he.height*Be,be={x:x.x+.5*x.width-.5*yi,y:x.y+.5*x.height-.5*Pi,width:yi,height:Pi};N.drawRect(be,0,!1,!1,d,d,wt(he,"linear")),N.enableMask(je,Ke)}if(hi&&N.enablePreviewStencil(),Pe.push(...[...K].reverse().map(Be=>pe({...Be,texture:wt(Be.data),enableOverlay:Zt&&fe,enableManipulation:ie,enableAntialiasing:!0,mask:je,maskOpacity:Ke,overlayColor:it}))),N.enableMask(je,C),!Zt){hi&&N.applyPreviewStencil(),N.resetCanvasMatrix(),N.updateCanvasMatrix(Yt,X.origin,X.translation,X.scale,X.rotation),Ze.length=0;const Be=Dt?Bt.filter(ri):Bt;ge(Be,Ze),hi&&N.disablePreviewStencil()}if(Pe.push(...Ze),N.resetCanvasMatrix(),N.enableMask(je,C),ge(se,ke?se.filter(ri):se),zt.length){N.enableMask(je,1);const Be=zt.filter(Pi=>!Pi.expandsCanvas),yi=zt.filter(Pi=>Pi.expandsCanvas);Be.length&&ge(Be,Pe),yi.length&&(N.enableMask({x:je.x+.5,y:je.y+.5,width:je.width-1,height:je.height-1},o),ge(yi,Pe))}if(Dt&&(N.resetCanvasMatrix(),N.updateCanvasMatrix(Yt,X.origin,X.translation,X.scale,X.rotation),ge(Bt.filter(Ge),Pe),N.resetCanvasMatrix()),ke&&(N.resetCanvasMatrix(),ge(se.filter(Ge),Pe),N.resetCanvasMatrix()),lt&&We.length&&!Zt){N.resetCanvasMatrix(),N.updateCanvasMatrix(Yt,X.origin,X.translation,X.scale,X.rotation);const Be=[...lt];Be[3]=.5;const yi=[{id:"selection",color:Be,actions:[...We]}].map(Pi=>Ft(Pi,Yt));ge(yi,Pe),N.resetCanvasMatrix()}N.disableMask(),ge(Qt,Pe),ut.forEach(Be=>{if(N.enableMask(Be.mask,Be.maskOpacity),Be.backgroundColor){const Pi=he&&Ka({...Be.mask},he.width/he.height),be=he&&wt(he,"linear");N.drawRect(Be.mask,0,!1,!1,Be.maskCornerRadius,Be.backgroundColor,be,Pi,Pi,void 0,void 0,void 0,void 0,Be.opacity,Be.maskFeather),be&&Pe.push(be)}const yi=pe({...Be,texture:wt(Be.data),enableAntialiasing:!1,translation:{x:Be.translation.x+Be.offset.x-.5*ft,y:Be.translation.y+Be.offset.y-.5*$t}});Pe.push(yi)}),N.disableMask(),(Be=>{Ut.forEach((yi,Pi)=>{!Be.find(be=>be===yi)&&xp(yi)&&(Array.from(Ot.values()).includes(yi)||(Ut.delete(Pi),N.textureDelete(yi)))})})(Pe),F(),He=!1};let wi,pi=0;const Fi=()=>{clearTimeout(wi);const X=Date.now();X-pi<48?wi=setTimeout(Fi,48):(pi=X,ii())};return Db(()=>r()),ws(()=>i(30,N=k4(g,{alpha:f}))),No(()=>{N&&(Gt.forEach(({canvas:X})=>Jn(X)),Gt.clear(),N.release(),i(30,N=void 0),i(0,g=void 0))}),t.$$set=X=>{"isAnimated"in X&&i(9,m=X.isAnimated),"isTransparent"in X&&i(10,f=X.isTransparent),"maskRect"in X&&i(11,x=X.maskRect),"maskOpacity"in X&&i(12,k=X.maskOpacity),"maskFrameOpacity"in X&&i(13,v=X.maskFrameOpacity),"maskMarkupOpacity"in X&&i(14,C=X.maskMarkupOpacity),"clipAnnotationsToImage"in X&&i(15,P=X.clipAnnotationsToImage),"pixelRatio"in X&&i(16,I=X.pixelRatio),"textPixelRatio"in X&&i(17,O=X.textPixelRatio),"backgroundColor"in X&&i(18,T=X.backgroundColor),"willRender"in X&&i(19,L=X.willRender),"didRender"in X&&i(20,F=X.didRender),"willRequest"in X&&i(21,B=X.willRequest),"loadImageData"in X&&i(22,y=X.loadImageData),"enableGrid"in X&&i(23,V=X.enableGrid),"gridColors"in X&&i(24,J=X.gridColors),"gridSize"in X&&i(25,S=X.gridSize),"gridOpacity"in X&&i(26,H=X.gridOpacity),"images"in X&&i(27,K=X.images),"interfaceImages"in X&&i(28,ut=X.interfaceImages),"selectionColor"in X&&i(29,lt=X.selectionColor)},t.$$.update=()=>{if(1&t.$$.dirty[0]&&g){const X=getComputedStyle(g).getPropertyValue("--color-transition-duration");i(31,et=(jt=>{let U=parseFloat(jt);return/^[0-9]+s$/.test(jt)?1e3*U:U})(X))}262656&t.$$.dirty[0]|1&t.$$.dirty[1]&&T&&ht.set(T,{duration:m?et:0}),4096&t.$$.dirty[0]&&Lt(Y,xi(k)?k:1),8192&t.$$.dirty[0]&&Lt(Z,xi(v)?v:1),2048&t.$$.dirty[0]&&x&&St.set(x),24&t.$$.dirty[1]&&c&&nt.set([c[0],c[1],c[2],Yi(s,0,1)]),1207959558&t.$$.dirty[0]&&i(33,n=!!(N&&ft&&$t&&K.length)),1073807366&t.$$.dirty[0]&&ft&&$t&&N&&(pi=0,N.resize(ft,$t,I)),4&t.$$.dirty[1]&&i(32,r=n?Bh()?Fi:ii:$e),6&t.$$.dirty[1]&&n&&r&&r()},[g,ft,$t,h,ht,Y,Z,St,nt,m,f,x,k,v,C,P,I,O,T,L,F,B,y,V,J,S,H,K,ut,lt,N,et,r,n,s,c,function(X){zi[X?"unshift":"push"](()=>{g=X,i(0,g)})},X=>{i(1,ft=X.detail.width),i(2,$t=X.detail.height),h("measure",{width:ft,height:$t})}]}class z4 extends li{constructor(e){super(),si(this,e,L4,A4,ei,{isAnimated:9,isTransparent:10,maskRect:11,maskOpacity:12,maskFrameOpacity:13,maskMarkupOpacity:14,clipAnnotationsToImage:15,pixelRatio:16,textPixelRatio:17,backgroundColor:18,willRender:19,didRender:20,willRequest:21,loadImageData:22,enableGrid:23,gridColors:24,gridSize:25,gridOpacity:26,images:27,interfaceImages:28,selectionColor:29},null,[-1,-1,-1])}}var ui=(t,e=Boolean,i=" ")=>t.filter(e).join(i);function m$(t,e,i){const n=t.slice();return n[17]=e[i],n}const F4=t=>({tab:4&t}),$$=t=>({tab:t[17]});function g$(t){let e,i,n,r=[],o=new Map,a=t[2];const s=l=>l[17].id;for(let l=0;l<a.length;l+=1){let c=m$(t,a,l),d=s(c);o.set(d,r[l]=f$(d,c))}return{c(){e=pt("ul");for(let l=0;l<r.length;l+=1)r[l].c();w(e,"class",i=ui(["PinturaTabList",t[0]])),w(e,"role","tablist"),w(e,"data-layout",t[1])},m(l,c){tt(l,e,c);for(let d=0;d<r.length;d+=1)r[d].m(e,null);t[14](e),n=!0},p(l,c){1124&c&&(a=l[2],Fe(),r=Aa(r,c,s,1,l,a,o,e,Ss,f$,null,m$),De()),(!n||1&c&&i!==(i=ui(["PinturaTabList",l[0]])))&&w(e,"class",i),(!n||2&c)&&w(e,"data-layout",l[1])},i(l){if(!n){for(let c=0;c<a.length;c+=1)M(r[c]);n=!0}},o(l){for(let c=0;c<r.length;c+=1)D(r[c]);n=!1},d(l){l&&Q(e);for(let c=0;c<r.length;c+=1)r[c].d();t[14](null)}}}function f$(t,e){let i,n,r,o,a,s,l,c,d,u;const p=e[11].default,h=sr(p,e,e[10],$$);function g(...f){return e[12](e[17],...f)}function m(...f){return e[13](e[17],...f)}return{key:t,first:null,c(){i=pt("li"),n=pt("button"),h&&h.c(),o=de(),w(n,"type","button"),n.disabled=r=e[17].disabled,w(i,"role","tab"),w(i,"aria-controls",a=e[17].href.substr(1)),w(i,"id",s=e[17].tabId),w(i,"aria-selected",l=e[17].selected),this.first=i},m(f,x){tt(f,i,x),Tt(i,n),h&&h.m(n,null),Tt(i,o),c=!0,d||(u=[Mt(n,"keydown",g),Mt(n,"click",m)],d=!0)},p(f,x){e=f,h&&h.p&&(!c||1028&x)&&cr(h,p,e,e[10],c?lr(p,e[10],x,F4):dr(e[10]),$$),(!c||4&x&&r!==(r=e[17].disabled))&&(n.disabled=r),(!c||4&x&&a!==(a=e[17].href.substr(1)))&&w(i,"aria-controls",a),(!c||4&x&&s!==(s=e[17].tabId))&&w(i,"id",s),(!c||4&x&&l!==(l=e[17].selected))&&w(i,"aria-selected",l)},i(f){c||(M(h,f),c=!0)},o(f){D(h,f),c=!1},d(f){f&&Q(i),h&&h.d(f),d=!1,_i(u)}}}function D4(t){let e,i,n=t[4]&&g$(t);return{c(){n&&n.c(),e=Tn()},m(r,o){n&&n.m(r,o),tt(r,e,o),i=!0},p(r,[o]){r[4]?n?(n.p(r,o),16&o&&M(n,1)):(n=g$(r),n.c(),M(n,1),n.m(e.parentNode,e)):n&&(Fe(),D(n,1,1,()=>{n=null}),De())},i(r){i||(M(n),i=!0)},o(r){D(n),i=!1},d(r){n&&n.d(r),r&&Q(e)}}}function B4(t,e,i){let n,r,o,{$$slots:a={},$$scope:s}=e,{class:l}=e,{name:c}=e,{selected:d}=e,{tabs:u=[]}=e,{layout:p}=e;const h=Sa(),g=x=>{const k=o.querySelectorAll('[role="tab"] button')[x];k&&k.focus()},m=(x,k)=>{x.preventDefault(),x.stopPropagation(),h("select",k)},f=({key:x},k)=>{if(!/arrow/i.test(x))return;const v=u.findIndex(C=>C.id===k);return/right|down/i.test(x)?g(v<u.length-1?v+1:0):/left|up/i.test(x)?g(v>0?v-1:u.length-1):void 0};return t.$$set=x=>{"class"in x&&i(0,l=x.class),"name"in x&&i(7,c=x.name),"selected"in x&&i(8,d=x.selected),"tabs"in x&&i(9,u=x.tabs),"layout"in x&&i(1,p=x.layout),"$$scope"in x&&i(10,s=x.$$scope)},t.$$.update=()=>{896&t.$$.dirty&&i(2,n=u.map(x=>{const k=x.id===d;return{...x,tabId:`tab-${c}-${x.id}`,href:`#panel-${c}-${x.id}`,selected:k}})),4&t.$$.dirty&&i(4,r=n.length>1)},[l,p,n,o,r,m,f,c,d,u,s,a,(x,k)=>f(k,x.id),(x,k)=>m(k,x.id),function(x){zi[x?"unshift":"push"](()=>{o=x,i(3,o)})}]}class wu extends li{constructor(e){super(),si(this,e,B4,D4,ei,{class:0,name:7,selected:8,tabs:9,layout:1})}}const O4=t=>({panel:16&t}),y$=t=>({panel:t[4][0].id,panelIsActive:!0});function x$(t,e,i){const n=t.slice();return n[14]=e[i].id,n[15]=e[i].shouldDraw,n[16]=e[i].panelId,n[17]=e[i].tabindex,n[18]=e[i].labelledBy,n[19]=e[i].isActive,n[20]=e[i].hidden,n[3]=e[i].visible,n}const W4=t=>({panel:16&t,panelIsActive:16&t}),b$=t=>({panel:t[14],panelIsActive:t[19]});function _4(t){let e,i,n,r,o,a;const s=t[11].default,l=sr(s,t,t[10],y$);return{c(){e=pt("div"),i=pt("div"),l&&l.c(),w(i,"class",n=ui([t[1]])),w(e,"class",t[0]),w(e,"style",t[2])},m(c,d){tt(c,e,d),Tt(e,i),l&&l.m(i,null),r=!0,o||(a=[Mt(e,"measure",t[13]),Ui(Mr.call(null,e))],o=!0)},p(c,d){l&&l.p&&(!r||1040&d)&&cr(l,s,c,c[10],r?lr(s,c[10],d,O4):dr(c[10]),y$),(!r||2&d&&n!==(n=ui([c[1]])))&&w(i,"class",n),(!r||1&d)&&w(e,"class",c[0]),(!r||4&d)&&w(e,"style",c[2])},i(c){r||(M(l,c),r=!0)},o(c){D(l,c),r=!1},d(c){c&&Q(e),l&&l.d(c),o=!1,_i(a)}}}function V4(t){let e,i,n,r,o,a=[],s=new Map,l=t[4];const c=d=>d[14];for(let d=0;d<l.length;d+=1){let u=x$(t,l,d),p=c(u);s.set(p,a[d]=w$(p,u))}return{c(){e=pt("div");for(let d=0;d<a.length;d+=1)a[d].c();w(e,"class",i=ui(["PinturaTabPanels",t[0]])),w(e,"style",t[2])},m(d,u){tt(d,e,u);for(let p=0;p<a.length;p+=1)a[p].m(e,null);n=!0,r||(o=[Mt(e,"measure",t[12]),Ui(Mr.call(null,e,{observePosition:!0}))],r=!0)},p(d,u){1042&u&&(l=d[4],Fe(),a=Aa(a,u,c,1,d,l,s,e,Ss,w$,null,x$),De()),(!n||1&u&&i!==(i=ui(["PinturaTabPanels",d[0]])))&&w(e,"class",i),(!n||4&u)&&w(e,"style",d[2])},i(d){if(!n){for(let u=0;u<l.length;u+=1)M(a[u]);n=!0}},o(d){for(let u=0;u<a.length;u+=1)D(a[u]);n=!1},d(d){d&&Q(e);for(let u=0;u<a.length;u+=1)a[u].d();r=!1,_i(o)}}}function v$(t){let e;const i=t[11].default,n=sr(i,t,t[10],b$);return{c(){n&&n.c()},m(r,o){n&&n.m(r,o),e=!0},p(r,o){n&&n.p&&(!e||1040&o)&&cr(n,i,r,r[10],e?lr(i,r[10],o,W4):dr(r[10]),b$)},i(r){e||(M(n,r),e=!0)},o(r){D(n,r),e=!1},d(r){n&&n.d(r)}}}function w$(t,e){let i,n,r,o,a,s,l,c,d,u=e[15]&&v$(e);return{key:t,first:null,c(){i=pt("div"),u&&u.c(),n=de(),w(i,"class",r=ui(["PinturaTabPanel",e[1]])),i.hidden=o=e[20],w(i,"id",a=e[16]),w(i,"tabindex",s=e[17]),w(i,"aria-labelledby",l=e[18]),w(i,"data-inert",c=!e[3]),this.first=i},m(p,h){tt(p,i,h),u&&u.m(i,null),Tt(i,n),d=!0},p(p,h){(e=p)[15]?u?(u.p(e,h),16&h&&M(u,1)):(u=v$(e),u.c(),M(u,1),u.m(i,n)):u&&(Fe(),D(u,1,1,()=>{u=null}),De()),(!d||2&h&&r!==(r=ui(["PinturaTabPanel",e[1]])))&&w(i,"class",r),(!d||16&h&&o!==(o=e[20]))&&(i.hidden=o),(!d||16&h&&a!==(a=e[16]))&&w(i,"id",a),(!d||16&h&&s!==(s=e[17]))&&w(i,"tabindex",s),(!d||16&h&&l!==(l=e[18]))&&w(i,"aria-labelledby",l),(!d||16&h&&c!==(c=!e[3]))&&w(i,"data-inert",c)},i(p){d||(M(u),d=!0)},o(p){D(u),d=!1},d(p){p&&Q(i),u&&u.d()}}}function N4(t){let e,i,n,r;const o=[V4,_4],a=[];function s(l,c){return l[5]?0:1}return e=s(t),i=a[e]=o[e](t),{c(){i.c(),n=Tn()},m(l,c){a[e].m(l,c),tt(l,n,c),r=!0},p(l,[c]){let d=e;e=s(l),e===d?a[e].p(l,c):(Fe(),D(a[d],1,1,()=>{a[d]=null}),De(),i=a[e],i?i.p(l,c):(i=a[e]=o[e](l),i.c()),M(i,1),i.m(n.parentNode,n))},i(l){r||(M(i),r=!0)},o(l){D(i),r=!1},d(l){a[e].d(l),l&&Q(n)}}}function H4(t,e,i){let n,r,{$$slots:o={},$$scope:a}=e,{class:s}=e,{name:l}=e,{selected:c}=e,{panelClass:d}=e,{panels:u=[]}=e,{visible:p}=e,{style:h}=e;const g={};return t.$$set=m=>{"class"in m&&i(0,s=m.class),"name"in m&&i(6,l=m.name),"selected"in m&&i(7,c=m.selected),"panelClass"in m&&i(1,d=m.panelClass),"panels"in m&&i(8,u=m.panels),"visible"in m&&i(3,p=m.visible),"style"in m&&i(2,h=m.style),"$$scope"in m&&i(10,a=m.$$scope)},t.$$.update=()=>{968&t.$$.dirty&&i(4,n=u.map(m=>{const f=m===c;f&&i(9,g[m]=!0,g);const x=p?p.indexOf(m)!==-1:f;return{id:m,panelId:`panel-${l}-${m}`,labelledBy:`tab-${l}-${m}`,isActive:f,hidden:!f,visible:x,tabindex:f?0:-1,shouldDraw:f||g[m]}})),16&t.$$.dirty&&i(5,r=n.length>1)},[s,d,h,p,n,r,l,c,u,g,a,o,function(m){jr.call(this,t,m)},function(m){jr.call(this,t,m)}]}class Su extends li{constructor(e){super(),si(this,e,H4,N4,ei,{class:0,name:6,selected:7,panelClass:1,panels:8,visible:3,style:2})}}var Oh=t=>{const e=Object.getOwnPropertyDescriptors(t.prototype);return Object.keys(e).filter(i=>!!e[i].get)};function S$(t){let e,i,n,r;const o=[t[4]];function a(c){t[22](c)}var s=t[10];function l(c){let d={};for(let u=0;u<o.length;u+=1)d=Cn(d,o[u]);return c[2]!==void 0&&(d.name=c[2]),{props:d}}return s&&(e=du(s,l(t)),zi.push(()=>mo(e,"name",a)),t[23](e),e.$on("measure",t[11])),{c(){e&&At(e.$$.fragment),n=Tn()},m(c,d){e&&It(e,c,d),tt(c,n,d),r=!0},p(c,d){const u=16&d[0]?Tr(o,[zr(c[4])]):{};if(!i&&4&d[0]&&(i=!0,u.name=c[2],To(()=>i=!1)),s!==(s=c[10])){if(e){Fe();const p=e;D(p.$$.fragment,1,0,()=>{Et(p,1)}),De()}s?(e=du(s,l(c)),zi.push(()=>mo(e,"name",a)),c[23](e),e.$on("measure",c[11]),At(e.$$.fragment),M(e.$$.fragment,1),It(e,n.parentNode,n)):e=null}else s&&e.$set(u)},i(c){r||(e&&M(e.$$.fragment,c),r=!0)},o(c){e&&D(e.$$.fragment,c),r=!1},d(c){t[23](null),c&&Q(n),e&&Et(e,c)}}}function j4(t){let e,i,n,r=t[5]&&S$(t);return{c(){e=pt("div"),r&&r.c(),w(e,"data-util",t[2]),w(e,"class",i=ui(["PinturaUtilPanel",t[1]])),w(e,"style",t[6])},m(o,a){tt(o,e,a),r&&r.m(e,null),t[24](e),n=!0},p(o,a){o[5]?r?(r.p(o,a),32&a[0]&&M(r,1)):(r=S$(o),r.c(),M(r,1),r.m(e,null)):r&&(Fe(),D(r,1,1,()=>{r=null}),De()),(!n||4&a[0])&&w(e,"data-util",o[2]),(!n||2&a[0]&&i!==(i=ui(["PinturaUtilPanel",o[1]])))&&w(e,"class",i),(!n||64&a[0])&&w(e,"style",o[6])},i(o){n||(M(r),n=!0)},o(o){D(r),n=!1},d(o){o&&Q(e),r&&r.d(),t[24](null)}}}function U4(t,e,i){let n,r,o,a,s,l;const c=Sa();let{isActive:d=!0}=e,{stores:u}=e,{content:p}=e,{component:h}=e,{locale:g}=e,{class:m}=e;const f=sn("isAnimated");let x;A(t,f,H=>i(21,l=H));const k=ai(0),v=Ei(k,H=>Yi(H,0,1));A(t,v,H=>i(20,s=H));let C=!d;const P=le(d);A(t,P,H=>i(25,a=H));const I={isActive:Ei(P,async(H,K)=>{if(!H)return K(H);await By(),K(H)}),isActiveFraction:Ei(v,H=>H),isVisible:Ei(v,H=>H>0)},O=p.view,T=Oh(O),L=Object.keys(p.props||{}).reduce((H,K)=>(T.includes(K)&&(H[K]=p.props[K]),H),{}),F=Object.keys(I).reduce((H,K)=>(T.includes(K)&&(H[K]=I[K]),H),{});let B,y;const V=H=>{i(17,x={...H.detail}),S&&d&&c("measure",{...x})};wo("measurable",Mr);const J=rl().$$.context;let S=!1;return ws(()=>{if(i(19,S=!0),o)return;i(0,h=new O({target:y,props:{...r},context:J})),i(2,B=h.name);const H=h.$on("measure",V);return()=>{H(),h.$destroy()}}),t.$$set=H=>{"isActive"in H&&i(12,d=H.isActive),"stores"in H&&i(13,u=H.stores),"content"in H&&i(14,p=H.content),"component"in H&&i(0,h=H.component),"locale"in H&&i(15,g=H.locale),"class"in H&&i(1,m=H.class)},t.$$.update=()=>{135169&t.$$.dirty[0]&&x&&d&&h&&c("measure",x),2101248&t.$$.dirty[0]&&k.set(d?1:0,{hard:l===!1}),1310720&t.$$.dirty[0]&&(s<=0&&!C?i(18,C=!0):s>0&&C&&i(18,C=!1)),786432&t.$$.dirty[0]&&S&&c(C?"hide":"show"),1048576&t.$$.dirty[0]&&c("fade",s),1048576&t.$$.dirty[0]&&i(6,n=s<1?"opacity: "+s:void 0),4096&t.$$.dirty[0]&&Ct(P,a=d,a),40960&t.$$.dirty[0]&&i(4,r={...L,...F,stores:u,locale:g})},i(5,o=!T.includes("external")),[h,m,B,y,r,o,n,f,v,P,O,V,d,u,p,g,k,x,C,S,s,l,function(H){B=H,i(2,B)},function(H){zi[H?"unshift":"push"](()=>{h=H,i(0,h)})},function(H){zi[H?"unshift":"push"](()=>{y=H,i(3,y)})}]}class o2 extends li{constructor(e){super(),si(this,e,U4,j4,ei,{isActive:12,stores:13,content:14,component:0,locale:15,class:1,opacity:16},null,[-1,-1])}get opacity(){return this.$$.ctx[16]}}function G4(t){let e,i,n;const r=t[5].default,o=sr(r,t,t[4],null);return{c(){e=Cr("svg"),o&&o.c(),w(e,"class",t[3]),w(e,"style",t[2]),w(e,"width",t[0]),w(e,"height",t[1]),w(e,"viewBox",i="0 0 "+t[0]+`
    `+t[1]),w(e,"xmlns","http://www.w3.org/2000/svg"),w(e,"aria-hidden","true"),w(e,"focusable","false"),w(e,"stroke-linecap","round"),w(e,"stroke-linejoin","round")},m(a,s){tt(a,e,s),o&&o.m(e,null),n=!0},p(a,[s]){o&&o.p&&(!n||16&s)&&cr(o,r,a,a[4],n?lr(r,a[4],s,null):dr(a[4]),null),(!n||8&s)&&w(e,"class",a[3]),(!n||4&s)&&w(e,"style",a[2]),(!n||1&s)&&w(e,"width",a[0]),(!n||2&s)&&w(e,"height",a[1]),(!n||3&s&&i!==(i="0 0 "+a[0]+`
    `+a[1]))&&w(e,"viewBox",i)},i(a){n||(M(o,a),n=!0)},o(a){D(o,a),n=!1},d(a){a&&Q(e),o&&o.d(a)}}}function Z4(t,e,i){let{$$slots:n={},$$scope:r}=e,{width:o=24}=e,{height:a=24}=e,{style:s}=e,{class:l}=e;return t.$$set=c=>{"width"in c&&i(0,o=c.width),"height"in c&&i(1,a=c.height),"style"in c&&i(2,s=c.style),"class"in c&&i(3,l=c.class),"$$scope"in c&&i(4,r=c.$$scope)},[o,a,s,l,r,n]}class Mo extends li{constructor(e){super(),si(this,e,Z4,G4,ei,{width:0,height:1,style:2,class:3})}}var a2=(t,e)=>e===t.target||e.contains(t.target),k$=(t,e,i)=>{const n=Oe(e)?e:t;return i?`${n} (${r=i,r.map(o=>o==="CMD"?yu()?"⌘":"Ctrl":o).join("+")})`:n;var r};function C$(t){let e,i;return e=new Mo({props:{class:"PinturaButtonIcon",$$slots:{default:[X4]},$$scope:{ctx:t}}}),{c(){At(e.$$.fragment)},m(n,r){It(e,n,r),i=!0},p(n,r){const o={};536870920&r&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){D(e.$$.fragment,n),i=!1},d(n){Et(e,n)}}}function X4(t){let e;return{c(){e=Cr("g")},m(i,n){tt(i,e,n),e.innerHTML=t[3]},p(i,n){8&n&&(e.innerHTML=i[3])},d(i){i&&Q(e)}}}function T$(t){let e;return{c(){e=pt("span"),w(e,"class",t[11])},m(i,n){tt(i,e,n),e.innerHTML=t[0]},p(i,n){1&n&&(e.innerHTML=i[0]),2048&n&&w(e,"class",i[11])},d(i){i&&Q(e)}}}function Y4(t){let e,i,n,r,o;const a=t[27].default,s=sr(a,t,t[29],null),l=s||function(c){let d,u,p,h=c[3]&&C$(c),g=c[0]&&T$(c);return{c(){d=pt("span"),h&&h.c(),u=de(),g&&g.c(),w(d,"class",c[13])},m(m,f){tt(m,d,f),h&&h.m(d,null),Tt(d,u),g&&g.m(d,null),p=!0},p(m,f){m[3]?h?(h.p(m,f),8&f&&M(h,1)):(h=C$(m),h.c(),M(h,1),h.m(d,u)):h&&(Fe(),D(h,1,1,()=>{h=null}),De()),m[0]?g?g.p(m,f):(g=T$(m),g.c(),g.m(d,null)):g&&(g.d(1),g=null),(!p||8192&f)&&w(d,"class",m[13])},i(m){p||(M(h),p=!0)},o(m){D(h),p=!1},d(m){m&&Q(d),h&&h.d(),g&&g.d()}}}(t);return{c(){e=pt("button"),l&&l.c(),w(e,"type",t[6]),w(e,"style",t[4]),e.disabled=t[5],w(e,"class",t[12]),w(e,"title",i=k$(t[0],t[1],t[2]))},m(c,d){tt(c,e,d),l&&l.m(e,null),t[28](e),n=!0,r||(o=[Mt(e,"keydown",function(){ji(t[8])&&t[8].apply(this,arguments)}),Mt(e,"click",function(){ji(t[7])&&t[7].apply(this,arguments)}),Mt(e,"pointerdown",function(){ji(t[14])&&t[14].apply(this,arguments)}),Ui(t[9].call(null,e))],r=!0)},p(c,[d]){t=c,s?s.p&&(!n||536870912&d)&&cr(s,a,t,t[29],n?lr(a,t[29],d,null):dr(t[29]),null):l&&l.p&&(!n||10249&d)&&l.p(t,n?d:-1),(!n||64&d)&&w(e,"type",t[6]),(!n||16&d)&&w(e,"style",t[4]),(!n||32&d)&&(e.disabled=t[5]),(!n||4096&d)&&w(e,"class",t[12]),(!n||7&d&&i!==(i=k$(t[0],t[1],t[2])))&&w(e,"title",i)},i(c){n||(M(l,c),n=!0)},o(c){D(l,c),n=!1},d(c){c&&Q(e),l&&l.d(c),t[28](null),r=!1,_i(o)}}}function q4(t,e,i){let n,r,o,a,s,l,{$$slots:c={},$$scope:d}=e,{class:u}=e,{label:p}=e,{title:h}=e,{shortcut:g}=e,{labelClass:m}=e,{innerClass:f}=e,{hideLabel:x=!1}=e,{icon:k}=e,{style:v}=e,{disabled:C}=e,{type:P="button"}=e,{onclick:I}=e,{onkeydown:O}=e,{onhold:T}=e,{action:L=()=>{}}=e,{holdThreshold:F=500}=e,{holdSpeedUpFactor:B=.5}=e,{holdSpeedMin:y=20}=e;const V=S=>{i(25,l=setTimeout(()=>{T(),V(Math.max(S*B,y))},S))};let J;return t.$$set=S=>{"class"in S&&i(15,u=S.class),"label"in S&&i(0,p=S.label),"title"in S&&i(1,h=S.title),"shortcut"in S&&i(2,g=S.shortcut),"labelClass"in S&&i(16,m=S.labelClass),"innerClass"in S&&i(17,f=S.innerClass),"hideLabel"in S&&i(18,x=S.hideLabel),"icon"in S&&i(3,k=S.icon),"style"in S&&i(4,v=S.style),"disabled"in S&&i(5,C=S.disabled),"type"in S&&i(6,P=S.type),"onclick"in S&&i(7,I=S.onclick),"onkeydown"in S&&i(8,O=S.onkeydown),"onhold"in S&&i(19,T=S.onhold),"action"in S&&i(9,L=S.action),"holdThreshold"in S&&i(20,F=S.holdThreshold),"holdSpeedUpFactor"in S&&i(21,B=S.holdSpeedUpFactor),"holdSpeedMin"in S&&i(22,y=S.holdSpeedMin),"$$scope"in S&&i(29,d=S.$$scope)},t.$$.update=()=>{101187584&t.$$.dirty&&i(26,r=T?()=>{l&&(clearTimeout(l),i(25,l=void 0),document.documentElement.removeEventListener("pointerup",r))}:$e),68681728&t.$$.dirty&&i(14,n=T?()=>{document.documentElement.addEventListener("pointerup",r),V(F)}:$e),131072&t.$$.dirty&&i(13,o=ui(["PinturaButtonInner",f])),294912&t.$$.dirty&&i(12,a=ui(["PinturaButton",x&&"PinturaButtonIconOnly",u])),327680&t.$$.dirty&&i(11,s=ui([x?"implicit":"PinturaButtonLabel",m]))},[p,h,g,k,v,C,P,I,O,L,J,s,a,o,n,u,m,f,x,T,F,B,y,S=>a2(S,J),()=>J,l,r,c,function(S){zi[S?"unshift":"push"](()=>{J=S,i(10,J)})},d]}class ks extends li{constructor(e){super(),si(this,e,q4,Y4,ei,{class:15,label:0,title:1,shortcut:2,labelClass:16,innerClass:17,hideLabel:18,icon:3,style:4,disabled:5,type:6,onclick:7,onkeydown:8,onhold:19,action:9,holdThreshold:20,holdSpeedUpFactor:21,holdSpeedMin:22,isEventTarget:23,getElement:24})}get isEventTarget(){return this.$$.ctx[23]}get getElement(){return this.$$.ctx[24]}}var s2=(t,e)=>{const i=t.findIndex(e);if(i>=0)return t.splice(i,1)};const K4=80;var Cs=(t,e={})=>{const{inertia:i=!1,inertiaDurationMultiplier:n=K4,shouldStartInteraction:r=()=>!0,pinch:o=!1,multiTouch:a,getEventPosition:s=ct=>rt(ct.clientX,ct.clientY),observeKeys:l=!1}=e;function c(ct,et){t.dispatchEvent(new CustomEvent(ct,{detail:et}))}function d(){I&&I(),I=void 0}const u=[],p=ct=>ct.timeStamp===0?Date.now():ct.timeStamp,h=()=>{const ct=_e(u[0].position);if(u[1]){const et=.5*(u[1].position.x-ct.x),ht=.5*(u[1].position.y-ct.y);ct.x+=et,ct.y+=ht}return ct},g=ct=>{ct.origin.x=ct.position.x,ct.origin.y=ct.position.y,ct.translation.x=0,ct.translation.y=0},m=ct=>{const et=(ht=>u.findIndex(Y=>Y.event.pointerId===ht.pointerId))(ct);if(!(et<0))return u[et]},f=()=>u.length===1,x=()=>u.length===2,k=ct=>{const et=Oo(ct.map(ht=>ht.position));return{center:et,distance:((ht,Y)=>ht.reduce((Z,St)=>Z+ho(Y,St.position),0)/ht.length)(ct,et),velocity:Oo(ct.map(ht=>ht.velocity)),translation:Oo(ct.map(ht=>ht.translation))}};let v,C,P,I,O,T,L,F,B=0,y;t.addEventListener("pointerdown",K);const V=["Meta","Control","Alt","Shift"];function J(ct){if(!V.includes(ct.key))return;const{metaKey:et,ctrlKey:ht,altKey:Y,shiftKey:Z}=ct;H({metaKey:et,ctrlKey:ht,altKey:Y,shiftKey:Z})}let S=Date.now();const H=ct=>{const et=_e(u[0].translation);let ht=L;o&&x()&&(ht*=ho(u[0].position,u[1].position)/O,Fn(et,u[1].translation)),Fn(et,T);const Y=Date.now();Y-S<16||(S=Y,c("interactionupdate",{position:h(),translation:et,scalar:o?ht:void 0,isMultiTouching:x(),...ct}))};function K(ct){if(!x()&&!(et=>xi(et.button)&&et.button!==0)(ct)&&r(ct,t)){if(d(),(et=>{const ht=p(et),Y={timeStamp:ht,timeStampInitial:ht,position:s(et),origin:s(et),velocity:Qi(),velocityHistory:[],velocityAverage:Qi(),translation:Qi(),interactionState:void 0,event:et};u.push(Y),Y.interactionState=k(u)})(ct),l&&(window.addEventListener("keydown",J),window.addEventListener("keyup",J)),f())document.documentElement.addEventListener("pointermove",ut),document.documentElement.addEventListener("pointerup",lt),document.documentElement.addEventListener("pointercancel",lt),document.addEventListener("visibilitychange",ft),F=!1,L=1,T=Qi(),O=void 0,c("interactionstart",{origin:_e(m(ct).origin)});else if(o)F=!0,O=ho(u[0].position,u[1].position),T.x+=u[0].translation.x,T.y+=u[0].translation.y,g(u[0]);else if(a===!1)return u.length=0,Lt(),c("interactioncancel")}}function ut(ct){ct.preventDefault(),(St=>{const nt=m(St);if(!nt)return;const mt=p(St),Ft=s(St),oe=Math.max(1,mt-nt.timeStamp);nt.velocity.x=(Ft.x-nt.position.x)/oe,nt.velocity.y=(Ft.y-nt.position.y)/oe,nt.velocityHistory.push(_e(nt.velocity)),nt.velocityHistory=nt.velocityHistory.slice(-3),nt.velocityAverage=nt.velocityHistory.reduce((Rt,Ut,Ot,j)=>(Rt.x+=Ut.x/j.length,Rt.y+=Ut.y/j.length,Rt),Qi()),nt.translation.x=Ft.x-nt.origin.x,nt.translation.y=Ft.y-nt.origin.y,nt.timeStamp=mt,nt.position.x=Ft.x,nt.position.y=Ft.y,nt.event=St})(ct);const{metaKey:et=!1,ctrlKey:ht=!1,altKey:Y=!1,shiftKey:Z=!1}=l?ct:{};H({metaKey:et,ctrlKey:ht,altKey:Y,shiftKey:Z})}function lt(ct){if(!m(ct))return;const et=h(),ht=(oe=>{const Rt=s2(u,Ut=>Ut.event.pointerId===oe.pointerId);if(Rt)return Rt[0]})(ct);if(o&&f()){const oe=ho(u[0].position,ht.position);L*=oe/O,T.x+=u[0].translation.x+ht.translation.x,T.y+=u[0].translation.y+ht.translation.y,g(u[0])}let Y=!1,Z=!1;if(!F&&ht){const oe=performance.now(),Rt=oe-ht.timeStampInitial;Y=Bo(ht.translation)<64&&Rt<300,Z=!!(y&&Y&&oe-B<700&&Bo(y,ht.position)<128),Y&&(y=_e(ht.position),B=oe)}if(u.length>0)return;Lt();const St=_e(ht.translation),nt=_e(ht.velocityAverage);let mt=!1;c("interactionrelease",{isTap:Y,isDoubleTap:Z,position:et,translation:St,scalar:L,preventInertia:()=>mt=!0});const Ft=ho(nt);if(mt||!i||Ft<.25)return $t(St,{isTap:Y,isDoubleTap:Z});C=_e(et),P=_e(St),v=Dh(_e(St),{easing:M4,duration:Ft*n}),v.set({x:St.x+50*nt.x,y:St.y+50*nt.y}).then(()=>{I&&$t(xa(v),{isTap:Y,isDoubleTap:Z})}),I=v.subscribe(N)}function N(ct){ct&&c("interactionupdate",{position:rt(C.x+(ct.x-P.x),C.y+(ct.y-P.y)),translation:ct,scalar:o?L:void 0})}function ft(ct){if(document.visibilityState==="visible"||!u.length)return;const et=k(u);d(),c("interactionend",{...et}),u.length=0,Lt()}function $t(ct,et){d(),c("interactionend",{...et,translation:ct,scalar:o?L:void 0})}function Lt(){l&&window.removeEventListener("keydown",J),l&&window.removeEventListener("keyup",J),document.documentElement.removeEventListener("pointermove",ut),document.documentElement.removeEventListener("pointerup",lt),document.documentElement.removeEventListener("pointercancel",lt),document.addEventListener("visibilitychange",ft)}return{destroy(){d(),t.removeEventListener("pointerdown",K)}}},Ts=(t,e={})=>{const{direction:i,shiftMultiplier:n=10,bubbles:r=!1,preventDefault:o=!1,stopKeydownPropagation:a=!0}=e,s=i==="horizontal",l=i==="vertical",c=d=>{const{key:u}=d,p=d.shiftKey,h=/up|down/i.test(u),g=/left|right/i.test(u);if(!g&&!h||s&&h||l&&g)return;const m=p?n:1;a&&d.stopPropagation(),o&&d.preventDefault(),t.dispatchEvent(new CustomEvent("nudge",{bubbles:r,detail:rt((/left/i.test(u)?-1:/right/i.test(u)?1:0)*m,(/up/i.test(u)?-1:/down/i.test(u)?1:0)*m)}))};return t.addEventListener("keydown",c),{destroy(){t.removeEventListener("keydown",c)}}};function us(t,e){return e?e*Math.sign(t)*Math.log10(1+Math.abs(t)/e):t}const M$=(t,e,i)=>{if(!e||!i)return{...t};const n=t.x+us(e.x-t.x,i),r=t.x+t.width+us(e.x+e.width-(t.x+t.width),i),o=t.y+us(e.y-t.y,i);return{x:n,y:o,width:r-n,height:t.y+t.height+us(e.y+e.height-(t.y+t.height),i)-o}},J4=(t,e,i)=>e&&i?rt(t.x+us(e.x-t.x,i),t.y+us(e.y-t.y,i)):{...t};var l2=(t,e)=>{if(t)return/em/.test(t)?16*parseInt(t,10):/px/.test(t)?parseInt(t,10):void 0},ku=(t,e)=>{let i=t.detail||0;const{deltaX:n,deltaY:r,wheelDelta:o,wheelDeltaX:a,wheelDeltaY:s}=t,{fixScrollDirection:l=!1}=e||{};return xi(a)&&Math.abs(a)>Math.abs(s)?i=a/-120:xi(n)&&Math.abs(n)>Math.abs(r)?i=n/20:(o||s)&&(i=(o||s)/-120),i||(i=r/20),(va()||Ia())&&(i*=2),l&&yu()&&(i*=-1),i};function Q4(t){let e,i,n,r,o,a,s;const l=t[37].default,c=sr(l,t,t[36],null);return{c(){e=pt("div"),i=pt("div"),c&&c.c(),w(i,"style",t[5]),w(e,"class",n=ui(["PinturaScrollable",t[0]])),w(e,"style",t[4]),w(e,"data-direction",t[1]),w(e,"data-state",t[6])},m(d,u){tt(d,e,u),Tt(e,i),c&&c.m(i,null),t[39](e),o=!0,a||(s=[Mt(i,"interactionstart",t[9]),Mt(i,"interactionupdate",t[11]),Mt(i,"interactionend",t[12]),Mt(i,"interactionrelease",t[10]),Ui(Cs.call(null,i,{inertia:!0})),Mt(i,"measure",t[38]),Ui(Mr.call(null,i)),Mt(e,"wheel",t[14],{passive:!1}),Mt(e,"scroll",t[16]),Mt(e,"focusin",t[15]),Mt(e,"nudge",t[17]),Mt(e,"measure",t[13]),Ui(Mr.call(null,e,{observePosition:!0})),Ui(r=Ts.call(null,e,{direction:t[1]==="x"?"horizontal":"vertical",stopKeydownPropagation:!1}))],a=!0)},p(d,u){c&&c.p&&(!o||32&u[1])&&cr(c,l,d,d[36],o?lr(l,d[36],u,null):dr(d[36]),null),(!o||32&u[0])&&w(i,"style",d[5]),(!o||1&u[0]&&n!==(n=ui(["PinturaScrollable",d[0]])))&&w(e,"class",n),(!o||16&u[0])&&w(e,"style",d[4]),(!o||2&u[0])&&w(e,"data-direction",d[1]),(!o||64&u[0])&&w(e,"data-state",d[6]),r&&ji(r.update)&&2&u[0]&&r.update.call(null,{direction:d[1]==="x"?"horizontal":"vertical",stopKeydownPropagation:!1})},i(d){o||(M(c,d),o=!0)},o(d){D(c,d),o=!1},d(d){d&&Q(e),c&&c.d(d),t[39](null),a=!1,_i(s)}}}function tv(t,e,i){let n,r,o,a,s,l,c,d,u,{$$slots:p={},$$scope:h}=e;const g=Sa();let m,f,x,k,v="idle",C=ai(0);A(t,C,Y=>i(35,d=Y));let{class:P}=e,{scrollBlockInteractionDist:I=5}=e,{scrollStep:O=10}=e,{scrollFocusMargin:T=64}=e,{scrollDirection:L="x"}=e,{scrollAutoCancel:F=!1}=e,{elasticity:B=0}=e,{onscroll:y=$e}=e,{maskFeatherSize:V}=e,{maskFeatherStartOpacity:J}=e,{maskFeatherEndOpacity:S}=e,{scroll:H}=e;const K=sn("fixScrollDirection");let ut;A(t,K,Y=>i(46,u=Y));let lt="",N=!0;const ft=C.subscribe(Y=>{const Z=Qi();Z[L]=Y,y(Z)}),$t=Y=>Math.max(Math.min(0,Y),x[n]-f[n]);let Lt,ct,et;const ht=(Y,Z={})=>{const{elastic:St=!1,animate:nt=!1,preventScrollState:mt=!1}=Z;Math.abs(Y-m)>I&&v==="idle"&&!k&&!mt&&i(28,v="scrolling");const Ft=$t(Y),oe=St&&B&&!k?Ft+us(Y-Ft,B):Ft;let Rt=!0;nt?Rt=!1:N||(Rt=!k),N=!1,C.set(oe,{hard:Rt}).then(Ut=>{k&&(N=!0)})};return No(()=>{ft()}),t.$$set=Y=>{"class"in Y&&i(0,P=Y.class),"scrollBlockInteractionDist"in Y&&i(21,I=Y.scrollBlockInteractionDist),"scrollStep"in Y&&i(22,O=Y.scrollStep),"scrollFocusMargin"in Y&&i(23,T=Y.scrollFocusMargin),"scrollDirection"in Y&&i(1,L=Y.scrollDirection),"scrollAutoCancel"in Y&&i(24,F=Y.scrollAutoCancel),"elasticity"in Y&&i(25,B=Y.elasticity),"onscroll"in Y&&i(26,y=Y.onscroll),"maskFeatherSize"in Y&&i(20,V=Y.maskFeatherSize),"maskFeatherStartOpacity"in Y&&i(18,J=Y.maskFeatherStartOpacity),"maskFeatherEndOpacity"in Y&&i(19,S=Y.maskFeatherEndOpacity),"scroll"in Y&&i(27,H=Y.scroll),"$$scope"in Y&&i(36,h=Y.$$scope)},t.$$.update=()=>{if(2&t.$$.dirty[0]&&i(32,n=L==="x"?"width":"height"),2&t.$$.dirty[0]&&i(30,r=L.toUpperCase()),8&t.$$.dirty[0]&&i(34,o=ut&&getComputedStyle(ut)),8&t.$$.dirty[0]|8&t.$$.dirty[1]&&i(33,a=o&&l2(o.getPropertyValue("--scrollable-feather-size"))),537657348&t.$$.dirty[0]|22&t.$$.dirty[1]&&d!=null&&x&&a!=null&&f){const Y=-1*d/a,Z=-(x[n]-f[n]-d)/a;i(18,J=Yi(1-Y,0,1)),i(19,S=Yi(1-Z,0,1)),i(20,V=a),i(4,lt=`--scrollable-feather-start-opacity: ${J};--scrollable-feather-end-opacity: ${S}`)}134217736&t.$$.dirty[0]&&ut&&H!==void 0&&(xi(H)?ht(H):ht(H.scrollOffset,H)),536870916&t.$$.dirty[0]|2&t.$$.dirty[1]&&i(31,s=x&&f?f[n]>x[n]:void 0),268435456&t.$$.dirty[0]|1&t.$$.dirty[1]&&i(6,l=ui([v,s?"overflows":void 0])),1073741824&t.$$.dirty[0]|17&t.$$.dirty[1]&&i(5,c=s?`transform: translate${r}(${d}px)`:void 0)},[P,L,f,ut,lt,c,l,C,K,()=>{s&&(ct=!1,Lt=!0,et=rt(0,0),k=!1,i(28,v="idle"),m=xa(C))},({detail:Y})=>{s&&(k=!0,i(28,v="idle"))},({detail:Y})=>{s&&(ct||Lt&&(Lt=!1,Bo(Y.translation)<.1)||(!F||L!=="x"||(Z=>{const St=Co(rt(Z.x-et.x,Z.y-et.y),Math.abs);et=_e(Z);const nt=Bo(St),mt=St.x-St.y;return!(nt>1&&mt<-.5)})(Y.translation)?ht(m+Y.translation[L],{elastic:!0}):ct=!0))},({detail:Y})=>{if(!s||ct)return;const Z=m+Y.translation[L],St=$t(Z);N=!1,C.set(St).then(nt=>{k&&(N=!0)})},({detail:Y})=>{i(29,x=Y),g("measure",{x:Y.x,y:Y.y,width:Y.width,height:Y.height})},Y=>{if(!s)return;Y.preventDefault(),Y.stopPropagation();const Z=Y.shiftKey,St=ku(Y,{fixScrollDirection:u})*(Z?-1:1),nt=xa(C);ht(nt+St*O,{animate:!0})},Y=>{if(!s||!k)return;let Z=Y.target;Y.target.classList.contains("implicit")&&(Z=Z.parentNode);const St=Z[L==="x"?"offsetLeft":"offsetTop"],nt=St+Z[L==="x"?"offsetWidth":"offsetHeight"],mt=xa(C),Ft=T+V;mt+St<Ft?ht(-St+Ft):mt+nt>x[n]-Ft&&ht(x[n]-nt-Ft,{animate:!0})},()=>{i(3,ut[L==="x"?"scrollLeft":"scrollTop"]=0,ut)},({detail:Y})=>{if(ut.querySelector("[data-focus-visible]"))return;const Z=-2*Y[L],St=xa(C);ht(St+Z*O,{animate:!0,preventScrollState:!0})},J,S,V,I,O,T,F,B,y,H,v,x,r,s,n,a,o,d,h,p,Y=>i(2,f=Y.detail),function(Y){zi[Y?"unshift":"push"](()=>{ut=Y,i(3,ut)})}]}class ka extends li{constructor(e){super(),si(this,e,tv,Q4,ei,{class:0,scrollBlockInteractionDist:21,scrollStep:22,scrollFocusMargin:23,scrollDirection:1,scrollAutoCancel:24,elasticity:25,onscroll:26,maskFeatherSize:20,maskFeatherStartOpacity:18,maskFeatherEndOpacity:19,scroll:27},null,[-1,-1])}}function P$(t,{delay:e=0,duration:i=400,easing:n=Th}={}){const r=+getComputedStyle(t).opacity;return{delay:e,duration:i,easing:n,css:o=>"opacity: "+o*r}}function ev(t){let e,i,n,r,o;return{c(){e=pt("span"),w(e,"class","PinturaStatusMessage")},m(a,s){tt(a,e,s),e.innerHTML=t[0],n=!0,r||(o=[Mt(e,"measure",function(){ji(t[1])&&t[1].apply(this,arguments)}),Ui(Mr.call(null,e))],r=!0)},p(a,[s]){t=a,(!n||1&s)&&(e.innerHTML=t[0])},i(a){n||(zl(()=>{i||(i=jm(e,P$,{duration:500},!0)),i.run(1)}),n=!0)},o(a){i||(i=jm(e,P$,{duration:500},!1)),i.run(0),n=!1},d(a){a&&Q(e),a&&i&&i.end(),r=!1,_i(o)}}}function iv(t,e,i){let{text:n}=e,{onmeasure:r=$e}=e;return t.$$set=o=>{"text"in o&&i(0,n=o.text),"onmeasure"in o&&i(1,r=o.onmeasure)},[n,r]}class c2 extends li{constructor(e){super(),si(this,e,iv,ev,ei,{text:0,onmeasure:1})}}function nv(t){let e,i,n,r,o,a,s,l,c;return{c(){e=pt("span"),i=Cr("svg"),n=Cr("g"),r=Cr("circle"),o=Cr("circle"),a=de(),s=pt("span"),l=cn(t[3]),w(r,"class","PinturaProgressIndicatorBar"),w(r,"r","8.5"),w(r,"cx","10"),w(r,"cy","10"),w(r,"stroke-linecap","round"),w(r,"opacity",".25"),w(o,"class","PinturaProgressIndicatorFill"),w(o,"r","8.5"),w(o,"stroke-dasharray",t[2]),w(o,"cx","10"),w(o,"cy","10"),w(o,"transform","rotate(-90) translate(-20)"),w(n,"fill","none"),w(n,"stroke","currentColor"),w(n,"stroke-width","2.5"),w(n,"stroke-linecap","round"),w(n,"opacity",t[1]),w(i,"width","20"),w(i,"height","20"),w(i,"viewBox","0 0 20 20"),w(i,"xmlns","http://www.w3.org/2000/svg"),w(i,"aria-hidden","true"),w(i,"focusable","false"),w(s,"class","implicit"),w(e,"class","PinturaProgressIndicator"),w(e,"data-status",t[0]),w(e,"style",c="opacity:"+t[4])},m(d,u){tt(d,e,u),Tt(e,i),Tt(i,n),Tt(n,r),Tt(n,o),Tt(e,a),Tt(e,s),Tt(s,l)},p(d,[u]){4&u&&w(o,"stroke-dasharray",d[2]),2&u&&w(n,"opacity",d[1]),8&u&&An(l,d[3]),1&u&&w(e,"data-status",d[0]),16&u&&c!==(c="opacity:"+d[4])&&w(e,"style",c)},i:Qe,o:Qe,d(d){d&&Q(e)}}}function rv(t,e,i){let n,r,o,a,s,l,c;const d=Sa();let{progress:u}=e,{min:p=0}=e,{max:h=100}=e,{labelBusy:g="Busy"}=e,{opacity:m}=e;const f=ai(m,{precision:.01});A(t,f,P=>i(4,c=P));const x=ai(0,{precision:.01}),k=ai(0,{precision:.01});A(t,k,P=>i(13,s=P));const v=Ei([x],P=>Yi(P,p,h));A(t,v,P=>i(14,l=P));const C=v.subscribe(P=>{u===1&&Math.round(P)>=100&&d("complete")});return ws(()=>{k.set(1)}),No(()=>{C()}),t.$$set=P=>{"progress"in P&&i(8,u=P.progress),"min"in P&&i(9,p=P.min),"max"in P&&i(10,h=P.max),"labelBusy"in P&&i(11,g=P.labelBusy),"opacity"in P&&i(12,m=P.opacity)},t.$$.update=()=>{4096&t.$$.dirty&&xi(m)&&f.set(m),256&t.$$.dirty&&u&&u!==1/0&&x.set(100*u),18688&t.$$.dirty&&i(3,n=u===1/0?g:Math.round(l)+"%"),16640&t.$$.dirty&&i(2,r=u===1/0?"26.5 53":l/100*53+" 53"),8192&t.$$.dirty&&i(1,o=s),256&t.$$.dirty&&i(0,a=u===1/0?"busy":"loading")},[a,o,r,n,c,f,k,v,u,p,h,g,m,s,l]}class d2 extends li{constructor(e){super(),si(this,e,rv,nv,ei,{progress:8,min:9,max:10,labelBusy:11,opacity:12})}}function ov(t){let e,i,n;const r=t[5].default,o=sr(r,t,t[4],null);return{c(){e=pt("span"),o&&o.c(),w(e,"class",i="PinturaStatusAside "+t[0]),w(e,"style",t[1])},m(a,s){tt(a,e,s),o&&o.m(e,null),n=!0},p(a,[s]){o&&o.p&&(!n||16&s)&&cr(o,r,a,a[4],n?lr(r,a[4],s,null):dr(a[4]),null),(!n||1&s&&i!==(i="PinturaStatusAside "+a[0]))&&w(e,"class",i),(!n||2&s)&&w(e,"style",a[1])},i(a){n||(M(o,a),n=!0)},o(a){D(o,a),n=!1},d(a){a&&Q(e),o&&o.d(a)}}}function av(t,e,i){let n,{$$slots:r={},$$scope:o}=e,{offset:a=0}=e,{opacity:s=0}=e,{class:l}=e;return t.$$set=c=>{"offset"in c&&i(2,a=c.offset),"opacity"in c&&i(3,s=c.opacity),"class"in c&&i(0,l=c.class),"$$scope"in c&&i(4,o=c.$$scope)},t.$$.update=()=>{12&t.$$.dirty&&i(1,n=`transform:translateX(${a}px);opacity:${s}`)},[l,n,a,s,o,r]}class u2 extends li{constructor(e){super(),si(this,e,av,ov,ei,{offset:2,opacity:3,class:0})}}const{document:R$}=Oy;function sv(t){let e,i,n,r;return{c(){e=de(),i=pt("button"),w(i,"class","PinturaImageButton"),w(i,"type","button"),w(i,"title",t[1]),i.disabled=t[2]},m(o,a){tt(o,e,a),tt(o,i,a),i.innerHTML=t[0],t[11](i),n||(r=[Mt(R$.body,"load",t[5],!0),Mt(R$.body,"error",t[6],!0),Mt(i,"pointerdown",t[4])],n=!0)},p(o,[a]){1&a&&(i.innerHTML=o[0]),2&a&&w(i,"title",o[1]),4&a&&(i.disabled=o[2])},i:Qe,o:Qe,d(o){o&&Q(e),o&&Q(i),t[11](null),n=!1,_i(r)}}}function lv(t,e,i){let n,{html:r}=e,{title:o}=e,{onclick:a}=e,{disabled:s=!1}=e,{ongrab:l=$e}=e,{ondrag:c=$e}=e,{ondrop:d=$e}=e;const u=f=>Bo(p,rt(f.pageX,f.pageY))<256;let p;const h=f=>{document.documentElement.removeEventListener("pointermove",g),document.documentElement.removeEventListener("pointerup",h);const x=rt(f.pageX,f.pageY);if(Bo(p,x)<32)return a(f);u(f)||d(f)},g=f=>{u(f)||c(f)},m=f=>n&&n.contains(f)&&f.nodeName==="IMG";return t.$$set=f=>{"html"in f&&i(0,r=f.html),"title"in f&&i(1,o=f.title),"onclick"in f&&i(7,a=f.onclick),"disabled"in f&&i(2,s=f.disabled),"ongrab"in f&&i(8,l=f.ongrab),"ondrag"in f&&i(9,c=f.ondrag),"ondrop"in f&&i(10,d=f.ondrop)},t.$$.update=()=>{8&t.$$.dirty&&n&&n.querySelector("img")&&i(3,n.dataset.loader=!0,n)},[r,o,s,n,f=>{p=rt(f.pageX,f.pageY),l(f),document.documentElement.addEventListener("pointermove",g),document.documentElement.addEventListener("pointerup",h)},({target:f})=>{m(f)&&i(3,n.dataset.load=!0,n)},({target:f})=>{m(f)&&i(3,n.dataset.error=!0,n)},a,l,c,d,function(f){zi[f?"unshift":"push"](()=>{n=f,i(3,n)})}]}class p2 extends li{constructor(e){super(),si(this,e,lv,sv,ei,{html:0,title:1,onclick:7,disabled:2,ongrab:8,ondrag:9,ondrop:10})}}function I$(t,e,i){const n=t.slice();return n[14]=e[i],n}function E$(t,e){let i,n,r,o,a,s,l;function c(){return e[10](e[14])}function d(...h){return e[11](e[14],...h)}function u(...h){return e[12](e[14],...h)}function p(...h){return e[13](e[14],...h)}return n=new p2({props:{onclick:c,ongrab:d,ondrag:u,ondrop:p,disabled:e[1]||e[14].disabled,title:e[14].title,html:e[14].thumb}}),{key:t,first:null,c(){i=pt("li"),At(n.$$.fragment),r=de(),w(i,"style",e[6]),this.first=i},m(h,g){tt(h,i,g),It(n,i,null),Tt(i,r),a=!0,s||(l=Ui(o=e[8].call(null,i,e[14])),s=!0)},p(h,g){e=h;const m={};5&g&&(m.onclick=c),9&g&&(m.ongrab=d),17&g&&(m.ondrag=u),33&g&&(m.ondrop=p),3&g&&(m.disabled=e[1]||e[14].disabled),1&g&&(m.title=e[14].title),1&g&&(m.html=e[14].thumb),n.$set(m),(!a||64&g)&&w(i,"style",e[6]),o&&ji(o.update)&&1&g&&o.update.call(null,e[14])},i(h){a||(M(n.$$.fragment,h),a=!0)},o(h){D(n.$$.fragment,h),a=!1},d(h){h&&Q(i),Et(n),s=!1,l()}}}function cv(t){let e,i,n=[],r=new Map,o=t[0];const a=s=>s[14].id;for(let s=0;s<o.length;s+=1){let l=I$(t,o,s),c=a(l);r.set(c,n[s]=E$(c,l))}return{c(){e=pt("ul");for(let s=0;s<n.length;s+=1)n[s].c();w(e,"class","PinturaImageButtonList")},m(s,l){tt(s,e,l);for(let c=0;c<n.length;c+=1)n[c].m(e,null);i=!0},p(s,[l]){127&l&&(o=s[0],Fe(),n=Aa(n,l,a,1,s,o,r,e,Ss,E$,null,I$),De())},i(s){if(!i){for(let l=0;l<o.length;l+=1)M(n[l]);i=!0}},o(s){for(let l=0;l<n.length;l+=1)D(n[l]);i=!1},d(s){s&&Q(e);for(let l=0;l<n.length;l+=1)n[l].d()}}}function dv(t,e,i){let n,r,{items:o}=e,{disabled:a}=e,{onclickitem:s}=e,{ongrabitem:l}=e,{ondragitem:c}=e,{ondropitem:d}=e;const u=ai(0,{stiffness:.25,damping:.9});return A(t,u,p=>i(9,r=p)),ws(()=>u.set(1)),t.$$set=p=>{"items"in p&&i(0,o=p.items),"disabled"in p&&i(1,a=p.disabled),"onclickitem"in p&&i(2,s=p.onclickitem),"ongrabitem"in p&&i(3,l=p.ongrabitem),"ondragitem"in p&&i(4,c=p.ondragitem),"ondropitem"in p&&i(5,d=p.ondropitem)},t.$$.update=()=>{512&t.$$.dirty&&i(6,n="opacity:"+r)},[o,a,s,l,c,d,n,u,(p,h)=>h.mount&&h.mount(p.firstChild,h),r,p=>s(p.id),(p,h)=>l&&l(p.id,h),(p,h)=>c&&c(p.id,h),(p,h)=>d&&d(p.id,h)]}class Wh extends li{constructor(e){super(),si(this,e,dv,cv,ei,{items:0,disabled:1,onclickitem:2,ongrabitem:3,ondragitem:4,ondropitem:5})}}var yc=()=>Lr()&&window.devicePixelRatio||1;let bp=null;var Ic=t=>(bp===null&&(bp=yc()===1?Math.round:e=>e),bp(t)),Xp=(t,e={})=>{if(t){if(e.preventScroll&&Ia()){const i=document.body.scrollTop;return t.focus(),void(document.body.scrollTop=i)}t.focus(e)}},h2=t=>/date|email|number|search|text|url/.test(t.type),Ec=t=>(e=>/textarea/i.test(e.nodeName))(t)||h2(t)||t.isContentEditable;const uv=t=>({}),A$=t=>({}),pv=t=>({}),L$=t=>({});function hv(t){let e,i;const n=[t[7]];let r={$$slots:{default:[$v]},$$scope:{ctx:t}};for(let o=0;o<n.length;o+=1)r=Cn(r,n[o]);return e=new ks({props:r}),t[46](e),{c(){At(e.$$.fragment)},m(o,a){It(e,o,a),i=!0},p(o,a){const s=128&a[0]?Tr(n,[zr(o[7])]):{};524288&a[1]&&(s.$$scope={dirty:a,ctx:o}),e.$set(s)},i(o){i||(M(e.$$.fragment,o),i=!0)},o(o){D(e.$$.fragment,o),i=!1},d(o){t[46](null),Et(e,o)}}}function mv(t){let e,i;const n=[t[7]];let r={};for(let o=0;o<n.length;o+=1)r=Cn(r,n[o]);return e=new ks({props:r}),t[45](e),{c(){At(e.$$.fragment)},m(o,a){It(e,o,a),i=!0},p(o,a){const s=128&a[0]?Tr(n,[zr(o[7])]):{};e.$set(s)},i(o){i||(M(e.$$.fragment,o),i=!0)},o(o){D(e.$$.fragment,o),i=!1},d(o){t[45](null),Et(e,o)}}}function $v(t){let e;const i=t[44].label,n=sr(i,t,t[50],L$);return{c(){n&&n.c()},m(r,o){n&&n.m(r,o),e=!0},p(r,o){n&&n.p&&(!e||524288&o[1])&&cr(n,i,r,r[50],e?lr(i,r[50],o,pv):dr(r[50]),L$)},i(r){e||(M(n,r),e=!0)},o(r){D(n,r),e=!1},d(r){n&&n.d(r)}}}function z$(t){let e,i,n,r,o,a,s;const l=t[44].details,c=sr(l,t,t[50],A$);return{c(){e=pt("div"),c&&c.c(),i=de(),n=pt("span"),w(n,"class","PinturaPanelTip"),w(n,"style",t[10]),w(e,"class",r=ui(["PinturaPanel","pintura-editor-panel",t[2]])),w(e,"tabindex","-1"),w(e,"style",t[11])},m(d,u){tt(d,e,u),c&&c.m(e,null),Tt(e,i),Tt(e,n),t[47](e),o=!0,a||(s=[Mt(e,"close",t[48]),Mt(e,"keydown",t[18]),Mt(e,"measure",t[49]),Ui(Mr.call(null,e))],a=!0)},p(d,u){c&&c.p&&(!o||524288&u[1])&&cr(c,l,d,d[50],o?lr(l,d[50],u,uv):dr(d[50]),A$),(!o||1024&u[0])&&w(n,"style",d[10]),(!o||4&u[0]&&r!==(r=ui(["PinturaPanel","pintura-editor-panel",d[2]])))&&w(e,"class",r),(!o||2048&u[0])&&w(e,"style",d[11])},i(d){o||(M(c,d),o=!0)},o(d){D(c,d),o=!1},d(d){d&&Q(e),c&&c.d(d),t[47](null),a=!1,_i(s)}}}function gv(t){let e,i,n,r,o,a,s,l,c;const d=[mv,hv],u=[];function p(g,m){return g[1]?0:1}i=p(t),n=u[i]=d[i](t);let h=t[6]&&z$(t);return{c(){e=de(),n.c(),r=de(),h&&h.c(),o=de(),a=Tn()},m(g,m){tt(g,e,m),u[i].m(g,m),tt(g,r,m),h&&h.m(g,m),tt(g,o,m),tt(g,a,m),s=!0,l||(c=[Mt(document.body,"pointerdown",function(){ji(t[9])&&t[9].apply(this,arguments)}),Mt(document.body,"pointerup",function(){ji(t[8])&&t[8].apply(this,arguments)})],l=!0)},p(g,m){let f=i;i=p(t=g),i===f?u[i].p(t,m):(Fe(),D(u[f],1,1,()=>{u[f]=null}),De(),n=u[i],n?n.p(t,m):(n=u[i]=d[i](t),n.c()),M(n,1),n.m(r.parentNode,r)),t[6]?h?(h.p(t,m),64&m[0]&&M(h,1)):(h=z$(t),h.c(),M(h,1),h.m(o.parentNode,o)):h&&(Fe(),D(h,1,1,()=>{h=null}),De())},i(g){s||(M(n),M(h),M(!1),s=!0)},o(g){D(n),D(h),D(!1),s=!1},d(g){g&&Q(e),u[i].d(g),g&&Q(r),h&&h.d(g),g&&Q(o),g&&Q(a),l=!1,_i(c)}}}function fv(t,e,i){let n,r,o,a,s,l,c,d,u,p,h,g,m,f,x,k,v,C,P,{$$slots:I={},$$scope:O}=e,{buttonClass:T}=e,{buttonLabel:L}=e,{buttonLabelClass:F}=e,{buttonHideLabel:B}=e,{buttonIcon:y}=e,{buttonTitle:V}=e,{panelClass:J}=e,{isActive:S=!1}=e,{onshow:H=({panel:j})=>Xp(j,{preventScroll:!0})}=e,{onhide:K=$e}=e;const ut=sn("isAnimated");A(t,ut,j=>i(43,P=j));const lt=sn("rootPortal");A(t,lt,j=>i(38,f=j));const N=sn("rootRect");let ft,$t,Lt;A(t,N,j=>i(41,v=j));const ct=()=>i(26,Lt=n&&n.getBoundingClientRect());let et=Qi(),ht=ai(0);A(t,ht,j=>i(40,k=j));let Y=Qi();const Z=le({x:0,y:0});A(t,Z,j=>i(39,x=j));const St=ai(-5,{stiffness:.1,damping:.35,precision:.001});A(t,St,j=>i(42,C=j));let nt=!0;const mt=j=>a2(j,f)||$t.isEventTarget(j);let Ft,oe,Rt=!1;const Ut=j=>{Ec(j.target)||(S||ct(),i(31,oe=j),i(0,S=!S))},Ot=j=>{/down/i.test(j.key)&&(i(0,S=!0),i(31,oe=j))};return No(()=>{if(!f||!Ft)return;const j=Ft;By().then(()=>{j.parentNode&&j.remove()})}),t.$$set=j=>{"buttonClass"in j&&i(19,T=j.buttonClass),"buttonLabel"in j&&i(1,L=j.buttonLabel),"buttonLabelClass"in j&&i(20,F=j.buttonLabelClass),"buttonHideLabel"in j&&i(21,B=j.buttonHideLabel),"buttonIcon"in j&&i(22,y=j.buttonIcon),"buttonTitle"in j&&i(23,V=j.buttonTitle),"panelClass"in j&&i(2,J=j.panelClass),"isActive"in j&&i(0,S=j.isActive),"onshow"in j&&i(24,H=j.onshow),"onhide"in j&&i(25,K=j.onhide),"$$scope"in j&&i(50,O=j.$$scope)},t.$$.update=()=>{if(16&t.$$.dirty[0]&&(n=$t&&$t.getElement()),1073741825&t.$$.dirty[0]&&i(8,g=S?j=>{Rt&&(i(30,Rt=!1),mt(j)||i(0,S=!1))}:void 0),1&t.$$.dirty[0]|4096&t.$$.dirty[1]&&ht.set(S?1:0,{hard:P===!1}),1&t.$$.dirty[0]|4096&t.$$.dirty[1]&&St.set(S?0:-5,{hard:P===!1}),2048&t.$$.dirty[1]&&i(34,r=1-C/-5),1&t.$$.dirty[0]|1024&t.$$.dirty[1]&&v&&S&&ct(),67108873&t.$$.dirty[0]|1024&t.$$.dirty[1]&&v&&ft&&Lt&&S){i(29,nt=!0);let j=Lt.x-v.x+.5*Lt.width-.5*ft.width,wt=Lt.y-v.y+Lt.height;const yt=12,Gt=12,ue=v.width-12,pe=v.height-12,ve=j,ge=wt,_=ve+ft.width,we=ge+ft.height;ve<yt&&(i(28,Y.x=ve-yt,Y),j=yt),_>ue&&(i(28,Y.x=_-ue,Y),j=ue-ft.width),we>pe?(i(27,et.y=-1,et),Gt<wt-ft.height-Lt.height?(i(28,Y.y=0,Y),wt-=ft.height+Lt.height):(i(28,Y.y=wt-(we-pe),Y),wt-=we-pe-12,i(29,nt=!1))):i(27,et.y=1,et),Ct(Z,x=Co(rt(j,wt),Ic),x)}512&t.$$.dirty[1]&&i(6,o=k>0),512&t.$$.dirty[1]&&i(37,a=k<1),134217728&t.$$.dirty[0]|2304&t.$$.dirty[1]&&i(36,s=`translateX(${Math.round(x.x)+12*et.x}px) translateY(${Math.round(x.y)+12*et.y+et.y*C}px)`),1024&t.$$.dirty[1]&&i(35,l=`--panel-max-height:${v.height-24}px`),624&t.$$.dirty[1]&&i(11,c=a?`opacity: ${k}; pointer-events: ${k<1?"none":"all"}; transform: ${s};${l}`:`transform: ${s};${l}`),8&t.$$.dirty[1]&&i(32,d=.5+.5*r),8&t.$$.dirty[1]&&i(33,u=r),939524104&t.$$.dirty[0]|262&t.$$.dirty[1]&&i(10,p=x&&ft&&`opacity:${nt?u:0};transform:scaleX(${d})rotate(45deg);top:${et.y<0?Y.y+ft.height:0}px;left:${Y.x+.5*ft.width}px`),1&t.$$.dirty[0]&&i(9,h=S?j=>{mt(j)||i(30,Rt=!0)}:void 0),96&t.$$.dirty[0]|128&t.$$.dirty[1]&&o&&f&&Ft&&Ft.parentNode!==f&&f.append(Ft),1&t.$$.dirty[0]&&(S||i(31,oe=void 0)),16777313&t.$$.dirty[0]|1&t.$$.dirty[1]&&S&&o&&Ft&&H({e:oe,panel:Ft}),33554497&t.$$.dirty[0]&&o&&!S&&K(),16252930&t.$$.dirty[0]&&i(7,m={label:L,icon:y,class:ui(["PinturaPanelButton",T]),onkeydown:Ot,onclick:Ut,hideLabel:B,labelClass:F,title:V})},[S,L,J,ft,$t,Ft,o,m,g,h,p,c,ut,lt,N,ht,Z,St,j=>{/esc/i.test(j.key)&&(i(0,S=!1),n.focus())},T,F,B,y,V,H,K,Lt,et,Y,nt,Rt,oe,d,u,r,l,s,a,f,x,k,v,C,P,I,function(j){zi[j?"unshift":"push"](()=>{$t=j,i(4,$t)})},function(j){zi[j?"unshift":"push"](()=>{$t=j,i(4,$t)})},function(j){zi[j?"unshift":"push"](()=>{Ft=j,i(5,Ft)})},j=>{j.stopPropagation(),i(0,S=!1)},j=>i(3,ft=Ea(j.detail)),O]}class Cu extends li{constructor(e){super(),si(this,e,fv,gv,ei,{buttonClass:19,buttonLabel:1,buttonLabelClass:20,buttonHideLabel:21,buttonIcon:22,buttonTitle:23,panelClass:2,isActive:0,onshow:24,onhide:25},null,[-1,-1])}}var yv={Up:38,Down:40,Left:37,Right:39};function xv(t){let e,i,n,r,o,a,s,l;const c=t[15].default,d=sr(c,t,t[14],null);return{c(){e=pt("li"),i=pt("input"),n=de(),r=pt("label"),d&&d.c(),w(i,"type","radio"),w(i,"class","implicit"),w(i,"id",t[7]),w(i,"name",t[0]),i.value=t[3],i.disabled=t[6],i.hidden=t[5],i.checked=t[4],w(r,"for",t[7]),w(r,"title",t[2]),w(e,"class",o=ui(["PinturaRadioGroupOption",t[1]])),w(e,"data-hidden",t[5]),w(e,"data-disabled",t[6]),w(e,"data-selected",t[4])},m(u,p){tt(u,e,p),Tt(e,i),Tt(e,n),Tt(e,r),d&&d.m(r,null),a=!0,s||(l=[Mt(i,"change",zb(t[16])),Mt(i,"keydown",t[9]),Mt(i,"click",t[10])],s=!0)},p(u,[p]){(!a||128&p)&&w(i,"id",u[7]),(!a||1&p)&&w(i,"name",u[0]),(!a||8&p)&&(i.value=u[3]),(!a||64&p)&&(i.disabled=u[6]),(!a||32&p)&&(i.hidden=u[5]),(!a||16&p)&&(i.checked=u[4]),d&&d.p&&(!a||16384&p)&&cr(d,c,u,u[14],a?lr(c,u[14],p,null):dr(u[14]),null),(!a||128&p)&&w(r,"for",u[7]),(!a||4&p)&&w(r,"title",u[2]),(!a||2&p&&o!==(o=ui(["PinturaRadioGroupOption",u[1]])))&&w(e,"class",o),(!a||32&p)&&w(e,"data-hidden",u[5]),(!a||64&p)&&w(e,"data-disabled",u[6]),(!a||16&p)&&w(e,"data-selected",u[4])},i(u){a||(M(d,u),a=!0)},o(u){D(d,u),a=!1},d(u){u&&Q(e),d&&d.d(u),s=!1,_i(l)}}}function bv(t,e,i){let n,r,{$$slots:o={},$$scope:a}=e,{name:s}=e,{class:l}=e,{label:c}=e,{id:d}=e,{value:u}=e,{checked:p}=e,{onkeydown:h}=e,{onclick:g}=e,{hidden:m=!1}=e,{disabled:f=!1}=e;const x=Object.values(yv),k=sn("keysPressed");return A(t,k,v=>i(17,r=v)),t.$$set=v=>{"name"in v&&i(0,s=v.name),"class"in v&&i(1,l=v.class),"label"in v&&i(2,c=v.label),"id"in v&&i(11,d=v.id),"value"in v&&i(3,u=v.value),"checked"in v&&i(4,p=v.checked),"onkeydown"in v&&i(12,h=v.onkeydown),"onclick"in v&&i(13,g=v.onclick),"hidden"in v&&i(5,m=v.hidden),"disabled"in v&&i(6,f=v.disabled),"$$scope"in v&&i(14,a=v.$$scope)},t.$$.update=()=>{2049&t.$$.dirty&&i(7,n=`${s}-${d}`)},[s,l,c,u,p,m,f,n,k,v=>{h(v)},v=>{r.some(C=>x.includes(C))||g(v)},d,h,g,a,o,function(v){jr.call(this,t,v)}]}class m2 extends li{constructor(e){super(),si(this,e,bv,xv,ei,{name:0,class:1,label:2,id:11,value:3,checked:4,onkeydown:12,onclick:13,hidden:5,disabled:6})}}var $s=(t=[])=>t.reduce((e,i)=>(En(i)?En(i[1]):i.options)?e.concat(En(i)?i[1]:i.options):(e.push(i),e),[]);const Vd=(t,e,i)=>{let n;return En(t)?n={id:e,value:t[0],label:t[1],...t[2]||{}}:(n=t,n.id=n.id!=null?n.id:e),i?i(n):n};var ar=(t,e,i)=>tn(t)?t(e,i):t;const $2=(t,e)=>t.map(([i,n,r])=>{if(En(n))return[ar(i,e),$2(n,e)];{const o=[i,ar(n,e)];if(r){let a={...r};r.icon&&(a.icon=ar(r.icon,e)),o.push(a)}return o}});var g2=(t,e)=>$2(t,e),f2=(t,e)=>Array.isArray(t)&&Array.isArray(e)?Ja(t,e):t===e;function F$(t,e,i){const n=t.slice();return n[27]=e[i],n}const vv=t=>({option:1024&t[0]}),D$=t=>({option:t[27]});function B$(t,e,i){const n=t.slice();return n[27]=e[i],n}const wv=t=>({option:1024&t[0]}),O$=t=>({option:t[27]}),Sv=t=>({option:1024&t[0]}),W$=t=>({option:t[27]});function _$(t){let e,i,n,r,o,a=[],s=new Map,l=t[1]&&V$(t),c=t[10];const d=u=>u[27].id;for(let u=0;u<c.length;u+=1){let p=F$(t,c,u),h=d(p);s.set(h,a[u]=Z$(h,p))}return{c(){e=pt("fieldset"),l&&l.c(),i=de(),n=pt("ul");for(let u=0;u<a.length;u+=1)a[u].c();w(n,"class","PinturaRadioGroupOptions"),w(e,"class",r=ui(["PinturaRadioGroup",t[3]])),w(e,"data-layout",t[5]),w(e,"title",t[7])},m(u,p){tt(u,e,p),l&&l.m(e,null),Tt(e,i),Tt(e,n);for(let h=0;h<a.length;h+=1)a[h].m(n,null);o=!0},p(u,p){u[1]?l?l.p(u,p):(l=V$(u),l.c(),l.m(e,i)):l&&(l.d(1),l=null),8419153&p[0]&&(c=u[10],Fe(),a=Aa(a,p,d,1,u,c,s,n,Ss,Z$,null,F$),De()),(!o||8&p[0]&&r!==(r=ui(["PinturaRadioGroup",u[3]])))&&w(e,"class",r),(!o||32&p[0])&&w(e,"data-layout",u[5]),(!o||128&p[0])&&w(e,"title",u[7])},i(u){if(!o){for(let p=0;p<c.length;p+=1)M(a[p]);o=!0}},o(u){for(let p=0;p<a.length;p+=1)D(a[p]);o=!1},d(u){u&&Q(e),l&&l.d();for(let p=0;p<a.length;p+=1)a[p].d()}}}function V$(t){let e,i,n;return{c(){e=pt("legend"),i=cn(t[1]),w(e,"class",n=t[2]&&"implicit")},m(r,o){tt(r,e,o),Tt(e,i)},p(r,o){2&o[0]&&An(i,r[1]),4&o[0]&&n!==(n=r[2]&&"implicit")&&w(e,"class",n)},d(r){r&&Q(e)}}}function kv(t){let e,i;return e=new m2({props:{name:t[4],label:t[27].label,id:t[27].id,value:t[27].value,disabled:t[27].disabled,hidden:t[27].hidden,class:t[8],checked:t[12](t[27])===t[0],onkeydown:t[13](t[27]),onclick:t[14](t[27]),$$slots:{default:[Mv]},$$scope:{ctx:t}}}),{c(){At(e.$$.fragment)},m(n,r){It(e,n,r),i=!0},p(n,r){const o={};16&r[0]&&(o.name=n[4]),1024&r[0]&&(o.label=n[27].label),1024&r[0]&&(o.id=n[27].id),1024&r[0]&&(o.value=n[27].value),1024&r[0]&&(o.disabled=n[27].disabled),1024&r[0]&&(o.hidden=n[27].hidden),256&r[0]&&(o.class=n[8]),1025&r[0]&&(o.checked=n[12](n[27])===n[0]),1024&r[0]&&(o.onkeydown=n[13](n[27])),1024&r[0]&&(o.onclick=n[14](n[27])),8389696&r[0]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){D(e.$$.fragment,n),i=!1},d(n){Et(e,n)}}}function Cv(t){let e,i,n,r,o,a,s=[],l=new Map;const c=t[22].group,d=sr(c,t,t[23],W$),u=d||function(g){let m,f,x=g[27].label+"";return{c(){m=pt("span"),f=cn(x),w(m,"class","PinturaRadioGroupOptionGroupLabel")},m(k,v){tt(k,m,v),Tt(m,f)},p(k,v){1024&v[0]&&x!==(x=k[27].label+"")&&An(f,x)},d(k){k&&Q(m)}}}(t);let p=t[27].options;const h=g=>g[27].id;for(let g=0;g<p.length;g+=1){let m=B$(t,p,g),f=h(m);l.set(f,s[g]=G$(f,m))}return{c(){e=pt("li"),u&&u.c(),i=de(),n=pt("ul");for(let g=0;g<s.length;g+=1)s[g].c();r=de(),w(n,"class","PinturaRadioGroupOptions"),w(e,"class",o=ui(["PinturaRadioGroupOptionGroup",t[9]]))},m(g,m){tt(g,e,m),u&&u.m(e,null),Tt(e,i),Tt(e,n);for(let f=0;f<s.length;f+=1)s[f].m(n,null);Tt(e,r),a=!0},p(g,m){d?d.p&&(!a||8389632&m[0])&&cr(d,c,g,g[23],a?lr(c,g[23],m,Sv):dr(g[23]),W$):u&&u.p&&(!a||1024&m[0])&&u.p(g,a?m:[-1,-1]),8418641&m[0]&&(p=g[27].options,Fe(),s=Aa(s,m,h,1,g,p,l,n,Ss,G$,null,B$),De()),(!a||512&m[0]&&o!==(o=ui(["PinturaRadioGroupOptionGroup",g[9]])))&&w(e,"class",o)},i(g){if(!a){M(u,g);for(let m=0;m<p.length;m+=1)M(s[m]);a=!0}},o(g){D(u,g);for(let m=0;m<s.length;m+=1)D(s[m]);a=!1},d(g){g&&Q(e),u&&u.d(g);for(let m=0;m<s.length;m+=1)s[m].d()}}}function N$(t){let e,i;return e=new Mo({props:{$$slots:{default:[Tv]},$$scope:{ctx:t}}}),{c(){At(e.$$.fragment)},m(n,r){It(e,n,r),i=!0},p(n,r){const o={};8389632&r[0]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){D(e.$$.fragment,n),i=!1},d(n){Et(e,n)}}}function Tv(t){let e,i=t[27].icon+"";return{c(){e=Cr("g")},m(n,r){tt(n,e,r),e.innerHTML=i},p(n,r){1024&r[0]&&i!==(i=n[27].icon+"")&&(e.innerHTML=i)},d(n){n&&Q(e)}}}function H$(t){let e,i,n=t[27].label+"";return{c(){e=pt("span"),i=cn(n),w(e,"class",t[6])},m(r,o){tt(r,e,o),Tt(e,i)},p(r,o){1024&o[0]&&n!==(n=r[27].label+"")&&An(i,n),64&o[0]&&w(e,"class",r[6])},d(r){r&&Q(e)}}}function Mv(t){let e;const i=t[22].option,n=sr(i,t,t[23],D$),r=n||function(o){let a,s,l,c=o[27].icon&&N$(o),d=!o[27].hideLabel&&H$(o);return{c(){c&&c.c(),a=de(),d&&d.c(),s=de()},m(u,p){c&&c.m(u,p),tt(u,a,p),d&&d.m(u,p),tt(u,s,p),l=!0},p(u,p){u[27].icon?c?(c.p(u,p),1024&p[0]&&M(c,1)):(c=N$(u),c.c(),M(c,1),c.m(a.parentNode,a)):c&&(Fe(),D(c,1,1,()=>{c=null}),De()),u[27].hideLabel?d&&(d.d(1),d=null):d?d.p(u,p):(d=H$(u),d.c(),d.m(s.parentNode,s))},i(u){l||(M(c),l=!0)},o(u){D(c),l=!1},d(u){c&&c.d(u),u&&Q(a),d&&d.d(u),u&&Q(s)}}}(t);return{c(){r&&r.c()},m(o,a){r&&r.m(o,a),e=!0},p(o,a){n?n.p&&(!e||8389632&a[0])&&cr(n,i,o,o[23],e?lr(i,o[23],a,vv):dr(o[23]),D$):r&&r.p&&(!e||1088&a[0])&&r.p(o,e?a:[-1,-1])},i(o){e||(M(r,o),e=!0)},o(o){D(r,o),e=!1},d(o){r&&r.d(o)}}}function j$(t){let e,i;return e=new Mo({props:{$$slots:{default:[Pv]},$$scope:{ctx:t}}}),{c(){At(e.$$.fragment)},m(n,r){It(e,n,r),i=!0},p(n,r){const o={};8389632&r[0]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){D(e.$$.fragment,n),i=!1},d(n){Et(e,n)}}}function Pv(t){let e,i=t[27].icon+"";return{c(){e=Cr("g")},m(n,r){tt(n,e,r),e.innerHTML=i},p(n,r){1024&r[0]&&i!==(i=n[27].icon+"")&&(e.innerHTML=i)},d(n){n&&Q(e)}}}function U$(t){let e,i,n=t[27].label+"";return{c(){e=pt("span"),i=cn(n),w(e,"class",t[6])},m(r,o){tt(r,e,o),Tt(e,i)},p(r,o){1024&o[0]&&n!==(n=r[27].label+"")&&An(i,n),64&o[0]&&w(e,"class",r[6])},d(r){r&&Q(e)}}}function Rv(t){let e;const i=t[22].option,n=sr(i,t,t[23],O$),r=n||function(o){let a,s,l,c=o[27].icon&&j$(o),d=!o[27].hideLabel&&U$(o);return{c(){c&&c.c(),a=de(),d&&d.c(),s=de()},m(u,p){c&&c.m(u,p),tt(u,a,p),d&&d.m(u,p),tt(u,s,p),l=!0},p(u,p){u[27].icon?c?(c.p(u,p),1024&p[0]&&M(c,1)):(c=j$(u),c.c(),M(c,1),c.m(a.parentNode,a)):c&&(Fe(),D(c,1,1,()=>{c=null}),De()),u[27].hideLabel?d&&(d.d(1),d=null):d?d.p(u,p):(d=U$(u),d.c(),d.m(s.parentNode,s))},i(u){l||(M(c),l=!0)},o(u){D(c),l=!1},d(u){c&&c.d(u),u&&Q(a),d&&d.d(u),u&&Q(s)}}}(t);return{c(){r&&r.c()},m(o,a){r&&r.m(o,a),e=!0},p(o,a){n?n.p&&(!e||8389632&a[0])&&cr(n,i,o,o[23],e?lr(i,o[23],a,wv):dr(o[23]),O$):r&&r.p&&(!e||1088&a[0])&&r.p(o,e?a:[-1,-1])},i(o){e||(M(r,o),e=!0)},o(o){D(r,o),e=!1},d(o){r&&r.d(o)}}}function G$(t,e){let i,n,r;return n=new m2({props:{name:e[4],label:e[27].label,id:e[27].id,value:e[27].value,disabled:e[27].disabled,hidden:e[27].hidden,class:e[8],checked:e[12](e[27])===e[0],onkeydown:e[13](e[27]),onclick:e[14](e[27]),$$slots:{default:[Rv]},$$scope:{ctx:e}}}),{key:t,first:null,c(){i=Tn(),At(n.$$.fragment),this.first=i},m(o,a){tt(o,i,a),It(n,o,a),r=!0},p(o,a){e=o;const s={};16&a[0]&&(s.name=e[4]),1024&a[0]&&(s.label=e[27].label),1024&a[0]&&(s.id=e[27].id),1024&a[0]&&(s.value=e[27].value),1024&a[0]&&(s.disabled=e[27].disabled),1024&a[0]&&(s.hidden=e[27].hidden),256&a[0]&&(s.class=e[8]),1025&a[0]&&(s.checked=e[12](e[27])===e[0]),1024&a[0]&&(s.onkeydown=e[13](e[27])),1024&a[0]&&(s.onclick=e[14](e[27])),8389696&a[0]&&(s.$$scope={dirty:a,ctx:e}),n.$set(s)},i(o){r||(M(n.$$.fragment,o),r=!0)},o(o){D(n.$$.fragment,o),r=!1},d(o){o&&Q(i),Et(n,o)}}}function Z$(t,e){let i,n,r,o,a;const s=[Cv,kv],l=[];function c(d,u){return d[27].options?0:1}return n=c(e),r=l[n]=s[n](e),{key:t,first:null,c(){i=Tn(),r.c(),o=Tn(),this.first=i},m(d,u){tt(d,i,u),l[n].m(d,u),tt(d,o,u),a=!0},p(d,u){let p=n;n=c(e=d),n===p?l[n].p(e,u):(Fe(),D(l[p],1,1,()=>{l[p]=null}),De(),r=l[n],r?r.p(e,u):(r=l[n]=s[n](e),r.c()),M(r,1),r.m(o.parentNode,o))},i(d){a||(M(r),a=!0)},o(d){D(r),a=!1},d(d){d&&Q(i),l[n].d(d),d&&Q(o)}}}function Iv(t){let e,i,n,r=t[11].length&&_$(t);return{c(){r&&r.c(),e=de(),i=Tn()},m(o,a){r&&r.m(o,a),tt(o,e,a),tt(o,i,a),n=!0},p(o,a){o[11].length?r?(r.p(o,a),2048&a[0]&&M(r,1)):(r=_$(o),r.c(),M(r,1),r.m(e.parentNode,e)):r&&(Fe(),D(r,1,1,()=>{r=null}),De())},i(o){n||(M(r),M(!1),n=!0)},o(o){D(r),D(!1),n=!1},d(o){r&&r.d(o),o&&Q(e),o&&Q(i)}}}function Ev(t,e,i){let n,r,o,{$$slots:a={},$$scope:s}=e;const l=Sa();let{label:c}=e,{hideLabel:d=!0}=e,{class:u}=e,{name:p="radio-group-"+ra()}=e,{selectedIndex:h=-1}=e,{options:g=[]}=e,{onchange:m}=e,{layout:f}=e,{optionMapper:x}=e,{optionFilter:k}=e,{value:v}=e,{optionLabelClass:C}=e,{title:P}=e,{locale:I}=e,{optionClass:O}=e,{optionGroupClass:T}=e;const L=B=>o.findIndex(y=>y.id===B.id),F=(B,y)=>{i(0,h=L(B));const V={index:h,...B};((J,...S)=>{J&&J(...S)})(m,V,y),l("change",V)};return t.$$set=B=>{"label"in B&&i(1,c=B.label),"hideLabel"in B&&i(2,d=B.hideLabel),"class"in B&&i(3,u=B.class),"name"in B&&i(4,p=B.name),"selectedIndex"in B&&i(0,h=B.selectedIndex),"options"in B&&i(15,g=B.options),"onchange"in B&&i(16,m=B.onchange),"layout"in B&&i(5,f=B.layout),"optionMapper"in B&&i(17,x=B.optionMapper),"optionFilter"in B&&i(18,k=B.optionFilter),"value"in B&&i(19,v=B.value),"optionLabelClass"in B&&i(6,C=B.optionLabelClass),"title"in B&&i(7,P=B.title),"locale"in B&&i(20,I=B.locale),"optionClass"in B&&i(8,O=B.optionClass),"optionGroupClass"in B&&i(9,T=B.optionGroupClass),"$$scope"in B&&i(23,s=B.$$scope)},t.$$.update=()=>{1343488&t.$$.dirty[0]&&i(11,n=g2(k?g.filter(k):g,I)),133120&t.$$.dirty[0]&&i(10,r=((B=[],y)=>{let V=0;return B.map(J=>(V++,En(J)?En(J[1])?{id:V,label:J[0],options:J[1].map(S=>Vd(S,++V,y))}:Vd(J,V,y):J.options?{id:J.id||V,label:J.label,options:J.options.map(S=>Vd(S,++V,y))}:Vd(J,V,y)))})(n,x)),1024&t.$$.dirty[0]&&i(21,o=$s(r)),2654209&t.$$.dirty[0]&&h<0&&(i(0,h=o.findIndex(B=>f2(B.value,v))),h<0&&i(0,h=(B=>B.findIndex(y=>y[0]===void 0))(g)))},[h,c,d,u,p,f,C,P,O,T,r,n,L,B=>y=>{var V;V=y.key,/enter| /i.test(V)&&F(B,y)},B=>y=>{F(B,y)},g,m,x,k,v,I,o,a,s]}class Qa extends li{constructor(e){super(),si(this,e,Ev,Iv,ei,{label:1,hideLabel:2,class:3,name:4,selectedIndex:0,options:15,onchange:16,layout:5,optionMapper:17,optionFilter:18,value:19,optionLabelClass:6,title:7,locale:20,optionClass:8,optionGroupClass:9},null,[-1,-1])}}function X$(t){let e,i,n,r,o,a,s,l,c,d;return{c(){e=pt("div"),i=pt("button"),n=cn("▲"),o=de(),a=pt("button"),s=cn("▼"),w(i,"type","button"),w(i,"tabindex","-1"),w(i,"aria-label",r="increase "+t[7]),w(a,"type","button"),w(a,"tabindex","-1"),w(a,"aria-label",l="decrease "+t[7]),w(e,"class","PinturaInputSpinners")},m(u,p){tt(u,e,p),Tt(e,i),Tt(i,n),Tt(e,o),Tt(e,a),Tt(a,s),c||(d=[Mt(i,"click",t[17]),Mt(a,"click",t[18])],c=!0)},p(u,p){128&p&&r!==(r="increase "+u[7])&&w(i,"aria-label",r),128&p&&l!==(l="decrease "+u[7])&&w(a,"aria-label",l)},d(u){u&&Q(e),c=!1,_i(d)}}}function Av(t){let e,i,n,r,o,a,s=t[1]==="number"&&t[9]&&X$(t);return{c(){e=pt("div"),i=pt("input"),r=de(),s&&s.c(),w(i,"class","PinturaInputField"),w(i,"title",t[7]),w(i,"type",t[1]),w(i,"min",t[4]),w(i,"max",t[5]),w(i,"step",t[6]),w(i,"inputmode",t[3]),i.value=n=t[14]?t[13]:t[0],w(i,"style",t[11]),w(i,"placeholder",t[8]),w(i,"maxlength",t[12]),i.disabled=t[2],w(i,"spellcheck","false"),w(i,"autocorrect","off"),w(i,"autocapitalize","off"),w(e,"class","PinturaInput")},m(l,c){tt(l,e,c),Tt(e,i),t[27](i),Tt(e,r),s&&s.m(e,null),o||(a=[Mt(i,"input",t[16]),Mt(i,"blur",function(){ji(t[14]&&t[15])&&(t[14]&&t[15]).apply(this,arguments)}),Mt(i,"keydown",t[19]),Mt(i,"keyup",t[20])],o=!0)},p(l,[c]){t=l,128&c&&w(i,"title",t[7]),2&c&&w(i,"type",t[1]),16&c&&w(i,"min",t[4]),32&c&&w(i,"max",t[5]),64&c&&w(i,"step",t[6]),8&c&&w(i,"inputmode",t[3]),24577&c&&n!==(n=t[14]?t[13]:t[0])&&i.value!==n&&(i.value=n),2048&c&&w(i,"style",t[11]),256&c&&w(i,"placeholder",t[8]),4096&c&&w(i,"maxlength",t[12]),4&c&&(i.disabled=t[2]),t[1]==="number"&&t[9]?s?s.p(t,c):(s=X$(t),s.c(),s.m(e,null)):s&&(s.d(1),s=null)},i:Qe,o:Qe,d(l){l&&Q(e),t[27](null),s&&s.d(),o=!1,_i(a)}}}function Lv(t,e,i){let n,r,o,a,s,l,c,{value:d}=e,{type:u="text"}=e,{disabled:p=!1}=e,{inputmode:h}=e,{min:g}=e,{max:m}=e,{step:f}=e,{onchange:x=$e}=e,{onkeydown:k=$e}=e,{title:v}=e,{stepMultiplier:C=10}=e,{placeholder:P}=e,{enableSpinButtons:I=!0}=e,{enableStopPropagation:O=!1}=e;const T=()=>{let y=l.value;return u==="number"&&(y=h==="numeric"?parseInt(y,10):parseFloat(y),!xi(y)||Number.isNaN(y)?y=g||0:n&&(y=Yi(y,g,m))),y};let L=d;const F=()=>{const y=Yi(T()+(c?f*C:f),g,m);y!==d&&(i(25,L=y),i(0,d=y),x(d))},B=()=>{const y=Yi(T()-(c?f*C:f),g,m);y!==d&&(i(25,L=y),i(0,d=y),x(d))};return t.$$set=y=>{"value"in y&&i(0,d=y.value),"type"in y&&i(1,u=y.type),"disabled"in y&&i(2,p=y.disabled),"inputmode"in y&&i(3,h=y.inputmode),"min"in y&&i(4,g=y.min),"max"in y&&i(5,m=y.max),"step"in y&&i(6,f=y.step),"onchange"in y&&i(21,x=y.onchange),"onkeydown"in y&&i(22,k=y.onkeydown),"title"in y&&i(7,v=y.title),"stepMultiplier"in y&&i(23,C=y.stepMultiplier),"placeholder"in y&&i(8,P=y.placeholder),"enableSpinButtons"in y&&i(9,I=y.enableSpinButtons),"enableStopPropagation"in y&&i(24,O=y.enableStopPropagation)},t.$$.update=()=>{48&t.$$.dirty&&i(14,n=xi(g)&&xi(m)),33555457&t.$$.dirty&&i(13,r=l===document.activeElement?L:d),32&t.$$.dirty&&i(26,o=m?(m+"").length:void 0),67108872&t.$$.dirty&&i(12,a=h==="numeric"&&o?o:void 0),67108864&t.$$.dirty&&i(11,s=o?`min-width:${o}em`:void 0)},[d,u,p,h,g,m,f,v,P,I,l,s,a,r,n,()=>{i(25,L=T()),x(d)},()=>{i(25,L=l.value),x(T())},F,B,y=>{c=y.shiftKey,k(y);const{key:V}=y;O&&y.stopPropagation(),/up|down/i.test(V)&&(/up/i.test(V)&&F(),/down/i.test(V)&&B(),y.preventDefault(),y.stopPropagation())},y=>{const{key:V}=y;/up|down/i.test(V)&&(y.preventDefault(),y.stopPropagation())},x,k,C,O,L,o,function(y){zi[y?"unshift":"push"](()=>{l=y,i(10,l)})}]}class y2 extends li{constructor(e){super(),si(this,e,Lv,Av,ei,{value:0,type:1,disabled:2,inputmode:3,min:4,max:5,step:6,onchange:21,onkeydown:22,title:7,stepMultiplier:23,placeholder:8,enableSpinButtons:9,enableStopPropagation:24})}}const zv=t=>({}),Y$=t=>({});function Fv(t){let e,i,n,r,o=(t[2]||t[21])+"",a=t[6]&&q$(t);return{c(){a&&a.c(),e=de(),i=pt("span"),w(i,"class",n=ui(["PinturaButtonLabel",t[3],t[5]&&"implicit"]))},m(s,l){a&&a.m(s,l),tt(s,e,l),tt(s,i,l),i.innerHTML=o,r=!0},p(s,l){s[6]?a?(a.p(s,l),64&l[0]&&M(a,1)):(a=q$(s),a.c(),M(a,1),a.m(e.parentNode,e)):a&&(Fe(),D(a,1,1,()=>{a=null}),De()),(!r||2097156&l[0])&&o!==(o=(s[2]||s[21])+"")&&(i.innerHTML=o),(!r||40&l[0]&&n!==(n=ui(["PinturaButtonLabel",s[3],s[5]&&"implicit"])))&&w(i,"class",n)},i(s){r||(M(a),r=!0)},o(s){D(a),r=!1},d(s){a&&a.d(s),s&&Q(e),s&&Q(i)}}}function Dv(t){let e,i;return e=new y2({props:{value:t[10],onchange:t[17],enableStopPropagation:!0,type:"number",inputmode:"numeric",min:t[8].reduce(tg,1/0),max:t[8].reduce(eg,-1/0),enableSpinButtons:!1}}),{c(){At(e.$$.fragment)},m(n,r){It(e,n,r),i=!0},p(n,r){const o={};1024&r[0]&&(o.value=n[10]),131072&r[0]&&(o.onchange=n[17]),256&r[0]&&(o.min=n[8].reduce(tg,1/0)),256&r[0]&&(o.max=n[8].reduce(eg,-1/0)),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){D(e.$$.fragment,n),i=!1},d(n){Et(e,n)}}}function q$(t){let e,i;return e=new Mo({props:{class:"PinturaButtonIcon",$$slots:{default:[Bv]},$$scope:{ctx:t}}}),{c(){At(e.$$.fragment)},m(n,r){It(e,n,r),i=!0},p(n,r){const o={};536870976&r[0]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){D(e.$$.fragment,n),i=!1},d(n){Et(e,n)}}}function Bv(t){let e;return{c(){e=Cr("g")},m(i,n){tt(i,e,n),e.innerHTML=t[6]},p(i,n){64&n[0]&&(e.innerHTML=i[6])},d(i){i&&Q(e)}}}function Ov(t){let e,i,n,r,o,a;const s=[Dv,Fv],l=[];function c(d,u){return d[18]?0:1}return i=c(t),n=l[i]=s[i](t),{c(){e=pt("span"),n.c(),w(e,"slot","label"),w(e,"title",r=ar(t[1],t[16])),w(e,"class",o=ui(["PinturaButtonInner",t[18]&&"PinturaComboBox",t[4]]))},m(d,u){tt(d,e,u),l[i].m(e,null),a=!0},p(d,u){let p=i;i=c(d),i===p?l[i].p(d,u):(Fe(),D(l[p],1,1,()=>{l[p]=null}),De(),n=l[i],n?n.p(d,u):(n=l[i]=s[i](d),n.c()),M(n,1),n.m(e,null)),(!a||65538&u[0]&&r!==(r=ar(d[1],d[16])))&&w(e,"title",r),(!a||262160&u[0]&&o!==(o=ui(["PinturaButtonInner",d[18]&&"PinturaComboBox",d[4]])))&&w(e,"class",o)},i(d){a||(M(n),a=!0)},o(d){D(n),a=!1},d(d){d&&Q(e),l[i].d()}}}function Wv(t){let e,i,n=t[31].label+"";return{c(){e=pt("span"),i=cn(n),w(e,"slot","group")},m(r,o){tt(r,e,o),Tt(e,i)},p(r,o){1&o[1]&&n!==(n=r[31].label+"")&&An(i,n)},d(r){r&&Q(e)}}}function K$(t){let e,i;return e=new Mo({props:{style:tn(t[14])?t[14](t[31].value):t[14],$$slots:{default:[_v]},$$scope:{ctx:t}}}),{c(){At(e.$$.fragment)},m(n,r){It(e,n,r),i=!0},p(n,r){const o={};16384&r[0]|1&r[1]&&(o.style=tn(n[14])?n[14](n[31].value):n[14]),536870912&r[0]|1&r[1]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){D(e.$$.fragment,n),i=!1},d(n){Et(e,n)}}}function _v(t){let e,i=t[31].icon+"";return{c(){e=Cr("g")},m(n,r){tt(n,e,r),e.innerHTML=i},p(n,r){1&r[1]&&i!==(i=n[31].icon+"")&&(e.innerHTML=i)},d(n){n&&Q(e)}}}function J$(t){let e,i,n,r,o,a=t[31].label+"",s=t[31].sublabel&&Q$(t);return{c(){e=pt("span"),i=new bu(!1),n=de(),s&&s.c(),i.a=n,w(e,"style",r=tn(t[15])?t[15](t[31].value):t[15]),w(e,"class",o=ui(["PinturaDropdownOptionLabel",t[11]]))},m(l,c){tt(l,e,c),i.m(a,e),Tt(e,n),s&&s.m(e,null)},p(l,c){1&c[1]&&a!==(a=l[31].label+"")&&i.p(a),l[31].sublabel?s?s.p(l,c):(s=Q$(l),s.c(),s.m(e,null)):s&&(s.d(1),s=null),32768&c[0]|1&c[1]&&r!==(r=tn(l[15])?l[15](l[31].value):l[15])&&w(e,"style",r),2048&c[0]&&o!==(o=ui(["PinturaDropdownOptionLabel",l[11]]))&&w(e,"class",o)},d(l){l&&Q(e),s&&s.d()}}}function Q$(t){let e,i=t[31].sublabel+"";return{c(){e=pt("span"),w(e,"class","PinturaDropdownOptionSublabel")},m(n,r){tt(n,e,r),e.innerHTML=i},p(n,r){1&r[1]&&i!==(i=n[31].sublabel+"")&&(e.innerHTML=i)},d(n){n&&Q(e)}}}function Vv(t){let e,i,n,r=t[31].icon&&K$(t),o=!t[31].hideLabel&&J$(t);return{c(){e=pt("span"),r&&r.c(),i=de(),o&&o.c(),w(e,"slot","option")},m(a,s){tt(a,e,s),r&&r.m(e,null),Tt(e,i),o&&o.m(e,null),n=!0},p(a,s){a[31].icon?r?(r.p(a,s),1&s[1]&&M(r,1)):(r=K$(a),r.c(),M(r,1),r.m(e,i)):r&&(Fe(),D(r,1,1,()=>{r=null}),De()),a[31].hideLabel?o&&(o.d(1),o=null):o?o.p(a,s):(o=J$(a),o.c(),o.m(e,null))},i(a){n||(M(r),n=!0)},o(a){D(r),n=!1},d(a){a&&Q(e),r&&r.d(),o&&o.d()}}}function Nv(t){let e,i,n,r,o,a;const s=t[27].controls,l=sr(s,t,t[29],Y$);return n=new Qa({props:{class:"PinturaOptionsList PinturaScrollableContent",name:t[7],value:t[10],selectedIndex:t[9],optionFilter:t[12],optionMapper:t[13],optionLabelClass:ui(["PinturaDropdownOptionLabel",t[11]]),optionGroupClass:"PinturaListOptionGroup",optionClass:"PinturaListOption",options:t[19],onchange:t[22],$$slots:{option:[Vv,({option:c})=>({31:c}),({option:c})=>[0,c?1:0]],group:[Wv,({option:c})=>({31:c}),({option:c})=>[0,c?1:0]]},$$scope:{ctx:t}}}),{c(){e=pt("div"),l&&l.c(),i=de(),At(n.$$.fragment),w(e,"slot","details"),w(e,"class","PinturaOptionsListWrapper")},m(c,d){tt(c,e,d),l&&l.m(e,null),Tt(e,i),It(n,e,null),r=!0,o||(a=Mt(e,"keydown",t[24]),o=!0)},p(c,d){l&&l.p&&(!r||536870912&d[0])&&cr(l,s,c,c[29],r?lr(s,c[29],d,zv):dr(c[29]),Y$);const u={};128&d[0]&&(u.name=c[7]),1024&d[0]&&(u.value=c[10]),512&d[0]&&(u.selectedIndex=c[9]),4096&d[0]&&(u.optionFilter=c[12]),8192&d[0]&&(u.optionMapper=c[13]),2048&d[0]&&(u.optionLabelClass=ui(["PinturaDropdownOptionLabel",c[11]])),524288&d[0]&&(u.options=c[19]),536922112&d[0]|1&d[1]&&(u.$$scope={dirty:d,ctx:c}),n.$set(u)},i(c){r||(M(l,c),M(n.$$.fragment,c),r=!0)},o(c){D(l,c),D(n.$$.fragment,c),r=!1},d(c){c&&Q(e),l&&l.d(c),Et(n),o=!1,a()}}}function Hv(t){let e,i,n;function r(a){t[28](a)}let o={onshow:t[23],buttonClass:ui(["PinturaDropdownButton",t[0],t[5]&&"PinturaDropdownIconOnly"]),$$slots:{details:[Nv],label:[Ov]},$$scope:{ctx:t}};return t[20]!==void 0&&(o.isActive=t[20]),e=new Cu({props:o}),zi.push(()=>mo(e,"isActive",r)),{c(){At(e.$$.fragment)},m(a,s){It(e,a,s),n=!0},p(a,s){const l={};33&s[0]&&(l.buttonClass=ui(["PinturaDropdownButton",a[0],a[5]&&"PinturaDropdownIconOnly"])),540016638&s[0]&&(l.$$scope={dirty:s,ctx:a}),!i&&1048576&s[0]&&(i=!0,l.isActive=a[20],To(()=>i=!1)),e.$set(l)},i(a){n||(M(e.$$.fragment,a),n=!0)},o(a){D(e.$$.fragment,a),n=!1},d(a){Et(e,a)}}}const tg=(t,[e])=>e<t?e:t,eg=(t,[e])=>e>t?e:t;function jv(t,e,i){let n,r,{$$slots:o={},$$scope:a}=e,{class:s}=e,{title:l}=e,{label:c}=e,{labelClass:d}=e,{innerClass:u}=e,{hideLabel:p=!1}=e,{icon:h}=e,{name:g}=e,{options:m=[]}=e,{selectedIndex:f=-1}=e,{value:x}=e,{optionLabelClass:k}=e,{optionFilter:v}=e,{optionMapper:C}=e,{optionIconStyle:P}=e,{optionLabelStyle:I}=e,{locale:O}=e,{onchange:T=$e}=e,{onload:L=$e}=e,{ondestroy:F=$e}=e,{enableInput:B=!1}=e,y;return ws(()=>L({options:m})),No(()=>F({options:m})),t.$$set=V=>{"class"in V&&i(0,s=V.class),"title"in V&&i(1,l=V.title),"label"in V&&i(2,c=V.label),"labelClass"in V&&i(3,d=V.labelClass),"innerClass"in V&&i(4,u=V.innerClass),"hideLabel"in V&&i(5,p=V.hideLabel),"icon"in V&&i(6,h=V.icon),"name"in V&&i(7,g=V.name),"options"in V&&i(8,m=V.options),"selectedIndex"in V&&i(9,f=V.selectedIndex),"value"in V&&i(10,x=V.value),"optionLabelClass"in V&&i(11,k=V.optionLabelClass),"optionFilter"in V&&i(12,v=V.optionFilter),"optionMapper"in V&&i(13,C=V.optionMapper),"optionIconStyle"in V&&i(14,P=V.optionIconStyle),"optionLabelStyle"in V&&i(15,I=V.optionLabelStyle),"locale"in V&&i(16,O=V.locale),"onchange"in V&&i(17,T=V.onchange),"onload"in V&&i(25,L=V.onload),"ondestroy"in V&&i(26,F=V.ondestroy),"enableInput"in V&&i(18,B=V.enableInput),"$$scope"in V&&i(29,a=V.$$scope)},t.$$.update=()=>{65792&t.$$.dirty[0]&&i(19,n=O?g2(m,O):m),525312&t.$$.dirty[0]&&i(21,r=n.reduce((V,J)=>{if(V)return V;const S=Array.isArray(J)?J:[J,J],[H,K]=S;return f2(H,x)?K:void 0},void 0)||(V=>{const J=V.find(S=>S[0]===void 0);if(J)return J[1]})(n)||x)},[s,l,c,d,u,p,h,g,m,f,x,k,v,C,P,I,O,T,B,n,y,r,V=>{i(21,r=V.value),T(V),i(20,y=!1)},({e:V,panel:J})=>{if(V&&V.key&&/up|down/i.test(V.key))return Xp(J.querySelector("input:not([disabled])"));Xp(J.querySelector("fieldset"))},V=>{/tab/i.test(V.key)&&V.preventDefault()},L,F,o,function(V){y=V,i(20,y)},a]}class x2 extends li{constructor(e){super(),si(this,e,jv,Hv,ei,{class:0,title:1,label:2,labelClass:3,innerClass:4,hideLabel:5,icon:6,name:7,options:8,selectedIndex:9,value:10,optionLabelClass:11,optionFilter:12,optionMapper:13,optionIconStyle:14,optionLabelStyle:15,locale:16,onchange:17,onload:25,ondestroy:26,enableInput:18},null,[-1,-1])}}function Uv(t){let e;return{c(){e=pt("div"),w(e,"slot","details")},m(i,n){tt(i,e,n),t[14](e)},p:Qe,d(i){i&&Q(e),t[14](null)}}}function Gv(t){let e,i,n;function r(a){t[15](a)}let o={buttonLabel:t[0],buttonClass:t[1],buttonIcon:t[2],buttonHideLabel:t[3],buttonTitle:t[4],buttonLabelClass:t[5],onshow:t[6],onhide:t[7],$$slots:{details:[Uv]},$$scope:{ctx:t}};return t[9]!==void 0&&(o.isActive=t[9]),e=new Cu({props:o}),zi.push(()=>mo(e,"isActive",r)),{c(){At(e.$$.fragment)},m(a,s){It(e,a,s),n=!0},p(a,[s]){const l={};1&s&&(l.buttonLabel=a[0]),2&s&&(l.buttonClass=a[1]),4&s&&(l.buttonIcon=a[2]),8&s&&(l.buttonHideLabel=a[3]),16&s&&(l.buttonTitle=a[4]),32&s&&(l.buttonLabelClass=a[5]),64&s&&(l.onshow=a[6]),128&s&&(l.onhide=a[7]),65792&s&&(l.$$scope={dirty:s,ctx:a}),!i&&512&s&&(i=!0,l.isActive=a[9],To(()=>i=!1)),e.$set(l)},i(a){n||(M(e.$$.fragment,a),n=!0)},o(a){D(e.$$.fragment,a),n=!1},d(a){Et(e,a)}}}function Zv(t,e,i){let{buttonLabel:n}=e,{buttonClass:r}=e,{buttonIcon:o}=e,{buttonHideLabel:a}=e,{buttonTitle:s}=e,{buttonLabelClass:l}=e,{root:c}=e,{ondestroy:d=$e}=e,{onshow:u=$e}=e,{onhide:p=$e}=e,h,g=!1;return No(d),t.$$set=m=>{"buttonLabel"in m&&i(0,n=m.buttonLabel),"buttonClass"in m&&i(1,r=m.buttonClass),"buttonIcon"in m&&i(2,o=m.buttonIcon),"buttonHideLabel"in m&&i(3,a=m.buttonHideLabel),"buttonTitle"in m&&i(4,s=m.buttonTitle),"buttonLabelClass"in m&&i(5,l=m.buttonLabelClass),"root"in m&&i(10,c=m.root),"ondestroy"in m&&i(11,d=m.ondestroy),"onshow"in m&&i(6,u=m.onshow),"onhide"in m&&i(7,p=m.onhide)},t.$$.update=()=>{1280&t.$$.dirty&&h&&c&&h.firstChild!==c&&(h.hasChildNodes()?h.replaceChild(c,h.firstChild):h.append(c))},[n,r,o,a,s,l,u,p,h,g,c,d,()=>i(9,g=!1),()=>i(9,g=!0),function(m){zi[m?"unshift":"push"](()=>{h=m,i(8,h)})},function(m){g=m,i(9,g)}]}class Xv extends li{constructor(e){super(),si(this,e,Zv,Gv,ei,{buttonLabel:0,buttonClass:1,buttonIcon:2,buttonHideLabel:3,buttonTitle:4,buttonLabelClass:5,root:10,ondestroy:11,onshow:6,onhide:7,hide:12,show:13})}get hide(){return this.$$.ctx[12]}get show(){return this.$$.ctx[13]}}var xc=(t,e,i)=>(t-e)/(i-e);const Yv=t=>({}),ig=t=>({});function ng(t){let e,i,n,r,o,a,s,l;return i=new Mo({props:{$$slots:{default:[qv]},$$scope:{ctx:t}}}),o=new Mo({props:{$$slots:{default:[Kv]},$$scope:{ctx:t}}}),{c(){e=pt("button"),At(i.$$.fragment),n=de(),r=pt("button"),At(o.$$.fragment),w(e,"type","button"),w(e,"aria-label","Increase"),w(r,"type","button"),w(r,"aria-label","Decrease")},m(c,d){tt(c,e,d),It(i,e,null),tt(c,n,d),tt(c,r,d),It(o,r,null),a=!0,s||(l=[Mt(e,"pointerdown",t[20](1)),Mt(r,"pointerdown",t[20](-1))],s=!0)},p(c,d){const u={};128&d[1]&&(u.$$scope={dirty:d,ctx:c}),i.$set(u);const p={};128&d[1]&&(p.$$scope={dirty:d,ctx:c}),o.$set(p)},i(c){a||(M(i.$$.fragment,c),M(o.$$.fragment,c),a=!0)},o(c){D(i.$$.fragment,c),D(o.$$.fragment,c),a=!1},d(c){c&&Q(e),Et(i),c&&Q(n),c&&Q(r),Et(o),s=!1,_i(l)}}}function qv(t){let e;return{c(){e=Cr("path"),w(e,"d","M8 12 h8 M12 8 v8")},m(i,n){tt(i,e,n)},p:Qe,d(i){i&&Q(e)}}}function Kv(t){let e;return{c(){e=Cr("path"),w(e,"d","M9 12 h6")},m(i,n){tt(i,e,n)},p:Qe,d(i){i&&Q(e)}}}function Jv(t){let e,i,n,r,o,a,s,l,c,d,u,p,h,g,m,f,x;const k=t[36].default,v=sr(k,t,t[38],null),C=t[36].knob,P=sr(C,t,t[38],ig);let I=t[9]&&ng(t);return{c(){e=pt("div"),i=pt("div"),n=pt("input"),o=de(),a=pt("div"),v&&v.c(),l=de(),c=pt("div"),d=pt("div"),P&&P.c(),h=de(),I&&I.c(),w(n,"type","range"),w(n,"id",t[3]),w(n,"min",t[0]),w(n,"max",t[1]),w(n,"step",t[2]),n.value=t[14],w(n,"style",r=t[10]?"pointer-events:none":""),w(a,"class",s=ui(["PinturaSliderTrack",t[5]])),w(a,"style",t[4]),w(d,"class",u=ui(["PinturaSliderKnob",t[7]])),w(d,"style",t[6]),w(c,"class","PinturaSliderKnobController"),w(c,"style",t[17]),w(i,"class","PinturaSliderControl"),w(i,"style",p="--slider-position:"+Math.round(t[15])),w(e,"class",g=ui(["PinturaSlider",t[12]])),w(e,"data-direction",t[8])},m(O,T){tt(O,e,T),Tt(e,i),Tt(i,n),t[37](n),Tt(i,o),Tt(i,a),v&&v.m(a,null),Tt(i,l),Tt(i,c),Tt(c,d),P&&P.m(d,null),Tt(e,h),I&&I.m(e,null),m=!0,f||(x=[Mt(n,"input",t[18]),Mt(n,"nudge",t[19]),Ui(Ts.call(null,n)),Mt(i,"pointerdown",function(){ji(t[11]&&t[13])&&(t[11]&&t[13]).apply(this,arguments)})],f=!0)},p(O,T){t=O,(!m||8&T[0])&&w(n,"id",t[3]),(!m||1&T[0])&&w(n,"min",t[0]),(!m||2&T[0])&&w(n,"max",t[1]),(!m||4&T[0])&&w(n,"step",t[2]),(!m||16384&T[0])&&(n.value=t[14]),(!m||1024&T[0]&&r!==(r=t[10]?"pointer-events:none":""))&&w(n,"style",r),v&&v.p&&(!m||128&T[1])&&cr(v,k,t,t[38],m?lr(k,t[38],T,null):dr(t[38]),null),(!m||32&T[0]&&s!==(s=ui(["PinturaSliderTrack",t[5]])))&&w(a,"class",s),(!m||16&T[0])&&w(a,"style",t[4]),P&&P.p&&(!m||128&T[1])&&cr(P,C,t,t[38],m?lr(C,t[38],T,Yv):dr(t[38]),ig),(!m||128&T[0]&&u!==(u=ui(["PinturaSliderKnob",t[7]])))&&w(d,"class",u),(!m||64&T[0])&&w(d,"style",t[6]),(!m||131072&T[0])&&w(c,"style",t[17]),(!m||32768&T[0]&&p!==(p="--slider-position:"+Math.round(t[15])))&&w(i,"style",p),t[9]?I?(I.p(t,T),512&T[0]&&M(I,1)):(I=ng(t),I.c(),M(I,1),I.m(e,null)):I&&(Fe(),D(I,1,1,()=>{I=null}),De()),(!m||4096&T[0]&&g!==(g=ui(["PinturaSlider",t[12]])))&&w(e,"class",g),(!m||256&T[0])&&w(e,"data-direction",t[8])},i(O){m||(M(v,O),M(P,O),M(I),m=!0)},o(O){D(v,O),D(P,O),D(I),m=!1},d(O){O&&Q(e),t[37](null),v&&v.d(O),P&&P.d(O),I&&I.d(),f=!1,_i(x)}}}function Qv(t,e,i){let n,r,o,a,s,l,c,d,u,p,h,g,m,f,x,{$$slots:k={},$$scope:v}=e,{min:C=0}=e,{max:P=100}=e,{step:I=1}=e,{id:O}=e,{value:T=0}=e,{valueMin:L}=e,{valueMax:F}=e,{trackStyle:B}=e,{trackClass:y}=e,{knobStyle:V}=e,{knobClass:J}=e,{ongrab:S=$e}=e,{onchange:H=$e}=e,{onrelease:K=$e}=e,{onexceed:ut=$e}=e,{direction:lt="x"}=e,{getValue:N=Xi}=e,{setValue:ft=Xi}=e,{enableSpinButtons:$t=!0}=e,{enableForceUseKnob:Lt=!1}=e,{enableStopPropagation:ct=!0}=e,{enablePointerdownListener:et=!0}=e,{maxInteractionDistance:ht=6}=e,{class:Y}=e;const Z=wt=>ft(((yt,Gt)=>(Gt=1/Gt,Math.round(yt*Gt)/Gt))(Yi(wt,C,P),I),T),St=(wt,yt,Gt={})=>{const{grabbed:ue=!1,released:pe=!1}=Gt,ve=Z(C+wt/yt*r),ge=L||C,_=F||P;i(21,T=Oe(ve)?ve:Yi(ve,ge,_)),x!==ve&&(x=ve,!Oe(ve)&&(ve<ge||ve>_)&&ut(T,ve),T!==f&&(f=T,ue&&S(T),H(T),pe&&K(T)))};let nt;const mt=wt=>{const yt=wt[d]-m;St(g+yt,h)},Ft=wt=>{h=void 0,document.documentElement.removeEventListener("pointermove",mt),document.documentElement.removeEventListener("pointerup",Ft),H(T),K(T)},oe=()=>{i(21,T=Z(n+Ut*I)),H(T)};let Rt,Ut=1,Ot=!1;const j=wt=>{clearTimeout(Rt),Ot||oe(),K(T),document.removeEventListener("pointerup",j)};return t.$$set=wt=>{"min"in wt&&i(0,C=wt.min),"max"in wt&&i(1,P=wt.max),"step"in wt&&i(2,I=wt.step),"id"in wt&&i(3,O=wt.id),"value"in wt&&i(21,T=wt.value),"valueMin"in wt&&i(22,L=wt.valueMin),"valueMax"in wt&&i(23,F=wt.valueMax),"trackStyle"in wt&&i(4,B=wt.trackStyle),"trackClass"in wt&&i(5,y=wt.trackClass),"knobStyle"in wt&&i(6,V=wt.knobStyle),"knobClass"in wt&&i(7,J=wt.knobClass),"ongrab"in wt&&i(24,S=wt.ongrab),"onchange"in wt&&i(25,H=wt.onchange),"onrelease"in wt&&i(26,K=wt.onrelease),"onexceed"in wt&&i(27,ut=wt.onexceed),"direction"in wt&&i(8,lt=wt.direction),"getValue"in wt&&i(28,N=wt.getValue),"setValue"in wt&&i(29,ft=wt.setValue),"enableSpinButtons"in wt&&i(9,$t=wt.enableSpinButtons),"enableForceUseKnob"in wt&&i(10,Lt=wt.enableForceUseKnob),"enableStopPropagation"in wt&&i(30,ct=wt.enableStopPropagation),"enablePointerdownListener"in wt&&i(11,et=wt.enablePointerdownListener),"maxInteractionDistance"in wt&&i(31,ht=wt.maxInteractionDistance),"class"in wt&&i(12,Y=wt.class),"$$scope"in wt&&i(38,v=wt.$$scope)},t.$$.update=()=>{270532608&t.$$.dirty[0]&&i(14,n=T!==void 0?N(T):0),3&t.$$.dirty[0]&&(r=P-C),16387&t.$$.dirty[0]&&i(33,o=xc(n,C,P)),4&t.$$.dirty[1]&&i(15,a=100*o),256&t.$$.dirty[0]&&i(34,s=lt.toUpperCase()),256&t.$$.dirty[0]&&i(35,l=lt==="x"?"Width":"Height"),16&t.$$.dirty[1]&&(c="offset"+l),t.$$.dirty[1],8&t.$$.dirty[1]&&(d="page"+s),32768&t.$$.dirty[0]|8&t.$$.dirty[1]&&i(17,u=`transform: translate${s}(${a}%)`)},[C,P,I,O,B,y,V,J,lt,$t,Lt,et,Y,wt=>{let yt=!1;ct&&wt.stopPropagation(),clearTimeout(nt);const Gt=p.getBoundingClientRect();if(h=p[c],m=wt[d],g=m-Gt[lt],Lt){if(Math.abs(g-o*h)>ht)return;yt=!0,wt.stopPropagation()}return document.activeElement!==p&&p.focus(),St(g,h,{grabbed:!0}),document.documentElement.addEventListener("pointermove",mt),document.documentElement.addEventListener("pointerup",Ft),yt},n,a,p,u,wt=>{h||(i(21,T=ft(parseFloat(wt.target.value))),T!==f&&(f=T,H(T)))},wt=>{const yt=p[c];St(n/r*yt+wt.detail[lt],yt),clearTimeout(nt),nt=setTimeout(()=>{K(T)},250)},wt=>yt=>{clearTimeout(nt),Ut=wt,Ot=!1,Rt=setInterval(()=>{Ot=!0,oe()},100),document.addEventListener("pointercancel",j),document.addEventListener("pointerup",j)},T,L,F,S,H,K,ut,N,ft,ct,ht,wt=>{const yt=p.getBoundingClientRect(),Gt=wt[d]-yt[lt],ue=p[c];return Math.abs(Gt-o*ue)},o,s,l,k,function(wt){zi[wt?"unshift":"push"](()=>{p=wt,i(16,p)})},v]}class _h extends li{constructor(e){super(),si(this,e,Qv,Jv,ei,{min:0,max:1,step:2,id:3,value:21,valueMin:22,valueMax:23,trackStyle:4,trackClass:5,knobStyle:6,knobClass:7,ongrab:24,onchange:25,onrelease:26,onexceed:27,direction:8,getValue:28,setValue:29,enableSpinButtons:9,enableForceUseKnob:10,enableStopPropagation:30,enablePointerdownListener:11,maxInteractionDistance:31,class:12,eventDistanceToKnob:32,handlePointerDown:13},null,[-1,-1])}get eventDistanceToKnob(){return this.$$.ctx[32]}get handlePointerDown(){return this.$$.ctx[13]}}function rg(t){let e,i;return e=new Mo({props:{class:"PinturaButtonIcon",$$slots:{default:[t5]},$$scope:{ctx:t}}}),{c(){At(e.$$.fragment)},m(n,r){It(e,n,r),i=!0},p(n,r){const o={};1048580&r&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){D(e.$$.fragment,n),i=!1},d(n){Et(e,n)}}}function t5(t){let e;return{c(){e=Cr("g")},m(i,n){tt(i,e,n),e.innerHTML=t[2]},p(i,n){4&n&&(e.innerHTML=i[2])},d(i){i&&Q(e)}}}function og(t){let e,i,n=ar(t[8],t[6])+"";return{c(){e=pt("span"),i=cn(n),w(e,"class","PinturaButtonLabelPrefix")},m(r,o){tt(r,e,o),Tt(e,i)},p(r,o){320&o&&n!==(n=ar(r[8],r[6])+"")&&An(i,n)},d(r){r&&Q(e)}}}function e5(t){let e,i,n,r,o,a,s,l,c,d=t[2]&&rg(t),u=t[8]&&og(t);return{c(){e=pt("span"),d&&d.c(),i=de(),u&&u.c(),n=de(),r=pt("span"),o=cn(t[9]),w(r,"class",a=ui(["PinturaButtonLabel",t[3],t[5]&&"implicit"])),w(e,"slot","label"),w(e,"title",s=ar(t[1],t[6])),w(e,"class",l=ui(["PinturaButtonInner",t[4]]))},m(p,h){tt(p,e,h),d&&d.m(e,null),Tt(e,i),u&&u.m(e,null),Tt(e,n),Tt(e,r),Tt(r,o),c=!0},p(p,h){p[2]?d?(d.p(p,h),4&h&&M(d,1)):(d=rg(p),d.c(),M(d,1),d.m(e,i)):d&&(Fe(),D(d,1,1,()=>{d=null}),De()),p[8]?u?u.p(p,h):(u=og(p),u.c(),u.m(e,n)):u&&(u.d(1),u=null),(!c||512&h)&&An(o,p[9]),(!c||40&h&&a!==(a=ui(["PinturaButtonLabel",p[3],p[5]&&"implicit"])))&&w(r,"class",a),(!c||66&h&&s!==(s=ar(p[1],p[6])))&&w(e,"title",s),(!c||16&h&&l!==(l=ui(["PinturaButtonInner",p[4]])))&&w(e,"class",l)},i(p){c||(M(d),c=!0)},o(p){D(d),c=!1},d(p){p&&Q(e),d&&d.d(),u&&u.d()}}}function i5(t){let e,i,n,r,o;const a=[t[12],{value:t[7]},{onchange:t[11]}];let s={};for(let l=0;l<a.length;l+=1)s=Cn(s,a[l]);return i=new _h({props:s}),{c(){e=pt("div"),At(i.$$.fragment),w(e,"slot","details")},m(l,c){tt(l,e,c),It(i,e,null),n=!0,r||(o=Mt(e,"keydown",t[10]),r=!0)},p(l,c){const d=6272&c?Tr(a,[4096&c&&zr(l[12]),128&c&&{value:l[7]},2048&c&&{onchange:l[11]}]):{};i.$set(d)},i(l){n||(M(i.$$.fragment,l),n=!0)},o(l){D(i.$$.fragment,l),n=!1},d(l){l&&Q(e),Et(i),r=!1,o()}}}function n5(t){let e,i;return e=new Cu({props:{panelClass:"PinturaSliderPanel",buttonClass:ui(["PinturaSliderButton",t[0],t[5]&&"PinturaSliderIconOnly"]),$$slots:{details:[i5],label:[e5]},$$scope:{ctx:t}}}),{c(){At(e.$$.fragment)},m(n,r){It(e,n,r),i=!0},p(n,[r]){const o={};33&r&&(o.buttonClass=ui(["PinturaSliderButton",n[0],n[5]&&"PinturaSliderIconOnly"])),1053694&r&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){D(e.$$.fragment,n),i=!1},d(n){Et(e,n)}}}function r5(t,e,i){const n=["class","title","label","icon","labelClass","innerClass","hideLabel","locale","value","onchange","labelPrefix"];let r=Wm(e,n),{class:o}=e,{title:a}=e,{label:s=Math.round}=e,{icon:l}=e,{labelClass:c}=e,{innerClass:d}=e,{hideLabel:u=!1}=e,{locale:p}=e,{value:h}=e,{onchange:g=$e}=e,{labelPrefix:m}=e;const{min:f,max:x,getValue:k=Xi}=r;let v;const C=P=>i(9,v=(I=>tn(s)?s(k(I),f,x,I):s)(P));return t.$$set=P=>{e=Cn(Cn({},e),Pc(P)),i(12,r=Wm(e,n)),"class"in P&&i(0,o=P.class),"title"in P&&i(1,a=P.title),"label"in P&&i(13,s=P.label),"icon"in P&&i(2,l=P.icon),"labelClass"in P&&i(3,c=P.labelClass),"innerClass"in P&&i(4,d=P.innerClass),"hideLabel"in P&&i(5,u=P.hideLabel),"locale"in P&&i(6,p=P.locale),"value"in P&&i(7,h=P.value),"onchange"in P&&i(14,g=P.onchange),"labelPrefix"in P&&i(8,m=P.labelPrefix)},t.$$.update=()=>{8320&t.$$.dirty&&C(h)},[o,a,l,c,d,u,p,h,m,v,P=>{/tab/i.test(P.key)&&P.preventDefault()},P=>{C(P),g(P)},r,s,g]}class o5 extends li{constructor(e){super(),si(this,e,r5,n5,ei,{class:0,title:1,label:13,icon:2,labelClass:3,innerClass:4,hideLabel:5,locale:6,value:7,onchange:14,labelPrefix:8})}}function ag(t){let e,i,n=ar(t[0],t[1])+"";return{c(){e=pt("span"),i=cn(n),w(e,"class",t[3])},m(r,o){tt(r,e,o),Tt(e,i)},p(r,o){3&o&&n!==(n=ar(r[0],r[1])+"")&&An(i,n),8&o&&w(e,"class",r[3])},d(r){r&&Q(e)}}}function a5(t){let e,i,n,r,o=t[0]&&ag(t);return n=new $o({props:{items:t[2]}}),{c(){e=pt("li"),o&&o.c(),i=de(),At(n.$$.fragment),w(e,"class","PinturaShapeStyle")},m(a,s){tt(a,e,s),o&&o.m(e,null),Tt(e,i),It(n,e,null),r=!0},p(a,[s]){a[0]?o?o.p(a,s):(o=ag(a),o.c(),o.m(e,i)):o&&(o.d(1),o=null);const l={};4&s&&(l.items=a[2]),n.$set(l)},i(a){r||(M(n.$$.fragment,a),r=!0)},o(a){D(n.$$.fragment,a),r=!1},d(a){a&&Q(e),o&&o.d(),Et(n)}}}function s5(t,e,i){let n,{title:r}=e,{locale:o}=e,{items:a}=e,{hideTitle:s=!1}=e;return t.$$set=l=>{"title"in l&&i(0,r=l.title),"locale"in l&&i(1,o=l.locale),"items"in l&&i(2,a=l.items),"hideTitle"in l&&i(4,s=l.hideTitle)},t.$$.update=()=>{16&t.$$.dirty&&i(3,n="PinturaShapeStyleLabel"+(s?" implicit":""))},[r,o,a,n,s]}class l5 extends li{constructor(e){super(),si(this,e,s5,a5,ei,{title:0,locale:1,items:2,hideTitle:4})}}var sg=(t,e,i)=>{let n,r,o;const a=Math.floor(6*t),s=6*t-a,l=i*(1-e),c=i*(1-s*e),d=i*(1-(1-s)*e);switch(a%6){case 0:n=i,r=d,o=l;break;case 1:n=c,r=i,o=l;break;case 2:n=l,r=i,o=d;break;case 3:n=l,r=c,o=i;break;case 4:n=d,r=l,o=i;break;case 5:n=i,r=l,o=c}return[n,r,o]};function c5(t){let e,i,n;return{c(){e=pt("div"),i=pt("span"),w(e,"class","PinturaColorPreview"),w(e,"title",t[0]),w(e,"style",n="--color:"+t[1])},m(r,o){tt(r,e,o),Tt(e,i)},p(r,[o]){1&o&&w(e,"title",r[0]),2&o&&n!==(n="--color:"+r[1])&&w(e,"style",n)},i:Qe,o:Qe,d(r){r&&Q(e)}}}function d5(t,e,i){let n,{color:r}=e,{title:o}=e;return t.$$set=a=>{"color"in a&&i(2,r=a.color),"title"in a&&i(0,o=a.title)},t.$$.update=()=>{4&t.$$.dirty&&i(1,n=r?kr(r):"transparent")},[o,n,r]}class Vh extends li{constructor(e){super(),si(this,e,d5,c5,ei,{color:2,title:0})}}var b2=t=>(t=t.trim(),/^rgba/.test(t)?t.substr(5).split(",").map(parseFloat).map((e,i)=>e/(i===3?1:255)):/^rgb/.test(t)?t.substr(4).split(",").map(parseFloat).map(e=>e/255):/^#/.test(t)?(e=>{const[,i,n,r,o]=e.split("");e=e.length>=4&&e.length<=5?`#${i}${i}${n}${n}${r}${r}${o?`${o}${o}`:""}`:e;const[a,s,l,c,d]=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})?$/i.exec(e)||[];if(a)return[s,l,c,d].filter(u=>u!==void 0).map(u=>parseInt(u,16)/255)})(t):/[0-9]{1,3}\s?,\s?[0-9]{1,3}\s?,\s?[0-9]{1,3}/.test(t)?t.split(",").map(e=>parseInt(e,10)).map(e=>e/255):void 0);function lg(t){let e,i;return{c(){e=pt("span"),i=cn(t[0])},m(n,r){tt(n,e,r),Tt(e,i)},p(n,r){1&r[0]&&An(i,n[0])},d(n){n&&Q(e)}}}function u5(t){let e,i,n,r;i=new Vh({props:{color:t[4],title:ar(t[8],t[10])}});let o=!t[9]&&lg(t);return{c(){e=pt("span"),At(i.$$.fragment),n=de(),o&&o.c(),w(e,"slot","label"),w(e,"class","PinturaButtonLabel")},m(a,s){tt(a,e,s),It(i,e,null),Tt(e,n),o&&o.m(e,null),r=!0},p(a,s){const l={};16&s[0]&&(l.color=a[4]),1280&s[0]&&(l.title=ar(a[8],a[10])),i.$set(l),a[9]?o&&(o.d(1),o=null):o?o.p(a,s):(o=lg(a),o.c(),o.m(e,null))},i(a){r||(M(i.$$.fragment,a),r=!0)},o(a){D(i.$$.fragment,a),r=!1},d(a){a&&Q(e),Et(i),o&&o.d()}}}function cg(t){let e,i,n,r,o,a,s,l,c,d,u,p,h,g;c=new _h({props:{class:"PinturaHuePicker",knobStyle:"background-color:"+t[20],onchange:t[26],value:t[15],min:0,max:1,step:.01}});let m=t[11]&&dg(t),f=t[14]&&ug(t);return{c(){e=pt("div"),i=pt("div"),n=pt("div"),r=pt("div"),l=de(),At(c.$$.fragment),d=de(),m&&m.c(),u=de(),f&&f.c(),w(r,"role","button"),w(r,"aria-label","Saturation slider"),w(r,"class","PinturaPickerKnob"),w(r,"tabindex","0"),w(r,"style",o=`background-color:${t[19]};`),w(n,"class","PinturaPickerKnobController"),w(n,"style",a=`transform:translate(${t[24]}%,${t[23]}%)`),w(i,"class","PinturaSaturationPicker"),w(i,"style",s="background-color: "+t[20]),w(e,"class","PinturaPicker")},m(x,k){tt(x,e,k),Tt(e,i),Tt(i,n),Tt(n,r),t[38](i),Tt(e,l),It(c,e,null),Tt(e,d),m&&m.m(e,null),Tt(e,u),f&&f.m(e,null),p=!0,h||(g=[Mt(r,"nudge",t[29]),Ui(Ts.call(null,r,{preventDefault:!0})),Mt(i,"pointerdown",t[28])],h=!0)},p(x,k){(!p||524288&k[0]&&o!==(o=`background-color:${x[19]};`))&&w(r,"style",o),(!p||25165824&k[0]&&a!==(a=`transform:translate(${x[24]}%,${x[23]}%)`))&&w(n,"style",a),(!p||1048576&k[0]&&s!==(s="background-color: "+x[20]))&&w(i,"style",s);const v={};1048576&k[0]&&(v.knobStyle="background-color:"+x[20]),32768&k[0]&&(v.value=x[15]),c.$set(v),x[11]?m?(m.p(x,k),2048&k[0]&&M(m,1)):(m=dg(x),m.c(),M(m,1),m.m(e,u)):m&&(Fe(),D(m,1,1,()=>{m=null}),De()),x[14]?f?f.p(x,k):(f=ug(x),f.c(),f.m(e,null)):f&&(f.d(1),f=null)},i(x){p||(M(c.$$.fragment,x),M(m),p=!0)},o(x){D(c.$$.fragment,x),D(m),p=!1},d(x){x&&Q(e),t[38](null),Et(c),m&&m.d(),f&&f.d(),h=!1,_i(g)}}}function dg(t){let e,i;return e=new _h({props:{class:"PinturaOpacityPicker",knobStyle:"background-color:"+t[17],trackStyle:`background-image:linear-gradient(to right,${t[18]},${t[19]})`,onchange:t[27],value:t[16],min:0,max:1,step:.01}}),{c(){At(e.$$.fragment)},m(n,r){It(e,n,r),i=!0},p(n,r){const o={};131072&r[0]&&(o.knobStyle="background-color:"+n[17]),786432&r[0]&&(o.trackStyle=`background-image:linear-gradient(to right,${n[18]},${n[19]})`),65536&r[0]&&(o.value=n[16]),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){D(e.$$.fragment,n),i=!1},d(n){Et(e,n)}}}function ug(t){let e,i,n;return{c(){e=pt("input"),w(e,"class","PinturaColorPickerInput"),w(e,"type","text"),e.value=t[22]},m(r,o){tt(r,e,o),i||(n=[Mt(e,"keydown",t[31]),Mt(e,"input",t[30])],i=!0)},p(r,o){4194304&o[0]&&e.value!==r[22]&&(e.value=r[22])},d(r){r&&Q(e),i=!1,_i(n)}}}function pg(t){let e,i;return e=new Qa({props:{label:ar(t[10].labelColorPalette,t[10]),class:ui(["PinturaColorPresets",t[9]?"PinturaColorPresetsGrid":"PinturaColorPresetsList"]),hideLabel:!1,name:t[1],value:t[4],optionGroupClass:"PinturaListOptionGroup",optionClass:"PinturaListOption",options:t[2].map(t[39]),selectedIndex:t[3],optionMapper:t[7],optionLabelClass:t[6],onchange:t[40],$$slots:{option:[h5,({option:n})=>({52:n}),({option:n})=>[0,n?2097152:0]],group:[p5,({option:n})=>({52:n}),({option:n})=>[0,n?2097152:0]]},$$scope:{ctx:t}}}),{c(){At(e.$$.fragment)},m(n,r){It(e,n,r),i=!0},p(n,r){const o={};1024&r[0]&&(o.label=ar(n[10].labelColorPalette,n[10])),512&r[0]&&(o.class=ui(["PinturaColorPresets",n[9]?"PinturaColorPresetsGrid":"PinturaColorPresetsList"])),2&r[0]&&(o.name=n[1]),16&r[0]&&(o.value=n[4]),1028&r[0]&&(o.options=n[2].map(n[39])),8&r[0]&&(o.selectedIndex=n[3]),128&r[0]&&(o.optionMapper=n[7]),64&r[0]&&(o.optionLabelClass=n[6]),512&r[0]|6291456&r[1]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){D(e.$$.fragment,n),i=!1},d(n){Et(e,n)}}}function p5(t){let e,i,n=t[52].label+"";return{c(){e=pt("span"),i=cn(n),w(e,"slot","group")},m(r,o){tt(r,e,o),Tt(e,i)},p(r,o){2097152&o[1]&&n!==(n=r[52].label+"")&&An(i,n)},d(r){r&&Q(e)}}}function hg(t){let e,i,n=t[52].label+"";return{c(){e=pt("span"),i=cn(n),w(e,"class","PinturaButtonLabel")},m(r,o){tt(r,e,o),Tt(e,i)},p(r,o){2097152&o[1]&&n!==(n=r[52].label+"")&&An(i,n)},d(r){r&&Q(e)}}}function h5(t){let e,i,n,r;i=new Vh({props:{title:t[52].label,color:t[52].value}});let o=!t[9]&&hg(t);return{c(){e=pt("span"),At(i.$$.fragment),n=de(),o&&o.c(),w(e,"slot","option")},m(a,s){tt(a,e,s),It(i,e,null),Tt(e,n),o&&o.m(e,null),r=!0},p(a,s){const l={};2097152&s[1]&&(l.title=a[52].label),2097152&s[1]&&(l.color=a[52].value),i.$set(l),a[9]?o&&(o.d(1),o=null):o?o.p(a,s):(o=hg(a),o.c(),o.m(e,null))},i(a){r||(M(i.$$.fragment,a),r=!0)},o(a){D(i.$$.fragment,a),r=!1},d(a){a&&Q(e),Et(i),o&&o.d()}}}function m5(t){let e,i,n,r=t[13]&&cg(t),o=t[12]&&pg(t);return{c(){e=pt("div"),r&&r.c(),i=de(),o&&o.c(),w(e,"slot","details"),w(e,"class","PinturaColorPickerPanel")},m(a,s){tt(a,e,s),r&&r.m(e,null),Tt(e,i),o&&o.m(e,null),n=!0},p(a,s){a[13]?r?(r.p(a,s),8192&s[0]&&M(r,1)):(r=cg(a),r.c(),M(r,1),r.m(e,i)):r&&(Fe(),D(r,1,1,()=>{r=null}),De()),a[12]?o?(o.p(a,s),4096&s[0]&&M(o,1)):(o=pg(a),o.c(),M(o,1),o.m(e,null)):o&&(Fe(),D(o,1,1,()=>{o=null}),De())},i(a){n||(M(r),M(o),n=!0)},o(a){D(r),D(o),n=!1},d(a){a&&Q(e),r&&r.d(),o&&o.d()}}}function $5(t){let e,i;return e=new Cu({props:{buttonClass:ui(["PinturaColorPickerButton",t[5]]),$$slots:{details:[m5],label:[u5]},$$scope:{ctx:t}}}),{c(){At(e.$$.fragment)},m(n,r){It(e,n,r),i=!0},p(n,r){const o={};32&r[0]&&(o.buttonClass=ui(["PinturaColorPickerButton",n[5]])),33554399&r[0]|4194304&r[1]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){D(e.$$.fragment,n),i=!1},d(n){Et(e,n)}}}function g5(t,e,i){let n,r,o,a,s,l,c,d,u,p,h,g,m,f,{label:x}=e,{name:k}=e,{options:v=[]}=e,{selectedIndex:C=-1}=e,{value:P}=e,{buttonClass:I}=e,{optionLabelClass:O}=e,{optionMapper:T}=e,{onchange:L}=e,{title:F}=e,{hidePresetLabel:B=!0}=e,{locale:y}=e,{enableOpacity:V=!0}=e,{enablePresets:J=!0}=e,{enablePicker:S=!0}=e,{enableInput:H=!1}=e;const K=(Z,St)=>{if(u=[Z[0],Z[1],Z[2]],St){let nt=((mt,Ft,oe)=>{let Rt=Math.max(mt,Ft,oe),Ut=Rt-Math.min(mt,Ft,oe),Ot=Ut&&(Rt==mt?(Ft-oe)/Ut:Rt==Ft?2+(oe-mt)/Ut:4+(mt-Ft)/Ut);return[60*(Ot<0?Ot+6:Ot)/360,Rt&&Ut/Rt,Rt]})(...u);i(15,s=nt[0]),i(33,l=nt[1]),i(34,c=nt[2]),i(16,d=xi(Z[3])?Z[3]:1)}i(17,p=kr(Z)),i(18,h=kr([...u,0])),i(19,g=kr([...u,1])),i(20,m=kr(sg(s,1,1)))},ut=()=>{const Z=[...sg(s,l,c),d];K(Z),L(Z)},lt=Z=>{const St=Z.length===3?[...Z,1]:Z;K(St,!0),L(St)},N=(Z,St)=>{const nt=Yi(Z.x/St.width,0,1),mt=Yi(Z.y/St.height,0,1);var Ft;Ft=1-mt,i(33,l=nt),i(34,c=Ft),d===0&&i(16,d=1),ut()};let ft,$t,Lt,ct;const et=Z=>{const St=Dn(am(Z),ct);N(Fn(_e(Lt),St),$t)},ht=Z=>{$t=void 0,document.documentElement.removeEventListener("pointermove",et),document.documentElement.removeEventListener("pointerup",ht)};let Y;return t.$$set=Z=>{"label"in Z&&i(0,x=Z.label),"name"in Z&&i(1,k=Z.name),"options"in Z&&i(2,v=Z.options),"selectedIndex"in Z&&i(3,C=Z.selectedIndex),"value"in Z&&i(4,P=Z.value),"buttonClass"in Z&&i(5,I=Z.buttonClass),"optionLabelClass"in Z&&i(6,O=Z.optionLabelClass),"optionMapper"in Z&&i(7,T=Z.optionMapper),"onchange"in Z&&i(32,L=Z.onchange),"title"in Z&&i(8,F=Z.title),"hidePresetLabel"in Z&&i(9,B=Z.hidePresetLabel),"locale"in Z&&i(10,y=Z.locale),"enableOpacity"in Z&&i(11,V=Z.enableOpacity),"enablePresets"in Z&&i(12,J=Z.enablePresets),"enablePicker"in Z&&i(13,S=Z.enablePicker),"enableInput"in Z&&i(14,H=Z.enableInput)},t.$$.update=()=>{16&t.$$.dirty[0]|16&t.$$.dirty[1]&&(!P||f&&Ja(P,f)||(i(35,f=[...P]),K(P,!0))),4&t.$$.dirty[1]&&i(24,n=100*l),8&t.$$.dirty[1]&&i(23,r=100-100*c),32&t.$$.dirty[1]&&i(37,o=!!Y&&Y.length>=4&&Y.length<=5),18448&t.$$.dirty[0]|64&t.$$.dirty[1]&&i(22,a=H&&P?((Z,St,nt)=>{let mt=Z.map(Ft=>Math.round(255*Ft).toString(16).toLowerCase().padStart(2,"0"));return(!St&&mt.length>3||mt[3]==="ff")&&mt.pop(),nt&&(mt=mt.map(Ft=>Ft.substring(0,1))),"#"+mt.join("")})(P,V,o):void 0)},[x,k,v,C,P,I,O,T,F,B,y,V,J,S,H,s,d,p,h,g,m,ft,a,r,n,lt,Z=>{i(15,s=Z),d===0&&i(16,d=1),ut()},Z=>{i(16,d=Z),ut()},Z=>{Z.stopPropagation(),$t=Vn(ft.offsetWidth,ft.offsetHeight),Lt=(St=>rt(St.offsetX,St.offsetY))(Z),ct=am(Z),N(Lt,$t),document.documentElement.addEventListener("pointermove",et),document.documentElement.addEventListener("pointerup",ht)},Z=>{$t=Vn(ft.offsetWidth,ft.offsetHeight);const St=n/100*$t.width,nt=r/100*$t.height;N({x:St+Z.detail.x,y:nt+Z.detail.y},$t)},Z=>{const{value:St}=Z.target,nt=St.length;if(!St.startsWith("#")||nt<4||nt===6||nt===8||nt>9||!V&&nt>7)return;const mt=b2(St);mt&&(i(36,Y=St),K(mt),L(mt))},Z=>{Z.stopPropagation()},L,l,c,f,Y,o,function(Z){zi[Z?"unshift":"push"](()=>{ft=Z,i(21,ft)})},([Z,St])=>[Z,tn(St)?St(y):St],Z=>lt(Z.value)]}class f5 extends li{constructor(e){super(),si(this,e,g5,$5,ei,{label:0,name:1,options:2,selectedIndex:3,value:4,buttonClass:5,optionLabelClass:6,optionMapper:7,onchange:32,title:8,hidePresetLabel:9,locale:10,enableOpacity:11,enablePresets:12,enablePicker:13,enableInput:14},null,[-1,-1])}}function y5(t){let e,i,n;return i=new $o({props:{items:t[0]}}),{c(){e=pt("div"),At(i.$$.fragment),w(e,"class","PinturaShorthandControl PinturaShapeStyle")},m(r,o){tt(r,e,o),It(i,e,null),n=!0},p(r,[o]){const a={};1&o&&(a.items=r[0]),i.$set(a)},i(r){n||(M(i.$$.fragment,r),n=!0)},o(r){D(i.$$.fragment,r),n=!1},d(r){r&&Q(e),Et(i)}}}function x5(t,e,i){let n,r,{value:o}=e,{onchange:a}=e,{controls:s=[]}=e;return t.$$set=l=>{i(6,e=Cn(Cn({},e),Pc(l))),"value"in l&&i(1,o=l.value),"onchange"in l&&i(2,a=l.onchange),"controls"in l&&i(3,s=l.controls)},t.$$.update=()=>{i(4,n=(l=>{const{controls:c,...d}=l;return d})(e)),30&t.$$.dirty&&i(0,r=s.map((l,c)=>{const[d,u,p]=l;return[d,u,{...n,...p,value:o[c],onchange:h=>{const g=[...o];g[c]=h,a(g)}}]}))},e=Pc(e),[r,o,a,s,n]}class b5 extends li{constructor(e){super(),si(this,e,x5,y5,ei,{value:1,onchange:2,controls:3})}}function mg(t,e,i){const n=t.slice();return n[9]=e[i][0],n[0]=e[i][1],n[10]=e[i][2],n[2]=e[i][3],n}function v5(t){let e,i,n;const r=[t[10]];var o=t[3][t[9]]||t[9];function a(s){let l={};for(let c=0;c<r.length;c+=1)l=Cn(l,r[c]);return{props:l}}return o&&(e=du(o,a())),{c(){e&&At(e.$$.fragment),i=Tn()},m(s,l){e&&It(e,s,l),tt(s,i,l),n=!0},p(s,l){const c=4&l?Tr(r,[zr(s[10])]):{};if(o!==(o=s[3][s[9]]||s[9])){if(e){Fe();const d=e;D(d.$$.fragment,1,0,()=>{Et(d,1)}),De()}o?(e=du(o,a()),At(e.$$.fragment),M(e.$$.fragment,1),It(e,i.parentNode,i)):e=null}else o&&e.$set(c)},i(s){n||(e&&M(e.$$.fragment,s),n=!0)},o(s){e&&D(e.$$.fragment,s),n=!1},d(s){s&&Q(i),e&&Et(e,s)}}}function w5(t){let e,i=t[9],n=t[9]&&vp(t);return{c(){n&&n.c(),e=Tn()},m(r,o){n&&n.m(r,o),tt(r,e,o)},p(r,o){r[9]?i?ei(i,r[9])?(n.d(1),n=vp(r),n.c(),n.m(e.parentNode,e)):n.p(r,o):(n=vp(r),n.c(),n.m(e.parentNode,e)):i&&(n.d(1),n=null),i=r[9]},i:Qe,o(r){D(n)},d(r){r&&Q(e),n&&n.d(r)}}}function S5(t){let e,i,n=t[10].innerHTML+"";return{c(){e=new bu(!1),i=Tn(),e.a=i},m(r,o){e.m(n,r,o),tt(r,i,o)},p(r,o){4&o&&n!==(n=r[10].innerHTML+"")&&e.p(n)},i:Qe,o:Qe,d(r){r&&Q(i),r&&e.d()}}}function k5(t){let e,i=t[10].textContent+"";return{c(){e=cn(i)},m(n,r){tt(n,e,r)},p(n,r){4&r&&i!==(i=n[10].textContent+"")&&An(e,i)},i:Qe,o:Qe,d(n){n&&Q(e)}}}function C5(t){let e,i;return e=new $o({props:{items:t[2],discardEmptyItems:!0}}),{c(){At(e.$$.fragment)},m(n,r){It(e,n,r),i=!0},p(n,r){const o={};4&r&&(o.items=n[2]),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){D(e.$$.fragment,n),i=!1},d(n){Et(e,n)}}}function vp(t){let e,i,n,r,o;const a=[C5,k5,S5],s=[];function l(u,p){return u[2]&&u[2].length?0:u[10].textContent?1:u[10].innerHTML?2:-1}~(i=l(t))&&(n=s[i]=a[i](t));let c=[t[4](t[10])],d={};for(let u=0;u<c.length;u+=1)d=Cn(d,c[u]);return{c(){e=pt(t[9]),n&&n.c(),r=de(),/-/.test(t[9])?Vm(e,d):_m(e,d)},m(u,p){tt(u,e,p),~i&&s[i].m(e,null),Tt(e,r),o=!0},p(u,p){let h=i;i=l(u),i===h?~i&&s[i].p(u,p):(n&&(Fe(),D(s[h],1,1,()=>{s[h]=null}),De()),~i?(n=s[i],n?n.p(u,p):(n=s[i]=a[i](u),n.c()),M(n,1),n.m(e,r)):n=null),d=Tr(c,[4&p&&u[4](u[10])]),/-/.test(u[9])?Vm(e,d):_m(e,d)},i(u){o||(M(n),o=!0)},o(u){D(n),o=!1},d(u){u&&Q(e),~i&&s[i].d()}}}function $g(t,e){let i,n,r,o,a,s;const l=[w5,v5],c=[];function d(u,p){return 4&p&&(n=null),n==null&&(n=!u[5](u[9])),n?0:1}return r=d(e,-1),o=c[r]=l[r](e),{key:t,first:null,c(){i=Tn(),o.c(),a=Tn(),this.first=i},m(u,p){tt(u,i,p),c[r].m(u,p),tt(u,a,p),s=!0},p(u,p){let h=r;r=d(e=u,p),r===h?c[r].p(e,p):(Fe(),D(c[h],1,1,()=>{c[h]=null}),De(),o=c[r],o?o.p(e,p):(o=c[r]=l[r](e),o.c()),M(o,1),o.m(a.parentNode,a))},i(u){s||(M(o),s=!0)},o(u){D(o),s=!1},d(u){u&&Q(i),c[r].d(u),u&&Q(a)}}}function T5(t){let e,i,n=[],r=new Map,o=t[2];const a=s=>s[0]+s[1];for(let s=0;s<o.length;s+=1){let l=mg(t,o,s),c=a(l);r.set(c,n[s]=$g(c,l))}return{c(){for(let s=0;s<n.length;s+=1)n[s].c();e=Tn()},m(s,l){for(let c=0;c<n.length;c+=1)n[c].m(s,l);tt(s,e,l),i=!0},p(s,[l]){62&l&&(o=s[2],Fe(),n=Aa(n,l,a,1,s,o,r,e.parentNode,Ss,$g,e,mg),De())},i(s){if(!i){for(let l=0;l<o.length;l+=1)M(n[l]);i=!0}},o(s){for(let l=0;l<n.length;l+=1)D(n[l]);i=!1},d(s){for(let l=0;l<n.length;l+=1)n[l].d(s);s&&Q(e)}}}function M5(t,e,i){let n,r,{items:o}=e,{discardEmptyItems:a=!0}=e,{key:s=""}=e;const l={Button:ks,ImageButton:p2,ImageButtonList:Wh,Dropdown:x2,RadioGroup:Qa,Input:y2,Panel:Xv,ProgressIndicator:d2,ShapeStyle:l5,ToggleSlider:o5,ColorPicker:f5,ShorthandControl:b5},c=u=>!Oe(u)||!!l[u],d=u=>{if(!u)return!1;const[p,,h,g=[]]=u;return!!c(p)||g.some(d)||h.textContent||h.innerHTML};return t.$$set=u=>{"items"in u&&i(6,o=u.items),"discardEmptyItems"in u&&i(7,a=u.discardEmptyItems),"key"in u&&i(0,s=u.key)},t.$$.update=()=>{1&t.$$.dirty&&i(1,n=s),192&t.$$.dirty&&i(2,r=(o&&a?o.filter(d):o)||[])},[s,n,r,l,(u={})=>{const{textContent:p,innerHTML:h,...g}=u;return g},c,o,a]}class $o extends li{constructor(e){super(),si(this,e,M5,T5,ei,{items:6,discardEmptyItems:7,key:0})}}let wp=null;var P5=t=>{if(wp===null&&(wp=Lr()&&"visualViewport"in window),!wp)return!1;const e=visualViewport.height,i=()=>{t(visualViewport.height<e?"visible":"hidden")};return visualViewport.addEventListener("resize",i),()=>visualViewport.removeEventListener("resize",i)};function gg(t){let e,i;const n=[{onclick:t[1]},t[3]];let r={};for(let o=0;o<n.length;o+=1)r=Cn(r,n[o]);return e=new ks({props:r}),{c(){At(e.$$.fragment)},m(o,a){It(e,o,a),i=!0},p(o,a){const s=10&a[0]?Tr(n,[2&a[0]&&{onclick:o[1]},8&a[0]&&zr(o[3])]):{};e.$set(s)},i(o){i||(M(e.$$.fragment,o),i=!0)},o(o){D(e.$$.fragment,o),i=!1},d(o){Et(e,o)}}}function fg(t){let e,i;const n=[{onclick:t[0]},{class:"PinturaInputFormButtonConfirm"},t[2]];let r={};for(let o=0;o<n.length;o+=1)r=Cn(r,n[o]);return e=new ks({props:r}),{c(){At(e.$$.fragment)},m(o,a){It(e,o,a),i=!0},p(o,a){const s=5&a[0]?Tr(n,[1&a[0]&&{onclick:o[0]},n[1],4&a[0]&&zr(o[2])]):{};e.$set(s)},i(o){i||(M(e.$$.fragment,o),i=!0)},o(o){D(e.$$.fragment,o),i=!1},d(o){Et(e,o)}}}function R5(t){let e,i,n,r,o,a,s,l,c=t[3]&&gg(t);const d=t[24].default,u=sr(d,t,t[23],null);let p=t[2]&&fg(t);return{c(){e=pt("div"),i=pt("div"),c&&c.c(),n=de(),r=pt("div"),u&&u.c(),o=de(),p&&p.c(),w(r,"class","PinturaInputFormFields"),w(i,"class","PinturaInputFormInner"),w(e,"class","PinturaInputForm"),w(e,"data-layout",t[4]),w(e,"style",t[6])},m(h,g){tt(h,e,g),Tt(e,i),c&&c.m(i,null),Tt(i,n),Tt(i,r),u&&u.m(r,null),Tt(i,o),p&&p.m(i,null),t[25](e),a=!0,s||(l=[Mt(r,"keydown",t[10]),Mt(e,"focusin",t[7]),Mt(e,"focusout",t[8]),Mt(e,"measure",t[9]),Ui(Mr.call(null,e))],s=!0)},p(h,g){h[3]?c?(c.p(h,g),8&g[0]&&M(c,1)):(c=gg(h),c.c(),M(c,1),c.m(i,n)):c&&(Fe(),D(c,1,1,()=>{c=null}),De()),u&&u.p&&(!a||8388608&g[0])&&cr(u,d,h,h[23],a?lr(d,h[23],g,null):dr(h[23]),null),h[2]?p?(p.p(h,g),4&g[0]&&M(p,1)):(p=fg(h),p.c(),M(p,1),p.m(i,null)):p&&(Fe(),D(p,1,1,()=>{p=null}),De()),(!a||16&g[0])&&w(e,"data-layout",h[4]),(!a||64&g[0])&&w(e,"style",h[6])},i(h){a||(M(c),M(u,h),M(p),a=!0)},o(h){D(c),D(u,h),D(p),a=!1},d(h){h&&Q(e),c&&c.d(),u&&u.d(h),p&&p.d(),t[25](null),s=!1,_i(l)}}}function I5(t,e,i){let n,r,o,a,s,{$$slots:l={},$$scope:c}=e,{onconfirm:d}=e,{oncancel:u}=e,{autoFocus:p=!0}=e,{autoPositionCursor:h=!0}=e,{buttonConfirm:g}=e,{buttonCancel:m}=e,{layout:f="stack"}=e,{parentRect:x}=e,{align:k}=e,{justify:v}=e,{parentMargin:C=16}=e,{panelOffset:P=Qi()}=e,I=!1,O,T,L="",F=0;const B=()=>{const S=s.querySelector("input, textarea");S.focus(),F>=1||S.select()},y=()=>{I=!0,J||!ba()&&!$u()||i(19,L="top:1em;bottom:auto;"),ba()&&(S=>{let H;const K=lt=>H=lt.touches[0].screenY,ut=lt=>{const N=lt.touches[0].screenY,ft=lt.target;/textarea/i.test(ft.nodeName)?(N>H?ft.scrollTop==0&&lt.preventDefault():N<H?ft.scrollTop+ft.offsetHeight==ft.scrollHeight&&lt.preventDefault():lt.preventDefault(),H=N):lt.preventDefault()};S.addEventListener("touchstart",K),S.addEventListener("touchmove",ut)})(s),i(20,F=1)};let V;const J=P5(S=>{o?S!=="hidden"||I?(clearTimeout(T),T=void 0,i(19,L=`top:${visualViewport.height-O.height-P.y}px`),S==="visible"?(i(5,s.dataset.stick=!0,s),B(),y()):(I=!1,i(20,F=0))):B():i(19,L="top: 4.5em; bottom: auto")});return ws(()=>{p&&B()}),No(()=>{J&&J()}),t.$$set=S=>{"onconfirm"in S&&i(0,d=S.onconfirm),"oncancel"in S&&i(1,u=S.oncancel),"autoFocus"in S&&i(11,p=S.autoFocus),"autoPositionCursor"in S&&i(12,h=S.autoPositionCursor),"buttonConfirm"in S&&i(2,g=S.buttonConfirm),"buttonCancel"in S&&i(3,m=S.buttonCancel),"layout"in S&&i(4,f=S.layout),"parentRect"in S&&i(13,x=S.parentRect),"align"in S&&i(14,k=S.align),"justify"in S&&i(15,v=S.justify),"parentMargin"in S&&i(16,C=S.parentMargin),"panelOffset"in S&&i(17,P=S.panelOffset),"$$scope"in S&&i(23,c=S.$$scope)},t.$$.update=()=>{385024&t.$$.dirty[0]&&i(21,n=x&&O?((S,H,K,ut,lt)=>{let N,ft;return N=ut==="center"?S.x+.5*S.width-.5*H.width:ut==="right"?S.x+S.width-H.width-lt:S.x+lt,ft=K==="center"?S.y+.5*S.height-.5*H.height:K==="bottom"?S.y+S.height-H.height-lt:S.y+lt,`left:${N}px;top:${ft}px;right:auto;bottom:auto;`})(x,O,k,v,C):void 0),32&t.$$.dirty[0]&&i(22,r=s&&getComputedStyle(s)),4194304&t.$$.dirty[0]&&(o=r&&r.getPropertyValue("--editor-modal")==="1"),3670016&t.$$.dirty[0]&&i(6,a=`opacity:${F};${n||L}`)},[d,u,g,m,f,s,a,S=>{var H;((K=>/textarea/i.test(K))(S.target)||h2(S.target))&&(V=Date.now(),h&&((H=S.target).selectionStart=H.selectionEnd=H.value.length),clearTimeout(T),T=setTimeout(y,200))},S=>{Date.now()-V>50||(S.stopPropagation(),B())},({detail:S})=>{i(18,O={width:S.width,height:S.height})},S=>S.key==="Enter"?d():S.key==="Escape"?u():void 0,p,h,x,k,v,C,P,O,L,F,n,r,c,l,function(S){zi[S?"unshift":"push"](()=>{s=S,i(5,s)})}]}class v2 extends li{constructor(e){super(),si(this,e,I5,R5,ei,{onconfirm:0,oncancel:1,autoFocus:11,autoPositionCursor:12,buttonConfirm:2,buttonCancel:3,layout:4,parentRect:13,align:14,justify:15,parentMargin:16,panelOffset:17},null,[-1,-1])}}const E5=["aspectRatio","isRotatedSideways","flip","cropSize"],yg=Ih.map(([t])=>t).filter(t=>!E5.includes(t));var ss=(t,e)=>new CustomEvent("ping",{detail:{type:t,data:e},cancelable:!0,bubbles:!0}),w2=(t,e)=>(e?Lh(t,e):t).replace(/([a-z])([A-Z])/g,"$1-$2").replace(/\s+/g,"-").toLowerCase(),xg=(t,e=Xi)=>{const{subscribe:i,set:n}=le(void 0);return{subscribe:i,destroy:((r,o)=>{const a=matchMedia(r);return a.addListener(o),o(a),{get matches(){return a.matches},destroy:()=>a.removeListener(o)}})(t,({matches:r})=>n(e(r))).destroy}},Wl=t=>/video/.test(t.type),bg=(t,e,i)=>new Promise((n,r)=>{(async()=>{Wl(t)&&n(await(l=>new Promise((c,d)=>{const u=ln("video");u.onseeked=()=>{const p=ln("canvas");ny(u).then(({width:h,height:g})=>{p.width=h,p.height=g;const m=p.getContext("2d",{willReadFrequently:!0}),f=()=>{m.drawImage(u,0,0,p.width,p.height);const x=m.getImageData(0,0,p.width,p.height);Jn(p),URL.revokeObjectURL(u.src),c(x)};Ia()?setTimeout(f,16):f()})},u.onloadeddata=()=>{u.currentTime=0},u.onerror=p=>{console.error(p),d(u.error)},u.src=URL.createObjectURL(l),u.load()}))(t));const o=await e.read(t),a=l=>Hf(l,i).then(c=>e.apply(c,o)).then(n).catch(r);if(Nf(t)||!Vf()||Ia()||ba())return a(t);let s;try{s=await Fc((l,c)=>createImageBitmap(l).then(d=>c(null,d)).catch(c),[t])}catch{}s&&s.width?await mu()?Fh()&&o>1?n(await(async l=>zc(await Bl(l)))(s)):n(s):n(e.apply(s,o)):a(t)})()}),vg=(t,e)=>new Promise(async i=>{if(t.width<e.width&&t.height<e.height)return i(t);const n=Math.min(e.width/t.width,e.height/t.height),r=n*t.width,o=n*t.height,a=ln("canvas",{width:r,height:o}),s=a.getContext("2d",{willReadFrequently:!0}),l=Il(t)?await Bl(t):t;s.drawImage(l,0,0,r,o),i(zc(a))});let Sp=null;var A5=()=>{if(Sp===null){let t=ln("canvas");Sp=!!vu(t),Jn(t),t=void 0}return Sp};const wg=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],Js={precision:1e-4},Nd={precision:.01*Js.precision};var L5=()=>{const t=[],e=[],i=[],n=()=>{e.forEach(o=>o(i))},r=o=>{o.unsub=o.subscribe(a=>((s,l)=>{const c=t.indexOf(s);c<0||(i[c]=l,n())})(o,a)),n()};return{get length(){return t.length},clear:()=>{t.forEach(o=>o.unsub()),t.length=0,i.length=0},unshift:o=>{t.unshift(o),r(o)},get:o=>t[o],push:o=>{t.push(o),r(o)},remove:o=>{o.unsub();const a=t.indexOf(o);t.splice(a,1),i.splice(a,1)},forEach:o=>t.forEach(o),filter:o=>t.filter(o),subscribe:o=>(e.push(o),o(i),()=>{e.splice(e.indexOf(o),1)})}},kp=t=>t[0]<.25&&t[1]<.25&&t[2]<.25,S2=(t={})=>new Promise(e=>{const{accept:i="image/*"}=t,n=ln("input",{style:"position:absolute;visibility:hidden;width:0;height:0;",type:"file",accept:i}),r=()=>{const[o]=n.files;n.parentNode&&n.remove(),n.removeEventListener("change",r),e(o)};n.addEventListener("change",r),ba()&&document.body.append(n),n.click()}),Ac=t=>{try{return t()}catch(e){console.error(e)}},z5=([t,e])=>t+.5*(e-t),gs=t=>Math.round(100*t),Nh=t=>rt(t.clientX,t.clientY),Yp=(t,e,i)=>{const n=Nh(t);return Dn(Dn(n,e),i)};function F5(t,e,i){let n,r,o,a,s,l,c,d,u,p,h,g,m,f,x,k,v,C,P,I,O,{root:T}=e,{locale:L}=e,{stores:F}=e,{allowPan:B=!0}=e,{allowZoom:y=!0}=e,{enablePan:V=!0}=e,{enableZoom:J=!0}=e,{enableZoomControls:S=J}=e,{enableZoomInput:H=!0}=e,{enablePanInput:K=!0}=e,{enablePanLimit:ut=!0}=e,{panLimitGutterScalar:lt=0}=e,{zoomOptions:N=[.25,.5,1,1.25,1.5,2,3,4,6,8,16]}=e,{zoomAdjustStep:ft=.25}=e,{zoomAdjustFactor:$t=.1}=e,{zoomAdjustWheelFactor:Lt=1}=e,{elasticity:ct=5}=e,{imageSelectionRectCentered:et}=e,{imageSelectionRectScalar:ht}=e,{zoomLevel:Y=null}=e,{zoomControls:Z}=e,{zoomMultiTouching:St=!1}=e;const{isAnimated:nt,isInteracting:mt,rootRect:Ft,stageRect:oe,stageScalar:Rt,imageSelectionPan:Ut,imageSelectionZoom:Ot,imageSelectionStageFitScalar:j,imageSelectionRect:wt,imageSelectionStoredState:yt,imagePreviewUpscale:Gt}=F;A(t,nt,ot=>i(70,I=ot)),A(t,mt,ot=>i(69,C=ot)),A(t,Ft,ot=>i(66,x=ot)),A(t,oe,ot=>i(65,f=ot)),A(t,Rt,ot=>i(46,P=ot)),A(t,Ut,ot=>i(64,h=ot)),A(t,Ot,ot=>i(43,p=ot)),A(t,j,ot=>i(44,g=ot)),A(t,wt,ot=>i(67,k=ot)),A(t,yt,ot=>i(71,O=ot)),A(t,Gt,ot=>i(45,m=ot));const ue=sn("fixScrollDirection");A(t,ue,ot=>i(68,v=ot));let pe=!1,ve,ge,_,we;const gi=ot=>{const he=T.querySelector(".PinturaMain > .PinturaUtilMain")||T.querySelector('div[tabindex="0"] .PinturaUtilMain');return!!he&&!!he.contains(ot.target)&&!Ec(ot.target)},xe=(ot={})=>{const{pan:he=h,zoom:ie=p}=ot;Ct(yt,O={translation:he,zoom:ie},O)},_t=()=>h&&h.x===0&&h.y===0,Te=()=>{Ct(Ot,p=void 0,p),_t()||Ct(Ut,h=Qi(),h),He.set(void 0,{hard:!0})},Ie=()=>{Te(),xe()},He=ai(void 0,{precision:.01});He.subscribe(ot=>{if(ot===void 0)return Ct(Ot,p=void 0,p),void(_t()||Ct(Ut,h=Qi(),h));const he=p;ot<=1?_t()||Ct(Ut,h=Qi(),h):ot<=he&&Ct(Ut,h=Ar(h,.8),h),Ct(Ot,p=ot,p)});const vi=ot=>{He.update(he=>{const ie=ot(he||g);return xe({zoom:ie}),ie})},vt=ot=>{ot?He.set(ot,{hard:I===!1}):(ot=void 0,He.set(void 0,{hard:!0})),Ct(Ot,p=ot,p),xe({zoom:ot})},bt=(ot,he)=>{const ie=ht*he,fe={...et},Dt=1-Yi(lt,0,1);Er(fe,ie<Dt?ie:Dt);const ke={...et};Er(ke,ie),ea(ke,ot);const fi={...ke};return ke.x>fe.x&&(fi.x=fe.x),ke.y>fe.y&&(fi.y=fe.y),ke.x+ke.width<fe.x+fe.width&&(fi.x=fe.x+fe.width-ke.width),ke.y+ke.height<fe.y+fe.height&&(fi.y=fe.y+fe.height-ke.height),Dn(Ti(fi),Ti(fe))},Ze=({translation:ot,zoom:he=1,elastify:ie=!0})=>{if(!ve)return;let fe=ot;const Dt=rt(ve.x+fe.x,ve.y+fe.y);if(!ut)return Dt;const ke=bt(Dt,he);return ie?J4(ke,Dt,ct):ke};let Pe,ri;const Ge=()=>{ri=void 0,Ct(mt,C=!0,C),i(34,pe=K),Pe=!1,_=!1,ve={...h},ge=m?p||g:o?p||1:p||g},ii=ot=>{const{scalar:he,translation:ie,isMultiTouching:fe}=ot.detail;if(!ve||!fe&&!K)return;fe&&Ar(ie,.5),(K||fe)&&(Pe=!0),St||i(13,St=fe);const Dt=n?Yi(ge*he,s,l):1,ke=Ze({translation:ie,zoom:Dt,elastify:!0}),fi=ps(ke);we=ps(h),_=fi<we,n&&Ot.set(Dt),Ut.set(ke),ri=St&&{translation:ot.detail.translation,scalar:he}},wi=ot=>{Ct(mt,C=!1,C),i(34,pe=!1),i(13,St=!1),_&&we<50&&(ve=void 0,ge=void 0,Ut.set(Qi()))},pi=ot=>{Ct(mt,C=!1,C),i(34,pe=!1),i(13,St=!1),Promise.resolve().then(()=>{if(Pe&&ve){const he=ri||ot.detail,ie=n?Yi(ge*he.scalar,s,l):1,fe=Ze({elastify:!1,translation:he.translation,zoom:ie});Ut.set(fe)}ve=void 0,ge=void 0,K&&ot.detail.isDoubleTap&&Ie(),xe()})};let Fi,X=Date.now(),jt=0,U=!1,Bt=!1;const ye=ot=>{if(!gi(ot)||(ot.preventDefault(),ot.stopPropagation(),Bt))return;clearTimeout(Fi);const he=ku(ot,{fixScrollDirection:v}),ie=Date.now(),fe=ie-X;X=ie;const Dt=Math.abs(he/fe)>.2;jt=Dt?jt+1:0;const ke=1+-1*he*Lt/(Dt?50:100),fi=Yp(ot,x,f);Qt(fi,ke,{isZoomingFast:Dt})},Qt=(ot,he,{isZoomingFast:ie})=>{const fe=m?p||g:o?p||1:p||g,Dt=fe*he,ke=Qi(),fi=h,hi=m?g:o?1:g,Be=Math.abs(Dt-hi),yi=Dt<fe,Pi=fe>hi&&yi||fe<hi&&Dt>fe,be=jt>=5;if(ie||(U=!1),jt>0&&!U&&(U=Pi),be&&U)return Ie(),Bt=!0,void setTimeout(()=>{Bt=!1},100);if(be)return;!ie&&Pi&&Be<=.05&&(Fi=setTimeout(()=>{Ie()},250)),Ct(Ot,p=Yi(Dt,s,l),p);const me=Ci(k);Er(me,fe),ea(me,fi);const Ee=Ti(me),an=Ci(me);Er(an,p-fe+1,ot);const Gi=Ti(an),fn=sm(Dn(Gi,Ee),fe);((hn,mn,en)=>{hn.x=mn,hn.y=en})(ke,fi.x+fn.x,fi.y+fn.y),Ct(Ut,h=yi&&ie?Ar(_e(h),.85):bt(ke,fe),h),xe()},se=ot=>(ot?"add":"remove")+"EventListener";let zt,We,Ae,je;const Ke=ot=>{ot.preventDefault(),We={...h},je=Ci(k),Ae=Yp(ot,x,f),zt=m?p||g:o?p||1:p||g},it=ot=>{ot.preventDefault(),Ct(Ot,p=Yi(ot.scale*zt,s,l),p);const he=Ci(je);Er(he,zt),ea(he,We);const ie=Ti(he),fe=Ci(he);Er(fe,p-zt+1,Ae);const Dt=Ti(fe),ke=sm(Dn(Dt,ie),zt),fi={x:We.x+ke.x,y:We.y+ke.y};Ct(Ut,h=bt(fi,p),h)},Xt=ot=>{ot.preventDefault()},Nt=ot=>{T[se(ot)]("wheel",ye),ba()||(T[se(ot)]("gesturestart",Ke),T[se(ot)]("gesturechange",it),T[se(ot)]("gestureend",Xt))},Zt=ot=>{const he=se(ot);T[he]("interactionstart",Ge),T[he]("interactionupdate",ii),T[he]("interactionrelease",wi),T[he]("interactionend",pi)};let Yt;return ws(()=>{Yt=Cs(T,{drag:!0,pinch:!0,inertia:!0,inertiaDurationMultiplier:10,shouldStartInteraction:gi})}),No(()=>{Nt(!1),Zt(!1),Yt.destroy(),Yt=void 0}),t.$$set=ot=>{"root"in ot&&i(14,T=ot.root),"locale"in ot&&i(15,L=ot.locale),"stores"in ot&&i(16,F=ot.stores),"allowPan"in ot&&i(17,B=ot.allowPan),"allowZoom"in ot&&i(18,y=ot.allowZoom),"enablePan"in ot&&i(19,V=ot.enablePan),"enableZoom"in ot&&i(20,J=ot.enableZoom),"enableZoomControls"in ot&&i(21,S=ot.enableZoomControls),"enableZoomInput"in ot&&i(22,H=ot.enableZoomInput),"enablePanInput"in ot&&i(23,K=ot.enablePanInput),"enablePanLimit"in ot&&i(24,ut=ot.enablePanLimit),"panLimitGutterScalar"in ot&&i(25,lt=ot.panLimitGutterScalar),"zoomOptions"in ot&&i(26,N=ot.zoomOptions),"zoomAdjustStep"in ot&&i(27,ft=ot.zoomAdjustStep),"zoomAdjustFactor"in ot&&i(28,$t=ot.zoomAdjustFactor),"zoomAdjustWheelFactor"in ot&&i(29,Lt=ot.zoomAdjustWheelFactor),"elasticity"in ot&&i(30,ct=ot.elasticity),"imageSelectionRectCentered"in ot&&i(31,et=ot.imageSelectionRectCentered),"imageSelectionRectScalar"in ot&&i(32,ht=ot.imageSelectionRectScalar),"zoomLevel"in ot&&i(33,Y=ot.zoomLevel),"zoomControls"in ot&&i(12,Z=ot.zoomControls),"zoomMultiTouching"in ot&&i(13,St=ot.zoomMultiTouching)},t.$$.update=()=>{var ot,he;5505024&t.$$.dirty[0]&&i(36,n=y&&J&&H),655360&t.$$.dirty[0]&&i(35,r=B&&V),393216&t.$$.dirty[0]&&(B||y?(Ct(Ot,p=J?O.zoom:void 0,p),Ct(Ut,h=V?_e(O.translation):_t()?h:Qi(),h),He.set(p)):Te()),32768&t.$$.dirty[1]&&(o=P>=1),67141632&t.$$.dirty[0]|57344&t.$$.dirty[1]&&i(40,a=[(m||P<1)&&[g,gs(g)+"%",{sublabel:L.labelZoomFit}],...N.map(ie=>[ie,gs(ie)+"%"])].filter(Boolean).map(ie=>(ie[0]===1&&(ie[2]={sublabel:L.labelZoomActual}),ie)).sort((ie,fe)=>{const Dt=ie[0]||g,ke=fe[0]||g;return Dt<ke?-1:ke<Dt?1:0})),8704&t.$$.dirty[1]&&i(38,s=Math.min(a.reduce((ie,[fe])=>fe<ie?fe:ie,Number.MAX_SAFE_INTEGER),g)),512&t.$$.dirty[1]&&i(37,l=a.reduce((ie,[fe])=>fe>ie?fe:ie,Number.MIN_SAFE_INTEGER)),4&t.$$.dirty[1]&&Y!==null&&vt(Y),61440&t.$$.dirty[1]&&i(42,d=p||(m||P<1?g:1)),2560&t.$$.dirty[1]&&i(39,(ot=a.map(([ie])=>ie),he=d,c=ot.findIndex(ie=>ie===he))),2048&t.$$.dirty[1]&&i(41,u=gs(d)+"%"),405045248&t.$$.dirty[0]|6080&t.$$.dirty[1]&&i(12,Z=(y||y)&&S?[["Button","zoom-out",{hideLabel:!0,label:L.labelZoomOut,icon:L.iconZoomOut,disabled:p===s,onclick:()=>vi(ie=>Math.max(s,ie-ft)),onhold:()=>vi(ie=>Math.max(s,ie*(1-$t)))}],["Dropdown","zoom-level",{label:u,labelClass:"PinturaFixedWidthCharacters",options:a,selectedIndex:c,onchange:ie=>vt(ie.value)}],["Button","zoom-in",{hideLabel:!0,label:L.labelZoomIn,icon:L.iconZoomIn,disabled:p===l,onclick:()=>vi(ie=>Math.min(l,ie+ft)),onhold:()=>vi(ie=>Math.min(l,ie*(1+$t)))}]]:[]),16384&t.$$.dirty[0]|32&t.$$.dirty[1]&&T&&Nt(n),16384&t.$$.dirty[0]|16&t.$$.dirty[1]&&T&&Zt(r),8404992&t.$$.dirty[0]|24&t.$$.dirty[1]&&T&&T.style.setProperty("--cursor",r&&K?pe?"grabbing":"grab":"")},[nt,mt,Ft,oe,Rt,Ut,Ot,j,wt,yt,Gt,ue,Z,St,T,L,F,B,y,V,J,S,H,K,ut,lt,N,ft,$t,Lt,ct,et,ht,Y,pe,r,n,l,s,c,a,u,d,p,g,m,P]}class D5 extends li{constructor(e){super(),si(this,e,F5,null,ei,{root:14,locale:15,stores:16,allowPan:17,allowZoom:18,enablePan:19,enableZoom:20,enableZoomControls:21,enableZoomInput:22,enablePanInput:23,enablePanLimit:24,panLimitGutterScalar:25,zoomOptions:26,zoomAdjustStep:27,zoomAdjustFactor:28,zoomAdjustWheelFactor:29,elasticity:30,imageSelectionRectCentered:31,imageSelectionRectScalar:32,zoomLevel:33,zoomControls:12,zoomMultiTouching:13},null,[-1,-1,-1,-1])}}const B5=t=>new Promise(e=>{const i=new FileReader;i.onload=()=>e(i.result),i.readAsArrayBuffer(t)}),Cp=(t,e=0,i=t.byteLength)=>{const n=[],r=e+i;for(;e<r;){const o=t.getUint32(e);if(o<0)break;const a=t.getUint32(e+4);if(n.push({type:a,size:o,offset:e,bodyOffset:e+8,bodySize:o-8}),o<8)break;e+=o}return n},O5=(t,{limit:e=1024}={})=>{let i=0;if(i+=4,t.getUint32(i)!==1718909296)return 0;i+=4;const n=t.getUint32(i);return n===1836069938?((r,o,a)=>{let s=!1,l=-1;for(let h=o;h<a;h++)if(s||r.getUint32(h)!==1953653099||(s=!0,h+=4),s&&r.getUint8(h)==64){l=h;break}if(l<0)return 0;const c=r.getUint32(l-28),d=r.getUint32(l-20),u=r.getUint32(l-32),p=r.getUint32(l-16);return c===65536&&d===4294901760?90:u===4294901760&&p===4294901760?180:c===4294901760&&d===65536?270:0})(t,i,e):n===1903435808?(r=>{const o=Cp(r).find(c=>c.type===1836019574);if(!o)return 0;const a=Cp(r,o.bodyOffset,o.bodySize);a.filter(c=>c.type===1953653099).forEach(c=>{a.push(...Cp(r,c.bodyOffset,c.bodySize))});const s=[1836476516,1953196132],l=a.filter(c=>s.includes(c.type));for(const{type:c,bodyOffset:d}of l){const u=r.getUint8(d);let p=d+4;p+=c===1836476516?32:36,p+=u===1?12:0;const h=r.getInt32(p),g=r.getInt32(p+4);if(h===0&&g>0)return 90;if(h<0&&g===0)return 180;if(h===0&&g<0)return 270}return 0})(t):0},{window:Qs}=Oy;function Sg(t){let e,i,n,r=t[42]&&kg(t),o=t[39]&&Pg(t);return{c(){r&&r.c(),e=de(),o&&o.c(),i=Tn()},m(a,s){r&&r.m(a,s),tt(a,e,s),o&&o.m(a,s),tt(a,i,s),n=!0},p(a,s){a[42]?r?(r.p(a,s),2048&s[1]&&M(r,1)):(r=kg(a),r.c(),M(r,1),r.m(e.parentNode,e)):r&&(Fe(),D(r,1,1,()=>{r=null}),De()),a[39]?o?(o.p(a,s),256&s[1]&&M(o,1)):(o=Pg(a),o.c(),M(o,1),o.m(i.parentNode,i)):o&&(Fe(),D(o,1,1,()=>{o=null}),De())},i(a){n||(M(r),M(o),n=!0)},o(a){D(r),D(o),n=!1},d(a){r&&r.d(a),a&&Q(e),o&&o.d(a),a&&Q(i)}}}function kg(t){let e,i,n,r,o,a;const s=[_5,W5],l=[];function c(d,u){return d[40]?0:d[35]?1:-1}return~(n=c(t))&&(r=l[n]=s[n](t)),{c(){e=pt("div"),i=pt("p"),r&&r.c(),w(i,"style",t[74]),w(e,"class","PinturaStatus"),w(e,"style",o="opacity: "+t[56])},m(d,u){tt(d,e,u),Tt(e,i),~n&&l[n].m(i,null),a=!0},p(d,u){let p=n;n=c(d),n===p?~n&&l[n].p(d,u):(r&&(Fe(),D(l[p],1,1,()=>{l[p]=null}),De()),~n?(r=l[n],r?r.p(d,u):(r=l[n]=s[n](d),r.c()),M(r,1),r.m(i,null)):r=null),(!a||4096&u[2])&&w(i,"style",d[74]),(!a||33554432&u[1]&&o!==(o="opacity: "+d[56]))&&w(e,"style",o)},i(d){a||(M(r),a=!0)},o(d){D(r),a=!1},d(d){d&&Q(e),~n&&l[n].d()}}}function W5(t){let e,i,n,r;e=new c2({props:{text:t[35].text||"",onmeasure:t[215]}});let o=t[35].aside&&Cg(t);return{c(){At(e.$$.fragment),i=de(),o&&o.c(),n=Tn()},m(a,s){It(e,a,s),tt(a,i,s),o&&o.m(a,s),tt(a,n,s),r=!0},p(a,s){const l={};16&s[1]&&(l.text=a[35].text||""),e.$set(l),a[35].aside?o?(o.p(a,s),16&s[1]&&M(o,1)):(o=Cg(a),o.c(),M(o,1),o.m(n.parentNode,n)):o&&(Fe(),D(o,1,1,()=>{o=null}),De())},i(a){r||(M(e.$$.fragment,a),M(o),r=!0)},o(a){D(e.$$.fragment,a),D(o),r=!1},d(a){Et(e,a),a&&Q(i),o&&o.d(a),a&&Q(n)}}}function _5(t){let e,i,n,r;return e=new c2({props:{text:t[40],onmeasure:t[215]}}),n=new u2({props:{class:"PinturaStatusIcon",offset:t[84],opacity:t[85],$$slots:{default:[H5]},$$scope:{ctx:t}}}),{c(){At(e.$$.fragment),i=de(),At(n.$$.fragment)},m(o,a){It(e,o,a),tt(o,i,a),It(n,o,a),r=!0},p(o,a){const s={};512&a[1]&&(s.text=o[40]),e.$set(s);const l={};4194304&a[2]&&(l.offset=o[84]),8388608&a[2]&&(l.opacity=o[85]),8&a[0]|8&a[19]&&(l.$$scope={dirty:a,ctx:o}),n.$set(l)},i(o){r||(M(e.$$.fragment,o),M(n.$$.fragment,o),r=!0)},o(o){D(e.$$.fragment,o),D(n.$$.fragment,o),r=!1},d(o){Et(e,o),o&&Q(i),Et(n,o)}}}function Cg(t){let e,i;return e=new u2({props:{class:"PinturaStatusButton",offset:t[84],opacity:t[85],$$slots:{default:[V5]},$$scope:{ctx:t}}}),{c(){At(e.$$.fragment)},m(n,r){It(e,n,r),i=!0},p(n,r){const o={};4194304&r[2]&&(o.offset=n[84]),8388608&r[2]&&(o.opacity=n[85]),16&r[1]|8&r[19]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){D(e.$$.fragment,n),i=!1},d(n){Et(e,n)}}}function Tg(t){let e,i;return e=new d2({props:{progress:t[35].progressIndicator.progress}}),{c(){At(e.$$.fragment)},m(n,r){It(e,n,r),i=!0},p(n,r){const o={};16&r[1]&&(o.progress=n[35].progressIndicator.progress),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){D(e.$$.fragment,n),i=!1},d(n){Et(e,n)}}}function Mg(t){let e,i;const n=[t[35].closeButton,{hideLabel:!0}];let r={};for(let o=0;o<n.length;o+=1)r=Cn(r,n[o]);return e=new ks({props:r}),{c(){At(e.$$.fragment)},m(o,a){It(e,o,a),i=!0},p(o,a){const s=16&a[1]?Tr(n,[zr(o[35].closeButton),n[1]]):{};e.$set(s)},i(o){i||(M(e.$$.fragment,o),i=!0)},o(o){D(e.$$.fragment,o),i=!1},d(o){Et(e,o)}}}function V5(t){let e,i,n,r=t[35].progressIndicator.visible&&Tg(t),o=t[35].closeButton&&t[35].text&&Mg(t);return{c(){r&&r.c(),e=de(),o&&o.c(),i=Tn()},m(a,s){r&&r.m(a,s),tt(a,e,s),o&&o.m(a,s),tt(a,i,s),n=!0},p(a,s){a[35].progressIndicator.visible?r?(r.p(a,s),16&s[1]&&M(r,1)):(r=Tg(a),r.c(),M(r,1),r.m(e.parentNode,e)):r&&(Fe(),D(r,1,1,()=>{r=null}),De()),a[35].closeButton&&a[35].text?o?(o.p(a,s),16&s[1]&&M(o,1)):(o=Mg(a),o.c(),M(o,1),o.m(i.parentNode,i)):o&&(Fe(),D(o,1,1,()=>{o=null}),De())},i(a){n||(M(r),M(o),n=!0)},o(a){D(r),D(o),n=!1},d(a){r&&r.d(a),a&&Q(e),o&&o.d(a),a&&Q(i)}}}function N5(t){let e,i=t[3].iconSupportError+"";return{c(){e=Cr("g")},m(n,r){tt(n,e,r),e.innerHTML=i},p(n,r){8&r[0]&&i!==(i=n[3].iconSupportError+"")&&(e.innerHTML=i)},d(n){n&&Q(e)}}}function H5(t){let e,i;return e=new Mo({props:{$$slots:{default:[N5]},$$scope:{ctx:t}}}),{c(){At(e.$$.fragment)},m(n,r){It(e,n,r),i=!0},p(n,r){const o={};8&r[0]|8&r[19]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){D(e.$$.fragment,n),i=!1},d(n){Et(e,n)}}}function Pg(t){let e,i,n,r,o,a,s,l,c,d,u,p,h,g,m=t[10]&&Rg(t),f=t[47]&&t[46]&&Ig(t);const x=[q5,Y5],k=[];function v(T,L){return T[47]?0:1}function C(T){t[431](T)}function P(T){t[432](T)}function I(T){t[433](T)}n=v(t),r=k[n]=x[n](t),a=new z4({props:{isAnimated:t[55],isTransparent:t[20],pixelRatio:t[59],textPixelRatio:t[6],backgroundColor:t[58],maskRect:t[60],maskOpacity:t[75]?t[75].maskOpacity:1,maskMarkupOpacity:t[7],maskFrameOpacity:t[5],clipAnnotationsToImage:t[87],images:t[57],interfaceImages:t[88],loadImageData:t[28],enableGrid:t[11],gridSize:t[89],gridColors:[t[90],t[91]],gridOpacity:t[92],selectionColor:t[93],willRequest:t[83]||t[94],willRender:t[428],didRender:t[429]}});let O={root:t[2],locale:t[3],stores:t[201],allowPan:t[96],enablePan:t[17],enablePanLimit:t[21],panLimitGutterScalar:t[22],enablePanInput:t[97],allowZoom:t[98],enableZoom:t[18],enableZoomInput:t[19]!==void 0?t[19]:t[99],enableZoomControls:t[100],zoomOptions:t[13]||t[23],zoomAdjustStep:t[14]||t[24],zoomAdjustFactor:t[15]||t[25],zoomAdjustWheelFactor:t[16]||t[26],imageSelectionRectCentered:t[101],imageSelectionRectScalar:t[102],elasticity:qp*t[8]};return t[0]!==void 0&&(O.zoomLevel=t[0]),t[33]!==void 0&&(O.zoomControls=t[33]),t[34]!==void 0&&(O.zoomMultiTouching=t[34]),d=new D5({props:O}),zi.push(()=>mo(d,"zoomLevel",C)),zi.push(()=>mo(d,"zoomControls",P)),zi.push(()=>mo(d,"zoomMultiTouching",I)),{c(){m&&m.c(),e=de(),f&&f.c(),i=de(),r.c(),o=de(),At(a.$$.fragment),s=de(),l=pt("div"),c=de(),At(d.$$.fragment),w(l,"class","PinturaRootPortal")},m(T,L){m&&m.m(T,L),tt(T,e,L),f&&f.m(T,L),tt(T,i,L),k[n].m(T,L),tt(T,o,L),It(a,T,L),tt(T,s,L),tt(T,l,L),t[430](l),tt(T,c,L),It(d,T,L),g=!0},p(T,L){T[10]?m?(m.p(T,L),1024&L[0]&&M(m,1)):(m=Rg(T),m.c(),M(m,1),m.m(e.parentNode,e)):m&&(Fe(),D(m,1,1,()=>{m=null}),De()),T[47]&&T[46]?f?(f.p(T,L),98304&L[1]&&M(f,1)):(f=Ig(T),f.c(),M(f,1),f.m(i.parentNode,i)):f&&(Fe(),D(f,1,1,()=>{f=null}),De());let F=n;n=v(T),n===F?k[n].p(T,L):(Fe(),D(k[F],1,1,()=>{k[F]=null}),De(),r=k[n],r?r.p(T,L):(r=k[n]=x[n](T),r.c()),M(r,1),r.m(o.parentNode,o));const B={};16777216&L[1]&&(B.isAnimated=T[55]),1048576&L[0]&&(B.isTransparent=T[20]),268435456&L[1]&&(B.pixelRatio=T[59]),64&L[0]&&(B.textPixelRatio=T[6]),134217728&L[1]&&(B.backgroundColor=T[58]),536870912&L[1]&&(B.maskRect=T[60]),8192&L[2]&&(B.maskOpacity=T[75]?T[75].maskOpacity:1),128&L[0]&&(B.maskMarkupOpacity=T[7]),32&L[0]&&(B.maskFrameOpacity=T[5]),33554432&L[2]&&(B.clipAnnotationsToImage=T[87]),67108864&L[1]&&(B.images=T[57]),67108864&L[2]&&(B.interfaceImages=T[88]),268435456&L[0]&&(B.loadImageData=T[28]),2048&L[0]&&(B.enableGrid=T[11]),134217728&L[2]&&(B.gridSize=T[89]),805306368&L[2]&&(B.gridColors=[T[90],T[91]]),1073741824&L[2]&&(B.gridOpacity=T[92]),1&L[3]&&(B.selectionColor=T[93]),2097152&L[2]|2&L[3]&&(B.willRequest=T[83]||T[94]),512&L[0]|1083965504&L[1]|4&L[3]&&(B.willRender=T[428]),248&L[2]&&(B.didRender=T[429]),a.$set(B);const y={};4&L[0]&&(y.root=T[2]),8&L[0]&&(y.locale=T[3]),8&L[3]&&(y.allowPan=T[96]),131072&L[0]&&(y.enablePan=T[17]),2097152&L[0]&&(y.enablePanLimit=T[21]),4194304&L[0]&&(y.panLimitGutterScalar=T[22]),16&L[3]&&(y.enablePanInput=T[97]),32&L[3]&&(y.allowZoom=T[98]),262144&L[0]&&(y.enableZoom=T[18]),524288&L[0]|64&L[3]&&(y.enableZoomInput=T[19]!==void 0?T[19]:T[99]),128&L[3]&&(y.enableZoomControls=T[100]),8396800&L[0]&&(y.zoomOptions=T[13]||T[23]),16793600&L[0]&&(y.zoomAdjustStep=T[14]||T[24]),33587200&L[0]&&(y.zoomAdjustFactor=T[15]||T[25]),67174400&L[0]&&(y.zoomAdjustWheelFactor=T[16]||T[26]),256&L[3]&&(y.imageSelectionRectCentered=T[101]),512&L[3]&&(y.imageSelectionRectScalar=T[102]),256&L[0]&&(y.elasticity=qp*T[8]),!u&&1&L[0]&&(u=!0,y.zoomLevel=T[0],To(()=>u=!1)),!p&&4&L[1]&&(p=!0,y.zoomControls=T[33],To(()=>p=!1)),!h&&8&L[1]&&(h=!0,y.zoomMultiTouching=T[34],To(()=>h=!1)),d.$set(y)},i(T){g||(M(m),M(f),M(r),M(a.$$.fragment,T),M(d.$$.fragment,T),g=!0)},o(T){D(m),D(f),D(r),D(a.$$.fragment,T),D(d.$$.fragment,T),g=!1},d(T){m&&m.d(T),T&&Q(e),f&&f.d(T),T&&Q(i),k[n].d(T),T&&Q(o),Et(a,T),T&&Q(s),T&&Q(l),t[430](null),T&&Q(c),Et(d,T)}}}function Rg(t){let e,i,n,r,o;return i=new $o({props:{items:t[71]}}),{c(){e=pt("div"),At(i.$$.fragment),w(e,"class","PinturaNav PinturaNavTools")},m(a,s){tt(a,e,s),It(i,e,null),n=!0,r||(o=[Mt(e,"measure",t[415]),Ui(Mr.call(null,e))],r=!0)},p(a,s){const l={};512&s[2]&&(l.items=a[71]),i.$set(l)},i(a){n||(M(i.$$.fragment,a),n=!0)},o(a){D(i.$$.fragment,a),n=!1},d(a){a&&Q(e),Et(i),r=!1,_i(o)}}}function Ig(t){let e,i,n;return i=new ka({props:{elasticity:t[8]*Kp,scrollDirection:t[78]?"y":"x",$$slots:{default:[X5]},$$scope:{ctx:t}}}),{c(){e=pt("div"),At(i.$$.fragment),w(e,"class","PinturaNav PinturaNavMain")},m(r,o){tt(r,e,o),It(i,e,null),n=!0},p(r,o){const a={};256&o[0]&&(a.elasticity=r[8]*Kp),65536&o[2]&&(a.scrollDirection=r[78]?"y":"x"),24576&o[1]|540672&o[2]|8&o[19]&&(a.$$scope={dirty:o,ctx:r}),i.$set(a)},i(r){n||(M(i.$$.fragment,r),n=!0)},o(r){D(i.$$.fragment,r),n=!1},d(r){r&&Q(e),Et(i)}}}function j5(t){let e,i;const n=[t[81],{tabs:t[45]}];let r={$$slots:{default:[Z5,({tab:o})=>({591:o}),({tab:o})=>[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,o?4:0]]},$$scope:{ctx:t}};for(let o=0;o<n.length;o+=1)r=Cn(r,n[o]);return e=new wu({props:r}),e.$on("select",t[416]),{c(){At(e.$$.fragment)},m(o,a){It(e,o,a),i=!0},p(o,a){const s=16384&a[1]|524288&a[2]?Tr(n,[524288&a[2]&&zr(o[81]),16384&a[1]&&{tabs:o[45]}]):{};12&a[19]&&(s.$$scope={dirty:a,ctx:o}),e.$set(s)},i(o){i||(M(e.$$.fragment,o),i=!0)},o(o){D(e.$$.fragment,o),i=!1},d(o){Et(e,o)}}}function U5(t){let e,i;return e=new $o({props:{items:t[45]}}),{c(){At(e.$$.fragment)},m(n,r){It(e,n,r),i=!0},p(n,r){const o={};16384&r[1]&&(o.items=n[45]),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){D(e.$$.fragment,n),i=!1},d(n){Et(e,n)}}}function G5(t){let e,i=t[591].icon+"";return{c(){e=Cr("g")},m(n,r){tt(n,e,r),e.innerHTML=i},p(n,r){4&r[19]&&i!==(i=n[591].icon+"")&&(e.innerHTML=i)},d(n){n&&Q(e)}}}function Z5(t){let e,i,n,r,o,a=t[591].label+"";return e=new Mo({props:{$$slots:{default:[G5]},$$scope:{ctx:t}}}),{c(){At(e.$$.fragment),i=de(),n=pt("span"),r=cn(a)},m(s,l){It(e,s,l),tt(s,i,l),tt(s,n,l),Tt(n,r),o=!0},p(s,l){const c={};12&l[19]&&(c.$$scope={dirty:l,ctx:s}),e.$set(c),(!o||4&l[19])&&a!==(a=s[591].label+"")&&An(r,a)},i(s){o||(M(e.$$.fragment,s),o=!0)},o(s){D(e.$$.fragment,s),o=!1},d(s){Et(e,s),s&&Q(i),s&&Q(n)}}}function X5(t){let e,i,n,r;const o=[U5,j5],a=[];function s(l,c){return l[76]?0:1}return e=s(t),i=a[e]=o[e](t),{c(){i.c(),n=Tn()},m(l,c){a[e].m(l,c),tt(l,n,c),r=!0},p(l,c){let d=e;e=s(l),e===d?a[e].p(l,c):(Fe(),D(a[d],1,1,()=>{a[d]=null}),De(),i=a[e],i?i.p(l,c):(i=a[e]=o[e](l),i.c()),M(i,1),i.m(n.parentNode,n))},i(l){r||(M(i),r=!0)},o(l){D(i),r=!1},d(l){a[e].d(l),l&&Q(n)}}}function Y5(t){let e,i,n;function r(a){t[424](a)}let o={class:"PinturaMain",content:{...t[48].find(t[423]),props:t[27][t[44]]},locale:t[3],stores:t[201]};return t[1][t[44]]!==void 0&&(o.component=t[1][t[44]]),e=new o2({props:o}),zi.push(()=>mo(e,"component",r)),e.$on("measure",t[227]),e.$on("show",t[425]),e.$on("hide",t[426]),e.$on("fade",t[427]),{c(){At(e.$$.fragment)},m(a,s){It(e,a,s),n=!0},p(a,s){const l={};134217728&s[0]|139264&s[1]&&(l.content={...a[48].find(a[423]),props:a[27][a[44]]}),8&s[0]&&(l.locale=a[3]),!i&&2&s[0]|8192&s[1]&&(i=!0,l.component=a[1][a[44]],To(()=>i=!1)),e.$set(l)},i(a){n||(M(e.$$.fragment,a),n=!0)},o(a){D(e.$$.fragment,a),n=!1},d(a){Et(e,a)}}}function q5(t){let e,i;const n=[{class:"PinturaMain"},{visible:t[64]},t[81],{panels:t[80]}];let r={$$slots:{default:[K5,({panel:o,panelIsActive:a})=>({589:o,590:a}),({panel:o,panelIsActive:a})=>[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,(o?1:0)|(a?2:0)]]},$$scope:{ctx:t}};for(let o=0;o<n.length;o+=1)r=Cn(r,n[o]);return e=new Su({props:r}),e.$on("measure",t[422]),{c(){At(e.$$.fragment)},m(o,a){It(e,o,a),i=!0},p(o,a){const s=786436&a[2]?Tr(n,[n[0],4&a[2]&&{visible:o[64]},524288&a[2]&&zr(o[81]),262144&a[2]&&{panels:o[80]}]):{};134217738&a[0]|131200&a[1]|4&a[2]|11&a[19]&&(s.$$scope={dirty:a,ctx:o}),e.$set(s)},i(o){i||(M(e.$$.fragment,o),i=!0)},o(o){D(e.$$.fragment,o),i=!1},d(o){Et(e,o)}}}function K5(t){let e,i,n;function r(...s){return t[417](t[589],...s)}function o(s){t[418](s,t[589])}let a={content:{...t[48].find(r),props:t[27][t[589]]},locale:t[3],isActive:t[590],stores:t[201]};return t[1][t[589]]!==void 0&&(a.component=t[1][t[589]]),e=new o2({props:a}),zi.push(()=>mo(e,"component",o)),e.$on("measure",t[227]),e.$on("show",function(){return t[419](t[589])}),e.$on("hide",function(){return t[420](t[589])}),e.$on("fade",function(...s){return t[421](t[589],...s)}),{c(){At(e.$$.fragment)},m(s,l){It(e,s,l),n=!0},p(s,l){t=s;const c={};134217728&l[0]|131072&l[1]|1&l[19]&&(c.content={...t[48].find(r),props:t[27][t[589]]}),8&l[0]&&(c.locale=t[3]),2&l[19]&&(c.isActive=t[590]),!i&&2&l[0]|1&l[19]&&(i=!0,c.component=t[1][t[589]],To(()=>i=!1)),e.$set(c)},i(s){n||(M(e.$$.fragment,s),n=!0)},o(s){D(e.$$.fragment,s),n=!1},d(s){Et(e,s)}}}function Eg(t){let e,i;return{c(){e=pt("span"),w(e,"class","PinturaEditorOverlay"),w(e,"style",i="opacity:"+t[103])},m(n,r){tt(n,e,r)},p(n,r){1024&r[3]&&i!==(i="opacity:"+n[103])&&w(e,"style",i)},d(n){n&&Q(e)}}}function Ag(t){let e,i;const n=[{layout:"row"},{parentRect:t[52]},t[62]];let r={$$slots:{default:[J5]},$$scope:{ctx:t}};for(let o=0;o<n.length;o+=1)r=Cn(r,n[o]);return e=new v2({props:r}),{c(){At(e.$$.fragment)},m(o,a){It(e,o,a),i=!0},p(o,a){const s=2097152&a[1]|1&a[2]?Tr(n,[n[0],2097152&a[1]&&{parentRect:o[52]},1&a[2]&&zr(o[62])]):{};3&a[2]|8&a[19]&&(s.$$scope={dirty:a,ctx:o}),e.$set(s)},i(o){i||(M(e.$$.fragment,o),i=!0)},o(o){D(e.$$.fragment,o),i=!1},d(o){Et(e,o)}}}function J5(t){let e,i,n;return{c(){e=pt("input"),e.value=i=t[62].text,w(e,"placeholder",n=t[62].placeholder),w(e,"type","text"),w(e,"spellcheck","false"),w(e,"autocorrect","off"),w(e,"autocapitalize","off")},m(r,o){tt(r,e,o),t[434](e)},p(r,o){1&o[2]&&i!==(i=r[62].text)&&e.value!==i&&(e.value=i),1&o[2]&&n!==(n=r[62].placeholder)&&w(e,"placeholder",n)},d(r){r&&Q(e),t[434](null)}}}function Q5(t){let e,i,n,r,o,a;zl(t[414]);let s=t[41]&&Sg(t),l=t[103]>0&&Eg(t),c=t[62]&&Ag(t);return{c(){e=pt("div"),s&&s.c(),i=de(),l&&l.c(),n=de(),c&&c.c(),w(e,"id",t[4]),w(e,"class",t[79]),w(e,"data-env",t[77]),w(e,"dir",t[12])},m(d,u){tt(d,e,u),s&&s.m(e,null),Tt(e,i),l&&l.m(e,null),Tt(e,n),c&&c.m(e,null),t[435](e),r=!0,o||(a=[Mt(Qs,"keydown",t[218]),Mt(Qs,"keyup",t[219]),Mt(Qs,"blur",t[220]),Mt(Qs,"paste",t[224]),Mt(Qs,"resize",t[414]),Mt(e,"ping",function(){ji(t[70])&&t[70].apply(this,arguments)}),Mt(e,"contextmenu",t[221]),Mt(e,"touchstart",t[216],{passive:!1}),Mt(e,"touchmove",function(){ji(t[73])&&t[73].apply(this,arguments)}),Mt(e,"pointermove",function(){ji(t[72])&&t[72].apply(this,arguments)}),Mt(e,"transitionend",t[206]),Mt(e,"dropfiles",t[222]),Mt(e,"measure",t[436]),Mt(e,"click",function(){ji(t[43]?t[223]:$e)&&(t[43]?t[223]:$e).apply(this,arguments)}),Ui(Mr.call(null,e,{observeViewRect:!0,isMeasureRoot:!0})),Ui(I4.call(null,e)),Ui(r2.call(null,e))],o=!0)},p(d,u){(t=d)[41]?s?(s.p(t,u),1024&u[1]&&M(s,1)):(s=Sg(t),s.c(),M(s,1),s.m(e,i)):s&&(Fe(),D(s,1,1,()=>{s=null}),De()),t[103]>0?l?l.p(t,u):(l=Eg(t),l.c(),l.m(e,n)):l&&(l.d(1),l=null),t[62]?c?(c.p(t,u),1&u[2]&&M(c,1)):(c=Ag(t),c.c(),M(c,1),c.m(e,null)):c&&(Fe(),D(c,1,1,()=>{c=null}),De()),(!r||16&u[0])&&w(e,"id",t[4]),(!r||131072&u[2])&&w(e,"class",t[79]),(!r||32768&u[2])&&w(e,"data-env",t[77]),(!r||4096&u[0])&&w(e,"dir",t[12])},i(d){r||(M(s),M(c),r=!0)},o(d){D(s),D(c),r=!1},d(d){d&&Q(e),s&&s.d(),l&&l.d(),c&&c.d(),t[435](null),o=!1,_i(a)}}}const qp=1,Kp=10;function tw(t,e,i){let n,r,o,a,s,l,c,d,u,p,h,g,m,f,x,k,v,C,P,I,O,T,L,F,B,y,V,J,S,H,K,ut,lt,N,ft,$t,Lt,ct,et,ht,Y,Z,St,nt,mt,Ft,oe,Rt,Ut,Ot,j,wt,yt,Gt,ue,pe,ve,ge,_,we,gi,xe,_t,Te,Ie,He,vi,vt,bt,Ze,Pe,ri,Ge,ii,wi,pi,Fi,X,jt,U,Bt,ye,Qt,se,zt,We,Ae,je,Ke,it,Xt,Nt,Zt,Yt,ot,he,ie,fe,Dt,ke,fi,hi,Be,yi,Pi,be,me,Ee,an,Gi,fn,hn,mn,en,qi,Ln,Gn,Nn,gr,Hn,bn,On,Wn,Ri,oo,zn,go,ao,Pr,fr,Mn,Ki,Ur,Qr,fo,yo,Po,so,lo,xo,bo,Fr,yr,to,dn,Qn,vo,Dr,ki,Pn,Zn,$n,eo,Gr,un,Zr,ur,co,pr,jn,uo,xr,io,Xr,Bn,vn,ci,W,ne,Ai,oi,Kt,Se,Li,Vi,pn,nn,Bi,Br,Ho,La,jo,br,Rr,Ro,Io,Eo,E,Re,Ve,Mi,Ni,Ii,Je,bi,qe,Di,gn,Rn,on,yn,Si,vr,po,Ms,Ps,Rs,Is,za,ts,Es=Qe,Ca=Qe;A(t,P4,$=>i(402,Se=$)),t.$$.on_destroy.push(()=>Es()),t.$$.on_destroy.push(()=>Ca());const da=qa(),hr=Sa();let{class:Or}=e,{layout:Xn}=e,{stores:Wr}=e,{locale:Ue}=e,{id:Ao}=e,{util:ua}=e,{utils:_r}=e,{animations:Fa="auto"}=e,{disabled:pa=!1}=e,{status:b}=e,{previewUpscale:G=!1}=e,{previewPad:z=!1}=e,{previewMaskOpacity:st=.95}=e,{previewImageDataMaxSize:dt}=e,{previewImageTextPixelRatio:Vt}=e,{markupMaskOpacity:Pt=1}=e,{zoomMaskOpacity:te=.85}=e,{elasticityMultiplier:Wt=10}=e,{willRevert:Ht=()=>Promise.resolve(!0)}=e,{willProcessImage:re=()=>Promise.resolve(!0)}=e,{willRenderCanvas:ee=Xi}=e,{willRenderToolbar:Ne=Xi}=e,{willRenderUtilTabs:ae=Xi}=e,{willSetHistoryInitialState:Me=Xi}=e,{enableButtonExport:Ce=!0}=e,{enableButtonRevert:Jt=!0}=e,{enableNavigateHistory:Le=!0}=e,{enableToolbar:di=!0}=e,{enableUtils:Oi=!0}=e,{enableButtonClose:mi=!1}=e,{enableDropImage:$i=!1}=e,{enablePasteImage:ti=!1}=e,{enableBrowseImage:rn=!1}=e,{enableTransparencyGrid:Hi=!1}=e,{layoutDirectionPreference:mr="auto"}=e,{layoutHorizontalUtilsPreference:tr="left"}=e,{layoutVerticalUtilsPreference:wn="bottom"}=e,{layoutVerticalToolbarPreference:Sn="top"}=e,{layoutVerticalControlGroupsPreference:wr="bottom"}=e,{layoutVerticalControlTabsPreference:Yr="bottom"}=e,{textDirection:Da}=e,{markupEditorZoomLevel:Ba=null}=e,{markupEditorZoomLevels:As}=e,{markupEditorZoomAdjustStep:Ta}=e,{markupEditorZoomAdjustFactor:Uo}=e,{markupEditorZoomAdjustWheelFactor:Lo}=e,{markupEditorInteractionMode:Oa=!1}=e,{muteAudio:Go=!0}=e,{willSetMediaInitialTimeOffset:es=($,q)=>$*z5(q[0])}=e,{enablePan:Zo=!0}=e,{enableZoom:Wa=!0}=e,{enableZoomControls:_a=!0}=e,{enableZoomInput:Ls}=e,{enablePanInput:al}=e,{enableCanvasAlpha:Xo=!1}=e,{enablePanLimit:Va}=e,{panLimitGutterScalar:er}=e,{zoomPresetOptions:ha=[.25,.5,1,1.25,1.5,2,3,4,6,8,16]}=e,{zoomAdjustStep:Xh=.25}=e,{zoomAdjustFactor:Yh=.1}=e,{zoomAdjustWheelFactor:qh=1}=e,{zoomLevel:zs=null}=e,{fixScrollDirection:Oc=!1}=e;const Kh=le(Oc);let _l,Wc;wo("fixScrollDirection",Kh);let{imagePreviewSrc:Iu}=e,{imageOrienter:_c={read:()=>1,apply:$=>$}}=e,{pluginComponents:sl}=e,{pluginOptions:Fs={}}=e;const N2=da.sub,zo={};let{root:$r}=e;const Eu=()=>{Dt.setAttribute("data-redraw","true"),Os.set({})},Au=le(!0);A(t,Au,$=>i(468,gr=$));const Vl=le(void 0);A(t,Vl,$=>i(410,Eo=$));const is=le(0);A(t,is,$=>i(411,E=$));const Jh=le(0),Qh=le(!1),Vc=$=>{Qh.set($.type==="play"),da.pub($.type)};let t0,Lu,e0,zu,Fu=!1;const Du=()=>{if(!r||!ll())return;zu=d,Ct(Vl,Eo=void 0,Eo);const $=Dt;Fu=!1;const q=1/24,gt=Bs();(Math.abs(l*gt-E*gt)<=q||gt-gt*E<=q)&&Ct(is,E=s,E),Hc(Bs()*E),$.play().catch(()=>{});const kt=()=>{ll()||(e0=requestAnimationFrame(kt),Ct(is,E=Nc()/Bs(),E),zu>=0&&E>=l&&(Ct(is,E=l,E),Ds()),d>-1&&(Fu=!0),Fu&&d===-1&&u>0&&(Ct(is,E=a[u][0],E),Hc(E*Bs())),Eu())};kt()},Ds=()=>{r&&!ll()&&(Ct(Vl,Eo=void 0,Eo),zu=void 0,Dt.pause(),cancelAnimationFrame(e0),Eu())},ll=()=>Dt&&Dt.paused,Bu=()=>{if(r)return ll()?Du():Ds()},Ou=()=>{r&&(Dt.muted=!0)},Wu=()=>{r&&(Dt.muted=!1)},i0=()=>{r&&Ct(Nl,Io=!Io,Io)},Nl=le(Go);A(t,Nl,$=>i(409,Io=$));const Bs=()=>{if(r)return Dt.duration},Nc=()=>{if(r)return Dt.currentTime},Hc=$=>{r&&(Dt.currentTime=$,Jh.set($))};wo("previewcontrols",{play:Du,pause:Ds,togglePlayPause:Bu,mute:Ou,unmute:Wu,toggleMute:i0,setCurrentTime:Hc,getCurrentTime:Nc,getDuration:Bs,currentTime:Jh,frameOffset:is,framePeekOffset:Vl,isPlaying:Qh,isMuted:Nl});const Os=le({});A(t,Os,$=>i(54,On=$)),wo("redrawTrigger",Os);const jc=le(Wt);A(t,jc,$=>i(484,Rr=$)),wo("elasticityMultiplier",jc);let Hl=[];const _u=ai();A(t,_u,$=>i(103,ts=$));const n0=zh()||1024,r0=Vn(n0,n0),o0=Zy(),H2=$=>Promise.resolve(br&&br($,{resourceType:"image"})).then(q=>{if(q===!1)return;const{headers:gt,credentials:kt}=q||{};return fetch($,{headers:gt,credentials:kt}).then(at=>{if(at.status!==200)throw`${at.status} (${at.statusText})`;return at.blob()}).then(at=>bg(at,_c,o0)).then(at=>vg(at,g))});let{imageSourceToImageData:Vu=$=>Oe($)?H2($):Al($)?new Promise(q=>q(zc($))):$h($)||Dc($)?bg($,_c,o0).then(q=>vg(q,g)):void 0}=e;const Nu=(()=>{let $,q;const gt=yg.reduce((kt,at)=>(kt[at]=function(xt,qt,Xe){let Ye=[];return{set:qt,update:Xe,publish:ce=>{Ye.forEach(Wi=>Wi(ce))},subscribe:ce=>(Ye.push(ce),xt(ce),()=>{Ye=Ye.filter(Wi=>Wi!==ce)})}}(xt=>{if(!q)return xt();q.stores[at].subscribe(xt)()},xt=>{q&&q.stores[at].set(xt)},xt=>{q&&q.stores[at].update(xt)}),kt),{});return{update:kt=>{if(q=kt,$&&($.forEach(at=>at()),$=void 0),!kt)return gt.file.publish(void 0),void gt.loadState.publish(void 0);$=yg.map(at=>kt.stores[at].subscribe(xt=>{gt[at].publish(xt)}))},stores:gt,destroy:()=>{$&&$.forEach(kt=>kt())}}})(),{file:Hu,size:Ws,duration:ju,trim:Uu,volume:a0,minDuration:j2,maxDuration:Gu,loadState:Uc,processState:Zu,cropAspectRatio:Gc,cropLimitToImage:Xu,crop:ma,cropMinSize:U2,cropMaxSize:G2,cropRange:Z2,cropOrigin:X2,cropRectAspectRatio:Y2,rotation:cl,rotationRange:q2,targetSize:K2,flipX:Zc,flipY:Xc,backgroundColor:Yc,backgroundImage:s0,colorMatrix:l0,convolutionMatrix:c0,gamma:d0,vignette:u0,noise:p0,decoration:Yu,annotation:qu,manipulation:Ku,redaction:Ju,frame:_s,selection:Qu,state:qc}=Nu.stores;A(t,Hu,$=>i(386,Fr=$)),A(t,Ws,$=>i(359,hi=$)),A(t,ju,$=>i(412,Re=$)),A(t,Uu,$=>i(407,jo=$)),A(t,a0,$=>i(408,Ro=$)),A(t,Gu,$=>i(413,Ve=$)),A(t,Uc,$=>i(378,Ki=$)),A(t,Zu,$=>i(377,Mn=$)),A(t,Gc,$=>i(481,Vi=$)),A(t,Xu,$=>i(87,Je=$)),A(t,ma,$=>i(397,jn=$)),A(t,cl,$=>i(362,Pi=$)),A(t,Zc,$=>i(361,yi=$)),A(t,Xc,$=>i(360,Be=$)),A(t,Yc,$=>i(368,Ln=$)),A(t,Yu,$=>i(50,fi=$)),A(t,qu,$=>i(51,be=$)),A(t,Ku,$=>i(365,mn=$)),A(t,Ju,$=>i(366,en=$)),A(t,_s,$=>i(49,ke=$)),A(t,Qu,$=>i(61,Br=$)),A(t,qc,$=>i(470,dn=$));const h0=($,q,gt=0)=>new Promise((kt,at)=>{if(Wl($))return void(va()?(async Ye=>{const ce=await B5(Ye),Wi=new DataView(ce);return O5(Wi)})($):Promise.resolve()).then(Ye=>{const ce=document.createElement("video");ce.onerror=()=>console.error(ce.error),ce.playsInline=!0,ce.preload="auto",ce.onloadeddata=()=>{ce.onloadeddata=void 0,ce.dataset.rotation=Ye||"0",Yy(ce).then(()=>{const Wi=es(ce.duration,jo||[[0,1]]);Wi>0?(ce.onseeked=()=>{ce.onseeked=void 0,kt(ce)},ce.currentTime=Wi):(ce.currentTime=Wi,kt(ce))})},ce.src=URL.createObjectURL($),ce.load()});let xt,qt=!1;q.cancel=()=>qt=!0;const Xe=Date.now();Vu($).then(Ye=>{const ce=Date.now()-Xe;clearTimeout(xt),xt=setTimeout(()=>{qt||kt(Ye)},Math.max(0,gt-ce))}).catch(at)}),{images:m0,shapePreprocessor:$0,imageScrambler:g0,imageRedactionRendering:f0,willRequest:y0,willRequestResource:x0}=Wr;let jl;A(t,m0,$=>i(406,La=$)),A(t,$0,$=>i(405,Ho=$)),A(t,g0,$=>i(369,Gn=$)),A(t,f0,$=>i(367,qi=$)),A(t,y0,$=>i(83,br=$)),A(t,x0,$=>i(94,yn=$));const J2=Ei(s0,($,q)=>{if(!$)return q(void 0);jl&&(jl.cancel(),jl=void 0),jl={cancel:$e},h0($,jl).then(q).catch(gt=>{})}),Q2=qc.subscribe($=>da.pub("update",$)),tx=le();wo("ui",le({})),wo("selection",Qu);const t1=le(!0);A(t,t1,$=>i(96,vr=$));const e1=le(!0);A(t,e1,$=>i(98,Ms=$));const i1=le(!0);A(t,i1,$=>i(404,Bi=$));const Kc=le(!0);A(t,Kc,$=>i(482,pn=$));const n1=le(!0);A(t,n1,$=>i(99,Ps=$));const r1=le();A(t,r1,$=>i(100,Rs=$));const Jc=le();A(t,Jc,$=>i(483,nn=$));const o1=Ei([Jc,Kc],()=>nn!==void 0?nn:pn);A(t,o1,$=>i(97,po=$));const Ul=le([0,0,0]);A(t,Ul,$=>i(58,Pn=$));const Qc=le([1,1,1]);A(t,Qc,$=>i(466,hn=$));const Gl=ai([1,1,1]);A(t,Gl,$=>i(465,fn=$));const a1=le();A(t,a1,$=>i(93,on=$));const b0=le(),s1=le();A(t,s1,$=>i(53,Hn=$));const dl=le();A(t,dl,$=>i(363,Ee=$));const ul=le(hs());A(t,ul,$=>i(82,Qn=$));const l1=le(0);A(t,l1,$=>i(403,Li=$));const Zl=le(hs());A(t,Zl,$=>i(86,Ii=$));const Vs=le();A(t,Vs,$=>i(463,fe=$));const td=xg("(pointer: fine)",$=>$?"pointer-fine":"pointer-coarse");A(t,td,$=>i(384,xo=$));const ed=xg("(hover: hover)",$=>$?"pointer-hover":"pointer-no-hover");A(t,ed,$=>i(383,lo=$));const v0=le(!1),Xl=le(!1);A(t,Xl,$=>i(364,Gi=$));const c1=kl(void 0,$=>{const q=ai(0),gt=[Xl.subscribe(kt=>{q.set(kt?1:0)}),q.subscribe($)];return()=>gt.forEach(kt=>kt())});A(t,c1,$=>i(464,an=$));const id=le();A(t,id,$=>i(469,yo=$));const nd=le();let d1;A(t,nd,$=>i(55,Ri=$)),wo("isAnimated",nd);const rd=le(G);A(t,rd,$=>i(387,yr=$));const Ns=le(!1);A(t,Ns,$=>i(475,io=$)),wo("imageIsStatic",Ns);const Yl=le();A(t,Yl,$=>i(476,Xr=$));const u1=le();A(t,u1,$=>i(473,uo=$));const w0=kl(void 0,$=>{const q=le(void 0),gt=[ma.subscribe(()=>{if(!jn)return;if(io)return q.set(Ci(jn));const kt=M$(jn,uo,5*Wt);q.set(kt)}),q.subscribe($)];return()=>gt.forEach(kt=>kt())}),Yo=le();A(t,Yo,$=>i(472,pr=$));const od=le();A(t,od,$=>i(474,xr=$));const p1=le(void 0);A(t,p1,$=>i(479,Ai=$));const S0=le(Qi());A(t,S0,$=>i(480,oi=$));const k0=($,q)=>{if(!q||!$)return{top:0,right:0,bottom:0,left:0};const gt=by(q,$,m),kt=xy(gt,$);return{top:Math.abs(kt.top),right:Math.abs(kt.right),bottom:Math.abs(kt.bottom),left:Math.abs(kt.left)}},C0=le({}),h1=Ei([Vs,ul,Zl,C0],([$,q,gt,kt],at)=>{if(!$)return at(void 0);let xt=0;J.length!==1||p||Sn==="bottom"||(xt=gt.y+gt.height),at(In($.x+q.x,$.y+q.y+xt,$.width,$.height))});let ql={left:0,right:0,top:0,bottom:0};const ad=le(!1),pl=Ei([ad,_s,h1,Xl],([$,q,gt,kt],at)=>{if(!gt)return at({left:0,right:0,top:0,bottom:0});if(!$)return;const xt=Math.min(gt.width,gt.height),qt=k0({width:xt,height:xt},q);ni(ql.top,4)===ni(qt.top,4)&&ni(ql.bottom,4)===ni(qt.bottom,4)&&ni(ql.right,4)===ni(qt.right,4)&&ni(ql.left,4)===ni(qt.left,4)||(ql=qt,at(qt))});A(t,pl,$=>i(395,Zr=$));const hl=Ei([ad,pl],([$,q],gt)=>{if(!$)return gt(!1);gt(Object.values(q).some(kt=>kt>0))});A(t,hl,$=>i(396,ur=$));const ex=Ei([ad,Vs,hl,pl],([$,q,gt,kt],at)=>{if(q)return $&&gt?void at(In(q.x+kt.left,q.y+kt.top,q.width-kt.left-kt.right,q.height-kt.top-kt.bottom)):at({...q})}),Ma=Ei([h1,hl,pl],([$,q,gt],kt)=>$?q?void kt(In($.x+gt.left,$.y+gt.top,$.width-gt.left-gt.right,$.height-gt.top-gt.bottom)):kt($):kt(void 0));A(t,Ma,$=>i(52,me=$));const ix=Ei([Ns,Ws,cl],([$,q,gt],kt)=>{if(!$||!q)return kt(void 0);const at=Hr(q);kt(Sr(at,gt))}),m1=Ei([ix],([$],q)=>{if(!$)return q(void 0);const gt=rr($);q(Mc(gt))});A(t,m1,$=>i(399,ci=$));const Na=Ei([Ma,ma,m1,rd],([$,q,gt,kt],at)=>{if(!$||!q||!(!Xr&&!uo))return;const{width:xt,height:qt}=gt||q,Xe=Math.min($.width/xt,$.height/qt);at(kt?Xe:Math.min(1,Xe))});A(t,Na,$=>i(398,vn=$)),wo("imageStaticVisualCorners",Ei([Ns,Ws,cl,Ma,Vs,Na],([$,q,gt,kt,at,xt],qt)=>{if(!($&&kt&&at&&q))return qt(void 0);const Xe=Hr(q),Ye=Mc(Er(Xe,xt)),ce=Xd(kt,Ye);Ye.x=ce.x,Ye.y=ce.y,qt(Sr(Ye,gt))}));const ml=le(void 0);A(t,ml,$=>i(401,Kt=$));const T0=Ei([ma,Ma],([$,q])=>{if(q&&$)return Math.min(q.width/$.width,q.height/$.height)}),$1=Ei([ma,Yo],([$,q])=>$&&q?Math.min($.width/q.width,$.height/q.height):1);A(t,$1,$=>i(102,za=$));const Kl=Ei([ml,$1],([$,q])=>$&&q?q*$:1);A(t,Kl,$=>i(478,W=$));const $l=le(Qi());A(t,$l,$=>i(400,ne=$));const M0=le({scalar:W,translation:ne}),P0=()=>{M0.set({scalar:void 0,translation:Qi()})},sd=kl(void 0,$=>{const q=ai(void 0,{precision:1e-4}),gt=yc()===1?xt=>Wo(xt,Math.round):Xi,kt=()=>{if(!pr)return;const xt=Gi||!yo;if(io){const Xe=Ci(pr);return ea(Xe,oi),ea(Xe,me),q.set(Xe,{hard:xt})}const qt=M$(pr,Ai,qp*Wt);qt.width<0&&(qt.width=0,qt.x=pr.x),qt.height<0&&(qt.height=0,qt.y=pr.y),ea(qt,me),ea(qt,ne),Er(qt,W),!xt&&gt(qt),q.set(qt,{hard:xt})},at=[Ma.subscribe(kt),Yo.subscribe(kt),Kl.subscribe(kt),$l.subscribe(kt),_s.subscribe(kt),q.subscribe($)];return()=>at.forEach(xt=>xt())});A(t,sd,$=>i(60,un=$));const g1=le(1);A(t,g1,$=>i(471,co=$));const f1=()=>{if(!jn||!me)return;let $=ms(Ci(jn),vn||1);const q=Xd(me,ms(Ci(ci),vn));ea($,q);const gt=fe.width/$.width,kt=fe.height/$.height,at=Math.min(1,gt,kt);g1.set(at),Er($,at),((xt,qt)=>{const[Xe,Ye,ce,Wi]=il(xt);Xe<qt.y&&(xt.y=Math.max(qt.y,xt.y)),Ye>qt.width&&(xt.x=qt.width-xt.width),ce>qt.height&&(xt.y=qt.height-xt.height),Wi<qt.x&&(xt.x=Math.max(qt.x,xt.x))})($,{...fe,x:0,y:0}),Yo.set($)},R0=Ei([Ma,Na,ma,Ws],([$,q,gt,kt],at)=>{$&&(gt||kt)&&at(I0($,q||1,gt||kt))});A(t,R0,$=>i(101,Is=$));const I0=($,q,gt)=>gt.width<=$.width&&gt.height<=$.height?Xd($,ms(Ci(gt),q)):Jr($,or(gt));let y1,E0;const x1=$=>{if(p&&y1&&ia(y1,$)&&E0===vn)return;if(io)return f1();y1=$,E0=vn;const q=I0($,vn,jn||hi);Yo.set(q)};let A0=!1;const nx=Na.subscribe($=>{!A0&&$!==void 0&&jn&&(x1(me),A0=!0)}),rx=Ma.subscribe($=>{$&&vn!==void 0&&jn&&x1($)}),ox=Ns.subscribe($=>{!$&&me&&x1(me)});let b1;const ax=od.subscribe($=>{if(!$)return b1=void 0,void Ct(Yl,Xr=void 0,Xr);b1=Bn;const q=Ci(jn);Yl.set(q)}),sx=Yo.subscribe($=>{if(!$||!xr)return;const q=(gt=Ci($),kt=xr,gt.x-=kt.x,gt.y-=kt.y,gt.width-=kt.width,gt.height-=kt.height,gt);var gt,kt;((xt,qt)=>{xt.x/=qt,xt.y/=qt,xt.width/=qt,xt.height/=qt})(q,b1);const at=((xt,qt)=>(xt.x+=qt.x,xt.y+=qt.y,xt.width+=qt.width,xt.height+=qt.height,xt))(Ci(Xr),q);ma.set(at)}),lx=ma.subscribe($=>{if(!$||!pr)return;if(io)return void(xr||f1());if(Gi||xr||uo)return;const q=or(pr),gt=or($);if(ni(q,6)===ni(gt,6))return;const{width:kt,height:at}=jn,xt=Math.min(me.width/kt,me.height/at),qt=Vn($.width*xt,$.height*xt),Xe=.5*(pr.width-qt.width),Ye=.5*(pr.height-qt.height),ce=In(Math.max(0,Math.min(me.width-qt.width,pr.x+Xe)),Math.max(0,Math.min(me.height-qt.height,pr.y+Ye)),qt.width,qt.height);Yo.set(ce)}),L0=Ei([Na,ma,Yo,Ns],([$,q,gt,kt],at)=>{if(!$||!q||!gt)return;if(kt)return at(co);const xt=gt.width/q.width,qt=gt.height/q.height;at(Math.max(xt,qt)/$)}),ld=Ei([Na,L0],([$,q],gt)=>{q&&gt($*q)});A(t,ld,$=>i(477,Bn=$));let gl={left:0,right:0,top:0,bottom:0};const z0=Ei([_s,Yo],([$,q],gt)=>{if(!q)return gt(gl);const kt=k0(q,$);ni(gl.top,4)===ni(kt.top,4)&&ni(gl.bottom,4)===ni(kt.bottom,4)&&ni(gl.right,4)===ni(kt.right,4)&&ni(gl.left,4)===ni(kt.left,4)||(gl=kt,gt(kt))}),cx=Ei([z0],([$],q)=>{q(Object.values($).some(gt=>gt>0))}),v1=ai(.075,{stiffness:.03,damping:.4,precision:.001}),dx=Ei([Gl,Ul,v1,sd,Kl,_s,cx,z0,hl],([$,q,gt,kt,at,xt,qt,Xe,Ye],ce)=>{if(!kt||p)return ce([]);let{x:Wi,y:kn,width:Ir,height:Ji}=kt;Wi+=.5,kn+=.5,Ir-=.5,Ji-=.5;const ir=[];if(xt){if(qt){let{left:Zi,right:Ko,top:Us,bottom:yl}=Xe;Zi*=at,Ko*=at,Us*=at,yl*=at;const U1=kp(q)?[1,1,1,.125]:[0,0,0,.075];ir.push({x:Wi-Zi-.5,y:kn-Us-.5,width:Ir+Zi+Ko+1,height:Ji+Us+yl+1,strokeWidth:1,strokeColor:U1,opacity:Ye?1:.5})}const Fo=kp($);xt&&xt.frameColor&&kp(xt.frameColor)||Fo||(ir.push({x:Wi-1,y:kn-1,width:Ir+2,height:Ji+2,strokeWidth:2,strokeColor:[0,0,0,.1],opacity:gt}),ir.push({x:Wi+1,y:kn+1,width:Ir-2,height:Ji-2,strokeWidth:2,strokeColor:[0,0,0,.1],opacity:gt}))}ce([...ir,{x:Wi,y:kn,width:Ir,height:Ji,strokeWidth:1,strokeColor:$,opacity:gt}])}),Jl=le([]);A(t,Jl,$=>i(389,vo=$));const F0=Ei([dx,Jl],([$,q],gt)=>{gt([...$,...q])});A(t,F0,$=>i(95,Si=$));const w1=ai(0,{precision:.001});A(t,w1,$=>i(391,ki=$));const S1=ai();A(t,S1,$=>i(394,eo=$));const k1=ai();A(t,k1,$=>i(393,$n=$));const C1=ai();A(t,C1,$=>i(392,Zn=$));const T1=ai();A(t,T1,$=>i(390,Dr=$));const Ql=le(!1);A(t,Ql,$=>i(376,fr=$));const tc=le();let ns;A(t,tc,$=>i(379,Ur=$));const M1=Ei([Ql,tc],([$,q],gt)=>{if(!$||!q)return void gt(void 0);if(ns&&(ns.cancel(),i(285,ns=void 0)),Bc(q))return gt(Of(q));const kt=qo.length?0:Ri?250:0;i(285,ns={cancel:$e}),h0(q,ns,kt).then(gt).catch(at=>{Ct(Uc,Ki.error=at,Ki)}).finally(()=>{i(285,ns=void 0)})});Es(),Es=Nr(M1,$=>i(358,Dt=$));let{imagePreviewCurrent:ec}=e;const P1=le({});A(t,P1,$=>i(381,Po=$));const cd=le([]);A(t,cd,$=>i(88,bi=$));const dd=Ei([Ma,dl,Ws,w0,Yo,ld,cl,Zc,Xc,Kl,$l,v0],([$,q,gt,kt,at,xt,qt,Xe,Ye,ce,Wi,kn],Ir)=>{if(!$||!at)return;const Ji=h4($,q,gt,kt,at,ce,Wi,xt,qt,Xe,Ye);!kn&&B(Ji),Ir(Ji)});A(t,dd,$=>i(382,so=$));const D0=Ei([l0,c0,d0,u0,p0],([$,q,gt,kt,at],xt)=>{const qt=$&&Object.keys($).map(Xe=>$[Xe]).filter(Boolean);xt({gamma:gt||void 0,vignette:kt||void 0,noise:at||void 0,convolutionMatrix:q||void 0,colorMatrix:qt&&qt.length&&Ch(qt)})});let ud,R1;const B0=(()=>{if(!ba())return!1;const $=navigator.userAgent.match(/OS (\d+)_(\d+)_?(\d+)?/i)||[],[,q,gt]=$.map(kt=>parseInt(kt,10)||0);return q>13||q===13&&gt>=4})(),ic=le({});A(t,ic,$=>i(370,bn=$)),wo("env",ic);const O0=yc(),I1=kl(O0,$=>{const q=()=>$(yc()),gt=matchMedia(`(resolution: ${O0}dppx)`);return gt.addListener(q),()=>gt.removeListener(q)});A(t,I1,$=>i(59,Gr=$));const Pa=(($,q)=>{const{sub:gt,pub:kt}=qa(),at=[],xt=le(0),qt=[],Xe=()=>qt.forEach(ce=>ce({index:xa(xt),length:at.length})),Ye={get index(){return xa(xt)},set index(ce){ce=Number.isInteger(ce)?ce:0,ce=Yi(ce,0,at.length-1),xt.set(ce),q(at[Ye.index]),Xe()},get state(){return at[at.length-1]},length:()=>at.length,undo(){const ce=Ye.index--;return kt("undo",ce),ce},redo(){const ce=Ye.index++;return kt("redo",Ye.index),ce},revert(){at.length=1,Ye.index=0,kt("revert")},write(ce){ce&&q({...$(),...ce});const Wi=$(),kn=at[at.length-1];JSON.stringify(Wi)!==JSON.stringify(kn)&&(at.length=Ye.index+1,at.push(Wi),xt.set(at.length-1),Xe(),kt("writehistory"))},set(ce={}){at.length=0,Ye.index=0;const Wi=Array.isArray(ce)?ce:[ce];at.push(...Wi),Ye.index=at.length-1},get:()=>[...at],subscribe:ce=>(qt.push(ce),ce({index:Ye.index,length:at.length}),()=>qt.splice(qt.indexOf(ce),1)),on:gt};return Ye})(()=>dn,$=>{Ct(qc,dn=$,dn),ul.set(Qn)});Ca(),Ca=Nr(Pa,$=>i(388,to=$));const W0=()=>{const $={x:0,y:0,...hi},q=Wo(Jr($,dn.cropAspectRatio),Math.round),gt=Me({...dn,rotation:0,crop:q},dn),kt=[gt];JSON.stringify(gt)!==JSON.stringify(dn)&&kt.push({...dn}),Pa.set(kt)},ux=Uc.subscribe($=>{$&&$.complete&&W0()}),px=()=>Ht().then($=>$&&Pa.revert()),rs=le(!1);A(t,rs,$=>i(371,Wn=$));const hx=()=>{Ct(rs,Wn=!0,Wn),re().then($=>{if(!$)return void Ct(rs,Wn=!1,Wn);let q;q=nc.subscribe(gt=>{gt===1&&(q&&q(),hr("processImage"))})})},mx=Zu.subscribe($=>{if(!$)return void Ct(rs,Wn=!1,Wn);Ct(rs,Wn=!0,Wn);const{complete:q,abort:gt}=$;(q||gt)&&Ct(rs,Wn=!1,Wn)}),qo=L5();A(t,qo,$=>i(57,Qr=$));const $x=Ei([qo],([$],q)=>{if(!$.length)return q();const{origin:gt,translation:kt,rotation:at,scale:xt}=$[0];q({origin:gt,translation:kt,rotation:at,scale:xt})}),pd=le();A(t,pd,$=>i(385,bo=$));let hd,md=[];const _0=le(),E1=le(),gx=Ei([ml,E1,Na,T0],([$,q,gt,kt])=>$||(q||gt<1?kt:1)),V0={...Wr,imageFile:Hu,imageSize:Ws,mediaDuration:ju,mediaMinDuration:j2,mediaMaxDuration:Gu,mediaTrim:Uu,imageBackgroundColor:Yc,imageBackgroundImage:s0,imageCropAspectRatio:Gc,imageCropMinSize:U2,imageCropMaxSize:G2,imageCropLimitToImage:Xu,imageCropRect:ma,imageCropRectOrigin:X2,imageCropRectSnapshot:Yl,imageCropRectAspectRatio:Y2,imageCropRange:Z2,imageRotation:cl,imageRotationRange:q2,imageFlipX:Zc,imageFlipY:Xc,imageOutputSize:K2,imageColorMatrix:l0,imageConvolutionMatrix:c0,imageGamma:d0,imageVignette:u0,imageNoise:p0,imageManipulation:Ku,imageDecoration:Yu,imageAnnotation:qu,imageRedaction:Ju,imageFrame:_s,imagePreview:M1,imagePreviewSource:tc,imageTransforms:dd,imagePreviewModifiers:P1,history:Pa,animation:id,pixelRatio:I1,elasticityMultiplier:Wt,scrollElasticity:Kp,rangeInputElasticity:5,redrawTrigger:Os,pointerAccuracy:td,pointerHoverable:ed,env:ic,rootRect:dl,stageRect:Ma,stageRectBase:h1,stageRecenter:C0,stageScalar:Na,stagePadding:pl,stagePadded:hl,presentationScalar:ld,imagePreviewUpscale:E1,utilRect:Vs,utilRectPadded:ex,allowPlayPause:Au,allowPan:t1,allowZoom:e1,allowZoomControls:i1,enableZoomInput:n1,enablePanInput:Kc,enablePanInputStatus:o1,imageSelectionMultiTouching:_0,rootBackgroundColor:Ul,rootForegroundColor:Qc,rootLineColor:Gl,rootColorSecondary:b0,imageOutlineOpacity:v1,utilTools:pd,imageSelectionPan:$l,imageSelectionZoom:ml,imageSelectionZoomCurrent:gx,imageSelectionStageFitScalar:T0,imageSelectionStoredState:M0,imageOverlayMarkup:Jl,interfaceImages:cd,isInteracting:Xl,isTransformingImage:v0,isInteractingFraction:c1,imageCropRectIntent:u1,imageCropRectPresentation:w0,imageSelectionRect:Yo,imageSelectionRectIntent:p1,imageSelectionRectPresentation:sd,imageSelectionRectSnapshot:od,imageScalar:L0,imageTransformsInterpolated:$x,imageEffects:D0};delete V0.image;const fx="util-"+ra();let A1=[];const N0=$=>S.find(([q])=>$===q);let Ha=[],H0=ba();const j0=($,q,gt)=>{let kt=_.getPropertyValue($);kt=gt?gt(kt):/^[0-9]+$/.test(kt)?parseFloat(kt):void 0,q.set(kt,{hard:!Ri})},Hs=($,q,gt=!1)=>{const kt=(at=>{const xt=_.getPropertyValue(at);return b2(xt)})($);kt&&kt[3]!==0&&(gt||(kt.length=3),q.set(kt,{hard:!Ri}))},L1=le();A(t,L1,$=>i(89,qe=$));const z1=le();A(t,z1,$=>i(90,Di=$));const F1=le();A(t,F1,$=>i(91,gn=$));const $d=ai(0,{damping:.9});A(t,$d,$=>i(92,Rn=$));const U0=()=>{Hs("color",Qc),Hs(Xo?"--color-background":"background-color",Ul),Hs("outline-color",Gl),Hs("--color-primary",a1),Hs("--color-secondary",b0),Hs("--grid-color-even",z1,!0),Hs("--grid-color-odd",F1,!0),j0("--grid-size",L1),j0("--editor-inset-top",l1,$=>parseInt($,10))},G0=Ei([dd,D0,Yc,J2],([$,q,gt,kt])=>$&&{...$,...q,backgroundColor:gt,backgroundImage:kt});A(t,G0,$=>i(380,fo=$));const yx=()=>{const $=qo.length?void 0:{resize:1.05},q=((gt,kt,at={})=>{const{resize:xt=1,opacity:qt=0}=at,Xe={opacity:[ai(qt,{...Js,stiffness:.1}),Xi],resize:[ai(xt,{...Js,stiffness:.1}),Xi],translation:[ai(void 0,Js),Xi],rotation:[ai(void 0,Nd),Xi],origin:[ai(void 0,Js),Xi],scale:[ai(void 0,Nd),Xi],gamma:[ai(void 0,Nd),Ji=>Ji||1],vignette:[ai(void 0,Nd),Ji=>Ji||0],colorMatrix:[ai([...wg],Js),Ji=>Ji||[...wg]],convolutionMatrix:[le(void 0),Ji=>Ji&&Ji.clarity||void 0],backgroundColor:[ai(void 0,Js),(Ji,ir,Fo)=>{if(Array.isArray(Ji)){if(Array.isArray(ir)){const Zi=[...Ji];ir[3]===0?(Zi[3]=0,Fo(Zi)):Zi[3]===0&&((Ji=[...ir])[3]=0)}return Ji}}],backgroundImage:[le(void 0),Xi]},Ye=Object.entries(Xe).map(([Ji,ir])=>[Ji,ir[0]]),ce=Ye.map(([,Ji])=>Ji),Wi=Object.entries(Xe).reduce((Ji,[ir,Fo])=>{const[Zi,Ko]=Fo;return Ji[ir]=(Us,yl)=>Zi.set(Ko(Us,kn[ir],U1=>{Zi.set(U1,{hard:!0})}),yl),Ji},{});let kn;const Ir=Ei(ce,Ji=>(kn=Ji.reduce((ir,Fo,Zi)=>(ir[Ye[Zi][0]]=Fo,ir),{}),kn.data=gt,kn.size=kt,kn.scale*=Ji[1],kn));return Ir.get=()=>kn,Ir.set=(Ji,ir)=>{const Fo={hard:!ir};Object.entries(Ji).forEach(([Zi,Ko])=>{Wi[Zi]&&Wi[Zi](Ko,Fo)})},Ir})(Dt,hi,$);qo.unshift(q),Z0(fo)},Z0=$=>{qo.forEach((q,gt)=>{const kt=gt===0?1:0;q.set({...$,opacity:kt,resize:1},yo)})};let gd;const nc=Dh(void 0,{duration:500});let D1;A(t,nc,$=>i(56,ao=$));const fd=le(!1);let ja;A(t,fd,$=>i(375,Pr=$));const yd=ai(void 0,{stiffness:.1,damping:.7,precision:.25});A(t,yd,$=>i(84,Mi=$));const xd=ai(0,{stiffness:.1,precision:.05});A(t,xd,$=>i(85,Ni=$));const rc=ai(0,{stiffness:.02,damping:.5,precision:.25});A(t,rc,$=>i(373,zn=$));const B1=ai(void 0,{stiffness:.02,damping:.5,precision:.25});A(t,B1,$=>i(374,go=$));const bd=ai(void 0,{stiffness:.02,damping:.5,precision:.25});let vd;A(t,bd,$=>i(372,oo=$));const xx=()=>{hr("abortLoadImage")},bx=()=>{hr("abortProcessImage"),Ct(rs,Wn=!1,Wn)},X0=$=>{$.target&&$.target.dataset.touchScroll==="true"||$.preventDefault()},vx=B0?$=>{const q=$.touches?$.touches[0]:$;q.pageX>20&&q.pageX<window.innerWidth-20||X0($)}:$e,js=le([]);A(t,js,$=>i(467,Nn=$)),wo("keysPressed",js);const O1=$=>{!$||Ll($)&&!(q=>/^image/.test(q.type)&&!/svg/.test(q.type))($)||!Ll($)&&!/^http/.test($)||hr("loadImage",$)},wx=$=>{$&&O1($)};let fl,oc,W1=[];const Y0=le();wo("rootPortal",Y0),wo("rootRect",dl);const q0=()=>({foregroundColor:[...hn],lineColor:[...fn],utilVisibility:{...lt},isInteracting:Gi,isInteractingFraction:an,rootRect:Ci(Ee),stageRect:Ci(me),manipulationShapesDirty:Md,annotationShapesDirty:Sd,decorationShapesDirty:Cd,frameShapesDirty:Td}),K0=($,q,gt)=>Un($,Vn(Math.round(q.width/gt),Math.round(q.height/gt))),J0=($,q,gt)=>{var kt;return $._translate=rt((kt=q).x,kt.y),$._scale=gt,$},wd=$=>{const q=[];return $.forEach(gt=>q.push(Sx(gt))),q.filter(Boolean)},Sx=$=>nr($)?($.points=[rt($.x1,$.y1),rt($.x2,$.y2)],$):(!(q=>qn(q)&&!q.text.length)($)||$.backgroundColor&&$.backgroundColor[3]!==0||(su($)&&($.width=5,$.height=$.lineHeight),$.strokeWidth=1,$.strokeColor=[1,1,1,.5],$.backgroundColor=[0,0,0,.1]),$);let Q0,_1=[],V1=[],N1=[],H1=[],j1=[],tm={};const em=($,q,gt,kt,at,xt,qt)=>{const{manipulationShapesDirty:Xe,annotationShapesDirty:Ye,decorationShapesDirty:ce,frameShapesDirty:Wi,selectionRect:kn,scale:Ir}=$,Ji=Q0!==Ir,ir=Ji||!ia(tm,kn);ir&&(Q0=Ir,tm=kn),Xe&&(N1=q.filter(Ad).map(_n).map(Zi=>Un(Zi,hi))),(Ye||gt!==be)&&(_1=gt.filter(Ad).map(_n).sort((Zi,Ko)=>Zi.alwaysOnTop?1:Ko.alwaysOnTop?-1:0).map(Zi=>Un(Zi,hi))),(Ji||kd||Ye||gt!==be)&&(V1=wd(_1.map(Zi=>m(Zi,{flipX:yi,flipY:Be,rotation:Pi,scale:Ir,context:Hr(hi)})).flat())),(ce||kt!==fi||ir)&&(H1=wd(kt.filter(Ad).map(_n).sort((Zi,Ko)=>Zi.alwaysOnTop?1:Ko.alwaysOnTop?-1:0).map(Zi=>K0(Zi,kn,Ir)).map(Zi=>m(Zi,{context:kn})).flat().map(Zi=>J0(Zi,kn,Ir)))),(Wi||xt!==ke||ir)&&(j1=xt?wd([xt].map(_n).map(Zi=>K0(Zi,kn,Ir)).map(m).flat().map(Zi=>J0(Zi,kn,Ir))):[]);let Fo=wd(at.filter(Ad));return typeof window<"u"&&(Zi=>{if(Zi&&Zi._dzq9b88)return;const[Ko]=[[85,110,108,105,99,101,110,115,101,100,32,80,105,110,116,117,114,97,32,105,110,115,116,97,110,99,101]].map(Us=>Us.map(yl=>String.fromCharCode(yl)).join(""));Fo=[...Fo,{x:kn.x+.5*kn.width-82,y:kn.y+kn.height-16-12,width:164,height:16,text:Ko,fontWeight:900,fontSize:12,color:[1,1,1,.25]}]})(window),{manipulationShapesDirty:Xe,manipulationShapes:N1,annotationShapesDirty:Ye,annotationShapes:V1,decorationShapesDirty:ce,decorationShapes:H1,frameShapesDirty:Wi,frameShapes:j1,interfaceShapes:Fo,selectionShapes:qt.map(_n).map(Zi=>Un(Zi,hi))}};let Sd=!0,kd=!0,Cd=!0,Td=!0,Md=!0;return No(()=>{Ds(),Dt&&Oe(Dt.src)&&/^blob:/.test(Dt.src)&&URL.revokeObjectURL(Dt.src),Q2(),rx(),nx(),ox(),ax(),sx(),lx(),ux(),mx(),td.destroy(),ed.destroy(),Nu.destroy(),qo.clear(),_1.length=0,V1.length=0,N1.length=0,H1.length=0,j1.length=0;try{i(229,ec=void 0),i(286,gd=void 0)}catch{}}),t.$$set=$=>{"class"in $&&i(230,Or=$.class),"layout"in $&&i(231,Xn=$.layout),"stores"in $&&i(232,Wr=$.stores),"locale"in $&&i(3,Ue=$.locale),"id"in $&&i(4,Ao=$.id),"util"in $&&i(233,ua=$.util),"utils"in $&&i(234,_r=$.utils),"animations"in $&&i(235,Fa=$.animations),"disabled"in $&&i(236,pa=$.disabled),"status"in $&&i(228,b=$.status),"previewUpscale"in $&&i(237,G=$.previewUpscale),"previewPad"in $&&i(238,z=$.previewPad),"previewMaskOpacity"in $&&i(5,st=$.previewMaskOpacity),"previewImageDataMaxSize"in $&&i(239,dt=$.previewImageDataMaxSize),"previewImageTextPixelRatio"in $&&i(6,Vt=$.previewImageTextPixelRatio),"markupMaskOpacity"in $&&i(7,Pt=$.markupMaskOpacity),"zoomMaskOpacity"in $&&i(240,te=$.zoomMaskOpacity),"elasticityMultiplier"in $&&i(8,Wt=$.elasticityMultiplier),"willRevert"in $&&i(241,Ht=$.willRevert),"willProcessImage"in $&&i(242,re=$.willProcessImage),"willRenderCanvas"in $&&i(9,ee=$.willRenderCanvas),"willRenderToolbar"in $&&i(243,Ne=$.willRenderToolbar),"willRenderUtilTabs"in $&&i(244,ae=$.willRenderUtilTabs),"willSetHistoryInitialState"in $&&i(245,Me=$.willSetHistoryInitialState),"enableButtonExport"in $&&i(246,Ce=$.enableButtonExport),"enableButtonRevert"in $&&i(247,Jt=$.enableButtonRevert),"enableNavigateHistory"in $&&i(248,Le=$.enableNavigateHistory),"enableToolbar"in $&&i(10,di=$.enableToolbar),"enableUtils"in $&&i(249,Oi=$.enableUtils),"enableButtonClose"in $&&i(250,mi=$.enableButtonClose),"enableDropImage"in $&&i(251,$i=$.enableDropImage),"enablePasteImage"in $&&i(252,ti=$.enablePasteImage),"enableBrowseImage"in $&&i(253,rn=$.enableBrowseImage),"enableTransparencyGrid"in $&&i(11,Hi=$.enableTransparencyGrid),"layoutDirectionPreference"in $&&i(254,mr=$.layoutDirectionPreference),"layoutHorizontalUtilsPreference"in $&&i(255,tr=$.layoutHorizontalUtilsPreference),"layoutVerticalUtilsPreference"in $&&i(256,wn=$.layoutVerticalUtilsPreference),"layoutVerticalToolbarPreference"in $&&i(257,Sn=$.layoutVerticalToolbarPreference),"layoutVerticalControlGroupsPreference"in $&&i(258,wr=$.layoutVerticalControlGroupsPreference),"layoutVerticalControlTabsPreference"in $&&i(259,Yr=$.layoutVerticalControlTabsPreference),"textDirection"in $&&i(12,Da=$.textDirection),"markupEditorZoomLevel"in $&&i(260,Ba=$.markupEditorZoomLevel),"markupEditorZoomLevels"in $&&i(13,As=$.markupEditorZoomLevels),"markupEditorZoomAdjustStep"in $&&i(14,Ta=$.markupEditorZoomAdjustStep),"markupEditorZoomAdjustFactor"in $&&i(15,Uo=$.markupEditorZoomAdjustFactor),"markupEditorZoomAdjustWheelFactor"in $&&i(16,Lo=$.markupEditorZoomAdjustWheelFactor),"markupEditorInteractionMode"in $&&i(261,Oa=$.markupEditorInteractionMode),"muteAudio"in $&&i(262,Go=$.muteAudio),"willSetMediaInitialTimeOffset"in $&&i(263,es=$.willSetMediaInitialTimeOffset),"enablePan"in $&&i(17,Zo=$.enablePan),"enableZoom"in $&&i(18,Wa=$.enableZoom),"enableZoomControls"in $&&i(264,_a=$.enableZoomControls),"enableZoomInput"in $&&i(19,Ls=$.enableZoomInput),"enablePanInput"in $&&i(265,al=$.enablePanInput),"enableCanvasAlpha"in $&&i(20,Xo=$.enableCanvasAlpha),"enablePanLimit"in $&&i(21,Va=$.enablePanLimit),"panLimitGutterScalar"in $&&i(22,er=$.panLimitGutterScalar),"zoomPresetOptions"in $&&i(23,ha=$.zoomPresetOptions),"zoomAdjustStep"in $&&i(24,Xh=$.zoomAdjustStep),"zoomAdjustFactor"in $&&i(25,Yh=$.zoomAdjustFactor),"zoomAdjustWheelFactor"in $&&i(26,qh=$.zoomAdjustWheelFactor),"zoomLevel"in $&&i(0,zs=$.zoomLevel),"fixScrollDirection"in $&&i(266,Oc=$.fixScrollDirection),"imagePreviewSrc"in $&&i(269,Iu=$.imagePreviewSrc),"imageOrienter"in $&&i(270,_c=$.imageOrienter),"pluginComponents"in $&&i(271,sl=$.pluginComponents),"pluginOptions"in $&&i(27,Fs=$.pluginOptions),"root"in $&&i(2,$r=$.root),"imageSourceToImageData"in $&&i(28,Vu=$.imageSourceToImageData),"imagePreviewCurrent"in $&&i(229,ec=$.imagePreviewCurrent)},t.$$.update=()=>{if(262144&t.$$.dirty[8]&&Kh.set(Oc),1&t.$$.dirty[0]|4096&t.$$.dirty[8]&&i(0,zs=zs===null?Ba:zs),2&t.$$.dirty[0]|8388608&t.$$.dirty[8]){let at=!1;sl.forEach(([xt])=>{zo[xt]||(i(1,zo[xt]={},zo),at=!0)}),at&&i(283,Hl=[...sl])}var $,q,gt,kt;if(8&t.$$.dirty[0]|131072&t.$$.dirty[7]|16&t.$$.dirty[9]&&i(339,J=Ue&&Hl.length?_r||Hl.map(([at])=>at):[]),134217728&t.$$.dirty[0]|16&t.$$.dirty[9]|536870912&t.$$.dirty[10]|16384&t.$$.dirty[12]&&i(340,S=((at,xt,qt,Xe)=>{const Ye=xt.filter(([ce])=>at.includes(ce)).filter(([ce,{isSupported:Wi}])=>Wi({...Xe,...qt[ce]})).map(([ce,Wi])=>[ce,Wi.Component]);return Ja(Ye,A1,(ce,Wi)=>ce[0]===Wi[0]&&ce[1]===Wi[1])?A1:(A1=Ye,Ye)})(J,Hl,Fs,{src:Fr})),1073741824&t.$$.dirty[10]&&i(294,H=S.length),8&t.$$.dirty[0]|32768&t.$$.dirty[9]|536870912&t.$$.dirty[10]&&i(48,K=H&&J.map(at=>{const xt=N0(at);if(xt)return{id:at,view:xt[1],tabIcon:Ue[at+"Icon"],tabLabel:Ue[at+"Label"]}}).filter(Boolean)||[]),131072&t.$$.dirty[1]&&i(357,n=!!K.find(at=>at.id==="trim")),196608&t.$$.dirty[11]|512&t.$$.dirty[13]&&i(293,r=!!(Re&&Dt&&n)),65536&t.$$.dirty[7]|32768&t.$$.dirty[9]&&i(44,ut=H&&ua&&typeof ua=="string"&&N0(ua)?ua:H>0?S[0][0]:void 0),8192&t.$$.dirty[1]|16384&t.$$.dirty[9]&&r&&ut&&Ds(),16384&t.$$.dirty[9]|131072&t.$$.dirty[11]&&(r?(Dt.addEventListener("play",Vc),Dt.addEventListener("pause",Vc)):Dt&&Dt.nodeName==="video"&&(Dt.removeEventListener("play",Vc),Dt.removeEventListener("pause",Vc))),16384&t.$$.dirty[9]&&r&&is.set(Nc()/Bs()),384&t.$$.dirty[13]&&(at=>{if(!ll())return;const xt=Date.now();if(Lu&&xt-Lu<16)return;Lu=xt;const qt=Re*at;if(qt.toFixed(1)===t0)return;t0=qt.toFixed(1);const Xe=Dt,Ye=()=>{Xe.removeEventListener("seeked",Ye),Eu()};Xe.addEventListener("seeked",Ye),((ce,Wi)=>{ce.fastSeek&&ce.fastSeek(Wi),ce.currentTime=Wi})(Xe,qt)})(Eo||E),256&t.$$.dirty[13]&&i(355,o=E&&ni(E,6)),1552&t.$$.dirty[13]&&i(353,a=jo||[[0,Math.min(Re,Ve)/Re]]),4096&t.$$.dirty[11]&&(s=a[0][0]),4096&t.$$.dirty[11]&&(l=a[a.length-1][1]),4096&t.$$.dirty[11]&&i(356,c=a.map(([at,xt])=>[ni(at,6),ni(xt,6)])),49152&t.$$.dirty[11]&&i(354,d=c.findIndex(([at,xt])=>o>=at&&o<=xt)),57344&t.$$.dirty[11]&&(u=d===-1&&c.findIndex((at,xt,qt)=>{const Xe=qt[xt-1];return Xe?o<=at[0]&&o>=Xe[1]:o<=at[0]})),16384&t.$$.dirty[8]&&Nl.set(Go),131072&t.$$.dirty[11]|64&t.$$.dirty[13]&&(Dt&&Io?Ou():Wu()),131072&t.$$.dirty[11]|32&t.$$.dirty[13]&&Dt&&(at=>{r&&(Dt.volume=Math.min(1,at))})(Ro),256&t.$$.dirty[0]&&Ct(jc,Rr=Wt,Rr),16384&t.$$.dirty[7]&&i(349,p=Xn==="overlay"),2&t.$$.dirty[8]|256&t.$$.dirty[11]&&i(46,h=Oi&&!p),134217730&t.$$.dirty[0]&&Fs&&Object.entries(Fs).forEach(([at,xt])=>{Object.entries(xt).forEach(([qt,Xe])=>{zo[at]&&i(1,zo[at][qt]=Xe,zo)})}),524288&t.$$.dirty[7]&&_u.set(pa?1:0),4194304&t.$$.dirty[7]&&(g=dt?($=dt,q=r0,Vn(Math.min($.width,q.width),Math.min($.height,q.height))):r0),8&t.$$.dirty[13]&&Nu.update(La[0]),4&t.$$.dirty[13]&&(m=Ho?(at,xt)=>Ho(at,{flipX:void 0,flipY:void 0,rotation:void 0,...xt,isPreview:!0}):Xi),1073741824&t.$$.dirty[1]&&Array.isArray(Br)&&hr("selectionchange",[...Br]),65536&t.$$.dirty[8]|2&t.$$.dirty[13]&&r1.set(Bi&&_a),139264&t.$$.dirty[8]&&Jc.set(Oa==="pan"||al),4194304&t.$$.dirty[1]&&Hn&&dl.set(In(Hn.x,Hn.y,Hn.width,Hn.height)),4194560&t.$$.dirty[11]|64&t.$$.dirty[12]&&Ee&&p&&Ki&&Ki.complete&&(()=>{const at=Vi,xt=or(Ee);at&&at===xt||(Gc.set(or(Ee)),W0())})(),536870912&t.$$.dirty[10]&&i(47,Lt=J.length>1),65536&t.$$.dirty[1]&&(Lt||ul.set(hs())),1024&t.$$.dirty[0]|1&t.$$.dirty[13]&&(di||Zl.set(In(0,Li,0,0))),8389632&t.$$.dirty[11]&&i(352,x=!Gi&&f),1073741824&t.$$.dirty[12]&&i(350,k=!Se),4194304&t.$$.dirty[1]&&i(295,Xt=Hn&&Hn.width>0&&Hn.height>0),8&t.$$.dirty[0]|98304&t.$$.dirty[9]&&i(41,Nt=Xt&&Ue&&!!H),1024&t.$$.dirty[1]&&setTimeout(()=>i(284,d1=Nt),1),262144&t.$$.dirty[7]|32&t.$$.dirty[9]|2560&t.$$.dirty[11]&&Ct(id,yo=Fa==="always"?x:Fa!=="never"&&x&&d1&&k,yo),262144&t.$$.dirty[7]|1536&t.$$.dirty[11]&&Ct(nd,Ri=Fa==="always"?f:Fa!=="never"&&f&&k,Ri),1048576&t.$$.dirty[7]|256&t.$$.dirty[11]&&rd.set(G||p),2097152&t.$$.dirty[7]&&ad.set(z),4&t.$$.dirty[0]|603979776&t.$$.dirty[12]&&$r&&($r.dispatchEvent(ss("markupzoom",Kt)),$r.dispatchEvent(ss("zoom",xi(Kt)?Kt:vn))),4&t.$$.dirty[0]|268435456&t.$$.dirty[12]&&$r&&($r.dispatchEvent(ss("markuppan",ne)),$r.dispatchEvent(ss("pan",ne))),33554432&t.$$.dirty[12]&&jn&&P0(),134217728&t.$$.dirty[12]&&ci&&f1(),16785408&t.$$.dirty[1]&&ut&&v1.set(.075,{hard:!Ri}),8388608&t.$$.dirty[7]&&i(347,v=te),25165824&t.$$.dirty[12]&&i(348,C=ur?-Math.max(...Object.values(Zr)):0),555745280&t.$$.dirty[1]|192&t.$$.dirty[11]&&un){let at=un.x-me.x,xt=me.x+me.width-(un.x+un.width),qt=un.y-me.y,Xe=me.y+me.height-(un.y+un.height),Ye=Math.min(at,qt,xt,Xe);w1.set(Ye>C?0:Math.min(v,Math.abs(Ye/64)),{hard:!Ri})}if(268435456&t.$$.dirty[1]&&i(346,P=.55/Gr),18874368&t.$$.dirty[1]|32&t.$$.dirty[11]&&me&&S1.set({x:0,y:me.y,width:me.x<64?0:me.x,height:me.height+P},{hard:!Ri}),18874368&t.$$.dirty[1]|4194336&t.$$.dirty[11]&&me&&k1.set({x:0,y:0,width:Ee.width,height:me.y+P},{hard:!Ri}),18874368&t.$$.dirty[1]|4194336&t.$$.dirty[11]&&me){let at=me.x+me.width,xt=Ee.width-(me.x+me.width);xt<64&&(at+=xt,xt=0),C1.set({x:at,y:me.y,width:xt,height:me.height+P},{hard:!Ri})}if(18874368&t.$$.dirty[1]|4194304&t.$$.dirty[11]&&me&&T1.set({x:0,y:me.y+me.height,width:Ee.width,height:Ee.height-(me.y+me.height)},{hard:!Ri}),134217728&t.$$.dirty[1]|4718592&t.$$.dirty[12]&&i(342,I=eo&&{id:"stage-overlay",backgroundColor:Pn,opacity:ki,...eo}),134217728&t.$$.dirty[1]|2621440&t.$$.dirty[12]&&i(345,O=$n&&{id:"stage-overlay",backgroundColor:Pn,opacity:ki,...$n}),134217728&t.$$.dirty[1]|1572864&t.$$.dirty[12]&&i(344,T=Zn&&{id:"stage-overlay",backgroundColor:Pn,opacity:ki,...Zn}),134217728&t.$$.dirty[1]|786432&t.$$.dirty[12]&&i(343,L=Dr&&{id:"stage-overlay",backgroundColor:Pn,opacity:ki,...Dr}),30&t.$$.dirty[11]&&i(341,F=[O,T,L,I].filter(Boolean)),1&t.$$.dirty[11]|131072&t.$$.dirty[12]&&F&&vo&&Jl.update(at=>[...at.filter(xt=>xt.id!=="stage-overlay"),...F]),2097152&t.$$.dirty[8]|16384&t.$$.dirty[12]&&tc.set(Iu||Fr||void 0),4&t.$$.dirty[0]|4096&t.$$.dirty[7]|131072&t.$$.dirty[11]&&(i(229,ec=Dt),Dt&&$r.dispatchEvent(ss("loadpreview",ec))),128&t.$$.dirty[12]&&Ur&&($l.set(Qi()),ml.set(void 0),P0(),cd.set([])),65536&t.$$.dirty[12]&&i(299,y=to.index>0),65536&t.$$.dirty[12]&&i(298,V=to.index<to.length-1),8&t.$$.dirty[1]&&_0.set(hd),32768&t.$$.dirty[12]&&E1.set(yr),8192&t.$$.dirty[1]&&tx.set(ut),131200&t.$$.dirty[1]&&i(38,lt=K.reduce((at,xt)=>(at[xt.id]=lt&&lt[xt.id]||0,at),{})),8192&t.$$.dirty[1]&&i(81,N={name:fx,selected:ut}),131072&t.$$.dirty[1]&&i(321,ft=K.map(at=>({id:at.id,icon:at.tabIcon,label:at.tabLabel}))),131072&t.$$.dirty[1]&&i(80,$t=K.map(at=>at.id)),8192&t.$$.dirty[7]&&i(79,ct=ui(["PinturaRoot","PinturaRootComponent",Or])),4194304&t.$$.dirty[11]&&i(335,et=Ee&&(Ee.width>1e3?"wide":Ee.width<600?"narrow":void 0)),4194304&t.$$.dirty[11]&&i(322,ht=Ee&&(Ee.width<=320||Ee.height<=460)),4194304&t.$$.dirty[11]&&i(334,Y=Ee&&(Ee.height>1e3?"tall":Ee.height<600?"short":void 0)),4&t.$$.dirty[0]&&i(301,Z=$r&&$r.parentNode&&$r.parentNode.classList.contains("PinturaModal")),1&t.$$.dirty[1]|4194304&t.$$.dirty[9]|4194304&t.$$.dirty[11]&&i(327,St=Z&&Ee&&ud>Ee.width),2&t.$$.dirty[1]|4194304&t.$$.dirty[9]|4194304&t.$$.dirty[11]&&i(326,nt=Z&&Ee&&R1>Ee.height),196608&t.$$.dirty[10]&&i(328,mt=St&&nt),1048576&t.$$.dirty[0]&&i(325,Ft=Xo),33554432&t.$$.dirty[10]&&i(296,oe=et==="narrow"),64&t.$$.dirty[8]|4194304&t.$$.dirty[11]&&i(336,(gt=Ee,kt=mr,Rt=Ee?kt==="auto"?gt.width>gt.height?"landscape":"portrait":kt==="horizontal"?gt.width<500?"portrait":"landscape":kt==="vertical"?gt.height<400?"landscape":"portrait":void 0:"landscape")),67108864&t.$$.dirty[10]&&i(78,Ut=Rt==="landscape"),131072&t.$$.dirty[9]|16777216&t.$$.dirty[10]&&i(324,Ot=oe||Y==="short"),1&t.$$.dirty[1]|4194304&t.$$.dirty[11]&&i(323,j=H0&&Ee&&ud===Ee.width&&!B0),4&t.$$.dirty[1]|8192&t.$$.dirty[12]&&i(297,wt=[...bo||[],...md].filter(Boolean)),128&t.$$.dirty[8]&&i(333,yt="has-navigation-preference-"+tr),256&t.$$.dirty[8]&&i(332,Gt="has-navigation-preference-"+wn),512&t.$$.dirty[8]&&i(329,ue="has-toolbar-preference-"+Sn),1024&t.$$.dirty[8]&&i(331,pe="has-controlgroups-preference-"+wr),2048&t.$$.dirty[8]&&i(330,ve="has-controltabs-preference-"+Yr),4194304&t.$$.dirty[11]&&i(338,ge=Ee!==void 0&&Ee.width>0&&Ee.height>0),4&t.$$.dirty[0]|268435456&t.$$.dirty[10]&&i(337,_=ge&&$r&&getComputedStyle($r)),134217728&t.$$.dirty[10]&&_&&U0(),1024&t.$$.dirty[0]|16875520&t.$$.dirty[1]|540672&t.$$.dirty[7]|4194304&t.$$.dirty[9]|134213632&t.$$.dirty[10]|536870912&t.$$.dirty[11]|6144&t.$$.dirty[12]&&ic.set({...bn,layoutMode:Xn,orientation:Rt,horizontalSpace:et,verticalSpace:Y,navigationHorizontalPreference:yt,navigationVerticalPreference:Gt,controlGroupsVerticalPreference:pe,controlTabsVerticalpreference:ve,toolbarVerticalPreference:ue,isModal:Z,isDisabled:pa,isCentered:mt,isCenteredHorizontally:St,isCenteredVertically:nt,isAnimated:Ri,isTransparent:Ft,pointerAccuracy:xo,pointerHoverable:lo,isCompact:Ot,hasSwipeNavigation:j,hasLimitedSpace:ht,hasToolbar:di,hasNavigation:Lt&&h,isIOS:H0,browserVersion:Fh()?"chrome-"+(navigator.userAgent.match(/Chrome\/([0-9]+)/)||[])[1]:void 0}),536870912&t.$$.dirty[11]&&i(77,we=Object.entries(bn).map(([at,xt])=>/^is|has/.test(at)?xt?w2(at):void 0:xt).filter(Boolean).join(" ")),8192&t.$$.dirty[1]&&ut&&pd.set([]),8192&t.$$.dirty[1]|134217728&t.$$.dirty[7]|2048&t.$$.dirty[10]|536870912&t.$$.dirty[11]&&i(45,gi=ae(ft.map(at=>({...at,selected:ut===at.id})),{...bn},()=>Os.set({}))),16384&t.$$.dirty[1]&&i(76,xe=!!gi.find(at=>Array.isArray(at))),1536&t.$$.dirty[12]&&i(75,_t=so&&Object.entries(Po).filter(([,at])=>at!=null).reduce((at,[,xt])=>at={...at,...xt},{})),64&t.$$.dirty[12]&&i(318,vi=Ki&&Ki.task==="any-to-file"),256&t.$$.dirty[10]&&vi&&qo&&qo.clear(),256&t.$$.dirty[12]&&i(320,Te=!!fo&&!!fo.translation),128&t.$$.dirty[9]|1024&t.$$.dirty[10]|131072&t.$$.dirty[11]&&Te&&Dt&&Dt!==gd&&(i(286,gd=Dt),yx()),1024&t.$$.dirty[10]|256&t.$$.dirty[12]&&Te&&Z0(fo),67108864&t.$$.dirty[1]&&Qr&&Qr.length>1){let at=[];qo.forEach((xt,qt)=>{qt!==0&&xt.get().opacity<=0&&at.push(xt)}),at.forEach(xt=>qo.remove(xt))}if(8&t.$$.dirty[0]|512&t.$$.dirty[10]&&i(40,He=Ue&&Ie.length&&Ue.labelSupportError(Ie)),64&t.$$.dirty[12]&&i(310,vt=Ki&&!!Ki.error),64&t.$$.dirty[12]&&i(43,bt=!Ki||!Ki.complete&&Ki.task===void 0),64&t.$$.dirty[12]&&i(311,Ze=Ki&&(Ki.taskLengthComputable?Ki.taskProgress:1/0)),256&t.$$.dirty[10]&&vi&&Ct(Ql,fr=!1,fr),16777216&t.$$.dirty[1]|256&t.$$.dirty[9]|64&t.$$.dirty[12]&&Ki&&Ki.complete){const at=Ri?250:0;clearTimeout(D1),i(287,D1=setTimeout(()=>{Ct(Ql,fr=!0,fr)},at))}if(4096&t.$$.dirty[1]|1&t.$$.dirty[10]|80&t.$$.dirty[12]&&i(315,Pe=Ki&&!vt&&!bt&&!fr),64&t.$$.dirty[9]|131072&t.$$.dirty[11]|128&t.$$.dirty[12]&&i(314,ri=!(!Ur||Dt&&!ns)),16777216&t.$$.dirty[1]|16&t.$$.dirty[12]&&(fr?setTimeout(()=>$d.set(1),Ri?500:0):$d.set(0)),1073741824&t.$$.dirty[11]|32&t.$$.dirty[12]&&i(309,Ge=!!(Wn||Mn&&Mn.progress!==void 0&&!Mn.complete)),1073741824&t.$$.dirty[9]&&Ge&&Ds(),4096&t.$$.dirty[1]|64&t.$$.dirty[12]&&i(312,ii=Ki&&!(Ki.error||bt)),8&t.$$.dirty[0]|64&t.$$.dirty[12]&&i(313,wi=Ue&&(Ki?!Ki.complete||Ki.error?Lh(Ue.statusLabelLoadImage(Ki),Ki.error&&Ki.error.metadata,"{","}"):Ue.statusLabelLoadImage({progress:1/0,task:"blob-to-bitmap"}):Ue.statusLabelLoadImage(Ki))),8&t.$$.dirty[0]|32&t.$$.dirty[12]&&i(308,pi=Mn&&Ue&&Ue.statusLabelProcessImage(Mn)),32&t.$$.dirty[12]&&i(306,Fi=Mn&&(Mn.taskLengthComputable?Mn.taskProgress:1/0)),32&t.$$.dirty[12]&&i(307,X=Mn&&!Mn.error),32&t.$$.dirty[12]&&i(305,jt=!(!Mn||!Mn.error)),8&t.$$.dirty[0]|4096&t.$$.dirty[1]|2048&t.$$.dirty[7]|2080374784&t.$$.dirty[9]|63&t.$$.dirty[10])if(b){let at,xt,qt,Xe,Ye;Oe(b)&&(at=b),xi(b)?xt=b:Array.isArray(b)&&([at,xt,Ye]=b,xt===!1&&(Xe=!0),xi(xt)&&(qt=!0)),i(35,ja=(at||xt)&&{text:at,aside:Xe||qt,progressIndicator:{visible:qt,progress:xt},closeButton:Xe&&{label:Ue.statusLabelButtonClose,icon:Ue.statusIconButtonClose,onclick:Ye||(()=>i(228,b=void 0))}})}else i(35,ja=Ue&&bt||vt||Pe||ri?{text:wi,aside:vt||ii,progressIndicator:{visible:ii,progress:Ze},closeButton:vt&&{label:Ue.statusLabelButtonClose,icon:Ue.statusIconButtonClose,onclick:xx}}:Ue&&Ge&&pi?{text:pi,aside:jt||X,progressIndicator:{visible:X,progress:Fi},closeButton:jt&&{label:Ue.statusLabelButtonClose,icon:Ue.statusIconButtonClose,onclick:bx}}:void 0);if(2048&t.$$.dirty[7]&&i(317,U=b!==void 0),16777216&t.$$.dirty[1]|4194304&t.$$.dirty[9]|32&t.$$.dirty[12]&&Z&&Mn&&Mn.complete&&(fd.set(!0),setTimeout(()=>fd.set(!1),Ri?100:0)),4&t.$$.dirty[0]|8192&t.$$.dirty[1]|16&t.$$.dirty[12]&&fr&&$r&&$r.dispatchEvent(ss("selectutil",ut)),4608&t.$$.dirty[1]|1073741824&t.$$.dirty[9]|177&t.$$.dirty[10]|8&t.$$.dirty[12]&&i(316,Bt=Pr||He||bt||vt||Pe||ri||Ge||U),64&t.$$.dirty[10]&&Ct(nc,ao=Bt?1:0,ao),16777216&t.$$.dirty[1]|64&t.$$.dirty[10]&&nc.set(Bt?1:0,{duration:Ri?500:1}),33554432&t.$$.dirty[1]&&i(42,ye=ao>0),16&t.$$.dirty[1]&&i(304,Qt=!(!ja||!ja.aside)),16779280&t.$$.dirty[1]|33554944&t.$$.dirty[9]|4&t.$$.dirty[12]&&ye&&ja){clearTimeout(vd);const at={hard:Ri===!1};if(Qt){const xt=!!ja.error||!Ri;xd.set(1,at),yd.set(go,{hard:xt}),i(288,vd=setTimeout(()=>{rc.set(16,at)},1))}else xd.set(0,at),i(288,vd=setTimeout(()=>{rc.set(0,at)},1))}if(2048&t.$$.dirty[1]&&(ye||(bd.set(void 0,{hard:!0}),yd.set(void 0,{hard:!0}),rc.set(0,{hard:!0}))),2&t.$$.dirty[12]&&i(303,se=.5*zn),16777216&t.$$.dirty[9]|1&t.$$.dirty[12]&&i(74,zt=`transform: translateX(${oo-se}px)`),512&t.$$.dirty[1]|131072&t.$$.dirty[11]&&i(39,ie=Dt&&!He),256&t.$$.dirty[1]|12582912&t.$$.dirty[9]&&i(300,Ae=We&&(ie||Z)?X0:$e),2097152&t.$$.dirty[9]&&i(73,je=Ae),2097152&t.$$.dirty[9]&&i(72,Ke=Ae),8&t.$$.dirty[0]|8388608&t.$$.dirty[1]|1677721600&t.$$.dirty[7]|5&t.$$.dirty[8]|1966080&t.$$.dirty[9]|536870912&t.$$.dirty[11]&&i(71,it=Ue&&On&&Ac(()=>Ne([["div","alpha",{class:"PinturaNavGroup"},[["div","alpha-set",{class:"PinturaNavSet"},[mi&&["Button","close",{label:Ue.labelClose,icon:Ue.iconButtonClose,onclick:()=>hr("close"),hideLabel:!0}],Jt&&["Button","revert",{label:Ue.labelButtonRevert,icon:Ue.iconButtonRevert,disabled:!y,onclick:px,hideLabel:!0}]]]]],["div","beta",{class:"PinturaNavGroup PinturaNavGroupFloat"},[Le&&["div","history",{class:"PinturaNavSet"},[["Button","undo",{label:Ue.labelButtonUndo,icon:Ue.iconButtonUndo,disabled:!y,onclick:Pa.undo,hideLabel:!0}],["Button","redo",{label:Ue.labelButtonRedo,icon:Ue.iconButtonRedo,disabled:!V,onclick:Pa.redo,hideLabel:!0}]]],wt.length&&["div","plugin-tools",{class:"PinturaNavSet"},wt.filter(Boolean).map(([at,xt,qt])=>[at,xt,{...qt}])]]],["div","gamma",{class:"PinturaNavGroup"},[Ce&&["Button","export",{label:Ue.labelButtonExport,icon:oe&&Ue.iconButtonExport,class:"PinturaButtonExport",onclick:hx,hideLabel:oe}]]]],{...bn},()=>Os.set({})))),33554432&t.$$.dirty[11]&&i(292,Zt=en&&!!en.length),8192&t.$$.dirty[9]|33816576&t.$$.dirty[11]&&i(291,Yt=Zt&&My(hi,en)),12288&t.$$.dirty[9]|402784256&t.$$.dirty[11]&&Zt&&((at,xt,qt,Xe)=>{if(!xt)return;const Ye={dataSizeScalar:qt};Xe&&Xe[3]>0&&(Ye.backgroundColor=[...Xe]),xt(at,Ye).then(ce=>{fl&&Jn(fl),i(289,fl=ce)})})(Dt,Gn,Yt,Ln),1024&t.$$.dirty[9]|100925440&t.$$.dirty[11]&&en&&fl&&hi){const{width:at,height:xt}=hi,qt=Ia()?"pixelated":qi==="auto"?"auto":"pixelated";i(290,W1=en.map(Xe=>{const Ye=In(Xe.x,Xe.y,Xe.width,Xe.height),ce=Sr(Ci(Ye),Xe.rotation).map(Wi=>rt(Wi.x/at,Wi.y/xt));return{...Xe,id:"redaction",flipX:!1,flipY:!1,cornerRadius:0,strokeWidth:0,strokeColor:void 0,backgroundColor:[0,0,0,0],backgroundImage:fl,backgroundImageRendering:qt,backgroundCorners:ce}}))}2048&t.$$.dirty[9]|16777216&t.$$.dirty[11]&&i(37,ot=[...W1,...mn||[]]),32&t.$$.dirty[1]&&oc&&Y0.set(oc),4&t.$$.dirty[0]|256&t.$$.dirty[1]&&ie&&$r.dispatchEvent(ss("ready")),1048576&t.$$.dirty[1]&&i(65,Sd=!0),3932160&t.$$.dirty[11]&&i(66,kd=!0),524288&t.$$.dirty[1]&&i(67,Cd=!0),262144&t.$$.dirty[1]&&i(68,Td=!0),64&t.$$.dirty[1]&&i(69,Md=!0)},i(351,f=!Bh()),B=yc()===1?$=>{$&&(Co($.origin,Math.round),Co($.translation,Math.round))}:Xi,i(319,Ie=[!A5()&&"WebGL"].filter(Boolean)),i(302,We=ba()||$u()&&va()),i(70,he=(($,q=!0)=>gt=>{gt.type==="ping"&&(q&&gt.stopPropagation(),$(gt.detail.type,gt.detail.data))})(da.pub)),[zs,zo,$r,Ue,Ao,st,Vt,Pt,Wt,ee,di,Hi,Da,As,Ta,Uo,Lo,Zo,Wa,Ls,Xo,Va,er,ha,Xh,Yh,qh,Fs,Vu,M1,Pa,ud,R1,md,hd,ja,oc,ot,lt,ie,He,Nt,ye,bt,ut,gi,h,Lt,K,ke,fi,be,me,Hn,On,Ri,ao,Qr,Pn,Gr,un,Br,_l,Wc,Ha,Sd,kd,Cd,Td,Md,he,it,Ke,je,zt,_t,xe,we,Ut,ct,$t,N,Qn,br,Mi,Ni,Ii,Je,bi,qe,Di,gn,Rn,on,yn,Si,vr,po,Ms,Ps,Rs,Is,za,ts,Au,Vl,is,Nl,Os,jc,_u,Hu,Ws,ju,Uu,a0,Gu,Uc,Zu,Gc,Xu,ma,cl,Zc,Xc,Yc,Yu,qu,Ku,Ju,_s,Qu,qc,m0,$0,g0,f0,y0,x0,t1,e1,i1,Kc,n1,r1,Jc,o1,Ul,Qc,Gl,a1,s1,dl,ul,l1,Zl,Vs,td,ed,Xl,c1,id,nd,rd,Ns,Yl,u1,Yo,od,p1,S0,pl,hl,Ma,m1,Na,ml,$1,Kl,$l,sd,g1,R0,ld,Jl,F0,w1,S1,k1,C1,T1,Ql,tc,P1,cd,dd,ic,I1,rs,qo,pd,V0,L1,z1,F1,$d,({target:$,propertyName:q})=>{$===$r&&/background|outline/.test(q)&&_&&U0()},G0,nc,fd,yd,xd,rc,B1,bd,$=>{const q=!(!ja||!ja.closeButton)||!Ri;B1.set($.detail.width,{hard:q}),bd.set(Math.round(.5*-$.detail.width),{hard:q})},vx,js,$=>{const{keyCode:q,metaKey:gt,ctrlKey:kt,shiftKey:at}=$;if(q===9&&pa)return void $.preventDefault();if($.target&&q===32&&$r.contains($.target)&&!Ec($.target)&&(gr&&r&&Bu(),$.preventDefault()),q===90&&(gt||kt))return void(at&&gt?Pa.redo():Pa.undo());if(q===89&&kt)return void Pa.redo();if(q===229)return;const xt=new Set([...Nn,q]);js.set(Array.from(xt))},({key:$,keyCode:q})=>{if($==="Meta")return js.set([]);js.set(Nn.filter(gt=>gt!==q))},()=>{js.set([])},$=>{Ec($.target)||$.preventDefault()},$=>{$i&&O1($.detail.resources[0])},()=>{rn&&S2().then(wx)},$=>{if(!ti)return;const q=Yi((window.innerWidth-Math.abs(Ee.x))/Ee.width,0,1),gt=Yi((window.innerHeight-Math.abs(Ee.y))/Ee.height,0,1);q<.75&&gt<.75||O1(($.clipboardData||window.clipboardData).files[0])},q0,em,$=>{fe&&ia($.detail,fe)||Ct(Vs,fe=$.detail,fe)},b,ec,Or,Xn,Wr,ua,_r,Fa,pa,G,z,dt,te,Ht,re,Ne,ae,Me,Ce,Jt,Le,Oi,mi,$i,ti,rn,mr,tr,wn,Sn,wr,Yr,Ba,Oa,Go,es,_a,al,Oc,()=>i(62,_l=void 0),($,q,gt)=>{const{text:kt="",placeholder:at="",autoClose:xt=!0,align:qt="top",justify:Xe="center",buttonConfirm:Ye,buttonCancel:ce}=gt;i(62,_l={align:qt,justify:Xe,text:kt,placeholder:at,buttonConfirm:Ye,buttonCancel:ce,onconfirm:()=>{$(Wc.value),xt&&i(62,_l=void 0)},oncancel:()=>{q(void 0),i(62,_l=void 0)}})},Iu,_c,sl,N2,Du,Ds,ll,Bu,Ou,Wu,i0,Bs,Nc,Hc,Hl,d1,ns,gd,D1,vd,fl,W1,Yt,Zt,r,H,Xt,oe,wt,V,y,Ae,Z,We,se,Qt,jt,Fi,X,pi,Ge,vt,Ze,ii,wi,ri,Pe,Bt,U,vi,Ie,Te,ft,ht,j,Ot,Ft,nt,St,mt,ue,ve,pe,Gt,yt,Y,et,Rt,_,ge,J,S,F,I,L,T,O,P,v,C,p,k,f,x,a,d,o,c,n,Dt,hi,Be,yi,Pi,Ee,Gi,mn,en,qi,Ln,Gn,bn,Wn,oo,zn,go,Pr,fr,Mn,Ki,Ur,fo,Po,so,lo,xo,bo,Fr,yr,to,vo,Dr,ki,Zn,$n,eo,Zr,ur,jn,vn,ci,ne,Kt,Se,Li,Bi,Ho,La,jo,Ro,Io,Eo,E,Re,Ve,function(){i(31,ud=Qs.innerWidth),i(32,R1=Qs.innerHeight)},$=>Ct(Zl,Ii=$.detail,Ii),({detail:$})=>i(44,ut=$),($,q)=>q.id===$,function($,q){t.$$.not_equal(zo[q],$)&&(zo[q]=$,i(1,zo),i(271,sl),i(27,Fs))},$=>i(64,Ha=Ha.concat($)),$=>i(64,Ha=Ha.filter(q=>q!==$)),($,{detail:q})=>i(38,lt[$]=q,lt),$=>Ct(ul,Qn=$.detail,Qn),$=>$.id===ut,function($){t.$$.not_equal(zo[ut],$)&&(zo[ut]=$,i(1,zo),i(271,sl),i(27,Fs))},()=>i(64,Ha=Ha.concat(ut)),()=>i(64,Ha=Ha.filter($=>$!==ut)),({detail:$})=>i(38,lt[ut]=$,lt),$=>{const q={...$,...q0()},{annotationShapes:gt,decorationShapes:kt,interfaceShapes:at,frameShapes:xt,selectionShapes:qt}=ee({annotationShapes:be,decorationShapes:fi,interfaceShapes:Si,frameShapes:ke,selectionShapes:Br},q);return em(q,ot,gt,kt,at,xt,qt)},()=>{i(65,Sd=!1),i(66,kd=!1),i(67,Cd=!1),i(68,Td=!1),i(69,Md=!1)},function($){zi[$?"unshift":"push"](()=>{oc=$,i(36,oc)})},function($){zs=$,i(0,zs),i(260,Ba)},function($){md=$,i(33,md)},function($){hd=$,i(34,hd)},function($){zi[$?"unshift":"push"](()=>{Wc=$,i(63,Wc)})},function($){zi[$?"unshift":"push"](()=>{$r=$,i(2,$r)})},$=>Ct(s1,Hn=$.detail,Hn)]}class Lg extends li{constructor(e){super(),si(this,e,tw,Q5,ei,{class:230,layout:231,stores:232,locale:3,id:4,util:233,utils:234,animations:235,disabled:236,status:228,previewUpscale:237,previewPad:238,previewMaskOpacity:5,previewImageDataMaxSize:239,previewImageTextPixelRatio:6,markupMaskOpacity:7,zoomMaskOpacity:240,elasticityMultiplier:8,willRevert:241,willProcessImage:242,willRenderCanvas:9,willRenderToolbar:243,willRenderUtilTabs:244,willSetHistoryInitialState:245,enableButtonExport:246,enableButtonRevert:247,enableNavigateHistory:248,enableToolbar:10,enableUtils:249,enableButtonClose:250,enableDropImage:251,enablePasteImage:252,enableBrowseImage:253,enableTransparencyGrid:11,layoutDirectionPreference:254,layoutHorizontalUtilsPreference:255,layoutVerticalUtilsPreference:256,layoutVerticalToolbarPreference:257,layoutVerticalControlGroupsPreference:258,layoutVerticalControlTabsPreference:259,textDirection:12,markupEditorZoomLevel:260,markupEditorZoomLevels:13,markupEditorZoomAdjustStep:14,markupEditorZoomAdjustFactor:15,markupEditorZoomAdjustWheelFactor:16,markupEditorInteractionMode:261,muteAudio:262,willSetMediaInitialTimeOffset:263,enablePan:17,enableZoom:18,enableZoomControls:264,enableZoomInput:19,enablePanInput:265,enableCanvasAlpha:20,enablePanLimit:21,panLimitGutterScalar:22,zoomPresetOptions:23,zoomAdjustStep:24,zoomAdjustFactor:25,zoomAdjustWheelFactor:26,zoomLevel:0,fixScrollDirection:266,hideTextInput:267,showTextInput:268,imagePreviewSrc:269,imageOrienter:270,pluginComponents:271,pluginOptions:27,sub:272,pluginInterface:1,root:2,play:273,pause:274,isPaused:275,togglePlayPause:276,mute:277,unmute:278,toggleMute:279,getDuration:280,getCurrentTime:281,setCurrentTime:282,imageSourceToImageData:28,imagePreview:29,imagePreviewCurrent:229,history:30},null,[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1])}get class(){return this.$$.ctx[230]}set class(e){this.$$set({class:e}),R()}get layout(){return this.$$.ctx[231]}set layout(e){this.$$set({layout:e}),R()}get stores(){return this.$$.ctx[232]}set stores(e){this.$$set({stores:e}),R()}get locale(){return this.$$.ctx[3]}set locale(e){this.$$set({locale:e}),R()}get id(){return this.$$.ctx[4]}set id(e){this.$$set({id:e}),R()}get util(){return this.$$.ctx[233]}set util(e){this.$$set({util:e}),R()}get utils(){return this.$$.ctx[234]}set utils(e){this.$$set({utils:e}),R()}get animations(){return this.$$.ctx[235]}set animations(e){this.$$set({animations:e}),R()}get disabled(){return this.$$.ctx[236]}set disabled(e){this.$$set({disabled:e}),R()}get status(){return this.$$.ctx[228]}set status(e){this.$$set({status:e}),R()}get previewUpscale(){return this.$$.ctx[237]}set previewUpscale(e){this.$$set({previewUpscale:e}),R()}get previewPad(){return this.$$.ctx[238]}set previewPad(e){this.$$set({previewPad:e}),R()}get previewMaskOpacity(){return this.$$.ctx[5]}set previewMaskOpacity(e){this.$$set({previewMaskOpacity:e}),R()}get previewImageDataMaxSize(){return this.$$.ctx[239]}set previewImageDataMaxSize(e){this.$$set({previewImageDataMaxSize:e}),R()}get previewImageTextPixelRatio(){return this.$$.ctx[6]}set previewImageTextPixelRatio(e){this.$$set({previewImageTextPixelRatio:e}),R()}get markupMaskOpacity(){return this.$$.ctx[7]}set markupMaskOpacity(e){this.$$set({markupMaskOpacity:e}),R()}get zoomMaskOpacity(){return this.$$.ctx[240]}set zoomMaskOpacity(e){this.$$set({zoomMaskOpacity:e}),R()}get elasticityMultiplier(){return this.$$.ctx[8]}set elasticityMultiplier(e){this.$$set({elasticityMultiplier:e}),R()}get willRevert(){return this.$$.ctx[241]}set willRevert(e){this.$$set({willRevert:e}),R()}get willProcessImage(){return this.$$.ctx[242]}set willProcessImage(e){this.$$set({willProcessImage:e}),R()}get willRenderCanvas(){return this.$$.ctx[9]}set willRenderCanvas(e){this.$$set({willRenderCanvas:e}),R()}get willRenderToolbar(){return this.$$.ctx[243]}set willRenderToolbar(e){this.$$set({willRenderToolbar:e}),R()}get willRenderUtilTabs(){return this.$$.ctx[244]}set willRenderUtilTabs(e){this.$$set({willRenderUtilTabs:e}),R()}get willSetHistoryInitialState(){return this.$$.ctx[245]}set willSetHistoryInitialState(e){this.$$set({willSetHistoryInitialState:e}),R()}get enableButtonExport(){return this.$$.ctx[246]}set enableButtonExport(e){this.$$set({enableButtonExport:e}),R()}get enableButtonRevert(){return this.$$.ctx[247]}set enableButtonRevert(e){this.$$set({enableButtonRevert:e}),R()}get enableNavigateHistory(){return this.$$.ctx[248]}set enableNavigateHistory(e){this.$$set({enableNavigateHistory:e}),R()}get enableToolbar(){return this.$$.ctx[10]}set enableToolbar(e){this.$$set({enableToolbar:e}),R()}get enableUtils(){return this.$$.ctx[249]}set enableUtils(e){this.$$set({enableUtils:e}),R()}get enableButtonClose(){return this.$$.ctx[250]}set enableButtonClose(e){this.$$set({enableButtonClose:e}),R()}get enableDropImage(){return this.$$.ctx[251]}set enableDropImage(e){this.$$set({enableDropImage:e}),R()}get enablePasteImage(){return this.$$.ctx[252]}set enablePasteImage(e){this.$$set({enablePasteImage:e}),R()}get enableBrowseImage(){return this.$$.ctx[253]}set enableBrowseImage(e){this.$$set({enableBrowseImage:e}),R()}get enableTransparencyGrid(){return this.$$.ctx[11]}set enableTransparencyGrid(e){this.$$set({enableTransparencyGrid:e}),R()}get layoutDirectionPreference(){return this.$$.ctx[254]}set layoutDirectionPreference(e){this.$$set({layoutDirectionPreference:e}),R()}get layoutHorizontalUtilsPreference(){return this.$$.ctx[255]}set layoutHorizontalUtilsPreference(e){this.$$set({layoutHorizontalUtilsPreference:e}),R()}get layoutVerticalUtilsPreference(){return this.$$.ctx[256]}set layoutVerticalUtilsPreference(e){this.$$set({layoutVerticalUtilsPreference:e}),R()}get layoutVerticalToolbarPreference(){return this.$$.ctx[257]}set layoutVerticalToolbarPreference(e){this.$$set({layoutVerticalToolbarPreference:e}),R()}get layoutVerticalControlGroupsPreference(){return this.$$.ctx[258]}set layoutVerticalControlGroupsPreference(e){this.$$set({layoutVerticalControlGroupsPreference:e}),R()}get layoutVerticalControlTabsPreference(){return this.$$.ctx[259]}set layoutVerticalControlTabsPreference(e){this.$$set({layoutVerticalControlTabsPreference:e}),R()}get textDirection(){return this.$$.ctx[12]}set textDirection(e){this.$$set({textDirection:e}),R()}get markupEditorZoomLevel(){return this.$$.ctx[260]}set markupEditorZoomLevel(e){this.$$set({markupEditorZoomLevel:e}),R()}get markupEditorZoomLevels(){return this.$$.ctx[13]}set markupEditorZoomLevels(e){this.$$set({markupEditorZoomLevels:e}),R()}get markupEditorZoomAdjustStep(){return this.$$.ctx[14]}set markupEditorZoomAdjustStep(e){this.$$set({markupEditorZoomAdjustStep:e}),R()}get markupEditorZoomAdjustFactor(){return this.$$.ctx[15]}set markupEditorZoomAdjustFactor(e){this.$$set({markupEditorZoomAdjustFactor:e}),R()}get markupEditorZoomAdjustWheelFactor(){return this.$$.ctx[16]}set markupEditorZoomAdjustWheelFactor(e){this.$$set({markupEditorZoomAdjustWheelFactor:e}),R()}get markupEditorInteractionMode(){return this.$$.ctx[261]}set markupEditorInteractionMode(e){this.$$set({markupEditorInteractionMode:e}),R()}get muteAudio(){return this.$$.ctx[262]}set muteAudio(e){this.$$set({muteAudio:e}),R()}get willSetMediaInitialTimeOffset(){return this.$$.ctx[263]}set willSetMediaInitialTimeOffset(e){this.$$set({willSetMediaInitialTimeOffset:e}),R()}get enablePan(){return this.$$.ctx[17]}set enablePan(e){this.$$set({enablePan:e}),R()}get enableZoom(){return this.$$.ctx[18]}set enableZoom(e){this.$$set({enableZoom:e}),R()}get enableZoomControls(){return this.$$.ctx[264]}set enableZoomControls(e){this.$$set({enableZoomControls:e}),R()}get enableZoomInput(){return this.$$.ctx[19]}set enableZoomInput(e){this.$$set({enableZoomInput:e}),R()}get enablePanInput(){return this.$$.ctx[265]}set enablePanInput(e){this.$$set({enablePanInput:e}),R()}get enableCanvasAlpha(){return this.$$.ctx[20]}set enableCanvasAlpha(e){this.$$set({enableCanvasAlpha:e}),R()}get enablePanLimit(){return this.$$.ctx[21]}set enablePanLimit(e){this.$$set({enablePanLimit:e}),R()}get panLimitGutterScalar(){return this.$$.ctx[22]}set panLimitGutterScalar(e){this.$$set({panLimitGutterScalar:e}),R()}get zoomPresetOptions(){return this.$$.ctx[23]}set zoomPresetOptions(e){this.$$set({zoomPresetOptions:e}),R()}get zoomAdjustStep(){return this.$$.ctx[24]}set zoomAdjustStep(e){this.$$set({zoomAdjustStep:e}),R()}get zoomAdjustFactor(){return this.$$.ctx[25]}set zoomAdjustFactor(e){this.$$set({zoomAdjustFactor:e}),R()}get zoomAdjustWheelFactor(){return this.$$.ctx[26]}set zoomAdjustWheelFactor(e){this.$$set({zoomAdjustWheelFactor:e}),R()}get zoomLevel(){return this.$$.ctx[0]}set zoomLevel(e){this.$$set({zoomLevel:e}),R()}get fixScrollDirection(){return this.$$.ctx[266]}set fixScrollDirection(e){this.$$set({fixScrollDirection:e}),R()}get hideTextInput(){return this.$$.ctx[267]}get showTextInput(){return this.$$.ctx[268]}get imagePreviewSrc(){return this.$$.ctx[269]}set imagePreviewSrc(e){this.$$set({imagePreviewSrc:e}),R()}get imageOrienter(){return this.$$.ctx[270]}set imageOrienter(e){this.$$set({imageOrienter:e}),R()}get pluginComponents(){return this.$$.ctx[271]}set pluginComponents(e){this.$$set({pluginComponents:e}),R()}get pluginOptions(){return this.$$.ctx[27]}set pluginOptions(e){this.$$set({pluginOptions:e}),R()}get sub(){return this.$$.ctx[272]}get pluginInterface(){return this.$$.ctx[1]}get root(){return this.$$.ctx[2]}set root(e){this.$$set({root:e}),R()}get play(){return this.$$.ctx[273]}get pause(){return this.$$.ctx[274]}get isPaused(){return this.$$.ctx[275]}get togglePlayPause(){return this.$$.ctx[276]}get mute(){return this.$$.ctx[277]}get unmute(){return this.$$.ctx[278]}get toggleMute(){return this.$$.ctx[279]}get getDuration(){return this.$$.ctx[280]}get getCurrentTime(){return this.$$.ctx[281]}get setCurrentTime(){return this.$$.ctx[282]}get imageSourceToImageData(){return this.$$.ctx[28]}set imageSourceToImageData(e){this.$$set({imageSourceToImageData:e}),R()}get imagePreview(){return this.$$.ctx[29]}get imagePreviewCurrent(){return this.$$.ctx[229]}set imagePreviewCurrent(e){this.$$set({imagePreviewCurrent:e}),R()}get history(){return this.$$.ctx[30]}}typeof window<"u"&&(t=>{if(t&&t._dzq9b88)return;const[e,i,n]=[[99,111,110,115,111,108,101],[108,111,103],[84,104,105,115,32,118,101,114,115,105,111,110,32,111,102,32,80,105,110,116,117,114,97,32,105,115,32,102,111,114,32,116,101,115,116,105,110,103,32,112,117,114,112,111,115,101,115,32,111,110,108,121,46,32,86,105,115,105,116,32,104,116,116,112,115,58,47,47,112,113,105,110,97,46,110,108,47,112,105,110,116,117,114,97,47,32,116,111,32,112,117,114,99,104,97,115,101,32,97,32,118,97,108,105,100,32,108,105,99,101,110,115,101,46]].map(r=>r.map(o=>String.fromCharCode(o)).join(""));t&&t[e]&&t[e][i](n)})(window);const ew=["klass","stores","isVisible","isActive","isActiveFraction","locale"],iw=["history","klass","stores","navButtons","pluginComponents","pluginInterface","pluginOptions","sub","imagePreviewSrc","imagePreview","imagePreviewCurrent"],nw=["locale"];let Tp;const k2=new Set([]),tu={},Jp=new Map,rw=(...t)=>{t.filter(e=>!!e.util).forEach(e=>{const[i,n,r=()=>!0]=e.util;Jp.has(i)||(Jp.set(i,{Component:n,isSupported:r}),Oh(n).filter(o=>!ew.includes(o)).forEach(o=>{k2.add(o),tu[o]?tu[o].push(i):tu[o]=[i]}))})};var C2=[...Uy,"init","update","undo","redo","revert","writehistory","destroy","show","hide","close","ready","zoom","pan","loadpreview","selectshape","blurshape","updateshape","addshape","removeshape","selectstyle","markuptap","markupzoom","markuppan","selectutil","selectcontrol","selectiondown","selectionup","selectionchange"],T2=(t,e,i={})=>{const{prefix:n="pintura:"}=i;return C2.map(r=>t.on(r,o=>Al(e)?((a,s,l)=>a.dispatchEvent(new CustomEvent(s,{detail:l,bubbles:!0,cancelable:!0})))(e,`${n}${r}`,o):e(r,o)))};const ow=t=>Oe(t[0]),aw=t=>!ow(t),M2=t=>t[1],Qp=t=>t[3]||[],sw=(t,e)=>{const i=th(t,e);return s2(i,n=>M2(n)===t),i},th=(t,e)=>{if(aw(e)){if(e.find(n=>M2(n)===t))return e;const i=e.find(n=>th(t,Qp(n)));return i&&i[3]}return th(t,Qp(e))},lw=()=>[.75,.25,.25,0,0,.25,.75,.25,0,0,.25,.25,.75,0,0,0,0,0,1,0],cw=()=>[1.398,-.316,.065,-.273,.201,-.051,1.278,-.08,-.273,.201,-.051,.119,1.151,-.29,.215,0,0,0,1,0],dw=()=>[1.073,-.015,.092,-.115,-.017,.107,.859,.184,-.115,-.017,.015,.077,1.104,-.115,-.017,0,0,0,1,0],uw=()=>[1.06,0,0,0,0,0,1.01,0,0,0,0,0,.93,0,0,0,0,0,1,0],pw=()=>[1.1,0,0,0,-.1,0,1.1,0,0,-.1,0,0,1.2,0,-.1,0,0,0,1,0],hw=()=>[.212,.715,.114,0,0,.212,.715,.114,0,0,.212,.715,.114,0,0,0,0,0,1,0],mw=()=>[.15,1.3,-.25,.1,-.2,.15,1.3,-.25,.1,-.2,.15,1.3,-.25,.1,-.2,0,0,0,1,0],$w=()=>[.163,.518,.084,-.01,.208,.163,.529,.082,-.02,.21,.171,.529,.084,0,.214,0,0,0,1,0],gw=()=>[.338,.991,.117,.093,-.196,.302,1.049,.096,.078,-.196,.286,1.016,.146,.101,-.196,0,0,0,1,0],fw=()=>[.393,.768,.188,0,0,.349,.685,.167,0,0,.272,.533,.13,0,0,0,0,0,1,0],yw=()=>[.289,.62,.185,0,.077,.257,.566,.163,0,.115,.2,.43,.128,0,.188,0,0,0,1,0],xw=()=>[.269,.764,.172,.05,.1,.239,.527,.152,0,.176,.186,.4,.119,0,.159,0,0,0,1,0],bw=()=>[.547,.764,.134,0,-.147,.281,.925,.12,0,-.135,.225,.558,.33,0,-.113,0,0,0,1,0],vw={chrome:cw,fade:dw,pastel:lw,cold:pw,warm:uw,monoDefault:hw,monoWash:$w,monoNoir:mw,monoStark:gw,sepiaDefault:fw,sepiaRust:xw,sepiaBlues:yw,sepiaColor:bw};var ww={filterFunctions:vw,filterOptions:[["Default",[[void 0,t=>t.labelDefault]]],["Classic",[["chrome",t=>t.filterLabelChrome],["fade",t=>t.filterLabelFade],["cold",t=>t.filterLabelCold],["warm",t=>t.filterLabelWarm],["pastel",t=>t.filterLabelPastel]]],["Monochrome",[["monoDefault",t=>t.filterLabelMonoDefault],["monoNoir",t=>t.filterLabelMonoNoir],["monoStark",t=>t.filterLabelMonoStark],["monoWash",t=>t.filterLabelMonoWash]]],["Sepia",[["sepiaDefault",t=>t.filterLabelSepiaDefault],["sepiaRust",t=>t.filterLabelSepiaRust],["sepiaBlues",t=>t.filterLabelSepiaBlues],["sepiaColor",t=>t.filterLabelSepiaColor]]]]};const Sw={base:0,min:-.25,max:.25,getLabel:t=>gs(t/.25),getStore:({imageColorMatrix:t})=>t,getValue:t=>{if(t.brightness)return t.brightness[4]},setValue:(t,e)=>t.update(i=>({...i,brightness:[1,0,0,0,e,0,1,0,0,e,0,0,1,0,e,0,0,0,1,0]}))},kw={base:1,min:.5,max:1.5,getLabel:t=>gs(2*(t-.5)-1),getStore:({imageColorMatrix:t})=>t,getValue:t=>{if(t.contrast)return t.contrast[0]},setValue:(t,e)=>t.update(i=>({...i,contrast:[e,0,0,0,.5*(1-e),0,e,0,0,.5*(1-e),0,0,e,0,.5*(1-e),0,0,0,1,0]}))},Cw={base:1,min:0,max:2,getLabel:t=>gs(t-1),getStore:({imageColorMatrix:t})=>t,getValue:t=>{if(t.saturation)return(t.saturation[0]-.213)/.787},setValue:(t,e)=>t.update(i=>({...i,saturation:[.213+.787*e,.715-.715*e,.072-.072*e,0,0,.213-.213*e,.715+.285*e,.072-.072*e,0,0,.213-.213*e,.715-.715*e,.072+.928*e,0,0,0,0,0,1,0]}))},Tw={base:1,min:.5,max:1.5,getLabel:t=>gs(2*(t-.5)-1),getStore:({imageColorMatrix:t})=>t,getValue:t=>{if(t.exposure)return t.exposure[0]},setValue:(t,e)=>t.update(i=>({...i,exposure:[e,0,0,0,0,0,e,0,0,0,0,0,e,0,0,0,0,0,1,0]}))},Mw={base:1,min:.15,max:4,getLabel:t=>gs(t<1?(t-.15)/.85-1:(t-1)/3),getStore:({imageGamma:t})=>t},Pw={base:0,min:-1,max:1,getStore:({imageVignette:t})=>t},Rw={base:0,min:-1,max:1,getStore:({imageConvolutionMatrix:t})=>t,getValue:t=>{if(t.clarity)return t.clarity[0]===0?t.clarity[1]/-1:t.clarity[1]/-2},setValue:(t,e)=>{t.update(i=>({...i,clarity:e>=0?[0,-1*e,0,-1*e,1+4*e,-1*e,0,-1*e,0]:[-1*e,-2*e,-1*e,-2*e,1+-3*e,-2*e,-1*e,-2*e,-1*e]}))}},Iw={base:0,min:-1,max:1,getStore:({imageColorMatrix:t})=>t,getValue:t=>{if(!t.temperature)return;const e=t.temperature[0];return e>=1?(e-1)/.1:(1-e)/-.15},setValue:(t,e)=>t.update(i=>({...i,temperature:e>0?[1+.1*e,0,0,0,0,0,1,0,0,0,0,0,1+.1*-e,0,0,0,0,0,1,0]:[1+.15*e,0,0,0,0,0,1+.05*e,0,0,0,0,0,1+.15*-e,0,0,0,0,0,1,0]}))};var Ew={finetuneControlConfiguration:{gamma:Mw,brightness:Sw,contrast:kw,saturation:Cw,exposure:Tw,temperature:Iw,clarity:Rw,vignette:Pw},finetuneOptions:[["brightness",t=>t.finetuneLabelBrightness],["contrast",t=>t.finetuneLabelContrast],["saturation",t=>t.finetuneLabelSaturation],["exposure",t=>t.finetuneLabelExposure],["temperature",t=>t.finetuneLabelTemperature],["gamma",t=>t.finetuneLabelGamma],!Bh()&&["clarity",t=>t.finetuneLabelClarity],["vignette",t=>t.finetuneLabelVignette]].filter(Boolean)};const Aw={shape:{frameColor:[1,1,1],frameStyle:"solid",frameSize:"2.5%"},thumb:'<rect stroke-width="5" x="0" y="0" width="100%" height="100%"/>'},Lw={shape:{frameColor:[1,1,1],frameStyle:"solid",frameSize:"2.5%",frameRound:!0},thumb:'<rect stroke-width="5" x="0" y="0" width="100%" height="100%" rx="12%"/>'},zw={shape:{frameColor:[1,1,1],frameStyle:"line",frameInset:"2.5%",frameSize:".3125%",frameRadius:0},thumb:'<div style="top:.5em;left:.5em;right:.5em;bottom:.5em;box-shadow:inset 0 0 0 1px currentColor"></div>'},Fw={shape:{frameColor:[1,1,1],frameStyle:"line",frameAmount:2,frameInset:"2.5%",frameSize:".3125%",frameOffset:"1.25%",frameRadius:0},thumb:'<div style="top:.75em;left:.75em;right:.75em;bottom:.75em; outline: 3px double"></div>'},Dw={shape:{frameColor:[1,1,1],frameStyle:"edge",frameInset:"2.5%",frameOffset:"5%",frameSize:".3125%"},thumb:'<div style="top:.75em;left:.5em;bottom:.75em;border-left:1px solid"></div><div style="top:.75em;right:.5em;bottom:.75em;border-right:1px solid"></div><div style="top:.5em;left:.75em;right:.75em;border-top:1px solid"></div><div style="bottom:.5em;left:.75em;right:.75em;border-bottom:1px solid"></div>'},Bw={shape:{frameColor:[1,1,1],frameStyle:"edge",frameInset:"2.5%",frameSize:".3125%"},thumb:'<div style="top:-.5em;left:.5em;right:.5em;bottom:-.5em; box-shadow: inset 0 0 0 1px currentColor"></div><div style="top:.5em;left:-.5em;right:-.5em;bottom:.5em;box-shadow:inset 0 0 0 1px currentColor"></div>'},Ow={shape:{frameColor:[1,1,1],frameStyle:"edge",frameOffset:"1.5%",frameSize:".3125%"},thumb:'<div style="top:.3125em;left:.5em;bottom:.3125em;border-left:1px solid"></div><div style="top:.3125em;right:.5em;bottom:.3125em;border-right:1px solid"></div><div style="top:.5em;left:.3125em;right:.3125em;border-top:1px solid"></div><div style="bottom:.5em;left:.3125em;right:.3125em;border-bottom:1px solid"></div>'},Ww={shape:{frameColor:[1,1,1],frameStyle:"hook",frameInset:"2.5%",frameSize:".3125%",frameLength:"5%"},thumb:'<div style="top:.5em;left:.5em;width:.75em;height:.75em; border-left: 1px solid;border-top: 1px solid;"></div><div style="top:.5em;right:.5em;width:.75em;height:.75em; border-right: 1px solid;border-top: 1px solid;"></div><div style="bottom:.5em;left:.5em;width:.75em;height:.75em; border-left: 1px solid;border-bottom: 1px solid;"></div><div style="bottom:.5em;right:.5em;width:.75em;height:.75em; border-right: 1px solid;border-bottom: 1px solid;"></div>'},_w={shape:{frameColor:[1,1,1],frameStyle:"polaroid"},thumb:'<rect stroke-width="20%" x="-5%" y="-5%" width="110%" height="96%"/>'};var Vw={frameStyles:{solidSharp:Aw,solidRound:Lw,lineSingle:zw,lineMultiple:Fw,edgeSeparate:Dw,edgeCross:Bw,edgeOverlap:Ow,hook:Ww,polaroid:_w},frameOptions:[[void 0,t=>t.labelNone],["solidSharp",t=>t.frameLabelMatSharp],["solidRound",t=>t.frameLabelMatRound],["lineSingle",t=>t.frameLabelLineSingle],["lineMultiple",t=>t.frameLabelLineMultiple],["edgeCross",t=>t.frameLabelEdgeCross],["edgeSeparate",t=>t.frameLabelEdgeSeparate],["edgeOverlap",t=>t.frameLabelEdgeOverlap],["hook",t=>t.frameLabelCornerHooks],["polaroid",t=>t.frameLabelPolaroid]]},Fl=t=>t.charAt(0).toUpperCase()+t.slice(1);let pc=null;var Mp=()=>{if(pc===null)if(Lr())try{pc=document.fonts.check("16px TestNonExistingFont")===!1}catch{pc=!1}else pc=!1;return pc};const Lc=(t,e)=>i=>i[e?`${e}${Fl(t)}`:t],Nw=t=>[t,""+t],Tu=(t,e)=>i=>[t[i],Lc(i,e)],P2=t=>Array.isArray(t)&&t.every(xi)?t.map(Nw):t,qs=[1,.2549,.2118],zg=[1,1,1,0],Hw=t=>{const{hideLabel:e=!0}=t||{};return n3(["new","add","subtract"].map(i=>[i,Lc(i,"shapeLabelSelectionMode"),{icon:Lc(i,"shapeIconSelectionMode"),hideLabel:e}]),{title:i=>i.shapeTitleSelectionMode,layout:"radio"})},jw=t=>R2(t,{title:e=>e.shapeTitleBrushSize,layout:"radio",optionHideLabel:!0,optionIcon:(e,i)=>`<circle fill="currentColor" stroke-width=".05em" stroke="currentColor" fill-opacity=".25" cx="12" cy="12" r="${2+8*i}"/>`}),Fg={eraser:()=>({eraseRadius:8,cursorStyle:"ellipse",cursorSize:"eraseRadius"}),path:()=>({points:[]}),line:()=>({x1:0,y1:0,x2:0,y2:0,disableErase:!1}),rectangle:()=>({x:0,y:0,width:0,height:0}),ellipse:()=>({x:0,y:0,rx:0,ry:0}),text:()=>({x:0,y:0,text:"Text"})},os=(t,e={},i)=>{if(!Fg[t])return;const{position:n="relative",inputMode:r="drag",isSelection:o=!1}=i||{};return[{...Fg[t](),...e},{position:n,inputMode:r,isSelection:o}]},Uw=t=>({sharpie:os("path",{bitmap:!0,strokeJoin:"round",strokeCap:"round",strokeWidth:"0.5%",strokeColor:[...qs],cursorStyle:"ellipse",cursorSize:"strokeWidth",disableErase:!1,disableResize:!0,disableMove:!0}),eraser:os("eraser"),path:os("path",{pathClose:void 0,strokeWidth:"0.5%",strokeColor:[...qs],backgroundColor:[0,0,0,0]},{inputMode:"step"}),line:os("line",{strokeColor:[...qs],strokeWidth:"0.5%"}),arrow:os("line",{lineStart:"none",lineEnd:"arrow-solid",strokeColor:[...qs],strokeWidth:"0.5%"}),rectangle:os("rectangle",{strokeColor:[...zg],backgroundColor:[...qs]}),ellipse:os("ellipse",{strokeColor:[...zg],backgroundColor:[...qs]}),text:os("text",{color:[...qs],fontSize:"2%"}),...t}),Pp=(t,e,i)=>[t,e||Lc(t,"shapeLabelTool"),{icon:Lc(t,"shapeIconTool"),...i}],Gw=(t=["move","view","sharpie","eraser","path","line","arrow","rectangle","ellipse","text","preset"])=>t.map(e=>Oe(e)?Pp(e):Array.isArray(e)?nl(e[1])?Pp(e[0],void 0,e[1]):Pp(e[0],e[1],e[2]):void 0).filter(Boolean),Zw=t=>Object.keys(t).map(Tu(t,"shapeTitleColor")),Xw=t=>Object.keys(t).map(Tu(t,"labelSize")),Yw=t=>Object.keys(t).map(Tu(t,"labelSize")),Dg=t=>Object.keys(t).map(Tu(t,"labelSize")),qw=t=>[...t],Kw=t=>t.map(e=>[e,i=>i["shapeLabelFontStyle"+e.filter(n=>n!=="normal").map(Fl).join("")]]),Jw=t=>t.map(e=>[w2(e),i=>i["shapeTitleLineDecoration"+Fl(e)],{icon:i=>i["shapeIconLineDecoration"+Fl(e)]}]),wa=(t,e)=>{const{defaultKey:i,defaultValue:n,defaultOptions:r}=e||{},o=[];return i&&(o[0]=[n,a=>a[i],{...r}]),[...o,...t]},Bg=t=>t.split(",").map(e=>e.trim()).some(e=>document.fonts.check("16px "+e)),Og=(t={})=>["ToggleSlider",{...t}],Qw=(t,e={defaultKey:"labelDefault"})=>["Dropdown",{title:i=>i.shapeTitleFontFamily,onload:({options:i=[]})=>{Mp()&&i.map(([n])=>n).filter(Boolean).filter(n=>!Bg(n)).forEach(n=>{const r="PinturaFontTest-"+n.replace(/[^a-zA-Z0-9]+/g,"").toLowerCase();document.getElementById(r)||document.body.append(ln("span",{textContent:" ",id:r,class:"PinturaFontTest",style:`font-family:${n};font-size:0;color:transparent;`}))})},ondestroy:()=>{Mp()&&document.querySelectorAll(".PinturaFontTest").forEach(i=>i.remove())},optionLabelStyle:i=>"font-family: "+i,options:wa(t,e),optionFilter:i=>{if(!Mp())return!0;const[n]=i;return n?Bg(n):!0}}],Mu=(t,e={})=>["ColorPicker",{options:wa(t),...e}],t3=(t,e={})=>Mu(t,{title:i=>i.labelColor,...e}),e3=(t,e={})=>Mu(t,{title:i=>i.shapeTitleBackgroundColor,...e}),i3=(t,e={})=>Mu(t,{title:i=>i.shapeTitleStrokeColor,options:wa(t),buttonClass:"PinturaColorPickerButtonStroke",onchange:(i,n)=>{const r=n.strokeWidth;(xi(r)||Oe(r)?parseFloat(r):0)>0||(n.strokeWidth=e&&e.defaultStrokeWidth||"0.5%")},...e}),R2=(t,e)=>{const{title:i,optionHideLabel:n=!1,layout:r,optionIcon:o=!1}=e||{},a=P2(t),s=t.map(([u])=>Oe(u)?parseFloat(u):u),l=Math.max(...s),c=Math.min(...s),d=l-c;return[r==="radio"?"RadioGroup":"Dropdown",{title:i===!1?void 0:i||(u=>u.shapeTitleStrokeWidth),options:u=>{const p=e?a.map(h=>{const[g,m,f={}]=h,x=Oe(g)?parseFloat(g):g,k=(x-c)/d;let v;return o==="line"?v=`<path stroke="currentColor" stroke-linecap="square" stroke-width="${.1+.875*k}em" d="M3,12 H20"/>`:o==="dot"?v=`<circle fill="currentColor" cx="12" cy="12" r="${2+8*k}"/>`:Oe(o)?v=o:tn(o)&&(v=o(x,k)),[g,m,{icon:v,hideLabel:n,...f}]}):a;return ze(u,"backgroundColor")?wa(p,{defaultKey:"shapeLabelStrokeNone"}):wa(p)},onchange:(u,p)=>{if(!u)return;const h=p.strokeColor||[];if(h[3])return;const g=[...h];g[3]=1,p.strokeColor=g}}]},n3=(t,e)=>{const{title:i,layout:n}=e||{};return[n==="radio"?"RadioGroup":"Dropdown",{title:i,options:wa(t)}]},I2=(t,e,i)=>["Dropdown",{title:n=>n[e],options:wa(t,{defaultKey:"labelNone",defaultOptions:{icon:'<g stroke="currentColor" stroke-linecap="round" stroke-width=".125em"><path d="M5,12 H14"/></g>'}}),optionIconStyle:i}],r3=t=>I2(t,"shapeTitleLineStart","transform: scaleX(-1)"),o3=t=>I2(t,"shapeTitleLineEnd"),a3=t=>Mu(t,{title:e=>e.shapeTitleTextColor,options:wa(t)}),s3=t=>["Dropdown",{title:e=>e.shapeTitleFontStyle,optionLabelStyle:e=>e&&`font-style:${e[0]};font-weight:${e[1]}`,options:wa(t,{defaultKey:"shapeLabelFontStyleNormal"})}],E2=t=>["ShorthandControl",t],A2=(t,e,i,n)=>{n||t.find(([o])=>o===i)||(n={defaultKey:"labelAuto",defaultValue:i});const r=P2(t);return["Dropdown",{title:e,options:wa(r,n),...n}]},l3=(t,e)=>A2(t,i=>i.shapeTitleFontSize,"4%",e),c3=(t,e)=>A2(t,i=>i.shapeTitleLineHeight,"120%",e),d3=t=>["RadioGroup",{title:e=>e.shapeTitleTextAlign,options:wa(t)}],Rp={colorOptions:()=>Zw({transparent:[1,1,1,0],white:[1,1,1],silver:[.8667,.8667,.8667],gray:[.6667,.6667,.6667],black:[0,0,0],navy:[0,.1216,.2471],blue:[0,.4549,.851],aqua:[.498,.8588,1],teal:[.2235,.8,.8],olive:[.2392,.6,.4392],green:[.1804,.8,.251],yellow:[1,.8627,0],orange:[1,.5216,.1059],red:[1,.2549,.2118],maroon:[.5216,.0784,.2941],fuchsia:[.9412,.0706,.7451],purple:[.6941,.051,.7882]}),lineEndStyleOptions:()=>Jw(["bar","arrow","arrowSolid","circle","circleSolid","square","squareSolid"]),fontFamilyOptions:()=>qw([["Helvetica, Arial, Verdana, 'Droid Sans', sans-serif","Sans Serif"],["'Arial Black', 'Avenir-Black', 'Arial Bold'","Black"],["'Arial Narrow', 'Futura-CondensedMedium'","Narrow"],["'Trebuchet MS'","Humanist"],["Georgia, 'Avenir-Black', 'Times New Roman', 'Droid Serif', serif","Serif"],["Palatino","Old-Style"],["'Times New Roman', 'TimesNewRomanPSMT'","Transitional"],["Menlo, Monaco, 'Lucida Console', monospace","Monospaced"],["'Courier New', monospace","Slab Serif"]]),fontStyleOptions:()=>Kw([["normal","bold"],["italic","normal"],["italic","bold"]]),textAlignOptions:()=>["left","center","right"].map(t=>[t,e=>e["shapeTitleTextAlign"+Fl(t)],{hideLabel:!0,icon:e=>e["shapeIconTextAlign"+Fl(t)]}]),strokeWidthOptions:()=>Dg({extraSmall:"0.25%",small:"0.5%",mediumSmall:"1%",medium:"1.75%",mediumLarge:"2.5%",large:"3.5%",extraLarge:"5%"}),brushSizeOptions:()=>Dg(Object.entries({extraSmall:"0.25%",small:"0.5%",mediumSmall:"1%",medium:"1.75%",mediumLarge:"2.5%",large:"3.5%",extraLarge:"5%"}).reduce((t,[e,i])=>(t[e]=2*parseFloat(i)+"%",t),{})),fontSizeOptions:()=>Xw({extraSmall:"2%",small:"4%",mediumSmall:"8%",medium:"10%",mediumLarge:"15%",large:"20%",extraLarge:"25%"}),lineHeightOptions:()=>Yw({extraSmall:"40%",small:"60%",mediumSmall:"100%",medium:"120%",mediumLarge:"140%",large:"180%",extraLarge:"220%"})},u3=new Intl.NumberFormat("default",{minimumFractionDigits:1,maximumFractionDigits:1}),L2=(t,e)=>Oe(e)?t+"%":t,z2=(t,e,i,n)=>Oe(n)?Math.round(t/i*100)+"%":""+u3.format(t),Ip={getValue:t=>parseFloat(t),setValue:L2,label:z2,step:.05,labelClass:"PinturaPercentageLabel"},p3={factory:E2,options:{title:"Text shadow",controls:[["ToggleSlider","x",{...Ip,min:-100,max:100,labelPrefix:"X"}],["ToggleSlider","y",{...Ip,min:-100,max:100,labelPrefix:"Y"}],["ToggleSlider","blur",{...Ip,min:0,max:25,labelPrefix:t=>t.shapeTitleTextShadowBlur}],["ColorPicker","color",{enablePresets:!1}]]}},Hd={defaultColor:{factory:t3,items:"colorOptions"},defaultNumber:{factory:Og},defaultPercentage:{factory:Og,options:{getValue:t=>parseFloat(t),setValue:t=>t+"%",step:.05,label:(t,e,i)=>Math.round(t/i*100)+"%",labelClass:"PinturaPercentageLabel"}},backgroundColor:{items:"colorOptions",factory:e3},strokeColor:{items:"colorOptions",factory:i3},strokeWidth:{items:"strokeWidthOptions",factory:R2},brushSize:{items:"brushSizeOptions",factory:jw},drawMode:{factory:Hw},lineStart:{items:"lineEndStyleOptions",factory:r3},lineEnd:{items:"lineEndStyleOptions",factory:o3},color:{items:"colorOptions",factory:a3},fontFamily:{items:"fontFamilyOptions",factory:Qw},fontStyle_fontWeight:{items:"fontStyleOptions",factory:s3},fontSize:{items:"fontSizeOptions",factory:l3},lineHeight:{items:"lineHeightOptions",factory:c3},textAlign:{items:"textAlignOptions",factory:d3},textShadowX_textShadowY_textShadowBlur_textShadowColor:p3,textOutlineWidth_textOutlineColor:{factory:E2,options:{title:"Text outline",controls:[["ToggleSlider","width",{getValue:t=>parseFloat(t),setValue:L2,label:z2,min:0,max:15,step:.05,labelClass:"PinturaPercentageLabel",labelPrefix:t=>t.shapeTitleTextOutlineWidth}],["ColorPicker","color",{enablePresets:!1}]]}},cornerRadius:{factory:"defaultPercentage",options:{min:0,max:50,title:t=>t.shapeTitleCornerRadius}},frameColor:{factory:"defaultColor"},frameSize:{factory:"defaultPercentage",options:{min:.2,max:10,title:t=>t.labelSize}},frameInset:{factory:"defaultPercentage",options:{min:.5,max:10,title:t=>t.labelOffset}},frameOffset:{factory:"defaultPercentage",options:{min:.5,max:10,title:t=>t.labelOffset}},frameRadius:{factory:"defaultPercentage",options:{min:.5,max:10,title:t=>t.labelRadius}},frameAmount:{factory:"defaultNumber",options:{min:1,max:5,step:1,title:t=>t.labelAmount}}},F2=(t={})=>{const e={...Hd,...t},i={};return Object.entries(e).forEach(([n,r])=>{if(!/Options$/.test(n))if(Hd[n]&&nl(r)&&!En(r)){const{component:o,factory:a,items:s,options:l={}}=e[n];if(Oe(a))i[n]=[a,l];else{const c=Hd[n].items;let d=Oe(c)?e[c]||Rp[c]():void 0;Oe(s)&&Rp[s]?d=e[s]?e[s].every(p=>!Array.isArray(p))?e[s].map(p=>[p,p]):e[s]:Rp[s]():(s||l.items)&&(d=s||l.items);let u=a||Hd[n].factory;tn(u)?i[n]=d?u(d,l):u(l):o&&(i[n]=[o,{...l,items:s}])}}else i[n]=r}),i};function h3(t){let e,i,n,r,o;const a=t[7].default,s=sr(a,t,t[6],null);return{c(){e=pt("div"),i=pt("div"),s&&s.c(),w(i,"class","PinturaToolbarInner"),w(e,"class","PinturaToolbar"),w(e,"data-layout",t[1]),w(e,"data-overflow",t[0])},m(l,c){tt(l,e,c),Tt(e,i),s&&s.m(i,null),n=!0,r||(o=[Mt(i,"measure",t[3]),Ui(Mr.call(null,i)),Mt(e,"measure",t[2]),Ui(Mr.call(null,e))],r=!0)},p(l,[c]){s&&s.p&&(!n||64&c)&&cr(s,a,l,l[6],n?lr(a,l[6],c,null):dr(l[6]),null),(!n||2&c)&&w(e,"data-layout",l[1]),(!n||1&c)&&w(e,"data-overflow",l[0])},i(l){n||(M(s,l),n=!0)},o(l){D(s,l),n=!1},d(l){l&&Q(e),s&&s.d(l),r=!1,_i(o)}}}function m3(t,e,i){let n,r,{$$slots:o={},$$scope:a}=e,s=0,l=0,c=0;const d=()=>{i(0,r=n==="compact"&&s>c?"overflow":void 0)};return t.$$set=u=>{"$$scope"in u&&i(6,a=u.$$scope)},t.$$.update=()=>{48&t.$$.dirty&&i(1,n=l>c?"compact":"default")},[r,n,({detail:u})=>{const{width:p}=u;i(5,c=p),d()},({detail:u})=>{const{width:p}=u;p>l&&i(4,l=p),s=p,r||d()},l,c,a,o]}class D2 extends li{constructor(e){super(),si(this,e,m3,h3,ei,{})}}function $3(t){let e,i,n,r;const o=t[5].default,a=sr(o,t,t[4],null);return{c(){e=pt("div"),a&&a.c(),w(e,"class",t[0])},m(s,l){tt(s,e,l),a&&a.m(e,null),i=!0,n||(r=[Mt(e,"measure",function(){ji(t[1]&&t[3])&&(t[1]&&t[3]).apply(this,arguments)}),Ui(t[2].call(null,e))],n=!0)},p(s,[l]){t=s,a&&a.p&&(!i||16&l)&&cr(a,o,t,t[4],i?lr(o,t[4],l,null):dr(t[4]),null),(!i||1&l)&&w(e,"class",t[0])},i(s){i||(M(a,s),i=!0)},o(s){D(a,s),i=!1},d(s){s&&Q(e),a&&a.d(s),n=!1,_i(r)}}}function g3(t,e,i){let{$$slots:n={},$$scope:r}=e;const o=Sa();let{class:a=null}=e;const s=sn("measurable");let l=!1;return ws(()=>i(1,l=!0)),t.$$set=c=>{"class"in c&&i(0,a=c.class),"$$scope"in c&&i(4,r=c.$$scope)},[a,l,s,({detail:c})=>o("measure",c),r,n]}class f3 extends li{constructor(e){super(),si(this,e,g3,$3,ei,{class:0})}}const y3=t=>({}),Wg=t=>({}),x3=t=>({}),_g=t=>({}),b3=t=>({}),Vg=t=>({});function Ng(t){let e,i;const n=t[4].header,r=sr(n,t,t[3],Vg);return{c(){e=pt("div"),r&&r.c(),w(e,"class","PinturaUtilHeader")},m(o,a){tt(o,e,a),r&&r.m(e,null),i=!0},p(o,a){r&&r.p&&(!i||8&a)&&cr(r,n,o,o[3],i?lr(n,o[3],a,b3):dr(o[3]),Vg)},i(o){i||(M(r,o),i=!0)},o(o){D(r,o),i=!1},d(o){o&&Q(e),r&&r.d(o)}}}function Hg(t){let e,i;const n=t[4].footer,r=sr(n,t,t[3],Wg);return{c(){e=pt("div"),r&&r.c(),w(e,"class","PinturaUtilFooter")},m(o,a){tt(o,e,a),r&&r.m(e,null),i=!0},p(o,a){r&&r.p&&(!i||8&a)&&cr(r,n,o,o[3],i?lr(n,o[3],a,y3):dr(o[3]),Wg)},i(o){i||(M(r,o),i=!0)},o(o){D(r,o),i=!1},d(o){o&&Q(e),r&&r.d(o)}}}function v3(t){let e,i,n,r,o,a,s=t[1]&&Ng(t);const l=t[4].main,c=sr(l,t,t[3],_g),d=c||function(p){let h,g;return h=new f3({props:{class:"PinturaStage"}}),h.$on("measure",p[5]),{c(){At(h.$$.fragment)},m(m,f){It(h,m,f),g=!0},p:Qe,i(m){g||(M(h.$$.fragment,m),g=!0)},o(m){D(h.$$.fragment,m),g=!1},d(m){Et(h,m)}}}(t);let u=t[2]&&Hg(t);return{c(){s&&s.c(),e=de(),i=pt("div"),d&&d.c(),n=de(),u&&u.c(),r=de(),o=Tn(),w(i,"class","PinturaUtilMain")},m(p,h){s&&s.m(p,h),tt(p,e,h),tt(p,i,h),d&&d.m(i,null),t[6](i),tt(p,n,h),u&&u.m(p,h),tt(p,r,h),tt(p,o,h),a=!0},p(p,[h]){p[1]?s?(s.p(p,h),2&h&&M(s,1)):(s=Ng(p),s.c(),M(s,1),s.m(e.parentNode,e)):s&&(Fe(),D(s,1,1,()=>{s=null}),De()),c&&c.p&&(!a||8&h)&&cr(c,l,p,p[3],a?lr(l,p[3],h,x3):dr(p[3]),_g),p[2]?u?(u.p(p,h),4&h&&M(u,1)):(u=Hg(p),u.c(),M(u,1),u.m(r.parentNode,r)):u&&(Fe(),D(u,1,1,()=>{u=null}),De())},i(p){a||(M(s),M(d,p),M(u),M(!1),a=!0)},o(p){D(s),D(d,p),D(u),D(!1),a=!1},d(p){s&&s.d(p),p&&Q(e),p&&Q(i),d&&d.d(p),t[6](null),p&&Q(n),u&&u.d(p),p&&Q(r),p&&Q(o)}}}function w3(t,e,i){let{$$slots:n={},$$scope:r}=e,{hasHeader:o=!!e.$$slots.header}=e,{hasFooter:a=!!e.$$slots.footer}=e,{root:s}=e;return t.$$set=l=>{i(7,e=Cn(Cn({},e),Pc(l))),"hasHeader"in l&&i(1,o=l.hasHeader),"hasFooter"in l&&i(2,a=l.hasFooter),"root"in l&&i(0,s=l.root),"$$scope"in l&&i(3,r=l.$$scope)},e=Pc(e),[s,o,a,r,n,function(l){jr.call(this,t,l)},function(l){zi[l?"unshift":"push"](()=>{s=l,i(0,s)})}]}class ol extends li{constructor(e){super(),si(this,e,w3,v3,ei,{hasHeader:1,hasFooter:2,root:0})}}function jg(t){let e,i;return{c(){e=pt("div"),w(e,"class","PinturaRangeInputMeter"),w(e,"style",i=`transform: translateX(${t[9].x-t[12].x}px) translateY(${t[9].y-t[12].y}px)`)},m(n,r){tt(n,e,r),e.innerHTML=t[7]},p(n,r){128&r[0]&&(e.innerHTML=n[7]),512&r[0]&&i!==(i=`transform: translateX(${n[9].x-n[12].x}px) translateY(${n[9].y-n[12].y}px)`)&&w(e,"style",i)},d(n){n&&Q(e)}}}function S3(t){let e,i,n,r,o,a,s,l,c,d,u,p=t[9]&&jg(t);return{c(){e=pt("div"),i=pt("span"),n=de(),r=pt("button"),o=cn(t[1]),s=de(),l=pt("div"),p&&p.c(),w(i,"class","PinturaRangeInputValue"),w(r,"class","PinturaRangeInputReset"),w(r,"type","button"),r.disabled=a=t[0]===t[2],w(l,"class","PinturaRangeInputInner"),w(l,"style",t[8]),w(l,"data-value-limited",t[5]),w(e,"class","PinturaRangeInput"),w(e,"tabindex","0")},m(h,g){tt(h,e,g),Tt(e,i),i.innerHTML=t[3],Tt(e,n),Tt(e,r),Tt(r,o),Tt(e,s),Tt(e,l),p&&p.m(l,null),d||(u=[Mt(r,"click",t[17]),Mt(l,"interactionstart",t[13]),Mt(l,"interactionupdate",t[15]),Mt(l,"interactionend",t[16]),Mt(l,"interactionrelease",t[14]),Ui(c=Cs.call(null,l,{inertia:t[6]})),Mt(l,"measure",t[37]),Ui(Mr.call(null,l)),Mt(e,"wheel",t[19],{passive:!1}),Mt(e,"nudge",t[20]),Ui(Ts.call(null,e,{direction:"horizontal",preventDefault:!0}))],d=!0)},p(h,g){8&g[0]&&(i.innerHTML=h[3]),2&g[0]&&An(o,h[1]),5&g[0]&&a!==(a=h[0]===h[2])&&(r.disabled=a),h[9]?p?p.p(h,g):(p=jg(h),p.c(),p.m(l,null)):p&&(p.d(1),p=null),256&g[0]&&w(l,"style",h[8]),32&g[0]&&w(l,"data-value-limited",h[5]),c&&ji(c.update)&&64&g[0]&&c.update.call(null,{inertia:h[6]})},i:Qe,o:Qe,d(h){h&&Q(e),p&&p.d(),d=!1,_i(u)}}}function k3(t,e,i){let n,r,o,a,s,l,c,d,u,p,{labelReset:h="Reset"}=e,{direction:g="x"}=e,{min:m=0}=e,{max:f=1}=e,{base:x=m}=e,{value:k=0}=e,{valueLabel:v=0}=e,{valueMin:C}=e,{valueMax:P}=e,{oninputstart:I=$e}=e,{oninputmove:O=$e}=e,{oninputend:T=$e}=e,{elasticity:L=0}=e,{nudgeMultiplier:F}=e,{step:B=8}=e;const y=sn("isAnimated");A(t,y,nt=>i(6,d=nt));const V=sn("fixScrollDirection");A(t,V,nt=>i(43,u=nt));const J=(nt,mt,Ft)=>Math.ceil((nt-Ft)/mt)*mt+Ft;let S,H,K;const ut={x:2,y:0},lt=(nt,mt,Ft)=>`M ${nt-Ft} ${mt} a ${Ft} ${Ft} 0 1 0 0 -1`;let N,ft,$t=!1,Lt={snap:!1,elastic:!1};const ct=(nt,mt,Ft)=>{const oe=nt[g]+mt[g],Rt=Yi(oe,N[1][g],N[0][g]),Ut=L?Rt+us(oe-Rt,L):Rt,Ot=Ft.elastic?Ut:Rt,j=rt(0,0);return j[g]=Ot,et.set(j,{hard:Ft.snap}),Yi(Y(j,g),m,f)},et=ai();A(t,et,nt=>i(9,p=nt));const ht=(nt,mt)=>{const Ft=.5*(S[mt]-a[mt])-(xc(nt,m,f)*a[mt]-.5*a[mt]);return{x:mt==="x"?Ft:0,y:mt==="y"?Ft:0}},Y=(nt,mt)=>{const Ft=-(nt[mt]-.5*S[mt])/a[mt];return m+Ft*n},Z=et.subscribe(nt=>{nt&&ft&&O(Yi(Y(nt,g),m,f))}),St=nt=>{const mt=[ht(C??m,g),ht(P??f,g)],Ft={x:g==="x"?p.x+nt:0,y:g==="y"?p.y+nt:0},oe=Yi(Ft[g],mt[1][g],mt[0][g]),Rt={...p,[g]:oe};Ct(et,p=Rt,p);const Ut=Yi(Y(Rt,g),m,f);I(),O(Ut),T(Ut)};return No(()=>{Z()}),t.$$set=nt=>{"labelReset"in nt&&i(1,h=nt.labelReset),"direction"in nt&&i(21,g=nt.direction),"min"in nt&&i(22,m=nt.min),"max"in nt&&i(23,f=nt.max),"base"in nt&&i(2,x=nt.base),"value"in nt&&i(0,k=nt.value),"valueLabel"in nt&&i(3,v=nt.valueLabel),"valueMin"in nt&&i(24,C=nt.valueMin),"valueMax"in nt&&i(25,P=nt.valueMax),"oninputstart"in nt&&i(26,I=nt.oninputstart),"oninputmove"in nt&&i(27,O=nt.oninputmove),"oninputend"in nt&&i(28,T=nt.oninputend),"elasticity"in nt&&i(29,L=nt.elasticity),"nudgeMultiplier"in nt&&i(30,F=nt.nudgeMultiplier),"step"in nt&&i(31,B=nt.step)},t.$$.update=()=>{if(12582912&t.$$.dirty[0]&&i(33,n=f-m),20971520&t.$$.dirty[0]&&i(35,r=C!=null?Math.max(C,m):m),41943040&t.$$.dirty[0]&&i(34,o=P!=null?Math.min(P,f):f),12582916&t.$$.dirty[0]&&i(36,s=xc(x,m,f)),16&t.$$.dirty[0]|32&t.$$.dirty[1]&&S){const nt=.5*S.y;let mt,Ft=40*s,oe="",Rt=S.y,Ut="";for(let Ot=0;Ot<=40;Ot++){const j=ut.x+10*Ot,wt=nt;oe+=lt(j,wt,Ot%5==0?2:.75)+" ",mt=j+ut.x,Ot===Ft&&(Ut=`<path d="M${j} ${wt-4} l2 3 l-2 -1 l-2 1 z"/>`)}i(7,H=`<svg width="${mt}" height="${Rt}" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 ${mt} ${Rt}" aria-hidden="true" focusable="false">
        ${Ut}
        <rect rx="4" ry="4" y="${nt-4}"" height="8"/>
        <path fill-rule="evenodd" d="${oe.trim()}"/></svg>`),i(32,K={x:mt-2*ut.x,y:Rt})}16&t.$$.dirty[0]|2&t.$$.dirty[1]&&(a=S&&K),12582912&t.$$.dirty[0]|24&t.$$.dirty[1]&&i(5,l=r!==m||o!==f),32&t.$$.dirty[0]|24&t.$$.dirty[1]&&i(8,c=l?function(nt,mt){const oe=xc(nt,m,f),Rt=xc(mt,m,f);return`--range-mask-from:${100*ni(J(oe,.025,0)-.0125)}%;--range-mask-to:${100*ni(J(Rt,.025,0)-.0125)}%`}(r,o):""),2097233&t.$$.dirty[0]|4&t.$$.dirty[1]&&n&&S&&S.x&&S.y&&et.set(ht(k,g),{hard:d===!1})},[k,h,x,v,S,l,d,H,c,p,y,V,ut,()=>{$t=!1,ft=xa(et),N=[ht(C??m,g),ht(P??f,g)],I()},()=>{$t=!0},({detail:nt})=>{Lt.snap=!$t,Lt.elastic=!$t,ct(ft,nt.translation,Lt)},({detail:nt})=>{Lt.snap=!1,Lt.elastic=!1;const mt=ct(ft,nt.translation,Lt);if(ft=void 0,N=void 0,Math.abs(mt-x)<.01)return T(x);T(mt)},()=>{i(0,k=Yi(x,r,o)),I(),T(k)},et,nt=>{nt.preventDefault(),nt.stopPropagation();const mt=ku(nt,{fixScrollDirection:u})*B;St(mt)},({detail:nt})=>{St(nt[g]*Math.abs(F||8))},g,m,f,C,P,I,O,T,L,F,B,K,n,o,r,s,nt=>i(4,S=(mt=>rt(mt.width,mt.height))(nt.detail))]}class Hh extends li{constructor(e){super(),si(this,e,k3,S3,ei,{labelReset:1,direction:21,min:22,max:23,base:2,value:0,valueLabel:3,valueMin:24,valueMax:25,oninputstart:26,oninputmove:27,oninputend:28,elasticity:29,nudgeMultiplier:30,step:31},null,[-1,-1])}}var C3={[fs]:t=>({x:t.x,y:t.y}),[aa]:t=>({x:t.x+t.width,y:t.y}),[ys]:t=>({x:t.x+t.width,y:t.y}),[sa]:t=>({x:t.x+t.width,y:t.y+t.height}),[xs]:t=>({x:t.x,y:t.y+t.height}),[la]:t=>({x:t.x,y:t.y+t.height}),[bs]:t=>({x:t.x,y:t.y}),[oa]:t=>({x:t.x,y:t.y})};function Ug(t,e,i){const n=t.slice();return n[14]=e[i].key,n[15]=e[i].translate,n[16]=e[i].scale,n[17]=e[i].type,n[18]=e[i].opacity,n}function Gg(t,e){let i,n,r,o,a,s,l,c;return{key:t,first:null,c(){i=pt("div"),w(i,"role","button"),w(i,"aria-label",n=`Drag ${e[17]} ${e[14]}`),w(i,"tabindex",r=e[17]==="edge"?-1:0),w(i,"class","PinturaRectManipulator"),w(i,"data-direction",o=e[14]),w(i,"data-shape",a=e[17]==="edge"?"edge":""+e[0]),w(i,"style",s=`--tx:${e[15].x};--ty:${e[15].y};--sx:${e[16].x};--sy:${e[16].y};opacity:${e[18]}`),this.first=i},m(d,u){tt(d,i,u),l||(c=[Mt(i,"nudge",function(){ji(e[6](e[14]))&&e[6](e[14]).apply(this,arguments)}),Ui(Ts.call(null,i,{preventDefault:!0})),Mt(i,"interactionstart",function(){ji(e[5]("resizestart",e[14]))&&e[5]("resizestart",e[14]).apply(this,arguments)}),Mt(i,"interactionupdate",function(){ji(e[5]("resizemove",e[14]))&&e[5]("resizemove",e[14]).apply(this,arguments)}),Mt(i,"interactionend",function(){ji(e[5]("resizeend",e[14]))&&e[5]("resizeend",e[14]).apply(this,arguments)}),Ui(Cs.call(null,i))],l=!0)},p(d,u){e=d,2&u&&n!==(n=`Drag ${e[17]} ${e[14]}`)&&w(i,"aria-label",n),2&u&&r!==(r=e[17]==="edge"?-1:0)&&w(i,"tabindex",r),2&u&&o!==(o=e[14])&&w(i,"data-direction",o),3&u&&a!==(a=e[17]==="edge"?"edge":""+e[0])&&w(i,"data-shape",a),2&u&&s!==(s=`--tx:${e[15].x};--ty:${e[15].y};--sx:${e[16].x};--sy:${e[16].y};opacity:${e[18]}`)&&w(i,"style",s)},d(d){d&&Q(i),l=!1,_i(c)}}}function T3(t){let e,i=[],n=new Map,r=t[1];const o=a=>a[14];for(let a=0;a<r.length;a+=1){let s=Ug(t,r,a),l=o(s);n.set(l,i[a]=Gg(l,s))}return{c(){for(let a=0;a<i.length;a+=1)i[a].c();e=Tn()},m(a,s){for(let l=0;l<i.length;l+=1)i[l].m(a,s);tt(a,e,s)},p(a,[s]){99&s&&(r=a[1],i=Aa(i,s,o,1,a,r,n,e.parentNode,Wy,Gg,e,Ug))},i:Qe,o:Qe,d(a){for(let s=0;s<i.length;s+=1)i[s].d(a);a&&Q(e)}}}function M3(t,e,i){let n,r,o,a,{rect:s=null}=e,{visible:l=!1}=e,{style:c}=e;const d=sn("isAnimated");A(t,d,m=>i(11,a=m));const u=ai(void 0,{precision:1e-4,stiffness:.2,damping:.4});A(t,u,m=>i(10,o=m));const p=ai(0,{precision:.001});let h;A(t,p,m=>i(9,r=m));const g=Sa();return t.$$set=m=>{"rect"in m&&i(7,s=m.rect),"visible"in m&&i(8,l=m.visible),"style"in m&&i(0,c=m.style)},t.$$.update=()=>{2304&t.$$.dirty&&u.set(l?1:.5,{hard:a===!1}),2304&t.$$.dirty&&p.set(l?1:0,{hard:a===!1}),1664&t.$$.dirty&&i(1,n=Object.keys(Ap).map((m,f)=>{const x=Ap[m],k=C3[x](s),v=x.length===1?"edge":"corner",C=v==="corner";return{key:x,type:v,scale:{x:/^(t|b)$/.test(x)?s.width:C?Yi(o,.5,1.25):1,y:/^(r|l)$/.test(x)?s.height:C?Yi(o,.5,1.25):1},translate:{x:k.x,y:k.y},opacity:r}}))},[c,n,d,u,p,(m,f)=>({detail:x})=>{h&&f!==h||m!=="resizestart"&&h===void 0||(m==="resizestart"&&(h=f),m==="resizeend"&&(h=void 0),g(m,{direction:f,translation:x&&x.translation}))},m=>({detail:f})=>{g("resizestart",{direction:m,translation:{x:0,y:0}}),g("resizemove",{direction:m,translation:f}),g("resizeend",{direction:m,translation:{x:0,y:0}})},s,l,r,o,a]}class P3 extends li{constructor(e){super(),si(this,e,M3,T3,ei,{rect:7,visible:8,style:0})}}var R3=t=>{function e(a,s){t.dispatchEvent(new CustomEvent(a,{detail:s}))}const i=a=>{a.preventDefault(),t.addEventListener("gesturechange",n),t.addEventListener("gestureend",r),e("gesturedown")},n=a=>{a.preventDefault(),e("gestureupdate",a.scale)},r=a=>{e("gestureup",a.scale),a.preventDefault(),o()},o=()=>{t.removeEventListener("gesturechange",n),t.removeEventListener("gestureend",r)};return t.addEventListener("gesturestart",i),{destroy:()=>{o(),t.removeEventListener("gesturestart",i)}}},jh={[fs]:xs,[ys]:bs,[xs]:fs,[bs]:ys,[oa]:sa,[aa]:la,[sa]:oa,[la]:aa},Uh=t=>{const e=t===bs||t===ys,i=t===fs||t===xs;return[t===ys||t===aa||t===sa,t===bs||t===la||t===oa,t===fs||t===aa||t===oa,t===xs||t===sa||t===la,e,i,e||i]},Zg=(t,e,i,n={})=>{const{target:r,translate:o}=e,{aspectRatio:a,minSize:s,maxSize:l}=n,c=Cc[jh[r]],d=Fn(rt(t.x,t.y),rt(c[0]*t.width,c[1]*t.height)),u=Cc[r],p=Fn(Ci(t),rt(u[0]*t.width,u[1]*t.height)),[h,g,m,f,x,k,v]=Uh(r);let C=o.x,P=o.y;x?P=0:k&&(C=0);const{inner:I,outer:O}=I3(d,r,i,{aspectRatio:a,minSize:s,maxSize:l});let[T,L,F,B]=il(t);if(h?B=d.x:g&&(L=d.x),f?T=d.y:m&&(F=d.y),h){const y=I.x+I.width,V=O.x+O.width;L=Yi(p.x+C,y,V)}else if(g){const y=O.x,V=I.x;B=Yi(p.x+C,y,V)}if(f){const y=I.y+I.height,V=O.y+O.height;F=Yi(p.y+P,y,V)}else if(m){const y=O.y,V=I.y;T=Yi(p.y+P,y,V)}if(B>I.x&&(B=I.x),L<I.x+I.width&&(L=I.x+I.width),T>I.y&&(T=I.y),F<I.y+I.height&&(F=I.y+I.height),B<O.x){const y=O.x-B;B=O.x,L+=y}if(L>O.x+O.width){const y=L-(O.x+O.width);L=O.x+O.width,B-=y}if(T<O.y){const y=O.y-T;T=O.y,F+=y}if(F>O.y+O.height){const y=F-(O.y+O.height);F=O.y+O.height,T-=y}if(a)if(v){let y=L-B,V=F-T;x?(V=y/a,T=d.y-.5*V,F=d.y+.5*V):k&&(y=V*a,B=d.x-.5*y,L=d.x+.5*y)}else{const y=rt(p.x+C-d.x,p.y+P-d.y);r===aa?(y.x=Math.max(0,y.x),y.y=Math.min(0,y.y)):r===sa?(y.x=Math.max(0,y.x),y.y=Math.max(0,y.y)):r===la?(y.x=Math.min(0,y.x),y.y=Math.max(0,y.y)):r===oa&&(y.x=Math.min(0,y.x),y.y=Math.min(0,y.y));const V=ps(y),J=ps(rt(I.width,I.height)),S=ps(rt(O.width,O.height)),H=Yi(V,J,S),K=rt(a,1),ut=Ar(ro(K),H);r===aa?(L=d.x+ut.x,T=d.y-ut.y):r===sa?(L=d.x+ut.x,F=d.y+ut.y):r===la?(B=d.x-ut.x,F=d.y+ut.y):r===oa&&(B=d.x-ut.x,T=d.y-ut.y)}return In(B,T,L-B,F-T)};const I3=(t,e,i,n)=>{const{aspectRatio:r,minSize:o,maxSize:a}=n,s=e===ys||e===aa||e===sa,l=e===bs||e===la||e===oa,c=e===fs||e===aa||e===oa,d=e===xs||e===sa||e===la,u=e===bs||e===ys,p=e===fs||e===xs,h=Ci(i);s?(h.x=t.x,h.width-=t.x):l&&(h.width=t.x),d?(h.y=t.y,h.height-=t.y):c&&(h.height=t.y);const g=((I,O)=>ca(0,0,I,O))(Math.min(h.width,a.width),Math.min(h.height,a.height));if(r){if(u){const I=Math.min(t.y,i.height-t.y);g.height=Math.min(2*I,g.height)}else if(p){const I=Math.min(t.x,i.width-t.x);g.width=Math.min(2*I,g.width)}}const m=r?el(Ka(Hr(o),r)):o,f=r?el(Jr(g,r)):g;let x,k,v,C;s?x=t.x:l&&(k=t.x),d?v=t.y:c&&(C=t.y),s?k=x+m.width:l&&(x=k-m.width),d?C=v+m.height:c&&(v=C-m.height),u?(v=t.y-.5*m.height,C=t.y+.5*m.height):p&&(x=t.x-.5*m.width,k=t.x+.5*m.width);const P=rr([rt(x,v),rt(k,C)]);return s?k=x+f.width:l&&(x=k-f.width),d?C=v+f.height:c&&(v=C-f.height),u?(v=t.y-.5*f.height,C=t.y+.5*f.height):p&&(x=t.x-.5*f.width,k=t.x+.5*f.width),x=Math.max(i.x,x),k=Math.min(i.x+i.width,k),v=Math.max(i.y,v),C=Math.min(i.y+i.height,C),{inner:P,outer:rr([rt(x,v),rt(k,C)])}};var Xg=t=>180*t/Math.PI;function E3(t){let e,i,n;return i=new Hh({props:{elasticity:t[5],min:t[9],max:t[10],value:t[11],valueMin:Math.max(t[9],t[0]),valueMax:Math.min(t[10],t[1]),labelReset:t[6],base:t[12],valueLabel:Math.round(Xg(t[11]))+"&deg;",oninputstart:t[2],oninputmove:t[17],oninputend:t[18]}}),{c(){e=pt("div"),At(i.$$.fragment),w(e,"class","PinturaImageRotator")},m(r,o){tt(r,e,o),It(i,e,null),n=!0},p(r,[o]){const a={};32&o&&(a.elasticity=r[5]),512&o&&(a.min=r[9]),1024&o&&(a.max=r[10]),2048&o&&(a.value=r[11]),513&o&&(a.valueMin=Math.max(r[9],r[0])),1026&o&&(a.valueMax=Math.min(r[10],r[1])),64&o&&(a.labelReset=r[6]),4096&o&&(a.base=r[12]),2048&o&&(a.valueLabel=Math.round(Xg(r[11]))+"&deg;"),4&o&&(a.oninputstart=r[2]),392&o&&(a.oninputmove=r[17]),400&o&&(a.oninputend=r[18]),i.$set(a)},i(r){n||(M(i.$$.fragment,r),n=!0)},o(r){D(i.$$.fragment,r),n=!1},d(r){r&&Q(e),Et(i)}}}function A3(t,e,i){let n,r,o,a,s,l,c,{rotation:d}=e,{valueMin:u}=e,{valueMax:p}=e,{oninputstart:h=$e}=e,{oninputmove:g=$e}=e,{oninputend:m=$e}=e,{elasticity:f=0}=e,{labelReset:x}=e,{rotationMin:k}=e,{rotationMax:v}=e;return t.$$set=C=>{"rotation"in C&&i(13,d=C.rotation),"valueMin"in C&&i(0,u=C.valueMin),"valueMax"in C&&i(1,p=C.valueMax),"oninputstart"in C&&i(2,h=C.oninputstart),"oninputmove"in C&&i(3,g=C.oninputmove),"oninputend"in C&&i(4,m=C.oninputend),"elasticity"in C&&i(5,f=C.elasticity),"labelReset"in C&&i(6,x=C.labelReset),"rotationMin"in C&&i(14,k=C.rotationMin),"rotationMax"in C&&i(15,v=C.rotationMax)},t.$$.update=()=>{16384&t.$$.dirty&&i(9,n=k+1e-9),32768&t.$$.dirty&&i(10,r=v-1e-9),1536&t.$$.dirty&&i(12,o=n+.5*(r-n)),32768&t.$$.dirty&&i(16,a=2*v),8192&t.$$.dirty&&i(8,s=Math.sign(d)),73728&t.$$.dirty&&i(7,l=Math.round(Math.abs(d)/a)*a),8576&t.$$.dirty&&i(11,c=d-s*l)},[u,p,h,g,m,f,x,l,s,n,r,c,o,d,k,v,a,C=>g(s*l+C),C=>m(s*l+C)]}class L3 extends li{constructor(e){super(),si(this,e,A3,E3,ei,{rotation:13,valueMin:0,valueMax:1,oninputstart:2,oninputmove:3,oninputend:4,elasticity:5,labelReset:6,rotationMin:14,rotationMax:15})}}function z3(t){let e,i,n,r,o;return{c(){e=pt("div"),i=pt("p"),n=cn(t[0]),r=cn(" × "),o=cn(t[1]),w(e,"class","PinturaImageInfo")},m(a,s){tt(a,e,s),Tt(e,i),Tt(i,n),Tt(i,r),Tt(i,o)},p(a,[s]){1&s&&An(n,a[0]),2&s&&An(o,a[1])},i:Qe,o:Qe,d(a){a&&Q(e)}}}function F3(t,e,i){let{width:n}=e,{height:r}=e;return t.$$set=o=>{"width"in o&&i(0,n=o.width),"height"in o&&i(1,r=o.height)},[n,r]}class D3 extends li{constructor(e){super(),si(this,e,F3,z3,ei,{width:0,height:1})}}function B3(t){let e,i;return e=new Qa({props:{class:"PinturaPresetListFilter",layout:"row",options:t[8],selectedIndex:t[7],onchange:t[10]}}),{c(){At(e.$$.fragment)},m(n,r){It(e,n,r),i=!0},p(n,r){const o={};256&r&&(o.options=n[8]),128&r&&(o.selectedIndex=n[7]),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){D(e.$$.fragment,n),i=!1},d(n){Et(e,n)}}}function O3(t){let e,i;return e=new x2({props:{icon:t[0],label:t[1],labelClass:t[2],hideLabel:t[3],options:t[9],selectedIndex:t[4],onchange:t[5],optionMapper:t[6],$$slots:{controls:[B3]},$$scope:{ctx:t}}}),{c(){At(e.$$.fragment)},m(n,r){It(e,n,r),i=!0},p(n,[r]){const o={};1&r&&(o.icon=n[0]),2&r&&(o.label=n[1]),4&r&&(o.labelClass=n[2]),8&r&&(o.hideLabel=n[3]),512&r&&(o.options=n[9]),16&r&&(o.selectedIndex=n[4]),32&r&&(o.onchange=n[5]),64&r&&(o.optionMapper=n[6]),262528&r&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){D(e.$$.fragment,n),i=!1},d(n){Et(e,n)}}}const Yg='fill="none" stroke="currentColor"';function W3(t,e,i){let n,r,o,{icon:a}=e,{label:s}=e,{labelClass:l}=e,{hideLabel:c}=e,{options:d}=e,{selectedIndex:u}=e,{onchange:p}=e,{optionMapper:h}=e,{filter:g="landscape"}=e,{onfilterchange:m=$e}=e;const f=(k,v,C,P,I)=>`
    <rect ${Yg} x="${k}" y="${v}" width="${C}" height="${P}" rx="${I}"/>`,x=(k,v)=>`<path ${Yg} d="M${k} ${v} l2 2 l3 -4"/>`;return t.$$set=k=>{"icon"in k&&i(0,a=k.icon),"label"in k&&i(1,s=k.label),"labelClass"in k&&i(2,l=k.labelClass),"hideLabel"in k&&i(3,c=k.hideLabel),"options"in k&&i(12,d=k.options),"selectedIndex"in k&&i(4,u=k.selectedIndex),"onchange"in k&&i(5,p=k.onchange),"optionMapper"in k&&i(6,h=k.optionMapper),"filter"in k&&i(11,g=k.filter),"onfilterchange"in k&&i(13,m=k.onfilterchange)},t.$$.update=()=>{6144&t.$$.dirty&&i(9,n=((k,v)=>(k||[]).map(C=>Oe(C[0])?(C[1]=C[1].map(v),C):v(C)))(d,(k=>v=>{const[C,P,I={}]=v;return xi(C)&&(I.hidden=k==="landscape"?C<1:C>1),[C,P,I]})(g))),2048&t.$$.dirty&&i(7,r=g==="landscape"?0:1),128&t.$$.dirty&&i(8,o=[["landscape","Landscape",{hideLabel:!0,icon:f(2,6,19,12,2)+(r===0?x(9,12):"")}],["portrait","Portrait",{hideLabel:!0,icon:f(5,3,13,18,2)+(r===1?x(9,12):"")}]])},[a,s,l,c,u,p,h,r,o,n,k=>{i(11,g=k.value),m(k.value)},g,d,m]}class _3 extends li{constructor(e){super(),si(this,e,W3,O3,ei,{icon:0,label:1,labelClass:2,hideLabel:3,options:12,selectedIndex:4,onchange:5,optionMapper:6,filter:11,onfilterchange:13})}}const qg=t=>Co(t,e=>ni(e,6)),Kg=t=>Wo(t,e=>ni(e,6)),as=(t,e,i=1e-4)=>Math.abs(t-e)<i;var V3=(t,e,i,n,r={})=>{const{aspectRatio:o}=r;t=Kg(t),n=n.map(qg);const a=dm(t,jh[i.target]),s=Co(a,x=>ni(x,6)),l=o?Ka(r.minSize,o):r.minSize,c=o?Jr(r.maxSize,o):r.maxSize,d=dm(e,i.target);if(ho(d,a)<1){e=Ci(t);const x=Math.min(l.width/t.width,l.height/t.height);Er(e,x,a)}e=cm(Ci(e),l,c,a);let u=Ci(e);e=Kg(e);const p=ty(n,1),h=_o(t),g=_o(e),m=h.findIndex(x=>ds(Co(x,k=>ni(k,6)),s)),f=x=>p.map(k=>dh(k,x)).filter(Boolean).pop();if(o){const x=g.map((k,v)=>{if(v===m)return;const C=rt(a.x-k.x,a.y-k.y);ro(C),Ar(C,.5);const P=rt(a.x-C.x,a.y-C.y),I=vs(P,qg(k)),O=f(I);if(!O)return;const T=h[v];return{intersection:O,cornerDist:ho(a,T),intersectionDist:ho(a,O)}}).filter(Boolean);if(x.length){const k=x.reduce((v,C)=>{const P=C.intersectionDist/C.cornerDist;return P<v?P:v},Number.MAX_SAFE_INTEGER);u=Ci(t),Er(u,k,a)}}else{const x=i.target.length===1,k=!(n[0].y===n[1].y||n[0].x===n[1].x),v=h.map((C,P)=>{if(P===m)return;const I=g[P],O=!as(I.x,s.x)&&!as(I.y,s.y);if(!x&&!k&&O||x&&(as(I.x,s.x)||as(I.y,s.y)))return;const T=_e(x?C:a),L=Dn(_e(T),I);ro(L),Ar(L,.5),x?Fn(T,L):Dn(T,L);const F=vs(T,I);return f(F)||void 0}).filter(Boolean);if(v.length){const[C,P,I,O]=Uh(i.target);let[T,L,F,B]=il(e);v.forEach(({x:y,y:V})=>{const J=ni(y,6),S=ni(V,6);I&&!as(S,s.y)&&(T=Math.max(T,V)),C&&!as(J,s.x)&&(L=Math.min(L,y)),O&&!as(S,s.y)&&(F=Math.min(F,V)),P&&!as(J,s.x)&&(B=Math.max(B,y))}),u=Gx([T,L,F,B]),Er(u,.9999,a)}}return cm(u,l,c,a),u};function N3(t){let e,i;return e=new $o({props:{items:t[11]}}),{c(){At(e.$$.fragment)},m(n,r){It(e,n,r),i=!0},p(n,r){const o={};2048&r[0]&&(o.items=n[11]),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){D(e.$$.fragment,n),i=!1},d(n){Et(e,n)}}}function H3(t){let e,i,n;return i=new D2({props:{$$slots:{default:[N3]},$$scope:{ctx:t}}}),{c(){e=pt("div"),At(i.$$.fragment),w(e,"slot","header")},m(r,o){tt(r,e,o),It(i,e,null),n=!0},p(r,o){const a={};2048&o[0]|4&o[7]&&(a.$$scope={dirty:o,ctx:r}),i.$set(a)},i(r){n||(M(i.$$.fragment,r),n=!0)},o(r){D(i.$$.fragment,r),n=!1},d(r){r&&Q(e),Et(i)}}}function Jg(t){let e,i;return e=new ks({props:{onclick:t[88],label:t[4].cropLabelButtonRecenter,icon:t[4].cropIconButtonRecenter,class:"PinturaButtonCenter",disabled:!t[9],hideLabel:!0,style:`opacity: ${t[29]}; transform: translate3d(${t[30].x}px, ${t[30].y}px, 0)`}}),{c(){At(e.$$.fragment)},m(n,r){It(e,n,r),i=!0},p(n,r){const o={};16&r[0]&&(o.label=n[4].cropLabelButtonRecenter),16&r[0]&&(o.icon=n[4].cropIconButtonRecenter),512&r[0]&&(o.disabled=!n[9]),1610612736&r[0]&&(o.style=`opacity: ${n[29]}; transform: translate3d(${n[30].x}px, ${n[30].y}px, 0)`),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){D(e.$$.fragment,n),i=!1},d(n){Et(e,n)}}}function Qg(t){let e,i;return e=new P3({props:{rect:t[8],visible:t[12],style:t[1]}}),e.$on("resizestart",t[68]),e.$on("resizemove",t[69]),e.$on("resizeend",t[70]),{c(){At(e.$$.fragment)},m(n,r){It(e,n,r),i=!0},p(n,r){const o={};256&r[0]&&(o.rect=n[8]),4096&r[0]&&(o.visible=n[12]),2&r[0]&&(o.style=n[1]),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){D(e.$$.fragment,n),i=!1},d(n){Et(e,n)}}}function tf(t){let e,i;return e=new D3({props:{width:Math.round(t[13].width),height:Math.round(t[13].height)}}),{c(){At(e.$$.fragment)},m(n,r){It(e,n,r),i=!0},p(n,r){const o={};8192&r[0]&&(o.width=Math.round(n[13].width)),8192&r[0]&&(o.height=Math.round(n[13].height)),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){D(e.$$.fragment,n),i=!1},d(n){Et(e,n)}}}function j3(t){let e,i,n,r,o,a,s,l,c=t[21]&&t[10]&&Jg(t),d=t[21]&&Qg(t),u=t[22]&&tf(t);return{c(){e=pt("div"),i=pt("div"),c&&c.c(),n=de(),d&&d.c(),o=de(),u&&u.c(),w(i,"class","PinturaStage"),w(e,"slot","main")},m(p,h){tt(p,e,h),Tt(e,i),c&&c.m(i,null),Tt(i,n),d&&d.m(i,null),t[162](i),Tt(e,o),u&&u.m(e,null),a=!0,s||(l=[Ui(Mr.call(null,i)),Mt(i,"measure",t[160]),Mt(i,"wheel",function(){ji(t[2]&&t[87])&&(t[2]&&t[87]).apply(this,arguments)},{passive:!1}),Mt(i,"interactionstart",t[74]),Mt(i,"interactionupdate",t[75]),Mt(i,"interactionrelease",t[77]),Mt(i,"interactionend",t[76]),Ui(r=Cs.call(null,i,{drag:!0,inertia:!0,pinch:t[2],shouldStartInteraction:nf,getEventPosition:t[163]})),Mt(i,"gesturedown",t[84]),Mt(i,"gestureupdate",t[85]),Mt(i,"gestureup",t[86]),Ui(R3.call(null,i))],s=!0)},p(p,h){(t=p)[21]&&t[10]?c?(c.p(t,h),2098176&h[0]&&M(c,1)):(c=Jg(t),c.c(),M(c,1),c.m(i,n)):c&&(Fe(),D(c,1,1,()=>{c=null}),De()),t[21]?d?(d.p(t,h),2097152&h[0]&&M(d,1)):(d=Qg(t),d.c(),M(d,1),d.m(i,null)):d&&(Fe(),D(d,1,1,()=>{d=null}),De()),r&&ji(r.update)&&16777220&h[0]&&r.update.call(null,{drag:!0,inertia:!0,pinch:t[2],shouldStartInteraction:nf,getEventPosition:t[163]}),t[22]?u?(u.p(t,h),4194304&h[0]&&M(u,1)):(u=tf(t),u.c(),M(u,1),u.m(e,null)):u&&(Fe(),D(u,1,1,()=>{u=null}),De())},i(p){a||(M(c),M(d),M(u),a=!0)},o(p){D(c),D(d),D(u),a=!1},d(p){p&&Q(e),c&&c.d(),d&&d.d(),t[162](null),u&&u.d(),s=!1,_i(l)}}}function ef(t){let e,i,n,r;const o=[{class:"PinturaControlList"},{tabs:t[7]},t[18]];let a={$$slots:{default:[U3,({tab:c})=>({218:c}),({tab:c})=>[0,0,0,0,0,0,0,c?2:0]]},$$scope:{ctx:t}};for(let c=0;c<o.length;c+=1)a=Cn(a,o[c]);e=new wu({props:a}),e.$on("select",t[161]);const s=[{class:"PinturaControlPanels"},{panelClass:"PinturaControlPanel"},{panels:t[17]},t[18]];let l={$$slots:{default:[X3,({panel:c})=>({217:c}),({panel:c})=>[0,0,0,0,0,0,0,c?1:0]]},$$scope:{ctx:t}};for(let c=0;c<s.length;c+=1)l=Cn(l,s[c]);return n=new Su({props:l}),{c(){At(e.$$.fragment),i=de(),At(n.$$.fragment)},m(c,d){It(e,c,d),tt(c,i,d),It(n,c,d),r=!0},p(c,d){const u=262272&d[0]?Tr(o,[o[0],128&d[0]&&{tabs:c[7]},262144&d[0]&&zr(c[18])]):{};6&d[7]&&(u.$$scope={dirty:d,ctx:c}),e.$set(u);const p=393216&d[0]?Tr(s,[s[0],s[1],131072&d[0]&&{panels:c[17]},262144&d[0]&&zr(c[18])]):{};511721496&d[0]|5&d[7]&&(p.$$scope={dirty:d,ctx:c}),n.$set(p)},i(c){r||(M(e.$$.fragment,c),M(n.$$.fragment,c),r=!0)},o(c){D(e.$$.fragment,c),D(n.$$.fragment,c),r=!1},d(c){Et(e,c),c&&Q(i),Et(n,c)}}}function U3(t){let e,i,n=t[218].label+"";return{c(){e=pt("span"),i=cn(n)},m(r,o){tt(r,e,o),Tt(e,i)},p(r,o){2&o[7]&&n!==(n=r[218].label+"")&&An(i,n)},d(r){r&&Q(e)}}}function G3(t){let e,i;return e=new Hh({props:{elasticity:t[25]*t[44],base:J3,min:t[23],max:K3,valueMin:t[27][0],valueMax:t[27][1],value:t[28],labelReset:t[4].labelReset,valueLabel:Math.round(100*t[28])+"%",oninputstart:t[81],oninputmove:t[82],oninputend:t[83]}}),{c(){At(e.$$.fragment)},m(n,r){It(e,n,r),i=!0},p(n,r){const o={};33554432&r[0]&&(o.elasticity=n[25]*n[44]),8388608&r[0]&&(o.min=n[23]),134217728&r[0]&&(o.valueMin=n[27][0]),134217728&r[0]&&(o.valueMax=n[27][1]),268435456&r[0]&&(o.value=n[28]),16&r[0]&&(o.labelReset=n[4].labelReset),268435456&r[0]&&(o.valueLabel=Math.round(100*n[28])+"%"),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){D(e.$$.fragment,n),i=!1},d(n){Et(e,n)}}}function Z3(t){let e,i;return e=new L3({props:{elasticity:t[25]*t[44],rotation:t[14],labelReset:t[4].labelReset,valueMin:t[26][0],valueMax:t[26][1],rotationMin:-t[3],rotationMax:t[3],oninputstart:t[71],oninputmove:t[72],oninputend:t[73]}}),{c(){At(e.$$.fragment)},m(n,r){It(e,n,r),i=!0},p(n,r){const o={};33554432&r[0]&&(o.elasticity=n[25]*n[44]),16384&r[0]&&(o.rotation=n[14]),16&r[0]&&(o.labelReset=n[4].labelReset),67108864&r[0]&&(o.valueMin=n[26][0]),67108864&r[0]&&(o.valueMax=n[26][1]),8&r[0]&&(o.rotationMin=-n[3]),8&r[0]&&(o.rotationMax=n[3]),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){D(e.$$.fragment,n),i=!1},d(n){Et(e,n)}}}function X3(t){let e,i,n,r;const o=[Z3,G3],a=[];function s(l,c){return l[217]===l[93]+"-rotation"?0:l[217]===l[93]+"-zoom"?1:-1}return~(e=s(t))&&(i=a[e]=o[e](t)),{c(){i&&i.c(),n=Tn()},m(l,c){~e&&a[e].m(l,c),tt(l,n,c),r=!0},p(l,c){let d=e;e=s(l),e===d?~e&&a[e].p(l,c):(i&&(Fe(),D(a[d],1,1,()=>{a[d]=null}),De()),~e?(i=a[e],i?i.p(l,c):(i=a[e]=o[e](l),i.c()),M(i,1),i.m(n.parentNode,n)):i=null)},i(l){r||(M(i),r=!0)},o(l){D(i),r=!1},d(l){~e&&a[e].d(l),l&&Q(n)}}}function Y3(t){let e,i,n=t[19]&&ef(t);return{c(){e=pt("div"),n&&n.c(),w(e,"slot","footer"),w(e,"style",t[16])},m(r,o){tt(r,e,o),n&&n.m(e,null),i=!0},p(r,o){r[19]?n?(n.p(r,o),524288&o[0]&&M(n,1)):(n=ef(r),n.c(),M(n,1),n.m(e,null)):n&&(Fe(),D(n,1,1,()=>{n=null}),De()),(!i||65536&o[0])&&w(e,"style",r[16])},i(r){i||(M(n),i=!0)},o(r){D(n),i=!1},d(r){r&&Q(e),n&&n.d()}}}function q3(t){let e,i,n;function r(a){t[164](a)}let o={hasHeader:t[20],$$slots:{footer:[Y3],main:[j3],header:[H3]},$$scope:{ctx:t}};return t[15]!==void 0&&(o.root=t[15]),e=new ol({props:o}),zi.push(()=>mo(e,"root",r)),e.$on("measure",t[165]),{c(){At(e.$$.fragment)},m(a,s){It(e,a,s),n=!0},p(a,s){const l={};1048576&s[0]&&(l.hasHeader=a[20]),2146402302&s[0]|4&s[7]&&(l.$$scope={dirty:s,ctx:a}),!i&&32768&s[0]&&(i=!0,l.root=a[15],To(()=>i=!1)),e.$set(l)},i(a){n||(M(e.$$.fragment,a),n=!0)},o(a){D(e.$$.fragment,a),n=!1},d(a){Et(e,a)}}}const K3=1,J3=0,nf=(t,e)=>t.target===e;function Q3(t,e,i){let n,r,o,a,s,l,c,d,u,p,h,g,m,f,x,k,v,C,P,I,O,T,L,F,B,y,V,J,S,H,K,ut,lt,N,ft,$t,Lt,ct,et,ht,Y,Z,St,nt,mt,Ft,oe,Rt,Ut,Ot,j,wt,yt,Gt,ue,pe,ve,ge,_,we,gi,xe,_t,Te,Ie,He,vi,vt,bt,Ze,Pe,ri,Ge=Qe,ii=()=>(Ge(),Ge=Nr(wi,E=>i(12,S=E)),wi);t.$$.on_destroy.push(()=>Ge());let{isActive:wi}=e;ii();let{stores:pi}=e,{cropImageSelectionCornerStyle:Fi="circle"}=e,{cropWillRenderImageSelectionGuides:X=(E,Re)=>{const Ve=E=="rotate";return{rows:Ve?5:3,cols:Ve?5:3,opacity:.25*Re}}}=e,{cropAutoCenterImageSelectionTimeout:jt}=e,{cropEnableZoomMatchImageAspectRatio:U=!0}=e,{cropEnableRotateMatchImageAspectRatio:Bt="never"}=e,{cropEnableRotationInput:ye=!0}=e,{cropEnableZoom:Qt=!0}=e,{cropEnableZoomInput:se=!0}=e,{cropEnableZoomAutoHide:zt=!0}=e,{cropEnableImageSelection:We=!0}=e,{cropEnableInfoIndicator:Ae=!1}=e,{cropEnableZoomTowardsWheelPosition:je=!0}=e,{cropEnableLimitWheelInputToCropSelection:Ke=!0}=e,{cropEnableCenterImageSelection:it=!0}=e,{cropEnableButtonRotateLeft:Xt=!0}=e,{cropEnableButtonRotateRight:Nt=!1}=e,{cropEnableButtonFlipHorizontal:Zt=!0}=e,{cropEnableButtonFlipVertical:Yt=!1}=e,{cropSelectPresetOptions:ot}=e,{cropEnableSelectPreset:he=!0}=e,{cropEnableFilterMatchAspectRatio:ie=!0}=e,{cropSelectPresetFilter:fe=!1}=e,{cropEnableButtonToggleCropLimit:Dt=!1}=e,{cropWillRenderTools:ke=Xi}=e,{cropActiveTransformTool:fi="rotation"}=e,{cropMinimizeToolbar:hi="auto"}=e,{cropInteractionFocus:Be="image"}=e,{cropRotationRange:yi=ta}=e,{cropMaskOpacity:Pi=.85}=e,{locale:be={}}=e;const me=sn("isAnimated");A(t,me,E=>i(139,H=E));const Ee=sn("elasticityMultiplier");A(t,Ee,E=>i(25,vi=E));const an=sn("redrawTrigger");A(t,an,E=>i(159,He=E));const Gi=sn("imageIsStatic");A(t,Gi,E=>i(145,Lt=E));const fn=sn("imageStaticVisualCorners");A(t,fn,E=>i(181,ge=E));const hn=sn("fixScrollDirection");A(t,hn,E=>i(175,j=E));let mn="idle";const en=le();A(t,en,E=>i(156,_t=E));const qi=()=>pe===void 0,Ln=E=>1/E,Gn=E=>{ie&&fe!==E&&(i(95,fe=E),pe&&pe!==1&&Nn()&&Ct(un,pe=Ln(pe),pe))},Nn=()=>{if(pe===1||!n)return!1;const E=Ln(pe);return!!$s(_t).find(([Re])=>Re===E)},gr=(E,Re,Ve)=>Ra(Ve)?Re.width===Math.round(E.height)||Re.height===Math.round(E.width):Re.width===Math.round(E.width)||Re.height===Math.round(E.height),Hn=()=>(qi()||Bt==="always"&&Nn())&&((E,Re,Ve)=>{const Mi=Ya(Zf(no(Re),Ve),Je=>Math.abs(Math.round(Je))),Ni=El(Mi),Ii=Ti(E);return ds(Ni,Ii)})(ct,oe,Rt)&&gr(ct,oe,Rt),bn=E=>{if(Bt!=="never"&&Hn()){Ct(Fr,Rt+=E,Rt);const Re=Ra(Rt),Ve=Re?oe.height:oe.width,Mi=Re?oe.width:oe.height;Ct(Zn,ct=In(0,0,Ve,Mi),ct),qi()||Ct(un,pe=Qo(Ve,Mi),pe)}else Ct(Fr,Rt+=E,Rt)},{history:On,env:Wn,isInteracting:Ri,isInteractingFraction:oo,isTransformingImage:zn,rootRect:go,stageRect:ao,utilRect:Pr,utilRectPadded:fr,rootLineColor:Mn,allowPan:Ki,allowZoom:Ur,allowPlayPause:Qr,rangeInputElasticity:fo,presentationScalar:yo,utilTools:Po,imagePreviewModifiers:so,imageOutlineOpacity:lo,imageFlipX:xo,imageFlipY:bo,imageRotation:Fr,imageRotationRange:yr,imageOutputSize:to,imageSelectionRect:dn,imageSelectionRectSnapshot:Qn,imageSelectionRectIntent:vo,imageSelectionRectPresentation:Dr,imageCropRectIntent:ki,imageCropRectOrigin:Pn,imageCropRect:Zn,imageCropMinSize:$n,imageCropMaxSize:eo,imageCropRange:Gr,imageCropAspectRatio:un,imageCropLimitToImage:Zr,imageSize:ur,imageScalar:co,imageOverlayMarkup:pr,stagePadded:jn,stageRecenter:uo}=pi;let xr;A(t,Wn,E=>i(140,K=E)),A(t,Ri,E=>i(144,$t=E)),A(t,zn,E=>i(173,mt=E)),A(t,go,E=>i(24,wt=E)),A(t,ao,E=>i(151,nt=E)),A(t,fr,E=>i(148,Y=E)),A(t,yo,E=>i(147,ht=E)),A(t,Po,E=>i(183,we=E)),A(t,so,E=>i(172,N=E)),A(t,xo,E=>i(158,Ie=E)),A(t,bo,E=>i(157,Te=E)),A(t,Fr,E=>i(14,Rt=E)),A(t,yr,E=>i(26,vt=E)),A(t,to,E=>i(184,gi=E)),A(t,dn,E=>i(150,St=E)),A(t,Qn,E=>i(149,Z=E)),A(t,vo,E=>i(182,_=E)),A(t,Dr,E=>i(143,ft=E)),A(t,ki,E=>i(176,yt=E)),A(t,Pn,E=>i(178,ue=E)),A(t,Zn,E=>i(13,ct=E)),A(t,$n,E=>i(154,Ot=E)),A(t,eo,E=>i(180,ve=E)),A(t,Gr,E=>i(177,Gt=E)),A(t,un,E=>i(179,pe=E)),A(t,Zr,E=>i(153,Ut=E)),A(t,ur,E=>i(152,oe=E)),A(t,co,E=>i(146,et=E)),A(t,jn,E=>i(142,lt=E));const io=(E,Re)=>{const Ve={target:E,translate:Re},Mi=Id(no(Ot),ht),Ni=Id(no(ve),ht);let Ii=Zg(Z,Ve,{...Y,x:0,y:0},{aspectRatio:pe,minSize:Mi,maxSize:Ni});if(Ii=((bi,qe,Di)=>{const[gn,Rn,on,yn]=il(bi),Si={...bi};if(gn<qe.y&&(bi.height=bi.height-(qe.y-gn),bi.y=qe.y),Rn>qe.x+qe.width&&(bi.width=qe.x+qe.width-bi.x),on>qe.y+qe.height&&(bi.height=qe.y+qe.height-bi.y),yn<qe.x&&(bi.width=bi.width-(qe.x-yn),bi.x=qe.x),Di){const vr=Math.min(1,Si.width/bi.width,Si.height/bi.height);return ms(Si,vr)}return bi})(Ii,{...Y,x:0,y:0},pe),!Ut)return{boundsLimited:Ii,boundsIntent:Ii};let Je=V3(Z,Ii,Ve,ge,{aspectRatio:pe,minSize:Mi,maxSize:Ni});return{boundsLimited:Je,boundsIntent:Je}},Xr=(E,Re)=>{const Ve={target:E,translate:Re},Mi=Id(no(Ot),ht),Ni=Id(no(ve),ht),Ii=((Je,bi,qe={})=>{const{target:Di,translate:gn}=bi,{aspectRatio:Rn,minSize:on}=qe,yn=Cc[jh[Di]],Si=Fn(Ci(Je),rt(yn[0]*Je.width,yn[1]*Je.height)),vr=Cc[Di],po=Fn(Ci(Je),rt(vr[0]*Je.width,vr[1]*Je.height)),[Ms,Ps,Rs,Is,za,ts,Es]=Uh(Di);let Ca=gn.x,da=gn.y;za?da=0:ts&&(Ca=0);let[hr,Or,Xn,Wr]=il(Je);if(Ms?Wr=Si.x:Ps&&(Or=Si.x),Is?hr=Si.y:Rs&&(Xn=Si.y),Ms?Or=po.x+Ca:Ps&&(Wr=po.x+Ca),Is?Xn=po.y+da:Rs&&(hr=po.y+da),on&&za&&Xn-hr<on.height){const Ue=on.height-(Xn-hr);hr-=.5*Ue,Xn+=.5*Ue}if(on&&ts&&Or-Wr<on.width){const Ue=on.width-(Or-Wr);Wr-=.5*Ue,Or+=.5*Ue}if(Rn)if(Es){let Ue=Or-Wr,Ao=Xn-hr;za?(Ao=Ue/Rn,hr=Si.y-.5*Ao,Xn=Si.y+.5*Ao):ts&&(Ue=Ao*Rn,Wr=Si.x-.5*Ue,Or=Si.x+.5*Ue)}else{const Ue=rt(po.x+Ca-Si.x,po.y+da-Si.y);Di===aa?(Ue.x=Math.max(0,Ue.x),Ue.y=Math.min(0,Ue.y)):Di===sa?(Ue.x=Math.max(0,Ue.x),Ue.y=Math.max(0,Ue.y)):Di===la?(Ue.x=Math.min(0,Ue.x),Ue.y=Math.max(0,Ue.y)):Di===oa&&(Ue.x=Math.min(0,Ue.x),Ue.y=Math.min(0,Ue.y));const Ao=ps(Ue),ua=rt(Rn,1),_r=Ar(ro(ua),Ao);Di===aa?(Or=Si.x+_r.x,hr=Si.y-_r.y):Di===sa?(Or=Si.x+_r.x,Xn=Si.y+_r.y):Di===la?(Wr=Si.x-_r.x,Xn=Si.y+_r.y):Di===oa&&(Wr=Si.x-_r.x,hr=Si.y-_r.y)}return In(Wr,hr,Or-Wr,Xn-hr)})(Z,Ve,{aspectRatio:pe,minSize:Mi});return{boundsLimited:Zg(Z,Ve,{...Y,x:0,y:0},{aspectRatio:pe,minSize:Mi,maxSize:Ni}),boundsIntent:Ii}};let Bn,vn;const ci=({translation:E,scalar:Re})=>{Lt&&(Re=1,E=Tl(_e(E)));const Ve=Math.min(St.width/ct.width,St.height/ct.height),Mi=Ar(_e(E),1/Ve);let Ni;if(vn){const Ii=Dn(_e(vn),E);vn=E,Ni=ea(Ci(ct),Ii)}else Ni=ea(Ci(Bn),Tl(_e(Mi))),Re!==void 0&&Er(Ni,1/Re);Ct(ki,yt=Ni,yt),Ct(Zn,ct=Ni,ct)},W=Ei([Gr,Zn],([E,Re],Ve)=>{if(!Re)return;const[Mi,Ni]=E,Ii=or(Re);Ve([el(Wo(Ka(Mi,Ii),ni)),el(Wo(Jr(Ni,Ii),ni))])});A(t,W,E=>i(174,Ft=E));const ne=Ei([ur,Zr,$n,eo,Gr,Fr],([E,Re,Ve,Mi,Ni,Ii],Je)=>{if(!E)return;const bi=Ni[0],qe=Ni[1];let Di,gn;Re?(Di=((Rn,on,yn)=>Ra(yn)?1-1/Math.min(Rn.height/on.width,Rn.width/on.height):1-1/Math.min(Rn.width/on.width,Rn.height/on.height))(E,qe,Ii),gn=Math.min(bi.width/Ve.width,bi.height/Ve.height)):(Di=-1,gn=1),Je([Di,gn].map(Rn=>ni(Rn)))});A(t,ne,E=>i(27,bt=E));const Ai=Ei([ur,Zn,Gr,Fr],([E,Re,Ve,Mi],Ni)=>{if(!E||!Re)return Ni(0);let Ii;const Je=Ve[0],bi=Ve[1],qe=Re.width,Di=Re.height,gn=or(Re),Rn=Ra(Mi)?Vn(E.height,E.width):E,on=Jr(Rn,gn);if(qe<=on.width||Di<=on.height){const yn=on.width-Je.width,Si=on.height-Je.height;Ii=yn===0||Si===0?1:1-Math.min((qe-Je.width)/yn,(Di-Je.height)/Si)}else{const yn=bi.width-on.width,Si=bi.height-on.height,vr=Jr({width:yn,height:Si},gn);Ii=-Math.min((qe-on.width)/vr.width,(Di-on.height)/vr.height)}Ni(Ii)});A(t,Ai,E=>i(28,Ze=E));const oi=E=>{const Re=or(Bn);let Ve,Mi,Ni;const Ii=Ra(Rt)?Vn(oe.height,oe.width):oe,Je=Jr(Ii,Re);if(E>=0){const Di=Je.width-Gt[0].width,gn=Je.height-Gt[0].height;Ve=Je.width-Di*E,Mi=Je.height-gn*E,Ni=Ka({width:Ve,height:Mi},Re)}else{const Di=Gt[1].width-Je.width,gn=Gt[1].height-Je.height;Ve=Je.width+Di*-E,Mi=Je.height+gn*-E,Ni=Jr({width:Ve,height:Mi},Re)}Ve=Ni.width,Mi=Ni.height;const bi=Bn.x+.5*Bn.width-.5*Ve,qe=Bn.y+.5*Bn.height-.5*Mi;Ct(Zn,ct={x:bi,y:qe,width:Ve,height:Mi},ct)};let Kt;const Se=E=>{const Re=Er(Ci(Kt),1/E);Ct(ki,yt=Re,yt),Ct(Zn,ct=Re,ct)};let Li;const Vi=()=>{uo.set({})};let pn;const nn=ai(0,{precision:1e-4});A(t,nn,E=>i(29,Pe=E));const Bi=ai();A(t,Bi,E=>i(30,ri=E));const Br=Ei([un,to,en],([E,Re,Ve],Mi)=>{if(!n)return;const Ni=$s(Ve),Ii=[...Ni].map(Je=>Je[0]).sort((Je,bi)=>En(Je[0])&&!En(bi[0])?1:-1).find(Je=>{if(En(Je)&&Re){const[bi,qe]=Je,Di=Re.width===bi&&Re.height===qe,gn=E===Qo(bi,qe);return Di&&gn}return Je===E});if(!Ii)return Mi(void 0);Mi(Ni.map(Je=>Je[0]).findIndex(Je=>En(Je)?Ja(Je,Ii):Je===Ii))});A(t,Br,E=>i(155,xe=E));const Ho=(E,Re)=>{if(!n||E===-1||E===void 0)return;const Ve=$s(Re)[E][0];return Ve?En(Ve)?Qo(Ve[0],Ve[1]):Ve:void 0},La=Ei([Mn,Dr,oo],([E,Re,Ve],Mi)=>{const{rows:Ni,cols:Ii,opacity:Je}=X(mn,Ve);if(!Re||Je<=0)return Mi([]);const{x:bi,y:qe,width:Di,height:gn}=Re,Rn=Di/Ii,on=gn/Ni,yn=[];for(let Si=1;Si<=Ni-1;Si++){const vr=qe+on*Si;yn.push({id:"image-selection-guide-row-"+Si,points:[rt(bi,vr),rt(bi+Di,vr)],opacity:Je,strokeWidth:1,strokeColor:E})}for(let Si=1;Si<=Ii-1;Si++){const vr=bi+Rn*Si;yn.push({id:"image-selection-guide-col-"+Si,points:[rt(vr,qe),rt(vr,qe+gn)],opacity:Je,strokeWidth:1,strokeColor:E})}Mi(yn)});A(t,La,E=>i(141,ut=E));const jo="crop-"+ra();let br,Rr=jo+"-"+(ye?fi:"zoom"),Ro=Rr,Io;const Eo=ai(H?20:0);return A(t,Eo,E=>i(138,J=E)),t.$$set=E=>{"isActive"in E&&ii(i(0,wi=E.isActive)),"stores"in E&&i(97,pi=E.stores),"cropImageSelectionCornerStyle"in E&&i(1,Fi=E.cropImageSelectionCornerStyle),"cropWillRenderImageSelectionGuides"in E&&i(98,X=E.cropWillRenderImageSelectionGuides),"cropAutoCenterImageSelectionTimeout"in E&&i(99,jt=E.cropAutoCenterImageSelectionTimeout),"cropEnableZoomMatchImageAspectRatio"in E&&i(100,U=E.cropEnableZoomMatchImageAspectRatio),"cropEnableRotateMatchImageAspectRatio"in E&&i(101,Bt=E.cropEnableRotateMatchImageAspectRatio),"cropEnableRotationInput"in E&&i(102,ye=E.cropEnableRotationInput),"cropEnableZoom"in E&&i(2,Qt=E.cropEnableZoom),"cropEnableZoomInput"in E&&i(103,se=E.cropEnableZoomInput),"cropEnableZoomAutoHide"in E&&i(104,zt=E.cropEnableZoomAutoHide),"cropEnableImageSelection"in E&&i(105,We=E.cropEnableImageSelection),"cropEnableInfoIndicator"in E&&i(106,Ae=E.cropEnableInfoIndicator),"cropEnableZoomTowardsWheelPosition"in E&&i(107,je=E.cropEnableZoomTowardsWheelPosition),"cropEnableLimitWheelInputToCropSelection"in E&&i(108,Ke=E.cropEnableLimitWheelInputToCropSelection),"cropEnableCenterImageSelection"in E&&i(109,it=E.cropEnableCenterImageSelection),"cropEnableButtonRotateLeft"in E&&i(110,Xt=E.cropEnableButtonRotateLeft),"cropEnableButtonRotateRight"in E&&i(111,Nt=E.cropEnableButtonRotateRight),"cropEnableButtonFlipHorizontal"in E&&i(112,Zt=E.cropEnableButtonFlipHorizontal),"cropEnableButtonFlipVertical"in E&&i(113,Yt=E.cropEnableButtonFlipVertical),"cropSelectPresetOptions"in E&&i(114,ot=E.cropSelectPresetOptions),"cropEnableSelectPreset"in E&&i(115,he=E.cropEnableSelectPreset),"cropEnableFilterMatchAspectRatio"in E&&i(116,ie=E.cropEnableFilterMatchAspectRatio),"cropSelectPresetFilter"in E&&i(95,fe=E.cropSelectPresetFilter),"cropEnableButtonToggleCropLimit"in E&&i(117,Dt=E.cropEnableButtonToggleCropLimit),"cropWillRenderTools"in E&&i(118,ke=E.cropWillRenderTools),"cropActiveTransformTool"in E&&i(119,fi=E.cropActiveTransformTool),"cropMinimizeToolbar"in E&&i(120,hi=E.cropMinimizeToolbar),"cropInteractionFocus"in E&&i(121,Be=E.cropInteractionFocus),"cropRotationRange"in E&&i(3,yi=E.cropRotationRange),"cropMaskOpacity"in E&&i(122,Pi=E.cropMaskOpacity),"locale"in E&&i(4,be=E.locale)},t.$$.update=()=>{4096&t.$$.dirty[0]|268435456&t.$$.dirty[3]&&Gi.set(Be==="selection"&&S),2097152&t.$$.dirty[3]&&i(129,n=ot&&Array.isArray(ot)&&ot.length),2097152&t.$$.dirty[3]|32&t.$$.dirty[4]&&en.set(n?ot:[]),4096&t.$$.dirty[0]&&S&&lo.set(1),4096&t.$$.dirty[0]&&Ki.set(!S),4096&t.$$.dirty[0]&&Ur.set(!S),4096&t.$$.dirty[0]&&S&&Qr.set(!0),65536&t.$$.dirty[4]&&i(124,h=K.layoutMode==="overlay"),4194304&t.$$.dirty[3]|1&t.$$.dirty[4]&&i(128,P=he&&!h),83886080&t.$$.dirty[4]&&i(137,l=Y&&St&&Xd(Y,St)),67117056&t.$$.dirty[4]&&i(135,c=!(!St||!l)),67119104&t.$$.dirty[4]&&i(133,d=c&&ia(St,l,E=>ni(E,5))),16400&t.$$.dirty[0]|52297732&t.$$.dirty[3]|1879114288&t.$$.dirty[4]|31&t.$$.dirty[5]&&i(11,r=He&&ke([Xt&&["Button","rotate-left",{label:be.cropLabelButtonRotateLeft,labelClass:"PinturaToolbarContentWide",icon:be.cropIconButtonRotateLeft,onclick:()=>{bn(-Math.PI/2),On.write()}}],Nt&&["Button","rotate-right",{label:be.cropLabelButtonRotateRight,labelClass:"PinturaToolbarContentWide",icon:be.cropIconButtonRotateRight,onclick:()=>{bn(Math.PI/2),On.write()}}],Zt&&["Button","flip-horizontal",{label:be.cropLabelButtonFlipHorizontal,labelClass:"PinturaToolbarContentWide",icon:be.cropIconButtonFlipHorizontal,onclick:()=>{Ra(Rt)?Ct(bo,Te=!Te,Te):Ct(xo,Ie=!Ie,Ie),On.write()}}],Yt&&["Button","flip-vertical",{label:be.cropLabelButtonFlipVertical,labelClass:"PinturaToolbarContentWide",icon:be.cropIconButtonFlipVertical,onclick:()=>{Ra(Rt)?Ct(xo,Ie=!Ie,Ie):Ct(bo,Te=!Te,Te),On.write()}}],P&&n&&[fe===!1?"Dropdown":_3,"select-preset",{icon:ar(be.cropIconSelectPreset,be,Ho(xe,_t)),label:ar(be.cropLabelSelectPreset,be,Ho(xe,_t)),labelClass:"PinturaToolbarContentWide",options:_t,filter:fe,onfilterchange:Gn,selectedIndex:xe,onchange:({value:E})=>{En(E)?(Ct(un,pe=Qo(E[0],E[1]),pe),Ct(to,gi=Gf(E),gi)):Ct(un,pe=E,pe),d&&Vi(),On.write()},optionMapper:E=>{let Re=!1;const Ve=En(E.value)?E.value[0]/E.value[1]:E.value;if(Ve){const Mi=Cl(oe,Rt,Ve);Re=Mi.width<Ot.width||Mi.height<Ot.height}return E.icon=((Mi,Ni={})=>{const{width:Ii=24,height:Je=24,bounds:bi=16,radius:qe=3}=Ni;let Di,gn,Rn,on,yn=En(Mi)?Qo(Mi[0],Mi[1]):Mi,Si=!!yn;return yn=Si?yn:1,Rn=yn>1?bi:yn*bi,on=Rn/yn,Di=Math.round(.5*(Ii-Rn)),gn=Math.round(.5*(Je-on)),`<rect fill="${Si?"currentColor":"none"}" stroke="${Si?"none":"currentColor"}" stroke-width="${Ii/16}" stroke-dasharray="${[Ii/12,Ii/6].join(" ")}" x="${Di}" y="${gn}" width="${Rn}" height="${on}" rx="${qe}"/>`})(E.value,{bounds:14}),{...E,disabled:Re}}}],Dt&&["Dropdown","select-crop-limit",{icon:ar(be.cropIconCropBoundary,be,Ut),label:be.cropLabelCropBoundary,labelClass:"PinturaToolbarContentWide",onchange:({value:E})=>{Ct(Zr,Ut=E,Ut),On.write()},options:[[!0,be.cropLabelCropBoundaryEdge,{icon:ar(be.cropIconCropBoundary,be,!0)}],[!1,be.cropLabelCropBoundaryNone,{icon:ar(be.cropIconCropBoundary,be,!1)}]]}]].filter(Boolean),K,()=>an.set({})).filter(Boolean)),6144&t.$$.dirty[0]|134217728&t.$$.dirty[3]|65537&t.$$.dirty[4]&&Ct(Po,we=S&&hi!=="never"&&(hi==="always"||K.verticalSpace==="short"||h)?r.map(([E,Re,Ve])=>Array.isArray(Ve)?[E,Re,Ve]:[E,Re,{...Ve,hideLabel:!0}]):[],we),536870912&t.$$.dirty[4]&&i(23,o=Ut?0:-1),150994944&t.$$.dirty[4]&&i(130,a=Y&&rt(-(nt.x-Y.x),-(nt.y-Y.y))),524352&t.$$.dirty[4]&&i(131,s=ft&&rt(Ic(ft.x+.5*ft.width+a.x),Ic(ft.y+.5*ft.height+a.y))),33554432&t.$$.dirty[4]&&i(134,u=Z!=null),16785408&t.$$.dirty[4]&&i(136,p=Y&&l&&(l.height===Y.height||l.width===Y.width)),12587008&t.$$.dirty[4]&&i(132,g=!p&&ht<1&&et<1),3840&t.$$.dirty[4]&&i(9,m=c&&!u&&(!d||g)),8192&t.$$.dirty[0]|8192&t.$$.dirty[3]|1&t.$$.dirty[4]&&i(22,f=Ae&&!!ct&&!h),524352&t.$$.dirty[4]&&i(8,v=ft&&a&&{x:ft.x+a.x,y:ft.y+a.y,width:ft.width,height:ft.height}),256&t.$$.dirty[0]|4096&t.$$.dirty[3]|1&t.$$.dirty[4]&&i(21,x=We&&!!v&&!h),65600&t.$$.dirty[3]|2097280&t.$$.dirty[4]&&i(10,k=it&&!!s&&!jt&&!Lt),512&t.$$.dirty[0]|1073741888&t.$$.dirty[3]|1048576&t.$$.dirty[4]&&m&&jt&&!$t&&(clearTimeout(pn),i(123,pn=setTimeout(Vi,jt))),1073741824&t.$$.dirty[3]|1048576&t.$$.dirty[4]&&$t&&clearTimeout(pn),1536&t.$$.dirty[0]|32768&t.$$.dirty[4]&&nn.set(k&&m?1:0,{hard:H===!1}),32896&t.$$.dirty[4]&&Bi.set(s,{hard:H===!1}),4096&t.$$.dirty[0]|262144&t.$$.dirty[4]&&(S&&!lt?(Ct(so,N.crop={maskOpacity:Pi,maskMarkupOpacity:Pi},N),so.set(N)):(delete N.crop,so.set(N))),131072&t.$$.dirty[4]&&ut&&pr.update(E=>{const Re=E.filter(Ve=>!/^image\-selection\-guide/.test(Ve.id));return S?[...Re,...ut]:Re}),65536&t.$$.dirty[4]&&i(127,C=K.verticalSpace!=="short"),134217728&t.$$.dirty[3]|9&t.$$.dirty[4]&&i(20,I=hi==="never"&&!h||C&&hi!=="always"),4&t.$$.dirty[0]|1024&t.$$.dirty[3]&&i(126,O=Qt&&se),2048&t.$$.dirty[3]|12&t.$$.dirty[4]&&i(125,T=zt?C&&O:O),512&t.$$.dirty[3]|2&t.$$.dirty[4]&&i(19,L=ye||T),2&t.$$.dirty[4]&&(T||i(5,Ro=Rr)),32&t.$$.dirty[0]&&i(18,F={name:jo,selected:Ro}),16&t.$$.dirty[0]|512&t.$$.dirty[3]|2&t.$$.dirty[4]&&i(7,B=[ye&&{id:jo+"-rotation",label:be.cropLabelTabRotation},T&&{id:jo+"-zoom",label:be.cropLabelTabZoom}].filter(Boolean)),128&t.$$.dirty[0]&&i(17,y=B.map(E=>E.id)),64&t.$$.dirty[0]|1&t.$$.dirty[4]&&br&&!br.children.length&&h&&br.dispatchEvent(new CustomEvent("measure",{detail:br.rect})),4096&t.$$.dirty[0]|32768&t.$$.dirty[4]&&H&&Eo.set(S?0:20),16384&t.$$.dirty[4]&&i(16,V=J?`transform: translateY(${J}px)`:void 0)},[wi,Fi,Qt,yi,be,Ro,br,B,v,m,k,r,S,ct,Rt,Io,V,y,F,L,I,x,f,o,wt,vi,vt,bt,Ze,Pe,ri,me,Ee,an,Gi,fn,hn,en,Wn,Ri,zn,go,ao,fr,fo,yo,Po,so,xo,bo,Fr,yr,to,dn,Qn,vo,Dr,ki,Pn,Zn,$n,eo,Gr,un,Zr,ur,co,jn,()=>{mn="select",Ct(Ri,$t=!0,$t),Ct(Qn,Z=Ci(St),Z),xr=Lt?io:Xr},({detail:E})=>{const{boundsLimited:Re,boundsIntent:Ve}=xr(E.direction,E.translation);Ct(zn,mt=!0,mt),Ct(vo,_=Ve,_),Ct(dn,St=Re,St)},({detail:E})=>{const{boundsLimited:Re}=xr(E.direction,E.translation);Ct(zn,mt=!1,mt),Ct(Ri,$t=!1,$t),Ct(vo,_=void 0,_),ps(E.translation)&&(Ct(dn,St=Re,St),On.write()),Ct(Qn,Z=void 0,Z),mn=void 0},()=>{mn="rotate",Ct(Ri,$t=!0,$t),Ct(Pn,ue=Ci(ct),ue)},E=>{Ct(zn,mt=!0,mt),Ct(Fr,Rt=E,Rt)},E=>{Ct(zn,mt=!1,mt),Ct(Ri,$t=!1,$t),Ct(Fr,Rt=E,Rt),On.write(),Ct(Pn,ue=void 0,ue)},()=>{mn="pan",vn=void 0,Ct(Ri,$t=!0,$t),Bn=Ci(ct)},({detail:E})=>{Ct(zn,mt=!0,mt),ci(E)},({detail:E})=>{Ct(zn,mt=!1,mt),Ct(Ri,$t=!1,$t),(ps(E.translation)>0||E.scalar!==0)&&(ci(E),On.write()),Ct(ki,yt=void 0,yt),Bn=void 0},({detail:{translation:E}})=>{Lt&&(E=Tl(_e(E))),vn=E,Ct(Ri,$t=!1,$t)},W,ne,Ai,()=>{mn="zoom",Ct(Ri,$t=!0,$t),Bn=Ci(ct)},E=>{Ct(zn,mt=!1,mt),oi(E)},E=>{oi(E),On.write(),Ct(zn,mt=!1,mt),Ct(Ri,$t=!1,$t),Bn=void 0},()=>{mn="zoom",Bn||(Kt=Ci(ct),Ct(Ri,$t=!0,$t))},({detail:E})=>{Kt&&(Ct(zn,mt=!0,mt),Se(E))},({detail:E})=>{Kt&&(Ct(zn,mt=!1,mt),Ct(Ri,$t=!1,$t),Se(E),Ct(ki,yt=void 0,yt),Kt=void 0,On.write())},E=>{const Re=Yp(E,wt,nt);if(Ke&&!nu(St,Re))return;mn="zoom",Ct(Ri,$t=!0,$t),Ct(zn,mt=!0,mt),E.preventDefault(),E.stopPropagation();const Ve=ku(E,{fixScrollDirection:j}),Mi=1+Ve/100,Ni=Ci(ct),Ii=Math.min(ct.width/Ot.width,ct.height/Ot.height)===1;if(U&&Ut){const qe=gr(ct,oe,Rt);if(qi()&&qe&&Ve>0&&d){Ct(Ri,$t=!1,$t),Ct(zn,mt=!1,mt);const Di=Ra(Rt)?Hr({height:oe.width,width:oe.height}):Hr(oe);return ia(Ni,Di)||(clearTimeout(Li),ia(On.state.crop,Di))?void 0:(Ct(Zn,ct=Di,ct),void On.write())}}let Je=Ti(ct);if(je&&Be!=="selection"&&Ve<0&&!Ii){const qe=Dn(_e(Re),St),Di=Math.min(St.width/ct.width,St.height/ct.height),gn=Er(Ci(St),1.1);Je=nu(gn,Re)?Fn(Ci(ct),Ar(qe,1/Di)):Je}let bi=Er(Ci(ct),Mi,Je);if(iu(Ft[1],bi)||(bi=lm(Ti(bi),Ft[1])),iu(bi,Ft[0])||(bi=lm(Ti(bi),Ft[0])),ia(Ni,bi,ni))return Ct(Ri,$t=!1,$t),void Ct(zn,mt=!1,mt);Ct(Zn,ct=Wo(bi,qe=>ni(qe,5)),ct),Ct(Ri,$t=!1,$t),Ct(zn,mt=!1,mt),clearTimeout(Li),Li=setTimeout(()=>{On.write()},500)},Vi,nn,Bi,Br,La,jo,Eo,fe,"crop",pi,X,jt,U,Bt,ye,se,zt,We,Ae,je,Ke,it,Xt,Nt,Zt,Yt,ot,he,ie,Dt,ke,fi,hi,Be,Pi,pn,h,T,O,C,P,n,a,s,g,d,u,c,p,l,J,H,K,ut,lt,ft,$t,Lt,et,ht,Y,Z,St,nt,oe,Ut,Ot,xe,_t,Te,Ie,He,function(E){jr.call(this,t,E)},({detail:E})=>i(5,Ro=E),function(E){zi[E?"unshift":"push"](()=>{br=E,i(6,br)})},E=>Nh(E),function(E){Io=E,i(15,Io)},function(E){jr.call(this,t,E)}]}var tS={util:["crop",class extends li{constructor(t){super(),si(this,t,Q3,q3,ei,{name:96,isActive:0,stores:97,cropImageSelectionCornerStyle:1,cropWillRenderImageSelectionGuides:98,cropAutoCenterImageSelectionTimeout:99,cropEnableZoomMatchImageAspectRatio:100,cropEnableRotateMatchImageAspectRatio:101,cropEnableRotationInput:102,cropEnableZoom:2,cropEnableZoomInput:103,cropEnableZoomAutoHide:104,cropEnableImageSelection:105,cropEnableInfoIndicator:106,cropEnableZoomTowardsWheelPosition:107,cropEnableLimitWheelInputToCropSelection:108,cropEnableCenterImageSelection:109,cropEnableButtonRotateLeft:110,cropEnableButtonRotateRight:111,cropEnableButtonFlipHorizontal:112,cropEnableButtonFlipVertical:113,cropSelectPresetOptions:114,cropEnableSelectPreset:115,cropEnableFilterMatchAspectRatio:116,cropSelectPresetFilter:95,cropEnableButtonToggleCropLimit:117,cropWillRenderTools:118,cropActiveTransformTool:119,cropMinimizeToolbar:120,cropInteractionFocus:121,cropRotationRange:3,cropMaskOpacity:122,locale:4},null,[-1,-1,-1,-1,-1,-1,-1,-1])}get name(){return this.$$.ctx[96]}get isActive(){return this.$$.ctx[0]}set isActive(t){this.$$set({isActive:t}),R()}get stores(){return this.$$.ctx[97]}set stores(t){this.$$set({stores:t}),R()}get cropImageSelectionCornerStyle(){return this.$$.ctx[1]}set cropImageSelectionCornerStyle(t){this.$$set({cropImageSelectionCornerStyle:t}),R()}get cropWillRenderImageSelectionGuides(){return this.$$.ctx[98]}set cropWillRenderImageSelectionGuides(t){this.$$set({cropWillRenderImageSelectionGuides:t}),R()}get cropAutoCenterImageSelectionTimeout(){return this.$$.ctx[99]}set cropAutoCenterImageSelectionTimeout(t){this.$$set({cropAutoCenterImageSelectionTimeout:t}),R()}get cropEnableZoomMatchImageAspectRatio(){return this.$$.ctx[100]}set cropEnableZoomMatchImageAspectRatio(t){this.$$set({cropEnableZoomMatchImageAspectRatio:t}),R()}get cropEnableRotateMatchImageAspectRatio(){return this.$$.ctx[101]}set cropEnableRotateMatchImageAspectRatio(t){this.$$set({cropEnableRotateMatchImageAspectRatio:t}),R()}get cropEnableRotationInput(){return this.$$.ctx[102]}set cropEnableRotationInput(t){this.$$set({cropEnableRotationInput:t}),R()}get cropEnableZoom(){return this.$$.ctx[2]}set cropEnableZoom(t){this.$$set({cropEnableZoom:t}),R()}get cropEnableZoomInput(){return this.$$.ctx[103]}set cropEnableZoomInput(t){this.$$set({cropEnableZoomInput:t}),R()}get cropEnableZoomAutoHide(){return this.$$.ctx[104]}set cropEnableZoomAutoHide(t){this.$$set({cropEnableZoomAutoHide:t}),R()}get cropEnableImageSelection(){return this.$$.ctx[105]}set cropEnableImageSelection(t){this.$$set({cropEnableImageSelection:t}),R()}get cropEnableInfoIndicator(){return this.$$.ctx[106]}set cropEnableInfoIndicator(t){this.$$set({cropEnableInfoIndicator:t}),R()}get cropEnableZoomTowardsWheelPosition(){return this.$$.ctx[107]}set cropEnableZoomTowardsWheelPosition(t){this.$$set({cropEnableZoomTowardsWheelPosition:t}),R()}get cropEnableLimitWheelInputToCropSelection(){return this.$$.ctx[108]}set cropEnableLimitWheelInputToCropSelection(t){this.$$set({cropEnableLimitWheelInputToCropSelection:t}),R()}get cropEnableCenterImageSelection(){return this.$$.ctx[109]}set cropEnableCenterImageSelection(t){this.$$set({cropEnableCenterImageSelection:t}),R()}get cropEnableButtonRotateLeft(){return this.$$.ctx[110]}set cropEnableButtonRotateLeft(t){this.$$set({cropEnableButtonRotateLeft:t}),R()}get cropEnableButtonRotateRight(){return this.$$.ctx[111]}set cropEnableButtonRotateRight(t){this.$$set({cropEnableButtonRotateRight:t}),R()}get cropEnableButtonFlipHorizontal(){return this.$$.ctx[112]}set cropEnableButtonFlipHorizontal(t){this.$$set({cropEnableButtonFlipHorizontal:t}),R()}get cropEnableButtonFlipVertical(){return this.$$.ctx[113]}set cropEnableButtonFlipVertical(t){this.$$set({cropEnableButtonFlipVertical:t}),R()}get cropSelectPresetOptions(){return this.$$.ctx[114]}set cropSelectPresetOptions(t){this.$$set({cropSelectPresetOptions:t}),R()}get cropEnableSelectPreset(){return this.$$.ctx[115]}set cropEnableSelectPreset(t){this.$$set({cropEnableSelectPreset:t}),R()}get cropEnableFilterMatchAspectRatio(){return this.$$.ctx[116]}set cropEnableFilterMatchAspectRatio(t){this.$$set({cropEnableFilterMatchAspectRatio:t}),R()}get cropSelectPresetFilter(){return this.$$.ctx[95]}set cropSelectPresetFilter(t){this.$$set({cropSelectPresetFilter:t}),R()}get cropEnableButtonToggleCropLimit(){return this.$$.ctx[117]}set cropEnableButtonToggleCropLimit(t){this.$$set({cropEnableButtonToggleCropLimit:t}),R()}get cropWillRenderTools(){return this.$$.ctx[118]}set cropWillRenderTools(t){this.$$set({cropWillRenderTools:t}),R()}get cropActiveTransformTool(){return this.$$.ctx[119]}set cropActiveTransformTool(t){this.$$set({cropActiveTransformTool:t}),R()}get cropMinimizeToolbar(){return this.$$.ctx[120]}set cropMinimizeToolbar(t){this.$$set({cropMinimizeToolbar:t}),R()}get cropInteractionFocus(){return this.$$.ctx[121]}set cropInteractionFocus(t){this.$$set({cropInteractionFocus:t}),R()}get cropRotationRange(){return this.$$.ctx[3]}set cropRotationRange(t){this.$$set({cropRotationRange:t}),R()}get cropMaskOpacity(){return this.$$.ctx[122]}set cropMaskOpacity(t){this.$$set({cropMaskOpacity:t}),R()}get locale(){return this.$$.ctx[4]}set locale(t){this.$$set({locale:t}),R()}}]};function eS(t){let e,i,n,r,o,a,s,l=t[77],c=(tn(t[77].label)?t[77].label(t[2]):t[77].label)+"";function d(...h){return t[51](t[77],...h)}const u=()=>t[52](i,l),p=()=>t[52](null,l);return{c(){e=pt("div"),i=pt("div"),n=de(),r=pt("span"),o=cn(c),w(i,"class",B2),w(e,"slot","option"),w(e,"class","PinturaFilterOption")},m(h,g){tt(h,e,g),Tt(e,i),u(),Tt(e,n),Tt(e,r),Tt(r,o),a||(s=[Mt(i,"measure",d),Ui(Mr.call(null,i))],a=!0)},p(h,g){l!==(t=h)[77]&&(p(),l=t[77],u()),4&g[0]|32768&g[2]&&c!==(c=(tn(t[77].label)?t[77].label(t[2]):t[77].label)+"")&&An(o,c)},d(h){h&&Q(e),p(),a=!1,_i(s)}}}function iS(t){let e,i;return e=new Qa({props:{locale:t[2],layout:"row",options:t[3],selectedIndex:t[12],onchange:t[32],$$slots:{option:[eS,({option:n})=>({77:n}),({option:n})=>[0,0,n?32768:0]]},$$scope:{ctx:t}}}),{c(){At(e.$$.fragment)},m(n,r){It(e,n,r),i=!0},p(n,r){const o={};4&r[0]&&(o.locale=n[2]),8&r[0]&&(o.options=n[3]),4096&r[0]&&(o.selectedIndex=n[12]),1028&r[0]|98304&r[2]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){D(e.$$.fragment,n),i=!1},d(n){Et(e,n)}}}function nS(t){let e,i,n,r,o,a,s,l;function c(h){t[54](h)}function d(h){t[55](h)}function u(h){t[56](h)}let p={elasticity:t[13]*t[19],onscroll:t[53],$$slots:{default:[iS]},$$scope:{ctx:t}};return t[4]!==void 0&&(p.maskFeatherStartOpacity=t[4]),t[5]!==void 0&&(p.maskFeatherEndOpacity=t[5]),t[6]!==void 0&&(p.maskFeatherSize=t[6]),i=new ka({props:p}),zi.push(()=>mo(i,"maskFeatherStartOpacity",c)),zi.push(()=>mo(i,"maskFeatherEndOpacity",d)),zi.push(()=>mo(i,"maskFeatherSize",u)),i.$on("measure",t[57]),{c(){e=pt("div"),At(i.$$.fragment),w(e,"slot","footer"),w(e,"style",t[11])},m(h,g){tt(h,e,g),It(i,e,null),a=!0,s||(l=[Mt(e,"transitionend",t[30]),Mt(e,"measure",t[58]),Ui(Mr.call(null,e,{observePosition:!0}))],s=!0)},p(h,g){const m={};8192&g[0]&&(m.elasticity=h[13]*h[19]),128&g[0]&&(m.onscroll=h[53]),5132&g[0]|65536&g[2]&&(m.$$scope={dirty:g,ctx:h}),!n&&16&g[0]&&(n=!0,m.maskFeatherStartOpacity=h[4],To(()=>n=!1)),!r&&32&g[0]&&(r=!0,m.maskFeatherEndOpacity=h[5],To(()=>r=!1)),!o&&64&g[0]&&(o=!0,m.maskFeatherSize=h[6],To(()=>o=!1)),i.$set(m),(!a||2048&g[0])&&w(e,"style",h[11])},i(h){a||(M(i.$$.fragment,h),a=!0)},o(h){D(i.$$.fragment,h),a=!1},d(h){h&&Q(e),Et(i),s=!1,_i(l)}}}function rS(t){let e,i;return e=new ol({props:{$$slots:{footer:[nS]},$$scope:{ctx:t}}}),e.$on("measure",t[59]),{c(){At(e.$$.fragment)},m(n,r){It(e,n,r),i=!0},p(n,r){const o={};16380&r[0]|65536&r[2]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){D(e.$$.fragment,n),i=!1},d(n){Et(e,n)}}}let B2="PinturaFilterPreview";function oS(t,e,i){let n,r,o,a,s,l,c,d,u,p,h,g,m,f,x,k,v,C,P,I,O=Qe,T=()=>(O(),O=Nr(y,vt=>i(43,d=vt)),y),L=Qe,F=()=>(L(),L=Nr(B,vt=>i(49,v=vt)),B);t.$$.on_destroy.push(()=>O()),t.$$.on_destroy.push(()=>L());let{isActive:B}=e;F();let{isActiveFraction:y}=e;T();let{stores:V}=e,{locale:J}=e,{filterFunctions:S}=e,{filterOptions:H}=e;const K=sn("elasticityMultiplier");A(t,K,vt=>i(13,I=vt));const{history:ut,interfaceImages:lt,stageRectBase:N,utilRect:ft,animation:$t,scrollElasticity:Lt,imageSize:ct,imagePreview:et,imageCropRect:ht,imageRotation:Y,imageFlipX:Z,imageFlipY:St,imageBackgroundColor:nt,imageGamma:mt,imageColorMatrix:Ft,allowPan:oe,allowZoom:Rt,allowZoomControls:Ut,allowPlayPause:Ot}=V;A(t,lt,vt=>i(60,u=vt)),A(t,N,vt=>i(48,k=vt)),A(t,ft,vt=>i(47,x=vt)),A(t,$t,vt=>i(50,C=vt)),A(t,ct,vt=>i(62,h=vt)),A(t,et,vt=>i(42,c=vt)),A(t,nt,vt=>i(61,p=vt)),A(t,mt,vt=>i(44,g=vt)),A(t,Ft,vt=>i(40,s=vt));const j=le({});A(t,j,vt=>i(46,f=vt));const wt=(vt,bt)=>Ct(j,f[vt.value]=bt,f),yt=Ei(j,vt=>{if(!vt[void 0])return;const bt=vt[void 0];return P&&Tc(P,bt)?P:no(bt)});A(t,yt,vt=>i(63,P=vt));const Gt=Ei([B,yt,ht,ct,Y,Z,St],([vt,bt,Ze,Pe,ri,Ge,ii],wi)=>{if(!vt||!bt||!Pe)return m;const pi=Hr(Pe),Fi=Ti(pi),X=Rh(Pe,Ze,ri),jt=Ti(X),U=Dn(_e(Fi),jt),Bt=Tl(_e(U)),ye=Math.max(bt.width/Ze.width,bt.height/Ze.height);wi({origin:Bt,translation:U,rotation:{x:ii?Math.PI:0,y:Ge?Math.PI:0,z:ri},scale:ye})});A(t,Gt,vt=>i(45,m=vt));const ue=ai(C?20:0);let pe;A(t,ue,vt=>i(39,a=vt));const ve={};let ge,_,we,gi,xe,_t,Te={x:0,y:0};const Ie=le([]);A(t,Ie,vt=>i(41,l=vt));const He=vt=>{const bt={...vt,data:c,size:h,offset:{...vt.offset},mask:{...vt.mask},backgroundColor:p};return bt.opacity=d,bt.offset.y+=a,bt.mask.y+=a,bt.id="filter",bt},vi=()=>u.filter(vt=>vt.id!=="filter");return No(()=>{lt.set([])}),t.$$set=vt=>{"isActive"in vt&&F(i(0,B=vt.isActive)),"isActiveFraction"in vt&&T(i(1,y=vt.isActiveFraction)),"stores"in vt&&i(34,V=vt.stores),"locale"in vt&&i(2,J=vt.locale),"filterFunctions"in vt&&i(35,S=vt.filterFunctions),"filterOptions"in vt&&i(3,H=vt.filterOptions)},t.$$.update=()=>{if(262144&t.$$.dirty[1]&&oe.set(v),262144&t.$$.dirty[1]&&Rt.set(v),262144&t.$$.dirty[1]&&Ut.set(v),262144&t.$$.dirty[1]&&v&&Ot.set(!1),8&t.$$.dirty[0]&&i(38,n=$s(H)),640&t.$$.dirty[1]&&i(12,r=((vt,bt)=>{if(!vt||!vt.filter||!bt)return 0;const Ze=vt.filter;return bt.findIndex(([Pe])=>{if(!S[Pe])return!1;const ri=S[Pe]();return Ja(ri,Ze)})})(s,n)),786432&t.$$.dirty[1]&&C&&ue.set(v?0:20),512&t.$$.dirty[0]|458752&t.$$.dirty[1]&&v&&x&&k&&_t&&i(37,xe={x:k.x-x.x,y:k.y-x.y+_t.y}),496&t.$$.dirty[0]|58096&t.$$.dirty[1]&&m&&xe&&Te&&gi&&pe){const vt=xe.x+gi.x+Te.x,bt=xe.y,Ze=gi.x+xe.x,Pe=Ze+gi.width;Ie.set(n.map(([ri],Ge)=>{const ii=f[ri],wi=Te.x+ii.x,pi=wi+ii.width;if(pi<0||wi>gi.width)return!1;const Fi=vt+ii.x,X=bt+ii.y,jt=(Bt=>({origin:_e(Bt.origin),translation:_e(Bt.translation),rotation:{...Bt.rotation},scale:Bt.scale}))(m);jt.offset=rt(.5*ii.width+Fi,.5*ii.height+X),jt.maskOpacity=1,jt.mask=In(Fi+0,X,ii.width+0,ii.height),jt.maskFeather=[1,0,1,0,1,Pe,1,Pe],wi<we&&ge<1&&(jt.maskFeather[0]=ge,jt.maskFeather[1]=Ze,jt.maskFeather[2]=1,jt.maskFeather[3]=Ze+we),pi>gi.width-we&&_<1&&(jt.maskFeather[4]=_,jt.maskFeather[5]=Pe-we,jt.maskFeather[6]=1,jt.maskFeather[7]=Pe),jt.maskCornerRadius=pe[ri];let U=s&&Object.keys(s).filter(Bt=>Bt!="filter").map(Bt=>s[Bt])||[];return tn(S[ri])&&U.push(S[ri]()),jt.colorMatrix=U.length?Ch(U):void 0,jt.gamma=g,jt}).filter(Boolean))}if(7424&t.$$.dirty[1])if(d>0&&l){const vt=[...vi(),...l.map(He)];lt.set(vt)}else lt.set(vi());256&t.$$.dirty[1]&&i(11,o=a?`transform: translateY(${a}px)`:void 0)},[B,y,J,H,ge,_,we,Te,gi,_t,ve,o,r,I,K,lt,N,ft,$t,Lt,ct,et,nt,mt,Ft,j,wt,yt,Gt,ue,vt=>{vt.target.className===B2&&i(36,pe=Object.keys(ve).reduce((bt,Ze)=>{const Pe=ve[Ze],ri=getComputedStyle(Pe),Ge=["top-left","top-right","bottom-left","bottom-right"].map(ii=>ri.getPropertyValue(`border-${ii}-radius`)).map(l2).map(ii=>1.25*ii);return bt[Ze]=Ge,bt},{}))},Ie,({value:vt})=>{Ct(Ft,s={...s,filter:tn(S[vt])?S[vt]():void 0},s),ut.write()},"filter",V,S,pe,xe,n,a,s,l,c,d,g,m,f,x,k,v,C,(vt,bt)=>wt(vt,bt.detail),function(vt,bt){zi[vt?"unshift":"push"](()=>{ve[bt.value]=vt,i(10,ve)})},vt=>i(7,Te=vt),function(vt){ge=vt,i(4,ge)},function(vt){_=vt,i(5,_)},function(vt){we=vt,i(6,we)},vt=>i(8,gi=vt.detail),vt=>i(9,_t=vt.detail),function(vt){jr.call(this,t,vt)}]}var aS={util:["filter",class extends li{constructor(t){super(),si(this,t,oS,rS,ei,{name:33,isActive:0,isActiveFraction:1,stores:34,locale:2,filterFunctions:35,filterOptions:3},null,[-1,-1,-1])}get name(){return this.$$.ctx[33]}get isActive(){return this.$$.ctx[0]}set isActive(t){this.$$set({isActive:t}),R()}get isActiveFraction(){return this.$$.ctx[1]}set isActiveFraction(t){this.$$set({isActiveFraction:t}),R()}get stores(){return this.$$.ctx[34]}set stores(t){this.$$set({stores:t}),R()}get locale(){return this.$$.ctx[2]}set locale(t){this.$$set({locale:t}),R()}get filterFunctions(){return this.$$.ctx[35]}set filterFunctions(t){this.$$set({filterFunctions:t}),R()}get filterOptions(){return this.$$.ctx[3]}set filterOptions(t){this.$$set({filterOptions:t}),R()}}]};function sS(t){let e,i,n=t[43].label+"";return{c(){e=pt("span"),i=cn(n)},m(r,o){tt(r,e,o),Tt(e,i)},p(r,o){4096&o[1]&&n!==(n=r[43].label+"")&&An(i,n)},d(r){r&&Q(e)}}}function lS(t){let e,i;const n=[{class:"PinturaControlList"},{tabs:t[1]},t[5]];let r={$$slots:{default:[sS,({tab:o})=>({43:o}),({tab:o})=>[0,o?4096:0]]},$$scope:{ctx:t}};for(let o=0;o<n.length;o+=1)r=Cn(r,n[o]);return e=new wu({props:r}),e.$on("select",t[24]),{c(){At(e.$$.fragment)},m(o,a){It(e,o,a),i=!0},p(o,a){const s=34&a[0]?Tr(n,[n[0],2&a[0]&&{tabs:o[1]},32&a[0]&&zr(o[5])]):{};12288&a[1]&&(s.$$scope={dirty:a,ctx:o}),e.$set(s)},i(o){i||(M(e.$$.fragment,o),i=!0)},o(o){D(e.$$.fragment,o),i=!1},d(o){Et(e,o)}}}function cS(t){let e,i;const n=[t[7][t[42]]];let r={};for(let o=0;o<n.length;o+=1)r=Cn(r,n[o]);return e=new Hh({props:r}),{c(){At(e.$$.fragment)},m(o,a){It(e,o,a),i=!0},p(o,a){const s=128&a[0]|2048&a[1]?Tr(n,[zr(o[7][o[42]])]):{};e.$set(s)},i(o){i||(M(e.$$.fragment,o),i=!0)},o(o){D(e.$$.fragment,o),i=!1},d(o){Et(e,o)}}}function dS(t){let e,i,n,r,o;i=new ka({props:{elasticity:t[6]*t[9],class:"PinturaControlListScroller",$$slots:{default:[lS]},$$scope:{ctx:t}}});const a=[{class:"PinturaControlPanels"},{panelClass:"PinturaControlPanel"},{panels:t[4]},t[5]];let s={$$slots:{default:[cS,({panel:l})=>({42:l}),({panel:l})=>[0,l?2048:0]]},$$scope:{ctx:t}};for(let l=0;l<a.length;l+=1)s=Cn(s,a[l]);return r=new Su({props:s}),{c(){e=pt("div"),At(i.$$.fragment),n=de(),At(r.$$.fragment),w(e,"slot","footer"),w(e,"style",t[3])},m(l,c){tt(l,e,c),It(i,e,null),Tt(e,n),It(r,e,null),o=!0},p(l,c){const d={};64&c[0]&&(d.elasticity=l[6]*l[9]),38&c[0]|8192&c[1]&&(d.$$scope={dirty:c,ctx:l}),i.$set(d);const u=48&c[0]?Tr(a,[a[0],a[1],16&c[0]&&{panels:l[4]},32&c[0]&&zr(l[5])]):{};128&c[0]|10240&c[1]&&(u.$$scope={dirty:c,ctx:l}),r.$set(u),(!o||8&c[0])&&w(e,"style",l[3])},i(l){o||(M(i.$$.fragment,l),M(r.$$.fragment,l),o=!0)},o(l){D(i.$$.fragment,l),D(r.$$.fragment,l),o=!1},d(l){l&&Q(e),Et(i),Et(r)}}}function uS(t){let e,i;return e=new ol({props:{$$slots:{footer:[dS]},$$scope:{ctx:t}}}),e.$on("measure",t[25]),{c(){At(e.$$.fragment)},m(n,r){It(e,n,r),i=!0},p(n,r){const o={};254&r[0]|8192&r[1]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){D(e.$$.fragment,n),i=!1},d(n){Et(e,n)}}}function pS(t,e,i){let n,r,o,a,s,l,c,d,u,p,h,g=Qe,m=()=>(g(),g=Nr(x,ht=>i(21,c=ht)),x);t.$$.on_destroy.push(()=>g());let{stores:f}=e,{isActive:x}=e;m();let{locale:k={}}=e,{finetuneControlConfiguration:v}=e,{finetuneOptions:C}=e,{finetuneNudgePrecision:P}=e;const{history:I,animation:O,scrollElasticity:T,rangeInputElasticity:L,imageColorMatrix:F,imageConvolutionMatrix:B,imageGamma:y,imageVignette:V,imageNoise:J,allowPan:S,allowZoom:H,allowZoomControls:K,allowPlayPause:ut}=f;A(t,O,ht=>i(22,d=ht));const lt={imageColorMatrix:F,imageConvolutionMatrix:B,imageGamma:y,imageVignette:V,imageNoise:J},N=sn("elasticityMultiplier");A(t,N,ht=>i(6,p=ht));const ft="finetune-"+ra(),$t=le({});A(t,$t,ht=>i(23,u=ht));const Lt=le({});A(t,Lt,ht=>i(7,h=ht));let ct=[];const et=ai(d?20:0);return A(t,et,ht=>i(20,l=ht)),t.$$set=ht=>{"stores"in ht&&i(15,f=ht.stores),"isActive"in ht&&m(i(0,x=ht.isActive)),"locale"in ht&&i(16,k=ht.locale),"finetuneControlConfiguration"in ht&&i(17,v=ht.finetuneControlConfiguration),"finetuneOptions"in ht&&i(18,C=ht.finetuneOptions),"finetuneNudgePrecision"in ht&&i(19,P=ht.finetuneNudgePrecision)},t.$$.update=()=>{var ht;2097152&t.$$.dirty[0]&&S.set(c),2097152&t.$$.dirty[0]&&H.set(c),2097152&t.$$.dirty[0]&&K.set(c),2097152&t.$$.dirty[0]&&c&&ut.set(!0),327680&t.$$.dirty[0]&&i(1,n=C?C.map(([Y,Z])=>({id:Y,label:tn(Z)?Z(k):Z})):[]),2&t.$$.dirty[0]&&i(2,r=n.length&&n[0].id),4&t.$$.dirty[0]&&i(5,o={name:ft,selected:r}),2&t.$$.dirty[0]&&i(4,a=n.map(Y=>Y.id)),131072&t.$$.dirty[0]&&v&&(ht=v,ct&&ct.forEach(Y=>Y()),ct=a.map(Y=>{const{getStore:Z,getValue:St=Xi}=ht[Y];return Z(lt).subscribe(nt=>{const mt=nt!=null?St(nt):nt;Ct($t,u={...u,[Y]:mt},u)})})),8519680&t.$$.dirty[0]&&v&&u&&Ct(Lt,h=Object.keys(u).reduce((Y,Z)=>{const{base:St,min:nt,max:mt,getLabel:Ft,getStore:oe,setValue:Rt=(j,wt)=>j.set(wt)}=v[Z],Ut=oe(lt),Ot=u[Z]!=null?u[Z]:St;return Y[Z]={base:St,min:nt,max:mt,value:Ot,valueLabel:Ft?Ft(Ot,nt,mt,mt-nt):Math.round(100*Ot),oninputmove:j=>{Rt(Ut,j)},oninputend:j=>{Rt(Ut,j),I.write()},elasticity:p*L,labelReset:k.labelReset,nudgeMultiplier:P},Y},{}),h),6291456&t.$$.dirty[0]&&d&&et.set(c?0:20),1048576&t.$$.dirty[0]&&i(3,s=l?`transform: translateY(${l}px)`:void 0)},[x,n,r,s,a,o,p,h,O,T,N,$t,Lt,et,"finetune",f,k,v,C,P,l,c,d,u,({detail:ht})=>i(2,r=ht),function(ht){jr.call(this,t,ht)}]}var hS={util:["finetune",class extends li{constructor(t){super(),si(this,t,pS,uS,ei,{name:14,stores:15,isActive:0,locale:16,finetuneControlConfiguration:17,finetuneOptions:18,finetuneNudgePrecision:19},null,[-1,-1])}get name(){return this.$$.ctx[14]}get stores(){return this.$$.ctx[15]}set stores(t){this.$$set({stores:t}),R()}get isActive(){return this.$$.ctx[0]}set isActive(t){this.$$set({isActive:t}),R()}get locale(){return this.$$.ctx[16]}set locale(t){this.$$set({locale:t}),R()}get finetuneControlConfiguration(){return this.$$.ctx[17]}set finetuneControlConfiguration(t){this.$$set({finetuneControlConfiguration:t}),R()}get finetuneOptions(){return this.$$.ctx[18]}set finetuneOptions(t){this.$$set({finetuneOptions:t}),R()}get finetuneNudgePrecision(){return this.$$.ctx[19]}set finetuneNudgePrecision(t){this.$$set({finetuneNudgePrecision:t}),R()}}]},hu=(t,e)=>{const i=e.length;return t<0?t%i+i:t>=i?t%i:t};function rf(t,e,i){const n=t.slice();return n[45]=e[i].key,n[46]=e[i].index,n[47]=e[i].translate,n[48]=e[i].scale,n[12]=e[i].rotate,n[49]=e[i].dir,n[50]=e[i].center,n[51]=e[i].type,n[2]=e[i].visible,n}function of(t){let e,i;return{c(){e=pt("div"),w(e,"class","PinturaShapeManipulator"),w(e,"data-control","point"),w(e,"style",i=`pointer-events:none;transform: translate3d(${t[50].x}px, ${t[50].y}px, 0) scale(${t[5]}, ${t[5]}); opacity: ${t[4]}`)},m(n,r){tt(n,e,r)},p(n,r){56&r[0]&&i!==(i=`pointer-events:none;transform: translate3d(${n[50].x}px, ${n[50].y}px, 0) scale(${n[5]}, ${n[5]}); opacity: ${n[4]}`)&&w(e,"style",i)},d(n){n&&Q(e)}}}function af(t,e){let i,n,r,o,a,s,l,c,d;function u(...h){return e[17](e[46],...h)}let p=e[51]==="edge"&&e[2]&&of(e);return{key:t,first:null,c(){i=pt("div"),s=de(),p&&p.c(),l=Tn(),w(i,"role","button"),w(i,"aria-label",n=`Drag ${e[51]} ${e[45]}`),w(i,"tabindex",r=e[51]==="edge"?-1:0),w(i,"class","PinturaShapeManipulator"),w(i,"data-control",o=e[51]),w(i,"style",a=`cursor:${e[49]?e[49]+"-resize":"move"};opacity:${e[4]};--tx:${e[47].x};--ty:${e[47].y};--r:${e[51]==="edge"?e[12]:0}rad;--sx:${e[51]==="point"?e[5]:e[48].x};--sy:${e[51]==="point"?e[5]:e[48].y};`),this.first=i},m(h,g){tt(h,i,g),tt(h,s,g),p&&p.m(h,g),tt(h,l,g),c||(d=[Mt(i,"nudge",u),Ui(Ts.call(null,i,{preventDefault:!0})),Mt(i,"interactionstart",function(){ji(e[9]("start",e[46]))&&e[9]("start",e[46]).apply(this,arguments)}),Mt(i,"interactionupdate",function(){ji(e[9]("move",e[46]))&&e[9]("move",e[46]).apply(this,arguments)}),Mt(i,"interactionend",function(){ji(e[9]("end",e[46]))&&e[9]("end",e[46]).apply(this,arguments)}),Ui(Cs.call(null,i,{observeKeys:!0}))],c=!0)},p(h,g){e=h,8&g[0]&&n!==(n=`Drag ${e[51]} ${e[45]}`)&&w(i,"aria-label",n),8&g[0]&&r!==(r=e[51]==="edge"?-1:0)&&w(i,"tabindex",r),8&g[0]&&o!==(o=e[51])&&w(i,"data-control",o),56&g[0]&&a!==(a=`cursor:${e[49]?e[49]+"-resize":"move"};opacity:${e[4]};--tx:${e[47].x};--ty:${e[47].y};--r:${e[51]==="edge"?e[12]:0}rad;--sx:${e[51]==="point"?e[5]:e[48].x};--sy:${e[51]==="point"?e[5]:e[48].y};`)&&w(i,"style",a),e[51]==="edge"&&e[2]?p?p.p(e,g):(p=of(e),p.c(),p.m(l.parentNode,l)):p&&(p.d(1),p=null)},d(h){h&&Q(i),h&&Q(s),p&&p.d(h),h&&Q(l),c=!1,_i(d)}}}function sf(t){let e,i,n,r;return{c(){e=pt("div"),w(e,"role","button"),w(e,"aria-label","Drag rotator"),w(e,"tabindex","0"),w(e,"class","PinturaShapeManipulator"),w(e,"data-control","rotate"),w(e,"style",i=`transform: translate3d(${t[0].x}px, ${t[0].y}px, 0) scale(${t[5]}, ${t[5]}); opacity: ${t[4]}`)},m(o,a){tt(o,e,a),n||(r=[Mt(e,"nudge",t[11]),Ui(Ts.call(null,e,{preventDefault:!0})),Mt(e,"interactionstart",t[12]("start")),Mt(e,"interactionupdate",t[12]("move")),Mt(e,"interactionend",t[12]("end")),Ui(Cs.call(null,e,{observeKeys:!0}))],n=!0)},p(o,a){49&a[0]&&i!==(i=`transform: translate3d(${o[0].x}px, ${o[0].y}px, 0) scale(${o[5]}, ${o[5]}); opacity: ${o[4]}`)&&w(e,"style",i)},d(o){o&&Q(e),n=!1,_i(r)}}}function mS(t){let e,i,n=[],r=new Map,o=t[3];const a=l=>l[45];for(let l=0;l<o.length;l+=1){let c=rf(t,o,l),d=a(c);r.set(d,n[l]=af(d,c))}let s=t[1]&&sf(t);return{c(){for(let l=0;l<n.length;l+=1)n[l].c();e=de(),s&&s.c(),i=Tn()},m(l,c){for(let d=0;d<n.length;d+=1)n[d].m(l,c);tt(l,e,c),s&&s.m(l,c),tt(l,i,c)},p(l,c){1592&c[0]&&(o=l[3],n=Aa(n,c,a,1,l,o,r,e.parentNode,Wy,af,e,rf)),l[1]?s?s.p(l,c):(s=sf(l),s.c(),s.m(i.parentNode,i)):s&&(s.d(1),s=null)},i:Qe,o:Qe,d(l){for(let c=0;c<n.length;c+=1)n[c].d(l);l&&Q(e),s&&s.d(l),l&&Q(i)}}}function $S(t,e,i){let n,r,o,a;const s=Sa(),l=.5*ta,c=Vo-l,d=Vo+l,u=-Vo,p=u-l,h=u+l,g=K1-l,m=-K1+l,f=l,x=-l,k=Vo-ta,v=k-l,C=k+l,P=K1-ta,I=P-l,O=P+l,T=u-ta,L=T+l,F=T-l,B=u+ta,y=B+l,V=B-l;let{visible:J=!1}=e,{points:S=[]}=e,{rotatorPoint:H}=e,{enableDragEdges:K=!0}=e,{enableDragPoints:ut=!0}=e,{enableRotatePoints:lt=!0}=e;const N=sn("isAnimated");A(t,N,et=>i(16,r=et));const ft=ai(.5,{precision:1e-4,stiffness:.3,damping:.7});A(t,ft,et=>i(5,a=et));const $t=ai(0,{precision:.001,stiffness:.3,damping:.7});A(t,$t,et=>i(4,o=et));const Lt=et=>{let ht="";return(et<=d&&et>=c||et>=p&&et<=h)&&(ht="ns"),(et<=m||et>=g||et>=x&&et<=f)&&(ht="ew"),(et>=I&&et<=O||et<=y&&et>=V)&&(ht="nesw"),(et>=v&&et<=C||et<=L&&et>=F)&&(ht="nwse"),ht},ct=(et,ht)=>{s("resizestart",{indexes:et,translation:Qi()}),s("resizemove",{indexes:et,translation:ht}),s("resizeend",{indexes:et,translation:Qi()})};return t.$$set=et=>{"visible"in et&&i(2,J=et.visible),"points"in et&&i(13,S=et.points),"rotatorPoint"in et&&i(0,H=et.rotatorPoint),"enableDragEdges"in et&&i(14,K=et.enableDragEdges),"enableDragPoints"in et&&i(15,ut=et.enableDragPoints),"enableRotatePoints"in et&&i(1,lt=et.enableRotatePoints)},t.$$.update=()=>{65540&t.$$.dirty[0]&&ft.set(J?1:.5,{hard:r===!1}),65540&t.$$.dirty[0]&&$t.set(J?1:0,{hard:r===!1}),8192&t.$$.dirty[0]&&i(3,n=((et,ht)=>{let Y=0;const Z=Oo(et),St=[],nt=et.length;for(;Y<nt;Y++){const mt=hu(Y-1,et),Ft=hu(Y+1,et),oe=et[mt],Rt=et[Y],Ut=et[Ft],Ot=Math.atan2(Ut.y-Rt.y,Ut.x-Rt.x);if(ut){const wt=ro(rt(oe.x-Rt.x,oe.y-Rt.y)),yt=ro(rt(Ut.x-Rt.x,Ut.y-Rt.y)),Gt=rt(wt.x+yt.x,wt.y+yt.y),ue=K?ut&&Lt(Math.atan2(Gt.y,Gt.x)):void 0;St.push({index:[Y],key:"point-"+Y,type:"point",scale:{x:1,y:1},translate:{x:Rt.x,y:Rt.y},angle:void 0,rotate:lt,center:Rt,dir:ue})}if(!K||Array.isArray(K)&&!K.some(([wt,yt])=>Y===wt&&Ft===yt))continue;const j=rt(Rt.x+.5*(Ut.x-Rt.x),Rt.y+.5*(Ut.y-Rt.y));St.push({index:[Y,Ft],key:"edge-"+Y,type:"edge",scale:{x:ho(Rt,Ut),y:1},translate:{x:Rt.x,y:Rt.y},angle:Ot,rotate:Ot,center:j,visible:Array.isArray(K),dir:Lt(Math.atan2(Z.y-j.y,Z.x-j.x))})}return St})(S))},[H,lt,J,n,o,a,N,ft,$t,(et,ht)=>({detail:Y})=>{const Z=Y&&Y.translation?Y.translation:rt(0,0);s("resize"+et,{...Y,indexes:ht,translation:Z})},ct,({detail:et})=>{s("rotatestart",{translation:Qi()}),s("rotatemove",{translation:et}),s("rotateend",{translation:Qi()})},et=>({detail:ht})=>{const Y=ht&&ht.translation?ht.translation:rt(0,0);s("rotate"+et,{...ht,translation:Y})},S,K,ut,r,(et,{detail:ht})=>ct(et,ht)]}class gS extends li{constructor(e){super(),si(this,e,$S,mS,ei,{visible:2,points:13,rotatorPoint:0,enableDragEdges:14,enableDragPoints:15,enableRotatePoints:1},null,[-1,-1])}}var eh=(t,e)=>{const i=Nh(t);return Dn(i,e)},jd=t=>document.createTextNode(t),O2=t=>(Ia()&&t.endsWith("<div><br></div>")?t.replace(/<div><br><\/div>$/,"<br><br>"):t).replace(/<div><br><\/div>/g,"<br>").replace(/<\/div>/g,"").replace(/<div>/g,"<br>");function lf(t){let e,i;return{c(){e=pt("pre"),w(e,"class","PinturaContentEditable"),w(e,"style",i=t[7]+";position:absolute;z-index:-1;pointer-events:none;")},m(n,r){tt(n,e,r),e.innerHTML=t[0]},p(n,r){1&r[0]&&(e.innerHTML=n[0]),128&r[0]&&i!==(i=n[7]+";position:absolute;z-index:-1;pointer-events:none;")&&w(e,"style",i)},d(n){n&&Q(e)}}}function fS(t){let e,i,n,r,o,a,s=t[8]&&lf(t);return{c(){s&&s.c(),e=de(),i=pt("pre"),w(i,"class","PinturaContentEditable"),w(i,"data-wrap-content",n=t[4]||t[5]?"wrap":"nowrap"),w(i,"contenteditable",""),w(i,"spellcheck",t[1]),w(i,"autocorrect",t[2]),w(i,"autocapitalize",t[3]),w(i,"style",r=t[8]?t[15](t[7]):t[7])},m(l,c){s&&s.m(l,c),tt(l,e,c),tt(l,i,c),t[26](i),o||(a=[Mt(i,"input",t[13]),Mt(i,"compositionend",t[12]),Mt(i,"paste",t[14]),Mt(i,"keydown",t[10]),Mt(i,"keyup",t[11]),Mt(i,"blur",t[9])],o=!0)},p(l,c){l[8]?s?s.p(l,c):(s=lf(l),s.c(),s.m(e.parentNode,e)):s&&(s.d(1),s=null),48&c[0]&&n!==(n=l[4]||l[5]?"wrap":"nowrap")&&w(i,"data-wrap-content",n),2&c[0]&&w(i,"spellcheck",l[1]),4&c[0]&&w(i,"autocorrect",l[2]),8&c[0]&&w(i,"autocapitalize",l[3]),384&c[0]&&r!==(r=l[8]?l[15](l[7]):l[7])&&w(i,"style",r)},i:Qe,o:Qe,d(l){s&&s.d(l),l&&Q(e),l&&Q(i),t[26](null),o=!1,_i(a)}}}function yS(t,e,i){let n,r,{spellcheck:o="false"}=e,{autocorrect:a="off"}=e,{autocapitalize:s="off"}=e,{wrapLines:l=!0}=e,{allowNewline:c=!0}=e,{textFormat:d="text"}=e,{formatInput:u=Xi}=e,{formatPaste:p=Xi}=e,{style:h}=e,{innerHTML:g}=e,{oninput:m=$e}=e,{enableTextStyleShortcuts:f=!1}=e;const x=()=>{if(!v)return;const S=document.createRange();S.selectNodeContents(v);const H=F();H.removeAllRanges(),H.addRange(S)},k=Sa();let v;document.execCommand("defaultParagraphSeparator",!1,"br");const C=S=>S.replace(/<\/?(?:i|b|em|u|s|strike|strong|font)>/,"").replace(/style=".*?"/g,"").replace(/\n/gim,"<br>"),P=()=>{i(0,g=v.innerHTML);const S=O2(g);k("input",S),m(S),requestAnimationFrame(()=>v&&v.scrollTo(0,0))},I=()=>{B(v);const S=d==="html"?v.innerHTML:C(v.innerHTML);i(6,v.innerHTML=u(S),v),y(v),P()},O={b:"bold",i:"italic",u:"underline",s:"strikethrough"},T=S=>{const H=ln("span");return H.dataset.bookmark=S,H},L=(S,H,K)=>{const ut=T(K);if(S.nodeType===Node.TEXT_NODE){const lt=S.textContent;if(K==="start"){const N=jd(lt.substr(0,H)),ft=jd(lt.substr(H));S.replaceWith(N,ut,ft)}else{const N=jd(lt.substr(0,H)),ft=jd(lt.substr(H));S.replaceWith(N,ut,ft)}}else S.nodeType===Node.ELEMENT_NODE&&S.insertBefore(ut,S.childNodes[H])},F=()=>{const S=v.getRootNode();return"getSelection"in S?S.getSelection():document.getSelection()},B=S=>{const H=F();if(!H.getRangeAt||!H.rangeCount)return;const K=H.getRangeAt(0),{startOffset:ut,endOffset:lt,startContainer:N,endContainer:ft}=K;if(S.contains(K.startContainer)&&S.contains(K.endContainer))if(N.nodeType===Node.TEXT_NODE&&N===ft){const $t=N.textContent,Lt=$t.substr(0,ut),ct=T("start"),et=lt-ut>0?$t.substr(ut,lt):"",ht=T("end"),Y=$t.substr(lt);N.replaceWith(Lt,ct,et,ht,Y)}else L(N,ut,"start"),L(ft,lt+(N===ft?1:0),"end")},y=S=>{const H=V(S,"start"),K=V(S,"end");if(!H||!K)return;const ut=document.createRange();ut.setStart(H,0),ut.setEnd(K,0);const lt=F();lt.removeAllRanges(),lt.addRange(ut),H.remove(),K.remove()},V=(S,H)=>{const K=S.children;for(let ut=0;ut<K.length;ut++){const lt=K[ut];if(lt.dataset.bookmark===H)return lt;if(lt.children.length){const N=V(lt,H);if(N)return N}}};let J;return t.$$set=S=>{"spellcheck"in S&&i(1,o=S.spellcheck),"autocorrect"in S&&i(2,a=S.autocorrect),"autocapitalize"in S&&i(3,s=S.autocapitalize),"wrapLines"in S&&i(4,l=S.wrapLines),"allowNewline"in S&&i(5,c=S.allowNewline),"textFormat"in S&&i(16,d=S.textFormat),"formatInput"in S&&i(17,u=S.formatInput),"formatPaste"in S&&i(18,p=S.formatPaste),"style"in S&&i(19,h=S.style),"innerHTML"in S&&i(0,g=S.innerHTML),"oninput"in S&&i(20,m=S.oninput),"enableTextStyleShortcuts"in S&&i(21,f=S.enableTextStyleShortcuts)},t.$$.update=()=>{var S;if(64&t.$$.dirty[0]&&i(25,n=!!v),33554433&t.$$.dirty[0]&&n&&g&&(S=g)!==v.innerHTML&&(i(6,v.innerHTML=S,v),v===document.activeElement&&x()),524336&t.$$.dirty[0])if(!l&&c){const H=h.includes(":right")?"text-indent:-100px!important":h.includes(":center")?"":"min-width:calc(100% + 100px)!important";i(7,J=h+";overflow:visible;"+H)}else i(7,J=h);524288&t.$$.dirty[0]&&i(8,r=h.includes("text-stroke"))},[g,o,a,s,l,c,v,J,r,()=>{k("blur")},S=>{if(/escape/i.test(S.code))return S.stopPropagation(),void k("cancel");const H=S.ctrlKey||S.metaKey;if(d==="html"&&H&&/b|i|u|s/.test(S.key))return f&&(K=>{const ut=O[K];ut&&document.execCommand(ut)})(S.key),void S.preventDefault();/enter/i.test(S.code)&&(S.stopPropagation(),S.isComposing||(H?k("confirm"):(c||S.preventDefault(),document.execCommand("insertLineBreak"),S.preventDefault())))},()=>{},S=>{S.data!==""&&I()},S=>{const{inputType:H}=S;H!=="insertCompositionText"&&H!=="deleteCompositionText"&&I()},S=>{S.preventDefault();const H=S.clipboardData.getData("text/plain"),K=d==="html"?H:C(H),ut=p(K);if(!ut.length)return;const lt=F().getRangeAt(0);lt.deleteContents(),lt.insertNode(document.createTextNode(ut)),P()},S=>S.replace("-webkit-text-stroke","--text-stroke").replace("text-shadow","--text-shadow"),d,u,p,h,m,f,()=>I(),()=>v&&v.focus(),x,n,function(S){zi[S?"unshift":"push"](()=>{v=S,i(6,v)})}]}class xS extends li{constructor(e){super(),si(this,e,yS,fS,ei,{spellcheck:1,autocorrect:2,autocapitalize:3,wrapLines:4,allowNewline:5,textFormat:16,formatInput:17,formatPaste:18,style:19,innerHTML:0,oninput:20,enableTextStyleShortcuts:21,confirm:22,focus:23,select:24},null,[-1,-1])}get spellcheck(){return this.$$.ctx[1]}set spellcheck(e){this.$$set({spellcheck:e}),R()}get autocorrect(){return this.$$.ctx[2]}set autocorrect(e){this.$$set({autocorrect:e}),R()}get autocapitalize(){return this.$$.ctx[3]}set autocapitalize(e){this.$$set({autocapitalize:e}),R()}get wrapLines(){return this.$$.ctx[4]}set wrapLines(e){this.$$set({wrapLines:e}),R()}get allowNewline(){return this.$$.ctx[5]}set allowNewline(e){this.$$set({allowNewline:e}),R()}get textFormat(){return this.$$.ctx[16]}set textFormat(e){this.$$set({textFormat:e}),R()}get formatInput(){return this.$$.ctx[17]}set formatInput(e){this.$$set({formatInput:e}),R()}get formatPaste(){return this.$$.ctx[18]}set formatPaste(e){this.$$set({formatPaste:e}),R()}get style(){return this.$$.ctx[19]}set style(e){this.$$set({style:e}),R()}get innerHTML(){return this.$$.ctx[0]}set innerHTML(e){this.$$set({innerHTML:e}),R()}get oninput(){return this.$$.ctx[20]}set oninput(e){this.$$set({oninput:e}),R()}get enableTextStyleShortcuts(){return this.$$.ctx[21]}set enableTextStyleShortcuts(e){this.$$set({enableTextStyleShortcuts:e}),R()}get confirm(){return this.$$.ctx[22]}get focus(){return this.$$.ctx[23]}get select(){return this.$$.ctx[24]}}const cf=["i","b","u","strike"].map(t=>({tag:t,tagOpen:new RegExp(`<${t}>`,"g"),tagClose:new RegExp(`</${t}>`,"g"),placeholderOpen:new RegExp(`___${t}O___`,"g"),placeholderClose:new RegExp(`___${t}C___`,"g")}));var bS=t=>t=((e,i=cf)=>(i.forEach(({tag:n,placeholderOpen:r,placeholderClose:o})=>{e=e.replace(r,`<${n}>`).replace(o,`</${n}>`)}),e))(t=(t=((e,i=cf)=>(i.forEach(({tag:n,tagOpen:r,tagClose:o})=>{e=e.replace(r,`___${n}O___`).replace(o,`___${n}C___`)}),e))(t)).replace(/ {2,}/g," ").replace(/\u00a0/g,"&nbsp;").split(`
`).join("<br>")),Ud=(t,e)=>Oe(t)?parseFloat(t)/100*e:t,hc=(t,e)=>({x:Vr(t.x,e.width),y:Vr(t.y,e.height)});function df(t,e,i){const n=t.slice();return n[276]=e[i],n[278]=i,n}function uf(t,e){let i,n,r,o,a,s,l,c,d,u,p,h=e[276].name+"";function g(){return e[180](e[278])}return r=new Vh({props:{color:e[276].color}}),{key:t,first:null,c(){i=pt("li"),n=pt("button"),At(r.$$.fragment),o=de(),a=pt("span"),s=cn(h),c=de(),w(n,"class","PinturaShapeListItem"),w(n,"type","button"),w(n,"aria-label",l="Select shape "+e[276].name),this.first=i},m(m,f){tt(m,i,f),Tt(i,n),It(r,n,null),Tt(n,o),Tt(n,a),Tt(a,s),Tt(i,c),d=!0,u||(p=Mt(n,"click",g),u=!0)},p(m,f){e=m;const x={};1048576&f[0]&&(x.color=e[276].color),r.$set(x),(!d||1048576&f[0])&&h!==(h=e[276].name+"")&&An(s,h),(!d||1048576&f[0]&&l!==(l="Select shape "+e[276].name))&&w(n,"aria-label",l)},i(m){d||(M(r.$$.fragment,m),d=!0)},o(m){D(r.$$.fragment,m),d=!1},d(m){m&&Q(i),Et(r),u=!1,p()}}}function pf(t){let e,i;return e=new gS({props:{visible:!0,points:t[12],rotatorPoint:t[26],enableDragEdges:t[16],enableDragPoints:t[28],enableRotatePoints:t[14]}}),e.$on("resizestart",t[37]),e.$on("resizemove",t[38]),e.$on("resizeend",t[39]),e.$on("rotatestart",t[40]),e.$on("rotatemove",t[41]),e.$on("rotateend",t[42]),{c(){At(e.$$.fragment)},m(n,r){It(e,n,r),i=!0},p(n,r){const o={};4096&r[0]&&(o.points=n[12]),67108864&r[0]&&(o.rotatorPoint=n[26]),65536&r[0]&&(o.enableDragEdges=n[16]),268435456&r[0]&&(o.enableDragPoints=n[28]),16384&r[0]&&(o.enableRotatePoints=n[14]),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){D(e.$$.fragment,n),i=!1},d(n){Et(e,n)}}}function hf(t){let e,i,n,r;const o=[wS,vS],a=[];function s(l,c){return l[4]==="modal"?0:l[4]==="inline"?1:-1}return~(e=s(t))&&(i=a[e]=o[e](t)),{c(){i&&i.c(),n=Tn()},m(l,c){~e&&a[e].m(l,c),tt(l,n,c),r=!0},p(l,c){let d=e;e=s(l),e===d?~e&&a[e].p(l,c):(i&&(Fe(),D(a[d],1,1,()=>{a[d]=null}),De()),~e?(i=a[e],i?i.p(l,c):(i=a[e]=o[e](l),i.c()),M(i,1),i.m(n.parentNode,n)):i=null)},i(l){r||(M(i),r=!0)},o(l){D(i),r=!1},d(l){~e&&a[e].d(l),l&&Q(n)}}}function vS(t){let e,i,n,r,o,a={formatInput:t[44],wrapLines:!!t[13].width,textFormat:t[13].format,enableTextStyleShortcuts:t[5],allowNewline:t[27],style:t[25]};return i=new xS({props:a}),t[183](i),i.$on("input",t[45]),i.$on("keyup",t[48]),i.$on("cancel",t[50]),i.$on("confirm",t[49]),{c(){e=pt("div"),At(i.$$.fragment),w(e,"class","PinturaInlineInput"),w(e,"style",t[24])},m(s,l){tt(s,e,l),It(i,e,null),n=!0,r||(o=Mt(e,"focusout",t[184]),r=!0)},p(s,l){const c={};8192&l[0]&&(c.wrapLines=!!s[13].width),8192&l[0]&&(c.textFormat=s[13].format),32&l[0]&&(c.enableTextStyleShortcuts=s[5]),134217728&l[0]&&(c.allowNewline=s[27]),33554432&l[0]&&(c.style=s[25]),i.$set(c),(!n||16777216&l[0])&&w(e,"style",s[24])},i(s){n||(M(i.$$.fragment,s),n=!0)},o(s){D(i.$$.fragment,s),n=!1},d(s){s&&Q(e),t[183](null),Et(i),r=!1,o()}}}function wS(t){let e,i;return e=new v2({props:{panelOffset:t[2],onconfirm:t[49],oncancel:t[50],buttonCancel:{icon:t[6].shapeIconInputCancel,label:t[6].shapeLabelInputCancel},buttonConfirm:{icon:t[6].shapeLabelInputConfirm,label:t[6].shapeIconInputConfirm,hideLabel:!0},$$slots:{default:[SS]},$$scope:{ctx:t}}}),{c(){At(e.$$.fragment)},m(n,r){It(e,n,r),i=!0},p(n,r){const o={};4&r[0]&&(o.panelOffset=n[2]),64&r[0]&&(o.buttonCancel={icon:n[6].shapeIconInputCancel,label:n[6].shapeLabelInputCancel}),64&r[0]&&(o.buttonConfirm={icon:n[6].shapeLabelInputConfirm,label:n[6].shapeIconInputConfirm,hideLabel:!0}),41943296&r[0]|1&r[9]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){D(e.$$.fragment,n),i=!1},d(n){Et(e,n)}}}function SS(t){let e,i,n;return{c(){e=pt("textarea"),w(e,"spellcheck","false"),w(e,"autocorrect","off"),w(e,"autocapitalize","off"),w(e,"style",t[25])},m(r,o){tt(r,e,o),t[181](e),Nm(e,t[23]),i||(n=[Mt(e,"keydown",t[47]),Mt(e,"keypress",t[46]),Mt(e,"keyup",t[48]),Mt(e,"input",t[45]),Mt(e,"input",t[182])],i=!0)},p(r,o){33554432&o[0]&&w(e,"style",r[25]),8388608&o[0]&&Nm(e,r[23])},d(r){r&&Q(e),t[181](null),i=!1,_i(n)}}}function mf(t){let e,i,n,r,o;return i=new $o({props:{items:t[21],key:t[10]}}),{c(){e=pt("div"),At(i.$$.fragment),w(e,"class","PinturaShapeControls"),w(e,"style",t[22])},m(a,s){tt(a,e,s),It(i,e,null),n=!0,r||(o=[Mt(e,"measure",t[185]),Ui(Mr.call(null,e))],r=!0)},p(a,s){const l={};2097152&s[0]&&(l.items=a[21]),1024&s[0]&&(l.key=a[10]),i.$set(l),(!n||4194304&s[0])&&w(e,"style",a[22])},i(a){n||(M(i.$$.fragment,a),n=!0)},o(a){D(i.$$.fragment,a),n=!1},d(a){a&&Q(e),Et(i),r=!1,_i(o)}}}function kS(t){let e,i,n,r,o,a,s,l,c,d,u=[],p=new Map,h=t[20];const g=k=>k[276].id;for(let k=0;k<h.length;k+=1){let v=df(t,h,k),C=g(v);p.set(C,u[k]=uf(C,v))}let m=t[15]&&pf(t),f=t[11]&&hf(t),x=t[17]>0&&mf(t);return{c(){e=pt("div"),i=pt("nav"),n=pt("ul");for(let k=0;k<u.length;k+=1)u[k].c();r=de(),m&&m.c(),o=de(),f&&f.c(),a=de(),x&&x.c(),w(i,"class","PinturaShapeList"),w(i,"data-visible",t[18]),w(e,"class","PinturaShapeEditor"),w(e,"tabindex","0")},m(k,v){tt(k,e,v),Tt(e,i),Tt(i,n);for(let C=0;C<u.length;C+=1)u[C].m(n,null);Tt(e,r),m&&m.m(e,null),Tt(e,o),f&&f.m(e,null),Tt(e,a),x&&x.m(e,null),t[186](e),l=!0,c||(d=[Mt(i,"focusin",t[53]),Mt(i,"focusout",t[54]),Mt(e,"keydown",function(){ji(t[0]?$e:t[43])&&(t[0]?$e:t[43]).apply(this,arguments)}),Mt(e,"nudge",function(){ji(t[0]?$e:t[52])&&(t[0]?$e:t[52]).apply(this,arguments)}),Mt(e,"measure",t[179]),Mt(e,"pointermove",function(){ji(t[0]?$e:t[55])&&(t[0]?$e:t[55]).apply(this,arguments)}),Mt(e,"pointerleave",function(){ji(t[0]?$e:t[56])&&(t[0]?$e:t[56]).apply(this,arguments)}),Mt(e,"interactionstart",function(){ji(t[0]?$e:t[31])&&(t[0]?$e:t[31]).apply(this,arguments)}),Mt(e,"interactionupdate",function(){ji(t[0]?$e:t[33])&&(t[0]?$e:t[33]).apply(this,arguments)}),Mt(e,"interactioncancel",function(){ji(t[0]?$e:t[32])&&(t[0]?$e:t[32]).apply(this,arguments)}),Mt(e,"interactionrelease",function(){ji(t[0]?$e:t[34])&&(t[0]?$e:t[34]).apply(this,arguments)}),Mt(e,"interactionend",function(){ji(t[0]?$e:t[35])&&(t[0]?$e:t[35]).apply(this,arguments)}),Ui(Mr.call(null,e)),Ui(Ts.call(null,e)),Ui(s=Cs.call(null,e,{drag:!0,inertia:!0,multiTouch:!1,observeKeys:!0,shouldStartInteraction:$f,getEventPosition:t[187]}))],c=!0)},p(k,v){t=k,1048706&v[0]&&(h=t[20],Fe(),u=Aa(u,v,g,1,t,h,p,n,Ss,uf,null,df),De()),(!l||262144&v[0])&&w(i,"data-visible",t[18]),t[15]?m?(m.p(t,v),32768&v[0]&&M(m,1)):(m=pf(t),m.c(),M(m,1),m.m(e,o)):m&&(Fe(),D(m,1,1,()=>{m=null}),De()),t[11]?f?(f.p(t,v),2048&v[0]&&M(f,1)):(f=hf(t),f.c(),M(f,1),f.m(e,a)):f&&(Fe(),D(f,1,1,()=>{f=null}),De()),t[17]>0?x?(x.p(t,v),131072&v[0]&&M(x,1)):(x=mf(t),x.c(),M(x,1),x.m(e,null)):x&&(Fe(),D(x,1,1,()=>{x=null}),De()),s&&ji(s.update)&&8&v[0]&&s.update.call(null,{drag:!0,inertia:!0,multiTouch:!1,observeKeys:!0,shouldStartInteraction:$f,getEventPosition:t[187]})},i(k){if(!l){for(let v=0;v<h.length;v+=1)M(u[v]);M(m),M(f),M(x),l=!0}},o(k){for(let v=0;v<u.length;v+=1)D(u[v]);D(m),D(f),D(x),l=!1},d(k){k&&Q(e);for(let v=0;v<u.length;v+=1)u[v].d();m&&m.d(),f&&f.d(),x&&x.d(),t[186](null),c=!1,_i(d)}}}const $f=(t,e)=>t.target===e;function CS(t,e,i){let n,r,o,a,s,l,c,d,u,p,h,g,m,f,x,k,v,C,P,I,O,T,L,F,B,y,V,J,S,H,K,ut,lt,N,ft,$t,Lt,ct,et,ht,Y,Z,St,nt,mt,Ft,oe,Rt,Ut,Ot,j,wt,yt,Gt,ue=Qe,pe=()=>(ue(),ue=Nr(we,b=>i(175,Ot=b)),we);t.$$.on_destroy.push(()=>ue());let{uid:ve=ra()}=e,{ui:ge}=e,{disabled:_=!1}=e,{shapes:we}=e;pe();let{selection:gi}=e,{offset:xe}=e,{contextRotation:_t=0}=e,{contextFlipX:Te=!1}=e,{contextFlipY:Ie=!1}=e,{contextZoom:He=1}=e,{active:vi=!1}=e,{opacity:vt=1}=e,{parentRect:bt}=e,{rootRect:Ze}=e,{utilRect:Pe}=e,{hoverColor:ri}=e,{caretColor:Ge}=e,{gridColor:ii}=e,{snapColor:wi}=e,{textInputMode:pi="inline"}=e,{oninteractionstart:Fi=$e}=e,{oninteractionupdate:X=$e}=e,{oninteractionrelease:jt=$e}=e,{oninteractionend:U=$e}=e,{oninteractioncancel:Bt=$e}=e,{onaddshape:ye=$e}=e,{onupdateshape:Qt=$e}=e,{onselectshape:se=$e}=e,{onblurshape:zt=$e}=e,{onremoveshape:We=$e}=e,{ontapshape:Ae=$e}=e,{onhovershape:je=$e}=e,{onhovercanvas:Ke=$e}=e,{ontapcanvas:it=$e}=e,{onleavecanvas:Xt=$e}=e,{beforeSelectShape:Nt=()=>!0}=e,{beforeDeselectShape:Zt=()=>!0}=e,{beforeRemoveShape:Yt=()=>!0}=e,{beforeUpdateShape:ot=(b,G)=>G}=e,{willRenderShapeControls:he=Xi}=e,{willRenderShapeTextControls:ie=Xi}=e,{willStartInteraction:fe=(b,G)=>!0}=e,{mapEditorPointToImagePoint:Dt}=e,{mapImagePointToEditorPoint:ke}=e,{eraseRadius:fi}=e,{selectRadius:hi}=e,{enableButtonFlipVertical:Be=!1}=e,{enableTapToAddText:yi=!0}=e,{enableTextStyleControls:Pi=!0}=e,{locale:be}=e,{snapThreshold:me=0}=e,{snapPointer:Ee=!0}=e,{enableSnapToContext:an=!0}=e,{gridSize:Gi=0}=e;const fn=b=>{if(me===0)return[];let G;return an&&(G={...bt,x:0,y:0}),[...Ot.filter(z=>z!==b).filter(z=>!So(z)).map(z=>Un({...z},bt)),G].filter(Boolean)},hn=(b,G,z,st)=>b===0?{snapTargets:[]}:{snapThreshold:b,gridSize:G,gridRect:z,snapTargets:fn(st)},mn=sn("isAnimated");A(t,mn,b=>i(176,wt=b));const en=b=>b.set(xa(b)),qi=b=>xa(b).find(So),Ln=(b,G)=>{if(!qi(G))return Fp(b),Hn(b,G)},Gn=b=>{qi(b)&&b.update(G=>G.filter(z=>!So(z)))},Nn=b=>{const G=qi(b);if(G)return Rm(G),en(b),G},gr=(b,G,z=(st,dt)=>({...st,...dt}))=>{qi(G)&&G.update(st=>st.map(dt=>So(dt)?z(dt,b):dt))},Hn=(b,G=we)=>(G.update(z=>[...z,b]),b),bn=(b,G,z)=>{const st=ot({...b},G,{...z});return ya(b,st,z),b},On=(b,G)=>{const z=ho(b,G),st=Rd(b,G),dt=Math.PI/8,Vt=dt*Math.round(st/dt)-_t%dt;G.x=b.x+z*Math.cos(Vt),G.y=b.y+z*Math.sin(Vt)},Wn=sn("keysPressed");A(t,Wn,b=>i(177,yt=b));const Ri=(b,G,z)=>b===0||G&&z?b:G||z?-b:b,oo=b=>{if(b.x===null&&b.y===null)return zn();b.x&&i(138,go=Dt({x:b.x,y:0}).x),b.y&&i(139,ao=Dt({x:0,y:b.y}).y)},zn=()=>{i(138,go=null),i(139,ao=null)};let go=null,ao=null;const Pr=(b,G)=>{const z=ke(b);return Dt(Fn(z,G))},fr=(b,G,z)=>{const st=(z-G)/b+1;return Array.from({length:st},(dt,Vt)=>G+Vt*b)},Mn=b=>{let G=[],z=[],st=b.points;if(b.x1!==void 0&&(st=[{x:b.x1,y:b.y1},{x:b.x2,y:b.y2}]),st){const dt=st.map(ke),Vt=rr(dt),Pt=dt[0],te=dt[dt.length-1];G=[Vt.x,Vt.x+.5*Vt.width,Vt.x+Vt.width,Pt.x,te.x],z=[Vt.y,Vt.y+.5*Vt.height,Vt.y+Vt.height,Pt.y,te.y]}else if(b.text||b.width!==void 0||b.rx!==void 0){let dt;if(b.text&&b.height===void 0){const ee=Jo(b.text,b);dt=In(b.x,b.y,ee.width,ee.height)}else dt=b.width!==void 0?ls(b):ls({x:b.x-b.rx,y:b.y-b.ry,width:2*b.rx,height:2*b.ry});const Vt=_o(dt).map(ke),Pt=Math.abs(b.rotation)>0?Sr(dt,b.rotation).map(ke):Vt,te=rr(Pt),Wt=Ti(te),Ht=.5*te.width,re=.5*te.height;G=[Wt.x-Ht,Wt.x,Wt.x+Ht],z=[Wt.y-re,Wt.y,Wt.y+re]}else if(b.x!==void 0){const dt=ke(b);G=[dt.x],z=[dt.y]}return{x:G,y:z}},Ki=(b,G,z)=>{let st,dt,Vt,Pt=Number.Infinity,te=null,Wt=null;for(let Ht=0;Ht<b.length;Ht++){dt=b[Ht];for(let re=0;re<G.length;re++)Vt=G[re],st=Math.abs(dt-Vt),st<z&&(Wt===null||st<Pt)&&(Pt=st,te=dt,Wt=Vt)}return{origin:te,target:Wt}},Ur=(b,G,z,st,dt)=>{const Vt={x:null,y:null},Pt={x:null,y:null},te=G.map(Mn);if(st>0){const Wt=ke({x:0,y:0}),Ht=ke({x:st,y:st}),re=ke({x:dt.width,y:dt.height}),ee=Ht.x-Wt.x,Ne=fr(ee,Wt.x,re.x),ae=fr(ee,Wt.y,re.y);te.push({x:Ne,y:ae})}return te.forEach(Wt=>{const{snapTranslation:Ht,snapLine:re}=((ee,Ne,ae)=>{const Me={x:null,y:null},Ce={x:null,y:null},Jt=Ki(ee.x,Ne.x,ae);Jt.target!==null&&(Me.x=Jt.target,Ce.x=Jt.target-Jt.origin);const Le=Ki(ee.y,Ne.y,ae);return Le.target!==null&&(Me.y=Le.target,Ce.y=Le.target-Le.origin),{snapTranslation:Ce,snapLine:Me}})(b,Wt,z);Ht.x!==null&&(Pt.x===null||Math.abs(Ht.x)<Math.abs(Pt.x))&&(Pt.x=Ht.x||0,Vt.x=re.x),Ht.y!==null&&(Pt.y===null||Math.abs(Ht.y)<Math.abs(Pt.y))&&(Pt.y=Ht.y||0,Vt.y=re.y)}),{snapTranslation:Pt,snapLines:Vt}},Qr=(b,G)=>(G.x!==null&&(b.x+=G.x),G.y!==null&&(b.y+=G.y),b),fo=(b,G,z,st)=>{const{snapThreshold:dt=0,gridSize:Vt=0,gridRect:Pt,snapTargets:te=[]}=st||{};let Wt=null;if(nr(b)){if(dt){const ee=Un({...b},bt),Ne=Pr(Ga(G),z),ae=Pr(Za(G),z),Me=Mn({...ee,x1:Ne.x,y1:Ne.y,x2:ae.x,y2:ae.y}),{snapTranslation:Ce,snapLines:Jt}=Ur(Me,te,dt,Vt,Pt);Qr(z,Ce),oo(Jt)}const Ht=Pr(Ga(G),z),re=Pr(Za(G),z);Wt={x1:Ht.x,y1:Ht.y,x2:re.x,y2:re.y}}else if(b.points){if(dt){const Ht=Un({...b},bt),re=Mn({...Ht,points:G.points.map(ae=>Pr(ae,z))}),{snapTranslation:ee,snapLines:Ne}=Ur(re,te,dt,Vt,Pt);Qr(z,ee),oo(Ne)}Wt={points:G.points.map(Ht=>Pr(Ht,z))}}else if(ko(b)||qn(b)||Kn(b)){if(dt){const Ht=Un({...b},bt),re=Pr(G,z),ee=Mn({...Ht,...re}),{snapTranslation:Ne,snapLines:ae}=Ur(ee,te,dt,Vt,Pt);Qr(z,Ne),oo(ae)}Wt=Pr(G,z)}Wt&&(bn(b,Wt,bt),yr())},yo={0:1,1:0,2:3,3:2},Po={0:3,1:2,2:1,3:0};let so;const lo=()=>{if(Ot.length)return Ot.find(So)},xo=()=>{if(Ot.length)return Ot.findIndex(So)},bo=()=>{const b=lo();if(b)return Rm(b),yr(),b},Fr=()=>{if(!lo())return;const b=[...Ot];b.splice(xo(),1),we.set(b)},yr=()=>{we.set(Ot)},to=(b,G=[],z=!0)=>{G.filter(Boolean).forEach(st=>delete b[st]),z&&yr()},dn=(b,G,z=!0)=>{b=Object.assign(b,G),z&&yr()},Qn=(b,G,z,st=!0)=>{b[G]=z,st&&yr()},vo=(b,G=!0)=>{Ot.forEach(z=>dn(z,b,!1)),G&&yr()},Dr=()=>[...Ot].reverse().find(cs),ki=()=>!!Dr(),Pn=b=>{if(!Yt(b))return!1;we.set(Ot.filter(G=>G!==b)),We(b)},Zn=()=>{const b=Dr();if(!b)return;const G=Ot.filter(dt=>Im(dt)&&$a(dt)),z=G.findIndex(dt=>dt===b);if(Pn(b)===!1)return;if($n=b,G.length-1<=0)return eo();const st=z-1<0?G.length-1:z-1;un(G[st])};let $n;const eo=(b={})=>{const{storePrevious:G=!0}=b;Object.keys(po).forEach(st=>po[st]={});const z=Gr();G&&($n=z),vo({isSelected:!1,isEditing:!1,_prerender:!1}),z&&zt(z)},Gr=()=>Ot.find(cs),un=(b,G=!0)=>{if(So(b))return;const z=Gr()||$n,st=cs(b);$n=void 0,Nt(z,b)&&(eo(),(dt=>{dt.isSelected=!0})(b),!st&&se(b),G&&yr())},Zr=b=>{qe&&qe.confirm&&b.isEditing&&qe.confirm(),dn(b,{isSelected:!1,isEditing:!1,_prerender:!1}),zt(b)},ur=b=>{dn(b,{isSelected:!0,isEditing:!0,_prerender:pi==="inline"})},co=b=>{dn(b,{isSelected:!0,isEditing:!1,_prerender:!1})},pr=b=>{if(!b.length)return[];const G=b.filter(Yt);return we.set(Ot.filter(z=>!G.includes(z))),G},jn=b=>{const G=Jo(b.text,b);return In(b.x,b.y,b.width?Math.min(b.width,G.width):G.width,b.height?Math.min(b.height,G.height):G.height)},uo=b=>{if(Ks(b))return ls(b);if(Kn(b))return J1(b);const G=jn(b);return G.width=Math.max(10,b.width||G.width),G},xr=(b,G,z=0,st=()=>!0)=>[...b].reverse().filter(st).map(dt=>({shape:dt,priority:1})).filter(dt=>{const{shape:Vt}=dt,Pt=Un(_n(Vt),bt),te=z+.5*(Pt.strokeWidth||0);if(ko(Pt))return Q1(G,te,Pt,Vt.rotation);if(qn(Pt)){const Wt=uo(Pt),Ht=Q1(G,te,Wt,Vt.rotation);let re=!1;if(Ht&&!cs(Vt)){const ee=jn(Pt);Vt.textAlign!=="right"||Vt.flipX||(ee.x=Wt.x+Wt.width-ee.width),Vt.textAlign==="center"&&(ee.x=Wt.x+.5*Wt.width-.5*ee.width),re=Q1(G,te,ee,Vt.rotation,Ti(Wt)),re||(dt.priority=-1)}return Ht}return Kn(Pt)?((Wt,Ht,re,ee,Ne,ae)=>{const Me=ru(rt(re.x,re.y),re.rx,re.ry,ee,Ne,ae,12);return zp(Wt,Ht,Me)})(G,te,Pt,Vt.rotation,Vt.flipX,Vt.flipY):nr(Pt)?uh(G,Math.max(16,te),Ga(Pt),Za(Pt)):Yn(Pt)&&Pt.pathClose?zp(G,te,Pt.points):!!Yn(Pt)&&(Pt.points.length===1?Bo(G,Pt.points[0])<te*te:ey(G,Math.max(16,te),Pt.points))}).sort((dt,Vt)=>dt.priority<Vt.priority?1:dt.priority>Vt.priority?-1:0).map(dt=>dt.shape),io=(b,G,z,st=0)=>{const dt=Math.abs(st),Vt=vs(G,z),Pt=ch(Vt,dt),te=(({start:Wt,end:Ht},re)=>{if(re===0)return[rt(Wt.x,Wt.y),rt(Wt.x,Wt.y),rt(Ht.x,Ht.y),rt(Ht.x,Ht.y)];const ee=Math.atan2(Ht.y-Wt.y,Ht.x-Wt.x),Ne=Math.sin(ee)*re,ae=Math.cos(ee)*re;return[rt(Ne+Wt.x,-ae+Wt.y),rt(-Ne+Wt.x,ae+Wt.y),rt(-Ne+Ht.x,ae+Ht.y),rt(Ne+Ht.x,-ae+Ht.y)]})(Pt,dt);return b.filter(Wt=>{const Ht=Un(_n(Wt),bt);if(nr(Ht)||Yn(Ht)){const re=Ht.points?[...Ht.points]:[Ga(Ht),Za(Ht)];return!!Jf(Pt,re)}return((re,ee)=>!!re.find(Ne=>Lp(Ne,ee))||!!ee.find(Ne=>Lp(Ne,re)))(te,((re,ee=12)=>{if(ko(re))return Sr(re,re.rotation,Ti(re));if(qn(re)){const Ne=uo(re);return Sr(Ne,re.rotation,Ti(Ne))}return Kn(re)?ru(rt(re.x,re.y),re.rx,re.ry,re.rotation,re.flipX,re.flipY,ee):[]})(Ht))})};let Xr,Bn,vn,ci,W,ne,Ai=!1,oi=!1,Kt=!1;const Se=()=>{clearTimeout(Bn),Bn=void 0,i(141,Kt=!1),zn()};let Li=null;const Vi=b=>{const G=xi(b.rotation)&&b.rotation!==0;if(ko(b)){if(b.width<1&&b.height<1)return;const z=Ti(b),st=_o(b);return(b.flipX||b.flipY)&&Ml(st,b.flipX,b.flipY,z.x,z.y),G?tl(st,b.rotation,z.x,z.y):st}if(Kn(b)){if(b.rx<1&&b.ry<1)return;const z=b,st=_o(J1(b));return(b.flipX||b.flipY)&&Ml(st,b.flipX,b.flipY,z.x,z.y),G?tl(st,b.rotation,z.x,z.y):st}if(nr(b))return[Ga(b),Za(b)];if(Yn(b)){if(b.bitmap&&!b.pathClose){const z=rr(b.points);return z.x-=.5*b.strokeWidth,z.y-=.5*b.strokeWidth,z.width+=b.strokeWidth,z.height+=b.strokeWidth,Vi({...b,...z})}return[...b.points]}if(qn(b)){if(b.width<5&&b.height<5)return;const z=uo(b);z.width=Math.max(10,z.width);const st=Ti(z),dt=_o(z);return(b.flipX||b.flipY)&&Ml(dt,b.flipX,b.flipY,st.x,st.y),G?tl(dt,b.rotation,st.x,st.y):dt}return[]},pn=b=>{const G=Vi(b);let z,st;return b.flipY?(z=Oo([G[0],G[1]]),st=ro(rt(G[1].x-G[2].x,G[1].y-G[2].y))):(z=Oo([G[2],G[3]]),st=ro(rt(G[2].x-G[1].x,G[2].y-G[1].y))),Ar(st,20/He),{origin:z,dir:st}},nn=b=>G=>G.id===b,Bi=b=>{const G=nn(b);return z=>z.filter((st=>dt=>!st(dt))(G))},Br=b=>{const G=nn(b),z=Bi(b);return()=>ge.update(st=>st.some(G)?z(st):st)},Ho=b=>{const G=Bi(b);return(...z)=>{ge.update(st=>[...G(st),...z.filter(Boolean)])}},La=Br("markup-hover"),jo=Ho("markup-hover");let br;const Rr="markup-manipulator-segment-"+ve,Ro=(b,G)=>{const z=b[G],st=G-1<0?b[b.length-1]:b[G-1],dt=G+1<b.length?b[G+1]:b[0],Vt=Dn(_e(st),z);ro(Vt);const Pt=Fn(Ar(Vt,10),z),te=Dn(_e(dt),z);return ro(te),[Pt,z,Fn(Ar(te,10),z)]},Io=Br(Rr),Eo=Ho(Rr),E=(b,G)=>{if(me<=0)return b;if(G)return zn(),b;const z=Dt(b),st=fn(),{snapTranslation:dt,snapLines:Vt}=Ur(Mn(z),st,me,Gi,n);return oo(Vt),Qr(b,dt),b},Re=ai(0);A(t,Re,b=>i(178,Gt=b));const Ve="markup-grid-line-"+ve,Mi=Br(Ve),Ni=Ho(Ve),Ii="markup-snap-line",Je=Br(Ii),bi=Ho(Ii);let qe;const Di=b=>{i(8,qe.innerHTML=bS(b),qe)},gn=b=>{const G=b.value===void 0?b.innerHTML:b.value,z=r.format==="text"?O2(G).split(/<br>|<br\/>/g).join(`
`).replace(/&nbsp;/g," ").replace(/&amp;/g,"&"):G;return su(r)&&r.disableNewline!==!1?(st=>{const dt=st.split(/[\n\r]/g);return dt.length>1?dt.map(Vt=>Vt.trim()).filter(Vt=>Vt.length).join(" "):dt[0]})(z):z},Rn=()=>{const b=gn(qe),G=bl(r,b),z=G===!0?b:G;let st=y.x,dt=y.y;if(!r.height){const Vt=Sr({...J},r.rotation),Pt=Jo(z,l),te=Sr({x:st,y:dt,...Pt},r.rotation),[Wt,,Ht]=Vt,[re,,ee]=te;let Ne=Wt,ae=re;r.flipX&&(Ne=Ht,ae=ee);const Me=Dn(_e(Ne),ae);st+=Me.x,dt+=Me.y}dn(r,{x:Oe(B.x)?Vr(st,bt.width):st,y:Oe(B.y)?Vr(dt,bt.height):dt,text:z})},on=()=>{a&&bo(),qe&&qe.confirm&&qe.confirm(),Rn(),co(r),Qt(r)},yn=()=>{a?Fr():(dn(r,{text:B.text,x:B.x,y:B.y}),co(r))},Si=(b,G,{flipX:z,flipY:st,rotation:dt},Vt="top left")=>{let Pt,te;const[Wt,Ht,re,ee]=Sr(b,dt),[Ne,ae,Me,Ce]=Sr(G,dt);return Vt==="top center"?(Pt=Oo(st?[ee,re]:[Wt,Ht]),te=Oo(st?[Ce,Me]:[Ne,ae])):Vt==="top right"&&!z||Vt==="top left"&&z?(Pt=st?re:Ht,te=st?Me:ae):(Pt=st?ee:Wt,te=st?Ce:Ne),Dn(_e(Pt),te)},vr=(b,G,z)=>rt(Oe(b.x)?Vr(G.x+z.x,bt.width):G.x+z.x,Oe(b.y)?Vr(G.y+z.y,bt.height):G.y+z.y),po={},Ms=()=>ur(r),Ps=()=>{const b=Ya(Jo(r.text,l),Wt=>Math.ceil(Wt)),G=ze(r,"height"),z=!G&&ze(r,"width"),st=r.id;let dt=po[st];dt||(po[st]={},dt=po[st]);const Vt=Wt=>{const{width:Ht,...re}=l,ee=Jo(r.text,re),Ne=Si(In(l.x,l.y,Wt.width,Wt.height),In(l.x,l.y,ee.width,ee.height),l,"top "+r.textAlign),ae=l.disableNewline!==!1;to(r,["width","height",ae&&"textAlign"]),dn(r,{...vr(r,l,Ne)})},Pt=Wt=>{const Ht=Vn(dt.width||l.width||b.width,b.height),re=dt.textAlign||"left",ee=Si(In(l.x,l.y,Wt.width,Wt.height),In(l.x,l.y,Ht.width,Ht.height),l,"top "+re);to(r,["height"]),dn(r,{...vr(r,l,ee),width:Oe(r.width)?Vr(Ht.width,bt.width):Ht.width,textAlign:re})},te=Wt=>{const Ht=Vn(dt.width||b.width,dt.height||b.height),re=dt.textAlign||"left",ee=Si(In(l.x,l.y,Wt.width,Wt.height),In(l.x,l.y,Ht.width,Ht.height),l,"top "+re);dn(r,{...vr(r,l,ee),width:Oe(r.width)?Vr(Ht.width,bt.width):Ht.width,height:Oe(r.width)?Vr(Ht.height,bt.height):Ht.height,textAlign:re})};if(G){dt.textAlign=r.textAlign,dt.width=l.width,dt.height=l.height;const Wt=Vn(l.width,l.height);Gs(r,"auto-height")?Pt(Wt):Gs(r,"auto-width")&&Vt(Wt)}else if(z){dt.textAlign=r.textAlign,dt.width=l.width;const Wt=Vn(l.width,b.height);Gs(r,"auto-width")?Vt(Wt):Gs(r,"fixed-size")&&te(Wt)}else{dt.textAlign=r.textAlign;const Wt=Vn(Math.ceil(b.width),Math.ceil(b.height));Gs(r,"fixed-size")?te(Wt):Gs(r,"auto-height")&&Pt(Wt)}},Rs=b=>{b.stopPropagation();const G=r.flipX||!1;Qn(r,"flipX",!G),Qt(r)},Is=b=>{b.stopPropagation();const G=r.flipY||!1;Qn(r,"flipY",!G),Qt(r)},za=b=>{Qn(r,"opacity",b)},ts=b=>{za(b),Qt(r)},Es=b=>{b.stopPropagation(),b.target.blur(),Zn()},Ca=b=>{b.stopPropagation(),Ot.findIndex(G=>G===r)!==Ot.length-1&&(we.set(Ot.filter(G=>G!==r).concat([r])),Qt(r))},da=b=>{b.stopPropagation(),hr()},hr=()=>{const b=_n(r);b.id=ra();const G=rt(50,-50);if(ze(b,"points")){const z=Pl(b,["points"],bt);z.points.forEach(st=>{st.x+=G.x,st.y+=G.y}),ya(b,z,bt)}else if(nr(b)){const z=Pl(b,["x1","y1","x2","y2"],bt);z.x1+=G.x,z.y1+=G.y,z.x2+=G.x,z.y2+=G.y,ya(b,z,bt)}else{const z=Pl(b,["x","y"],bt);z.x+=50,z.y-=50,ya(b,z,bt)}we.set([...Ot,b]),ye(b),un(b)},Or=ai(0,{stiffness:.2,damping:.7});let Xn;A(t,Or,b=>i(17,j=b));const Wr=(b,G)=>{const{disableTextLayout:z=[]}=G;return"height"in G?z.includes("auto-height")?b.shapeIconButtonTextLayoutAutoWidth:b.shapeIconButtonTextLayoutAutoHeight:"width"in G?z.includes("auto-width")?b.shapeIconButtonTextLayoutFixedSize:b.shapeIconButtonTextLayoutAutoWidth:z.includes("fixed-size")?b.shapeIconButtonTextLayoutAutoHeight:b.shapeIconButtonTextLayoutFixedSize},Ue=(b,G)=>{const{disableTextLayout:z=[]}=G;return"height"in G?z.includes("auto-height")?b.shapeTitleButtonTextLayoutAutoWidth:b.shapeTitleButtonTextLayoutAutoHeight:"width"in G?z.includes("auto-width")?b.shapeTitleButtonTextLayoutFixedSize:b.shapeTitleButtonTextLayoutAutoWidth:z.includes("fixed-size")?b.shapeTitleButtonTextLayoutAutoHeight:b.shapeTitleButtonTextLayoutFixedSize};let Ao=!1,ua=Qi(),_r;const Fa=b=>{je(b),i(142,br=b)};let pa;return No(()=>{Je(),Mi(),Io(),La()}),t.$$set=b=>{"uid"in b&&i(57,ve=b.uid),"ui"in b&&i(58,ge=b.ui),"disabled"in b&&i(0,_=b.disabled),"shapes"in b&&pe(i(1,we=b.shapes)),"selection"in b&&i(59,gi=b.selection),"offset"in b&&i(2,xe=b.offset),"contextRotation"in b&&i(60,_t=b.contextRotation),"contextFlipX"in b&&i(61,Te=b.contextFlipX),"contextFlipY"in b&&i(62,Ie=b.contextFlipY),"contextZoom"in b&&i(63,He=b.contextZoom),"active"in b&&i(64,vi=b.active),"opacity"in b&&i(65,vt=b.opacity),"parentRect"in b&&i(66,bt=b.parentRect),"rootRect"in b&&i(3,Ze=b.rootRect),"utilRect"in b&&i(67,Pe=b.utilRect),"hoverColor"in b&&i(68,ri=b.hoverColor),"caretColor"in b&&i(69,Ge=b.caretColor),"gridColor"in b&&i(70,ii=b.gridColor),"snapColor"in b&&i(71,wi=b.snapColor),"textInputMode"in b&&i(4,pi=b.textInputMode),"oninteractionstart"in b&&i(72,Fi=b.oninteractionstart),"oninteractionupdate"in b&&i(73,X=b.oninteractionupdate),"oninteractionrelease"in b&&i(74,jt=b.oninteractionrelease),"oninteractionend"in b&&i(75,U=b.oninteractionend),"oninteractioncancel"in b&&i(76,Bt=b.oninteractioncancel),"onaddshape"in b&&i(77,ye=b.onaddshape),"onupdateshape"in b&&i(78,Qt=b.onupdateshape),"onselectshape"in b&&i(79,se=b.onselectshape),"onblurshape"in b&&i(80,zt=b.onblurshape),"onremoveshape"in b&&i(81,We=b.onremoveshape),"ontapshape"in b&&i(82,Ae=b.ontapshape),"onhovershape"in b&&i(83,je=b.onhovershape),"onhovercanvas"in b&&i(84,Ke=b.onhovercanvas),"ontapcanvas"in b&&i(85,it=b.ontapcanvas),"onleavecanvas"in b&&i(86,Xt=b.onleavecanvas),"beforeSelectShape"in b&&i(87,Nt=b.beforeSelectShape),"beforeDeselectShape"in b&&i(88,Zt=b.beforeDeselectShape),"beforeRemoveShape"in b&&i(89,Yt=b.beforeRemoveShape),"beforeUpdateShape"in b&&i(90,ot=b.beforeUpdateShape),"willRenderShapeControls"in b&&i(91,he=b.willRenderShapeControls),"willRenderShapeTextControls"in b&&i(92,ie=b.willRenderShapeTextControls),"willStartInteraction"in b&&i(93,fe=b.willStartInteraction),"mapEditorPointToImagePoint"in b&&i(94,Dt=b.mapEditorPointToImagePoint),"mapImagePointToEditorPoint"in b&&i(95,ke=b.mapImagePointToEditorPoint),"eraseRadius"in b&&i(96,fi=b.eraseRadius),"selectRadius"in b&&i(97,hi=b.selectRadius),"enableButtonFlipVertical"in b&&i(98,Be=b.enableButtonFlipVertical),"enableTapToAddText"in b&&i(99,yi=b.enableTapToAddText),"enableTextStyleControls"in b&&i(5,Pi=b.enableTextStyleControls),"locale"in b&&i(6,be=b.locale),"snapThreshold"in b&&i(100,me=b.snapThreshold),"snapPointer"in b&&i(101,Ee=b.snapPointer),"enableSnapToContext"in b&&i(102,an=b.enableSnapToContext),"gridSize"in b&&i(103,Gi=b.gridSize)},t.$$.update=()=>{var b,G;16&t.$$.dirty[2]|1024&t.$$.dirty[3]&&i(166,n=Gi>0?{x:0,y:0,...bt}:void 0),1&t.$$.dirty[0]|1048576&t.$$.dirty[5]&&i(146,r=!_&&Ot&&(lo()||Dr())),4194304&t.$$.dirty[4]&&i(173,o=!!r),4194304&t.$$.dirty[4]&&i(160,a=r&&So(r)),4194304&t.$$.dirty[4]|32&t.$$.dirty[5]&&i(10,s=r&&!a?r.id:void 0),8&t.$$.dirty[0]|16&t.$$.dirty[2]|4194304&t.$$.dirty[4]&&i(13,l=Ze&&r&&Un(_n(r),bt)),4194304&t.$$.dirty[4]|32&t.$$.dirty[5]&&i(144,c=!(!r||!a)),8192&t.$$.dirty[0]|8&t.$$.dirty[2]|4194304&t.$$.dirty[4]&&i(172,d=r&&vt&&Vi(l)||[]),4194304&t.$$.dirty[4]&&i(174,u=r&&Bp(b=r)&&mc(b)&&b.disableResize!==!0&&(Ks(b)||qd(b)||Kn(b)||nr(b)||Yn(b)&&ze(b,"pathClose"))&&!Ua(r)),4194304&t.$$.dirty[4]&&i(14,p=r&&(z=>Bp(z)&&z.disableRotate!==!0&&(Ks(z)||ze(z,"text")||Kn(z)))(r)&&!Ua(r)),4194304&t.$$.dirty[4]|524288&t.$$.dirty[5]&&i(16,h=u&&ze(r,"text")&&!r.height?[[1,2],[3,0]]:(!r||!nr(r)&&!Yn(r))&&u),65536&t.$$.dirty[0]|4194304&t.$$.dirty[4]|524288&t.$$.dirty[5]&&i(28,g=!!r&&!Array.isArray(h)&&u),4194304&t.$$.dirty[4]|131072&t.$$.dirty[5]&&i(15,m=r&&d.length>1),4&t.$$.dirty[3]|131072&t.$$.dirty[5]&&i(170,f=d.map(ke)),4&t.$$.dirty[0]|32768&t.$$.dirty[5]&&i(12,x=f.map(z=>rt(z.x-xe.x,z.y-xe.y))),4194304&t.$$.dirty[4]|262144&t.$$.dirty[5]&&i(27,k=o&&(qd(r)?!ze(r,"disableNewline")||!r.disableNewline:r.disableNewline===!1)),4&t.$$.dirty[3]|262144&t.$$.dirty[4]&&(br&&ke&&!cs(br)&&$a(br)?(z=>{const st=Vi(Un(_n(z),bt));if(!st)return;const dt=st.map(ke),Vt=!!z.pathClose||!(!z.bitmap&&(Yn(z)||nr(z))),Pt=z.selectionStyle==="hook",te=Pt?dt.map((Ht,re,ee)=>({id:"markup-hover",points:Ro(ee,re),strokeColor:[0,0,0,.1],strokeWidth:2})):[{id:"markup-hover",points:dt.map(Ht=>rt(Ht.x+1,Ht.y+1)),strokeColor:[0,0,0,.1],strokeWidth:2,pathClose:Vt}],Wt=Pt?dt.map((Ht,re,ee)=>({id:"markup-hover",points:Ro(ee,re),strokeColor:ri,strokeWidth:2})):[{id:"markup-hover",points:dt,strokeColor:ri,strokeWidth:2,pathClose:Vt}];jo(...te,...Wt)})(br):La()),61440&t.$$.dirty[0]|8&t.$$.dirty[2]&&i(171,v=m&&p&&vt&&x&&(z=>{const st=pn(z),dt=ke({x:st.origin.x+st.dir.x,y:st.origin.y+st.dir.y});return{origin:ke(st.origin),position:dt}})(l)),4&t.$$.dirty[0]|65536&t.$$.dirty[5]&&i(26,C=v&&rt(v.position.x-xe.x,v.position.y-xe.y)),4194304&t.$$.dirty[5]&&i(165,T=!!(yt||[]).find(z=>[91,93,17].includes(z))),256&t.$$.dirty[3]|1024&t.$$.dirty[5]&&i(167,P=!(T||!Ee)),8&t.$$.dirty[2]|4718592&t.$$.dirty[4]|36896&t.$$.dirty[5]&&r&&f&&vt>0&&((z,st,dt)=>{if(!$a(st))return;const Vt=Yn(st),Pt=Vt&&ze(st,"pathClose"),te=Pt&&(wn=>wn.strokeWidth&&((Sn,wr)=>{const Yr=Sn.strokeColor;return!!Yr&&(Yr.length===3||Yr[3]>0)})(wn))(st),Wt=So(st),Ht=Ua(st),re=st.selectionStyle==="hook",{selectionOpacity:ee=1}=st;if(Wt&&Vt&&!Pt)return;const Ne=[],ae=[...f],Me=ae[ae.length-1],Ce=ae[0],Jt=(Ht?.05:.1)*z*ee,Le=Jt>0,di=(Ht?.5:1)*z*ee,Oi=di>0,mi=[0,0,0],$i=[1,1,1],ti=Ht?1:1.5;yt.includes(16)&&Me&&dt&&On(Me,dt);const rn=(ae.length&&Pt&&Wt&&dt?Bo(Ce,dt):1/0)<=256,Hi=(ae.length&&Pt&&Wt&&dt?Bo(Me,dt):1/0)<=256;!rn&&dt&&ae.push(dt);const mr=ae.length>1,tr=!!st.pathClose||!(!st.bitmap&&(Yn(st)||nr(st)))||ae.length>2&&rn;mr&&Le&&(re?Ne.push(...ae.map((wn,Sn,wr)=>({id:Rr,points:Ro(wr,Sn),strokeColor:mi,strokeWidth:2,opacity:Jt}))):Ne.push({id:Rr,points:ae.map(wn=>rt(wn.x+1,wn.y+1)),pathClose:tr,strokeColor:mi,strokeWidth:2,opacity:Jt})),Pt&&Le&&Ne.push(...ae.map(wn=>({id:Rr,...wn,rx:2*ti,ry:2*ti,backgroundColor:mi,opacity:Jt}))),v&&Le&&Ne.push({id:Rr,points:[rt(v.origin.x+1,v.origin.y+1),rt(v.position.x+1,v.position.y+1)],strokeColor:mi,strokeWidth:2,opacity:Jt}),mr&&Oi&&(re?Ne.push(...ae.map((wn,Sn,wr)=>({id:Rr,points:Ro(wr,Sn),strokeColor:$i,strokeWidth:ti,opacity:di}))):Ne.push({id:Rr,points:ae,pathClose:tr,strokeColor:$i,strokeWidth:ti,backgroundColor:Wt&&Pt&&st.backgroundColor&&st.backgroundColor[3]>0?st.backgroundColor:[0,0,0,0],opacity:di})),Pt&&Ne.push(...ae.map(wn=>({id:Rr,...wn,rx:3*ti,ry:3*ti,backgroundColor:[.5,.5,.5],strokeWidth:ti,strokeColor:$i}))),Pt&&Wt&&f.length>=3&&Ne.push({...Ce,id:Rr,rx:ti*(rn?5:4),ry:ti*(rn?5:4),backgroundColor:rn?ri:[.5,.5,.5],strokeWidth:ti,strokeColor:$i}),Pt&&Wt&&te&&!rn&&d.length>=2&&Ne.push({...Me,id:Rr,rx:ti*(Hi?5:4),ry:ti*(Hi?5:4),backgroundColor:Hi?ri:[.5,.5,.5],strokeWidth:ti,strokeColor:$i}),v&&Oi&&!re&&Ne.push({id:Rr,points:[{x:v.origin.x,y:v.origin.y},{x:v.position.x,y:v.position.y}],strokeColor:$i,strokeWidth:ti,opacity:di}),Eo(...Ne)})(vt,r,a&&Yn(r)?E({..._r},!P):void 0),4194304&t.$$.dirty[4]&&(r||Io()),262144&t.$$.dirty[4]&&i(168,I=!!br),65536&t.$$.dirty[4]&&i(169,O=!!ci),524288&t.$$.dirty[4]|28672&t.$$.dirty[5]&&(!_r||O||I||E({..._r},!P)),256&t.$$.dirty[2]|1028&t.$$.dirty[3]|8390656&t.$$.dirty[5]&&Gi>0&&n&&ke&&((z,st,dt,Vt)=>{const Pt=ke({x:0,y:0}),te=ke({x:z,y:z}),Wt=ke({x:st.width,y:st.height}),Ht=te.x-Pt.x;if(Re.set(Ht>6?1:0),Vt<=0)return Mi();const re=fr(Ht,Pt.x,Wt.x).map(Ne=>({id:Ve,opacity:Vt,points:[{x:Ne,y:Pt.y},{x:Ne,y:Wt.y}],strokeWidth:1,strokeColor:dt})),ee=fr(Ht,Pt.y,Wt.y).map(Ne=>({id:Ve,opacity:Vt,points:[{x:Pt.x,y:Ne},{x:Wt.x,y:Ne}],strokeWidth:1,strokeColor:dt}));Ni(...ee,...re)})(Gi,n,ii,Gt),512&t.$$.dirty[2]|4&t.$$.dirty[3]|49152&t.$$.dirty[4]|1024&t.$$.dirty[5]&&ke&&(T?Je():((z,st,dt)=>{if(z===null&&st===null)return Je();let Vt,Pt;z!==null&&(Vt={id:Ii,strokeColor:dt,strokeWidth:1.5,points:[ke({x:z,y:0}),ke({x:z,y:bt.height})]}),st!==null&&(Pt={id:Ii,strokeColor:dt,strokeWidth:1.5,points:[ke({x:0,y:st}),ke({x:bt.width,y:st})]}),bi(Vt,Pt)})(go,ao,wi)),4&t.$$.dirty[2]&&(z=>{if(!z)return vo({_prerender:!1});const st=Ot.find(dt=>dt.isEditing);st&&dn(st,{_prerender:pi==="inline"})})(vi),4194304&t.$$.dirty[5]&&yt&&yt.length&&(()=>{const[z]=yt;z!==8&&z!==46||ki()&&(r.isEditing||setTimeout(()=>Zn(),0))})(),272&t.$$.dirty[0]&&qe&&pi==="inline"&&qe.focus(),4194304&t.$$.dirty[4]&&i(164,L=r&&qn(r)),4194304&t.$$.dirty[4]|512&t.$$.dirty[5]&&i(11,F=L&&bl(r)!==!1&&Ua(r)),2048&t.$$.dirty[0]&&i(159,B=F?{...r}:void 0),16&t.$$.dirty[2]|16&t.$$.dirty[5]&&i(161,y=B&&Un({...B},bt)),64&t.$$.dirty[5]&&i(163,V=y&&Jo(y.text,y)),320&t.$$.dirty[5]&&(J=y&&In(y.x,y.y,V.width,V.height)),2048&t.$$.dirty[0]|4194304&t.$$.dirty[4]&&i(23,S=F?r.text:""),2056&t.$$.dirty[0]|16&t.$$.dirty[2]|4194304&t.$$.dirty[4]&&i(162,H=Ze&&r&&F&&Un({..._n(r),width:xi(r.width)?Math.floor(r.width):void 0,height:xi(r.height)?Math.floor(r.height):void 0},bt)),2064&t.$$.dirty[0]|128&t.$$.dirty[5]&&i(25,K=F&&((z,st)=>{const{textAlign:dt="left",fontFamily:Vt="sans-serif",fontWeight:Pt="normal",fontStyle:te="normal",letterSpacing:Wt="normal",textShadowX:Ht=0,textShadowY:re=0,textShadowBlur:ee=0,textShadowColor:Ne,textOutlineWidth:ae=0,textOutlineColor:Me}=z,Ce="!important",Jt=`caret-color:${lt};text-align:${dt}${Ce};font-family:${Vt}${Ce};font-weight:${Pt}${Ce};font-style:${te}${Ce};letter-spacing:${xi(Wt)?Wt+"px":"normal"}${Ce}`;if(st==="modal")return Jt;const Le=ae?`;-webkit-text-stroke:${2*ae}px ${kr(Me)} ${Ce}`:"",di=ee||Ht||re?`;text-shadow:${Ht}px ${re}px ${ee}px ${kr(Ne)} ${Ce}`:"";let Oi=z.fontSize,mi=1,$i="";Oi>1e3&&va()&&(mi=Oi/1e3,$i=`transform-origin:0 0;transform:scale(${mi})`,Oi=1e3);let ti=z.lineHeight/mi;const rn=kr(z.color),Hi=.5*Math.max(0,Oi-ti);return`--font-scalar:${mi};--bottom-inset:${Hi}px;padding:${Hi}px 0 0${Ce};color:${rn}${Ce};font-size:${Oi}px${Ce};line-height:${ti}px${Ce};${Jt};${$i}${Le}${di}`})(H,pi)),2052&t.$$.dirty[0]|536870912&t.$$.dirty[1]|2&t.$$.dirty[2]|128&t.$$.dirty[5]&&i(24,ut=F&&((z,st,dt,Vt)=>{let Pt,te;z.width&&z.height?(Pt=Ti(z),te=Ea(z)):(te=Jo(r.text,l),te.width=l.width||te.width,Pt=rt(z.x+.5*te.width,z.y+.5*te.height));const Wt=Math.max(0,z.fontSize-z.lineHeight)+z.lineHeight,Ht=ke(Pt);let re=Ht.x-st.x-.5*te.width,ee=Ht.y-st.y-.5*te.height,Ne=z.flipX,ae=z.flipY,Me=z.rotation;Te&&Ie?(Ne=!Ne,ae=!ae):Te?(Ne=!Ne,Me=-Me):Ie&&(ae=!ae,Me=-Me),Me+=Vt;const Ce=dt*(Ne?-1:1),Jt=dt*(ae?-1:1);return`--line-height:${Wt}px;width:${te.width}px;height:${te.height}px;transform:translate(${re}px,${ee}px) rotate(${Me}rad) scale(${Ce}, ${Jt})`})(H,xe,He,_t)),128&t.$$.dirty[2]&&(lt=Ge?kr(Ge):"auto"),2320&t.$$.dirty[0]&&F&&qe&&pi==="inline"&&Di(S),72351744&t.$$.dirty[4]&&i(150,N=r&&!c?r:N),67108864&t.$$.dirty[4]&&i(152,ft=N&&fb(N)),67108864&t.$$.dirty[4]&&i(147,$t=N&&Gs(N)),67108864&t.$$.dirty[4]&&i(149,Lt=N&&(z=>z.disableDuplicate!==!0&&mc(z))(N)),67108864&t.$$.dirty[4]&&i(148,ct=N&&Im(N)),67108864&t.$$.dirty[4]&&i(151,et=N&&(z=>z.disableReorder!==!0)(N)),67108864&t.$$.dirty[4]&&i(145,ht=N&&bl(N)!==!1),67108864&t.$$.dirty[4]&&i(153,Y=N&&ze(N,"backgroundImage")&&Dp(N,"opacity")),4194304&t.$$.dirty[4]&&i(155,Z=r&&r.format==="html"),5242880&t.$$.dirty[4]|1&t.$$.dirty[5]&&i(158,St=r&&(!c||Z)),131072&t.$$.dirty[4]|2097160&t.$$.dirty[5]&&Or.set(St&&!Kt?1:0,{hard:wt===!1}),4096&t.$$.dirty[0]|12&t.$$.dirty[5]&&i(157,nt=St&&x.length?(G=rr(x),Co(rt(G.x+.5*G.width,G.y),Ic)):nt),512&t.$$.dirty[0]|32&t.$$.dirty[2]|4&t.$$.dirty[5]&&i(156,mt=nt&&Xn&&Pe&&(z=>{const st=Pe.x,dt=Pe.y,Vt=st+Pe.width;let Pt=Math.max(z.x-.5*Xn.width,st),te=Math.max(z.y-Xn.height-16,dt);return Pt+Xn.width>Vt&&(Pt=Vt-Xn.width),rt(Pt,te)})(nt)),131072&t.$$.dirty[0]|2&t.$$.dirty[5]&&i(22,Ft=mt&&`transform: translate(${mt.x}px, ${mt.y}px);opacity:${j}`),2048&t.$$.dirty[0]&&i(154,oe=F?"text":"shape"),1088&t.$$.dirty[0]|1610612736&t.$$.dirty[2]|32&t.$$.dirty[3]|2145386496&t.$$.dirty[4]|1048577&t.$$.dirty[5]&&i(21,Rt=oe==="text"&&ie&&Z?Ac(()=>ie([["div","text-styles",{class:"PinturaShapeControlsGroup"},[...[["bold",{label:"B",style:"font-weight:900;",title:"Bold",shortcut:["CMD","B"]}],["italic",{label:"I",style:"font-family:Times New Roman;font-style:italic;",title:"Italic",shortcut:["CMD","I"]}],["underline",{label:"U",style:"text-decoration:underline;",title:"Underline",shortcut:["CMD","U"]}],["strikeThrough",{label:"S",style:"text-decoration:line-through;",title:"Strikethrough",shortcut:["CMD","S"]}]].map(([z,st])=>["Button","style-"+z,{onclick:()=>document.execCommand(z),...st,style:"font-size:1.25em;text-underline-offset:1px;text-decoration-thickness:1.5px;font-weight:400;"+st.style}])]],["div","text-reset",{class:"PinturaShapeControlsGroup"},[["Button","style-reset",{onclick:()=>document.execCommand("removeFormat"),style:"font-weight:400;",label:'<span style="font-size:1.25em;font-style:italic;font-family:Times New Roman;text-decoration:underline;">T</span><span style="position:relative;top:.175rem;">&times;</span>',title:"Remove styles"}]]]],s)):oe==="shape"&&he&&s?Ac(()=>he([Y&&["div","alpha",{class:"PinturaShapeControlsGroup"},[["ToggleSlider","adjust-opacity",{onrelease:ts,onchange:za,step:.01,value:ze(r,"opacity")?r.opacity:1,label:(z,st,dt)=>Math.round(z/dt*100)+"%",min:0,max:1,direction:"x"}]]],["div","beta",{class:"PinturaShapeControlsGroup"},[ft&&["Button","flip-horizontal",{onclick:Rs,label:be.shapeTitleButtonFlipHorizontal,icon:be.shapeIconButtonFlipHorizontal,hideLabel:!0}],ft&&Be&&["Button","flip-vertical",{onclick:Is,label:be.shapeTitleButtonFlipVertical,icon:be.shapeIconButtonFlipVertical,hideLabel:!0}],et&&["Button","to-front",{onclick:Ca,label:be.shapeTitleButtonMoveToFront,icon:be.shapeIconButtonMoveToFront,hideLabel:!0,disabled:Ot[Ot.length-1]===N}],Lt&&["Button","duplicate",{onclick:da,label:be.shapeTitleButtonDuplicate,icon:be.shapeIconButtonDuplicate,shortcut:["CMD","D"],hideLabel:!0}],ct&&["Button","remove",{onclick:Es,label:be.shapeTitleButtonRemove,icon:be.shapeIconButtonRemove,shortcut:["Backspace"],hideLabel:!0}]].filter(Boolean)],ht&&$t&&["div","gamma",{class:"PinturaShapeControlsGroup"},[["Button","text-layout",{onclick:Ps,label:ar(Ue,be,r),icon:ar(Wr,be,r),hideLabel:!0}]]],ht&&["div","delta",{class:"PinturaShapeControlsGroup"},[["Button","edit-text",{label:be.shapeLabelInputText,onclick:Ms}]]]].filter(Boolean),s)):[]),64&t.$$.dirty[0]|1048576&t.$$.dirty[5]&&i(20,Ut=Ot.filter($a).filter(z=>z.id).filter(z=>!So(z)).map(z=>({id:z.id,color:qn(z)?z.color:nr(z)?z.strokeColor:z.backgroundColor,name:z.name||be["shapeLabelTool"+Ny(vb(z))]})))},[_,we,xe,Ze,pi,Pi,be,un,qe,Xn,s,F,x,l,p,m,h,j,Ao,pa,Ut,Rt,Ft,S,ut,K,C,k,g,mn,Wn,b=>{const{origin:G}=b.detail;i(140,ci=void 0),W=void 0,ne=void 0,Ai=!1,vn=void 0,oi=!1,zn(),clearTimeout(Bn),Bn=setTimeout(()=>i(141,Kt=!0),250);const z=lo();if(!z||Yn(z)&&ze(z,"pathClose")||bo(),Xr=Dt(_e(G)),z&&Yn(z)&&ze(z,"pathClose"))return Fi(b);const st=xr(Ot,Xr,hi,Vt=>$a(Vt)),dt=st.length&&st.shift();if(r&&Ua(r)&&(on(),yi&&(oi=!0)),!dt&&r&&Ua(r)&&Zr(r),!!fe(G)){if(dt&&cs(dt))return Ai=!0,i(140,ci=dt),W=_n(ci),void(ne=Un(_n(ci),bt));vn=dt||void 0,!Fi(b)&&dt&&(un(dt),i(140,ci=dt),W=_n(ci),ne=Un(_n(ci),bt))}},b=>{Se(),Bt(b)},b=>{const{translation:G,ctrlKey:z,metaKey:st,shiftKey:dt,position:Vt}=b.detail;if(ci){if(!mc(ci)||Ua(ci))return;if(dt){let Pt=Math.abs(G.x),te=Math.abs(G.y);Li==="x"&&(te-=64),Li==="y"&&(Pt-=64),Pt>te?(G.y=0,Li="x"):te>Pt&&(G.x=0,Li="y")}else Li=null;return fo(ci,ne,G,{...hn(z||st?0:me,Gi,n,ci)})}X(b)},b=>{Se(),ci?Ua(ci)?yn():b.detail.isTap&&Ai&&qn(ci)&&bl(ci)!==!1&&ur(ci):jt(b)},b=>{const G=vn&&b.detail.isTap;if(b.detail.isTap&&setTimeout(()=>{it({target:ci||vn,position:Xr},0)}),ci)return Ae(ci),z=ci,st=W,JSON.stringify(z)!==JSON.stringify(st)&&Qt(ci),void i(140,ci=void 0);var z,st;const dt=Gr(),Vt=!dt||Zt(dt,vn||void 0);Vt&&eo({storePrevious:!1}),U(b),Vt&&G&&un(vn)},Re,b=>{i(141,Kt=!0),i(140,ci=r),ne=l},b=>{if(!ci)return void i(141,Kt=!1);const{translation:G,indexes:z,shiftKey:st,ctrlKey:dt,metaKey:Vt}=b.detail;((Pt,te,Wt,Ht,re)=>{const{snapThreshold:ee=0,gridSize:Ne=0,gridRect:ae,snapTargets:Me=[]}=re||{},Ce=ee?(Jt,Le,di)=>{const{snapTranslation:Oi,snapLines:mi}=Ur(Mn(Jt),Me,ee,Ne,ae);Qr(Le,Oi),oo(mi);const $i=Pr(di(),Le);Jt.x=$i.x,Jt.y=$i.y}:$e;if(nr(Pt)||Yn(Pt)&&ze(Pt,"pathClose")){const[Jt]=Wt,Le=yt.includes(16)?On:(ti,rn)=>rn;let di,Oi,mi;if(nr(Pt))Jt===0?(di=()=>Ga(te),Oi=ti=>Le(Za(te),ti),mi=(ti,rn)=>{ti.x1=rn.x,ti.y1=rn.y}):Jt===1&&(di=()=>Za(te),Oi=ti=>Le(Ga(te),ti),mi=(ti,rn)=>{ti.x2=rn.x,ti.y2=rn.y});else{const ti=te.points;di=()=>({...ti[Jt]}),Oi=rn=>{const Hi=ti[hu(Jt-1,ti)],mr=ti[hu(Jt+1,ti)];Le(Hi,rn),Le(mr,rn)},mi=(rn,Hi)=>rn.points=rn.points.map((mr,tr)=>Jt===tr?Hi:mr)}const $i=Pr(di(),Ht);Ce($i,Ht,di),Oi($i),mi(Pt,$i)}else if(Ks(Pt)||Kn(Pt)||qd(Pt)){let Jt,Le,di=!1;if(Kn(Pt))Jt=J1(te);else if(Ks(Pt))Jt=ls(te);else{di=!0,Jt=ls(te);const Hi=Jo(te.text,te);Jt.height=Hi.height}Pt.aspectRatio?Le=Pt.aspectRatio:re.shiftKey&&!di&&(Le=Jt.width/Jt.height);const Oi=ls(Jt),mi=Ti(Oi),$i=Pt.rotation,ti=_o(Oi),rn=Sr(Oi,$i);if(Wt.length===1){let Hi=Wt[0];Pt.flipX&&(Hi=yo[Hi]),Pt.flipY&&(Hi=Po[Hi]);const[mr,tr,wn,Sn]=ti,wr=ke(rn[Hi]),Yr=Fn({...wr},Ht),Da=Dt(Yr);Ce(Da,Ht,()=>Dt(wr));const Ba=rt(Da.x-rn[Hi].x,Da.y-rn[Hi].y),As=qr(_e(Ba),-$i),Ta=rt(ti[Hi].x+As.x,ti[Hi].y+As.y);let Uo;Hi===0&&(Uo=wn),Hi===1&&(Uo=Sn),Hi===2&&(Uo=mr),Hi===3&&(Uo=tr);const Lo=rr([Uo,Ta]);if(Le){const{width:_a,height:Ls}=Jr(Lo,Le),[al,Xo,Va,er]=il(Lo);Lo.width=_a,Lo.height=Ls,Ta.y<Uo.y&&(Lo.y=Va-Ls),Ta.x<Uo.x&&(Lo.x=Xo-_a)}const Oa=Sr(Lo,$i,mi),Go=Oo(Oa),es=qr(Oa[0],-$i,Go),Zo=qr(Oa[2],-$i,Go),Wa=rr([es,Zo]);bn(Pt,Kn(Pt)?om(Wa):Wa,bt)}else{Wt=Wt.map(er=>(Pt.flipX&&(er=yo[er]),Pt.flipY&&(er=Po[er]),er));const[Hi,mr]=Wt.map(er=>rn[er]),tr={x:Hi.x+.5*(mr.x-Hi.x),y:Hi.y+.5*(mr.y-Hi.y)},[wn,Sn]=Wt.map(er=>ti[er]),[wr,Yr]=Wt.map(er=>{const ha=er+2;return ha<4?ti[ha]:ti[ha-4]}),Da={x:wr.x+.5*(Yr.x-wr.x),y:wr.y+.5*(Yr.y-wr.y)},Ba=ke(tr),As=Fn({...Ba},Ht),Ta=Dt(As);Ce(Ta,Ht,()=>Dt(Ba));const Uo=rt(Ta.x-tr.x,Ta.y-tr.y),Lo=qr(_e(Uo),-$i),Oa=Dn(_e(wn),Sn),Go=Co(Oa,er=>1-Math.abs(Math.sign(er))),es=rt(Lo.x*Go.x,Lo.y*Go.y);Fn(wn,es),Fn(Sn,es);const Zo=rr(ti);if(Le){let er=Zo.width,ha=Zo.height;Go.y===0?ha=er/Le:er=ha*Le,Zo.width=er,Zo.height=ha,Go.y===0?Zo.y=Da.y-.5*ha:Zo.x=Da.x-.5*er}const Wa=Sr(Zo,$i,mi),_a=Oo(Wa),Ls=qr(Wa[0],-$i,_a),al=qr(Wa[2],-$i,_a),Xo=rr([Ls,al]);let Va;Kn(Pt)?Va=om(Xo):Ks(Pt)?Va=Xo:di&&(Va={x:Xo.x,y:Xo.y,width:Xo.width}),bn(Pt,Va,bt)}}yr()})(ci,ne,z,G,{shiftKey:st,...hn(dt||Vt?0:me,Gi,n,ci)})},b=>{if(!ci)return void i(141,Kt=!1);un(ci);const{isTap:G}=b.detail;G&&Ae(ci),i(140,ci=void 0),i(141,Kt=!1),Qt(r)},b=>{so=pn(l).origin,i(141,Kt=!0),i(140,ci=r),ne=l},b=>{if(!ci)return void i(141,Kt=!1);const{translation:G,shiftKey:z}=b.detail;((st,dt,Vt,Pt)=>{const te=uo(Un(_n(st),bt)),Wt=Ti(te),Ht=Pr(so,Vt);let re=Rd(Ht,Wt)+Math.PI/2;if(Pt.shiftKey){const ee=Math.PI/16;re=ee*Math.round(re/ee)-_t%ee}bn(st,{rotation:re},bt),yr()})(ci,0,G,{shiftKey:z})},()=>{ci?(un(ci),i(140,ci=void 0),i(141,Kt=!1),Qt(r)):i(141,Kt=!1)},b=>{const{key:G}=b,z=/escape/i.test(G);if(ki())return z?(b.preventDefault(),b.stopPropagation(),Zr(r)):void(Lt&&G==="d"&&(b.metaKey||b.ctrlKey)&&(b.preventDefault(),b.stopPropagation(),hr()))},b=>{const G=bl(r,b);return G===!0?b:G},Rn,b=>{const{target:G,key:z}=b,st=G.value||G.innerText,dt=G.selectionStart||0,Vt=G.selectionEnd||st.length,Pt=st.substring(0,dt)+z+st.substring(Vt);if(bl(r,Pt)!==Pt)return b.preventDefault()},b=>su(r)&&/enter/i.test(b.code)&&r.disableNewline!==!1?b.preventDefault():/arrow/i.test(b.code)?b.stopPropagation():/escape/i.test(b.key)?yn():void 0,b=>{const{key:G,ctrlKey:z,altKey:st}=b;if(/enter/i.test(G)&&(z||st))return on()},on,yn,Or,b=>{const G=Dr();G&&(Ua(G)||mc(G)&&(i(140,ci=G),ne=Un(_n(ci),bt),fo(ci,ne,b.detail)))},b=>{i(18,Ao=!0)},({relatedTarget:b})=>{b&&b.classList.contains("shape-selector__button")||i(18,Ao=!1)},b=>{if(b.pointerType==="touch"||b.target.className!=="PinturaShapeEditor")return void Xt();(Kt||Bn)&&Fa(void 0);const G=eh(b,Ze);i(143,_r=_e(G));const z=Co(Dt(G),dt=>Math.round(dt));if(ds(z,ua)||(ua=_e(z),Ke(Kt,G,z),Kt||Bn)||c)return;const[st]=xr(Ot,z,0,$a);st&&So(st)||Fa(st)},b=>{b.pointerType!=="touch"&&Xt()},ve,ge,gi,_t,Te,Ie,He,vi,vt,bt,Pe,ri,Ge,ii,wi,Fi,X,jt,U,Bt,ye,Qt,se,zt,We,Ae,je,Ke,it,Xt,Nt,Zt,Yt,ot,he,ie,fe,Dt,ke,fi,hi,Be,yi,me,Ee,an,Gi,en,qi,Ln,Gn,Nn,gr,Hn,(b,G={})=>{let z,st,dt,Vt=Kn(b),Pt=qn(b),te=G.position==="relative";const Wt=fn(),Ht=ae=>{if(!me)return ae;const Me=Dt(ae),{snapTranslation:Ce,snapLines:Jt}=Ur(Mn(Me),Wt,me,Gi,n);return Qr(ae,Ce),oo(Jt),ae},re=!!Gr(),ee=G.isSelection?gi:we,Ne=G.inputMode==="step";if(Yn(b)){if(Ne){let ae=!1;const Me=(Ce,Jt)=>{const Le=qi(ee),di=Ce&&rt(Ud(Ce.x,bt.width),Ud(Ce.y,bt.height)),Oi=di&&ke(di);yt.includes(16)&&Oi&&On(Oi,Jt);const mi=Dt(Jt),$i=Le.points.length?Le.points[0]:mi,ti=rt(Ud($i.x,bt.width),Ud($i.y,bt.height)),rn=ke(ti),Hi=Bo(rn,Jt);if(!ae&&Le.points.length===1&&Hi<36)return Gn(ee);if(Le.points.length>2&&Hi<=256){Le.pathClose=!0,$a(Le)&&un(Le);const wn=Nn(ee);return void ye(wn)}const mr=Le.strokeWidth&&Le.strokeColor&&(Le.strokeColor[3]===void 0||Le.strokeColor[3]>0),tr=Bo(Oi,Jt);if(mr&&Le.points.length>1&&tr<256){Le.pathClose=!1,Le.backgroundColor=[0,0,0,0],$a(Le)&&un(Le);const wn=Nn(ee);ye(wn)}else if(!(Le.points.length>0&&tr<100))return te?hc(mi,bt):mi};return{start:Ce=>{const Jt=qi(ee),{origin:Le}=Ce.detail;if(st=4,z=Ht(_e(Le)),dt=_e(z),Jt){const di=Jt.points[Jt.points.length-1],Oi=Me(di,z);return Oi&&(Jt.points=[...Jt.points,Oi]),void gr({points:Jt.points},ee)}ae=!0},update:Ce=>{if(!ae)return;const Jt=qi(ee);if(!Jt)return;const Le=Jt.points[0],di=Me(Le,rt(z.x+Ce.detail.translation.x,z.y+Ce.detail.translation.y));di&&(Jt.points[1]=di,gr({points:Jt.points},ee))},release:Ce=>Ce.detail.preventInertia(),end:Ce=>{if(!ae)return;const Jt=Dt(z),Le=te?hc(Jt,bt):Jt,{isTap:di}=Ce.detail;if(di&&xr(Ot,Jt,0,$a).length)return Gn(ee);Ln({...b,points:[Le]},ee)}}}return{start:ae=>{const{origin:Me}=ae.detail;st=4,z=_e(Me),dt=_e(z);const Ce=Dt(z),Jt=te?hc(Ce,bt):Ce;Ln({...b,points:[Jt]},ee)},update:ae=>{const Me=qi(ee),{translation:Ce}=ae.detail,Jt=rt(z.x+Ce.x,z.y+Ce.y),Le=ho(dt,Jt);if(ni(Le,5)<=st)return;const di=Rd(Jt,dt),Oi=st-Le;dt.x+=Oi*Math.cos(di),dt.y+=Oi*Math.sin(di);const mi=Dt(dt),$i=te?hc(mi,bt):mi;gr({points:Me.points.concat($i)},ee)},release:ae=>ae.detail.preventInertia(),cancel:()=>{Gn(ee)},end:ae=>{const Me=qi(ee);if(ae.detail.isTap){let Jt=!1;if(Me.bitmap?(vn&&(Jt=!0),re&&(Jt=!0)):Jt=!0,Jt)return Gn(ee)}const Ce=Nn(ee);ye(Ce)}}}return Vt||Pt||ko(b)?{start:ae=>{const{origin:Me}=ae.detail;z=Ht(_e(Me));const Ce=Dt(z),Jt=te?hc(Ce,bt):Ce,Le=-1*Ri(_t,Te,Ie),di={...b,rotation:Le,...Jt};di.flipX=Te,di.flipY=Ie,delete di.position,di.opacity=0,(Vt?["rx","ry"]:["width","height"]).forEach(Oi=>{di[Oi]=te?"0%":0}),Ln(di,ee)},update:ae=>{const Me=qi(ee);Me.opacity=1;let{aspectRatio:Ce}=Me,{translation:Jt,shiftKey:Le,ctrlKey:di}=ae.detail;!Ce&&Le&&(Ce=1);const Oi=Ht(rt(z.x+Jt.x,z.y+Jt.y)),mi=Dt(z),$i=Dt(Oi);if(Ce){const wr=rr([mi,$i]),Yr=Jr(wr,Ce);$i.x=mi.x+Yr.width,$i.y=mi.y+Yr.height}const ti={x:mi.x+.5*($i.x-mi.x),y:mi.y+.5*($i.y-mi.y)},rn=Ri(_t,Te,Ie);qr(mi,rn,ti),qr($i,rn,ti);const Hi=Math.min(mi.x,$i.x),mr=Math.min(mi.y,$i.y);let tr=Math.max(mi.x,$i.x)-Hi,wn=Math.max(mi.y,$i.y)-mr,Sn={};Vt?(di?(Sn.x=mi.x,Sn.y=mi.y):(Sn.x=Hi+.5*tr,Sn.y=mr+.5*wn),Sn.rx=.5*tr,Sn.ry=.5*wn):(di?(Sn.x=mi.x-.5*tr,Sn.y=mi.y-.5*wn):(Sn.x=Hi,Sn.y=mr),Sn.width=tr,Sn.height=wn),gr(Sn,ee,(wr,Yr)=>bn(wr,Yr,bt))},release:ae=>{ae.detail.preventInertia()},cancel:ae=>{Gn(ee)},end:ae=>{const Me=qi(ee);if(ae.detail.isTap){if(qn(Me)&&yi&&oi||!qn(Me)||!yi||vn)return Gn(ee);delete Me.width,delete Me.height,Me.disableNewline!==!1&&delete Me.textAlign;const Ce=Un({...Me},bt),Jt=Jo(Me.text,Ce),Le=Dt({x:z.x,y:z.y-.5*Jt.height}),di=Dt({x:z.x+Jt.width,y:z.y+.5*Jt.height}),Oi={x:Le.x+.5*(di.x-Le.x),y:Le.y+.5*(di.y-Le.y)},mi=Ri(_t,Te,Ie);qr(Le,mi,Oi),qr(di,mi,Oi);let $i=Math.min(Le.x,di.x),ti=Math.min(Le.y,di.y);$i<0&&($i=0),ti<0&&(ti=0),$i+Jt.width>bt.width&&($i=bt.width-Jt.width),ti+Jt.height>bt.height&&(ti=bt.height-Jt.height),Me.x=Oe(Me.x)?Vr($i,bt.width):$i,Me.y=Oe(Me.y)?Vr(ti,bt.height):ti}if(Me.opacity=1,qn(Me))ye(Me);else{const Ce=Nn(ee);ye(Ce)}$a(Me)&&un(Me),qn(Me)&&ur(Me)}}:nr(b)?{start:ae=>{const{origin:Me}=ae.detail,Ce=Dt(Ht(Me)),Jt=Co(Ce,Ic);z=_e(Me),Ln({...b,x1:te?Vr(Jt.x,bt.width):Jt.x,y1:te?Vr(Jt.y,bt.height):Jt.y,x2:te?Vr(Jt.x,bt.width):Jt.x,y2:te?Vr(Jt.y,bt.height):Jt.y,opacity:0},ee)},update:ae=>{const{translation:Me}=ae.detail,Ce=Ht(Fn(_e(z),Me));if(yt.includes(16)){const Le=ho(z,Ce),di=Rd(z,Ce),Oi=Math.PI/4,mi=Oi*Math.round(di/Oi);Ce.x=z.x+Le*Math.cos(mi),Ce.y=z.y+Le*Math.sin(mi)}const Jt=Dt(Ce);gr({x2:te?Vr(Jt.x,bt.width):Jt.x,y2:te?Vr(Jt.y,bt.height):Jt.y,opacity:1},ee)},release:ae=>ae.detail.preventInertia(),cancel:ae=>{Gn(ee)},end:ae=>{const Me=qi(ee);if(ae.detail.isTap)return Gn(ee);Me.opacity=1;const Ce=Nn(ee);ye(Ce),$a(Me)&&un(Ce)}}:void 0},()=>{let b,G;const z=fi*fi,st=(dt,Vt,Pt=!1)=>{const te=Bo(dt,Vt);if(!Pt&&te<2)return!1;const Wt=Ot.filter(re=>!re.disableErase);let Ht;return Ht=te<z?xr(Ot,Dt(Vt),fi):io(Wt,Dt(dt),Dt(Vt),fi),pr(Ht).forEach(We),!0};return{start:dt=>{b=rt(Math.round(dt.detail.origin.x),Math.round(dt.detail.origin.y)),st(b,b,!0),G=b},update:dt=>{const{translation:Vt}=dt.detail,Pt=rt(Math.round(b.x+Vt.x),Math.round(b.y+Vt.y));st(G,Pt)&&(G=_e(Pt))},release:dt=>dt.detail.preventInertia(),end:()=>{}}},lo,xo,b=>{if(!lo())return Fp(b),Hn(b)},bo,Fr,(b={})=>({id:ra(),...b}),yr,to,dn,Qn,(b,G,z=!0)=>{Ot.forEach(st=>Qn(st,b,G,!1)),z&&yr()},vo,Dr,ki,Pn,Zn,eo,Zr,ur,co,pr,jn,uo,xr,io,go,ao,ci,Kt,br,_r,c,ht,r,$t,ct,Lt,N,et,ft,Y,oe,Z,mt,nt,St,B,a,y,H,V,L,T,n,P,I,O,f,v,d,o,u,Ot,wt,yt,Gt,function(b){jr.call(this,t,b)},b=>un(we[b]),function(b){zi[b?"unshift":"push"](()=>{qe=b,i(8,qe)})},function(){S=this.value,i(23,S),i(11,F),i(146,r),i(164,L),i(0,_),i(175,Ot)},function(b){zi[b?"unshift":"push"](()=>{qe=b,i(8,qe)})},()=>{pa&&pa.focus()},b=>i(9,Xn=b.detail),function(b){zi[b?"unshift":"push"](()=>{pa=b,i(19,pa)})},b=>eh(b,Ze)]}class TS extends li{constructor(e){super(),si(this,e,CS,kS,ei,{uid:57,ui:58,disabled:0,shapes:1,selection:59,offset:2,contextRotation:60,contextFlipX:61,contextFlipY:62,contextZoom:63,active:64,opacity:65,parentRect:66,rootRect:3,utilRect:67,hoverColor:68,caretColor:69,gridColor:70,snapColor:71,textInputMode:4,oninteractionstart:72,oninteractionupdate:73,oninteractionrelease:74,oninteractionend:75,oninteractioncancel:76,onaddshape:77,onupdateshape:78,onselectshape:79,onblurshape:80,onremoveshape:81,ontapshape:82,onhovershape:83,onhovercanvas:84,ontapcanvas:85,onleavecanvas:86,beforeSelectShape:87,beforeDeselectShape:88,beforeRemoveShape:89,beforeUpdateShape:90,willRenderShapeControls:91,willRenderShapeTextControls:92,willStartInteraction:93,mapEditorPointToImagePoint:94,mapImagePointToEditorPoint:95,eraseRadius:96,selectRadius:97,enableButtonFlipVertical:98,enableTapToAddText:99,enableTextStyleControls:5,locale:6,snapThreshold:100,snapPointer:101,enableSnapToContext:102,gridSize:103,syncShapeCollection:104,getShapeDraft:105,addShapeDraft:106,discardShapeDraft:107,confirmShapeDraft:108,updateShapeDraft:109,addShape:110,createShape:111,eraseShape:112,getMarkupItemDraft:113,getMarkupItemDraftIndex:114,addMarkupItemDraft:115,confirmMarkupItemDraft:116,discardMarkupItemDraft:117,createMarkupItem:118,syncShapes:119,removeMarkupShapeProps:120,updateMarkupShape:121,updateMarkupShapeProperty:122,updateMarkupItemsShapeProperty:123,updateMarkupShapeItems:124,getActiveMarkupItem:125,hasActiveMarkupItem:126,removeShape:127,removeActiveMarkupItem:128,blurShapes:129,selectShape:7,deselectMarkupItem:130,editMarkupItem:131,finishEditMarkupItem:132,removeMarkupItems:133,getTextShapeRect:134,getMarkupShapeRect:135,getShapesNearPosition:136,getShapesBetweenPoints:137},null,[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1])}get syncShapeCollection(){return this.$$.ctx[104]}get getShapeDraft(){return this.$$.ctx[105]}get addShapeDraft(){return this.$$.ctx[106]}get discardShapeDraft(){return this.$$.ctx[107]}get confirmShapeDraft(){return this.$$.ctx[108]}get updateShapeDraft(){return this.$$.ctx[109]}get addShape(){return this.$$.ctx[110]}get createShape(){return this.$$.ctx[111]}get eraseShape(){return this.$$.ctx[112]}get getMarkupItemDraft(){return this.$$.ctx[113]}get getMarkupItemDraftIndex(){return this.$$.ctx[114]}get addMarkupItemDraft(){return this.$$.ctx[115]}get confirmMarkupItemDraft(){return this.$$.ctx[116]}get discardMarkupItemDraft(){return this.$$.ctx[117]}get createMarkupItem(){return this.$$.ctx[118]}get syncShapes(){return this.$$.ctx[119]}get removeMarkupShapeProps(){return this.$$.ctx[120]}get updateMarkupShape(){return this.$$.ctx[121]}get updateMarkupShapeProperty(){return this.$$.ctx[122]}get updateMarkupItemsShapeProperty(){return this.$$.ctx[123]}get updateMarkupShapeItems(){return this.$$.ctx[124]}get getActiveMarkupItem(){return this.$$.ctx[125]}get hasActiveMarkupItem(){return this.$$.ctx[126]}get removeShape(){return this.$$.ctx[127]}get removeActiveMarkupItem(){return this.$$.ctx[128]}get blurShapes(){return this.$$.ctx[129]}get selectShape(){return this.$$.ctx[7]}get deselectMarkupItem(){return this.$$.ctx[130]}get editMarkupItem(){return this.$$.ctx[131]}get finishEditMarkupItem(){return this.$$.ctx[132]}get removeMarkupItems(){return this.$$.ctx[133]}get getTextShapeRect(){return this.$$.ctx[134]}get getMarkupShapeRect(){return this.$$.ctx[135]}get getShapesNearPosition(){return this.$$.ctx[136]}get getShapesBetweenPoints(){return this.$$.ctx[137]}}function MS(t){let e,i,n;return i=new $o({props:{items:t[2]}}),{c(){e=pt("ul"),At(i.$$.fragment),w(e,"class","PinturaShapeStyleList")},m(r,o){tt(r,e,o),It(i,e,null),n=!0},p(r,o){const a={};4&o&&(a.items=r[2]),i.$set(a)},i(r){n||(M(i.$$.fragment,r),n=!0)},o(r){D(i.$$.fragment,r),n=!1},d(r){r&&Q(e),Et(i)}}}function PS(t){let e,i;return e=new ka({props:{class:"PinturaShapeStyles",elasticity:t[0],$$slots:{default:[RS]},$$scope:{ctx:t}}}),{c(){At(e.$$.fragment)},m(n,r){It(e,n,r),i=!0},p(n,r){const o={};1&r&&(o.elasticity=n[0]),131076&r&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){D(e.$$.fragment,n),i=!1},d(n){Et(e,n)}}}function RS(t){let e,i,n;return i=new $o({props:{items:t[2]}}),{c(){e=pt("ul"),At(i.$$.fragment),w(e,"class","PinturaShapeStyleList")},m(r,o){tt(r,e,o),It(i,e,null),n=!0},p(r,o){const a={};4&o&&(a.items=r[2]),i.$set(a)},i(r){n||(M(i.$$.fragment,r),n=!0)},o(r){D(i.$$.fragment,r),n=!1},d(r){r&&Q(e),Et(i)}}}function IS(t){let e,i,n,r;const o=[PS,MS],a=[];function s(l,c){return l[1]?0:1}return i=s(t),n=a[i]=o[i](t),{c(){e=pt("div"),n.c(),w(e,"style",t[3])},m(l,c){tt(l,e,c),a[i].m(e,null),r=!0},p(l,[c]){let d=i;i=s(l),i===d?a[i].p(l,c):(Fe(),D(a[d],1,1,()=>{a[d]=null}),De(),n=a[i],n?n.p(l,c):(n=a[i]=o[i](l),n.c()),M(n,1),n.m(e,null)),(!r||8&c)&&w(e,"style",l[3])},i(l){r||(M(n),r=!0)},o(l){D(n),r=!1},d(l){l&&Q(e),a[i].d()}}}function ES(t,e,i){let n,r,o,a,s,l,{isActive:c=!1}=e,{controls:d=[]}=e,{locale:u}=e,{scrollElasticity:p}=e,{scrollEnable:h=!0}=e,{hideTitles:g=!1}=e,{willRenderControls:m=Xi}=e;const f=sn("redrawTrigger");A(t,f,C=>i(14,a=C));const x=sn("env");A(t,x,C=>i(13,o=C));const k=sn("isAnimated");A(t,k,C=>i(16,l=C));const v=ai(0,{stiffness:.25,damping:.9});return A(t,v,C=>i(15,s=C)),t.$$set=C=>{"isActive"in C&&i(8,c=C.isActive),"controls"in C&&i(9,d=C.controls),"locale"in C&&i(10,u=C.locale),"scrollElasticity"in C&&i(0,p=C.scrollElasticity),"scrollEnable"in C&&i(1,h=C.scrollEnable),"hideTitles"in C&&i(11,g=C.hideTitles),"willRenderControls"in C&&i(12,m=C.willRenderControls)},t.$$.update=()=>{65792&t.$$.dirty&&v.set(c?1:0,{hard:l===!1}),33024&t.$$.dirty&&i(3,n=`opacity:${s};${c?"":"pointer-events:none;"}${s<=0?"visibility:hidden":""}`),32256&t.$$.dirty&&i(2,r=a&&m(d.map(C=>["ShapeStyle",C.id,{title:C.componentProps.title,locale:u,hideTitle:g,items:[[C.component,C.id,C.componentProps]]}]),o,()=>f.set({})))},[p,h,r,n,f,x,k,v,c,d,u,g,m,o,a,s,l]}class AS extends li{constructor(e){super(),si(this,e,ES,IS,ei,{isActive:8,controls:9,locale:10,scrollElasticity:0,scrollEnable:1,hideTitles:11,willRenderControls:12})}}function gf(t,e,i){const n=t.slice();return n[15]=e[i].key,n[6]=e[i].controls,n[16]=e[i].isActive,n}function ff(t,e){let i,n,r;return n=new AS({props:{isActive:e[16],controls:e[6],locale:e[1],scrollElasticity:e[2],scrollEnable:e[3],hideTitles:e[4],willRenderControls:e[5]}}),{key:t,first:null,c(){i=Tn(),At(n.$$.fragment),this.first=i},m(o,a){tt(o,i,a),It(n,o,a),r=!0},p(o,a){e=o;const s={};128&a&&(s.isActive=e[16]),128&a&&(s.controls=e[6]),2&a&&(s.locale=e[1]),4&a&&(s.scrollElasticity=e[2]),8&a&&(s.scrollEnable=e[3]),16&a&&(s.hideTitles=e[4]),32&a&&(s.willRenderControls=e[5]),n.$set(s)},i(o){r||(M(n.$$.fragment,o),r=!0)},o(o){D(n.$$.fragment,o),r=!1},d(o){o&&Q(i),Et(n,o)}}}function LS(t){let e,i,n,r=[],o=new Map,a=t[7];const s=l=>l[15];for(let l=0;l<a.length;l+=1){let c=gf(t,a,l),d=s(c);o.set(d,r[l]=ff(d,c))}return{c(){e=pt("div");for(let l=0;l<r.length;l+=1)r[l].c();w(e,"class",i=ui(["PinturaShapeStyleEditor",!t[3]&&"PinturaShapeStyleEditorOverflow",t[0]]))},m(l,c){tt(l,e,c);for(let d=0;d<r.length;d+=1)r[d].m(e,null);n=!0},p(l,[c]){190&c&&(a=l[7],Fe(),r=Aa(r,c,s,1,l,a,o,e,Ss,ff,null,gf),De()),(!n||9&c&&i!==(i=ui(["PinturaShapeStyleEditor",!l[3]&&"PinturaShapeStyleEditorOverflow",l[0]])))&&w(e,"class",i)},i(l){if(!n){for(let c=0;c<a.length;c+=1)M(r[c]);n=!0}},o(l){for(let c=0;c<r.length;c+=1)D(r[c]);n=!1},d(l){l&&Q(e);for(let c=0;c<r.length;c+=1)r[c].d()}}}function zS(t,e,i){let n,r,o,{class:a}=e,{controls:s={}}=e,{shape:l}=e,{onchange:c}=e,{locale:d}=e,{scrollElasticity:u}=e,{scrollEnable:p=!0}=e,{hideTitles:h=!1}=e,{willRenderControls:g}=e;const m=[];return t.$$set=f=>{"class"in f&&i(0,a=f.class),"controls"in f&&i(6,s=f.controls),"shape"in f&&i(8,l=f.shape),"onchange"in f&&i(9,c=f.onchange),"locale"in f&&i(1,d=f.locale),"scrollElasticity"in f&&i(2,u=f.scrollElasticity),"scrollEnable"in f&&i(3,p=f.scrollEnable),"hideTitles"in f&&i(4,h=f.hideTitles),"willRenderControls"in f&&i(5,g=f.willRenderControls)},t.$$.update=()=>{64&t.$$.dirty&&i(11,n=Object.keys(s).filter(f=>s[f])),2304&t.$$.dirty&&i(10,r=l&&Object.keys(l).length&&n&&Dp(l)?(f=>n.filter(x=>x.split("_").every(k=>ze(f,k)&&Dp(f,k))).map(x=>{const k=(f.settings&&f.settings[x]||{}).control||x,v=x.split("_"),C=v.length>1?v.map(T=>f[T]):f[x];if(tn(s[k])){const{title:T,component:L}=s[k](C,F=>{c({[x]:F})},{selectedShapeId:f.id});return{id:k,component:$o,componentProps:{title:T,items:L}}}let[P,I]=s[k];if(Oe(P)&&s[P]){const T={...I};[P,I]=s[P],I={...I,...T}}const O=tn(I.options)?I.options(f):I.options;return{id:k,component:P,componentProps:{...I,options:O,locale:d,value:C,optionLabelClass:"PinturaButtonLabel",onchange:T=>{const L=nl(T)&&!En(T)?T.value:T;I.onchange&&I.onchange(L,f);const F=v.length>1?v.reduce((B,y,V)=>({...B,[y]:Array.isArray(L)?L[V]:L}),{}):{[x]:L};c(F)}}}}).filter(Boolean))(l):[]),1280&t.$$.dirty&&i(7,o=((f,x)=>{let k=m.find(v=>v.key===f);return k||(k={key:f,controls:x},m.push(k)),m.forEach(v=>v.isActive=!1),k.controls=x,k.isActive=!0,m})(l&&Object.keys(l).length?Object.keys(l).join("_"):"none",r||[]))},[a,d,u,p,h,g,s,o,l,c,r,n]}class Pu extends li{constructor(e){super(),si(this,e,zS,LS,ei,{class:0,controls:6,shape:8,onchange:9,locale:1,scrollElasticity:2,scrollEnable:3,hideTitles:4,willRenderControls:5})}}var W2=t=>/<svg /.test(t);function FS(t){let e,i;return e=new $o({props:{items:t[10]}}),{c(){At(e.$$.fragment)},m(n,r){It(e,n,r),i=!0},p(n,r){const o={};1024&r&&(o.items=n[10]),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){D(e.$$.fragment,n),i=!1},d(n){Et(e,n)}}}function DS(t){let e,i,n,r;const o=[OS,BS],a=[];function s(l,c){return l[8]?0:1}return e=s(t),i=a[e]=o[e](t),{c(){i.c(),n=Tn()},m(l,c){a[e].m(l,c),tt(l,n,c),r=!0},p(l,c){let d=e;e=s(l),e===d?a[e].p(l,c):(Fe(),D(a[d],1,1,()=>{a[d]=null}),De(),i=a[e],i?i.p(l,c):(i=a[e]=o[e](l),i.c()),M(i,1),i.m(n.parentNode,n))},i(l){r||(M(i),r=!0)},o(l){D(i),r=!1},d(l){a[e].d(l),l&&Q(n)}}}function BS(t){let e,i,n,r,o=t[10]&&yf(t);return n=new ka({props:{scrollAutoCancel:t[9],elasticity:t[0],$$slots:{default:[WS]},$$scope:{ctx:t}}}),{c(){e=pt("div"),o&&o.c(),i=de(),At(n.$$.fragment),w(e,"class","PinturaShapePresetsFlat")},m(a,s){tt(a,e,s),o&&o.m(e,null),Tt(e,i),It(n,e,null),r=!0},p(a,s){a[10]?o?(o.p(a,s),1024&s&&M(o,1)):(o=yf(a),o.c(),M(o,1),o.m(e,i)):o&&(Fe(),D(o,1,1,()=>{o=null}),De());const l={};512&s&&(l.scrollAutoCancel=a[9]),1&s&&(l.elasticity=a[0]),536871070&s&&(l.$$scope={dirty:s,ctx:a}),n.$set(l)},i(a){r||(M(o),M(n.$$.fragment,a),r=!0)},o(a){D(o),D(n.$$.fragment,a),r=!1},d(a){a&&Q(e),o&&o.d(),Et(n)}}}function OS(t){let e,i,n,r,o;i=new ka({props:{elasticity:t[0],class:"PinturaShapePresetsGroups",$$slots:{default:[NS]},$$scope:{ctx:t}}});const a=[{class:"PinturaControlPanels"},{panelClass:"PinturaControlPanel"},{panels:t[11]},t[12]];let s={$$slots:{default:[jS,({panel:l,panelIsActive:c})=>({26:l,27:c}),({panel:l,panelIsActive:c})=>(l?67108864:0)|(c?134217728:0)]},$$scope:{ctx:t}};for(let l=0;l<a.length;l+=1)s=Cn(s,a[l]);return r=new Su({props:s}),{c(){e=pt("div"),At(i.$$.fragment),n=de(),At(r.$$.fragment),w(e,"class","PinturaShapePresetsGrouped")},m(l,c){tt(l,e,c),It(i,e,null),Tt(e,n),It(r,e,null),o=!0},p(l,c){const d={};1&c&&(d.elasticity=l[0]),536876128&c&&(d.$$scope={dirty:c,ctx:l}),i.$set(d);const u=6144&c?Tr(a,[a[0],a[1],2048&c&&{panels:l[11]},4096&c&&zr(l[12])]):{};738206239&c&&(u.$$scope={dirty:c,ctx:l}),r.$set(u)},i(l){o||(M(i.$$.fragment,l),M(r.$$.fragment,l),o=!0)},o(l){D(i.$$.fragment,l),D(r.$$.fragment,l),o=!1},d(l){l&&Q(e),Et(i),Et(r)}}}function yf(t){let e,i;return e=new $o({props:{items:t[10]}}),{c(){At(e.$$.fragment)},m(n,r){It(e,n,r),i=!0},p(n,r){const o={};1024&r&&(o.items=n[10]),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){D(e.$$.fragment,n),i=!1},d(n){Et(e,n)}}}function WS(t){let e,i;return e=new Wh({props:{items:t[7],onclickitem:t[1],ongrabitem:t[2],ondragitem:t[3],ondropitem:t[4]}}),{c(){At(e.$$.fragment)},m(n,r){It(e,n,r),i=!0},p(n,r){const o={};128&r&&(o.items=n[7]),2&r&&(o.onclickitem=n[1]),4&r&&(o.ongrabitem=n[2]),8&r&&(o.ondragitem=n[3]),16&r&&(o.ondropitem=n[4]),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){D(e.$$.fragment,n),i=!1},d(n){Et(e,n)}}}function xf(t){let e,i;return e=new $o({props:{items:t[10]}}),{c(){At(e.$$.fragment)},m(n,r){It(e,n,r),i=!0},p(n,r){const o={};1024&r&&(o.items=n[10]),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){D(e.$$.fragment,n),i=!1},d(n){Et(e,n)}}}function bf(t){let e,i;return e=new Mo({props:{$$slots:{default:[_S]},$$scope:{ctx:t}}}),{c(){At(e.$$.fragment)},m(n,r){It(e,n,r),i=!0},p(n,r){const o={};805306368&r&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){D(e.$$.fragment,n),i=!1},d(n){Et(e,n)}}}function _S(t){let e,i=t[28].icon+"";return{c(){e=Cr("g")},m(n,r){tt(n,e,r),e.innerHTML=i},p(n,r){268435456&r&&i!==(i=n[28].icon+"")&&(e.innerHTML=i)},d(n){n&&Q(e)}}}function vf(t){let e,i,n=t[28].label+"";return{c(){e=pt("span"),i=cn(n)},m(r,o){tt(r,e,o),Tt(e,i)},p(r,o){268435456&o&&n!==(n=r[28].label+"")&&An(i,n)},d(r){r&&Q(e)}}}function VS(t){let e,i,n,r=t[28].icon&&bf(t),o=!t[28].hideLabel&&vf(t);return{c(){r&&r.c(),e=de(),o&&o.c(),i=Tn()},m(a,s){r&&r.m(a,s),tt(a,e,s),o&&o.m(a,s),tt(a,i,s),n=!0},p(a,s){a[28].icon?r?(r.p(a,s),268435456&s&&M(r,1)):(r=bf(a),r.c(),M(r,1),r.m(e.parentNode,e)):r&&(Fe(),D(r,1,1,()=>{r=null}),De()),a[28].hideLabel?o&&(o.d(1),o=null):o?o.p(a,s):(o=vf(a),o.c(),o.m(i.parentNode,i))},i(a){n||(M(r),n=!0)},o(a){D(r),n=!1},d(a){r&&r.d(a),a&&Q(e),o&&o.d(a),a&&Q(i)}}}function NS(t){let e,i,n,r=t[10]&&xf(t);const o=[{class:"PinturaControlList"},{tabs:t[5]},t[12],{layout:"compact"}];let a={$$slots:{default:[VS,({tab:s})=>({28:s}),({tab:s})=>s?268435456:0]},$$scope:{ctx:t}};for(let s=0;s<o.length;s+=1)a=Cn(a,o[s]);return i=new wu({props:a}),i.$on("select",t[18]),{c(){r&&r.c(),e=de(),At(i.$$.fragment)},m(s,l){r&&r.m(s,l),tt(s,e,l),It(i,s,l),n=!0},p(s,l){s[10]?r?(r.p(s,l),1024&l&&M(r,1)):(r=xf(s),r.c(),M(r,1),r.m(e.parentNode,e)):r&&(Fe(),D(r,1,1,()=>{r=null}),De());const c=4128&l?Tr(o,[o[0],32&l&&{tabs:s[5]},4096&l&&zr(s[12]),o[3]]):{};805306368&l&&(c.$$scope={dirty:l,ctx:s}),i.$set(c)},i(s){n||(M(r),M(i.$$.fragment,s),n=!0)},o(s){D(r),D(i.$$.fragment,s),n=!1},d(s){r&&r.d(s),s&&Q(e),Et(i,s)}}}function HS(t){let e,i;return e=new Wh({props:{items:t[13][t[26]].items,disabled:t[13][t[26]].disabled,onclickitem:t[1],ongrabitem:t[2],ondragitem:t[3],ondropitem:t[4]}}),{c(){At(e.$$.fragment)},m(n,r){It(e,n,r),i=!0},p(n,r){const o={};67117056&r&&(o.items=n[13][n[26]].items),67117056&r&&(o.disabled=n[13][n[26]].disabled),2&r&&(o.onclickitem=n[1]),4&r&&(o.ongrabitem=n[2]),8&r&&(o.ondragitem=n[3]),16&r&&(o.ondropitem=n[4]),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){D(e.$$.fragment,n),i=!1},d(n){Et(e,n)}}}function jS(t){let e,i;return e=new ka({props:{scroll:t[27]?{scrollOffset:0,animate:!1}:void 0,scrollAutoCancel:t[9],elasticity:t[0],$$slots:{default:[HS]},$$scope:{ctx:t}}}),{c(){At(e.$$.fragment)},m(n,r){It(e,n,r),i=!0},p(n,r){const o={};134217728&r&&(o.scroll=n[27]?{scrollOffset:0,animate:!1}:void 0),512&r&&(o.scrollAutoCancel=n[9]),1&r&&(o.elasticity=n[0]),603987998&r&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){D(e.$$.fragment,n),i=!1},d(n){Et(e,n)}}}function US(t){let e,i,n,r;const o=[DS,FS],a=[];function s(l,c){return l[9]?0:l[10]?1:-1}return~(i=s(t))&&(n=a[i]=o[i](t)),{c(){e=pt("div"),n&&n.c(),w(e,"class","PinturaShapePresetsPalette")},m(l,c){tt(l,e,c),~i&&a[i].m(e,null),r=!0},p(l,[c]){let d=i;i=s(l),i===d?~i&&a[i].p(l,c):(n&&(Fe(),D(a[d],1,1,()=>{a[d]=null}),De()),~i?(n=a[i],n?n.p(l,c):(n=a[i]=o[i](l),n.c()),M(n,1),n.m(e,null)):n=null)},i(l){r||(M(n),r=!0)},o(l){D(n),r=!1},d(l){l&&Q(e),~i&&a[i].d()}}}function GS(t,e,i){let n,r,o,a,s,l,c,d,u,{locale:p}=e,{presets:h}=e,{scrollElasticity:g}=e,{enableSelectImage:m=!0}=e,{willRenderPresetToolbar:f=Xi}=e,{onaddpreset:x=$e}=e,{ongrabpreset:k}=e,{ondragpreset:v}=e,{ondroppreset:C}=e;const P="presets-"+ra(),I=(F,B="")=>W2(F)?F:au(F)?dy(F,B):`<img src="${F}" alt="${B}"/>`,O=F=>Uf(ph(F)),T=["src","alt","thumb","shape","id","mount","disabled"],L=F=>F.map(B=>(y=>En(y)&&Oe(y[0])&&En(y[1]))(B)?{...B[2],id:`${P}-${B[0].toLowerCase()}`,label:B[0],items:L(B[1])}:(y=>{let V,J,S,H,K,ut,lt,N=y;return Oe(y)?au(y)?(V=y,K=y,H=I(V,K)):(V=y,K=O(V),H=I(V,K)):(V=y.src,K=y.alt||(Oe(V)?O(V):Oe(y.thumb)?O(y.thumb):void 0),H=I(y.thumb||V,K),J=y.shape,ut=y.mount,lt=y.disabled,S=Object.keys(y).reduce((ft,$t)=>(T.includes($t)||(ft[$t]=y[$t]),ft),{})),{id:N,src:V,thumb:H,shape:J,shapeProps:S,alt:K,title:K,mount:ut,disabled:lt}})(B));return t.$$set=F=>{"locale"in F&&i(14,p=F.locale),"presets"in F&&i(15,h=F.presets),"scrollElasticity"in F&&i(0,g=F.scrollElasticity),"enableSelectImage"in F&&i(16,m=F.enableSelectImage),"willRenderPresetToolbar"in F&&i(17,f=F.willRenderPresetToolbar),"onaddpreset"in F&&i(1,x=F.onaddpreset),"ongrabpreset"in F&&i(2,k=F.ongrabpreset),"ondragpreset"in F&&i(3,v=F.ondragpreset),"ondroppreset"in F&&i(4,C=F.ondroppreset)},t.$$.update=()=>{32768&t.$$.dirty&&i(7,n=L(h)),128&t.$$.dirty&&i(9,r=n.length),640&t.$$.dirty&&i(8,o=r&&n.some(F=>!!F.items)),384&t.$$.dirty&&i(5,a=o&&n),384&t.$$.dirty&&i(13,s=o&&n.reduce((F,B)=>(F[B.id]=B,F),{})),96&t.$$.dirty&&i(6,l=l||a&&(a.find(F=>!F.disabled)||{}).id),64&t.$$.dirty&&i(12,c={name:P,selected:l}),32&t.$$.dirty&&i(11,d=a&&a.map(F=>F.id)),212994&t.$$.dirty&&i(10,u=p&&f([m&&["Button","browse",{label:p.shapeLabelButtonSelectSticker,icon:p.shapeIconButtonSelectSticker,onclick:()=>{S2().then(F=>{F&&x(F)})}}]]))},[g,x,k,v,C,a,l,n,o,r,u,d,c,s,p,h,m,f,({detail:F})=>i(6,l=F)]}class _2 extends li{constructor(e){super(),si(this,e,GS,US,ei,{locale:14,presets:15,scrollElasticity:0,enableSelectImage:16,willRenderPresetToolbar:17,onaddpreset:1,ongrabpreset:2,ondragpreset:3,ondroppreset:4})}}function ZS(t){let e,i,n,r;return e=new $o({props:{items:t[29]}}),n=new Pu({props:{locale:t[4],shape:t[31]||t[49],onchange:t[86],controls:t[9],scrollEnable:!1,hideTitles:!0,willRenderControls:t[162]}}),{c(){At(e.$$.fragment),i=de(),At(n.$$.fragment)},m(o,a){It(e,o,a),tt(o,i,a),It(n,o,a),r=!0},p(o,a){const s={};536870912&a[0]&&(s.items=o[29]),e.$set(s);const l={};16&a[0]&&(l.locale=o[4]),262145&a[1]&&(l.shape=o[31]||o[49]),512&a[0]&&(l.controls=o[9]),n.$set(l)},i(o){r||(M(e.$$.fragment,o),M(n.$$.fragment,o),r=!0)},o(o){D(e.$$.fragment,o),D(n.$$.fragment,o),r=!1},d(o){Et(e,o),o&&Q(i),Et(n,o)}}}function XS(t){let e,i,n;return i=new D2({props:{$$slots:{default:[ZS]},$$scope:{ctx:t}}}),{c(){e=pt("div"),At(i.$$.fragment),w(e,"slot","header")},m(r,o){tt(r,e,o),It(i,e,null),n=!0},p(r,o){const a={};536871440&o[0]|262145&o[1]|1048576&o[6]&&(a.$$scope={dirty:o,ctx:r}),i.$set(a)},i(r){n||(M(i.$$.fragment,r),n=!0)},o(r){D(i.$$.fragment,r),n=!1},d(r){r&&Q(e),Et(i)}}}function wf(t){let e,i;const n=[{locale:t[4]},{ui:t[69]},{shapes:t[5]},{selection:t[58]},{uid:t[19]},{parentRect:t[37]},{rootRect:t[55]},{utilRect:t[39]},{offset:t[50]},{disabled:t[38]},{contextRotation:t[22]},{contextFlipX:t[23]},{contextFlipY:t[24]},{contextZoom:t[36]?t[36].scale:void 0},{active:t[35]},{opacity:t[56]},{hoverColor:t[57]},{caretColor:t[57]},{snapColor:t[57]},{gridColor:[1,1,1,.125]},{eraseRadius:t[47]},{selectRadius:t[6]},{enableButtonFlipVertical:t[10]},{mapEditorPointToImagePoint:t[20]},{mapImagePointToEditorPoint:t[21]},{enableTapToAddText:t[13]},{textInputMode:t[8]},{snapThreshold:t[15]},{snapPointer:!t[48]},{enableSnapToContext:t[16]},{gridSize:t[14]},{willStartInteraction:t[96]},{oninteractionstart:t[80]},{oninteractionupdate:t[81]},{oninteractionrelease:t[82]},{oninteractionend:t[84]},{oninteractioncancel:t[83]},{onleavecanvas:t[88]},{onhovercanvas:t[87]},{onhovershape:t[90]},{ontapcanvas:t[89]},{onaddshape:t[154]},{onselectshape:t[155]},{onblurshape:t[156]},{ontapshape:t[157]},{onupdateshape:t[158]},{onremoveshape:t[159]},t[42]];let r={};for(let o=0;o<n.length;o+=1)r=Cn(r,n[o]);return e=new TS({props:r}),t[160](e),{c(){At(e.$$.fragment)},m(o,a){It(e,o,a),i=!0},p(o,a){const s=1106896240&a[0]|252381680&a[1]|511443072&a[2]|24&a[3]?Tr(n,[16&a[0]&&{locale:o[4]},128&a[2]&&{ui:o[69]},32&a[0]&&{shapes:o[5]},134217728&a[1]&&{selection:o[58]},524288&a[0]&&{uid:o[19]},64&a[1]&&{parentRect:o[37]},16777216&a[1]&&{rootRect:o[55]},256&a[1]&&{utilRect:o[39]},524288&a[1]&&{offset:o[50]},128&a[1]&&{disabled:o[38]},4194304&a[0]&&{contextRotation:o[22]},8388608&a[0]&&{contextFlipX:o[23]},16777216&a[0]&&{contextFlipY:o[24]},32&a[1]&&{contextZoom:o[36]?o[36].scale:void 0},16&a[1]&&{active:o[35]},33554432&a[1]&&{opacity:o[56]},67108864&a[1]&&{hoverColor:o[57]},67108864&a[1]&&{caretColor:o[57]},67108864&a[1]&&{snapColor:o[57]},n[19],65536&a[1]&&{eraseRadius:o[47]},64&a[0]&&{selectRadius:o[6]},1024&a[0]&&{enableButtonFlipVertical:o[10]},1048576&a[0]&&{mapEditorPointToImagePoint:o[20]},2097152&a[0]&&{mapImagePointToEditorPoint:o[21]},8192&a[0]&&{enableTapToAddText:o[13]},256&a[0]&&{textInputMode:o[8]},32768&a[0]&&{snapThreshold:o[15]},131072&a[1]&&{snapPointer:!o[48]},65536&a[0]&&{enableSnapToContext:o[16]},16384&a[0]&&{gridSize:o[14]},8&a[3]&&{willStartInteraction:o[96]},262144&a[2]&&{oninteractionstart:o[80]},524288&a[2]&&{oninteractionupdate:o[81]},1048576&a[2]&&{oninteractionrelease:o[82]},4194304&a[2]&&{oninteractionend:o[84]},2097152&a[2]&&{oninteractioncancel:o[83]},67108864&a[2]&&{onleavecanvas:o[88]},33554432&a[2]&&{onhovercanvas:o[87]},268435456&a[2]&&{onhovershape:o[90]},134217728&a[2]&&{ontapcanvas:o[89]},1073741824&a[0]|16&a[3]&&{onaddshape:o[154]},1073741824&a[0]&&{onselectshape:o[155]},1073741824&a[0]&&{onblurshape:o[156]},1073741824&a[0]&&{ontapshape:o[157]},1073741824&a[0]|16&a[3]&&{onupdateshape:o[158]},1073741824&a[0]|16&a[3]&&{onremoveshape:o[159]},2048&a[1]&&zr(o[42])]):{};e.$set(s)},i(o){i||(M(e.$$.fragment,o),i=!0)},o(o){D(e.$$.fragment,o),i=!1},d(o){t[160](null),Et(e,o)}}}function YS(t){let e,i,n,r,o,a=t[51]&&wf(t);return{c(){e=pt("div"),a&&a.c(),w(e,"slot","main"),w(e,"style",i="cursor:"+t[46])},m(s,l){tt(s,e,l),a&&a.m(e,null),t[161](e),n=!0,r||(o=[Mt(e,"keydown",t[85]),Ui(r2.call(null,e)),Mt(e,"dropfiles",function(){ji(t[12]?t[95]:$e)&&(t[12]?t[95]:$e).apply(this,arguments)}),Ui(Mr.call(null,e)),Mt(e,"measure",t[150])],r=!0)},p(s,l){(t=s)[51]?a?(a.p(t,l),1048576&l[1]&&M(a,1)):(a=wf(t),a.c(),M(a,1),a.m(e,null)):a&&(Fe(),D(a,1,1,()=>{a=null}),De()),(!n||32768&l[1]&&i!==(i="cursor:"+t[46]))&&w(e,"style",i)},i(s){n||(M(a),n=!0)},o(s){D(a),n=!1},d(s){s&&Q(e),a&&a.d(),t[161](null),r=!1,_i(o)}}}function qS(t){let e,i;return e=new _2({props:{locale:t[4],presets:t[18],enableSelectImage:t[11],willRenderPresetToolbar:t[43],onaddpreset:t[94],ongrabpreset:t[91],ondragpreset:t[92],ondroppreset:t[93],scrollElasticity:t[44]}}),{c(){At(e.$$.fragment)},m(n,r){It(e,n,r),i=!0},p(n,r){const o={};16&r[0]&&(o.locale=n[4]),262144&r[0]&&(o.presets=n[18]),2048&r[0]&&(o.enableSelectImage=n[11]),4096&r[1]&&(o.willRenderPresetToolbar=n[43]),8192&r[1]&&(o.scrollElasticity=n[44]),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){D(e.$$.fragment,n),i=!1},d(n){Et(e,n)}}}function KS(t){let e,i,n,r=t[7]==="stack"&&Sf(t),o=(t[53]&&t[34]||t[7]==="row")&&kf(t);return{c(){r&&r.c(),e=de(),o&&o.c(),i=Tn()},m(a,s){r&&r.m(a,s),tt(a,e,s),o&&o.m(a,s),tt(a,i,s),n=!0},p(a,s){a[7]==="stack"?r?(r.p(a,s),128&s[0]&&M(r,1)):(r=Sf(a),r.c(),M(r,1),r.m(e.parentNode,e)):r&&(Fe(),D(r,1,1,()=>{r=null}),De()),a[53]&&a[34]||a[7]==="row"?o?(o.p(a,s),128&s[0]|4194312&s[1]&&M(o,1)):(o=kf(a),o.c(),M(o,1),o.m(i.parentNode,i)):o&&(Fe(),D(o,1,1,()=>{o=null}),De())},i(a){n||(M(r),M(o),n=!0)},o(a){D(r),D(o),n=!1},d(a){r&&r.d(a),a&&Q(e),o&&o.d(a),a&&Q(i)}}}function Sf(t){let e,i,n,r;const o=[QS,JS],a=[];function s(l,c){return l[45]?0:1}return i=s(t),n=a[i]=o[i](t),{c(){e=pt("div"),n.c(),w(e,"class","PinturaControlPanels")},m(l,c){tt(l,e,c),a[i].m(e,null),r=!0},p(l,c){let d=i;i=s(l),i===d?a[i].p(l,c):(Fe(),D(a[d],1,1,()=>{a[d]=null}),De(),n=a[i],n?n.p(l,c):(n=a[i]=o[i](l),n.c()),M(n,1),n.m(e,null))},i(l){r||(M(n),r=!0)},o(l){D(n),r=!1},d(l){l&&Q(e),a[i].d()}}}function JS(t){let e,i,n;return i=new Pu({props:{locale:t[4],shape:t[31]||t[49],onchange:t[86],controls:t[9],scrollElasticity:t[44],willRenderControls:t[17]}}),{c(){e=pt("div"),At(i.$$.fragment),w(e,"class","PinturaControlPanel")},m(r,o){tt(r,e,o),It(i,e,null),n=!0},p(r,o){const a={};16&o[0]&&(a.locale=r[4]),262145&o[1]&&(a.shape=r[31]||r[49]),512&o[0]&&(a.controls=r[9]),8192&o[1]&&(a.scrollElasticity=r[44]),131072&o[0]&&(a.willRenderControls=r[17]),i.$set(a)},i(r){n||(M(i.$$.fragment,r),n=!0)},o(r){D(i.$$.fragment,r),n=!1},d(r){r&&Q(e),Et(i)}}}function QS(t){let e,i,n;return i=new _2({props:{locale:t[4],presets:t[18],enableSelectImage:t[11],willRenderPresetToolbar:t[43],onaddpreset:t[94],ongrabpreset:t[91],ondragpreset:t[92],ondroppreset:t[93],scrollElasticity:t[44]}}),{c(){e=pt("div"),At(i.$$.fragment),w(e,"class","PinturaControlPanel")},m(r,o){tt(r,e,o),It(i,e,null),n=!0},p(r,o){const a={};16&o[0]&&(a.locale=r[4]),262144&o[0]&&(a.presets=r[18]),2048&o[0]&&(a.enableSelectImage=r[11]),4096&o[1]&&(a.willRenderPresetToolbar=r[43]),8192&o[1]&&(a.scrollElasticity=r[44]),i.$set(a)},i(r){n||(M(i.$$.fragment,r),n=!0)},o(r){D(i.$$.fragment,r),n=!1},d(r){r&&Q(e),Et(i)}}}function kf(t){let e,i;return e=new ka({props:{class:"PinturaControlListScroller",elasticity:t[44],$$slots:{default:[i6]},$$scope:{ctx:t}}}),{c(){At(e.$$.fragment)},m(n,r){It(e,n,r),i=!0},p(n,r){const o={};8192&r[1]&&(o.elasticity=n[44]),131729&r[0]|262155&r[1]|1048576&r[6]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){D(e.$$.fragment,n),i=!1},d(n){Et(e,n)}}}function Cf(t){let e,i;return e=new Qa({props:{locale:t[4],class:"PinturaControlList",optionClass:"PinturaControlListOption",layout:"row",options:t[32],selectedIndex:t[32].findIndex(t[151]),onchange:t[79],$$slots:{option:[e6,({option:n})=>({205:n}),({option:n})=>[0,0,0,0,0,0,n?524288:0]]},$$scope:{ctx:t}}}),{c(){At(e.$$.fragment)},m(n,r){It(e,n,r),i=!0},p(n,r){const o={};16&r[0]&&(o.locale=n[4]),2&r[1]&&(o.options=n[32]),1&r[0]|2&r[1]&&(o.selectedIndex=n[32].findIndex(n[151])),16&r[0]|1572864&r[6]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){D(e.$$.fragment,n),i=!1},d(n){Et(e,n)}}}function Tf(t){let e,i;return e=new Mo({props:{$$slots:{default:[t6]},$$scope:{ctx:t}}}),{c(){At(e.$$.fragment)},m(n,r){It(e,n,r),i=!0},p(n,r){const o={};16&r[0]|1572864&r[6]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){D(e.$$.fragment,n),i=!1},d(n){Et(e,n)}}}function t6(t){let e,i=(tn(t[205].icon)?t[205].icon(t[4]):t[205].icon)+"";return{c(){e=Cr("g")},m(n,r){tt(n,e,r),e.innerHTML=i},p(n,r){16&r[0]|524288&r[6]&&i!==(i=(tn(n[205].icon)?n[205].icon(n[4]):n[205].icon)+"")&&(e.innerHTML=i)},d(n){n&&Q(e)}}}function Mf(t){let e,i,n=(tn(t[205].label)?t[205].label(t[4]):t[205].label)+"";return{c(){e=pt("span"),i=cn(n)},m(r,o){tt(r,e,o),Tt(e,i)},p(r,o){16&o[0]|524288&o[6]&&n!==(n=(tn(r[205].label)?r[205].label(r[4]):r[205].label)+"")&&An(i,n)},d(r){r&&Q(e)}}}function e6(t){let e,i,n,r=t[205].icon&&Tf(t),o=!t[205].hideLabel&&Mf(t);return{c(){e=pt("div"),r&&r.c(),i=de(),o&&o.c(),w(e,"slot","option")},m(a,s){tt(a,e,s),r&&r.m(e,null),Tt(e,i),o&&o.m(e,null),n=!0},p(a,s){a[205].icon?r?(r.p(a,s),524288&s[6]&&M(r,1)):(r=Tf(a),r.c(),M(r,1),r.m(e,i)):r&&(Fe(),D(r,1,1,()=>{r=null}),De()),a[205].hideLabel?o&&(o.d(1),o=null):o?o.p(a,s):(o=Mf(a),o.c(),o.m(e,null))},i(a){n||(M(r),n=!0)},o(a){D(r),n=!1},d(a){a&&Q(e),r&&r.d(),o&&o.d()}}}function Pf(t){let e,i;return e=new Pu({props:{locale:t[4],shape:t[31]||t[49],onchange:t[86],controls:t[9],scrollEnable:!1,hideTitles:!0,willRenderControls:t[152]}}),{c(){At(e.$$.fragment)},m(n,r){It(e,n,r),i=!0},p(n,r){const o={};16&r[0]&&(o.locale=n[4]),262145&r[1]&&(o.shape=n[31]||n[49]),512&r[0]&&(o.controls=n[9]),131072&r[0]&&(o.willRenderControls=n[152]),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){D(e.$$.fragment,n),i=!1},d(n){Et(e,n)}}}function i6(t){let e,i,n,r=t[34]&&Cf(t),o=t[7]==="row"&&Pf(t);return{c(){r&&r.c(),e=de(),o&&o.c(),i=Tn()},m(a,s){r&&r.m(a,s),tt(a,e,s),o&&o.m(a,s),tt(a,i,s),n=!0},p(a,s){a[34]?r?(r.p(a,s),8&s[1]&&M(r,1)):(r=Cf(a),r.c(),M(r,1),r.m(e.parentNode,e)):r&&(Fe(),D(r,1,1,()=>{r=null}),De()),a[7]==="row"?o?(o.p(a,s),128&s[0]&&M(o,1)):(o=Pf(a),o.c(),M(o,1),o.m(i.parentNode,i)):o&&(Fe(),D(o,1,1,()=>{o=null}),De())},i(a){n||(M(r),M(o),n=!0)},o(a){D(r),D(o),n=!1},d(a){r&&r.d(a),a&&Q(e),o&&o.d(a),a&&Q(i)}}}function Rf(t){let e,i;return e=new ka({props:{class:"PinturaControlListScroller",elasticity:t[44],$$slots:{default:[o6]},$$scope:{ctx:t}}}),{c(){At(e.$$.fragment)},m(n,r){It(e,n,r),i=!0},p(n,r){const o={};8192&r[1]&&(o.elasticity=n[44]),67108880&r[0]|8388608&r[1]|1048576&r[6]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){D(e.$$.fragment,n),i=!1},d(n){Et(e,n)}}}function If(t){let e,i;return e=new Mo({props:{$$slots:{default:[n6]},$$scope:{ctx:t}}}),{c(){At(e.$$.fragment)},m(n,r){It(e,n,r),i=!0},p(n,r){const o={};16&r[0]|1572864&r[6]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){D(e.$$.fragment,n),i=!1},d(n){Et(e,n)}}}function n6(t){let e,i=(tn(t[205].icon)?t[205].icon(t[4]):t[205].icon)+"";return{c(){e=Cr("g")},m(n,r){tt(n,e,r),e.innerHTML=i},p(n,r){16&r[0]|524288&r[6]&&i!==(i=(tn(n[205].icon)?n[205].icon(n[4]):n[205].icon)+"")&&(e.innerHTML=i)},d(n){n&&Q(e)}}}function r6(t){let e,i,n,r,o,a=(tn(t[205].label)?t[205].label(t[4]):t[205].label)+"",s=t[205].icon&&If(t);return{c(){e=pt("div"),s&&s.c(),i=de(),n=pt("span"),r=cn(a),w(e,"slot","option")},m(l,c){tt(l,e,c),s&&s.m(e,null),Tt(e,i),Tt(e,n),Tt(n,r),o=!0},p(l,c){l[205].icon?s?(s.p(l,c),524288&c[6]&&M(s,1)):(s=If(l),s.c(),M(s,1),s.m(e,i)):s&&(Fe(),D(s,1,1,()=>{s=null}),De()),(!o||16&c[0]|524288&c[6])&&a!==(a=(tn(l[205].label)?l[205].label(l[4]):l[205].label)+"")&&An(r,a)},i(l){o||(M(s),o=!0)},o(l){D(s),o=!1},d(l){l&&Q(e),s&&s.d()}}}function o6(t){let e,i;return e=new Qa({props:{locale:t[4],class:"PinturaControlList",optionClass:"PinturaControlListOption",layout:"row",options:t[54],selectedIndex:t[54].findIndex(t[153]),onchange:t[78],$$slots:{option:[r6,({option:n})=>({205:n}),({option:n})=>[0,0,0,0,0,0,n?524288:0]]},$$scope:{ctx:t}}}),{c(){At(e.$$.fragment)},m(n,r){It(e,n,r),i=!0},p(n,r){const o={};16&r[0]&&(o.locale=n[4]),8388608&r[1]&&(o.options=n[54]),67108864&r[0]|8388608&r[1]&&(o.selectedIndex=n[54].findIndex(n[153])),16&r[0]|1572864&r[6]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){D(e.$$.fragment,n),i=!1},d(n){Et(e,n)}}}function a6(t){let e,i,n,r,o;const a=[KS,qS],s=[];function l(d,u){return d[52]?0:d[45]?1:-1}~(i=l(t))&&(n=s[i]=a[i](t));let c=t[33]&&Rf(t);return{c(){e=pt("div"),n&&n.c(),r=de(),c&&c.c(),w(e,"slot","footer"),w(e,"style",t[40])},m(d,u){tt(d,e,u),~i&&s[i].m(e,null),Tt(e,r),c&&c.m(e,null),o=!0},p(d,u){let p=i;i=l(d),i===p?~i&&s[i].p(d,u):(n&&(Fe(),D(s[p],1,1,()=>{s[p]=null}),De()),~i?(n=s[i],n?n.p(d,u):(n=s[i]=a[i](d),n.c()),M(n,1),n.m(e,r)):n=null),d[33]?c?(c.p(d,u),4&u[1]&&M(c,1)):(c=Rf(d),c.c(),M(c,1),c.m(e,null)):c&&(Fe(),D(c,1,1,()=>{c=null}),De()),(!o||512&u[1])&&w(e,"style",d[40])},i(d){o||(M(n),M(c),o=!0)},o(d){D(n),D(c),o=!1},d(d){d&&Q(e),~i&&s[i].d(),c&&c.d()}}}function s6(t){let e,i;return e=new ol({props:{hasHeader:t[41],$$slots:{footer:[a6],main:[YS],header:[XS]},$$scope:{ctx:t}}}),e.$on("measure",t[163]),{c(){At(e.$$.fragment)},m(n,r){It(e,n,r),i=!0},p(n,r){const o={};1024&r[1]&&(o.hasHeader=n[41]),2113929201&r[0]|134216703&r[1]|1048576&r[6]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){D(e.$$.fragment,n),i=!1},d(n){Et(e,n)}}}function l6(t,e,i){let n,r,o,a,s,l,c,d,u,p,h,g,m,f,x,k,v,C,P,I,O,T,L,F,B,y,V,J,S,H,K,ut,lt,N,ft,$t,Lt,ct,et,ht,Y,Z,St,nt,mt,Ft,oe,Rt,Ut,Ot,j,wt,yt,Gt,ue,pe,ve,ge,_,we,gi,xe,_t,Te,Ie,He,vi=Qe,vt=()=>(vi(),vi=Nr(Fi,W=>i(35,Z=W)),Fi),bt=Qe,Ze=()=>(bt(),bt=Nr(ye,W=>i(142,Ft=W)),ye),Pe=Qe,ri=()=>(Pe(),Pe=Nr(en,W=>i(37,yt=W)),en),Ge=Qe,ii=()=>(Ge(),Ge=Nr(jt,W=>i(149,xe=W)),jt),wi=Qe,pi=()=>(wi(),wi=Nr(X,W=>i(56,Ie=W)),X);t.$$.on_destroy.push(()=>vi()),t.$$.on_destroy.push(()=>bt()),t.$$.on_destroy.push(()=>Pe()),t.$$.on_destroy.push(()=>Ge()),t.$$.on_destroy.push(()=>wi());let{isActive:Fi}=e;vt();let{isActiveFraction:X}=e;pi();let{isVisible:jt}=e;ii();let{stores:U}=e,{locale:Bt={}}=e,{shapes:ye}=e;Ze();let{toolbar:Qt=[]}=e,{toolShapes:se={}}=e,{toolActive:zt}=e,{toolSelectRadius:We}=e,{toolRetainStyles:Ae=!1}=e,{toolbarLayout:je="stack"}=e,{textInputMode:Ke}=e,{shapeControls:it={}}=e,{enableButtonFlipVertical:Xt=!1}=e,{enablePresetSelectImage:Nt=!0}=e,{enablePresetDropImage:Zt=!0}=e,{enableSelectToolToAddShape:Yt=!1}=e,{enableAutoSelectMoveTool:ot=["line","arrow","path","rectangle","ellipse","text"]}=e,{enableTapToAddText:he=!1}=e,{enableMoveTool:ie=!1}=e,{enableViewTool:fe=!1}=e,{enableToolShareStyles:Dt=!0}=e,{gridSize:ke=0}=e,{snapThreshold:fi=0}=e,{enableSnapToContext:hi=!0}=e,{willRenderHeaderTools:Be=Xi}=e,{willRenderPresetToolbar:yi}=e,{willRenderShapeStyleControls:Pi}=e,{willStartInteraction:be}=e,{shapePresets:me=[]}=e,{utilKey:Ee}=e,{mapScreenPointToImagePoint:an}=e,{mapImagePointToScreenPoint:Gi}=e,{imageRotation:fn=0}=e,{imageFlipX:hn=!1}=e,{imageFlipY:mn=!1}=e,{parentRect:en}=e;ri();let{hooks:qi={}}=e;const Ln=sn("selection");A(t,Ln,W=>i(148,_=W));const Gn=sn("isAnimated");A(t,Gn,W=>i(139,St=W));const Nn=sn("elasticityMultiplier");A(t,Nn,W=>i(143,oe=W));const gr=sn("ui");A(t,gr,W=>i(173,we=W));const Hn=sn("keysPressed");let bn;A(t,Hn,W=>i(146,ve=W));const{env:On,history:Wn,rootRect:Ri,rootColorSecondary:oo,enablePanInput:zn,enablePanInputStatus:go,enableZoomInput:ao,stageRect:Pr,utilRectPadded:fr,scrollElasticity:Mn,imageOverlayMarkup:Ki,imagePreviewModifiers:Ur,imageCropRect:Qr,shapePreprocessor:fo,stageScalar:yo,imageSelectionRect:Po,imageTransformsInterpolated:so,imageSelectionPan:lo,imageSize:xo,allowPan:bo,allowZoom:Fr,allowZoomControls:yr,allowPlayPause:to}=U;A(t,On,W=>i(140,nt=W)),A(t,Ri,W=>i(55,Te=W)),A(t,oo,W=>i(57,He=W)),A(t,go,W=>i(38,ue=W)),A(t,Pr,W=>i(144,Rt=W)),A(t,fr,W=>i(39,gi=W)),A(t,Ur,W=>i(174,_t=W)),A(t,Qr,W=>i(172,Gt=W)),A(t,fo,W=>i(147,ge=W)),A(t,yo,W=>i(170,j=W)),A(t,Po,W=>i(171,wt=W)),A(t,so,W=>i(36,Ut=W)),A(t,lo,W=>i(169,Ot=W)),A(t,xo,W=>i(145,pe=W));let dn=0,Qn={};const vo=W=>{const[ne,Ai]=bn[W];let oi,Kt,Se=Ai.position==="relative";const Li=Se?"0%":0,Vi=Se?"0%":0;ko(ne)||qn(ne)?(Kt=Se?"20%":.2*yt.width,oi=_n(ne),oi.x=Li,oi.y=Vi,ya(oi,{width:Kt,height:Kt},yt)):Kn(ne)?(Kt=Se?"10%":.1*yt.width,oi=_n(ne),oi.x=Li,oi.y=Vi,ya(oi,{rx:Kt,ry:Kt},yt)):nr(ne)&&(Kt=Se?"10%":.1*yt.width,oi=_n(ne),oi.x1=Li,oi.y1=Vi,oi.x2=Li,oi.y2=Vi),oi&&Promise.resolve().then(()=>{uo(pr(oi,void 0,Kt))})},Dr=W=>an(eh(W,Te));let ki,Pn={},Zn,$n;const eo=W=>{if(!(Yn(W)&&ze(W,"pathClose")))return;const ne=[...W.strokeColor];ne[3]=1,ki.updateMarkupShape(W,{pathClose:!1,strokeColor:ne},!1),ki.removeMarkupShapeProps(W,["backgroundColor"],!1),ki.confirmMarkupItemDraft(),ki.selectShape(W)};let Gr;const un=(W,ne)=>{if(xi(W))return W;if(W.endsWith("%"))return parseFloat(W)/100*ne.width};let Zr,ur,co;const pr=(W,ne,Ai)=>{let oi=!1;ne||(oi=!0,ne=lt?an(Ti(Rt)):Ti(Gt)),ne.x-=yt.x||0,ne.y-=yt.y||0,(hn||mn)&&(W.flipX=hn,W.flipY=mn);const Kt=ki.getShapesNearPosition(Ft,ne);if(oi&&Kt.length){const Se=.1*Math.min(Gt.width,Gt.height);ne.x+=Math.round(-Se+Math.random()*Se*2),ne.y+=Math.round(-Se+Math.random()*Se*2)}if(fn!==0&&(W.rotation=hn&&mn?-fn:hn||mn?fn:-fn),ze(W,"width")&&ze(W,"height")){const{width:Se,height:Li}=Pl(W,["width","height"],yt);ya(W,{x:ne.x-.5*Se,y:ne.y-.5*Li},yt)}else if(Kn(W))ya(W,{x:ne.x,y:ne.y},yt);else if(nr(W)){const{x1:Se,y1:Li,x2:Vi,y2:pn}=Pl(W,["x1","y1","x2","y2"],yt),nn=ho(rt(Se,Li),rt(Vi,pn)),Bi=Oe(Ai)?lu(Ai,yt.width):nn;ya(W,{x1:ne.x-Bi,y1:ne.y+Bi,x2:ne.x+Bi,y2:ne.y-Bi},yt)}else if(Yn(W)){const{points:Se}=Pl(W,["points"],yt),Li=Oo(Se);ya(W,{points:Se.map(Vi=>({x:Vi.x+ne.x-Li.x,y:Vi.y+ne.y-Li.y}))},yt)}return W},jn=(W,ne)=>{const Ai=pr(Pm(W,Gt),ne);return W.shape&&(ze(W.shape,"x")&&(Ai.x=W.shape.x),ze(W.shape,"y")&&(Ai.y=W.shape.y)),uo(Ai)},uo=W=>{const{beforeAddShape:ne=()=>!0}=qi;if(ne(W))return ki.addShape(W),ki.selectShape(W),N("addshape",W),Wn.write(),W};let xr=!1;const io=()=>{Wn.write()};let Xr;const Bn=sn("redrawTrigger");A(t,Bn,W=>i(141,mt=W));const vn=[],ci=ai(St?20:0);return A(t,ci,W=>i(138,Y=W)),t.$$set=W=>{"isActive"in W&&vt(i(1,Fi=W.isActive)),"isActiveFraction"in W&&pi(i(2,X=W.isActiveFraction)),"isVisible"in W&&ii(i(3,jt=W.isVisible)),"stores"in W&&i(101,U=W.stores),"locale"in W&&i(4,Bt=W.locale),"shapes"in W&&Ze(i(5,ye=W.shapes)),"toolbar"in W&&i(102,Qt=W.toolbar),"toolShapes"in W&&i(103,se=W.toolShapes),"toolActive"in W&&i(0,zt=W.toolActive),"toolSelectRadius"in W&&i(6,We=W.toolSelectRadius),"toolRetainStyles"in W&&i(104,Ae=W.toolRetainStyles),"toolbarLayout"in W&&i(7,je=W.toolbarLayout),"textInputMode"in W&&i(8,Ke=W.textInputMode),"shapeControls"in W&&i(9,it=W.shapeControls),"enableButtonFlipVertical"in W&&i(10,Xt=W.enableButtonFlipVertical),"enablePresetSelectImage"in W&&i(11,Nt=W.enablePresetSelectImage),"enablePresetDropImage"in W&&i(12,Zt=W.enablePresetDropImage),"enableSelectToolToAddShape"in W&&i(105,Yt=W.enableSelectToolToAddShape),"enableAutoSelectMoveTool"in W&&i(106,ot=W.enableAutoSelectMoveTool),"enableTapToAddText"in W&&i(13,he=W.enableTapToAddText),"enableMoveTool"in W&&i(107,ie=W.enableMoveTool),"enableViewTool"in W&&i(108,fe=W.enableViewTool),"enableToolShareStyles"in W&&i(109,Dt=W.enableToolShareStyles),"gridSize"in W&&i(14,ke=W.gridSize),"snapThreshold"in W&&i(15,fi=W.snapThreshold),"enableSnapToContext"in W&&i(16,hi=W.enableSnapToContext),"willRenderHeaderTools"in W&&i(110,Be=W.willRenderHeaderTools),"willRenderPresetToolbar"in W&&i(111,yi=W.willRenderPresetToolbar),"willRenderShapeStyleControls"in W&&i(17,Pi=W.willRenderShapeStyleControls),"willStartInteraction"in W&&i(112,be=W.willStartInteraction),"shapePresets"in W&&i(18,me=W.shapePresets),"utilKey"in W&&i(19,Ee=W.utilKey),"mapScreenPointToImagePoint"in W&&i(20,an=W.mapScreenPointToImagePoint),"mapImagePointToScreenPoint"in W&&i(21,Gi=W.mapImagePointToScreenPoint),"imageRotation"in W&&i(22,fn=W.imageRotation),"imageFlipX"in W&&i(23,hn=W.imageFlipX),"imageFlipY"in W&&i(24,mn=W.imageFlipY),"parentRect"in W&&ri(i(25,en=W.parentRect)),"hooks"in W&&i(113,qi=W.hooks)},t.$$.update=()=>{var W,ne,Ai,oi;if(4194304&t.$$.dirty[4]&&i(123,n=ve.includes(18)),2098176&t.$$.dirty[3]&&(bn&&se===bn||i(114,bn=se)),16&t.$$.dirty[1]&&bo.set(Z),16&t.$$.dirty[1]&&Fr.set(Z),16&t.$$.dirty[1]&&yr.set(Z),512&t.$$.dirty[3]&&i(33,r=Array.isArray(Qt)&&Qt.length>1&&Array.isArray(Qt[0][1])),4&t.$$.dirty[1]|512&t.$$.dirty[3]&&i(54,o=r?Qt.map((Kt,Se)=>[Se,Kt[0]]):[]),67108864&t.$$.dirty[0]|4&t.$$.dirty[1]|512&t.$$.dirty[3]&&i(137,a=r?Qt[dn][1]:Qt),262144&t.$$.dirty[0]|311296&t.$$.dirty[3]|8192&t.$$.dirty[4]&&i(32,s=((Kt,{willRenderPresetToolbar:Se,shapePresets:Li,enableViewTool:Vi,enableMoveTool:pn})=>{let nn=Li.length!==0||Se?Kt:Kt.filter(Bi=>Bi[0]!=="preset");return r&&(nn=[["move",Bi=>Bi.shapeLabelToolMove,{icon:Bi=>Bi.shapeIconToolMove}],["view",Bi=>Bi.shapeLabelToolView,{icon:Bi=>Bi.shapeIconToolView}],...nn]),nn=pn?nn:nn.filter(Bi=>Bi[0]!=="move"),Vi?nn:nn.filter(Bi=>Bi[0]!=="view")})(a,{willRenderPresetToolbar:yi,shapePresets:me,enableMoveTool:ie,enableViewTool:fe})),2&t.$$.dirty[1]&&i(135,d=!!s.length),1&t.$$.dirty[0]|2&t.$$.dirty[1]|2048&t.$$.dirty[4]&&d&&zt===void 0&&i(0,zt=s[0][0]),67108865&t.$$.dirty[0]|4&t.$$.dirty[1]|4194304&t.$$.dirty[3]|8192&t.$$.dirty[4]&&r&&i(115,Qn={...Qn,[dn]:a.map(([Kt])=>Kt).includes(zt)?zt:Qn[dn]||a[0][0]}),512&t.$$.dirty[0]&&i(134,l=!!Object.keys(it).length),2&t.$$.dirty[1]&&i(34,c=s.length>1),12&t.$$.dirty[1]&&i(53,u=c||r),1&t.$$.dirty[0]&&i(136,p=zt!==void 0),7168&t.$$.dirty[4]&&i(52,h=(!p||d)&&l),268435456&t.$$.dirty[0]&&i(30,N=Xr&&(W=Xr,(Kt,Se)=>{W.dispatchEvent(ss(Kt,Se))})),1073741825&t.$$.dirty[0]|16&t.$$.dirty[1]&&Z&&N&&N("selectcontrol",zt),16&t.$$.dirty[1]&&(Z?Ct(Ur,_t[Ee]={maskMarkupOpacity:.85},_t):delete _t[Ee]),1&t.$$.dirty[0]|2097152&t.$$.dirty[3]&&i(133,g=zt&&bn[zt]?bn[zt][1]:void 0),512&t.$$.dirty[4]&&i(124,m=g&&g.isSelection?"selection":"shapes"),1073741824&t.$$.dirty[3]|1&t.$$.dirty[4]&&(Kt=>{if(!ki)return;const Se=ki.getShapeDraft(Ln);Se&&(Kt&&(Zn=Se.drawMode),ki.updateShapeDraft({drawMode:Kt?"subtract":Zn},Ln))})(m==="selection"&&n),134217729&t.$$.dirty[0]&&zt&&ki){const Kt=ki.getMarkupItemDraft();Kt&&eo(Kt)}if(1&t.$$.dirty[0]&&zt&&ki&&zt!=="move"&&ki.blurShapes(),16&t.$$.dirty[1]|33554432&t.$$.dirty[4]&&i(51,f=xe&&Z),256&t.$$.dirty[1]|1048576&t.$$.dirty[4]&&i(50,x=gi&&rt(Rt.x-gi.x,Rt.y-gi.y)),512&t.$$.dirty[0]&&i(132,k=Object.keys(it)),16&t.$$.dirty[1]|262144&t.$$.dirty[4]&&i(120,v=Z&&Ft.filter(cs)[0]),16&t.$$.dirty[1]|262144&t.$$.dirty[4]&&i(129,C=Z&&Ft.find(Kt=>rp(Kt))),16&t.$$.dirty[1]|262144&t.$$.dirty[4]&&i(49,P=Z&&Ft.find(Kt=>So(Kt))),1&t.$$.dirty[0]|16&t.$$.dirty[1]|2097152&t.$$.dirty[3]&&i(126,I=Z&&bn[zt]?fy(_n({...bn[zt][0],...we[Ee]?we[Ee][zt]:{}})):{}),2097152&t.$$.dirty[3]&&bn&&i(116,Pn={}),1&t.$$.dirty[0]|8454144&t.$$.dirty[3]|260&t.$$.dirty[4]&&i(125,O=I&&Object.keys(I).reduce((Kt,Se)=>{const Li=Se==="disableStyle",Vi=Se==="settings",pn=!!k.find(Br=>Br.split("_").includes(Se));if(!Li&&!Vi&&!pn||I[Se]===void 0||I.disableStyle===!0||I.disableStyle&&I.disableStyle.includes(Se))return Kt;if(Se==="strokeWidth"&&Object.keys(Pn).includes("strokeWidth")&&Pn[Se]===void 0&&ze(I,"points"))return Kt[Se]=I[Se],Kt;const{share:nn=!0}=I.settings&&I.settings[Se]||{},Bi=Dt&&nn?Pn:Pn[zt]||{};return Kt[Se]=ze(Bi,Se)?Bi[Se]:I[Se],Kt},{})),524289&t.$$.dirty[0]|2048&t.$$.dirty[3]|2&t.$$.dirty[4]&&(Ae?((Kt,Se,Li)=>{const Vi=we[Kt],pn=Vi?Vi[Se]:{};gr.set({...we,[Kt]:{...Vi,[Se]:{...pn,...Li}}})})(Ee,zt,O):(ne=Ee,gr.set({[ne]:{}}))),16&t.$$.dirty[1]|134217728&t.$$.dirty[3]|16777218&t.$$.dirty[4]&&i(31,T=_&&Z?v||O:void 0),1&t.$$.dirty[1]|8388608&t.$$.dirty[4]&&T&&T.lineEnd&&!ge&&console.warn(`Set shapePreprocessor property to draw lineStart and lineEnd styles.
https://pqina.nl/pintura/docs/v8/api/exports/#createshapepreprocessor`),1&t.$$.dirty[0]|4&t.$$.dirty[4]&&i(48,L=ze(I,"eraseRadius")||ze(I,"points")&&!ze(I,"pathClose")||zt==="move"||zt==="view"),64&t.$$.dirty[1]|4&t.$$.dirty[4]&&i(47,F=I&&I.eraseRadius!==void 0?un(I.eraseRadius,yt):void 0),16&t.$$.dirty[1]|4194304&t.$$.dirty[4]&&i(130,B=Z&&ve.includes(32)),1&t.$$.dirty[0]|16&t.$$.dirty[1]&&i(131,y=Z&&zt==="view"),192&t.$$.dirty[4]&&i(128,V=y||B),48&t.$$.dirty[4]&&i(127,J=!!V&&(!!C||Ec(document.activeElement))),16&t.$$.dirty[1]|24&t.$$.dirty[4]&&zn.set(!Z||V&&!J),16&t.$$.dirty[1]|8&t.$$.dirty[4]&&ao.set(!Z||!J),64&t.$$.dirty[1]|6&t.$$.dirty[4]&&i(121,S=I.cursorStyle?(({cursorStyle:Kt,cursorSize:Se},Li,Vi)=>{let pn;const nn=Li[Se];if(nn===void 0?pn=un(Se,Vi):xi(nn)?pn=nn:Oe(nn)&&(pn=kb(Se,Li[Se],Vi),Se==="strokeWidth"&&(pn*=.5)),!(pn<=0||pn===void 0))return{size:pn,style:Kt}})(I,{...I,...O},yt):void 0),67108864&t.$$.dirty[3]|2097152&t.$$.dirty[4]&&i(122,H=co&&(oi=pe,(Ai=co).x>=0&&Ai.y>=0&&Ai.x<=oi.width&&Ai.y<=oi.height)),524288&t.$$.dirty[0]|160&t.$$.dirty[1]|1929379840&t.$$.dirty[3]|1&t.$$.dirty[4])if(H&&!Zr&&S&&!ue){const Kt=S.size*Ut.scale,Se={id:"cursor-"+Ee,x:ur.x,y:ur.y,strokeWidth:.5,strokeColor:[0,0,0]};S.style==="ellipse"&&(Se.rx=Kt,Se.ry=Kt);const Li={strokeWidth:2.5,strokeColor:[1,1,1],opacity:.75},Vi=[{...Se,...Li},Se];if(m==="selection"&&n){const pn=Kt,nn=ur.x+pn,Bi=ur.y+pn+4,Br={id:"cursor-"+Ee,strokeWidth:.75,strokeColor:[0,0,0],points:[{x:nn,y:Bi},{x:nn+4,y:Bi}]};Vi.push({...Br,...Li,strokeWidth:2,points:[{x:nn-.5,y:Bi},{x:nn+4.5,y:Bi}]},Br)}(pn=>{Ki.update(nn=>[...nn.filter(Bi=>Bi.id!=="cursor-"+Ee),...pn])})(Vi)}else Ki.update(Kt=>Kt.filter(Se=>Se.id!=="cursor-"+Ee));1&t.$$.dirty[0]|128&t.$$.dirty[1]|956301312&t.$$.dirty[3]&&i(46,K=H?((Kt,Se,Li,Vi,pn,nn)=>{if(Vi)return pn?"grabbing":"grab";if(Kt&&!Se)return"none";if(!Se)return nn==="move"?"default":"crosshair";let Bi=Se||Li;return cs(Bi)?rp(Bi)?Ke==="modal"?"default":"text":mc(Bi)?"move":"default":"default"})(S,Zr,v,ue,!1,zt):"default"),264193&t.$$.dirty[0]|262144&t.$$.dirty[3]&&i(45,ut=zt==="preset"&&(me.length>0||Nt||yi)),64&t.$$.dirty[1]&&(lt=!ze(yt,"x")&&!ze(yt,"y")),524288&t.$$.dirty[4]&&i(44,ft=oe*Mn),262144&t.$$.dirty[3]|196608&t.$$.dirty[4]&&i(43,$t=mt&&yi?Kt=>Ac(()=>yi(Kt,jn,{...nt},()=>Bn.set({}))):Xi),1048576&t.$$.dirty[3]&&i(42,Lt=Object.keys(qi).reduce((Kt,Se)=>(Se==="beforeAddShape"||qi[Se]===void 0||(Kt[Se]=qi[Se]),Kt),{})),16&t.$$.dirty[1]&&(Kt=>{Ft&&ye.update(Se=>Se.map(Li=>(Li._prerender=!!Kt&&rp(Li),Li)))})(Z),131072&t.$$.dirty[3]|196608&t.$$.dirty[4]&&i(29,ct=mt&&Be([],nt,()=>Bn.set({}))),536871424&t.$$.dirty[0]&&i(41,et=!!ct.length||!!Object.keys(it).some(Kt=>vn.includes(Kt))),16&t.$$.dirty[1]|32768&t.$$.dirty[4]&&St&&ci.set(Z?0:20),16384&t.$$.dirty[4]&&i(40,ht=Y?`transform: translateY(${Y}px)`:void 0)},to.set(!1),[zt,Fi,X,jt,Bt,ye,We,je,Ke,it,Xt,Nt,Zt,he,ke,fi,hi,Pi,me,Ee,an,Gi,fn,hn,mn,en,dn,ki,Xr,ct,N,T,s,r,c,Z,Ut,yt,ue,gi,ht,et,Lt,$t,ft,ut,K,F,L,P,x,f,h,u,o,Te,Ie,He,Ln,Gn,Nn,gr,Hn,On,Ri,oo,go,Pr,fr,Ki,Ur,Qr,fo,yo,Po,so,lo,xo,({index:W},ne)=>{i(26,dn=W),i(0,zt=Qn[W])},({value:W},ne)=>{i(0,zt=W),(Yt||/enter/i.test(ne.key))&&vo(W)},W=>{if(zt==="eraser")$n=ki.eraseShape();else if(zt&&bn[zt]){const[ne,Ai={}]=bn[zt],{drawMode:oi}=T;m==="selection"&&oi==="new"&&Ln.set([]);let Kt={};m==="selection"&&(N("selectiondown",[..._]),n&&(Zn=ne.drawMode,Kt.drawMode="subtract")),$n=ki.createShape({...ne,...O,...Kt},Ai)}else $n=void 0;return!!$n&&($n.start(W),!0)},W=>!!$n&&($n.update(W),!0),W=>!!$n&&($n.release(W),!0),W=>!!$n&&($n.cancel(W),$n=void 0,!0),W=>{if(!$n)return!1;if($n.end(W),$n=void 0,m==="selection"){if(W.detail.isTap){const[oi]=bn[zt];oi.bitmap||Ln.set([])}N("selectionup",[..._])}const ne=ki.getMarkupItemDraft(),Ai=ie&&(ot===!0||Array.isArray(ot)&&ot.includes(zt));return ne&&!ne.isEditing||!Ai||i(0,zt="move"),!0},W=>{const{key:ne}=W,Ai=ki.getMarkupItemDraft();/escape/i.test(ne)&&Ai&&(W.preventDefault(),W.stopPropagation(),ki.discardMarkupItemDraft(),$n=void 0),/enter/i.test(ne)&&Ai&&(W.preventDefault(),W.stopPropagation(),eo(Ai),$n=void 0)},function(W){Object.keys(W).forEach(ne=>{const{retain:Ai=!0,share:oi=!0}=I.settings&&I.settings[ne]||{};Ai&&(Dt&&oi?i(116,Pn[ne]=W[ne],Pn):(Pn[zt]||i(116,Pn[zt]={},Pn),i(116,Pn[zt][ne]=W[ne],Pn)))}),N("selectstyle",W),v&&(ki.updateMarkupShape(v,W),clearTimeout(Gr),Gr=setTimeout(()=>{io()},200))},(W,ne,Ai)=>{i(118,ur=ne),i(119,co=Ai)},()=>{i(119,co=void 0),i(118,ur=void 0)},W=>{N("markuptap",W)},W=>i(117,Zr=W),()=>{xr=!1},(W,ne)=>{if(xr)return;const{beforeAddShape:Ai=()=>!0}=qi,oi=Dr(ne),Kt=ki.getMarkupItemDraft(),Se=nu(Gt,{x:oi.x+(yt.x||0),y:oi.y+(yt.y||0)});if(Kt&&!Se&&ki.discardMarkupItemDraft(),Se){if(!Kt){const Li=Pm(W,Gt),Vi=pr(Li,oi);return Ai(Vi)?(Fp(Vi),void ki.addShape(Vi)):(xr=!0,void ne.preventDefault())}ko(Kt)&&(oi.x-=.5*Kt.width,oi.y-=.5*Kt.height),W.shape&&(ze(W.shape,"x")&&(oi.x=W.shape.x),ze(W.shape,"y")&&(oi.y=W.shape.y)),ki.updateMarkupShape(Kt,oi)}},(W,ne)=>{if(xr)return;const Ai=Dr(ne);if(!nu(Gt,{x:Ai.x+(yt.x||0),y:Ai.y+(yt.y||0)}))return void ki.discardMarkupItemDraft();const oi=ki.confirmMarkupItemDraft();ki.selectShape(oi),N("addshape",oi),Wn.write()},W=>jn(W),W=>{return ne=W.detail.resources,Ai=Dr(W.detail.event),ne.forEach(oi=>jn(oi,Ai));var ne,Ai},W=>{if(!be)return!0;const ne=rectClone(wt);return rectScale(ne,1/j),rectTranslate(ne,Ot),rectScale(ne,Ut.scale),be(W,{...ne,x:ne.x+Rt.x,y:ne.y+Rt.y})},io,Bn,vn,ci,U,Qt,se,Ae,Yt,ot,ie,fe,Dt,Be,yi,be,qi,bn,Qn,Pn,Zr,ur,co,v,S,H,n,m,O,I,J,V,C,B,y,k,g,l,d,p,a,Y,St,nt,mt,Ft,oe,Rt,pe,ve,ge,_,xe,function(W){jr.call(this,t,W)},W=>W[0]===zt,(W,ne,Ai)=>{const oi=W.filter(([,Kt])=>!vn.includes(Kt));return Pi?Pi(oi,ne,Ai):oi},W=>W[0]===dn,W=>{Promise.resolve().then(()=>{N("addshape",W),io()})},W=>{N("selectshape",W)},W=>{Promise.resolve().then(()=>{N("blurshape",W)})},W=>{N("tapshape",W)},W=>{N("updateshape",W),io()},W=>{N("removeshape",W),io()},function(W){zi[W?"unshift":"push"](()=>{ki=W,i(27,ki)})},function(W){zi[W?"unshift":"push"](()=>{Xr=W,i(28,Xr)})},W=>W.filter(([,ne])=>vn.includes(ne)),function(W){jr.call(this,t,W)}]}class Ru extends li{constructor(e){super(),si(this,e,l6,s6,ei,{isActive:1,isActiveFraction:2,isVisible:3,stores:101,locale:4,shapes:5,toolbar:102,toolShapes:103,toolActive:0,toolSelectRadius:6,toolRetainStyles:104,toolbarLayout:7,textInputMode:8,shapeControls:9,enableButtonFlipVertical:10,enablePresetSelectImage:11,enablePresetDropImage:12,enableSelectToolToAddShape:105,enableAutoSelectMoveTool:106,enableTapToAddText:13,enableMoveTool:107,enableViewTool:108,enableToolShareStyles:109,gridSize:14,snapThreshold:15,enableSnapToContext:16,willRenderHeaderTools:110,willRenderPresetToolbar:111,willRenderShapeStyleControls:17,willStartInteraction:112,shapePresets:18,utilKey:19,mapScreenPointToImagePoint:20,mapImagePointToScreenPoint:21,imageRotation:22,imageFlipX:23,imageFlipY:24,parentRect:25,hooks:113},null,[-1,-1,-1,-1,-1,-1,-1])}get isActive(){return this.$$.ctx[1]}set isActive(e){this.$$set({isActive:e}),R()}get isActiveFraction(){return this.$$.ctx[2]}set isActiveFraction(e){this.$$set({isActiveFraction:e}),R()}get isVisible(){return this.$$.ctx[3]}set isVisible(e){this.$$set({isVisible:e}),R()}get stores(){return this.$$.ctx[101]}set stores(e){this.$$set({stores:e}),R()}get locale(){return this.$$.ctx[4]}set locale(e){this.$$set({locale:e}),R()}get shapes(){return this.$$.ctx[5]}set shapes(e){this.$$set({shapes:e}),R()}get toolbar(){return this.$$.ctx[102]}set toolbar(e){this.$$set({toolbar:e}),R()}get toolShapes(){return this.$$.ctx[103]}set toolShapes(e){this.$$set({toolShapes:e}),R()}get toolActive(){return this.$$.ctx[0]}set toolActive(e){this.$$set({toolActive:e}),R()}get toolSelectRadius(){return this.$$.ctx[6]}set toolSelectRadius(e){this.$$set({toolSelectRadius:e}),R()}get toolRetainStyles(){return this.$$.ctx[104]}set toolRetainStyles(e){this.$$set({toolRetainStyles:e}),R()}get toolbarLayout(){return this.$$.ctx[7]}set toolbarLayout(e){this.$$set({toolbarLayout:e}),R()}get textInputMode(){return this.$$.ctx[8]}set textInputMode(e){this.$$set({textInputMode:e}),R()}get shapeControls(){return this.$$.ctx[9]}set shapeControls(e){this.$$set({shapeControls:e}),R()}get enableButtonFlipVertical(){return this.$$.ctx[10]}set enableButtonFlipVertical(e){this.$$set({enableButtonFlipVertical:e}),R()}get enablePresetSelectImage(){return this.$$.ctx[11]}set enablePresetSelectImage(e){this.$$set({enablePresetSelectImage:e}),R()}get enablePresetDropImage(){return this.$$.ctx[12]}set enablePresetDropImage(e){this.$$set({enablePresetDropImage:e}),R()}get enableSelectToolToAddShape(){return this.$$.ctx[105]}set enableSelectToolToAddShape(e){this.$$set({enableSelectToolToAddShape:e}),R()}get enableAutoSelectMoveTool(){return this.$$.ctx[106]}set enableAutoSelectMoveTool(e){this.$$set({enableAutoSelectMoveTool:e}),R()}get enableTapToAddText(){return this.$$.ctx[13]}set enableTapToAddText(e){this.$$set({enableTapToAddText:e}),R()}get enableMoveTool(){return this.$$.ctx[107]}set enableMoveTool(e){this.$$set({enableMoveTool:e}),R()}get enableViewTool(){return this.$$.ctx[108]}set enableViewTool(e){this.$$set({enableViewTool:e}),R()}get enableToolShareStyles(){return this.$$.ctx[109]}set enableToolShareStyles(e){this.$$set({enableToolShareStyles:e}),R()}get gridSize(){return this.$$.ctx[14]}set gridSize(e){this.$$set({gridSize:e}),R()}get snapThreshold(){return this.$$.ctx[15]}set snapThreshold(e){this.$$set({snapThreshold:e}),R()}get enableSnapToContext(){return this.$$.ctx[16]}set enableSnapToContext(e){this.$$set({enableSnapToContext:e}),R()}get willRenderHeaderTools(){return this.$$.ctx[110]}set willRenderHeaderTools(e){this.$$set({willRenderHeaderTools:e}),R()}get willRenderPresetToolbar(){return this.$$.ctx[111]}set willRenderPresetToolbar(e){this.$$set({willRenderPresetToolbar:e}),R()}get willRenderShapeStyleControls(){return this.$$.ctx[17]}set willRenderShapeStyleControls(e){this.$$set({willRenderShapeStyleControls:e}),R()}get willStartInteraction(){return this.$$.ctx[112]}set willStartInteraction(e){this.$$set({willStartInteraction:e}),R()}get shapePresets(){return this.$$.ctx[18]}set shapePresets(e){this.$$set({shapePresets:e}),R()}get utilKey(){return this.$$.ctx[19]}set utilKey(e){this.$$set({utilKey:e}),R()}get mapScreenPointToImagePoint(){return this.$$.ctx[20]}set mapScreenPointToImagePoint(e){this.$$set({mapScreenPointToImagePoint:e}),R()}get mapImagePointToScreenPoint(){return this.$$.ctx[21]}set mapImagePointToScreenPoint(e){this.$$set({mapImagePointToScreenPoint:e}),R()}get imageRotation(){return this.$$.ctx[22]}set imageRotation(e){this.$$set({imageRotation:e}),R()}get imageFlipX(){return this.$$.ctx[23]}set imageFlipX(e){this.$$set({imageFlipX:e}),R()}get imageFlipY(){return this.$$.ctx[24]}set imageFlipY(e){this.$$set({imageFlipY:e}),R()}get parentRect(){return this.$$.ctx[25]}set parentRect(e){this.$$set({parentRect:e}),R()}get hooks(){return this.$$.ctx[113]}set hooks(e){this.$$set({hooks:e}),R()}}var Gh=(t,e,i,n,r,o,a,s,l)=>{const c=_e(t),d=.5*i.width,u=.5*i.height,p=.5*e.width,h=.5*e.height,g=r.x+n.x,m=r.y+n.y;s&&(c.x=i.width-c.x),l&&(c.y=i.height-c.y);const f=Math.cos(o),x=Math.sin(o);c.x-=d,c.y-=u;const k=c.x*f-c.y*x,v=c.x*x+c.y*f;c.x=d+k,c.y=u+v,c.x*=a,c.y*=a,c.x+=p,c.y+=h,c.x+=g,c.y+=m,c.x-=d*a,c.y-=u*a;const C=(r.x-g)*a,P=(r.y-m)*a,I=C*f-P*x,O=C*x+P*f;return c.x+=I,c.y+=O,c},Zh=(t,e,i,n,r,o,a,s,l)=>{const c=_e(t),d=El(i),u=El(e),p=rt(r.x+n.x,r.y+n.y),h=Math.cos(o),g=Math.sin(o);c.x-=u.x,c.y-=u.y;const m=(r.x-p.x)*a,f=(r.y-p.y)*a,x=m*h-f*g,k=m*g+f*h;c.x-=x,c.y-=k,c.x-=p.x,c.y-=p.y,c.x/=a,c.y/=a;const v=c.x*h+c.y*g,C=c.x*g-c.y*h;return c.x=v,c.y=-C,c.x+=d.x,c.y+=d.y,s&&(c.x=i.width-c.x),l&&(c.y=i.height-c.y),c},Dl=t=>typeof t=="boolean";function c6(t){let e,i,n;function r(a){t[59](a)}let o={utilKey:"annotate",stores:t[4],locale:t[5],isActive:t[1],isActiveFraction:t[2],isVisible:t[3],mapScreenPointToImagePoint:t[44],mapImagePointToScreenPoint:t[43],imageRotation:t[45],imageFlipX:t[42],imageFlipY:t[41],shapes:t[47],toolbar:t[20]||t[6],toolShapes:t[21]||t[7],toolRetainStyles:t[8],enableSelectToolToAddShape:t[30],enableTapToAddText:t[31],enableViewTool:t[29],enableMoveTool:t[33],enableAutoSelectMoveTool:t[32],snapThreshold:t[15],gridSize:xi(t[17])?t[17]:t[14],enableSnapToContext:Dl(t[18])?t[18]:t[16],enableToolShareStyles:t[12],shapeControls:t[22]||t[9],shapePresets:t[26],enableButtonFlipVertical:t[23],parentRect:t[48],enablePresetDropImage:t[25],enablePresetSelectImage:t[24],toolSelectRadius:t[10],textInputMode:t[11],willStartInteraction:t[13],willRenderPresetToolbar:t[27]||t[19],willRenderShapeStyleControls:t[28],hooks:{willRenderShapeControls:t[34],willRenderShapeTextControls:t[35],beforeAddShape:t[36],beforeRemoveShape:t[37],beforeDeselectShape:t[38],beforeSelectShape:t[39],beforeUpdateShape:t[40]}};return t[0]!==void 0&&(o.toolActive=t[0]),e=new Ru({props:o}),zi.push(()=>mo(e,"toolActive",r)),e.$on("measure",t[60]),{c(){At(e.$$.fragment)},m(a,s){It(e,a,s),n=!0},p(a,s){const l={};16&s[0]&&(l.stores=a[4]),32&s[0]&&(l.locale=a[5]),2&s[0]&&(l.isActive=a[1]),4&s[0]&&(l.isActiveFraction=a[2]),8&s[0]&&(l.isVisible=a[3]),8192&s[1]&&(l.mapScreenPointToImagePoint=a[44]),4096&s[1]&&(l.mapImagePointToScreenPoint=a[43]),16384&s[1]&&(l.imageRotation=a[45]),2048&s[1]&&(l.imageFlipX=a[42]),1024&s[1]&&(l.imageFlipY=a[41]),1048640&s[0]&&(l.toolbar=a[20]||a[6]),2097280&s[0]&&(l.toolShapes=a[21]||a[7]),256&s[0]&&(l.toolRetainStyles=a[8]),1073741824&s[0]&&(l.enableSelectToolToAddShape=a[30]),1&s[1]&&(l.enableTapToAddText=a[31]),536870912&s[0]&&(l.enableViewTool=a[29]),4&s[1]&&(l.enableMoveTool=a[33]),2&s[1]&&(l.enableAutoSelectMoveTool=a[32]),32768&s[0]&&(l.snapThreshold=a[15]),147456&s[0]&&(l.gridSize=xi(a[17])?a[17]:a[14]),327680&s[0]&&(l.enableSnapToContext=Dl(a[18])?a[18]:a[16]),4096&s[0]&&(l.enableToolShareStyles=a[12]),4194816&s[0]&&(l.shapeControls=a[22]||a[9]),67108864&s[0]&&(l.shapePresets=a[26]),8388608&s[0]&&(l.enableButtonFlipVertical=a[23]),33554432&s[0]&&(l.enablePresetDropImage=a[25]),16777216&s[0]&&(l.enablePresetSelectImage=a[24]),1024&s[0]&&(l.toolSelectRadius=a[10]),2048&s[0]&&(l.textInputMode=a[11]),8192&s[0]&&(l.willStartInteraction=a[13]),134742016&s[0]&&(l.willRenderPresetToolbar=a[27]||a[19]),268435456&s[0]&&(l.willRenderShapeStyleControls=a[28]),1016&s[1]&&(l.hooks={willRenderShapeControls:a[34],willRenderShapeTextControls:a[35],beforeAddShape:a[36],beforeRemoveShape:a[37],beforeDeselectShape:a[38],beforeSelectShape:a[39],beforeUpdateShape:a[40]}),!i&&1&s[0]&&(i=!0,l.toolActive=a[0],To(()=>i=!1)),e.$set(l)},i(a){n||(M(e.$$.fragment,a),n=!0)},o(a){D(e.$$.fragment,a),n=!1},d(a){Et(e,a)}}}function d6(t,e,i){let n,r,o,a,s,l,c,d,u,{isActive:p}=e,{isActiveFraction:h}=e,{isVisible:g}=e,{stores:m}=e,{locale:f={}}=e,{markupEditorToolbar:x}=e,{markupEditorToolStyles:k}=e,{markupEditorToolRetainStyles:v}=e,{markupEditorShapeStyleControls:C}=e,{markupEditorToolSelectRadius:P}=e,{markupEditorTextInputMode:I}=e,{markupEditorToolShareStyles:O}=e,{markupEditorWillStartInteraction:T}=e,{markupEditorGridSize:L=0}=e,{markupEditorSnapThreshold:F=0}=e,{markupEditorSnapToContext:B=!1}=e,{annotateGridSize:y}=e,{annotateSnapToContext:V}=e,{willRenderShapePresetToolbar:J}=e,{annotateTools:S}=e,{annotateToolShapes:H}=e,{annotateShapeControls:K}=e,{annotateActiveTool:ut}=e,{annotateEnableButtonFlipVertical:lt=!1}=e,{annotateEnableSelectImagePreset:N=!1}=e,{annotateEnableDropImagePreset:ft=!0}=e,{annotatePresets:$t=[]}=e,{annotateWillRenderShapePresetToolbar:Lt}=e,{annotateWillRenderShapeStyleControls:ct}=e,{enableViewTool:et}=e,{enableSelectToolToAddShape:ht}=e,{enableTapToAddText:Y}=e,{enableAutoSelectMoveTool:Z}=e,{enableMoveTool:St}=e,{willRenderShapeControls:nt}=e,{willRenderShapeTextControls:mt}=e,{beforeAddShape:Ft}=e,{beforeRemoveShape:oe}=e,{beforeDeselectShape:Rt}=e,{beforeSelectShape:Ut}=e,{beforeUpdateShape:Ot}=e;const{rootRect:j,imageAnnotation:wt,imageSize:yt,imageRotation:Gt,imageFlipX:ue,imageFlipY:pe,imageTransforms:ve,imageTransformsInterpolated:ge}=m;return A(t,j,_=>i(58,d=_)),A(t,yt,_=>i(57,c=_)),A(t,Gt,_=>i(45,u=_)),A(t,ue,_=>i(42,a=_)),A(t,pe,_=>i(41,o=_)),A(t,ve,_=>i(56,l=_)),A(t,ge,_=>i(55,s=_)),t.$$set=_=>{"isActive"in _&&i(1,p=_.isActive),"isActiveFraction"in _&&i(2,h=_.isActiveFraction),"isVisible"in _&&i(3,g=_.isVisible),"stores"in _&&i(4,m=_.stores),"locale"in _&&i(5,f=_.locale),"markupEditorToolbar"in _&&i(6,x=_.markupEditorToolbar),"markupEditorToolStyles"in _&&i(7,k=_.markupEditorToolStyles),"markupEditorToolRetainStyles"in _&&i(8,v=_.markupEditorToolRetainStyles),"markupEditorShapeStyleControls"in _&&i(9,C=_.markupEditorShapeStyleControls),"markupEditorToolSelectRadius"in _&&i(10,P=_.markupEditorToolSelectRadius),"markupEditorTextInputMode"in _&&i(11,I=_.markupEditorTextInputMode),"markupEditorToolShareStyles"in _&&i(12,O=_.markupEditorToolShareStyles),"markupEditorWillStartInteraction"in _&&i(13,T=_.markupEditorWillStartInteraction),"markupEditorGridSize"in _&&i(14,L=_.markupEditorGridSize),"markupEditorSnapThreshold"in _&&i(15,F=_.markupEditorSnapThreshold),"markupEditorSnapToContext"in _&&i(16,B=_.markupEditorSnapToContext),"annotateGridSize"in _&&i(17,y=_.annotateGridSize),"annotateSnapToContext"in _&&i(18,V=_.annotateSnapToContext),"willRenderShapePresetToolbar"in _&&i(19,J=_.willRenderShapePresetToolbar),"annotateTools"in _&&i(20,S=_.annotateTools),"annotateToolShapes"in _&&i(21,H=_.annotateToolShapes),"annotateShapeControls"in _&&i(22,K=_.annotateShapeControls),"annotateActiveTool"in _&&i(0,ut=_.annotateActiveTool),"annotateEnableButtonFlipVertical"in _&&i(23,lt=_.annotateEnableButtonFlipVertical),"annotateEnableSelectImagePreset"in _&&i(24,N=_.annotateEnableSelectImagePreset),"annotateEnableDropImagePreset"in _&&i(25,ft=_.annotateEnableDropImagePreset),"annotatePresets"in _&&i(26,$t=_.annotatePresets),"annotateWillRenderShapePresetToolbar"in _&&i(27,Lt=_.annotateWillRenderShapePresetToolbar),"annotateWillRenderShapeStyleControls"in _&&i(28,ct=_.annotateWillRenderShapeStyleControls),"enableViewTool"in _&&i(29,et=_.enableViewTool),"enableSelectToolToAddShape"in _&&i(30,ht=_.enableSelectToolToAddShape),"enableTapToAddText"in _&&i(31,Y=_.enableTapToAddText),"enableAutoSelectMoveTool"in _&&i(32,Z=_.enableAutoSelectMoveTool),"enableMoveTool"in _&&i(33,St=_.enableMoveTool),"willRenderShapeControls"in _&&i(34,nt=_.willRenderShapeControls),"willRenderShapeTextControls"in _&&i(35,mt=_.willRenderShapeTextControls),"beforeAddShape"in _&&i(36,Ft=_.beforeAddShape),"beforeRemoveShape"in _&&i(37,oe=_.beforeRemoveShape),"beforeDeselectShape"in _&&i(38,Rt=_.beforeDeselectShape),"beforeSelectShape"in _&&i(39,Ut=_.beforeSelectShape),"beforeUpdateShape"in _&&i(40,Ot=_.beforeUpdateShape)},t.$$.update=()=>{251661312&t.$$.dirty[1]&&i(44,n=_=>Zh(_,d,c,s.origin,s.translation,l.rotation.z,s.scale,a,o)),251661312&t.$$.dirty[1]&&i(43,r=_=>Gh(_,d,c,s.origin,s.translation,l.rotation.z,s.scale,a,o))},[ut,p,h,g,m,f,x,k,v,C,P,I,O,T,L,F,B,y,V,J,S,H,K,lt,N,ft,$t,Lt,ct,et,ht,Y,Z,St,nt,mt,Ft,oe,Rt,Ut,Ot,o,a,r,n,u,j,wt,yt,Gt,ue,pe,ve,ge,"annotate",s,l,c,d,function(_){ut=_,i(0,ut)},function(_){jr.call(this,t,_)}]}var u6={util:["annotate",class extends li{constructor(t){super(),si(this,t,d6,c6,ei,{name:54,isActive:1,isActiveFraction:2,isVisible:3,stores:4,locale:5,markupEditorToolbar:6,markupEditorToolStyles:7,markupEditorToolRetainStyles:8,markupEditorShapeStyleControls:9,markupEditorToolSelectRadius:10,markupEditorTextInputMode:11,markupEditorToolShareStyles:12,markupEditorWillStartInteraction:13,markupEditorGridSize:14,markupEditorSnapThreshold:15,markupEditorSnapToContext:16,annotateGridSize:17,annotateSnapToContext:18,willRenderShapePresetToolbar:19,annotateTools:20,annotateToolShapes:21,annotateShapeControls:22,annotateActiveTool:0,annotateEnableButtonFlipVertical:23,annotateEnableSelectImagePreset:24,annotateEnableDropImagePreset:25,annotatePresets:26,annotateWillRenderShapePresetToolbar:27,annotateWillRenderShapeStyleControls:28,enableViewTool:29,enableSelectToolToAddShape:30,enableTapToAddText:31,enableAutoSelectMoveTool:32,enableMoveTool:33,willRenderShapeControls:34,willRenderShapeTextControls:35,beforeAddShape:36,beforeRemoveShape:37,beforeDeselectShape:38,beforeSelectShape:39,beforeUpdateShape:40},null,[-1,-1])}get name(){return this.$$.ctx[54]}get isActive(){return this.$$.ctx[1]}set isActive(t){this.$$set({isActive:t}),R()}get isActiveFraction(){return this.$$.ctx[2]}set isActiveFraction(t){this.$$set({isActiveFraction:t}),R()}get isVisible(){return this.$$.ctx[3]}set isVisible(t){this.$$set({isVisible:t}),R()}get stores(){return this.$$.ctx[4]}set stores(t){this.$$set({stores:t}),R()}get locale(){return this.$$.ctx[5]}set locale(t){this.$$set({locale:t}),R()}get markupEditorToolbar(){return this.$$.ctx[6]}set markupEditorToolbar(t){this.$$set({markupEditorToolbar:t}),R()}get markupEditorToolStyles(){return this.$$.ctx[7]}set markupEditorToolStyles(t){this.$$set({markupEditorToolStyles:t}),R()}get markupEditorToolRetainStyles(){return this.$$.ctx[8]}set markupEditorToolRetainStyles(t){this.$$set({markupEditorToolRetainStyles:t}),R()}get markupEditorShapeStyleControls(){return this.$$.ctx[9]}set markupEditorShapeStyleControls(t){this.$$set({markupEditorShapeStyleControls:t}),R()}get markupEditorToolSelectRadius(){return this.$$.ctx[10]}set markupEditorToolSelectRadius(t){this.$$set({markupEditorToolSelectRadius:t}),R()}get markupEditorTextInputMode(){return this.$$.ctx[11]}set markupEditorTextInputMode(t){this.$$set({markupEditorTextInputMode:t}),R()}get markupEditorToolShareStyles(){return this.$$.ctx[12]}set markupEditorToolShareStyles(t){this.$$set({markupEditorToolShareStyles:t}),R()}get markupEditorWillStartInteraction(){return this.$$.ctx[13]}set markupEditorWillStartInteraction(t){this.$$set({markupEditorWillStartInteraction:t}),R()}get markupEditorGridSize(){return this.$$.ctx[14]}set markupEditorGridSize(t){this.$$set({markupEditorGridSize:t}),R()}get markupEditorSnapThreshold(){return this.$$.ctx[15]}set markupEditorSnapThreshold(t){this.$$set({markupEditorSnapThreshold:t}),R()}get markupEditorSnapToContext(){return this.$$.ctx[16]}set markupEditorSnapToContext(t){this.$$set({markupEditorSnapToContext:t}),R()}get annotateGridSize(){return this.$$.ctx[17]}set annotateGridSize(t){this.$$set({annotateGridSize:t}),R()}get annotateSnapToContext(){return this.$$.ctx[18]}set annotateSnapToContext(t){this.$$set({annotateSnapToContext:t}),R()}get willRenderShapePresetToolbar(){return this.$$.ctx[19]}set willRenderShapePresetToolbar(t){this.$$set({willRenderShapePresetToolbar:t}),R()}get annotateTools(){return this.$$.ctx[20]}set annotateTools(t){this.$$set({annotateTools:t}),R()}get annotateToolShapes(){return this.$$.ctx[21]}set annotateToolShapes(t){this.$$set({annotateToolShapes:t}),R()}get annotateShapeControls(){return this.$$.ctx[22]}set annotateShapeControls(t){this.$$set({annotateShapeControls:t}),R()}get annotateActiveTool(){return this.$$.ctx[0]}set annotateActiveTool(t){this.$$set({annotateActiveTool:t}),R()}get annotateEnableButtonFlipVertical(){return this.$$.ctx[23]}set annotateEnableButtonFlipVertical(t){this.$$set({annotateEnableButtonFlipVertical:t}),R()}get annotateEnableSelectImagePreset(){return this.$$.ctx[24]}set annotateEnableSelectImagePreset(t){this.$$set({annotateEnableSelectImagePreset:t}),R()}get annotateEnableDropImagePreset(){return this.$$.ctx[25]}set annotateEnableDropImagePreset(t){this.$$set({annotateEnableDropImagePreset:t}),R()}get annotatePresets(){return this.$$.ctx[26]}set annotatePresets(t){this.$$set({annotatePresets:t}),R()}get annotateWillRenderShapePresetToolbar(){return this.$$.ctx[27]}set annotateWillRenderShapePresetToolbar(t){this.$$set({annotateWillRenderShapePresetToolbar:t}),R()}get annotateWillRenderShapeStyleControls(){return this.$$.ctx[28]}set annotateWillRenderShapeStyleControls(t){this.$$set({annotateWillRenderShapeStyleControls:t}),R()}get enableViewTool(){return this.$$.ctx[29]}set enableViewTool(t){this.$$set({enableViewTool:t}),R()}get enableSelectToolToAddShape(){return this.$$.ctx[30]}set enableSelectToolToAddShape(t){this.$$set({enableSelectToolToAddShape:t}),R()}get enableTapToAddText(){return this.$$.ctx[31]}set enableTapToAddText(t){this.$$set({enableTapToAddText:t}),R()}get enableAutoSelectMoveTool(){return this.$$.ctx[32]}set enableAutoSelectMoveTool(t){this.$$set({enableAutoSelectMoveTool:t}),R()}get enableMoveTool(){return this.$$.ctx[33]}set enableMoveTool(t){this.$$set({enableMoveTool:t}),R()}get willRenderShapeControls(){return this.$$.ctx[34]}set willRenderShapeControls(t){this.$$set({willRenderShapeControls:t}),R()}get willRenderShapeTextControls(){return this.$$.ctx[35]}set willRenderShapeTextControls(t){this.$$set({willRenderShapeTextControls:t}),R()}get beforeAddShape(){return this.$$.ctx[36]}set beforeAddShape(t){this.$$set({beforeAddShape:t}),R()}get beforeRemoveShape(){return this.$$.ctx[37]}set beforeRemoveShape(t){this.$$set({beforeRemoveShape:t}),R()}get beforeDeselectShape(){return this.$$.ctx[38]}set beforeDeselectShape(t){this.$$set({beforeDeselectShape:t}),R()}get beforeSelectShape(){return this.$$.ctx[39]}set beforeSelectShape(t){this.$$set({beforeSelectShape:t}),R()}get beforeUpdateShape(){return this.$$.ctx[40]}set beforeUpdateShape(t){this.$$set({beforeUpdateShape:t}),R()}}]};function p6(t){let e,i,n;function r(a){t[51](a)}let o={stores:t[4],locale:t[5],isActive:t[1],isActiveFraction:t[2],isVisible:t[3],mapScreenPointToImagePoint:t[42],mapImagePointToScreenPoint:t[41],utilKey:"decorate",shapes:t[44],toolbar:t[19]||t[6],toolShapes:t[20]||t[7],toolRetainStyles:t[8],shapeControls:t[21]||t[9],shapePresets:t[25],enableSelectToolToAddShape:t[28],enableTapToAddText:t[29],enableViewTool:t[30],enableMoveTool:t[31],enableAutoSelectMoveTool:t[32],snapThreshold:t[15],gridSize:xi(t[17])?t[17]:t[14],enableSnapToContext:Dl(t[18])?t[18]:t[16],enableToolShareStyles:t[12],enablePresetSelectImage:t[23],enablePresetDropImage:t[24],enableButtonFlipVertical:t[22],parentRect:t[43],toolSelectRadius:t[10],textInputMode:t[11],willStartInteraction:t[40],willRenderPresetToolbar:t[26]||t[13],willRenderShapeStyleControls:t[27],hooks:{willRenderShapeControls:t[33],willRenderShapeTextControls:t[34],beforeAddShape:t[35],beforeRemoveShape:t[36],beforeDeselectShape:t[37],beforeSelectShape:t[38],beforeUpdateShape:t[39]}};return t[0]!==void 0&&(o.toolActive=t[0]),e=new Ru({props:o}),zi.push(()=>mo(e,"toolActive",r)),e.$on("measure",t[52]),{c(){At(e.$$.fragment)},m(a,s){It(e,a,s),n=!0},p(a,s){const l={};16&s[0]&&(l.stores=a[4]),32&s[0]&&(l.locale=a[5]),2&s[0]&&(l.isActive=a[1]),4&s[0]&&(l.isActiveFraction=a[2]),8&s[0]&&(l.isVisible=a[3]),2048&s[1]&&(l.mapScreenPointToImagePoint=a[42]),1024&s[1]&&(l.mapImagePointToScreenPoint=a[41]),524352&s[0]&&(l.toolbar=a[19]||a[6]),1048704&s[0]&&(l.toolShapes=a[20]||a[7]),256&s[0]&&(l.toolRetainStyles=a[8]),2097664&s[0]&&(l.shapeControls=a[21]||a[9]),33554432&s[0]&&(l.shapePresets=a[25]),268435456&s[0]&&(l.enableSelectToolToAddShape=a[28]),536870912&s[0]&&(l.enableTapToAddText=a[29]),1073741824&s[0]&&(l.enableViewTool=a[30]),1&s[1]&&(l.enableMoveTool=a[31]),2&s[1]&&(l.enableAutoSelectMoveTool=a[32]),32768&s[0]&&(l.snapThreshold=a[15]),147456&s[0]&&(l.gridSize=xi(a[17])?a[17]:a[14]),327680&s[0]&&(l.enableSnapToContext=Dl(a[18])?a[18]:a[16]),4096&s[0]&&(l.enableToolShareStyles=a[12]),8388608&s[0]&&(l.enablePresetSelectImage=a[23]),16777216&s[0]&&(l.enablePresetDropImage=a[24]),4194304&s[0]&&(l.enableButtonFlipVertical=a[22]),1024&s[0]&&(l.toolSelectRadius=a[10]),2048&s[0]&&(l.textInputMode=a[11]),512&s[1]&&(l.willStartInteraction=a[40]),67117056&s[0]&&(l.willRenderPresetToolbar=a[26]||a[13]),134217728&s[0]&&(l.willRenderShapeStyleControls=a[27]),508&s[1]&&(l.hooks={willRenderShapeControls:a[33],willRenderShapeTextControls:a[34],beforeAddShape:a[35],beforeRemoveShape:a[36],beforeDeselectShape:a[37],beforeSelectShape:a[38],beforeUpdateShape:a[39]}),!i&&1&s[0]&&(i=!0,l.toolActive=a[0],To(()=>i=!1)),e.$set(l)},i(a){n||(M(e.$$.fragment,a),n=!0)},o(a){D(e.$$.fragment,a),n=!1},d(a){Et(e,a)}}}function h6(t,e,i){let n,r,o,a,s,{isActive:l}=e,{isActiveFraction:c}=e,{isVisible:d}=e,{stores:u}=e,{locale:p={}}=e,{markupEditorToolbar:h}=e,{markupEditorToolStyles:g}=e,{markupEditorToolRetainStyles:m}=e,{markupEditorShapeStyleControls:f}=e,{markupEditorToolSelectRadius:x}=e,{markupEditorTextInputMode:k}=e,{markupEditorToolShareStyles:v}=e,{willRenderShapePresetToolbar:C}=e,{markupEditorGridSize:P}=e,{markupEditorSnapThreshold:I}=e,{markupEditorSnapToContext:O=!0}=e,{decorateGridSize:T}=e,{decorateSnapToContext:L}=e,{decorateTools:F}=e,{decorateToolShapes:B}=e,{decorateShapeControls:y}=e,{decorateActiveTool:V}=e,{decorateEnableButtonFlipVertical:J=!1}=e,{decorateEnableSelectImagePreset:S=!1}=e,{decorateEnableDropImagePreset:H=!0}=e,{decoratePresets:K=[]}=e,{decorateWillRenderShapePresetToolbar:ut}=e,{decorateWillRenderShapeStyleControls:lt}=e,{enableSelectToolToAddShape:N}=e,{enableTapToAddText:ft}=e,{enableViewTool:$t}=e,{enableMoveTool:Lt}=e,{enableAutoSelectMoveTool:ct}=e,{willRenderShapeControls:et}=e,{willRenderShapeTextControls:ht}=e,{beforeAddShape:Y}=e,{beforeRemoveShape:Z}=e,{beforeDeselectShape:St}=e,{beforeSelectShape:nt}=e,{beforeUpdateShape:mt}=e,{markupEditorWillStartInteraction:Ft}=e;const{imageCropRect:oe,imageDecoration:Rt,imageSelectionRectPresentation:Ut,imageTransformsInterpolated:Ot}=u;return A(t,Ut,j=>i(49,a=j)),A(t,Ot,j=>i(50,s=j)),t.$$set=j=>{"isActive"in j&&i(1,l=j.isActive),"isActiveFraction"in j&&i(2,c=j.isActiveFraction),"isVisible"in j&&i(3,d=j.isVisible),"stores"in j&&i(4,u=j.stores),"locale"in j&&i(5,p=j.locale),"markupEditorToolbar"in j&&i(6,h=j.markupEditorToolbar),"markupEditorToolStyles"in j&&i(7,g=j.markupEditorToolStyles),"markupEditorToolRetainStyles"in j&&i(8,m=j.markupEditorToolRetainStyles),"markupEditorShapeStyleControls"in j&&i(9,f=j.markupEditorShapeStyleControls),"markupEditorToolSelectRadius"in j&&i(10,x=j.markupEditorToolSelectRadius),"markupEditorTextInputMode"in j&&i(11,k=j.markupEditorTextInputMode),"markupEditorToolShareStyles"in j&&i(12,v=j.markupEditorToolShareStyles),"willRenderShapePresetToolbar"in j&&i(13,C=j.willRenderShapePresetToolbar),"markupEditorGridSize"in j&&i(14,P=j.markupEditorGridSize),"markupEditorSnapThreshold"in j&&i(15,I=j.markupEditorSnapThreshold),"markupEditorSnapToContext"in j&&i(16,O=j.markupEditorSnapToContext),"decorateGridSize"in j&&i(17,T=j.decorateGridSize),"decorateSnapToContext"in j&&i(18,L=j.decorateSnapToContext),"decorateTools"in j&&i(19,F=j.decorateTools),"decorateToolShapes"in j&&i(20,B=j.decorateToolShapes),"decorateShapeControls"in j&&i(21,y=j.decorateShapeControls),"decorateActiveTool"in j&&i(0,V=j.decorateActiveTool),"decorateEnableButtonFlipVertical"in j&&i(22,J=j.decorateEnableButtonFlipVertical),"decorateEnableSelectImagePreset"in j&&i(23,S=j.decorateEnableSelectImagePreset),"decorateEnableDropImagePreset"in j&&i(24,H=j.decorateEnableDropImagePreset),"decoratePresets"in j&&i(25,K=j.decoratePresets),"decorateWillRenderShapePresetToolbar"in j&&i(26,ut=j.decorateWillRenderShapePresetToolbar),"decorateWillRenderShapeStyleControls"in j&&i(27,lt=j.decorateWillRenderShapeStyleControls),"enableSelectToolToAddShape"in j&&i(28,N=j.enableSelectToolToAddShape),"enableTapToAddText"in j&&i(29,ft=j.enableTapToAddText),"enableViewTool"in j&&i(30,$t=j.enableViewTool),"enableMoveTool"in j&&i(31,Lt=j.enableMoveTool),"enableAutoSelectMoveTool"in j&&i(32,ct=j.enableAutoSelectMoveTool),"willRenderShapeControls"in j&&i(33,et=j.willRenderShapeControls),"willRenderShapeTextControls"in j&&i(34,ht=j.willRenderShapeTextControls),"beforeAddShape"in j&&i(35,Y=j.beforeAddShape),"beforeRemoveShape"in j&&i(36,Z=j.beforeRemoveShape),"beforeDeselectShape"in j&&i(37,St=j.beforeDeselectShape),"beforeSelectShape"in j&&i(38,nt=j.beforeSelectShape),"beforeUpdateShape"in j&&i(39,mt=j.beforeUpdateShape),"markupEditorWillStartInteraction"in j&&i(40,Ft=j.markupEditorWillStartInteraction)},t.$$.update=()=>{524288&t.$$.dirty[1]&&i(48,n=s?s.scale:1),393216&t.$$.dirty[1]&&i(42,r=j=>{const wt=_e(j);return wt.x-=a.x,wt.y-=a.y,wt.x/=n,wt.y/=n,wt}),393216&t.$$.dirty[1]&&i(41,o=j=>{const wt=_e(j);return wt.x*=n,wt.y*=n,wt.x+=a.x,wt.y+=a.y,wt})},[V,l,c,d,u,p,h,g,m,f,x,k,v,C,P,I,O,T,L,F,B,y,J,S,H,K,ut,lt,N,ft,$t,Lt,ct,et,ht,Y,Z,St,nt,mt,Ft,o,r,oe,Rt,Ut,Ot,"decorate",n,a,s,function(j){V=j,i(0,V)},function(j){jr.call(this,t,j)}]}var m6={util:["decorate",class extends li{constructor(t){super(),si(this,t,h6,p6,ei,{name:47,isActive:1,isActiveFraction:2,isVisible:3,stores:4,locale:5,markupEditorToolbar:6,markupEditorToolStyles:7,markupEditorToolRetainStyles:8,markupEditorShapeStyleControls:9,markupEditorToolSelectRadius:10,markupEditorTextInputMode:11,markupEditorToolShareStyles:12,willRenderShapePresetToolbar:13,markupEditorGridSize:14,markupEditorSnapThreshold:15,markupEditorSnapToContext:16,decorateGridSize:17,decorateSnapToContext:18,decorateTools:19,decorateToolShapes:20,decorateShapeControls:21,decorateActiveTool:0,decorateEnableButtonFlipVertical:22,decorateEnableSelectImagePreset:23,decorateEnableDropImagePreset:24,decoratePresets:25,decorateWillRenderShapePresetToolbar:26,decorateWillRenderShapeStyleControls:27,enableSelectToolToAddShape:28,enableTapToAddText:29,enableViewTool:30,enableMoveTool:31,enableAutoSelectMoveTool:32,willRenderShapeControls:33,willRenderShapeTextControls:34,beforeAddShape:35,beforeRemoveShape:36,beforeDeselectShape:37,beforeSelectShape:38,beforeUpdateShape:39,markupEditorWillStartInteraction:40},null,[-1,-1])}get name(){return this.$$.ctx[47]}get isActive(){return this.$$.ctx[1]}set isActive(t){this.$$set({isActive:t}),R()}get isActiveFraction(){return this.$$.ctx[2]}set isActiveFraction(t){this.$$set({isActiveFraction:t}),R()}get isVisible(){return this.$$.ctx[3]}set isVisible(t){this.$$set({isVisible:t}),R()}get stores(){return this.$$.ctx[4]}set stores(t){this.$$set({stores:t}),R()}get locale(){return this.$$.ctx[5]}set locale(t){this.$$set({locale:t}),R()}get markupEditorToolbar(){return this.$$.ctx[6]}set markupEditorToolbar(t){this.$$set({markupEditorToolbar:t}),R()}get markupEditorToolStyles(){return this.$$.ctx[7]}set markupEditorToolStyles(t){this.$$set({markupEditorToolStyles:t}),R()}get markupEditorToolRetainStyles(){return this.$$.ctx[8]}set markupEditorToolRetainStyles(t){this.$$set({markupEditorToolRetainStyles:t}),R()}get markupEditorShapeStyleControls(){return this.$$.ctx[9]}set markupEditorShapeStyleControls(t){this.$$set({markupEditorShapeStyleControls:t}),R()}get markupEditorToolSelectRadius(){return this.$$.ctx[10]}set markupEditorToolSelectRadius(t){this.$$set({markupEditorToolSelectRadius:t}),R()}get markupEditorTextInputMode(){return this.$$.ctx[11]}set markupEditorTextInputMode(t){this.$$set({markupEditorTextInputMode:t}),R()}get markupEditorToolShareStyles(){return this.$$.ctx[12]}set markupEditorToolShareStyles(t){this.$$set({markupEditorToolShareStyles:t}),R()}get willRenderShapePresetToolbar(){return this.$$.ctx[13]}set willRenderShapePresetToolbar(t){this.$$set({willRenderShapePresetToolbar:t}),R()}get markupEditorGridSize(){return this.$$.ctx[14]}set markupEditorGridSize(t){this.$$set({markupEditorGridSize:t}),R()}get markupEditorSnapThreshold(){return this.$$.ctx[15]}set markupEditorSnapThreshold(t){this.$$set({markupEditorSnapThreshold:t}),R()}get markupEditorSnapToContext(){return this.$$.ctx[16]}set markupEditorSnapToContext(t){this.$$set({markupEditorSnapToContext:t}),R()}get decorateGridSize(){return this.$$.ctx[17]}set decorateGridSize(t){this.$$set({decorateGridSize:t}),R()}get decorateSnapToContext(){return this.$$.ctx[18]}set decorateSnapToContext(t){this.$$set({decorateSnapToContext:t}),R()}get decorateTools(){return this.$$.ctx[19]}set decorateTools(t){this.$$set({decorateTools:t}),R()}get decorateToolShapes(){return this.$$.ctx[20]}set decorateToolShapes(t){this.$$set({decorateToolShapes:t}),R()}get decorateShapeControls(){return this.$$.ctx[21]}set decorateShapeControls(t){this.$$set({decorateShapeControls:t}),R()}get decorateActiveTool(){return this.$$.ctx[0]}set decorateActiveTool(t){this.$$set({decorateActiveTool:t}),R()}get decorateEnableButtonFlipVertical(){return this.$$.ctx[22]}set decorateEnableButtonFlipVertical(t){this.$$set({decorateEnableButtonFlipVertical:t}),R()}get decorateEnableSelectImagePreset(){return this.$$.ctx[23]}set decorateEnableSelectImagePreset(t){this.$$set({decorateEnableSelectImagePreset:t}),R()}get decorateEnableDropImagePreset(){return this.$$.ctx[24]}set decorateEnableDropImagePreset(t){this.$$set({decorateEnableDropImagePreset:t}),R()}get decoratePresets(){return this.$$.ctx[25]}set decoratePresets(t){this.$$set({decoratePresets:t}),R()}get decorateWillRenderShapePresetToolbar(){return this.$$.ctx[26]}set decorateWillRenderShapePresetToolbar(t){this.$$set({decorateWillRenderShapePresetToolbar:t}),R()}get decorateWillRenderShapeStyleControls(){return this.$$.ctx[27]}set decorateWillRenderShapeStyleControls(t){this.$$set({decorateWillRenderShapeStyleControls:t}),R()}get enableSelectToolToAddShape(){return this.$$.ctx[28]}set enableSelectToolToAddShape(t){this.$$set({enableSelectToolToAddShape:t}),R()}get enableTapToAddText(){return this.$$.ctx[29]}set enableTapToAddText(t){this.$$set({enableTapToAddText:t}),R()}get enableViewTool(){return this.$$.ctx[30]}set enableViewTool(t){this.$$set({enableViewTool:t}),R()}get enableMoveTool(){return this.$$.ctx[31]}set enableMoveTool(t){this.$$set({enableMoveTool:t}),R()}get enableAutoSelectMoveTool(){return this.$$.ctx[32]}set enableAutoSelectMoveTool(t){this.$$set({enableAutoSelectMoveTool:t}),R()}get willRenderShapeControls(){return this.$$.ctx[33]}set willRenderShapeControls(t){this.$$set({willRenderShapeControls:t}),R()}get willRenderShapeTextControls(){return this.$$.ctx[34]}set willRenderShapeTextControls(t){this.$$set({willRenderShapeTextControls:t}),R()}get beforeAddShape(){return this.$$.ctx[35]}set beforeAddShape(t){this.$$set({beforeAddShape:t}),R()}get beforeRemoveShape(){return this.$$.ctx[36]}set beforeRemoveShape(t){this.$$set({beforeRemoveShape:t}),R()}get beforeDeselectShape(){return this.$$.ctx[37]}set beforeDeselectShape(t){this.$$set({beforeDeselectShape:t}),R()}get beforeSelectShape(){return this.$$.ctx[38]}set beforeSelectShape(t){this.$$set({beforeSelectShape:t}),R()}get beforeUpdateShape(){return this.$$.ctx[39]}set beforeUpdateShape(t){this.$$set({beforeUpdateShape:t}),R()}get markupEditorWillStartInteraction(){return this.$$.ctx[40]}set markupEditorWillStartInteraction(t){this.$$set({markupEditorWillStartInteraction:t}),R()}}]};function $6(t){let e,i;return e=new Ru({props:{stores:t[3],locale:t[4],isActive:t[0],isActiveFraction:t[1],isVisible:t[2],mapScreenPointToImagePoint:t[25],mapImagePointToScreenPoint:t[24],utilKey:"sticker",shapePresets:t[5],shapes:t[6]?t[34]:t[35],toolActive:"preset",imageFlipX:!!t[6]&&t[23],imageFlipY:!!t[6]&&t[22],imageRotation:t[6]?t[30]:0,parentRect:t[6]?t[36]:t[32],snapThreshold:t[28],gridSize:t[27],enableSnapToContext:t[26],enablePresetDropImage:t[7],enablePresetSelectImage:t[29],enableButtonFlipVertical:t[10]||t[8],toolSelectRadius:t[14],willStartInteraction:t[21],willRenderPresetToolbar:t[11]||t[9]||t[15],hooks:{willRenderShapeControls:t[12],willRenderShapeTextControls:t[13],beforeAddShape:t[16],beforeRemoveShape:t[17],beforeDeselectShape:t[18],beforeSelectShape:t[19],beforeUpdateShape:t[20]}}}),e.$on("measure",t[59]),{c(){At(e.$$.fragment)},m(n,r){It(e,n,r),i=!0},p(n,r){const o={};8&r[0]&&(o.stores=n[3]),16&r[0]&&(o.locale=n[4]),1&r[0]&&(o.isActive=n[0]),2&r[0]&&(o.isActiveFraction=n[1]),4&r[0]&&(o.isVisible=n[2]),33554432&r[0]&&(o.mapScreenPointToImagePoint=n[25]),16777216&r[0]&&(o.mapImagePointToScreenPoint=n[24]),32&r[0]&&(o.shapePresets=n[5]),64&r[0]&&(o.shapes=n[6]?n[34]:n[35]),8388672&r[0]&&(o.imageFlipX=!!n[6]&&n[23]),4194368&r[0]&&(o.imageFlipY=!!n[6]&&n[22]),1073741888&r[0]&&(o.imageRotation=n[6]?n[30]:0),64&r[0]&&(o.parentRect=n[6]?n[36]:n[32]),268435456&r[0]&&(o.snapThreshold=n[28]),134217728&r[0]&&(o.gridSize=n[27]),67108864&r[0]&&(o.enableSnapToContext=n[26]),128&r[0]&&(o.enablePresetDropImage=n[7]),536870912&r[0]&&(o.enablePresetSelectImage=n[29]),1280&r[0]&&(o.enableButtonFlipVertical=n[10]||n[8]),16384&r[0]&&(o.toolSelectRadius=n[14]),2097152&r[0]&&(o.willStartInteraction=n[21]),35328&r[0]&&(o.willRenderPresetToolbar=n[11]||n[9]||n[15]),2043904&r[0]&&(o.hooks={willRenderShapeControls:n[12],willRenderShapeTextControls:n[13],beforeAddShape:n[16],beforeRemoveShape:n[17],beforeDeselectShape:n[18],beforeSelectShape:n[19],beforeUpdateShape:n[20]}),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){D(e.$$.fragment,n),i=!1},d(n){Et(e,n)}}}function g6(t,e,i){let n,r,o,a,s,l,c,d,u,p,h,g,m,f,x,{isActive:k}=e,{isActiveFraction:v}=e,{isVisible:C}=e,{stores:P}=e,{locale:I={}}=e,{stickers:O=[]}=e,{stickerForceEnable:T=!1}=e,{stickerStickToImage:L=!1}=e,{stickerEnableSelectImagePreset:F=!0}=e,{stickerEnableDropImagePreset:B=!0}=e,{stickerEnableButtonFlipVertical:y=!1}=e,{stickerWillRenderShapePresetToolbar:V}=e,{stickerEnableSelectImage:J=!0}=e,{stickersEnableButtonFlipVertical:S=!1}=e,{stickersWillRenderShapePresetToolbar:H}=e,{markupEditorGridSize:K=0}=e,{markupEditorSnapThreshold:ut=0}=e,{markupEditorSnapToContext:lt=!1}=e,{annotateGridSize:N}=e,{annotateSnapToContext:ft}=e,{decorateGridSize:$t}=e,{decorateSnapToContext:Lt}=e,{willRenderShapeControls:ct}=e,{willRenderShapeTextControls:et}=e,{markupEditorToolSelectRadius:ht}=e,{willRenderShapePresetToolbar:Y}=e,{beforeAddShape:Z}=e,{beforeRemoveShape:St}=e,{beforeDeselectShape:nt}=e,{beforeSelectShape:mt}=e,{beforeUpdateShape:Ft}=e,{markupEditorWillStartInteraction:oe}=e;const{rootRect:Rt,imageCropRect:Ut,imageSelectionRectPresentation:Ot,imageAnnotation:j,imageDecoration:wt,imageSize:yt,imageTransforms:Gt,imageTransformsInterpolated:ue,imageRotation:pe,imageFlipX:ve,imageFlipY:ge}=P;return A(t,Rt,_=>i(58,f=_)),A(t,Ot,_=>i(54,d=_)),A(t,yt,_=>i(57,m=_)),A(t,Gt,_=>i(56,g=_)),A(t,ue,_=>i(55,h=_)),A(t,pe,_=>i(30,x=_)),A(t,ve,_=>i(23,p=_)),A(t,ge,_=>i(22,u=_)),t.$$set=_=>{"isActive"in _&&i(0,k=_.isActive),"isActiveFraction"in _&&i(1,v=_.isActiveFraction),"isVisible"in _&&i(2,C=_.isVisible),"stores"in _&&i(3,P=_.stores),"locale"in _&&i(4,I=_.locale),"stickers"in _&&i(5,O=_.stickers),"stickerForceEnable"in _&&i(43,T=_.stickerForceEnable),"stickerStickToImage"in _&&i(6,L=_.stickerStickToImage),"stickerEnableSelectImagePreset"in _&&i(44,F=_.stickerEnableSelectImagePreset),"stickerEnableDropImagePreset"in _&&i(7,B=_.stickerEnableDropImagePreset),"stickerEnableButtonFlipVertical"in _&&i(8,y=_.stickerEnableButtonFlipVertical),"stickerWillRenderShapePresetToolbar"in _&&i(9,V=_.stickerWillRenderShapePresetToolbar),"stickerEnableSelectImage"in _&&i(45,J=_.stickerEnableSelectImage),"stickersEnableButtonFlipVertical"in _&&i(10,S=_.stickersEnableButtonFlipVertical),"stickersWillRenderShapePresetToolbar"in _&&i(11,H=_.stickersWillRenderShapePresetToolbar),"markupEditorGridSize"in _&&i(46,K=_.markupEditorGridSize),"markupEditorSnapThreshold"in _&&i(47,ut=_.markupEditorSnapThreshold),"markupEditorSnapToContext"in _&&i(48,lt=_.markupEditorSnapToContext),"annotateGridSize"in _&&i(49,N=_.annotateGridSize),"annotateSnapToContext"in _&&i(50,ft=_.annotateSnapToContext),"decorateGridSize"in _&&i(51,$t=_.decorateGridSize),"decorateSnapToContext"in _&&i(52,Lt=_.decorateSnapToContext),"willRenderShapeControls"in _&&i(12,ct=_.willRenderShapeControls),"willRenderShapeTextControls"in _&&i(13,et=_.willRenderShapeTextControls),"markupEditorToolSelectRadius"in _&&i(14,ht=_.markupEditorToolSelectRadius),"willRenderShapePresetToolbar"in _&&i(15,Y=_.willRenderShapePresetToolbar),"beforeAddShape"in _&&i(16,Z=_.beforeAddShape),"beforeRemoveShape"in _&&i(17,St=_.beforeRemoveShape),"beforeDeselectShape"in _&&i(18,nt=_.beforeDeselectShape),"beforeSelectShape"in _&&i(19,mt=_.beforeSelectShape),"beforeUpdateShape"in _&&i(20,Ft=_.beforeUpdateShape),"markupEditorWillStartInteraction"in _&&i(21,oe=_.markupEditorWillStartInteraction)},t.$$.update=()=>{16777216&t.$$.dirty[1]&&i(53,n=h?h.scale:1),24576&t.$$.dirty[1]&&i(29,r=F!==!1&&J),65536&t.$$.dirty[1]&&i(28,o=ut),64&t.$$.dirty[0]|1343488&t.$$.dirty[1]&&i(27,a=L?xi(N)?N:K:xi($t)?$t:K),64&t.$$.dirty[0]|2752512&t.$$.dirty[1]&&i(26,s=L?Dl(ft)?ft:lt:Dl(Lt)?Lt:lt),12582976&t.$$.dirty[0]|264241152&t.$$.dirty[1]&&i(25,l=L?_=>Zh(_,f,m,h.origin,h.translation,g.rotation.z,h.scale,p,u):_=>{const we=_e(_);return we.x-=d.x,we.y-=d.y,we.x/=n,we.y/=n,we}),12582976&t.$$.dirty[0]|264241152&t.$$.dirty[1]&&i(24,c=L?_=>Gh(_,f,m,h.origin,h.translation,g.rotation.z,h.scale,p,u):_=>{const we=_e(_);return we.x*=n,we.y*=n,we.x+=d.x,we.y+=d.y,we})},[k,v,C,P,I,O,L,B,y,V,S,H,ct,et,ht,Y,Z,St,nt,mt,Ft,oe,u,p,c,l,s,a,o,r,x,Rt,Ut,Ot,j,wt,yt,Gt,ue,pe,ve,ge,"sticker",T,F,J,K,ut,lt,N,ft,$t,Lt,n,d,h,g,m,f,function(_){jr.call(this,t,_)}]}var f6={util:["sticker",class extends li{constructor(t){super(),si(this,t,g6,$6,ei,{name:42,isActive:0,isActiveFraction:1,isVisible:2,stores:3,locale:4,stickers:5,stickerForceEnable:43,stickerStickToImage:6,stickerEnableSelectImagePreset:44,stickerEnableDropImagePreset:7,stickerEnableButtonFlipVertical:8,stickerWillRenderShapePresetToolbar:9,stickerEnableSelectImage:45,stickersEnableButtonFlipVertical:10,stickersWillRenderShapePresetToolbar:11,markupEditorGridSize:46,markupEditorSnapThreshold:47,markupEditorSnapToContext:48,annotateGridSize:49,annotateSnapToContext:50,decorateGridSize:51,decorateSnapToContext:52,willRenderShapeControls:12,willRenderShapeTextControls:13,markupEditorToolSelectRadius:14,willRenderShapePresetToolbar:15,beforeAddShape:16,beforeRemoveShape:17,beforeDeselectShape:18,beforeSelectShape:19,beforeUpdateShape:20,markupEditorWillStartInteraction:21},null,[-1,-1])}get name(){return this.$$.ctx[42]}get isActive(){return this.$$.ctx[0]}set isActive(t){this.$$set({isActive:t}),R()}get isActiveFraction(){return this.$$.ctx[1]}set isActiveFraction(t){this.$$set({isActiveFraction:t}),R()}get isVisible(){return this.$$.ctx[2]}set isVisible(t){this.$$set({isVisible:t}),R()}get stores(){return this.$$.ctx[3]}set stores(t){this.$$set({stores:t}),R()}get locale(){return this.$$.ctx[4]}set locale(t){this.$$set({locale:t}),R()}get stickers(){return this.$$.ctx[5]}set stickers(t){this.$$set({stickers:t}),R()}get stickerForceEnable(){return this.$$.ctx[43]}set stickerForceEnable(t){this.$$set({stickerForceEnable:t}),R()}get stickerStickToImage(){return this.$$.ctx[6]}set stickerStickToImage(t){this.$$set({stickerStickToImage:t}),R()}get stickerEnableSelectImagePreset(){return this.$$.ctx[44]}set stickerEnableSelectImagePreset(t){this.$$set({stickerEnableSelectImagePreset:t}),R()}get stickerEnableDropImagePreset(){return this.$$.ctx[7]}set stickerEnableDropImagePreset(t){this.$$set({stickerEnableDropImagePreset:t}),R()}get stickerEnableButtonFlipVertical(){return this.$$.ctx[8]}set stickerEnableButtonFlipVertical(t){this.$$set({stickerEnableButtonFlipVertical:t}),R()}get stickerWillRenderShapePresetToolbar(){return this.$$.ctx[9]}set stickerWillRenderShapePresetToolbar(t){this.$$set({stickerWillRenderShapePresetToolbar:t}),R()}get stickerEnableSelectImage(){return this.$$.ctx[45]}set stickerEnableSelectImage(t){this.$$set({stickerEnableSelectImage:t}),R()}get stickersEnableButtonFlipVertical(){return this.$$.ctx[10]}set stickersEnableButtonFlipVertical(t){this.$$set({stickersEnableButtonFlipVertical:t}),R()}get stickersWillRenderShapePresetToolbar(){return this.$$.ctx[11]}set stickersWillRenderShapePresetToolbar(t){this.$$set({stickersWillRenderShapePresetToolbar:t}),R()}get markupEditorGridSize(){return this.$$.ctx[46]}set markupEditorGridSize(t){this.$$set({markupEditorGridSize:t}),R()}get markupEditorSnapThreshold(){return this.$$.ctx[47]}set markupEditorSnapThreshold(t){this.$$set({markupEditorSnapThreshold:t}),R()}get markupEditorSnapToContext(){return this.$$.ctx[48]}set markupEditorSnapToContext(t){this.$$set({markupEditorSnapToContext:t}),R()}get annotateGridSize(){return this.$$.ctx[49]}set annotateGridSize(t){this.$$set({annotateGridSize:t}),R()}get annotateSnapToContext(){return this.$$.ctx[50]}set annotateSnapToContext(t){this.$$set({annotateSnapToContext:t}),R()}get decorateGridSize(){return this.$$.ctx[51]}set decorateGridSize(t){this.$$set({decorateGridSize:t}),R()}get decorateSnapToContext(){return this.$$.ctx[52]}set decorateSnapToContext(t){this.$$set({decorateSnapToContext:t}),R()}get willRenderShapeControls(){return this.$$.ctx[12]}set willRenderShapeControls(t){this.$$set({willRenderShapeControls:t}),R()}get willRenderShapeTextControls(){return this.$$.ctx[13]}set willRenderShapeTextControls(t){this.$$set({willRenderShapeTextControls:t}),R()}get markupEditorToolSelectRadius(){return this.$$.ctx[14]}set markupEditorToolSelectRadius(t){this.$$set({markupEditorToolSelectRadius:t}),R()}get willRenderShapePresetToolbar(){return this.$$.ctx[15]}set willRenderShapePresetToolbar(t){this.$$set({willRenderShapePresetToolbar:t}),R()}get beforeAddShape(){return this.$$.ctx[16]}set beforeAddShape(t){this.$$set({beforeAddShape:t}),R()}get beforeRemoveShape(){return this.$$.ctx[17]}set beforeRemoveShape(t){this.$$set({beforeRemoveShape:t}),R()}get beforeDeselectShape(){return this.$$.ctx[18]}set beforeDeselectShape(t){this.$$set({beforeDeselectShape:t}),R()}get beforeSelectShape(){return this.$$.ctx[19]}set beforeSelectShape(t){this.$$set({beforeSelectShape:t}),R()}get beforeUpdateShape(){return this.$$.ctx[20]}set beforeUpdateShape(t){this.$$set({beforeUpdateShape:t}),R()}get markupEditorWillStartInteraction(){return this.$$.ctx[21]}set markupEditorWillStartInteraction(t){this.$$set({markupEditorWillStartInteraction:t}),R()}},({stickers:t,stickerEnableSelectImage:e,stickerEnableSelectImagePreset:i,stickerEnableDropImagePreset:n,stickerForceEnable:r})=>t&&t.length||e||i||n||r]};function y6(t){let e,i,n,r,o,a=(t[14](t[34].value)||"")+"",s=(tn(t[34].label)?t[34].label(t[1]):t[34].label)+"";return{c(){e=pt("div"),i=new bu(!1),n=de(),r=pt("span"),o=cn(s),i.a=n,w(e,"slot","option")},m(l,c){tt(l,e,c),i.m(a,e),Tt(e,n),Tt(e,r),Tt(r,o)},p(l,c){8&c[1]&&a!==(a=(l[14](l[34].value)||"")+"")&&i.p(a),2&c[0]|8&c[1]&&s!==(s=(tn(l[34].label)?l[34].label(l[1]):l[34].label)+"")&&An(o,s)},d(l){l&&Q(e)}}}function x6(t){let e,i;return e=new Qa({props:{locale:t[1],class:"PinturaControlList",layout:"row",options:t[2],selectedIndex:t[6],onchange:t[12],$$slots:{option:[y6,({option:n})=>({34:n}),({option:n})=>[0,n?8:0]]},$$scope:{ctx:t}}}),{c(){At(e.$$.fragment)},m(n,r){It(e,n,r),i=!0},p(n,r){const o={};2&r[0]&&(o.locale=n[1]),4&r[0]&&(o.options=n[2]),64&r[0]&&(o.selectedIndex=n[6]),2&r[0]|24&r[1]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){D(e.$$.fragment,n),i=!1},d(n){Et(e,n)}}}function b6(t){let e,i,n,r,o;return i=new Pu({props:{locale:t[1],class:"PinturaControlPanels",shape:t[4],onchange:t[13],controls:t[3],scrollElasticity:t[7]}}),r=new ka({props:{elasticity:t[10],$$slots:{default:[x6]},$$scope:{ctx:t}}}),{c(){e=pt("div"),At(i.$$.fragment),n=de(),At(r.$$.fragment),w(e,"slot","footer"),w(e,"style",t[5])},m(a,s){tt(a,e,s),It(i,e,null),Tt(e,n),It(r,e,null),o=!0},p(a,s){const l={};2&s[0]&&(l.locale=a[1]),16&s[0]&&(l.shape=a[4]),8&s[0]&&(l.controls=a[3]),128&s[0]&&(l.scrollElasticity=a[7]),i.$set(l);const c={};70&s[0]|16&s[1]&&(c.$$scope={dirty:s,ctx:a}),r.$set(c),(!o||32&s[0])&&w(e,"style",a[5])},i(a){o||(M(i.$$.fragment,a),M(r.$$.fragment,a),o=!0)},o(a){D(i.$$.fragment,a),D(r.$$.fragment,a),o=!1},d(a){a&&Q(e),Et(i),Et(r)}}}function v6(t){let e,i;return e=new ol({props:{$$slots:{footer:[b6]},$$scope:{ctx:t}}}),e.$on("measure",t[23]),{c(){At(e.$$.fragment)},m(n,r){It(e,n,r),i=!0},p(n,r){const o={};254&r[0]|16&r[1]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){D(e.$$.fragment,n),i=!1},d(n){Et(e,n)}}}function w6(t,e,i){let n,r,o,a,s,l,c,d,u=Qe,p=()=>(u(),u=Nr(h,S=>i(20,s=S)),h);t.$$.on_destroy.push(()=>u());let{isActive:h}=e;p();let{stores:g}=e,{locale:m={}}=e,{frameStyles:f={}}=e,{frameOptions:x=[]}=e,{markupEditorShapeStyleControls:k}=e;const v=sn("elasticityMultiplier");A(t,v,S=>i(22,d=S));const{history:C,animation:P,scrollElasticity:I,imageFrame:O,allowPan:T,allowZoom:L,allowZoomControls:F,allowPlayPause:B}=g;A(t,P,S=>i(21,l=S)),A(t,O,S=>i(4,c=S));let y={},V;const J=ai(l?20:0);return A(t,J,S=>i(19,a=S)),t.$$set=S=>{"isActive"in S&&p(i(0,h=S.isActive)),"stores"in S&&i(17,g=S.stores),"locale"in S&&i(1,m=S.locale),"frameStyles"in S&&i(18,f=S.frameStyles),"frameOptions"in S&&i(2,x=S.frameOptions),"markupEditorShapeStyleControls"in S&&i(3,k=S.markupEditorShapeStyleControls)},t.$$.update=()=>{1048576&t.$$.dirty[0]&&T.set(s),1048576&t.$$.dirty[0]&&L.set(s),1048576&t.$$.dirty[0]&&F.set(s),1048576&t.$$.dirty[0]&&s&&B.set(!0),4194304&t.$$.dirty[0]&&i(7,n=d*I),20&t.$$.dirty[0]&&i(6,r=c?x.findIndex(([S])=>S===c.id):0),3145728&t.$$.dirty[0]&&l&&J.set(s?0:20),524288&t.$$.dirty[0]&&i(5,o=a?`transform: translateY(${a}px)`:void 0)},[h,m,x,k,c,o,r,n,v,P,I,O,({value:S})=>{const H=f[S];if(!H||!H.shape)return O.set(void 0),void C.write();const{shape:K}=H,ut={id:S,..._n(K),...Object.keys(y).reduce((lt,N)=>(K[N]&&(lt[N]=y[N]),lt),{})};O.set(ut),C.write()},function(S){ze(S,"frameColor")&&(y.frameColor=S.frameColor),c&&(ya(c,S),O.set(c),clearTimeout(V),V=setTimeout(()=>{C.write()},200))},S=>{const H=f[S];var K;if(H&&H.thumb)return K=H.thumb,/div/i.test(K)||W2(K)?K:/rect|path|circle|line|<g>/i.test(K)?`<svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" stroke-width="1" stroke="currentColor" fill="none" aria-hidden="true" focusable="false" stroke-linecap="round" stroke-linejoin="round">${K}</svg>`:`<img src="${K}" alt=""/>`},J,"frame",g,f,a,s,l,d,function(S){jr.call(this,t,S)}]}var S6={util:["frame",class extends li{constructor(t){super(),si(this,t,w6,v6,ei,{name:16,isActive:0,stores:17,locale:1,frameStyles:18,frameOptions:2,markupEditorShapeStyleControls:3},null,[-1,-1])}get name(){return this.$$.ctx[16]}get isActive(){return this.$$.ctx[0]}set isActive(t){this.$$set({isActive:t}),R()}get stores(){return this.$$.ctx[17]}set stores(t){this.$$set({stores:t}),R()}get locale(){return this.$$.ctx[1]}set locale(t){this.$$set({locale:t}),R()}get frameStyles(){return this.$$.ctx[18]}set frameStyles(t){this.$$set({frameStyles:t}),R()}get frameOptions(){return this.$$.ctx[2]}set frameOptions(t){this.$$set({frameOptions:t}),R()}get markupEditorShapeStyleControls(){return this.$$.ctx[3]}set markupEditorShapeStyleControls(t){this.$$set({markupEditorShapeStyleControls:t}),R()}},({src:t})=>t&&!Wl(t)]};function k6(t){let e,i,n,r,o,a,s,l;return{c(){e=pt("div"),i=pt("input"),r=de(),o=pt("label"),a=cn(t[1]),w(i,"id",t[0]),w(i,"type","number"),w(i,"min","1"),w(i,"inputmode","numeric"),w(i,"pattern","[0-9]*"),w(i,"data-state",t[3]),w(i,"autocomplete","off"),w(i,"placeholder",t[4]),i.value=n=t[5]===void 0?"":t[7](t[5]+""),w(o,"for",t[0]),w(o,"title",t[2]),w(o,"aria-label",t[2]),w(e,"class","PinturaInputDimension")},m(c,d){tt(c,e,d),Tt(e,i),Tt(e,r),Tt(e,o),Tt(o,a),s||(l=Mt(i,"input",t[8]),s=!0)},p(c,[d]){1&d&&w(i,"id",c[0]),8&d&&w(i,"data-state",c[3]),16&d&&w(i,"placeholder",c[4]),160&d&&n!==(n=c[5]===void 0?"":c[7](c[5]+""))&&i.value!==n&&(i.value=n),2&d&&An(a,c[1]),1&d&&w(o,"for",c[0]),4&d&&w(o,"title",c[2]),4&d&&w(o,"aria-label",c[2])},i:Qe,o:Qe,d(c){c&&Q(e),s=!1,l()}}}function C6(t,e,i){let{id:n}=e,{label:r}=e,{title:o}=e,{state:a}=e,{placeholder:s}=e,{value:l}=e,{onchange:c}=e,{format:d=u=>u.replace(/\D/g,"")}=e;return t.$$set=u=>{"id"in u&&i(0,n=u.id),"label"in u&&i(1,r=u.label),"title"in u&&i(2,o=u.title),"state"in u&&i(3,a=u.state),"placeholder"in u&&i(4,s=u.placeholder),"value"in u&&i(5,l=u.value),"onchange"in u&&i(6,c=u.onchange),"format"in u&&i(7,d=u.format)},[n,r,o,a,s,l,c,d,u=>c(d(u.currentTarget.value))]}class Ef extends li{constructor(e){super(),si(this,e,C6,k6,ei,{id:0,label:1,title:2,state:3,placeholder:4,value:5,onchange:6,format:7})}}function T6(t){let e;return{c(){e=Cr("g")},m(i,n){tt(i,e,n),e.innerHTML=t[2]},p(i,n){4&n&&(e.innerHTML=i[2])},d(i){i&&Q(e)}}}function M6(t){let e,i,n,r,o,a,s,l;return o=new Mo({props:{$$slots:{default:[T6]},$$scope:{ctx:t}}}),{c(){e=pt("div"),i=pt("input"),n=de(),r=pt("label"),At(o.$$.fragment),w(i,"id",t[0]),w(i,"class","implicit"),w(i,"type","checkbox"),i.checked=t[1],w(r,"for",t[0]),w(r,"title",t[3])},m(c,d){tt(c,e,d),Tt(e,i),Tt(e,n),Tt(e,r),It(o,r,null),a=!0,s||(l=Mt(i,"change",t[5]),s=!0)},p(c,[d]){(!a||1&d)&&w(i,"id",c[0]),(!a||2&d)&&(i.checked=c[1]);const u={};68&d&&(u.$$scope={dirty:d,ctx:c}),o.$set(u),(!a||1&d)&&w(r,"for",c[0]),(!a||8&d)&&w(r,"title",c[3])},i(c){a||(M(o.$$.fragment,c),a=!0)},o(c){D(o.$$.fragment,c),a=!1},d(c){c&&Q(e),Et(o),s=!1,l()}}}function P6(t,e,i){let{id:n}=e,{locked:r}=e,{icon:o}=e,{title:a}=e,{onchange:s}=e;return t.$$set=l=>{"id"in l&&i(0,n=l.id),"locked"in l&&i(1,r=l.locked),"icon"in l&&i(2,o=l.icon),"title"in l&&i(3,a=l.title),"onchange"in l&&i(4,s=l.onchange)},[n,r,o,a,s,l=>s(l.currentTarget.checked)]}class R6 extends li{constructor(e){super(),si(this,e,P6,M6,ei,{id:0,locked:1,icon:2,title:3,onchange:4})}}function I6(t){let e;return{c(){e=cn("Save")},m(i,n){tt(i,e,n)},d(i){i&&Q(e)}}}function E6(t){let e,i,n,r,o,a,s,l,c,d,u,p,h,g=t[1].resizeLabelFormCaption+"";return l=new $o({props:{items:t[4]}}),d=new ks({props:{type:"submit",class:"implicit",$$slots:{default:[I6]},$$scope:{ctx:t}}}),{c(){e=pt("form"),i=pt("div"),n=pt("fieldset"),r=pt("legend"),o=cn(g),a=de(),s=pt("div"),At(l.$$.fragment),c=de(),At(d.$$.fragment),w(r,"class","implicit"),w(s,"class","PinturaFieldsetInner"),w(i,"class","PinturaFormInner"),w(e,"slot","footer"),w(e,"style",t[3])},m(m,f){tt(m,e,f),Tt(e,i),Tt(i,n),Tt(n,r),Tt(r,o),Tt(n,a),Tt(n,s),It(l,s,null),t[65](s),Tt(i,c),It(d,i,null),u=!0,p||(h=[Mt(s,"focusin",t[15]),Mt(s,"focusout",t[16]),Mt(e,"submit",Lb(t[17]))],p=!0)},p(m,f){(!u||2&f[0])&&g!==(g=m[1].resizeLabelFormCaption+"")&&An(o,g);const x={};16&f[0]&&(x.items=m[4]),l.$set(x);const k={};16&f[3]&&(k.$$scope={dirty:f,ctx:m}),d.$set(k),(!u||8&f[0])&&w(e,"style",m[3])},i(m){u||(M(l.$$.fragment,m),M(d.$$.fragment,m),u=!0)},o(m){D(l.$$.fragment,m),D(d.$$.fragment,m),u=!1},d(m){m&&Q(e),Et(l),t[65](null),Et(d),p=!1,_i(h)}}}function A6(t){let e,i;return e=new ol({props:{$$slots:{footer:[E6]},$$scope:{ctx:t}}}),e.$on("measure",t[66]),{c(){At(e.$$.fragment)},m(n,r){It(e,n,r),i=!0},p(n,r){const o={};30&r[0]|16&r[3]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){D(e.$$.fragment,n),i=!1},d(n){Et(e,n)}}}function L6(t,e,i){let n,r,o,a,s,l,c,d,u,p,h,g,m,f,x,k,v,C,P,I,O,T,L,F,B,y,V,J,S,H,K=Qe,ut=()=>(K(),K=Nr(N,it=>i(49,h=it)),N);t.$$.on_destroy.push(()=>K());const lt=(it,Xt=0,Nt=9999)=>{if(Oe(it)&&!(it=it.replace(/\D/g,"")).length)return;const Zt=Math.round(it);return Number.isNaN(Zt)?void 0:Yi(Zt,Xt,Nt)};let{isActive:N}=e;ut();let{stores:ft}=e,{locale:$t={}}=e,{resizeMinSize:Lt=Vn(1,1)}=e,{resizeMaxSize:ct=Vn(9999,9999)}=e,{resizeAspectRatioLocked:et=!1}=e,{resizeEnableButtonLockAspectRatio:ht=!0}=e,{resizeSizePresetOptions:Y}=e,{resizeWidthPresetOptions:Z}=e,{resizeHeightPresetOptions:St}=e,{resizeWillRenderFooter:nt=Xi}=e;const mt=ai(0,{stiffness:.15,damping:.3});A(t,mt,it=>i(54,k=it));const{animation:Ft,imageSize:oe,imageCropRect:Rt,imageCropRectAspectRatio:Ut,imageCropAspectRatio:Ot,imageOutputSize:j,imageSelectionZoom:wt,imageSelectionPan:yt,history:Gt,env:ue,allowPan:pe,allowZoom:ve,allowZoomControls:ge,allowPlayPause:_}=ft;A(t,Ft,it=>i(50,g=it)),A(t,oe,it=>i(73,J=it)),A(t,Rt,it=>i(52,f=it)),A(t,Ut,it=>i(53,x=it)),A(t,Ot,it=>i(72,F=it)),A(t,j,it=>i(61,L=it)),A(t,wt,it=>i(74,S=it)),A(t,yt,it=>i(75,H=it)),A(t,ue,it=>i(51,m=it));const we=ra();let gi,xe,_t,Te,Ie,He,vi=Qi();const vt=(it,Xt,Nt,Zt,Yt)=>it!=null&&Nt!==Xt?it>=Zt[Xt]&&it<=Yt[Xt]?"valid":"invalid":"undetermined",bt=(it,Xt,Nt)=>Math.round(it!=null?it/Xt:Nt.height),Ze=()=>{et&&xe&&_t&&(Te==="width"?i(39,_t=Math.round(xe/x)):Te==="height"?i(38,xe=Math.round(_t*x)):(Ie==="width"?i(39,_t=Math.round(xe/x)):Ie==="height"&&i(38,xe=Math.round(_t*x)),Pe()))},Pe=it=>{let Xt=lt(xe),Nt=lt(_t),Zt=Xt,Yt=Nt,ot=Zt&&Yt,he=it||x;if(!Zt&&!Yt)return;Zt&&!Yt?Yt=Math.round(Zt/he):Yt&&!Zt&&(Zt=Math.round(Yt*he)),he=it||ot?Qo(Zt,Yt):x;let ie=Vn(Zt,Yt);iu(ct,ie)||(ie=Jr(ct,he)),iu(ie,Lt)||(ie=Ka(Lt,he)),i(38,xe=Xt!=null?Math.round(ie.width):void 0),i(39,_t=Nt!=null?Math.round(ie.height):void 0)},ri=()=>{Pe();const{width:it,height:Xt}=L||{};it===xe&&Xt===_t||(xe||_t?(xe&&_t&&Ct(Ot,F=xe/_t,F),Ct(j,L=Vn(xe,_t),L)):(Ct(Ot,F=J.width/J.height,F),Ct(Ot,F=void 0,F),Ct(j,L=void 0,L)),Gt.write())},Ge=j.subscribe(it=>{if(!it)return i(38,xe=void 0),void i(39,_t=void 0);i(38,xe=it.width),i(39,_t=it.height),Pe()}),ii=Ot.subscribe(it=>{(xe||_t)&&it&&(xe&&_t&&Qo(xe,_t)!==it?(i(39,_t=xe/it),Pe(it)):Pe())}),wi=it=>Oe(it[0])?(it[1]=it[1].map(wi),it):xi(it)?[it,""+it]:it,pi=it=>{if(Oe(it[0]))return it[1]=it[1].map(pi),it;let[Xt,Nt]=it;if(xi(Xt)&&xi(Nt)){const[Zt,Yt]=[Xt,Nt];Nt=`${Zt} &times; ${Yt}`,Xt=[Zt,Yt]}return[Xt,Nt]},Fi=le();A(t,Fi,it=>i(60,T=it));const X=le();A(t,X,it=>i(64,V=it));const jt=le();A(t,jt,it=>i(58,I=it));const U=le();A(t,U,it=>i(63,y=it));const Bt=le();A(t,Bt,it=>i(56,C=it));const ye=le();A(t,ye,it=>i(62,B=it));const Qt=Ei([j,X],([it,Xt],Nt)=>{if(!Xt)return Nt(-1);const Zt=Xt.findIndex(([Yt])=>{if(!Yt&&!it)return!0;if(!Yt)return!1;const[ot,he]=Yt;return it.width===ot&&it.height===he});Nt(Zt<0?0:Zt)});A(t,Qt,it=>i(59,O=it));const se=Ei([j,U],([it,Xt],Nt)=>{if(!Xt)return Nt(-1);const Zt=Xt.findIndex(([Yt])=>!Yt&&!it||!!Yt&&it.width===Yt);Nt(Zt<0?0:Zt)});A(t,se,it=>i(57,P=it));const zt=Ei([j,ye],([it,Xt],Nt)=>{if(!Xt)return Nt(-1);const Zt=Xt.findIndex(([Yt])=>!Yt&&!it||!!Yt&&it.height===Yt);Nt(Zt<0?0:Zt)});A(t,zt,it=>i(55,v=it));let We,Ae;const je=sn("redrawTrigger"),Ke=ai(g?20:0);return A(t,Ke,it=>i(48,p=it)),No(()=>{Ge(),ii()}),t.$$set=it=>{"isActive"in it&&ut(i(0,N=it.isActive)),"stores"in it&&i(30,ft=it.stores),"locale"in it&&i(1,$t=it.locale),"resizeMinSize"in it&&i(31,Lt=it.resizeMinSize),"resizeMaxSize"in it&&i(32,ct=it.resizeMaxSize),"resizeAspectRatioLocked"in it&&i(28,et=it.resizeAspectRatioLocked),"resizeEnableButtonLockAspectRatio"in it&&i(33,ht=it.resizeEnableButtonLockAspectRatio),"resizeSizePresetOptions"in it&&i(34,Y=it.resizeSizePresetOptions),"resizeWidthPresetOptions"in it&&i(35,Z=it.resizeWidthPresetOptions),"resizeHeightPresetOptions"in it&&i(36,St=it.resizeHeightPresetOptions),"resizeWillRenderFooter"in it&&i(37,nt=it.resizeWillRenderFooter)},t.$$.update=()=>{var it;262144&t.$$.dirty[1]&&pe.set(!h),262144&t.$$.dirty[1]&&ve.set(!h),262144&t.$$.dirty[1]&&ge.set(!h),262144&t.$$.dirty[1]&&h&&_.set(!0),536870920&t.$$.dirty[1]&&Y&&(Ct(Fi,T=Y.map(pi),T),Ct(X,V=$s(T),V)),536870912&t.$$.dirty[1]&&i(47,a=!!T),268435456&t.$$.dirty[1]|4&t.$$.dirty[2]&&i(46,n=O>-1&&V[O][1]),134217744&t.$$.dirty[1]&&Z&&(Ct(jt,I=Z.map(wi),I),Ct(U,y=$s(I),y)),134283264&t.$$.dirty[1]&&i(44,s=!a&&I),67108864&t.$$.dirty[1]|2&t.$$.dirty[2]&&i(45,r=P>-1&&y[P][1]),33554464&t.$$.dirty[1]&&St&&(Ct(Bt,C=St.map(wi),C),Ct(ye,B=$s(C),B)),33619968&t.$$.dirty[1]&&i(43,l=!a&&C),16777216&t.$$.dirty[1]|1&t.$$.dirty[2]&&i(42,o=v>-1&&B[v][1]),77824&t.$$.dirty[1]&&i(41,c=!a&&!s&&!l),268435458&t.$$.dirty[0]|1072824263&t.$$.dirty[1]&&i(4,d=je&&Ac(()=>{return nt([a&&["Dropdown","size-presets",{label:n,options:T,onchange:Yt=>{return(ot=Yt.value)&&!We&&(We={...f},Ae=F),ot?(Ct(Ot,F=Qo(ot[0],ot[1]),F),Ct(j,L=Gf(ot),L)):(Ct(Rt,f=We,f),Ct(Ot,F=Ae,F),Ct(j,L=void 0,L),We=void 0,Ae=void 0),void Gt.write();var ot},selectedIndex:O}],s&&["Dropdown","width-presets",{label:r,options:I,onchange:Yt=>{i(38,xe=Yt.value),ri()},selectedIndex:P}],s&&l&&["span","times",{class:"PinturaResizeLabel",innerHTML:"&times;"}],l&&["Dropdown","height-presets",{label:o,options:C,onchange:Yt=>{i(39,_t=Yt.value),ri()},selectedIndex:v}],c&&[Ef,"width-input",{id:"width-"+we,title:$t.resizeTitleInputWidth,label:$t.resizeLabelInputWidth,placeholder:(Xt=lt(_t),Nt=x,Zt=f,Math.round(Xt!=null?Xt*Nt:Zt.width)),value:xe,state:vt(lt(xe),"width",Te,Lt,ct),onchange:Yt=>{i(38,xe=Yt),Ze()}}],c&&ht&&[R6,"aspect-ratio-lock",{id:"aspect-ratio-lock-"+we,title:$t.resizeTitleButtonMaintainAspectRatio,icon:Oe($t.resizeIconButtonMaintainAspectRatio)?$t.resizeIconButtonMaintainAspectRatio:$t.resizeIconButtonMaintainAspectRatio(et,k),locked:et,onchange:Yt=>{i(28,et=Yt),Ze()}}],c&&[Ef,"height-input",{id:"height-"+we,title:$t.resizeTitleInputHeight,label:$t.resizeLabelInputHeight,placeholder:bt(lt(xe),x,f),value:_t,state:vt(lt(_t),"height",Te,Lt,ct),onchange:Yt=>{i(39,_t=Yt),Ze()}}]].filter(Boolean),{...m},()=>je.set({}));var Xt,Nt,Zt}).filter(Boolean)),268435456&t.$$.dirty[0]&&mt.set(et?1:0),512&t.$$.dirty[1]&&Te&&(Ie=Te),262144&t.$$.dirty[1]&&h&&(vi=H,He=S),1074003968&t.$$.dirty[1]&&(h?(it=L,Ct(yt,H=Qi(),H),Ct(wt,S=it&&f?it.width/f.width||it.height/f.height:1,S)):(Ct(yt,H=vi,H),Ct(wt,S=He,S))),786432&t.$$.dirty[1]&&g&&Ke.set(h?0:20),131072&t.$$.dirty[1]&&i(3,u=p?`transform: translateY(${p}px)`:void 0)},[N,$t,gi,u,d,mt,Ft,oe,Rt,Ut,Ot,j,wt,yt,ue,it=>{const Xt=it.target.id;/width/.test(Xt)?i(40,Te="width"):/height/.test(Xt)?i(40,Te="height"):/aspectRatio/i.test(Xt)?i(40,Te="lock"):i(40,Te=void 0)},it=>{gi.contains(it.relatedTarget)||ri(),i(40,Te=void 0)},ri,Fi,X,jt,U,Bt,ye,Qt,se,zt,Ke,et,"resize",ft,Lt,ct,ht,Y,Z,St,nt,xe,_t,Te,c,o,l,s,r,n,a,p,h,g,m,f,x,k,v,C,P,I,O,T,L,B,y,V,function(it){zi[it?"unshift":"push"](()=>{gi=it,i(2,gi)})},function(it){jr.call(this,t,it)}]}var z6={util:["resize",class extends li{constructor(t){super(),si(this,t,L6,A6,ei,{name:29,isActive:0,stores:30,locale:1,resizeMinSize:31,resizeMaxSize:32,resizeAspectRatioLocked:28,resizeEnableButtonLockAspectRatio:33,resizeSizePresetOptions:34,resizeWidthPresetOptions:35,resizeHeightPresetOptions:36,resizeWillRenderFooter:37},null,[-1,-1,-1,-1])}get name(){return this.$$.ctx[29]}get isActive(){return this.$$.ctx[0]}set isActive(t){this.$$set({isActive:t}),R()}get stores(){return this.$$.ctx[30]}set stores(t){this.$$set({stores:t}),R()}get locale(){return this.$$.ctx[1]}set locale(t){this.$$set({locale:t}),R()}get resizeMinSize(){return this.$$.ctx[31]}set resizeMinSize(t){this.$$set({resizeMinSize:t}),R()}get resizeMaxSize(){return this.$$.ctx[32]}set resizeMaxSize(t){this.$$set({resizeMaxSize:t}),R()}get resizeAspectRatioLocked(){return this.$$.ctx[28]}set resizeAspectRatioLocked(t){this.$$set({resizeAspectRatioLocked:t}),R()}get resizeEnableButtonLockAspectRatio(){return this.$$.ctx[33]}set resizeEnableButtonLockAspectRatio(t){this.$$set({resizeEnableButtonLockAspectRatio:t}),R()}get resizeSizePresetOptions(){return this.$$.ctx[34]}set resizeSizePresetOptions(t){this.$$set({resizeSizePresetOptions:t}),R()}get resizeWidthPresetOptions(){return this.$$.ctx[35]}set resizeWidthPresetOptions(t){this.$$set({resizeWidthPresetOptions:t}),R()}get resizeHeightPresetOptions(){return this.$$.ctx[36]}set resizeHeightPresetOptions(t){this.$$set({resizeHeightPresetOptions:t}),R()}get resizeWillRenderFooter(){return this.$$.ctx[37]}set resizeWillRenderFooter(t){this.$$set({resizeWillRenderFooter:t}),R()}},({src:t})=>t&&!Wl(t)]};function F6(t){let e,i;return e=new Ru({props:{stores:t[3],locale:t[4],isActive:t[0],isActiveFraction:t[1],isVisible:t[2],mapScreenPointToImagePoint:t[9],mapImagePointToScreenPoint:t[8],utilKey:"redact",imageRotation:t[10],imageFlipX:t[7],imageFlipY:t[6],shapes:t[11],toolbar:["rect"],toolShapes:{rectangle:[{x:0,y:0,width:0,height:0}]},toolActive:"rectangle",parentRect:t[13],enablePresetDropImage:!1,enablePresetSelectImage:!1,willStartInteraction:t[5],hooks:{willRenderShapeControls:t[24]}}}),e.$on("measure",t[25]),{c(){At(e.$$.fragment)},m(n,r){It(e,n,r),i=!0},p(n,[r]){const o={};8&r&&(o.stores=n[3]),16&r&&(o.locale=n[4]),1&r&&(o.isActive=n[0]),2&r&&(o.isActiveFraction=n[1]),4&r&&(o.isVisible=n[2]),512&r&&(o.mapScreenPointToImagePoint=n[9]),256&r&&(o.mapImagePointToScreenPoint=n[8]),1024&r&&(o.imageRotation=n[10]),128&r&&(o.imageFlipX=n[7]),64&r&&(o.imageFlipY=n[6]),32&r&&(o.willStartInteraction=n[5]),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){D(e.$$.fragment,n),i=!1},d(n){Et(e,n)}}}function D6(t,e,i){let n,r,o,a,s,l,c,d,u,{isActive:p}=e,{isActiveFraction:h}=e,{isVisible:g}=e,{stores:m}=e,{locale:f={}}=e,{markupEditorWillStartInteraction:x}=e;const{imageRedaction:k,rootRect:v,imageSize:C,imageRotation:P,imageFlipX:I,imageFlipY:O,imageTransforms:T,imageTransformsInterpolated:L}=m;return A(t,v,F=>i(23,d=F)),A(t,C,F=>i(22,c=F)),A(t,P,F=>i(10,u=F)),A(t,I,F=>i(7,a=F)),A(t,O,F=>i(6,o=F)),A(t,T,F=>i(21,l=F)),A(t,L,F=>i(20,s=F)),t.$$set=F=>{"isActive"in F&&i(0,p=F.isActive),"isActiveFraction"in F&&i(1,h=F.isActiveFraction),"isVisible"in F&&i(2,g=F.isVisible),"stores"in F&&i(3,m=F.stores),"locale"in F&&i(4,f=F.locale),"markupEditorWillStartInteraction"in F&&i(5,x=F.markupEditorWillStartInteraction)},t.$$.update=()=>{15728832&t.$$.dirty&&i(9,n=F=>Zh(F,d,c,s.origin,s.translation,l.rotation.z,s.scale,a,o)),15728832&t.$$.dirty&&i(8,r=F=>Gh(F,d,c,s.origin,s.translation,l.rotation.z,s.scale,a,o))},[p,h,g,m,f,x,o,a,r,n,u,k,v,C,P,I,O,T,L,"redact",s,l,c,d,F=>{const B=Qp(F[0]);return sw("to-front",B),F},function(F){jr.call(this,t,F)}]}var B6={util:["redact",class extends li{constructor(t){super(),si(this,t,D6,F6,ei,{name:19,isActive:0,isActiveFraction:1,isVisible:2,stores:3,locale:4,markupEditorWillStartInteraction:5})}get name(){return this.$$.ctx[19]}get isActive(){return this.$$.ctx[0]}set isActive(t){this.$$set({isActive:t}),R()}get isActiveFraction(){return this.$$.ctx[1]}set isActiveFraction(t){this.$$set({isActiveFraction:t}),R()}get isVisible(){return this.$$.ctx[2]}set isVisible(t){this.$$set({isVisible:t}),R()}get stores(){return this.$$.ctx[3]}set stores(t){this.$$set({stores:t}),R()}get locale(){return this.$$.ctx[4]}set locale(t){this.$$set({locale:t}),R()}get markupEditorWillStartInteraction(){return this.$$.ctx[5]}set markupEditorWillStartInteraction(t){this.$$set({markupEditorWillStartInteraction:t}),R()}},({src:t})=>t&&!Wl(t)]};function Af(t){let e,i,n=(tn(t[32].label)?t[32].label(t[1]):t[32].label)+"";return{c(){e=pt("span"),i=cn(n)},m(r,o){tt(r,e,o),Tt(e,i)},p(r,o){2&o[0]|2&o[1]&&n!==(n=(tn(r[32].label)?r[32].label(r[1]):r[32].label)+"")&&An(i,n)},d(r){r&&Q(e)}}}function O6(t){let e,i,n,r=(t[11](t[32].value)||"")+"",o=t[32].label&&Af(t);return{c(){e=pt("div"),i=new bu(!1),n=de(),o&&o.c(),i.a=n,w(e,"slot","option")},m(a,s){tt(a,e,s),i.m(r,e),Tt(e,n),o&&o.m(e,null)},p(a,s){2&s[1]&&r!==(r=(a[11](a[32].value)||"")+"")&&i.p(r),a[32].label?o?o.p(a,s):(o=Af(a),o.c(),o.m(e,null)):o&&(o.d(1),o=null)},d(a){a&&Q(e),o&&o.d()}}}function W6(t){let e,i;return e=new Qa({props:{locale:t[1],class:"PinturaControlList",layout:"row",options:t[2],selectedIndex:t[4],onchange:t[10],$$slots:{option:[O6,({option:n})=>({32:n}),({option:n})=>[0,n?2:0]]},$$scope:{ctx:t}}}),{c(){At(e.$$.fragment)},m(n,r){It(e,n,r),i=!0},p(n,r){const o={};2&r[0]&&(o.locale=n[1]),4&r[0]&&(o.options=n[2]),16&r[0]&&(o.selectedIndex=n[4]),2&r[0]|6&r[1]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){D(e.$$.fragment,n),i=!1},d(n){Et(e,n)}}}function _6(t){let e,i,n;return i=new ka({props:{elasticity:t[5],$$slots:{default:[W6]},$$scope:{ctx:t}}}),{c(){e=pt("div"),At(i.$$.fragment),w(e,"slot","footer"),w(e,"style",t[3])},m(r,o){tt(r,e,o),It(i,e,null),n=!0},p(r,o){const a={};32&o[0]&&(a.elasticity=r[5]),22&o[0]|4&o[1]&&(a.$$scope={dirty:o,ctx:r}),i.$set(a),(!n||8&o[0])&&w(e,"style",r[3])},i(r){n||(M(i.$$.fragment,r),n=!0)},o(r){D(i.$$.fragment,r),n=!1},d(r){r&&Q(e),Et(i)}}}function V6(t){let e,i;return e=new ol({props:{$$slots:{footer:[_6]},$$scope:{ctx:t}}}),e.$on("measure",t[22]),{c(){At(e.$$.fragment)},m(n,r){It(e,n,r),i=!0},p(n,r){const o={};62&r[0]|4&r[1]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){D(e.$$.fragment,n),i=!1},d(n){Et(e,n)}}}function N6(t,e,i){let n,r,o,a,s,l,c,d,u,p,h=Qe,g=()=>(h(),h=Nr(m,S=>i(17,l=S)),m);t.$$.on_destroy.push(()=>h());let{isActive:m}=e;g();let{stores:f}=e,{locale:x={}}=e,{fillOptions:k=[]}=e;const v=S=>S.map(H=>(K=>En(K)&&Oe(K[0])&&En(K[1]))(H)?[H[0],v(H[1]),H[2]]:(K=>[Array.isArray(K)&&K.length===3?[...K,1]:K,void 0,{disabled:!1}])(H)),C=sn("elasticityMultiplier");A(t,C,S=>i(21,p=S));const{history:P,animation:I,scrollElasticity:O,imageBackgroundColor:T,imageBackgroundImage:L,allowPan:F,allowZoom:B,allowZoomControls:y,allowPlayPause:V}=f;A(t,I,S=>i(18,c=S)),A(t,T,S=>i(20,u=S)),A(t,L,S=>i(19,d=S));const J=ai(c?20:0);return A(t,J,S=>i(16,s=S)),t.$$set=S=>{"isActive"in S&&g(i(0,m=S.isActive)),"stores"in S&&i(14,f=S.stores),"locale"in S&&i(1,x=S.locale),"fillOptions"in S&&i(15,k=S.fillOptions)},t.$$.update=()=>{32768&t.$$.dirty[0]&&i(2,n=v(k)),131072&t.$$.dirty[0]&&F.set(l),131072&t.$$.dirty[0]&&B.set(l),131072&t.$$.dirty[0]&&y.set(l),131072&t.$$.dirty[0]&&l&&V.set(!0),2097152&t.$$.dirty[0]&&i(5,r=p*O),1572868&t.$$.dirty[0]&&i(4,o=n.findIndex(([S])=>d?S===d:Array.isArray(S)?Ja(S,u):void 0)||0),393216&t.$$.dirty[0]&&c&&J.set(l?0:20),65536&t.$$.dirty[0]&&i(3,a=s?`transform: translateY(${s}px)`:void 0)},[m,x,n,a,o,r,C,I,T,L,({value:S})=>{Oe(S)&&(Ct(T,u=void 0,u),Ct(L,d=S,d)),En(S)&&(Ct(T,u=S,u),Ct(L,d=void 0,d)),P.write()},S=>{if(Oe(S))return`<div class="PinturaFillTile"><img src="${S}" alt="" width="48" height="64"/></div>`;if(En(S)){const[H,K,ut,lt]=S.map((N,ft)=>ft<3?Math.round(255*N):N);return`<div class="PinturaFillTile" data-transparent="${lt<1}"><div style="background-color:rgba(${H},${K},${ut},${lt})"></div></div>`}return"<div></div>"},J,"fill",f,k,s,l,c,d,u,p,function(S){jr.call(this,t,S)}]}var H6={util:["fill",class extends li{constructor(t){super(),si(this,t,N6,V6,ei,{name:13,isActive:0,stores:14,locale:1,fillOptions:15},null,[-1,-1])}get name(){return this.$$.ctx[13]}get isActive(){return this.$$.ctx[0]}set isActive(t){this.$$set({isActive:t}),R()}get stores(){return this.$$.ctx[14]}set stores(t){this.$$set({stores:t}),R()}get locale(){return this.$$.ctx[1]}set locale(t){this.$$set({locale:t}),R()}get fillOptions(){return this.$$.ctx[15]}set fillOptions(t){this.$$set({fillOptions:t}),R()}},({src:t,fillOptions:e})=>t&&!Wl(t)&&e&&e.length]};const Lf='<g fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" stroke-width=".125em"><path d="M18 6L6 18M6 6l12 12"></path></path></g>',Ep='<path fill="none" d="M9 15 L12 9 L15 15 M10 13.5 h3" stroke="currentColor" stroke-width=".125em"/>';var j6={labelReset:"Reset",labelDefault:"Default",labelAuto:"Auto",labelNone:"None",labelEdit:"Edit",labelClose:"Close",labelSupportError:t=>t.join(", ")+" not supported on this browser",labelColor:"Color",labelWidth:"Width",labelSize:"Size",labelOffset:"Offset",labelAmount:"Amount",labelInset:"Inset",labelRadius:"Radius",labelColorPalette:"Color palette",labelSizeExtraSmall:"Extra small",labelSizeSmall:"Small",labelSizeMediumSmall:"Medium small",labelSizeMedium:"Medium",labelSizeMediumLarge:"Medium large",labelSizeLarge:"Large",labelSizeExtraLarge:"Extra large",labelButtonCancel:"Cancel",labelButtonUndo:"Undo",labelButtonRedo:"Redo",labelButtonRevert:"Revert",labelButtonExport:"Done",labelZoomIn:"Zoom in",labelZoomOut:"Zoom out",labelZoomFit:"Fit to view",labelZoomActual:"Actual size",iconZoomIn:'<path stroke="currentColor" stroke-width=".125em" d="M8 12 h8 M12 8 v8" />',iconZoomOut:'<path stroke="currentColor" stroke-width=".125em" d="M9 12 h6" />',iconSupportError:'<g fill="none" stroke="currentColor" stroke-width="2"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/><g><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></g>',iconButtonClose:Lf,iconButtonRevert:'<g fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" stroke-width=".125em"><path d="M7.388 18.538a8 8 0 10-2.992-9.03"/><path fill="currentColor" d="M2.794 11.696L2.37 6.714l5.088 3.18z"/><path d="M12 8v4M12 12l4 2"/></g>',iconButtonUndo:'<g fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" stroke-width=".125em"><path d="M10 8h4c2.485 0 5 2 5 5s-2.515 5-5 5h-4"/><path fill="currentColor" d="M5 8l4-3v6z"/></g>',iconButtonRedo:'<g fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" stroke-width=".125em"><path d="M14 8h-4c-2.485 0-5 2-5 5s2.515 5 5 5h4"/><path fill="currentColor" d="M19 8l-4-3v6z"/></g>',iconButtonExport:'<polyline points="20 6 9 17 4 12" fill="none" stroke="currentColor" stroke-width=".125em"></polyline>',statusLabelButtonClose:"Close",statusIconButtonClose:Lf,statusLabelLoadImage:t=>t&&t.task?t.error?t.error.code==="IMAGE_TOO_SMALL"?"Minimum image size is {minWidth} &times; {minHeight}":"Error loading image":t.task==="blob-to-bitmap"?"Preparing image&hellip;":"Loading image&hellip;":"Waiting for image",statusLabelProcessImage:t=>{if(t&&t.task)return t.task==="store"?t.error?"Error uploading image":"Uploading image&hellip;":t.error?"Error processing image":"Processing image&hellip;"}};const U6={shapeLabelButtonSelectSticker:"Select image",shapeIconButtonSelectSticker:'<g fill="none" stroke="currentColor" stroke-width="0.0625em"><path d="M8 21 L15 11 L19 15"/><path d="M15 2 v5 h5"/><path d="M8 2 h8 l4 4 v12 q0 4 -4 4 h-8 q-4 0 -4 -4 v-12 q0 -4 4 -4z"/></g><circle fill="currentColor" cx="10" cy="8" r="1.5"/>',shapeIconButtonFlipHorizontal:'<g stroke="currentColor" stroke-width=".125em"><path fill="none" d="M6 6.5h5v11H6z"/><path fill="currentColor" d="M15 6.5h3v11h-3z"/><path d="M11 4v16" fill="currentColor"/></g>',shapeIconButtonFlipVertical:'<g stroke="currentColor" stroke-width=".125em"><rect x="7" y="8" width="11" height="5" fill="none"/><rect x="7" y="17" width="11" height="2" fill="currentColor"/><line x1="5" y1="13" x2="20" y2="13"/></g>',shapeIconButtonRemove:'<g fill="none" fill-rule="evenodd"><path stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" d="M7.5 7h9z"/><path d="M7.916 9h8.168a1 1 0 01.99 1.14l-.972 6.862a2 2 0 01-1.473 1.653c-.877.23-1.753.345-2.629.345-.876 0-1.752-.115-2.628-.345a2 2 0 01-1.473-1.653l-.973-6.862A1 1 0 017.916 9z" fill="currentColor"/><rect fill="currentColor" x="10" y="5" width="4" height="3" rx="1"/></g>',shapeIconButtonDuplicate:'<g fill="none" fill-rule="evenodd"><path d="M15 13.994V16a2 2 0 01-2 2H8a2 2 0 01-2-2v-5a2 2 0 012-2h2.142" stroke="currentColor" stroke-width=".125em"/><path d="M15 9V8a1 1 0 00-2 0v1h-1a1 1 0 000 2h1v1a1 1 0 002 0v-1h1a1 1 0 000-2h-1zm-4-4h6a2 2 0 012 2v6a2 2 0 01-2 2h-6a2 2 0 01-2-2V7a2 2 0 012-2z" fill="currentColor"/></g>',shapeIconButtonMoveToFront:'<g fill="none" fill-rule="evenodd"><rect fill="currentColor" x="11" y="13" width="8" height="2" rx="1"/><rect fill="currentColor" x="9" y="17" width="10" height="2" rx="1"/><path d="M11.364 8H10a5 5 0 000 10M12 6.5L14.5 8 12 9.5z" stroke="currentColor" stroke-width=".125em" stroke-linecap="round"/></g>',shapeIconButtonTextLayoutAutoWidth:""+Ep,shapeIconButtonTextLayoutAutoHeight:'<g fill="currentColor"><circle cx="4" cy="12" r="1.5"/><circle cx="20" cy="12" r="1.5"/></g>'+Ep,shapeIconButtonTextLayoutFixedSize:'<g fill="currentColor"><circle cx="5" cy="6" r="1.5"/><circle cx="19" cy="6" r="1.5"/><circle cx="19" cy="19" r="1.5"/><circle cx="5" cy="19" r="1.5"/></g>'+Ep,shapeTitleButtonTextLayoutAutoWidth:"Auto width",shapeTitleButtonTextLayoutAutoHeight:"Auto height",shapeTitleButtonTextLayoutFixedSize:"Fixed size",shapeTitleButtonFlipHorizontal:"Flip Horizontal",shapeTitleButtonFlipVertical:"Flip Vertical",shapeTitleButtonRemove:"Remove",shapeTitleButtonDuplicate:"Duplicate",shapeTitleButtonMoveToFront:"Move to front",shapeLabelInputText:"Edit text",shapeIconInputCancel:'<g fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" stroke-width=".125em"><path d="M18 6L6 18M6 6l12 12"/></g>',shapeIconInputConfirm:'<g fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" stroke-width=".125em"><polyline points="20 6 9 17 4 12"/></g>',shapeLabelInputCancel:"Cancel",shapeLabelInputConfirm:"Confirm",shapeLabelStrokeNone:"No outline",shapeLabelFontStyleNormal:"Normal",shapeLabelFontStyleBold:"Bold",shapeLabelFontStyleItalic:"Italic",shapeLabelFontStyleItalicBold:"Bold Italic",shapeTitleBackgroundColor:"Fill color",shapeTitleCornerRadius:"Corner radius",shapeTitleFontFamily:"Font",shapeTitleFontSize:"Font size",shapeTitleFontStyle:"Font style",shapeTitleLineHeight:"Line height",shapeTitleLineStart:"Start",shapeTitleLineEnd:"End",shapeTitleStrokeWidth:"Line width",shapeTitleStrokeColor:"Line color",shapeTitleLineDecorationBar:"Bar",shapeTitleLineDecorationCircle:"Circle",shapeTitleLineDecorationSquare:"Square",shapeTitleLineDecorationArrow:"Arrow",shapeTitleLineDecorationCircleSolid:"Circle solid",shapeTitleLineDecorationSquareSolid:"Square solid",shapeTitleLineDecorationArrowSolid:"Arrow solid",shapeIconLineDecorationBar:'<g stroke="currentColor" stroke-linecap="round" stroke-width=".125em"><path d="M5,12 H16"/><path d="M16,8 V16"/></g>',shapeIconLineDecorationCircle:'<g stroke="currentColor" stroke-linecap="round"><path stroke-width=".125em" d="M5,12 H12"/><circle fill="none" stroke-width=".125em" cx="16" cy="12" r="4"/></g>',shapeIconLineDecorationSquare:'<g stroke="currentColor" stroke-linecap="round"><path stroke-width=".125em" d="M5,12 H12"/><rect fill="none" stroke-width=".125em" x="12" y="8" width="8" height="8"/></g>',shapeIconLineDecorationArrow:'<g stroke="currentColor" stroke-linecap="round" stroke-width=".125em"><path d="M5,12 H16 M13,7 l6,5 l-6,5" fill="none"/></g>',shapeIconLineDecorationCircleSolid:'<g stroke="currentColor" stroke-linecap="round"><path stroke-width=".125em" d="M5,12 H12"/><circle fill="currentColor" cx="16" cy="12" r="4"/></g>',shapeIconLineDecorationSquareSolid:'<g stroke="currentColor" stroke-linecap="round"><path stroke-width=".125em" d="M5,12 H12"/><rect fill="currentColor" x="12" y="8" width="8" height="8"/></g>',shapeIconLineDecorationArrowSolid:'<g stroke="currentColor" stroke-linecap="round" stroke-width=".125em"><path d="M5,12 H16"/><path d="M13,7 l6,5 l-6,5z" fill="currentColor"/></g>',shapeTitleColorTransparent:"Transparent",shapeTitleColorWhite:"White",shapeTitleColorSilver:"Silver",shapeTitleColorGray:"Gray",shapeTitleColorBlack:"Black",shapeTitleColorNavy:"Navy",shapeTitleColorBlue:"Blue",shapeTitleColorAqua:"Aqua",shapeTitleColorTeal:"Teal",shapeTitleColorOlive:"Olive",shapeTitleColorGreen:"Green",shapeTitleColorYellow:"Yellow",shapeTitleColorOrange:"Orange",shapeTitleColorRed:"Red",shapeTitleColorMaroon:"Maroon",shapeTitleColorFuchsia:"Fuchsia",shapeTitleColorPurple:"Purple",shapeTitleTextOutline:"Text outline",shapeTitleTextOutlineWidth:"Width",shapeTitleTextShadow:"Text shadow",shapeTitleTextShadowBlur:"Blur",shapeTitleTextColor:"Font color",shapeTitleTextAlign:"Text align",shapeTitleTextAlignLeft:"Left align text",shapeTitleTextAlignCenter:"Center align text",shapeTitleTextAlignRight:"Right align text",shapeIconTextAlignLeft:'<g stroke-width=".125em" stroke="currentColor"><line x1="5" y1="8" x2="15" y2="8"/><line x1="5" y1="12" x2="19" y2="12"/><line x1="5" y1="16" x2="14" y2="16"/></g>',shapeIconTextAlignCenter:'<g stroke-width=".125em" stroke="currentColor"><line x1="7" y1="8" x2="17" y2="8"/><line x1="5" y1="12" x2="19" y2="12"/><line x1="8" y1="16" x2="16" y2="16"/></g>',shapeIconTextAlignRight:'<g stroke-width=".125em" stroke="currentColor"><line x1="9" y1="8" x2="19" y2="8"/><line x1="5" y1="12" x2="19" y2="12"/><line x1="11" y1="16" x2="19" y2="16"/></g>',shapeLabelToolMove:"Move",shapeLabelToolView:"View",shapeLabelToolSharpie:"Sharpie",shapeLabelToolEraser:"Eraser",shapeLabelToolPath:"Path",shapeLabelToolRectangle:"Rectangle",shapeLabelToolEllipse:"Ellipse",shapeLabelToolArrow:"Arrow",shapeLabelToolLine:"Line",shapeLabelToolText:"Text",shapeLabelToolPreset:"Stickers",shapeIconToolView:'<g stroke-width=".125em" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path d="M10.98 9.703V2.567c0-1.19 1.19-1.785 1.784-1.785.595 0 1.784.595 1.784 1.785v3.568"/><path d="M14.548 9.703V4.35c0-1.19 1.19-1.784 1.784-1.784.595 0 1.784.594 1.784 1.784v2.973"/><path d="M18.116 10.244V7.271c0-1.19 1.19-1.784 1.784-1.784.595 0 1.785.595 1.785 1.784 0 1.19 0 8.92-1.19 12.488-1.19 3.569-10.704 4.758-13.678 0-2.973-4.757-2.973-4.757-4.163-6.541-1.189-1.784-1.153-2.974-.594-3.568.558-.595 1.784-1.19 2.973.594 1.277 1.916 2.07 2.907 2.379 2.974V5.487c0-1.19 1.19-1.784 1.784-1.784.595 0 1.784.595 1.784 1.784V8.46"/></g>',shapeIconToolMove:'<g stroke-width=".125em" stroke="currentColor" fill="none"><path d="M6 2 L6 19 L18 13 Z M13 18 L16 24" stroke="currentColor" stroke-width=".125em" fill="none" fill-rule="evenodd" stroke-linejoin="round"/></g>',shapeIconToolSharpie:'<g stroke-width=".125em" stroke="currentColor" fill="none"><path d="M2.025 5c5.616-2.732 8.833-3.857 9.65-3.374C12.903 2.351.518 12.666 2.026 14 3.534 15.334 16.536.566 17.73 2.566 18.924 4.566 3.98 17.187 4.831 18c.851.813 9.848-6 11.643-6 1.087 0-2.53 5.11-2.92 7-.086.41 3.323-1.498 4.773-1 .494.17.64 2.317 1.319 3 .439.443 1.332.776 2.679 1" stroke="currentColor" stroke-width=".125em" fill="none" fill-rule="evenodd" stroke-linejoin="round"/></g>',shapeIconToolEraser:'<g stroke-width=".125em" stroke="currentColor" stroke-linecap="round" fill="none"><g transform="translate(3, 15) rotate(-45)"><rect x="0" y="0" width="18" height="10" rx="3"/></g><line x1="11" y1="21" x2="18" y2="21"/><line x1="20" y1="21" x2="22" y2="21"/></g>',shapeIconToolPath:'<g stroke-width=".125em" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" fill="none"><circle cx="21" cy="3" r="2"/><circle cx="9" cy="9" r="2"/><circle cx="3" cy="21" r="2"/><path d="M19 4 11 8 M8 11 4 19"/></g>',shapeIconToolRectangle:'<g stroke-width=".125em" stroke="currentColor" fill="none"><rect x="1" y="1" width="22" height="22" rx="4"/></g>',shapeIconToolEllipse:'<g stroke-width=".125em" stroke="currentColor" fill="none"><circle cx="12" cy="12" r="11"/></g>',shapeIconToolArrow:'<g stroke-width=".125em" stroke="currentColor" fill="none"><line x1="20" y1="3" x2="6" y2="21"/><path d="m10 6 L21.5 1 L20 13.5" fill="currentColor" stroke="none"/></g>',shapeIconToolLine:'<g stroke-width=".125em" stroke="currentColor" fill="none"><line x1="20" y1="3" x2="6" y2="21"/></g>',shapeIconToolText:'<g stroke="none" fill="currentColor" transform="translate(6,0)"><path d="M8.14 20.085c.459 0 .901-.034 1.329-.102a8.597 8.597 0 001.015-.21v1.984c-.281.135-.695.247-1.242.336a9.328 9.328 0 01-1.477.133c-3.312 0-4.968-1.745-4.968-5.235V6.804H.344v-1.25l2.453-1.078L3.89.819h1.5v3.97h4.97v2.015H5.39v10.078c0 1.031.245 1.823.735 2.375s1.161.828 2.015.828z"/>',shapeIconToolPreset:'<g fill="none" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" stroke-width=".125em"><path d="M12 22c2.773 0 1.189-5.177 3-7 1.796-1.808 7-.25 7-3 0-5.523-4.477-10-10-10S2 6.477 2 12s4.477 10 10 10z"></path><path d="M20 17c-3 3-5 5-8 5"></path></g>',shapeTitleSelectionMode:"Selection mode",shapeTitleBrushSize:"Brush size",shapeLabelSelectionModeNew:"New",shapeLabelSelectionModeAdd:"Add",shapeLabelSelectionModeSubtract:"Remove",shapeLabelToolSelectionBrush:"Brush",shapeLabelToolSelectionLassoo:"Lassoo",shapeLabelToolSelectionRectangle:"Rectangle marquee",shapeLabelToolSelectionEllipse:"Ellipse marquee",shapeIconSelectionModeNew:'<g fill="none" fill-rule="evenodd" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"><path d="M6.5 17H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v1.5"/><rect width="12" height="12" x="9" y="9" fill="currentColor" fill-opacity=".25" rx="2"/></g>',shapeIconSelectionModeAdd:'<g fill="none" fill-rule="evenodd" stroke="currentColor"><path fill="currentColor" fill-opacity=".25" stroke-linecap="round" stroke-linejoin="round" d="M15 3a2 2 0 0 1 2 2v4h2a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-8a2 2 0 0 1-2-2v-2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h10Z"/><path d="M13 15h4M15 13v4"/></g>',shapeIconSelectionModeSubtract:'<g fill="none" fill-rule="evenodd" stroke="currentColor"><path fill="currentColor" fill-opacity=".25" stroke-linecap="round" stroke-linejoin="round" d="M15 3a2 2 0 0 1 2 2v4h-6a2 2 0 0 0-1.995 1.85L9 11v6H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h10Z"/><rect width="12" height="12" x="9" y="9" stroke-linecap="round" stroke-linejoin="round" rx="2"/><path d="M13 15h4"/></g>',shapeIconToolSelectionBrush:'<g stroke-width=".125em" stroke="currentColor" fill="none"><path d="M2.025 5c5.616-2.732 8.833-3.857 9.65-3.374C12.903 2.351.518 12.666 2.026 14 3.534 15.334 16.536.566 17.73 2.566 18.924 4.566 3.98 17.187 4.831 18c.851.813 9.848-6 11.643-6 1.087 0-2.53 5.11-2.92 7-.086.41 3.323-1.498 4.773-1 .494.17.64 2.317 1.319 3 .439.443 1.332.776 2.679 1" stroke="currentColor" fill-rule="evenodd" stroke-linejoin="round"/></g>',shapeIconToolSelectionLassoo:'<g fill="none" fill-rule="evenodd" stroke-width=".125em" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M11.428 17.702a18.46 18.46 0 0 0 4.085-1.595c5.851-3.112 9.019-8.599 7.074-12.256-1.945-3.657-8.265-4.1-14.116-.988C2.619 5.974-.55 11.46 1.396 15.118c.63 1.186 1.72 2.033 3.105 2.532"/><ellipse cx="8" cy="18.5" rx="3.5" ry="2.833" transform="rotate(-15 8 18.5)"/><path stroke-linecap="round" d="M5 18c3.347 1.048 5.514 1.881 6.5 2.5.859.54 1.517.994 1.5 2.364"/></g>',shapeIconToolSelectionRectangle:'<g stroke-width=".125em" stroke="currentColor"><path d="M9 1 h6 m4 0 h4v4 m0 4 v6 m0 4 v4h-4 m-4 0 h-6 m-4 0 h-4v-4 m0 -4 v-6 m0 -4 v-4h4" fill="none" /></g>',shapeIconToolSelectionEllipse:'<path stroke-width=".125em" stroke="currentColor" d="M1.21 9.853a11.054 11.054 0 0 0 0 4.294m1.643 3.965a11.054 11.054 0 0 0 3.035 3.035m3.965 1.644a11.054 11.054 0 0 0 4.294 0m3.965-1.644a11.054 11.054 0 0 0 3.035-3.035m1.644-3.965a11.054 11.054 0 0 0 0-4.294m-1.644-3.965a11.054 11.054 0 0 0-3.035-3.035m-3.965-1.644a11.054 11.054 0 0 0-4.294 0M5.888 2.853a11.054 11.054 0 0 0-3.035 3.035"/>'};var G6={cropLabel:"Crop",cropIcon:'<g stroke-width=".125em" stroke="currentColor" fill="none"><path d="M23 17H9a2 2 0 0 1-2-2v-5m0-3V1 M1 7h14a2 2 0 0 1 2 2v7m0 4v3"/></g>',cropIconButtonRecenter:'<path stroke="currentColor" fill="none" stroke-width="2" stroke-linejoin="bevel" d="M1.5 7.5v-6h6M1.5 16.5v6h6M22.5 16.5v6h-6M22.5 7.5v-6h-6"/><circle cx="12" cy="12" r="3.5" fill="currentColor" stroke="none"/>',cropIconButtonRotateLeft:'<g stroke="none" fill="currentColor"><path fill="none" d="M-1-1h582v402H-1z"/><rect x="3" rx="1" height="12" width="12" y="9"/><path d="M15 5h-1a5 5 0 015 5 1 1 0 002 0 7 7 0 00-7-7h-1.374l.747-.747A1 1 0 0011.958.84L9.603 3.194a1 1 0 000 1.415l2.355 2.355a1 1 0 001.415-1.414l-.55-.55H15z"/></g>',cropIconButtonRotateRight:'<g stroke="none" fill="currentColor"><path fill="none" d="M-1-1h582v402H-1z"/><path d="M11.177 5H10a5 5 0 00-5 5 1 1 0 01-2 0 7 7 0 017-7h1.374l-.747-.747A1 1 0 0112.042.84l2.355 2.355a1 1 0 010 1.415l-2.355 2.354a1 1 0 01-1.415-1.414l.55-.55z"/><rect rx="1" height="12" width="12" y="9" x="9"/></g>',cropIconButtonFlipVertical:'<g stroke="none" fill="currentColor"><path d="M19.993 12.143H7a1 1 0 0 1-1-1V5.994a1 1 0 0 1 1.368-.93l12.993 5.15a1 1 0 0 1-.368 1.93z"/><path d="M19.993 14a1 1 0 0 1 .368 1.93L7.368 21.078A1 1 0 0 1 6 20.148V15a1 1 0 0 1 1-1h12.993z" opacity=".6"/></g>',cropIconButtonFlipHorizontal:'<g stroke="none" fill="currentColor"><path d="M11.93 7.007V20a1 1 0 0 1-1 1H5.78a1 1 0 0 1-.93-1.368l5.15-12.993a1 1 0 0 1 1.929.368z"/><path d="M14 7.007V20a1 1 0 0 0 1 1h5.149a1 1 0 0 0 .93-1.368l-5.15-12.993A1 1 0 0 0 14 7.007z" opacity=".6"/></g>',cropIconSelectPreset:(t,e)=>{const[i,n,r]=e?[e<1?1:.3,e===1?.85:.5,e>1?1:.3]:[.2,.3,.4];return`<g fill="currentColor">
            <rect opacity="${i}" x="2" y="4" width="10" height="18" rx="1"/>
            <rect opacity="${n}" x="4" y="8" width="14" height="14" rx="1"/>
            <rect opacity="${r}" x="6" y="12" width="17" height="10" rx="1"/>
        </g>`},cropIconCropBoundary:(t,e)=>{const[i,n,r,o]=e?[.3,1,0,0]:[0,0,.3,1];return`<g fill="currentColor">
            <rect opacity="${i}" x="2" y="3" width="20" height="20" rx="1"/>
            <rect opacity="${n}" x="7" y="8" width="10" height="10" rx="1"/>
            <rect opacity="${r}" x="4" y="8" width="14" height="14" rx="1"/>
            <rect opacity="${o}" x="12" y="4" width="10" height="10" rx="1"/>
        </g>`},cropLabelButtonRecenter:"Recenter",cropLabelButtonRotateLeft:"Rotate left",cropLabelButtonRotateRight:"Rotate right",cropLabelButtonFlipHorizontal:"Flip horizontal",cropLabelButtonFlipVertical:"Flip vertical",cropLabelSelectPreset:"Crop shape",cropLabelCropBoundary:"Crop boundary",cropLabelCropBoundaryEdge:"Edge of image",cropLabelCropBoundaryNone:"None",cropLabelTabRotation:"Rotation",cropLabelTabZoom:"Scale"},Z6={fillLabel:"Fill",fillIcon:`
    <g fill="none" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" stroke-width=".125em">
        <g transform="rotate(60, 12, 12)">
            <rect x="4" y="4" width="14" height="16" rx="3"/>
        </g>
        <path d="M21 13 L21 21"></path>
        <path d="M4.5 12.5 L19 12.5"></path>
    </g>
    `},X6={frameLabel:"Frame",frameIcon:`<g fill="none" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" stroke-width=".125em">
            <rect x="2" y="2" width="20" height="20" rx="4"/>
            <rect x="6" y="6" width="12" height="12" rx="1"/>
        </g>`,frameLabelMatSharp:"Mat",frameLabelMatRound:"Bevel",frameLabelLineSingle:"Line",frameLabelLineMultiple:"Zebra",frameLabelEdgeSeparate:"Inset",frameLabelEdgeOverlap:"Plus",frameLabelEdgeCross:"Lumber",frameLabelCornerHooks:"Hook",frameLabelPolaroid:"Polaroid"},Y6={redactLabel:"Redact",redactIcon:'<g fill="none" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" stroke-width=".125em"><path d="M 4 5 l 1 -1"/><path d="M 4 10 l 6 -6"/><path d="M 4 15 l 11 -11"/><path d="M 4 20 l 16 -16"/><path d="M 9 20 l 11 -11"/><path d="M 14 20 l 6 -6"/><path d="M 19 20 l 1 -1"/></g>'},ih=(t,e)=>{const i=Object.getOwnPropertyDescriptors(t);Object.keys(i).forEach(n=>{i[n].get?Object.defineProperty(e,n,{get:()=>t[n],set:r=>t[n]=r}):e[n]=t[n]})},V2=t=>{const e={},{sub:i,pub:n}=qa();Lr()&&document.doctype!==null||console.warn("Browser is in quirks mode, add <!DOCTYPE html> to page to fix render issues");const r=Gy();ih(r,e);const o=((c,d)=>{const u={},p=new Lg({target:c,props:{stores:d,pluginComponents:Array.from(Jp)}});let h=!1;const g=()=>{h||(Lr()&&window.removeEventListener("pagehide",g),p&&(h=!0,p.$destroy()))};Tp||(Tp=new Set(Oh(Lg).filter(f=>!iw.includes(f)))),Tp.forEach(f=>{Object.defineProperty(u,f,{get:()=>p[f],set:nw.includes(f)?x=>{p[f]={...p[f],...x}}:x=>p[f]=x})}),Object.defineProperty(u,"previewImageData",{get:()=>p.imagePreviewCurrent}),k2.forEach(f=>{const x=tu[f],k=x[0];Object.defineProperty(u,f,{get:()=>p.pluginInterface[k][f],set:v=>{const C=x.reduce((P,I)=>(P[I]={...p.pluginOptions[I],[f]:v},P),{});p.pluginOptions={...p.pluginOptions,...C}}})}),Object.defineProperty(u,"element",{get:()=>p.root,set:()=>{}});const m=p.history;return pu(u,{on:(f,x)=>{if(h)return()=>{};if(/undo|redo|revert|writehistory/.test(f))return m.on(f,x);const k=[p.sub(f,x),p.$on(f,v=>x(v instanceof CustomEvent&&!v.detail?void 0:v))].filter(Boolean);return()=>k.forEach(v=>v())},updateImagePreview:f=>{p.imagePreviewSrc=f},close:()=>!h&&p.pub("close"),destroy:g}),Object.defineProperty(u,"history",{get:()=>({undo:()=>m.undo(),redo:()=>m.redo(),revert:()=>m.revert(),get:()=>m.get(),getCollapsed:()=>m.get().splice(0,m.index+1),set:f=>m.set(f),write:f=>m.write(f),get length(){return m.length()},get index(){return m.index},set index(f){m.index=f}})}),Lr()&&window.addEventListener("pagehide",g),u})(t,r.stores);ih(o,e);const a=["loadImage","processImage","abortProcessImage","abortLoadImage"].map(c=>o.on(c,d=>{const u=r[c](d&&d.detail);u instanceof Promise&&u.catch($e)})),s=(c,d)=>{const u=i(c,d),p=r.on(c,d),h=o.on(c,d);return()=>{u(),p(),h()}};e.handleEvent=$e;const l=C2.map(c=>s(c,d=>e.handleEvent(c,d)));return pu(e,{on:s,updateImage:c=>new Promise((d,u)=>{const p=e.history.get(),h=e.history.index,g=e.imageState;r.loadImage(c).then(m=>{e.history.set(p),e.history.index=h,e.imageState=g,d(m)}).catch(u)}),close:()=>{n("close")},destroy:()=>{[...a,...l].forEach(c=>c()),o.destroy(),r.destroy(),n("destroy")}}),setTimeout(()=>n("init",e),0),e};Lr();var q6=(t,e={})=>{const i=Oe(t)?document.querySelector(t):t;if(!Al(i))return;e.class=e.class?"pintura-editor "+e.class:"pintura-editor";const n=V2(i);return Object.assign(n,e)};const zf=(t,e,i,n)=>{const r=rt(e.x-t.x,e.y-t.y),o=ro(r),a=5*i;let s;s=n?.5*a:Math.ceil(.5*(a-1));const l=Ar(_e(o),s);return{anchor:_e(t),offset:l,normal:o,solid:n,size:a,sizeHalf:s}},K6=(t,e,i)=>{const{strokeWidth:n,strokeColor:r,strokeJoin:o,strokeCap:a,...s}=t,{anchor:l,offset:c,normal:d,solid:u,size:p,sizeHalf:h}=e,g=l.x,m=l.y,f=Ar(_e(d),p),x=rt(g+f.x,m+f.y);if(Ar(f,.55),u){Fn(i,c);const k=Ar(_e(d),.5*h);return[{...s,points:[rt(g-k.x,m-k.y),rt(x.x-f.y,x.y+f.x),rt(x.x+f.y,x.y-f.x)],pathClose:!0,backgroundColor:r}]}{const k=Ar((P=>{const I=P.x;return P.x=-P.y,P.y=I,P})(_e(d)),.5),v=rt(g-k.x,m-k.y),C=rt(g+k.x,m+k.y);return[{...s,points:[rt(x.x+f.y,x.y-f.x),v,rt(g,m),C,rt(x.x-f.y,x.y+f.x)],pathClose:!1,strokeWidth:n,strokeColor:r,strokeJoin:o,strokeCap:a}]}},J6=(t,e,i)=>{const{strokeWidth:n,strokeColor:r,...o}=t,{anchor:a,solid:s,offset:l,normal:c,sizeHalf:d}=e;return Fn(i,l),s&&Fn(i,Tl(_e(c))),[{...o,x:a.x,y:a.y,rx:d,ry:d,backgroundColor:s?r:void 0,strokeWidth:s?void 0:n,strokeColor:s?void 0:r}]},Q6=(t,e)=>{const{strokeWidth:i,strokeColor:n,strokeJoin:r,strokeCap:o,...a}=t,{anchor:s,offset:l}=e;return[{...a,points:[rt(s.x-l.y,s.y+l.x),rt(s.x+l.y,s.y-l.x)],strokeWidth:i,strokeColor:n,strokeJoin:r,strokeCap:o}]},tk=(t,e,i)=>{const{strokeWidth:n,strokeColor:r,...o}=t,{anchor:a,solid:s,offset:l,normal:c,sizeHalf:d}=e;return Fn(i,l),[{...o,x:a.x-d,y:a.y-d,width:2*d,height:2*d,rotation:(u=c,Math.atan2(u.y,u.x)),backgroundColor:s?r:void 0,strokeWidth:s?void 0:n,strokeColor:s?void 0:r}];var u},ek=(t={})=>e=>{if(!e.lineStart&&!e.lineEnd)return;const i=[],{x1:n,y1:r,x2:o,y2:a,lineStart:s,lineEnd:l,strokeWidth:c,strokeColor:d,strokeJoin:u,strokeCap:p,_isFormatted:h,_prerender:g,_scale:m,_translate:f,isSelected:x,isEditing:k,disableErase:v,id:C,...P}=e,I=rt(n,r),O=rt(o,a),T=[I,O];if(s){const[L,F]=s.split("-"),B=t[L];if(B){const y=zf(I,O,c,!!F);i.push(...B({...P,strokeColor:d,strokeWidth:c,strokeJoin:u,strokeCap:p},y,I))}}if(l){const[L,F]=l.split("-"),B=t[L];if(B){const y=zf(O,I,c,!!F);i.push(...B({...P,strokeColor:d,strokeWidth:c,strokeJoin:u,strokeCap:p},y,O))}}return[{...P,points:T,strokeWidth:c,strokeColor:d,strokeJoin:u,strokeCap:p},...i]},ik=()=>({arrow:K6,circle:J6,square:tk,bar:Q6}),nh=(t,e)=>{const i=parseFloat(t)*e;return Oe(t)?i+"%":i},na=(t,e)=>Oe(t)?lu(t,e):t,nk=t=>[{...t,frameStyle:"line",frameInset:0,frameOffset:0,frameSize:t.frameSize?nh(t.frameSize,2):"2.5%",frameRadius:t.frameRound?nh(t.frameSize,2):0}],rk=({width:t,height:e,frameImage:i,frameSize:n="15%",frameOutset:r=0,frameSlices:o={x1:.15,y1:.15,x2:.85,y2:.85}},{isPreview:a})=>{if(!i)return[];const s=Math.sqrt(t*e),l=na(n,s),c=a?l:Math.round(l),d=c,u=na(r,s),p=2*u,{x1:h,x2:g,y1:m,y2:f}=o,x={x0:0,y0:0,x1:c,y1:d,x2:t-c,y2:e-d,x3:t,y3:e,cw:c,ch:d,ew:t-c-c,eh:e-d-d},k=a?1:0,v=2*k,C=u>0,P={expandsCanvas:C,width:x.cw,height:x.ch,backgroundImage:i};return[{expandsCanvas:C,x:x.x1-k-u,y:x.y0-u,width:x.ew+v+p,height:x.ch,backgroundCorners:[{x:h,y:0},{x:g,y:0},{x:g,y:m},{x:h,y:m}],backgroundImage:i},{expandsCanvas:C,x:x.x1-k-u,y:x.y2+u,width:x.ew+v+p,height:x.ch,backgroundCorners:[{x:h,y:f},{x:g,y:f},{x:g,y:1},{x:h,y:1}],backgroundImage:i},{expandsCanvas:C,x:x.x0-u,y:x.y1-k-u,width:x.cw,height:x.eh+v+p,backgroundCorners:[{x:0,y:m},{x:h,y:m},{x:h,y:f},{x:0,y:f}],backgroundImage:i},{expandsCanvas:C,x:x.x2+u,y:x.y1-k-u,width:x.cw,height:x.eh+v+p,backgroundCorners:[{x:g,y:m},{x:1,y:m},{x:1,y:f},{x:g,y:f}],backgroundImage:i},{...P,x:x.x0-u,y:x.y0-u,backgroundCorners:[{x:0,y:0},{x:h,y:0},{x:h,y:m},{x:0,y:m}]},{...P,x:x.x2+u,y:x.y0-u,backgroundCorners:[{x:g,y:0},{x:1,y:0},{x:1,y:m},{x:g,y:m}]},{...P,x:x.x2+u,y:x.y2+u,backgroundCorners:[{x:g,y:f},{x:1,y:f},{x:1,y:1},{x:g,y:1}]},{...P,x:x.x0-u,y:x.y2+u,backgroundCorners:[{x:0,y:f},{x:h,y:f},{x:h,y:1},{x:0,y:1}]}]},ok=({x:t,y:e,width:i,height:n,frameInset:r="3.5%",frameSize:o=".25%",frameColor:a=[1,1,1],frameOffset:s="5%",frameAmount:l=1,frameRadius:c=0,expandsCanvas:d=!1},{isPreview:u})=>{const p=Math.sqrt(i*n);let h=na(o,p);const g=na(r,p),m=na(s,p);let f=0;u||(h=Math.max(1,Math.round(h)),f=h%2==0?0:.5);const x=na(nh(c,l),p);return new Array(l).fill(void 0).map((k,v)=>{const C=m*v;let P=t+g+C,I=e+g+C,O=t+i-g-C,T=e+n-g-C;return u||(P=Math.round(P),I=Math.round(I),O=Math.round(O),T=Math.round(T)),{x:P+f,y:I+f,width:O-P,height:T-I,cornerRadius:x>0?x-C:0,strokeWidth:h,strokeColor:a,expandsCanvas:d}})},ak=({x:t,y:e,width:i,height:n,frameSize:r=".25%",frameOffset:o=0,frameInset:a="2.5%",frameColor:s=[1,1,1]},{isPreview:l})=>{const c=Math.sqrt(i*n);let d=na(r,c),u=na(a,c),p=na(o,c),h=0;l||(d=Math.max(1,Math.round(d)),u=Math.round(u),p=Math.round(p),h=d%2==0?0:.5);const g=p-u,m=t+u+h,f=e+u+h,x=t+i-u-h,k=e+n-u-h;return[{points:[rt(m+g,f),rt(x-g,f)]},{points:[rt(x,f+g),rt(x,k-g)]},{points:[rt(x-g,k),rt(m+g,k)]},{points:[rt(m,k-g),rt(m,f+g)]}].map(v=>(v.strokeWidth=d,v.strokeColor=s,v))},sk=({x:t,y:e,width:i,height:n,frameSize:r=".25%",frameInset:o="2.5%",frameLength:a="2.5%",frameColor:s=[1,1,1]},{isPreview:l})=>{const c=Math.sqrt(i*n);let d=na(r,c),u=na(o,c),p=na(a,c),h=0;l||(d=Math.max(1,Math.round(d)),u=Math.round(u),p=Math.round(p),h=d%2==0?0:.5);const g=t+u+h,m=e+u+h,f=t+i-u-h,x=e+n-u-h;return[{points:[rt(g,m+p),rt(g,m),rt(g+p,m)]},{points:[rt(f-p,m),rt(f,m),rt(f,m+p)]},{points:[rt(f,x-p),rt(f,x),rt(f-p,x)]},{points:[rt(g+p,x),rt(g,x),rt(g,x-p)]}].map(k=>(k.strokeWidth=d,k.strokeColor=s,k))},lk=({x:t,y:e,width:i,height:n,frameColor:r=[1,1,1]},{isPreview:o})=>{const a=Math.sqrt(i*n),s=.1*a;let l=.2*a,c=0;const d=.5*s;return o?c=1:l=Math.ceil(l),r.length=3,[{id:"border",x:t-d+c,y:e-d+c,width:i+s-2*c,height:n+l-2*c,frameStyle:"line",frameInset:0,frameOffset:0,frameSize:s,frameColor:r,expandsCanvas:!0},{id:"chin",x:t-d,y:n-c,width:i+s,height:l,backgroundColor:r,expandsCanvas:!0}].filter(Boolean)},ck=(t={})=>(e,i)=>{if(!ze(e,"frameStyle"))return;const n=e.frameStyle,r=t[n];if(!r)return;const{frameStyle:o,...a}=e;return r(a,i)},dk=()=>({solid:nk,hook:sk,line:ok,edge:ak,polaroid:lk,nine:rk}),uk=t=>{const e=(i,n={isPreview:!0})=>{const r=t.map(o=>{const a=o(i,n);if(a)return a.map(s=>e(s,n))}).filter(Boolean).flat();return r.length?r.flat().map((o,a)=>(o.id=i.id+"_"+a,o)):i};return e};typeof window<"u"&&(t=>{if(!t)return;const[e,i,n,r]=[[108,111,99,97,116,105,111,110],[82,101,103,69,120,112],[116,101,115,116],[112,113,105,110,97,92,46,110,108]].map(o=>o.map(a=>String.fromCharCode(a)).join(""));t._dzq9b88=new t[i](r)[n](t[e])})(window);const pk=e2,Ff=i2,hk=()=>({read:Ox,apply:Wf}),mk=(t={})=>{const{blurAmount:e,dataSizeScalar:i,scrambleAmount:n,backgroundColor:r}=t;return(o,a)=>(async(s,l={})=>{if(!s)return;const{width:c,height:d}=s,{dataSize:u=96,dataSizeScalar:p=1,scrambleAmount:h=4,blurAmount:g=6,outputFormat:m="canvas",backgroundColor:f=[0,0,0]}=l,x=Math.round(u*p),k=Math.min(x/c,x/d),v=Math.floor(c*k),C=Math.floor(d*k),P=ln("canvas",{width:v,height:C}),I=P.getContext("2d",{willReadFrequently:!0});if(f.length=3,I.fillStyle=kr(f),I.fillRect(0,0,v,C),Il(s)){const F=ln("canvas",{width:c,height:d});F.getContext("2d",{willReadFrequently:!0}).putImageData(s,0,0),I.drawImage(F,0,0,v,C),Jn(F)}else I.drawImage(s,0,0,v,C);const O=I.getImageData(0,0,v,C),T=[];if(h>0&&T.push([C4,{amount:h}]),g>0)for(let F=0;F<g;F++)T.push([cy,{matrix:T4}]);let L;if(T.length){const F=(V,J)=>`(err, imageData) => {
(${V[J][0].toString()})(Object.assign({ imageData: imageData }, filterInstructions[${J}]), 
${V[J+1]?F(V,J+1):"done"})
}`,B=`function (options, done) {
const filterInstructions = options.filterInstructions;
const imageData = options.imageData;
(${F(T,0)})(null, imageData)
}`,y=await Fc(B,[{imageData:O,filterInstructions:T.map(V=>V[1])}],[O.data.buffer]);L=fh(y)}else L=O;return m==="canvas"?(I.putImageData(L,0,0),P):L})(o,{blurAmount:e,scrambleAmount:n,backgroundColor:r,...a,dataSizeScalar:i||a.dataSizeScalar})},$k=F2,gk={markupEditorToolbar:Gw(),markupEditorToolStyles:Uw(),markupEditorShapeStyleControls:F2()},fk=tS,yk=aS,xk=hS,bk=u6,vk=m6,wk=f6,Sk=S6,kk=B6,Ck=z6,Tk=H6,Mk=Ew,Pk=ww,Rk=Vw,Ik=j6,Ek=U6,Ak=G6,Lk=Z6,zk={filterLabel:"Filter",filterIcon:'<g stroke-width=".125em" stroke="currentColor" fill="none"><path d="M18.347 9.907a6.5 6.5 0 1 0-1.872 3.306M3.26 11.574a6.5 6.5 0 1 0 2.815-1.417 M10.15 17.897A6.503 6.503 0 0 0 16.5 23a6.5 6.5 0 1 0-6.183-8.51"/></g>',filterLabelChrome:"Chrome",filterLabelFade:"Fade",filterLabelCold:"Cold",filterLabelWarm:"Warm",filterLabelPastel:"Pastel",filterLabelMonoDefault:"Mono",filterLabelMonoNoir:"Noir",filterLabelMonoWash:"Wash",filterLabelMonoStark:"Stark",filterLabelSepiaDefault:"Sepia",filterLabelSepiaBlues:"Blues",filterLabelSepiaRust:"Rust",filterLabelSepiaColor:"Color"},Fk={finetuneLabel:"Finetune",finetuneIcon:'<g stroke-width=".125em" stroke="currentColor" fill="none"><path d="M4 1v5.5m0 3.503V23M12 1v10.5m0 3.5v8M20 1v15.5m0 3.5v3M2 7h4M10 12h4M18 17h4"/></g>',finetuneLabelBrightness:"Brightness",finetuneLabelContrast:"Contrast",finetuneLabelSaturation:"Saturation",finetuneLabelExposure:"Exposure",finetuneLabelTemperature:"Temperature",finetuneLabelGamma:"Gamma",finetuneLabelClarity:"Clarity",finetuneLabelVignette:"Vignette"},Dk={resizeLabel:"Resize",resizeIcon:'<g stroke-width=".125em" stroke="currentColor" fill="none"><rect x="2" y="12" width="10" height="10" rx="2"/><path d="M4 11.5V4a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-5.5"/><path d="M14 10l3.365-3.365M14 6h4v4"/></g>',resizeLabelFormCaption:"Image output size",resizeLabelInputWidth:"w",resizeTitleInputWidth:"Width",resizeLabelInputHeight:"h",resizeTitleInputHeight:"Height",resizeTitleButtonMaintainAspectRatio:"Maintain aspectratio",resizeIconButtonMaintainAspectRatio:(t,e)=>`<defs><mask id="mask1" x="0" y="0" width="24" height="24" ><rect x="0" y="0" width="24" height="10" fill="#fff" stroke="none"/></mask></defs><g fill="none" fill-rule="evenodd"><g  mask="url(#mask1)"><path transform="translate(0 ${3*(e-1)})" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" d="M9.401 10.205v-.804a2.599 2.599 0 0 1 5.198 0V17"/></g><rect fill="currentColor" x="7" y="10" width="10" height="7" rx="1.5"/></g>`},Bk={decorateLabel:"Decorate",decorateIcon:'<g fill="none" fill-rule="evenodd"><path stroke="currentColor" stroke-width=".125em" stroke-linecap="round" stroke-linejoin="round" d="M12 18.5l-6.466 3.4 1.235-7.2-5.23-5.1 7.228-1.05L12 2l3.233 6.55 7.229 1.05-5.231 5.1 1.235 7.2z"/></g>'},Ok={annotateLabel:"Annotate",annotateIcon:'<g stroke-width=".125em" stroke="currentColor" fill="none"><path d="M17.086 2.914a2.828 2.828 0 1 1 4 4l-14.5 14.5-5.5 1.5 1.5-5.5 14.5-14.5z"/></g>'},Wk={stickerLabel:"Sticker",stickerIcon:'<g fill="none" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" stroke-width=".125em"><path d="M12 22c2.773 0 1.189-5.177 3-7 1.796-1.808 7-.25 7-3 0-5.523-4.477-10-10-10S2 6.477 2 12s4.477 10 10 10z"/><path d="M20 17c-3 3-5 5-8 5"/></g>'},_k=X6,Vk=Y6,Nk=q6,Hk=(t=[])=>uk([ck(dk()),ek(ik()),...t]),jk=(t={})=>{let e,i;Array.isArray(t.imageReader)||(i=t.imageReader,delete t.imageReader),Array.isArray(t.imageWriter)?e=Ff():(e=tn(t.imageWriter)?t.imageWriter:Ff(t.imageWriter),delete t.imageWriter);let n;return tn(t.imageScrambler)||(n=t.imageScrambler,delete t.imageScrambler),{imageReader:pk(i),imageWriter:e,imageOrienter:hk(),imageScrambler:mk(n)}},Uk=(t={})=>{rw(fk,yk,xk,bk,vk,wk,Sk,kk,Ck,Tk);const e=jk(t),i={...Ik,...Ek,...Ak,...Lk,...zk,...Fk,..._k,...Vk,...Dk,...Bk,...Ok,...Wk,...t.locale};delete t.locale;const n=typeof t.shapePreprocessor=="function"?t.shapePreprocessor:Hk(t.shapePreprocessor);return delete t.shapePreprocessor,t.markupEditorShapeStyleControls&&Object.entries(t.markupEditorShapeStyleControls).every(([r,o])=>/Options$/.test(r)||!Array.isArray(o))&&(t.markupEditorShapeStyleControls=$k({...t.markupEditorShapeStyleControls})),_y([{...e,shapePreprocessor:n,utils:["trim","crop","filter","finetune","retouch","annotate","decorate","sticker","fill","frame","redact","resize"],...Mk,...Pk,...Rk,...gk,stickerStickToImage:!0,locale:i},t])},Gk={mounted(){this.editor=Nk(this.$refs.elementRef,Object.assign({},this.$attrs)),this.unsubs=T2(this.editor,this.$refs.elementRef)},beforeUpdate(){Object.assign(this.editor,Object.assign({},this.$attrs))},beforeUnmount(){this.editor&&(this.editor.destroy(),this.unsubs.forEach(t=>t()),this.unsubs=[],this.editor=void 0)},render(){return Mx("div",{className:"PinturaRootWrapper",ref:"elementRef"})}},Zk=Px({__name:"MediaImageEditor",props:{media:{}},async setup(t){let e,i;const n=t,r=Uk({enableButtonClose:!0}),o=([e,i]=Rx(()=>Cx(n.media)),e=await e,i(),e);function a(l){n.media.setMediaImage(l.detail.dest),n.media.setEditing(!1),n.media.setUniqueId()}function s(l){l||n.media.setEditing(!1)}return(l,c)=>(Ix(),Ex(Fx,{to:"#drawer-editor"},[im(kx,{width:500,"rail-width":500,touchless:"","model-value":!0,"disable-resize-watcher":!0,elevation:0,class:"ig-navigation-drawer-editor","onUpdate:modelValue":s},{default:Ax(()=>[im(G1(Gk),Lx(G1(r),{src:G1(o),"onPintura:process":c[0]||(c[0]=d=>a(d)),"onPintura:close":c[1]||(c[1]=d=>l.media.setEditing(!1)),onContextmenu:c[2]||(c[2]=zx(()=>{},["stop"]))}),null,16,["src"])]),_:1})]))}}),qk=Tx(Zk,[["__scopeId","data-v-b380d6be"]]);export{qk as default};

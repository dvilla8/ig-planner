import{U as Nx,_ as Hx}from"./Dzeonyxl.js";import{c as jx,d as Ux,X as Gx,Q as Zx,V as Xx,l as um,Z as Yx,u as np,A as qx,ae as Kx,ak as Jx}from"./CSSan7tc.js";import{V as Qx}from"./D_cqak07.js";import"./1D4YcTGT.js";import"./DxczIF-R.js";import"./4DXztDKb.js";import"./POKVRF_S.js";import"./D3riv6nD.js";import"./Bx9LJo80.js";import"./BECYRdem.js";import"./CfaQeyCz.js";import"./DoTDkiiE.js";import"./jMqT0U9S.js";import"./CgdOR2KZ.js";import"./Br3yn1n2.js";import"./CkxxaOBx.js";import"./Wg96nlvY.js";/*!
 * Pintura v8.79.2 - Test version
 * (c) 2018-2024 PQINA Inc. - All Rights Reserved
 * License: https://pqina.nl/pintura/license/
 * 
 * This version of Pintura is for testing purposes only.
 * Visit https://pqina.nl/pintura/ to obtain a commercial license.
 */const tb=[{value:65504,name:"jfif"},{value:65498,name:"sos"},{value:65505,subvalue:17784,name:"exif"},{value:65505,subvalue:26740,name:"xmp"},{value:65506,subvalue:19792,name:"mpf"}];var Gf=t=>{if(t.getUint16(0)!==65496)return;const e=t.byteLength;let i,n=2,r;for(;n<e&&t.getUint8(n)===255;){i=t.getUint16(n);const o=tb.find(a=>a.value===i&&(!a.subvalue||a.subvalue===t.getUint16(n+2+2)));if(o){const{name:a}=o;r||(r={}),r[a]||(r[a]={offset:n,size:t.getUint16(n+2)})}if(i===65498)break;n+=2+t.getUint16(n+2)}return r},gh=(t,e,i)=>{if(!t)return;const n=new DataView(t),r=Gf(n);if(!r||!r.exif)return;const o=((a,s)=>{if(a.getUint16(s)!==65505)return;const l=a.getUint16(s+2);if(s+=4,a.getUint32(s)!==1165519206)return;s+=6;const c=a.getUint16(s);if(c!==18761&&c!==19789)return;const d=c===18761;if(s+=2,a.getUint16(s,d)!==42)return;s+=a.getUint32(s+2,d);const u=p=>{const h=[];let g=s;const m=Math.min(a.byteLength,s+l-16);for(;g<m;g+=12){const f=g;a.getUint16(f,d)===p&&h.push(f)}return h};return{read:p=>{const h=u(p);if(h.length)return a.getUint16(h[0]+8,d)},write:(p,h)=>{const g=u(p);return!!g.length&&(g.forEach(m=>a.setUint16(m+8,h,d)),!0)}}})(n,r.exif.offset);return o?i===void 0?o.read(e):o.write(e,i):void 0},fh=t=>window.__pqina_webapi__?window.__pqina_webapi__[t]:window[t],$e=(...t)=>{};const eb={ArrayBuffer:"readAsArrayBuffer"};var Zf=async(t,e=[0,t.size],i)=>await((n,r=$e,o={})=>new Promise((a,s)=>{const{dataFormat:l=eb.ArrayBuffer}=o,c=new(fh("FileReader"));c.onload=()=>a(c.result),c.onerror=()=>s(c.error),c.onprogress=r,c[l](n)}))(t.slice(...e),i),ib=async(t,e)=>{const i=await Zf(t,[0,262144],e);return gh(i,274)||1};let rp=null;var Mr=()=>(rp===null&&(rp=typeof window<"u"&&window.document!==void 0),rp);let _d=null;var Mu=()=>new Promise(t=>{if(_d===null){const e="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEASABIAAD/4QA6RXhpZgAATU0AKgAAAAgAAwESAAMAAAABAAYAAAEoAAMAAAABAAIAAAITAAMAAAABAAEAAAAAAAD/2wBDAP//////////////////////////////////////////////////////////////////////////////////////wAALCAABAAIBASIA/8QAJgABAAAAAAAAAAAAAAAAAAAAAxABAAAAAAAAAAAAAAAAAAAAAP/aAAgBAQAAPwBH/9k=";let i=Mr()?new Image:{};return i.onload=()=>{_d=i.naturalWidth===1,i=void 0,t(_d)},void(i.src=e)}return t(_d)}),Vc=t=>t.getContext("2d").getImageData(0,0,t.width,t.height),fn=(t,e,i=[])=>{const n=document.createElement(t),r=Object.getOwnPropertyDescriptors(n.__proto__);for(const o in e)o==="style"?n.style.cssText=e[o]:r[o]&&r[o].set||/textContent|innerHTML/.test(o)||typeof e[o]=="function"?n[o]=e[o]:n.setAttribute(o,e[o]);return i.forEach(o=>n.appendChild(o)),n};const nb={1:()=>[1,0,0,1,0,0],2:t=>[-1,0,0,1,t,0],3:(t,e)=>[-1,0,0,-1,t,e],4:(t,e)=>[1,0,0,-1,0,e],5:()=>[0,1,1,0,0,0],6:(t,e)=>[0,1,-1,0,e,0],7:(t,e)=>[0,-1,-1,0,e,t],8:t=>[0,-1,1,0,0,t]};var Kn=t=>{t.width=1,t.height=1;const e=t.getContext("2d");e&&e.clearRect(0,0,1,1)},Fl=t=>"data"in t,yh=t=>Mr()?RegExp(t).test(window.navigator.userAgent):void 0;let op=null;var Pu=()=>(op===null&&(op=yh(/Android/)),op),Xf=(t,e)=>{const i=fn("canvas",{width:t.width,height:t.height});return i.getContext("2d",e).drawImage(t,0,0),i},Nl=async(t,e=1)=>{const i=await Mu(),[n,r]=i||e<5?[t.width,t.height]:[t.height,t.width],o=fn("canvas",{width:n,height:r}),a=o.getContext("2d",{willReadFrequently:!0});if(Fl(t)&&!i&&e>1){const s=fn("canvas",{width:t.width,height:t.height});s.getContext("2d",{willReadFrequently:!0}).putImageData(t,0,0),t=s}if(!i&&e>1&&a.transform.apply(a,((s,l,c=-1)=>(c===-1&&(c=1),nb[c](s,l)))(t.width,t.height,e)),Fl(t)){if(a.putImageData(t,0,0),Pu())return Xf(o)}else a.drawImage(t,0,0);return t instanceof HTMLCanvasElement&&Kn(t),o},Yf=async(t,e=1)=>e===1||await Mu()?t:Vc(await Nl(t,e)),sl=t=>typeof t=="object";const pm=t=>t instanceof HTMLElement?t:sl(t)?qf(t):t,qf=t=>{let e;return Array.isArray(t)?(e=[],t.forEach((i,n)=>{e[n]=pm(i)})):(e={},t!==null&&Object.keys(t).forEach(i=>{const n=t[i];e[i]=pm(n)})),e};var Ve=t=>typeof t=="string",cn=t=>typeof t=="function",rb=(t,e)=>new Promise((i,n)=>{const r=()=>i(((o,{width:a,height:s,canvasMemoryLimit:l,contextOptions:c})=>{let d=a||o.naturalWidth,u=s||o.naturalHeight;d||u||(d=300,u=150);const p=d*u;if(l&&p>l){const g=Math.sqrt(l)/Math.sqrt(p);d=Math.floor(d*g),u=Math.floor(u*g)}const h=fn("canvas");return h.width=d,h.height=u,h.getContext("2d",c).drawImage(o,0,0,d,u),h})(t,e));t.complete&&t.width?r():(t.onload=r,t.onerror=()=>n(new Error("Failed to load image")))}),Kf=()=>"createImageBitmap"in window,Jf=t=>/svg/.test(t.type),na=()=>Math.random().toString(36).substring(2,9);const ap=new Map;var Nc=(t,e,i)=>new Promise((n,r)=>{const o=t.toString();let a=ap.get(o);if(!a){const l=(p=>`function () {self.onmessage = function (message) {(${p.toString()}).apply(null, message.data.content.concat([function (err, response) {
    response = response || {};
    const transfer = 'data' in response ? [response.data.buffer] : 'width' in response ? [response] : [];
    return self.postMessage({ id: message.data.id, content: response, error: err }, transfer);
}]))}}`)(t),c=URL.createObjectURL((p=>new Blob(["(",typeof p=="function"?p.toString():p,")()"],{type:"application/javascript"}))(l)),d=new Map,u=new Worker(c);a={url:c,worker:u,messages:d,terminationTimeout:void 0,terminate:()=>{clearTimeout(a.terminationTimeout),a.worker.terminate(),URL.revokeObjectURL(c),ap.delete(o)}},u.onmessage=function(p){const{id:h,content:g,error:m}=p.data;if(clearTimeout(a.terminationTimeout),a.terminationTimeout=setTimeout(()=>{d.size>0||a.terminate()},500),!d.has(h))return;const f=d.get(h);d.delete(h),m!=null?f.reject(m):f.resolve(g)},ap.set(o,a)}const s=na();a.messages.set(s,{resolve:n,reject:r}),a.worker.postMessage({id:s,content:e},i)});let sp=null;var wa=()=>(sp===null&&(sp=yh(/Firefox/)),sp);const hm=async(t,e)=>{const i=await(async(r,o)=>{const a=fn("img",{src:URL.createObjectURL(r)}),s=await rb(a,o);return URL.revokeObjectURL(a.src),s})(t,{canvasMemoryLimit:e,contextOptions:{willReadFrequently:!0}}),n=Vc(i);return Kn(i),n};var Qf=async(t,e)=>{if(Pu()&&!wa())return await hm(t,e);let i;if(Kf()&&!Jf(t)&&"OffscreenCanvas"in window)try{i=await Nc((n,r,o)=>{createImageBitmap(n).then(a=>{let s=a.width,l=a.height;const c=s*l;if(r&&c>r){const h=Math.sqrt(r)/Math.sqrt(c);s=Math.floor(s*h),l=Math.floor(l*h)}const d=new OffscreenCanvas(s,l),u=d.getContext("2d",{willReadFrequently:!0});u.drawImage(a,0,0,s,l);const p=u.getImageData(0,0,d.width,d.height);o(null,p)}).catch(a=>{o(a)})},[t,e])}catch{}return i&&i.width?i:await hm(t,e)},xh=(t,e,i)=>new Promise((n,r)=>{try{t.toBlob(o=>{if(!o)return r(new Error("Failed to create blob"));n(o)},e,i)}catch(o){r(o)}}),ob=async(t,e,i)=>{const n=await Nl(t),r=await xh(n,e,i);return Kn(n),r};const ab={matroska:"mkv"};var ty=t=>{const e=(t.match(/\/([a-z0-9]+)/)||[])[1];if(/^x/.test(e)){const[,i=""]=t.split("/x-");return ab[i]}return e},ey=t=>t.substr(0,t.lastIndexOf("."))||t;const sb=/avif|bmp|gif|jpg|jpeg|jpe|jif|jfif|png|svg|tiff|webp/;var bh=t=>{return t&&(e=(i=t,i.split(".").pop()).toLowerCase(),sb.test(e)?"image/"+(/jfif|jif|jpe|jpg/.test(e)?"jpeg":e==="svg"?"svg+xml":e):"");var e,i},Ec=(t,e,i)=>{const n=new Date().getTime(),r=t.type.length&&!/null|text/.test(t.type),o=r?t.type:i,a=((s,l)=>{const c=bh(s);if(c===l)return s;const d=ty(l)||c;return`${ey(s)}.${d}`})(e,o);try{return new(fh("File"))([t],a,{lastModified:n,type:r?t.type:o})}catch{const l=r?t.slice():t.slice(0,t.size,o);return l.lastModified=n,l.name=a,l}},Jo=(t,e)=>t/e,Ji=t=>t;const lp=Math.PI,Oo=Math.PI/2,Qo=Oo/2;var Ea=t=>{const e=Math.abs(t)%Math.PI;return e>Qo&&e<Math.PI-Qo};const jp={Top:"t",Right:"r",Bottom:"b",Left:"l",TopLeft:"tl",TopRight:"tr",BottomRight:"br",BottomLeft:"bl"},{Top:Ts,Right:Ms,Bottom:Ps,Left:Rs,TopLeft:oa,TopRight:aa,BottomRight:sa,BottomLeft:la}=jp;var Ac={[Ts]:[.5,0],[Ms]:[1,.5],[Ps]:[.5,1],[Rs]:[0,.5],[oa]:[0,0],[aa]:[1,0],[sa]:[1,1],[la]:[0,1]},ai=(t,e=12)=>parseFloat(t.toFixed(e));const hu=(t,e,i)=>i+(t-i)*e,mm=t=>({x:t.x+.5*t.width,y:t.y+.5*t.height,rx:.5*t.width,ry:.5*t.height}),ln=()=>ot(0,0),ot=(t,e)=>({x:t,y:e}),$m=t=>ot(t.pageX,t.pageY),Oe=t=>ot(t.x,t.y),El=t=>(t.x=-t.x,t.y=-t.y,t),Lr=(t,e,i=ln())=>{const n=Math.cos(e),r=Math.sin(e),o=t.x-i.x,a=t.y-i.y;return t.x=i.x+n*o-r*a,t.y=i.y+r*o+n*a,t},vs=t=>Math.sqrt(t.x*t.x+t.y*t.y),no=t=>{const e=Math.sqrt(t.x*t.x+t.y*t.y);return e===0?ln():(t.x/=e,t.y/=e,t)},Vd=(t,e)=>Math.atan2(e.y-t.y,e.x-t.x),xs=(t,e)=>t.x===e.x&&t.y===e.y,wo=(t,e)=>(t.x=e(t.x),t.y=e(t.y),t),Fn=(t,e)=>(t.x+=e.x,t.y+=e.y,t),Dn=(t,e)=>(t.x-=e.x,t.y-=e.y,t),gm=(t,e)=>(t.x/=e,t.y/=e,t),Tr=(t,e)=>(t.x*=e,t.y*=e,t),ru=(t,e)=>t.x*e.x+t.y*e.y,ou=(t,e)=>t.x*e.y-t.y*e.x,bo=(t,e=ln())=>{const i=t.x-e.x,n=t.y-e.y;return i*i+n*n},$o=(t,e=ln())=>Math.sqrt(bo(t,e)),lb=(t,e,i)=>(t.x=hu(t.x,e,i.x),t.y=hu(t.y,e,i.y),t),Fo=t=>{let e=0,i=0;return t.forEach(n=>{e+=n.x,i+=n.y}),ot(e/t.length,i/t.length)},Al=(t,e,i,n,r)=>(t.forEach(o=>{o.x=e?n-(o.x-n):o.x,o.y=i?r-(o.y-r):o.y}),t),rl=(t,e,i,n)=>{const r=Math.sin(e),o=Math.cos(e);return t.forEach(a=>{a.x-=i,a.y-=n;const s=a.x*o-a.y*r,l=a.x*r+a.y*o;a.x=i+s,a.y=n+l}),t},Hl=(t,e)=>({width:t,height:e}),io=t=>Hl(t.width,t.height),Fa=t=>Hl(t.width,t.height),ol=t=>Hl(t.width,t.height),iy=t=>Hl(t[0],t[1]),Mc=t=>{return/img/i.test(t.nodeName)?Hl((e=t).naturalWidth,e.naturalHeight):Fa(t);var e},Vn=(t,e)=>Hl(t,e),Lc=(t,e,i=Ji)=>i(t.width)===i(e.width)&&i(t.height)===i(e.height),Nd=(t,e)=>(t.width*=e,t.height*=e,t),Dl=t=>ot(.5*t.width,.5*t.height),ny=(t,e)=>{const i=Math.abs(e),n=Math.abs(Math.cos(i)),r=Math.abs(Math.sin(i)),o=n*t.width+r*t.height,a=r*t.width+n*t.height;return t.width=o,t.height=a,t},mu=(t,e)=>t.width>=e.width&&t.height>=e.height,is=(t,e)=>(t.width=e(t.width),t.height=e(t.height),t),Is=(t,e)=>({start:t,end:e}),ry=t=>Is(Oe(t.start),Oe(t.end)),vh=(t,e)=>{if(e===0)return t;const i=ot(t.start.x-t.end.x,t.start.y-t.end.y),n=no(i),r=Tr(n,e);return t.start.x+=r.x,t.start.y+=r.y,t.end.x-=r.x,t.end.y-=r.y,t},cb=[ot(-1,-1),ot(-1,1),ot(1,1),ot(1,-1)],ca=(t,e,i,n)=>({x:t,y:e,width:i,height:n}),Ci=t=>ca(t.x,t.y,t.width,t.height),ws=()=>ca(0,0,0,0),Fr=t=>ca(0,0,t.width,t.height),db=t=>ca(t[3],t[0],t[1]-t[3],t[2]-t[0]),fs=t=>ca(t.x||0,t.y||0,t.width||0,t.height||0),nr=t=>{let e=t[0].x,i=t[0].x,n=t[0].y,r=t[0].y;return t.forEach(o=>{e=Math.min(e,o.x),i=Math.max(i,o.x),n=Math.min(n,o.y),r=Math.max(r,o.y)}),ca(e,n,i-e,r-n)},cp=t=>In(t.x-t.rx,t.y-t.ry,2*t.rx,2*t.ry),fm=(t,e)=>ca(t.x-.5*e.width,t.y-.5*e.height,e.width,e.height),In=(t,e,i,n)=>ca(t,e,i,n),Ti=t=>ot(t.x+.5*t.width,t.y+.5*t.height),ta=(t,e)=>(t.x+=e.x,t.y+=e.y,t),Cr=(t,e,i)=>(i=i||Ti(t),t.x=e*(t.x-i.x)+i.x,t.y=e*(t.y-i.y)+i.y,t.width=e*t.width,t.height=e*t.height,t),ym=(t,e,i,n)=>{const r=(n.x-t.x)/t.width,o=(n.y-t.y)/t.height;let a=Math.max(e.width,t.width),s=Math.max(e.height,t.height);return a=Math.min(i.width,a),s=Math.min(i.height,s),t.x=n.x-r*a,t.y=n.y-o*s,t.width=a,t.height=s,t},xm=(t,e)=>{const[i,n]=Ac[e],r=i*t.width,o=n*t.height;return ot(t.x+r,t.y+o)},Ss=(t,e)=>(t.x*=e,t.y*=e,t.width*=e,t.height*=e,t),ea=(t,e,i=Ji)=>i(t.x)===i(e.x)&&i(t.y)===i(e.y)&&i(t.width)===i(e.width)&&i(t.height)===i(e.height),rr=t=>Jo(t.width,t.height),oy=(t,e,i,n,r)=>(t.x=e,t.y=i,t.width=n,t.height=r,t),Ru=(t,e)=>(t.x=e.x,t.y=e.y,t.width=e.width,t.height=e.height,t),$r=(t,e,i)=>(i||(i=Ti(t)),Bo(t).map(n=>Lr(n,e,i))),au=(t,e)=>ca(.5*t.width-.5*e.width,.5*t.height-.5*e.height,e.width,e.height),$u=(t,e)=>!(e.x<t.x)&&!(e.y<t.y)&&!(e.x>t.x+t.width)&&!(e.y>t.y+t.height),rs=(t,e,i=ln())=>{if(t.width===0||t.height===0)return ws();const n=rr(t);e||(e=n);let r=t.width,o=t.height;return e>n?r=o*e:o=r/e,ca(i.x+.5*(t.width-r),i.y+.5*(t.height-o),r,o)},Ur=(t,e=rr(t),i=ln())=>{if(t.width===0||t.height===0)return ws();let n=t.width,r=n/e;return r>t.height&&(r=t.height,n=r*e),ca(i.x+.5*(t.width-n),i.y+.5*(t.height-r),n,r)},al=t=>[Math.min(t.y,t.y+t.height),Math.max(t.x,t.x+t.width),Math.max(t.y,t.y+t.height),Math.min(t.x,t.x+t.width)],Bo=t=>[ot(t.x,t.y),ot(t.x+t.width,t.y),ot(t.x+t.width,t.y+t.height),ot(t.x,t.y+t.height)],Do=(t,e)=>{if(t)return t.x=e(t.x),t.y=e(t.y),t.width=e(t.width),t.height=e(t.height),t},ay=(t,e,i=Ti(t))=>Bo(t).map((n,r)=>{const o=cb[r];return ot(hu(n.x,1+o.x*e.x,i.x),hu(n.y,1+o.y*e.y,i.y))}),zc=t=>(t.x=0,t.y=0,t),bm=t=>{const e=t[0],i=t[t.length-1];t=xs(e,i)?t:[...t,e];const n=e.x,r=e.y;let o,a,s,l=0,c=0,d=0,u=0;const p=t.length;for(;c<p;c++)o=t[c],a=t[c+1>p-1?0:c+1],s=(o.y-r)*(a.x-n)-(a.y-r)*(o.x-n),l+=s,d+=(o.x+a.x-2*n)*s,u+=(o.y+a.y-2*r)*s;return s=3*l,ot(n+d/s,r+u/s)},wh=(t,e)=>sy(t.start,t.end,e.start,e.end),sy=(t,e,i,n)=>{const r=(n.y-i.y)*(e.x-t.x)-(n.x-i.x)*(e.y-t.y);if(r===0)return;const o=((n.x-i.x)*(t.y-i.y)-(n.y-i.y)*(t.x-i.x))/r,a=((e.x-t.x)*(t.y-i.y)-(e.y-t.y)*(t.x-i.x))/r;return o<0||o>1||a<0||a>1?void 0:ot(t.x+o*(e.x-t.x),t.y+o*(e.y-t.y))},ly=(t,e,{ignoreIdenticalLines:i=!1,breakOnIntersection:n=!1}={})=>{const r=e.length,o=[];for(let a=0;a<r-1;a++){if(i&&(xs(t.start,e[a])||xs(t.start,e[a+1])||xs(t.end,e[a])||xs(t.end,e[a+1])))continue;const s=sy(t.start,t.end,e[a],e[a+1]);if(s){if(n)return[s];o.push(s)}}return o.length?o:void 0},Up=(t,e)=>{let i=0,n=0,r=!1;const o=e.length;for(i=0,n=o-1;i<o;n=i++)e[i].y>t.y!=e[n].y>t.y&&t.x<(e[n].x-e[i].x)*(t.y-e[i].y)/(e[n].y-e[i].y)+e[i].x&&(r=!r);return r},cy=t=>{const e=[];for(let i=0;i<t.length;i++){let n=i+1;n===t.length&&(n=0),e.push(Is(Oe(t[i]),Oe(t[n])))}return e},dy=(t,e=0)=>cy(t).map(i=>vh(i,e)),gu=(t,e,i,n=0,r=!1,o=!1,a=12)=>{const s=[];for(let l=0;l<a;l++)s.push(ot(t.x+e*Math.cos(l*(2*Math.PI)/a),t.y+i*Math.sin(l*(2*Math.PI)/a)));return(r||o)&&Al(s,r,o,t.x,t.y),n&&rl(s,n,t.x,t.y),s},fu=(t,e,i,n)=>{const r=ot(t.x-i.x,t.y-i.y),o=ot(n.x-i.x,n.y-i.y),a=ru(o,o);let s=ru(r,o)/a;s=s<0?0:s,s=s>1?1:s;const l=ot(o.x*s+i.x-t.x,o.y*s+i.y-t.y);return ru(l,l)<=e*e},uy=(t,e,i)=>{const n=i.length;for(let r=0;r<n-1;r++)if(fu(t,e,i[r],i[r+1]))return!0;return!1},Gp=(t,e,i)=>!!Up(t,i)||!!uy(t,e,i)||fu(t,e,i[0],i[i.length-1]),dp=(t,e,i,n,r)=>Gp(t,e,$r(i,n,r||Ti(i)));var ub=(t,e)=>{const i=Fr(t),n=Ti(i),r=$r(i,e,n);return zc(nr(r))},Bl=(t,e)=>t instanceof HTMLElement&&(!e||new RegExp(`^${e}$`,"i").test(t.nodeName)),Hc=t=>t instanceof File,vm=async(t,e,i)=>{const n=await xh(t,e,i);return Ec(n,"canvas")},Sh=t=>t.split("/").pop().split(/\?|\#/).shift();const pb=Mr()&&Node.prototype.replaceChildren?(t,e)=>t.replaceChildren(e):(t,e)=>{for(;t.lastChild;)t.removeChild(t.lastChild);e!==void 0&&t.append(e)},Hd=Mr()&&fn("div",{class:"PinturaMeasure",style:"position:absolute;left:0;top:0;width:99999px;height:0;pointer-events:none;contain:strict;margin:0;padding:0;"});let wm;var kh=t=>(pb(Hd,t),Hd.parentNode||document.body.append(Hd),clearTimeout(wm),wm=setTimeout(()=>{Hd.remove()},500),t);let up=null;var La=()=>(up===null&&(up=Mr()&&/^((?!chrome|android).)*(safari|iphone|ipad)/i.test(navigator.userAgent)),up),py=t=>new Promise((e,i)=>{let n=!1;!t.parentNode&&La()&&(n=!0,t.style.cssText="position:absolute;visibility:hidden;pointer-events:none;left:0;top:0;width:0;height:0;",kh(t));const r=()=>{const a=t.naturalWidth,s=t.naturalHeight;a&&s&&(n&&t.remove(),clearInterval(o),e({width:a,height:s}))};t.onerror=a=>{clearInterval(o),i(a)};const o=setInterval(r,1);r()}),hy=t=>new Promise((e,i)=>{const n=()=>{e({width:t.videoWidth,height:t.videoHeight})};if(t.readyState>=1)return n();t.onloadedmetadata=n,t.onerror=()=>i(t.error)}),Iu=t=>/^image/.test(t.type),Ch=t=>new Promise(e=>{const i=Ve(t)?t:URL.createObjectURL(t),n=()=>{const o=new Image;o.src=i,e(o)};if(t instanceof Blob&&Iu(t))return n();const r=document.createElement("video");r.preload="metadata",r.onloadedmetadata=()=>e(r),r.onerror=n,r.src=i}),yu=t=>t.nodeName==="VIDEO",my=async t=>{let e,i;e=t.src?t:await Ch(t);try{i=yu(e)?await hy(e):await py(e)}finally{Hc(t)&&URL.revokeObjectURL(e.src)}return i},hb=async t=>{const e=await my(t),i=await(o=>new Promise((a,s)=>{if(o.complete)return a(o);o.onload=()=>a(o),o.onerror=()=>s(new Error("Failed to load image"))}))(t),n=fn("canvas",e);n.getContext("2d",{willReadFrequently:!0}).drawImage(i,0,0);const r=await xh(n);return Ec(r,Sh(i.src))},Pl=(t=0,e=!0)=>new(fh("ProgressEvent"))("progress",{loaded:100*t,total:100,lengthComputable:e}),Sm=(t,e,i=n=>n)=>t.getAllResponseHeaders().indexOf(e)>=0?i(t.getResponseHeader(e)):void 0,mb=t=>{if(!t)return null;const e=t.split(/filename=|filename\*=.+''/).splice(1).map(i=>i.trim().replace(/^["']|[;"']{0,2}$/g,"")).filter(i=>i.length);return e.length?decodeURI(e[e.length-1]):null};const $b="URL_REQUEST";class Pc extends Error{constructor(e,i,n){super(e),this.name="EditorError",this.code=i,this.metadata=n}}var $y=(t,e)=>{const{headers:i={},credentials:n}=e||{};Object.entries(i).forEach(([r,o])=>t.setRequestHeader(r,o)),n&&(t.withCredentials=n!=="omit")},gb=(t,e,i)=>/^data:/.test(t)?(async(n,r="data-uri",o=$e)=>{o(Pl(0));const a=await fetch(n);o(Pl(.33));const s=await a.blob();let l;Iu(s)||(l="image/"+(n.includes(",/9j/")?"jpeg":"png")),o(Pl(.66));const c=Ec(s,r,l);return o(Pl(1)),c})(t,void 0,e):((n,r,o)=>new Promise((a,s)=>{const l=()=>s(new Pc("Error fetching image",$b,c)),c=new XMLHttpRequest;c.onprogress=r,c.onerror=l,c.onload=()=>{if(!c.response||c.status>=300||c.status<200)return l();const u=Sm(c,"Content-Type"),p=Sm(c,"Content-Disposition",mb)||Sh(n);a(Ec(c.response,p,u||bh(p)))};const{willRequest:d}=o;Promise.resolve(d&&d(n,{resourceType:"image"})).then(u=>{if(u===!1)return s("Image load rejected");c.open("GET",n),$y(c,u),c.responseType="blob",c.send()}).catch(console.error)}))(t,e,i),Th=t=>t instanceof Blob&&!(t instanceof File),gy=t=>"close"in t,fb=async(t,e,i)=>{if(Hc(t)||Th(t))return t;if(Ve(t))return await gb(t,e,i);if(Bl(t,"canvas"))return await vm(t);if(Bl(t,"img"))return await hb(t);if(Fl(t)||gy(t))return await vm(await Nl(t));throw new Pc("Invalid image source","invalid-image-source")};let pp=null;var Eu=()=>(pp===null&&(pp=Mr()&&/^mac/i.test(navigator.platform)),pp);let hp=null;var ra=()=>(hp===null&&(hp=Mr()&&(yh(/iPhone|iPad|iPod/)||Eu()&&navigator.maxTouchPoints>=1)),hp),yb=async(t,e=1)=>await Mu()||ra()||e<5?t:Vn(t.height,t.width),fy=t=>/jpeg/.test(t.type),xb=t=>{return typeof(e=t)!="object"||e.constructor!=Object?t:JSON.stringify(t);var e},Mh=(t,e=0,i)=>(e===0||(t.translate(i.x,i.y),t.rotate(e),t.translate(-i.x,-i.y)),t),yy=(t,e,i)=>(t.scale(e,i),t),bb=async(t,e={})=>{const{flipX:i,flipY:n,rotation:r,crop:o}=e,a=Fa(t),s=i||n,l=!!r,c=o&&(o.x||o.y||o.width||o.height),d=c&&ea(o,Fr(a)),u=c&&!d;if(!s&&!l&&!u)return t;let p,h=fn("canvas",{width:t.width,height:t.height});if(h.getContext("2d",{willReadFrequently:!0}).putImageData(t,0,0),s){const g=fn("canvas",{width:h.width,height:h.height}).getContext("2d",{willReadFrequently:!0});yy(g,i?-1:1,n?-1:1),g.drawImage(h,i?-h.width:0,n?-h.height:0),g.restore(),Kn(h),h=g.canvas}if(l){const g=is(ol(nr($r(fs(h),r))),Math.floor),m=fn("canvas",{width:o.width,height:o.height}).getContext("2d",{willReadFrequently:!0});((f,b,w)=>{f.translate(b,w)})(m,-o.x,-o.y),Mh(m,r,Dl(g)),m.drawImage(h,.5*(g.width-h.width),.5*(g.height-h.height)),m.restore(),Kn(h),h=m.canvas}else if(u)return p=h.getContext("2d",{willReadFrequently:!0}).getImageData(o.x,o.y,o.width,o.height),Kn(h),p;return p=h.getContext("2d",{willReadFrequently:!0}).getImageData(0,0,h.width,h.height),Kn(h),p},vb=(t,e)=>{const{imageData:i,width:n,height:r}=t,o=i.width,a=i.height,s=Math.round(n),l=Math.round(r),c=i.data,d=new Uint8ClampedArray(s*l*4),u=o/s,p=a/l,h=Math.ceil(.5*u),g=Math.ceil(.5*p);for(let m=0;m<l;m++)for(let f=0;f<s;f++){const b=4*(f+m*s);let w=0,S=0,C=0,R=0,M=0,D=0,T=0;const F=(m+.5)*p;for(let W=Math.floor(m*p);W<(m+1)*p;W++){const B=Math.abs(F-(W+.5))/g,y=(f+.5)*u,V=B*B;for(let tt=Math.floor(f*u);tt<(f+1)*u;tt++){let k=Math.abs(y-(tt+.5))/h;const N=Math.sqrt(V+k*k);if(N<-1||N>1||(w=2*N*N*N-3*N*N+1,w<=0))continue;k=4*(tt+W*o);const it=c[k+3];T+=w*it,C+=w,it<255&&(w=w*it/250),R+=w*c[k],M+=w*c[k+1],D+=w*c[k+2],S+=w}}d[b]=R/S,d[b+1]=M/S,d[b+2]=D/S,d[b+3]=T/C}e(null,{data:d,width:s,height:l})},Ph=t=>{if(t instanceof ImageData)return t;let e;try{e=new ImageData(t.width,t.height)}catch{e=fn("canvas").getContext("2d").createImageData(t.width,t.height)}return e.data.set(t.data),e},wb=async(t,e={},i)=>{const{width:n,height:r,fit:o,upscale:a}=e;if(!n&&!r)return t;let s=n,l=r;if(n?r||(l=n):s=r,o!=="force"){const c=s/t.width,d=l/t.height;let u=1;if(o==="cover"?u=Math.max(c,d):o==="contain"&&(u=Math.min(c,d)),u>1&&a===!1)return t;s=Math.round(t.width*u),l=Math.round(t.height*u)}return s=Math.max(s,1),l=Math.max(l,1),t.width===s&&t.height===l?t:i?i(t,s,l):(t=await Nc(vb,[{imageData:t,width:s,height:l}],[t.data.buffer]),Ph(t))},Sb=(t,e)=>{const{imageData:i,matrix:n}=t;if(!n)return e(null,i);const r=new Uint8ClampedArray(i.width*i.height*4),o=i.data,a=o.length,s=n[0],l=n[1],c=n[2],d=n[3],u=n[4],p=n[5],h=n[6],g=n[7],m=n[8],f=n[9],b=n[10],w=n[11],S=n[12],C=n[13],R=n[14],M=n[15],D=n[16],T=n[17],F=n[18],W=n[19];let B=0,y=0,V=0,tt=0,k=0,N=0,it=0,ut=0,st=0,mt=0,G=0,gt=0;for(;B<a;B+=4)y=o[B]/255,V=o[B+1]/255,tt=o[B+2]/255,k=o[B+3]/255,N=y*s+V*l+tt*c+k*d+u,it=y*p+V*h+tt*g+k*m+f,ut=y*b+V*w+tt*S+k*C+R,st=y*M+V*D+tt*T+k*F+W,mt=Math.max(0,N*st)+(1-st),G=Math.max(0,it*st)+(1-st),gt=Math.max(0,ut*st)+(1-st),r[B]=255*Math.max(0,Math.min(1,mt)),r[B+1]=255*Math.max(0,Math.min(1,G)),r[B+2]=255*Math.max(0,Math.min(1,gt)),r[B+3]=255*k;e(null,{data:r,width:i.width,height:i.height})},xy=(t,e)=>{const{imageData:i,matrix:n}=t;if(!n)return e(null,i);let r=n.reduce((T,F)=>T+F);r=r<=0?1:r;const o=i.width,a=i.height,s=i.data;let l=0,c=0,d=0;const u=Math.round(Math.sqrt(n.length)),p=Math.floor(u/2);let h=0,g=0,m=0,f=0,b=0,w=0,S=0,C=0,R=0,M=0;const D=new Uint8ClampedArray(o*a*4);for(d=0;d<a;d++)for(c=0;c<o;c++){for(h=0,g=0,m=0,f=0,w=0;w<u;w++)for(b=0;b<u;b++)S=d+w-p,C=c+b-p,S<0&&(S=a-1),S>=a&&(S=0),C<0&&(C=o-1),C>=o&&(C=0),R=4*(S*o+C),M=n[w*u+b],h+=s[R]*M,g+=s[R+1]*M,m+=s[R+2]*M,f+=s[R+3]*M;D[l]=h/r,D[l+1]=g/r,D[l+2]=m/r,D[l+3]=f/r,l+=4}e(null,{data:D,width:o,height:a})},kb=(t,e)=>{let{imageData:i,strength:n}=t;if(!n)return e(null,i);const r=new Uint8ClampedArray(i.width*i.height*4),o=i.width,a=i.height,s=i.data,l=(V,tt)=>(c=V-M,d=tt-D,Math.sqrt(c*c+d*d));let c,d,u,p,h,g,m,f,b,w,S,C=0,R=0,M=.5*o,D=.5*a,T=l(0,0);for(n>0?(u=0,p=0,h=0):(n=Math.abs(n),u=1,p=1,h=1),R=0;R<a;R++)for(C=0;C<o;C++)F=4*(C+R*o),W=s,B=r,y=l(C,R)*n/T,g=W[F]/255,m=W[F+1]/255,f=W[F+2]/255,b=W[F+3]/255,w=1-y,S=w*b+y,B[F]=(w*b*g+y*u)/S*255,B[F+1]=(w*b*m+y*p)/S*255,B[F+2]=(w*b*f+y*h)/S*255,B[F+3]=255*S;var F,W,B,y;e(null,{data:r,width:i.width,height:i.height})},Cb=(t,e)=>{const{imageData:i,level:n,monochrome:r=!1}=t;if(!n)return e(null,i);const o=new Uint8ClampedArray(i.width*i.height*4),a=i.data,s=a.length;let l,c,d,u=0;const p=()=>255*(2*Math.random()-1)*n,h=r?()=>{const g=p();return[g,g,g]}:()=>[p(),p(),p()];for(;u<s;u+=4)[l,c,d]=h(),o[u]=a[u]+l,o[u+1]=a[u+1]+c,o[u+2]=a[u+2]+d,o[u+3]=a[u+3];e(null,{data:o,width:i.width,height:i.height})},Tb=(t,e)=>{const{imageData:i,level:n}=t;if(!n)return e(null,i);const r=new Uint8ClampedArray(i.width*i.height*4),o=i.data,a=o.length;let s,l,c,d=0;for(;d<a;d+=4)s=o[d]/255,l=o[d+1]/255,c=o[d+2]/255,r[d]=255*Math.pow(s,n),r[d+1]=255*Math.pow(l,n),r[d+2]=255*Math.pow(c,n),r[d+3]=o[d+3];e(null,{data:r,width:i.width,height:i.height})},Mb=async(t,e={})=>{const{colorMatrix:i,convolutionMatrix:n,gamma:r,noise:o,vignette:a}=e,s=[];if(n&&s.push([xy,{matrix:n.clarity}]),r>0&&s.push([Tb,{level:1/r}]),i&&!(d=>{const u=d.length;let p;const h=u>=20?6:u>=16?5:3;for(let g=0;g<u;g++)if(p=d[g],p===1&&g%h!=0||p!==0&&p!==1)return!1;return!0})(i)&&s.push([Sb,{matrix:i}]),(o>0||o<0)&&s.push([Cb,{level:o}]),(a>0||a<0)&&s.push([kb,{strength:a}]),!s.length)return t;const l=(d,u)=>`(err, imageData) => {
            (${d[u][0].toString()})(Object.assign({ imageData: imageData }, filterInstructions[${u}]), 
                ${d[u+1]?l(d,u+1):"done"})
        }`,c=`function (options, done) {
        const filterInstructions = options.filterInstructions;
        const imageData = options.imageData;
        (${l(s,0)})(null, imageData)
    }`;return t=await Nc(c,[{imageData:t,filterInstructions:s.map(d=>d[1])}],[t.data.buffer]),Ph(t)},ui=t=>typeof t=="number",xu=t=>Ve(t)&&t.match(/(?:[\u2700-\u27bf]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff]|[\u0023-\u0039]\ufe0f?\u20e3|\u3299|\u3297|\u303d|\u3030|\u24c2|\ud83c[\udd70-\udd71]|\ud83c[\udd7e-\udd7f]|\ud83c\udd8e|\ud83c[\udd91-\udd9a]|\ud83c[\udde6-\uddff]|\ud83c[\ude01-\ude02]|\ud83c\ude1a|\ud83c\ude2f|\ud83c[\ude32-\ude3a]|\ud83c[\ude50-\ude51]|\u203c|\u2049|[\u25aa-\u25ab]|\u25b6|\u25c0|[\u25fb-\u25fe]|\u00a9|\u00ae|\u2122|\u2139|\ud83c\udc04|[\u2600-\u26FF]|\u2b05|\u2b06|\u2b07|\u2b1b|\u2b1c|\u2b50|\u2b55|\u231a|\u231b|\u2328|\u23cf|[\u23e9-\u23f3]|[\u23f8-\u23fa]|\ud83c\udccf|\u2934|\u2935|[\u2190-\u21ff])/g)!==null,Ie=(t,e)=>t.hasOwnProperty(e),En=t=>Array.isArray(t);let km=64,mp=102,Cm=112,Tm=!1;var by=(t,e)=>(!Tm&&Mr()&&(/^win/i.test(navigator.platform)&&(mp=103),(ra()||Eu())&&(km=63.5,mp=110,Cm=123),Tm=!0),`<svg${e?` aria-label="${e}"`:""} width="128" height="128" viewBox="0 0 128 128" preserveAspectRatio="xMinYMin meet" xmlns="http://www.w3.org/2000/svg"><text x="${km}" y="${mp}" alignment-baseline="text-top" dominant-baseline="text-top" text-anchor="middle" font-size="${Cm}px">${t}</text></svg>`),Ol=t=>t instanceof Blob,Ar=(t,e)=>t/e*100+"%",gr=t=>`rgba(${Math.round(255*t[0])}, ${Math.round(255*t[1])}, ${Math.round(255*t[2])}, ${ui(t[3])?t[3]:1})`,su=t=>Object.values(t).join("_");const vy=async(t,e=0)=>{const i=fn("canvas",{width:80,height:80}).getContext("2d");return await((n=0)=>new Promise(r=>{setTimeout(r,n)}))(e),i.drawImage(t,0,0,80,80),!((n=>!new Uint32Array(n.getImageData(0,0,n.canvas.width,n.canvas.height).data.buffer).some(r=>r!==0))(i)&&e<=256)||await vy(t,e+16)},Mm=new Map;var Pb=t=>new Promise((e,i)=>{const n=new FileReader;n.onerror=()=>i(n.error),n.onload=()=>e(n.result),n.readAsDataURL(t)}),ns=()=>{let t=[];return{sub:(e,i)=>(t.push({event:e,callback:i}),()=>t=t.filter(n=>n.event!==e||n.callback!==i)),pub:(e,i)=>{t.filter(n=>n.event===e).forEach(n=>n.callback(i))}}};const Aa=32,Rh=({color:t=[0,0,0],fontSize:e=16,fontFamily:i="sans-serif",fontVariant:n="normal",fontWeight:r="normal",fontStyle:o="normal",textAlign:a="left",letterSpacing:s="normal",lineHeight:l=20},c=1)=>`font-size:${e*c}px;font-style:${o};font-weight:${r};font-family:${i};font-variant:${n};line-height:${l*c}px;text-align:${a};letter-spacing:${ui(s)?s+"px":"normal"};color:${gr(t)};`,Ih=(t,e,i=1)=>{const{width:n,height:r,disableNewline:o}=e,a=!n,s=o===!1?((d="")=>d.split(`
`).length)(t):void 0,l=a?"normal":"break-word",c=a&&!s?"nowrap":"pre-line";return`max-width:none;min-width:auto;width:${a?"auto":n*i+"px"};height:${r?r*i+"px":"auto"};margin-top:0;margin-bottom:0;padding-top:${(({fontSize:d=16,lineHeight:u=20}={})=>.5*Math.max(0,d-u))(e)*i}px;word-break:${l};word-wrap:normal;white-space:${c};`},Pm=new Map,wy=t=>{const e=[];for(const i of Array.from(t.childNodes))i.nodeType===Node.TEXT_NODE?e.push(Rb(i)):e.push(...wy(i));return e},Sy="pointer-events:none;visibility:hidden;position:absolute;left:0;top:0;",Rb=t=>{const e=t.nodeValue;if(!e)return[];const i=e.length,n=document.createRange();n.selectNodeContents(t);const r=[];for(let a=0;a<i;a++){n.setStart(t,0),n.setEnd(t,a+1);const s=n.getClientRects().length-1,l=e.charAt(a);r[s]?r[s]+=l:r.push(l)}const o=n.getClientRects();return r.map((a,s)=>({rect:o[s],text:a}))},Rm=new Map,zo=(t="",e)=>{const{width:i=0,height:n=0}=e;if(i&&n)return Vn(i,n);let{fontSize:r=16,fontFamily:o,lineHeight:a=20,fontWeight:s,fontStyle:l,fontVariant:c,letterSpacing:d}=e;const u=su({text:t,fontFamily:o,fontWeight:s,fontStyle:l,fontVariant:c,fontSize:r,letterSpacing:d,lineHeight:a,width:i});let p=Rm.get(u);if(p)return p;let h=1;r>1e3&&wa()&&(h=r/1e3,r=1e3,a/=h);const g=kh(fn("pre",{contenteditable:"true",spellcheck:"false",style:`${Sy}${Rh({...e,fontSize:r,lineHeight:a})};${Ih(t,e)}"`,innerHTML:t})).getBoundingClientRect();return p=Fa(g),p=is(p,m=>m*h),i&&(p.width=i),Rm.set(u,p),p},Im=new Map,Ib=(t,e)=>new Promise((i,n)=>{let r=Im.get(t);r===void 0&&(r=((o,a)=>{const{sub:s,pub:l}=ns();let c,d;return Promise.resolve(a&&a(o,{resourceType:"stylesheet"})).then(u=>{if(u===!1)return d="requestPrevented",l("error",d);const{headers:p,credentials:h}=u||{};fetch(o,{headers:p,credentials:h}).then(g=>g.text()).then(g=>{c=g,l("load",c)}).catch(g=>{d=g,l("error",d)})}),{sub:(u,p)=>u==="load"&&c?p(c):u==="error"&&d?p(d):void s(u,p)}})(t,e),Im.set(t,r)),r.sub("load",i),r.sub("error",n)}),Em=async(t,e,i)=>{let n;try{n=await Ib(t,e)}catch{return[]}const r={innerHTML:n,id:na()};i&&(r.nonce=i);const o=fn("style",r);document.head.append(o);const a=Array.from(document.styleSheets).find(s=>s.ownerNode.id===o.id);return o.remove(),Array.from(a.cssRules)},kl=new Map,Eb=async(t,e,i)=>{if(kl.has(t.href))return kl.get(t.href);let n;try{n=Array.from(t.cssRules);for(const r of(o=>o.filter(a=>a instanceof CSSImportRule))(n)){const o=r.href;if(kl.has(o)){const s=kl.get(o);n=[...n,...s];continue}const a=await Em(o,e,i);kl.set(o,a),n=[...n,...a]}}catch{const o=t.href;n=await Em(o,e,i),kl.set(o,n)}return(r=>r.filter(o=>o instanceof CSSFontFaceRule))(n)},ky=(t,e)=>t.style.getPropertyValue(e),Ab=(t,e)=>t.style?ky(t,"font-family").replace(/^"|"$/g,"")==e:!1,Lb=async(t,e,i)=>{const n=((r,o)=>{const a=[];for(const s of r)Ab(s,o)&&a.push(s);return a})(await(async(r,o)=>{const a=Array.from(document.styleSheets).map(c=>Eb(c,r,o)),s=await Promise.all(a),l=[];return s.forEach(c=>l.push(...c)),l})(e,i),t);return n.length?n.map(r=>{const o=r.parentStyleSheet.href&&new URL(r.parentStyleSheet.href),a=o?o.origin+(c=>c.pathname.split("/").slice(0,-1).join("/"))(o)+"/":"",s=r.style.getPropertyValue("src").match(/url\("?(.*?)"?\)/)[1],l=Array.from(r.style).filter(c=>c!="src").reduce((c,d)=>c+=d+":"+ky(r,d)+";","");return[/^http/.test(s)?s:a+s,l]}):[]},Am=new Map,Lm=new Map;var Cy=async(t="",e)=>{if(!t.length)return;let{color:i,imageWidth:n=300,imageHeight:r=150,paddingTop:o=0,paddingRight:a=Aa,paddingBottom:s=0,paddingLeft:l=Aa,fontFamily:c,fontSize:d,pixelRatio:u=1,willRequest:p,outline:h,blur:g,styleNonce:m}=e,f=1,b="";d>1e3&&wa()&&(f=d/1e3,b=`transform-origin:0 0;transform:scale(${f})`);const w=u/f,S=(n+l+a)*u,C=(r+s+o)*u,R=await(async(y,V,tt)=>{if(Am.get(y))return;let k=Lm.get(y);if(!k){const it=await Lb(y,V,tt);if(!it.length)return void Am.set(y,!0);const ut=[];for(const[st,mt]of it){const G=await fetch(st).then(lt=>lt.blob()),gt=!(N=G.type)||/woff2/.test(N)?"woff2":/woff/.test(N)?"woff":/ttf|truetype/.test(N)?"truetype":/otf|opentype/.test(N)?"opentype":/svg/.test(N)?"svg":"woff2",vt=await Pb(G);ut.push(`@font-face { src:url(${vt}) format('${gt}');${mt};font-display:block; }`)}k=ut.join(""),Lm.set(y,k)}var N;return k})(c,p,m);let M="";R&&(M=`<style${m?` nonce="${m}"`:""}>${R}</style>`);const D=t.replace(/%/g,"%25").replace(/#/g,"%23").replace(/&nbsp;/g," ").replace(/&(?!#\d{4};|[a-z]+;)/gi,"&amp;").replace(/<br>|\n/g,"<br/>"),T=`top:${o*w}px;right:${a*w}px;bottom:${s*w}px;left:${l*w}px`;let F=i,W="",B="";if(h||g){const y=gr(i);h&&(F=[0,0,0,0],W=`-webkit-text-stroke: ${2*h*w}px ${y}`),g&&(La()?B=`filter:blur(${g*w*.4}px)`:(F=[0,0,0,0],B=`text-shadow: 0 0 ${g*w}px ${y}`))}return((y,{safariCacheKey:V="*"}={})=>new Promise((tt,k)=>{const N=new Image;N.onerror=()=>k(new Error("Failed to load SVG")),N.onload=()=>{if(!La()||!y.includes("@font-face")||Mm.has(V))return tt(N);vy(N).then(()=>{Mm.set(V,!0),tt(N)})},N.src="data:image/svg+xml,"+y}))(`<svg xmlns="http://www.w3.org/2000/svg" width="${S}" height="${C}" viewBox="0 0 ${S} ${C}"><foreignObject x="0" y="0" width="${S}" height="${C}"><div xmlns="http://www.w3.org/1999/xhtml">${M}<pre contenteditable="true" spellcheck="false" style="position:absolute;${T};${Rh({...e,color:F,fontSize:d},w)};${Ih(t,e,w)};${b};${W};${B}">${D}</pre></div></foreignObject></svg>`,{safariCacheKey:c})};const _n=t=>{const e={...t};return qf(e)},zm=(t,e={})=>{const i=rr(t);let n,r;const o=e.width||e.rx,a=e.height||e.ry;if(o&&a)return io(e);if(o||a){n=parseFloat(o||Number.MAX_SAFE_INTEGER),r=parseFloat(a||Number.MAX_SAFE_INTEGER);const s=Math.min(n,r);Ve(o)||Ve(a)?(n=s+"%",r=s*i+"%"):(n=s,r=s)}else n="10%",r=10*i+"%";return{[(e.width?"width":e.rx?"rx":void 0)||"width"]:n,[(e.width?"height":e.rx?"ry":void 0)||"height"]:r}},Fm=(t,e={})=>{return{width:void 0,height:void 0,...e,aspectRatio:1,backgroundImage:(i=by(t),"data:image/svg+xml,"+i.replace("<","%3C").replace(">","%3E"))};var i},Dm=(t,e={})=>({backgroundColor:[0,0,0,0],...qn(e)?{}:{width:void 0,height:void 0,aspectRatio:void 0},...e,backgroundImage:Ve(t)?t:Ol(t)?URL.createObjectURL(t):t}),Bm=(t,e)=>{let i;if(Ve(t)||Ol(t)){const n={...zm(e),backgroundSize:"contain"};i=xu(t)?Fm(t,n):Dm(t,n)}else if(t.src){const n=zm(e,t.shape||t),r={...t.shape,...n};if(t.width&&t.height&&!Ie(r,"aspectRatio")){const o=Jp(n,"width",e),a=Jp(n,"height",e);r.aspectRatio=Jo(o,a)}r.backgroundSize||t.shape||t.width&&t.height||(r.backgroundSize="contain"),i=xu(t.src)?Fm(t.src,r):Dm(t.src,r)}else t.shape&&(i=_n(t.shape));return Ie(i,"backgroundImage")&&(Ie(i,"backgroundColor")||(i.backgroundColor=[0,0,0,0]),Ie(i,"disableStyle")||(i.disableStyle=["cornerRadius","backgroundColor","strokeColor","strokeWidth"])),e?Zn(i,e):i},Qa=t=>ot(t.x1,t.y1),ts=t=>ot(t.x2,t.y2),Yn=t=>Ie(t,"text"),bu=t=>Yn(t)&&!(Au(t)||Ie(t,"width")),lu=t=>Yn(t)&&(Au(t)||Ie(t,"width")),vo=t=>!Yn(t)&&zb(t),qn=t=>Ie(t,"rx"),ir=t=>Ie(t,"x1"),On=t=>Ie(t,"points"),Ja=t=>Yn(t)&&t.isEditing,jd=t=>!Ie(t,"opacity")||t.opacity>0,ys=t=>t.isSelected,$p=t=>t.isEditing,eo=t=>t._isDraft,el=t=>Ie(t,"width")&&Ie(t,"height"),Ty=t=>{const e=Ie(t,"right"),i=Ie(t,"bottom");return e||i},Au=t=>(Ie(t,"x")||Ie(t,"left"))&&Ie(t,"right")||(Ie(t,"y")||Ie(t,"top"))&&Ie(t,"bottom"),zb=t=>el(t)||Au(t),Zp=t=>(t._isDraft=!0,t),Om=t=>(t._isDraft=!1,t),Xp=(t,e)=>t.disableStyle!==!0&&(!En(t.disableStyle)||!e||!t.disableStyle.includes(e)),fa=t=>t.disableSelect!==!0,Wm=t=>t.disableRemove!==!0,Fb=t=>!t.disableFlip&&!eo(t)&&!Ty(t)&&(e=>Ie(e,"backgroundImage")||Ie(e,"text"))(t),Cl=(t,e)=>!!Yn(t)&&t.disableInput!==!0&&(cn(t.disableInput)?t.disableInput(e??t.text):e||!0),qs=(t,e)=>t.disableTextLayout!==!0&&(!En(t.disableTextLayout)||!e||!t.disableTextLayout.includes(e)),gp=t=>My(t)&&t.points.length>3,My=t=>!!On(t)&&t.disableAddPoints!==void 0&&t.disableAddPoints!==!0,Yp=t=>t.disableManipulate!==!0&&!eo(t)&&!Ty(t),vc=t=>Yp(t)&&t.disableMove!==!0,qp=t=>(delete t.left,delete t.right,delete t.top,delete t.bottom,t),_m=t=>(delete t.rotation,t),Vm=t=>(t.strokeWidth=t.strokeWidth||1,t.strokeColor=t.strokeColor||[0,0,0],t),Nm=t=>(t.backgroundColor=t.backgroundColor?t.backgroundColor:t.strokeWidth||t.backgroundImage?void 0:[0,0,0],t),Hm=t=>{let e=t.text;e=e.replace(/&(#[0-9]+|[a-z]+);/gi,(i,n)=>`___${n}___`),e=e.replace(/&/,"&amp;"),t.text=e.replace(/___(#[0-9]+|[a-z]+)___/gi,(i,n)=>`&${n};`)},Db=t=>{if(t.fontSize=t.fontSize||"4%",t.fontFamily=t.fontFamily||"sans-serif",t.fontWeight=t.fontWeight||"normal",t.fontStyle=t.fontStyle||"normal",t.fontVariant=t.fontVariant||"normal",t.lineHeight=t.lineHeight||"120%",t.color=t.color||[0,0,0],t.format=t.format==="html"?"html":"text",t.textShadow){const[e,i,n,r]=t.textShadow;t.textShadowX=e,t.textShadowY=i,t.textShadowBlur=n,t.textShadowColor=r,delete t.textShadow}if(t.textOutline){const[e,i]=t.textOutline;t.textOutlineWidth=e,t.textOutlineColor=i,delete t.textOutline}return t.format==="html"?Hm(t):(e=>{Hm(e);let i=e.text;i=i.replace(/</g,"&gt;"),i=i.replace(/>/g,"&lt;"),e.text=i})(t),bu(t)?Bb(t):Ob(t)},Bb=t=>(t.disableNewline!==!1&&(delete t.textAlign,t.text=t.text.replace(/\n/g," ")),qp(t)),Ob=t=>(t.textAlign=t.textAlign||"left",t),Py=t=>((e=>{Ve(e.id)||(e.id=na()),Ie(e,"rotation")||(e.rotation=0),Ie(e,"opacity")||(e.opacity=1),Ie(e,"disableErase")||(e.disableErase=!0)})(t),Yn(t)?Db(t):vo(t)?(e=>{e.cornerRadius=e.cornerRadius||0,e.strokeWidth=e.strokeWidth||0,e.strokeColor=e.strokeColor||[0,0,0],Nm(e)})(t):On(t)?(e=>{Vm(e),_m(e),Ie(e,"pathClose")||(e.disableResize=!0,Ie(e,"disableMove")||(e.disableMove=!0)),qp(e)})(t):ir(t)?(e=>{Vm(e),e.lineStart=e.lineStart||void 0,e.lineEnd=e.lineEnd||void 0,_m(e),qp(e)})(t):qn(t)&&(e=>{e.strokeWidth=e.strokeWidth||0,e.strokeColor=e.strokeColor||[0,0,0],Nm(e)})(t),t),Wb=t=>Yn(t)?"text":vo(t)?"rectangle":On(t)?"path":ir(t)?"line":qn(t)?"ellipse":void 0,vu=(t,e)=>parseFloat(t)/100*e,_b=new RegExp(/^x|left|right|^width|rx|fontSize|eraseRadius|feather|cornerRadius|strokeWidth|strokeDash/,"i"),Vb=new RegExp(/^y|top|bottom|^height|ry/,"i"),Eh=(t,e,{width:i,height:n})=>{if(Array.isArray(e))return e.map(o=>(sl(o)&&Ry(o,{width:i,height:n}),Ve(o)&&(o=Eh(t,o,{width:i,height:n})),o));if(typeof e!="string"||!e.endsWith("%"))return e;const r=parseFloat(e)/100;return _b.test(t)?ai(i*r,6):Vb.test(t)?ai(n*r,6):e},Nb=Eh,Hb=["lineHeight","textOutlineWidth","textShadowX","textShadowY","textShadowBlur"],Ry=(t,e)=>{Object.entries(t).map(([i,n])=>{t[i]=Eh(i,n,e)}),t.text&&Hb.filter(i=>Ve(t[i])).forEach(i=>{var n,r;t[i]=(n=t[i],r=t.fontSize,Math.round(r*(parseFloat(n)/100)))})},Zn=(t,e)=>(Ry(t,e),Ay(t,e),t),Kp=(t,e)=>{let i;return/^x|width|rx|fontSize|strokeWidth|cornerRadius/.test(t)?i=e.width:/^y|height|ry/.test(t)&&(i=e.height),i},Jp=(t,e,i)=>Array.isArray(t[e])?t[e].map(n=>Object.entries(n).reduce((r,[o,a])=>(r[o]=Ve(a)?vu(a,Kp(o,i)):a,r),{})):Ve(t[e])?vu(t[e],Kp(e,i)):t[e],Ll=(t,e,i)=>e.reduce((n,r)=>{const o=Jp(t,r,i);return n[r]=o,n},{}),ba=(t,e,i)=>(Object.keys(e).forEach(n=>((r,o,a,s)=>{if(!Ve(r[o]))return r[o]=a,r;const l=Kp(o,s);return r[o]=l===void 0?a:Ar(a,l),r})(t,n,e[n],i)),t),Iy=(t,e)=>{const i=t.filter(n=>n.x<0||n.y<0||n.x1<0||n.y1<0).reduce((n,r)=>{const[o,a,s,l]=(c=>{const d=ws(),u=c.strokeWidth||0;if(vo(c))d.x=c.x-.5*u,d.y=c.y-.5*u,d.width=c.width+u,d.height=c.height+u;else if(ir(c)){const{x1:p,y1:h,x2:g,y2:m}=c,f=Math.abs(Math.min(p,g)),b=Math.abs(Math.max(p,g)),w=Math.abs(Math.min(h,m)),S=Math.abs(Math.min(h,m));d.x=f+.5*u,d.y=b+.5*u,d.width=b-f+u,d.height=S-w+u}else qn(c)&&(d.x=c.x-c.rx+.5*u,d.y=c.y-c.ry+.5*u,d.width=2*c.rx+u,d.height=2*c.ry+u);return d&&Ie(c,"rotation")&&$r(d,c.rotation),al(d)})(r);return n.top=Math.min(o,n.top),n.left=Math.min(l,n.left),n.bottom=Math.max(s,n.bottom),n.right=Math.max(a,n.right),n},{top:0,right:0,bottom:0,left:0});return i.right>0&&(i.right-=e.width),i.bottom>0&&(i.bottom-=e.height),i},Ey=(t,e,i)=>{const n=_n(t);Zn(n,e);const r=i(n);return Array.isArray(r)?r:[r]},Ay=(t,e)=>{if(Ie(t,"left")&&(t.x=t.left),Ie(t,"right")&&!Ve(t.right)){const i=e.width-t.right;Ie(t,"left")?(t.x=t.left,t.width=Math.max(0,i-t.left)):Ie(t,"width")&&(t.x=i-t.width)}if(Ie(t,"top")&&(t.y=t.top),Ie(t,"bottom")&&!Ve(t.bottom)){const i=e.height-t.bottom;Ie(t,"top")?(t.y=t.top,t.height=Math.max(0,i-t.top)):Ie(t,"height")&&(t.y=i-t.height)}return t},Ly=(t,e)=>(On(t)&&t.points.filter(i=>ui(i.x)).forEach(i=>{i.x*=e,i.y*=e}),ir(t)&&ui(t.x1)&&(t.x1*=e,t.y1*=e,t.x2*=e,t.y2*=e),ui(t.x)&&ui(t.y)&&(t.x*=e,t.y*=e),ui(t.width)&&ui(t.height)&&(t.width*=e,t.height*=e),ui(t.rx)&&ui(t.ry)&&(t.rx*=e,t.ry*=e),(i=>ui(i.strokeWidth)&&i.strokeWidth>0)(t)&&(t.strokeWidth*=e),Yn(t)&&(t._scale=e,ui(t.fontSize)&&(t.fontSize*=e),ui(t.lineHeight)&&(t.lineHeight*=e),ui(t.width)&&!ui(t.height)&&(t.width*=e)),Ie(t,"cornerRadius")&&ui(t.cornerRadius)&&(t.cornerRadius*=e),t),zy=t=>{if(vo(t))return ot(t.x+.5*t.width,t.y+.5*t.height);if(qn(t))return ot(t.x,t.y);if(t.text){if(lu(t)){const i=t.height||zo(t.text,t).height;return ot(t.x+.5*t.width,t.y+.5*i)}const e=zo(t.text,t);return ot(t.x+.5*e.width,t.y+.5*e.height)}return On(t)?Fo(t.points):ir(t)?Fo([Qa(t),ts(t)]):void 0};var jc=t=>/canvas/i.test(t.nodeName),jb=(t,e)=>new Promise((i,n)=>{let r=t,o=!1;const a=()=>{o||(o=!0,cn(e)&&Promise.resolve().then(()=>e(Vn(r.naturalWidth,r.naturalHeight))))};if(r.src||(r=new Image,Ve(t)&&new URL(t,location.href).origin!==location.origin&&(r.crossOrigin="anonymous"),r.src=Ve(t)?t:URL.createObjectURL(t)),r.complete)return a(),i(r);cn(e)&&py(r).then(a).catch(n),r.onload=()=>{a(),i(r)},r.onerror=()=>n(new Error("Failed to load image"))});const jm=new Map([]),Ah=(t,e={})=>new Promise((i,n)=>{const{onMetadata:r=$e,onLoad:o=i,onError:a=n,onComplete:s=$e}=e;let l=jm.get(t);if(l||(l={loading:!1,complete:!1,error:!1,image:void 0,size:void 0,bus:ns()},jm.set(t,l)),l.bus.sub("meta",r),l.bus.sub("load",o),l.bus.sub("error",a),l.bus.sub("complete",s),jc(t)){const c=t,d=c.cloneNode();l.complete=!0,l.image=d,l.size=Mc(c)}if(l.complete)return l.bus.pub("meta",{size:l.size}),l.error?l.bus.pub("error",l.error):l.bus.pub("load",l.image),l.bus.pub("complete"),void(l.bus=ns());l.loading||(l.loading=!0,jb(t,c=>{l.size=c,l.bus.pub("meta",{size:c})}).then(c=>{l.image=c,l.bus.pub("load",c)}).catch(c=>{l.error=c,l.bus.pub("error",c)}).finally(()=>{l.complete=!0,l.loading=!1,l.bus.pub("complete"),l.bus=ns()}))}),Ub=(t,e,i,n)=>t.drawImage(e,i.x,i.x,i.width,i.height,n.x,n.y,n.width,n.height);var Fy=async(t,e,i,n,r=Ub,o)=>{t.save(),t.clip(),await r(t,e,i,n,o),t.restore()};const wu=(t,e,i,n,r)=>{const o=Ci(t);if(n){const s=Do(nr(n),ai);return s.x*=i.width,s.width*=i.width,s.y*=i.height,s.height*=i.height,{srcRect:s,destRect:o}}const a=In(0,0,i.width,i.height);if(e==="contain"){const s=Ur(t,rr(a));o.width=s.width,o.height=s.height,r?(o.x+=r.x,o.y+=r.y):(o.x+=s.x,o.y+=s.y)}else if(e==="cover"){const s=rs(o,a.width/a.height);o.width=s.width,o.height=s.height,r?(o.x+=r.x,o.y+=r.y):(o.x+=s.x,o.y+=s.y)}else e?(o.width=e.width,o.height=e.height,r&&(o.x+=r.x,o.y+=r.y)):r&&(o.width=i.width,o.height=i.height,o.x+=r.x,o.y+=r.y);return{srcRect:a,destRect:o}},fp=(t,e)=>(e.cornerRadius>0?((i,n,r,o,a,s)=>{o<2*s&&(s=o/2),a<2*s&&(s=a/2),i.beginPath(),i.moveTo(n+s,r),i.arcTo(n+o,r,n+o,r+a,s),i.arcTo(n+o,r+a,n,r+a,s),i.arcTo(n,r+a,n,r,s),i.arcTo(n,r,n+o,r,s),i.closePath()})(t,e.x,e.y,e.width,e.height,e.cornerRadius):t.rect(e.x,e.y,e.width,e.height),t),Um=(t,e)=>(e.backgroundColor&&t.fill(),t),Gm=(t,e)=>(e.strokeWidth&&t.stroke(),t);var Lh=async(t,e,i={})=>{const{drawImage:n}=i;if(t.lineWidth=e.strokeWidth?e.strokeWidth:1,t.strokeStyle=e.strokeColor?gr(e.strokeColor):"none",t.fillStyle=e.backgroundColor?gr(e.backgroundColor):"none",t.globalAlpha=e.opacity,e.backgroundImage){let r;if(r=jc(e.backgroundImage)?e.backgroundImage:await Ah(e.backgroundImage),fp(t,e),Um(t,e),e.backgroundRepeat==="repeat"){const o=e.backgroundPosition||{x:0,y:0},{srcRect:a,destRect:s}=wu(e,e.backgroundSize||Mc(r),Mc(r),e.backgroundCorners,{x:0,y:0}),l=document.createElement("canvas");l.width=s.width,l.height=s.height;const c=l.getContext("2d",{willReadFrequently:!1,desynchronized:!0});await n(c,r,a,{...s,x:0,y:0});const d=t.createPattern(l,"repeat");t.fillStyle=d,t.save(),t.beginPath(),t.rect(e.x+o.x,e.y+o.y,e.width-o.x,e.height-o.y),t.clip(),t.translate(s.x+o.x,s.y+o.y),t.fill(),Kn(l),t.restore()}else{const{srcRect:o,destRect:a}=wu(e,e.backgroundSize,Mc(r),e.backgroundCorners,e.backgroundPosition);await Fy(t,r,o,a,n,{feather:e.feather})}return t.beginPath(),fp(t,e),Gm(t,e),[]}return fp(t,e),Um(t,e),Gm(t,e),[]},zh=async(t,e,i={})=>new Promise(async(n,r)=>{const{drawImage:o}=i;if(t.lineWidth=e.strokeWidth||1,t.strokeStyle=e.strokeColor?gr(e.strokeColor):"none",t.fillStyle=e.backgroundColor?gr(e.backgroundColor):"none",t.globalAlpha=e.opacity,t.ellipse(e.x,e.y,e.rx,e.ry,0,0,2*Math.PI),e.backgroundColor&&t.fill(),e.backgroundImage){let a;try{a=await Ah(e.backgroundImage)}catch(d){r(d)}const s=In(e.x-e.rx,e.y-e.ry,2*e.rx,2*e.ry),{srcRect:l,destRect:c}=wu(s,e.backgroundSize,Mc(a),e.backgroundCorners,e.backgroundPosition);await Fy(t,a,l,c,o),e.strokeWidth&&t.stroke(),n([])}else e.strokeWidth&&t.stroke(),n([])}),Gb=async(t,e,i)=>{const n=e.width&&e.height?Fa(e):zo(e.text,e),r={x:e.x,y:e.y,width:n.width,height:n.height};if(Lh(t,{...e,...r,options:i}),!e.text.length)return[];const{textOutlineWidth:o=0,textShadowX:a=0,textShadowY:s=0,textShadowBlur:l=0,textShadowColor:c,outline:d,blur:u,...p}=e,h=!!e.height;if(h&&(t.rect(r.x-o+Math.min(a,0),r.y-o+Math.min(s,0),r.width+o+o+Math.abs(a)+l,r.height+o+Math.abs(s)+l),t.save(),t.clip()),a||s||l){t.save(),t.translate(a,s);const g={...r};h||(g.height+=Aa+l),await yp(t,g,e,{...i,paddingLeft:Aa+l,paddingRight:Aa+l,paddingTop:l,paddingBottom:l+h?-1*s:e.fontSize,shapeExtendedProps:{color:c,blur:l}}),t.restore()}if(o){const g={...r};h||(g.height+=Aa+o),await yp(t,g,e,{...i,paddingLeft:Aa+o,paddingRight:Aa+o,paddingTop:o,paddingBottom:o+h?0:e.fontSize,shapeExtendedProps:{color:e.textOutlineColor,outline:o}})}return h&&t.restore(),await yp(t,r,p,{...i,paddingLeft:Aa,paddingRight:Aa,paddingTop:0,paddingBottom:h?0:e.fontSize}),[]};const yp=async(t,e,i,n)=>{const{willRequest:r,shapeExtendedProps:o,paddingLeft:a,paddingRight:s,paddingTop:l,paddingBottom:c,styleNonce:d}=n,u=await Cy(i.text,{...i,...o,...e,paddingLeft:a,paddingRight:s,paddingTop:l,paddingBottom:c,imageWidth:e.width,imageHeight:e.height,willRequest:r,styleNonce:d});t.drawImage(u,i.x-a,i.y-l,u.width,u.height)};var Zb=async(t,e)=>new Promise(async i=>{t.lineWidth=e.strokeWidth||1,t.strokeStyle=e.strokeColor?gr(e.strokeColor):"none",t.globalAlpha=e.opacity;let n=Qa(e),r=ts(e);t.moveTo(n.x,n.y),t.lineTo(r.x,r.y),e.strokeWidth&&t.stroke(),i([])}),Qp=async(t,e)=>new Promise((i,n)=>{if(e.bitmap&&e.points.length===1)return void zh(t,{x:e.points[0].x,y:e.points[0].y,rx:.5*e.strokeWidth,ry:.5*e.strokeWidth,backgroundColor:e.strokeColor}).then(()=>i([]));t.lineWidth=e.strokeWidth||1,t.strokeStyle=e.strokeColor?gr(e.strokeColor):"none",t.fillStyle=e.backgroundColor?gr(e.backgroundColor):"none",t.globalAlpha=e.opacity;const{points:r}=e;t.lineCap=e.strokeCap,t.lineJoin=e.strokeJoin,t.setLineDash(e.strokeDash||[]),e.pathClose&&t.beginPath(),t.moveTo(r[0].x,r[0].y);const o=r.length;for(let a=1;a<o;a++)t.lineTo(r[a].x,r[a].y);e.pathClose&&t.closePath(),e.strokeWidth&&t.stroke(),e.backgroundColor&&t.fill(),i([])}),Dy=(t,e,i,n)=>((e||i)&&(t.translate(n.x,n.y),t.scale(e?-1:1,i?-1:1),t.translate(-n.x,-n.y)),t);const Xb=async(t,e,i)=>{t.globalCompositeOperation=e.drawMode==="subtract"?"destination-out":"source-over";const n=zy(e);let r;if(Mh(t,e.rotation,n),Dy(t,e.flipX,e.flipY,n),vo(e)?r=Lh:qn(e)?r=zh:ir(e)?r=Zb:On(e)?r=Qp:Yn(e)&&(r=Gb),r){const o=await r(t,e,i);return o.length?[e,...await By(t,o,i)]:[]}return[]};var By=async(t,e,i)=>{let n=[];for(const r of e)t.save(),t.beginPath(),n=[...n,...await Xb(t,r,i)],t.restore();return n},Fh=async(t,e={})=>{const{shapes:i=[],contextBounds:n=t,transform:r=$e,drawImage:o,willRequest:a,styleNonce:s,canvasMemoryLimit:l,computeShape:c=Ji,preprocessShape:d=Ji}=e;if(!i.length)return t;const u=fn("canvas");u.width=n.width,u.height=n.height;const p=u.getContext("2d",{willReadFrequently:!0});p.putImageData(t,n.x||0,n.y||0);const h=i.map(_n).map(c).map(d).flat();r(p),await By(p,h,{drawImage:o,canvasMemoryLimit:l,willRequest:a,styleNonce:s});const g=p.getImageData(0,0,u.width,u.height);return Kn(u),g},Yb=async(t,e={})=>{const{backgroundColor:i,backgroundImage:n}=e,r=!(!i||i&&i[3]===0);if(!n&&!r)return t;const o=fn("canvas");o.width=t.width,o.height=t.height;const a=o.getContext("2d",{willReadFrequently:!0});if(a.putImageData(t,0,0),a.globalCompositeOperation="destination-over",r&&(a.fillStyle=gr(i),a.fillRect(0,0,o.width,o.height)),n){let l;l=jc(n)?n:await Ah(n);const{srcRect:c,destRect:d}=wu({x:0,y:0,width:t.width,height:t.height},"cover",{width:l.width,height:l.height});a.drawImage(l,c.x,c.y,c.width,c.height,d.x,d.y,d.width,d.height)}const s=a.getImageData(0,0,o.width,o.height);return Kn(o),s},Dh=t=>t.length?t.reduce((e,i)=>((n,r)=>{const o=new Array(20);return o[0]=n[0]*r[0]+n[1]*r[5]+n[2]*r[10]+n[3]*r[15],o[1]=n[0]*r[1]+n[1]*r[6]+n[2]*r[11]+n[3]*r[16],o[2]=n[0]*r[2]+n[1]*r[7]+n[2]*r[12]+n[3]*r[17],o[3]=n[0]*r[3]+n[1]*r[8]+n[2]*r[13]+n[3]*r[18],o[4]=n[0]*r[4]+n[1]*r[9]+n[2]*r[14]+n[3]*r[19]+n[4],o[5]=n[5]*r[0]+n[6]*r[5]+n[7]*r[10]+n[8]*r[15],o[6]=n[5]*r[1]+n[6]*r[6]+n[7]*r[11]+n[8]*r[16],o[7]=n[5]*r[2]+n[6]*r[7]+n[7]*r[12]+n[8]*r[17],o[8]=n[5]*r[3]+n[6]*r[8]+n[7]*r[13]+n[8]*r[18],o[9]=n[5]*r[4]+n[6]*r[9]+n[7]*r[14]+n[8]*r[19]+n[9],o[10]=n[10]*r[0]+n[11]*r[5]+n[12]*r[10]+n[13]*r[15],o[11]=n[10]*r[1]+n[11]*r[6]+n[12]*r[11]+n[13]*r[16],o[12]=n[10]*r[2]+n[11]*r[7]+n[12]*r[12]+n[13]*r[17],o[13]=n[10]*r[3]+n[11]*r[8]+n[12]*r[13]+n[13]*r[18],o[14]=n[10]*r[4]+n[11]*r[9]+n[12]*r[14]+n[13]*r[19]+n[14],o[15]=n[15]*r[0]+n[16]*r[5]+n[17]*r[10]+n[18]*r[15],o[16]=n[15]*r[1]+n[16]*r[6]+n[17]*r[11]+n[18]*r[16],o[17]=n[15]*r[2]+n[16]*r[7]+n[17]*r[12]+n[18]*r[17],o[18]=n[15]*r[3]+n[16]*r[8]+n[17]*r[13]+n[18]*r[18],o[19]=n[15]*r[4]+n[16]*r[9]+n[17]*r[14]+n[18]*r[19]+n[19],o})([...e],i),t.shift()):[],Oy=(t,e)=>{const i=t.width*t.height,n=e.reduce((o,a)=>(a.width>o.width&&a.height>o.height&&(o.width=a.width,o.height=a.height),o),{width:0,height:0}),r=n.width*n.height;return((o,a=2)=>Math.round(o*a)/a)(Math.max(.5,.5+(1-r/i)/2),5)};function ii(){}const Wy=t=>t;function Tn(t,e){for(const i in e)t[i]=e[i];return t}function _y(t){return t()}function Zm(){return Object.create(null)}function Ui(t){t.forEach(_y)}function Zi(t){return typeof t=="function"}function ri(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function zr(t,...e){if(t==null)return ii;const i=t.subscribe(...e);return i.unsubscribe?()=>i.unsubscribe():i}function va(t){let e;return zr(t,i=>e=i)(),e}function E(t,e,i){t.$$.on_destroy.push(zr(e,i))}function ar(t,e,i,n){if(t){const r=Vy(t,e,i,n);return t[0](r)}}function Vy(t,e,i,n){return t[1]&&n?Tn(i.ctx.slice(),t[1](n(e))):i.ctx}function sr(t,e,i,n){if(t[2]&&n){const r=t[2](n(i));if(e.dirty===void 0)return r;if(typeof r=="object"){const o=[],a=Math.max(e.dirty.length,r.length);for(let s=0;s<a;s+=1)o[s]=e.dirty[s]|r[s];return o}return e.dirty|r}return e.dirty}function lr(t,e,i,n,r,o){if(r){const a=Vy(e,i,n,o);t.p(a,r)}}function cr(t){if(t.ctx.length>32){const e=[],i=t.ctx.length/32;for(let n=0;n<i;n++)e[n]=-1;return e}return-1}function Fc(t){const e={};for(const i in t)i[0]!=="$"&&(e[i]=t[i]);return e}function Xm(t,e){const i={};e=new Set(e);for(const n in t)e.has(n)||n[0]==="$"||(i[n]=t[n]);return i}function wt(t,e,i){return t.set(i),e}function Xi(t){return t&&Zi(t.destroy)?t.destroy:ii}const Ny=typeof window<"u";let Hy=Ny?()=>window.performance.now():()=>Date.now(),Bh=Ny?t=>requestAnimationFrame(t):ii;const zl=new Set;function jy(t){zl.forEach(e=>{e.c(t)||(zl.delete(e),e.f())}),zl.size!==0&&Bh(jy)}function Oh(t){let e;return zl.size===0&&Bh(jy),{promise:new Promise(i=>{zl.add(e={c:t,f:i})}),abort(){zl.delete(e)}}}function kt(t,e){t.appendChild(e)}function Uy(t){if(!t)return document;const e=t.getRootNode?t.getRootNode():t.ownerDocument;return e&&e.host?e:t.ownerDocument}function qb(t){const e=ht("style");return function(i,n){kt(i.head||i,n),n.sheet}(Uy(t),e),e.sheet}function et(t,e,i){t.insertBefore(e,i||null)}function Q(t){t.parentNode.removeChild(t)}function ht(t){return document.createElement(t)}function fr(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function $n(t){return document.createTextNode(t)}function me(){return $n(" ")}function Mn(){return $n("")}function Pt(t,e,i,n){return t.addEventListener(e,i,n),()=>t.removeEventListener(e,i,n)}function Kb(t){return function(e){return e.preventDefault(),t.call(this,e)}}function Jb(t){return function(e){return e.stopPropagation(),t.call(this,e)}}function v(t,e,i){i==null?t.removeAttribute(e):t.getAttribute(e)!==i&&t.setAttribute(e,i)}function Ym(t,e){const i=Object.getOwnPropertyDescriptors(t.__proto__);for(const n in e)e[n]==null?t.removeAttribute(n):n==="style"?t.style.cssText=e[n]:n==="__value"?t.value=t[n]=e[n]:i[n]&&i[n].set?t[n]=e[n]:v(t,n,e[n])}function qm(t,e){Object.keys(e).forEach(i=>{(function(n,r,o){r in n?n[r]=typeof n[r]=="boolean"&&o===""||o:v(n,r,o)})(t,i,e[i])})}function An(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function Km(t,e){t.value=e??""}function Gy(t,e,{bubbles:i=!1,cancelable:n=!1}={}){const r=document.createEvent("CustomEvent");return r.initCustomEvent(t,i,n,e),r}class Lu{constructor(e=!1){this.is_svg=!1,this.is_svg=e,this.e=this.n=null}c(e){this.h(e)}m(e,i,n=null){this.e||(this.is_svg?this.e=fr(i.nodeName):this.e=ht(i.nodeName),this.t=i,this.c(e)),this.i(n)}h(e){this.e.innerHTML=e,this.n=Array.from(this.e.childNodes)}i(e){for(let i=0;i<this.n.length;i+=1)et(this.t,this.n[i],e)}p(e){this.d(),this.h(e),this.i(this.a)}d(){this.n.forEach(Q)}}function Su(t,e){return new t(e)}const ku=new Map;let Dc,cu=0;function Jm(t,e,i,n,r,o,a,s=0){const l=16.666/n;let c=`{
`;for(let f=0;f<=1;f+=l){const b=e+(i-e)*o(f);c+=100*f+`%{${a(b,1-b)}}
`}const d=c+`100% {${a(i,1-i)}}
}`,u=`__svelte_${function(f){let b=5381,w=f.length;for(;w--;)b=(b<<5)-b^f.charCodeAt(w);return b>>>0}(d)}_${s}`,p=Uy(t),{stylesheet:h,rules:g}=ku.get(p)||function(f,b){const w={stylesheet:qb(b),rules:{}};return ku.set(f,w),w}(p,t);g[u]||(g[u]=!0,h.insertRule(`@keyframes ${u} ${d}`,h.cssRules.length));const m=t.style.animation||"";return t.style.animation=`${m?m+", ":""}${u} ${n}ms linear ${r}ms 1 both`,cu+=1,u}function Qb(t,e){const i=(t.style.animation||"").split(", "),n=i.filter(e?o=>o.indexOf(e)<0:o=>o.indexOf("__svelte")===-1),r=i.length-n.length;r&&(t.style.animation=n.join(", "),cu-=r,cu||Bh(()=>{cu||(ku.forEach(o=>{const{ownerNode:a}=o.stylesheet;a&&Q(a)}),ku.clear())}))}function Rc(t){Dc=t}function ll(){if(!Dc)throw new Error("Function called outside component initialization");return Dc}function Es(t){ll().$$.on_mount.push(t)}function tv(t){ll().$$.after_update.push(t)}function Wo(t){ll().$$.on_destroy.push(t)}function Sa(){const t=ll();return(e,i,{cancelable:n=!1}={})=>{const r=t.$$.callbacks[e];if(r){const o=Gy(e,i,{cancelable:n});return r.slice().forEach(a=>{a.call(t,o)}),!o.defaultPrevented}return!0}}function mo(t,e){return ll().$$.context.set(t,e),e}function un(t){return ll().$$.context.get(t)}function Dr(t,e){const i=t.$$.callbacks[e.type];i&&i.slice().forEach(n=>n.call(this,e))}const wc=[],Fi=[],du=[],th=[],Zy=Promise.resolve();let eh=!1;function Xy(){eh||(eh=!0,Zy.then(I))}function Yy(){return Xy(),Zy}function Wl(t){du.push(t)}function So(t){th.push(t)}const xp=new Set;let hc,Ud=0;function I(){const t=Dc;do{for(;Ud<wc.length;){const e=wc[Ud];Ud++,Rc(e),ev(e.$$)}for(Rc(null),wc.length=0,Ud=0;Fi.length;)Fi.pop()();for(let e=0;e<du.length;e+=1){const i=du[e];xp.has(i)||(xp.add(i),i())}du.length=0}while(wc.length);for(;th.length;)th.pop()();eh=!1,xp.clear(),Rc(t)}function ev(t){if(t.fragment!==null){t.update(),Ui(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(Wl)}}function bp(t,e,i){t.dispatchEvent(Gy(`${e?"intro":"outro"}${i}`))}const uu=new Set;let es;function Pe(){es={r:0,c:[],p:es}}function Re(){es.r||Ui(es.c),es=es.p}function P(t,e){t&&t.i&&(uu.delete(t),t.i(e))}function z(t,e,i,n){if(t&&t.o){if(uu.has(t))return;uu.add(t),es.c.push(()=>{uu.delete(t),n&&(i&&t.d(1),n())}),t.o(e)}else n&&n()}const iv={duration:0};function Qm(t,e,i,n){let r=e(t,i),o=n?0:1,a=null,s=null,l=null;function c(){l&&Qb(t,l)}function d(p,h){const g=p.b-o;return h*=Math.abs(g),{a:o,b:p.b,d:g,duration:h,start:p.start,end:p.start+h,group:p.group}}function u(p){const{delay:h=0,duration:g=300,easing:m=Wy,tick:f=ii,css:b}=r||iv,w={start:Hy()+h,b:p};p||(w.group=es,es.r+=1),a||s?s=w:(b&&(c(),l=Jm(t,o,p,g,h,m,b)),p&&f(0,1),a=d(w,g),Wl(()=>bp(t,p,"start")),Oh(S=>{if(s&&S>s.start&&(a=d(s,g),s=null,bp(t,a.b,"start"),b&&(c(),l=Jm(t,o,a.b,a.duration,0,m,r.css))),a){if(S>=a.end)f(o=a.b,1-o),bp(t,a.b,"end"),s||(a.b?c():--a.group.r||Ui(a.group.c)),a=null;else if(S>=a.start){const C=S-a.start;o=a.a+a.d*m(C/a.duration),f(o,1-o)}}return!(!a&&!s)}))}return{run(p){Zi(r)?(hc||(hc=Promise.resolve(),hc.then(()=>{hc=null})),hc).then(()=>{r=r(),u(p)}):u(p)},end(){c(),a=s=null}}}const qy=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function Ky(t,e){t.d(1),e.delete(t.key)}function As(t,e){z(t,1,1,()=>{e.delete(t.key)})}function Da(t,e,i,n,r,o,a,s,l,c,d,u){let p=t.length,h=o.length,g=p;const m={};for(;g--;)m[t[g].key]=g;const f=[],b=new Map,w=new Map;for(g=h;g--;){const M=u(r,o,g),D=i(M);let T=a.get(D);T?T.p(M,e):(T=c(D,M),T.c()),b.set(D,f[g]=T),D in m&&w.set(D,Math.abs(g-m[D]))}const S=new Set,C=new Set;function R(M){P(M,1),M.m(s,d),a.set(M.key,M),d=M.first,h--}for(;p&&h;){const M=f[h-1],D=t[p-1],T=M.key,F=D.key;M===D?(d=M.first,p--,h--):b.has(F)?!a.has(T)||S.has(T)?R(M):C.has(F)?p--:w.get(T)>w.get(F)?(C.add(T),R(M)):(S.add(F),p--):(l(D,a),p--)}for(;p--;){const M=t[p];b.has(M.key)||l(M,a)}for(;h;)R(f[h-1]);return f}function yr(t,e){const i={},n={},r={$$scope:1};let o=t.length;for(;o--;){const a=t[o],s=e[o];if(s){for(const l in a)l in s||(n[l]=1);for(const l in s)r[l]||(i[l]=s[l],r[l]=1);t[o]=s}else for(const l in a)r[l]=1}for(const a in n)a in i||(i[a]=void 0);return i}function Pr(t){return typeof t=="object"&&t!==null?t:{}}function go(t,e,i){const n=t.$$.props[e];n!==void 0&&(t.$$.bound[n]=i,i(t.$$.ctx[n]))}function Et(t){t&&t.c()}function Rt(t,e,i,n){const{fragment:r,after_update:o}=t.$$;r&&r.m(e,i),n||Wl(()=>{const a=t.$$.on_mount.map(_y).filter(Zi);t.$$.on_destroy?t.$$.on_destroy.push(...a):Ui(a),t.$$.on_mount=[]}),o.forEach(Wl)}function It(t,e){const i=t.$$;i.fragment!==null&&(Ui(i.on_destroy),i.fragment&&i.fragment.d(e),i.on_destroy=i.fragment=null,i.ctx=[])}function si(t,e,i,n,r,o,a,s=[-1]){const l=Dc;Rc(t);const c=t.$$={fragment:null,ctx:[],props:o,update:ii,not_equal:r,bound:Zm(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(l?l.$$.context:[])),callbacks:Zm(),dirty:s,skip_bound:!1,root:e.target||l.$$.root};a&&a(c.root);let d=!1;if(c.ctx=i?i(t,e.props||{},(u,p,...h)=>{const g=h.length?h[0]:p;return c.ctx&&r(c.ctx[u],c.ctx[u]=g)&&(!c.skip_bound&&c.bound[u]&&c.bound[u](g),d&&function(m,f){m.$$.dirty[0]===-1&&(wc.push(m),Xy(),m.$$.dirty.fill(0)),m.$$.dirty[f/31|0]|=1<<f%31}(t,u)),p}):[],c.update(),d=!0,Ui(c.before_update),c.fragment=!!n&&n(c.ctx),e.target){if(e.hydrate){const u=function(p){return Array.from(p.childNodes)}(e.target);c.fragment&&c.fragment.l(u),u.forEach(Q)}else c.fragment&&c.fragment.c();e.intro&&P(t.$$.fragment),Rt(t,e.target,e.anchor,e.customElement),I()}Rc(l)}class li{$destroy(){It(this,1),this.$destroy=ii}$on(e,i){if(!Zi(i))return ii;const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(i),()=>{const r=n.indexOf(i);r!==-1&&n.splice(r,1)}}$set(e){var i;this.$$set&&(i=e,Object.keys(i).length!==0)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const Tl=[];function Rl(t,e){return{subscribe:he(t,e).subscribe}}function he(t,e=ii){let i;const n=new Set;function r(o){if(ri(t,o)&&(t=o,i)){const a=!Tl.length;for(const s of n)s[1](),Tl.push(s,t);if(a){for(let s=0;s<Tl.length;s+=2)Tl[s][0](Tl[s+1]);Tl.length=0}}}return{set:r,update:function(o){r(o(t))},subscribe:function(o,a=ii){const s=[o,a];return n.add(s),n.size===1&&(i=e(r)||ii),o(t),()=>{n.delete(s),n.size===0&&(i(),i=null)}}}}function Ai(t,e,i){const n=!Array.isArray(t),r=n?[t]:t,o=e.length<2;return Rl(i,a=>{let s=!1;const l=[];let c=0,d=ii;const u=()=>{if(c)return;d();const h=e(n?l[0]:l,a);o?a(h):d=Zi(h)?h:ii},p=r.map((h,g)=>zr(h,m=>{l[g]=m,c&=~(1<<g),s&&u()},()=>{c|=1<<g}));return s=!0,u(),function(){Ui(p),d()}})}var Jy=t=>t.reduce((e,i)=>Object.assign(e,i),{});const Ml=t=>({updateValue:t}),Lo=t=>({defaultValue:t}),Qy=t=>({store:t}),Gd=t=>({store:(e,i)=>Ai(...t(i))}),Zd=t=>({store:(e,i)=>{const[n,r,o=()=>!1]=t(i);let a,s=!0;return Ai(n,(l,c)=>{r(l,d=>{!s&&o(a,d)||(a=d,s=!1,c(d))})})}}),mc=t=>({store:(e,i)=>{const[n,r={},o]=t(i);let a=[];const s={},l=h=>n(h,s),c=h=>{(a.length||h.length)&&(a=h,d())},d=()=>{const h=a.map(l);o&&h.sort(o),a=[...h],p(h)};Object.entries(r).map(([h,g])=>g.subscribe(m=>{s[h]=m,m&&d()}));const{subscribe:u,set:p}=he(e||[]);return{set:c,update:h=>c(h(a)),subscribe:u}}});var t$=t=>{const e={},i={};return t.forEach(([n,...r])=>{const o=Jy(r),a=e[n]=((l,c,d)=>{const{store:u=C=>he(C),defaultValue:p=$e,updateValue:h}=d,g=u(p(),c,l),{subscribe:m,update:f=$e}=g;let b;const w=C=>{let R=!0;b&&b(),b=m(M=>{if(R)return R=!1;C(M),b(),b=void 0})},S=h?h(l):Ji;return g.set=C=>f(R=>S(C,R,w)),g.defaultValue=p,g})(i,e,o),s={get:()=>va(a),set:a.set};Object.defineProperty(i,n,s)}),{stores:e,accessors:i}},nv=[["src",Qy(()=>{let t;const{subscribe:e,set:i}=he(),n=r=>{t!==r&&(t=r,i(t))};return{set:n,subscribe:e,update:r=>n(r(t))}})],["imageReader"],["imageWriter"],["imageScrambler"],["imageRedactionRendering",Lo(()=>"pixelated")],["images",Lo(()=>[])],["shapePreprocessor"],["willRequestResource"],["willRequest"],["csp"]],t2=t=>t.charAt(0).toUpperCase()+t.slice(1),Cu=(t,e)=>{Object.keys(e).forEach(i=>{const n=cn(e[i])?{value:e[i],writable:!1}:e[i];Object.defineProperty(t,i,n)})};const e$=(t,e)=>{let i,n,r,o,a,s,l,c,d,u;const p=e.length;for(i=0;i<p;i++)if(n=e[i],r=e[i+1>p-1?0:i+1],o=n.x-t.x,a=n.y-t.y,s=r.x-t.x,l=r.y-t.y,c=o-s,d=a-l,u=c*a-d*o,u<-1e-5)return!1;return!0};var i$=(t,e)=>{const i=cy(e),n=ln();Bo(t).forEach(o=>{Fn(o,n),e$(o,e)||i.forEach(a=>{const s=Math.atan2(a.start.y-a.end.y,a.start.x-a.end.x),l=1e4*Math.sin(Math.PI-s),c=1e4*Math.cos(Math.PI-s),d=ot(o.x+l,o.y+c),u=vh(ry(a),1e4),p=wh(Is(o,d),u);p&&Fn(n,Dn(Oe(p),o))})});const r=Ci(t);return Fn(r,n),!!Bo(r).every(o=>e$(o,e))&&(Ru(t,r),!0)},e2=(t,e)=>{const i=Bo(t),n=dy(e,5),r=Ti(t),o=[];i.forEach(l=>{const c=((u,p)=>{const h=ot(u.start.x-u.end.x,u.start.y-u.end.y),g=no(h),m=Tr(g,p);return u.end.x+=m.x,u.end.y+=m.y,u})(Is(Oe(r),Oe(l)),1e6);let d=!1;n.map(ry).forEach(u=>{const p=wh(c,u);p&&!d&&(o.push(p),d=!0)})});const a=$o(o[0],o[2])<$o(o[1],o[3])?[o[0],o[2]]:[o[1],o[3]],s=nr(a);return s.width<t.width&&(Ru(t,s),!0)},i2=(t,e,i={x:0,y:0})=>{const n=Fr(t),r=Ti(n),o=ay(n,i,r).map(s=>Lr(s,e,r)),a=nr(o);return o.map(s=>Dn(s,a))},Il=(t,e=0,i=rr(t))=>{let n,r;if(e!==0){const o=Math.atan2(1,i),a=Math.sign(e)*e,s=a%Math.PI,l=a%Oo;let c;c=s>Qo&&s<Oo+Qo?l>Qo?a:Oo-l:l>Qo?Oo-l:a;const d=Math.min(Math.abs(t.height/Math.sin(o+c)),Math.abs(t.width/Math.cos(o-c)));n=Math.cos(o)*d,r=n/i}else n=t.width,r=n/i,r>t.height&&(r=t.height,n=r*i);return Vn(n,r)},rv=(t,e,i,n,r,o,a,s)=>{const l=io(a),c=io(s),d=ai(Math.max(e.width/c.width,e.height/c.height)),u=ai(Math.min(e.width/l.width,e.height/l.height)),p=Ci(e);if(u<1||d>1){const h=Ti(t),g=Ti(e),m=u<1?u:d,f=(g.x+h.x)/2,b=(g.y+h.y)/2,w=p.width/m,S=p.height/m;oy(p,f-.5*w,b-.5*S,w,S)}return o?(((h,g,m=0,f=ln(),b)=>{if(ui(m)&&m!==0||f.x||f.y){const w=rr(h),S=i2(g,m,f),C=Il(g,m,w);if(!(h.width<C.width&&h.height<C.height)){const R=.5*h.width-.5*C.width,M=.5*h.height-.5*C.height;h.width>C.width&&(h.width=C.width,h.x+=R),h.height>C.height&&(h.height=C.height,h.y+=M)}i$(h,S),e2(h,S)&&i$(h,S)}else{const w=rr(h);h.width=Math.min(h.width,g.width),h.height=Math.min(h.height,g.height),h.x=Math.max(h.x,0),h.x+h.width>g.width&&(h.x-=h.x+h.width-g.width),h.y=Math.max(h.y,0),h.y+h.height>g.height&&(h.y-=h.y+h.height-g.height);const S=Ti(h),C=Ur(h,w);C.width=Math.max(b.width,C.width),C.height=Math.max(b.height,C.height),C.x=S.x-.5*C.width,C.y=S.y-.5*C.height,Ru(h,C)}})(p,i,n,r,l),{crop:p}):{crop:p}},Wh=(t,e,i)=>{const n=Fr(t),r=Ti(n),o=$r(n,i,r),a=Ti(zc(nr(o))),s=Ti(e),l=Lr(s,-i,a),c=Dn(l,a),d=wo(Fn(r,c),ai);return In(d.x-.5*e.width,d.y-.5*e.height,e.width,e.height)},rn=(t,e,i)=>Math.max(e,Math.min(t,i));const vp=["cropLimitToImage","cropMinSize","cropMaxSize","cropAspectRatio","flipX","flipY","rotation","crop","colorMatrix","convolutionMatrix","gamma","vignette","manipulation","redaction","annotation","decoration","selection","frame","backgroundColor","backgroundImage","targetSize","metadata","trim","volume","minDuration","maxDuration","currentTime"],ih=t=>En(t)?t.map(ih):Th(t)||Hc(t)?t:sl(t)?{...t}:t,$c=t=>t.map(e=>Object.entries(e).reduce((i,[n,r])=>(n.startsWith("_")||(i[n]=r),i),{})),ov=(t,e)=>t===e;var os=(t,e,i=ov)=>{if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!i(t[n],e[n]))return!1;return!0};const n$=(t,e,i)=>{const n=wo(Ti(t),d=>ai(d,8)),r=Fr(e),o=Ti(r),a=$r(r,i,o),s=wo(Dl(nr(a)),d=>ai(d,8)),l=Math.abs(s.x-n.x),c=Math.abs(s.y-n.y);return l<1&&c<1},av=(t,e,i,n,r)=>{if(!r)return[-1/0,1/0];const o=Math.max(i.width/n.width,i.height/n.height),a=Vn(n.width*o,n.height*o),s=(l=a,Math.sqrt(l.width*l.width+l.height*l.height));var l;if(s<Math.min(t.width,t.height))return[-1/0,1/0];const c=e?t.height:t.width,d=e?t.width:t.height,u=Math.acos(a.height/s),p=u-Math.acos(d/s),h=Math.asin(c/s)-u;if(Number.isNaN(p)&&Number.isNaN(h))return[-1/0,1/0];const g=Number.isNaN(p)?h:Number.isNaN(h)?p:Math.min(p,h);return[-g,g]},Sc=(t,e)=>{const{context:i,props:n}=e;return t._isFormatted||((t=Py(t))._isFormatted=!0,Object.assign(t,n)),t._isDraft||!Au(t)||t._context&&ea(i,t._context)||(Ay(t,i),t._context={...i}),t},sv=(t,e)=>(t._isFormatted||(t.disableMove=!0,t.disableSelect=!0,t.disableResize=!0,t.disableRotate=!0),Sc(t,e));var _h=[["file"],["size"],["loadState"],["processState"],["aspectRatio",Gd(({size:t})=>[t,e=>e?rr(e):void 0])],["perspectiveX",Lo(()=>0)],["perspectiveY",Lo(()=>0)],["perspective",Gd(({perspectiveX:t,perspectiveY:e})=>[[t,e],([i,n])=>({x:i,y:n})])],["rotation",Lo(()=>0),Ml(t=>(e,i,n)=>{if(e===i)return e;const{loadState:r,size:o,rotationRange:a,cropMinSize:s,cropMaxSize:l,crop:c,perspective:d,cropLimitToImage:u,cropOrigin:p}=t;if(!c||!r||!r.beforeComplete)return e;const h=u&&((f,b,w)=>{const S=Il(b,w,rr(f));return Lc(is(S,Math.round),is(io(f),Math.round))})(c,o,i),g=u&&n$(c,o,i),m=((f,b,w,S,C,R,M,D,T,F)=>{const W=io(T),B=io(F);M&&(B.width=Math.min(F.width,C.width),B.height=Math.min(F.height,C.height));let y=!1;const V=(N,it)=>{const ut=Wh(C,S,N),st=Fr(C),mt=Ti(st),G=ay(st,R,mt),gt=Dn(Oe(mt),bm(G)),vt=Lr(Ti(ut),it,mt),lt=Dn(Oe(mt),vt);G.forEach($t=>Lr($t,it,mt));const St=nr(G),J=bm(G),q=Fn(Dn(Dn(J,lt),St),gt),Z=In(q.x-.5*ut.width,q.y-.5*ut.height,ut.width,ut.height);if(D&&Cr(Z,D.width/Z.width),M){const $t=i2(C,it,R);e2(Z,$t)}const bt=ai(Math.min(Z.width/W.width,Z.height/W.height),8),nt=ai(Math.max(Z.width/B.width,Z.height/B.height),8);return(bt<1||nt>1)&&ai(Math.abs(it-N))===ai(Math.PI/2)&&!y?(y=!0,V(f,f+Math.sign(it-N)*Math.PI)):{rotation:it,crop:Do(Z,$t=>ai($t,8))}},tt=Math.sign(b)*Math.round(Math.abs(b)/Oo)*Oo,k=rn(b,tt+w[0],tt+w[1]);return V(f,k)})(i,e,a,c,o,d,u,p,s,l);if(h&&g){const f=Il(o,e,rr(m.crop));m.crop.x+=.5*m.crop.width,m.crop.y+=.5*m.crop.height,m.crop.x-=.5*f.width,m.crop.y-=.5*f.height,m.crop.width=f.width,m.crop.height=f.height}return n(()=>{t.crop=Do(m.crop,f=>ai(f,8))}),m.rotation})],["flipX",Lo(()=>!1)],["flipY",Lo(()=>!1)],["flip",Gd(({flipX:t,flipY:e})=>[[t,e],([i,n])=>({x:i,y:n})])],["isRotatedSideways",Zd(({rotation:t})=>[[t],([e],i)=>i(Ea(e)),(e,i)=>e!==i])],["crop",Ml(t=>(e,i=e)=>{const{loadState:n,size:r,cropMinSize:o,cropMaxSize:a,cropLimitToImage:s,cropAspectRatio:l,rotation:c,perspective:d}=t;if(!e&&!i||!n||!n.beforeComplete)return e;e||(e=Fr(Il(r,c,l||rr(r))));const u=rv(i,e,r,c,d,s,o,a),p=Do(u.crop,h=>ai(h,8));return ea(i,p)?i:p})],["cropAspectRatio",Ml(t=>(e,i)=>{const{loadState:n,crop:r,size:o,rotation:a,cropLimitToImage:s}=t,l=(d=>{if(d){if(/:/.test(d)){const[u,p]=d.split(":");return u/p}return parseFloat(d)}})(e);if(!l)return;if(!r||!n||!n.beforeComplete)return l;const c=i?Math.abs(e-i):1;if(n$(r,o,a)&&s&&c>=.1){const d=((u,p)=>{const h=u.width,g=u.height;return Ea(p)&&(u.width=g,u.height=h),u})(io(o),a);t.crop=Do(Ur(Fr(d),e),ai)}else{const d={width:r.height*l,height:r.height},u=.5*(r.width-d.width),p=.5*(r.height-d.height);t.crop=Do(In(r.x+u,r.y+p,d.width,d.height),ai)}return l})],["cropOrigin"],["cropMinSize",Lo(()=>({width:1,height:1}))],["cropMaxSize",Lo(()=>({width:32768,height:32768}))],["cropLimitToImage",Lo(()=>!0),Ml(t=>(e,i,n)=>{const{crop:r}=t;return r&&!i&&e&&n(()=>t.crop=Ci(t.crop)),e})],["cropSize",Zd(({crop:t})=>[[t],([e],i)=>{e&&i(Vn(e.width,e.height))},(e,i)=>Lc(e,i)])],["cropRectAspectRatio",Gd(({cropSize:t})=>[[t],([e],i)=>{e&&i(ai(rr(e),5))}])],["cropRange",Zd(({size:t,rotation:e,cropRectAspectRatio:i,cropMinSize:n,cropMaxSize:r,cropLimitToImage:o})=>[[t,e,i,n,r,o],([a,s,l,c,d,u],p)=>{a&&p(((h,g,m,f,b,w)=>{const S=io(f),C=io(b);return w?[S,is(Il(h,g,m),Math.round)]:[S,C]})(a,s,l,c,d,u))},(a,s)=>os(a,s)])],["rotationRange",Zd(({size:t,isRotatedSideways:e,cropMinSize:i,cropSize:n,cropLimitToImage:r})=>[[t,e,i,n,r],([o,a,s,l,c],d)=>{!o||!l||d(av(o,a,s,l,c))},(o,a)=>os(o,a)])],["backgroundColor",Ml(()=>t=>((e=[0,0,0,0],i=1)=>e.length===4?e:[...e,i])(t))],["backgroundImage"],["targetSize"],["colorMatrix"],["convolutionMatrix"],["gamma"],["noise"],["vignette"],["duration"],["currentTime"],["minDuration",Lo(()=>1/24)],["maxDuration",Lo(()=>1/0)],["volume",Lo(()=>1)],["trim"],["redaction",mc(({size:t})=>[Sc,{context:t}])],["manipulation",mc(({size:t})=>[Sc,{context:t}])],["annotation",mc(({size:t})=>[Sc,{context:t}])],["decoration",mc(({crop:t})=>[Sc,{context:t}])],["selection",mc(({size:t})=>[sv,{context:t}])],["frame",Ml(()=>t=>{if(!t)return;const e={frameStyle:void 0,x:0,y:0,width:"100%",height:"100%",disableStyle:["backgroundColor","strokeColor","strokeWidth"]};return Ve(t)?e.frameStyle=t:Object.assign(e,t),e})],["metadata"],["state",Qy((t,e,i)=>{const n=vp.map(l=>e[l]);let r=!1;const o=he({}),{subscribe:a}=Ai([...n,o],(l,c)=>{if(r)return;const d=vp.reduce((u,p,h)=>(u[p]=ih(l[h]),u),{});d.crop&&Do(d.crop,Math.round),d.manipulation=d.manipulation&&$c(d.manipulation),d.redaction=d.redaction&&$c(d.redaction),d.annotation=d.annotation&&$c(d.annotation),d.decoration=d.decoration&&$c(d.decoration),d.selection=d.selection&&$c(d.selection),c(d)}),s=l=>{l&&(r=!0,i.cropOrigin=void 0,vp.filter(c=>Ie(l,c)).forEach(c=>{const d=l[c];i[c]=d===null?void 0:ih(d)}),r=!1,o.set({}))};return{set:s,update:l=>s(l(null)),subscribe:a}})]],r$=async(t,e,i={},n)=>{const{ontaskstart:r,ontaskprogress:o,ontaskend:a,token:s}=n;let l=!1;const c={cancel:$e};s.cancel=()=>{l=!0,c.cancel()};for(const[d,u]of e.entries()){if(l)return;const[p,h]=u;r(d,h);try{t=await p(t,{...i,taskCancelToken:c},g=>o(d,h,g))}catch(g){throw l=!0,g}a(d,h)}return t};const n2=["loadstart","loadabort","loaderror","loadprogress","load","processstart","processabort","processerror","processprogress","process"],lv=["flip","cropOrigin","isRotatedSideways","perspective","perspectiveX","perspectiveY","cropRange"],cv=_h.map(([t])=>t).filter(t=>!lv.includes(t)),wp=t=>"image"+t2(t),o$=t=>Ie(t,"crop");var r2=()=>{const{stores:t,accessors:e}=t$(nv),{sub:i,pub:n}=ns(),r=()=>e.images?e.images[0]:{};let o={};const a={};cv.forEach(m=>{Object.defineProperty(e,wp(m),{get:()=>{const f=r();if(f)return f.accessors[m]},set:f=>{o[wp(m)]=f,a[wp(m)]=f;const b=r();b&&(b.accessors[m]=f)}})});const s=()=>e.images&&e.images[0],l=t.src.subscribe(m=>{if(!m)return e.images=[];e.imageReader&&(e.images.length&&(o={}),d(m))}),c=t.imageReader.subscribe(m=>{m&&(e.images.length||e.src&&d(e.src))}),d=m=>{Promise.resolve().then(()=>p(m,o)).catch(()=>{})};let u;const p=(m,f={})=>new Promise((b,w)=>{let S=s();const C=!(f.cropLimitToImage===!1||f.imageCropLimitToImage===!1||a.imageCropLmitedToImage===!1),R=f.cropMinSize||f.imageCropMinSize||a.imageCropMinSize,M=C?R:S&&S.accessors.cropMinSize,D=f.minDuration||f.imageMinDuration;S&&g(),S=(({minSize:W={width:1,height:1},minDuration:B=0}={})=>{const{stores:y,accessors:V}=t$(_h),{pub:tt,sub:k}=ns(),N=(it,ut)=>{const st=()=>V[it]||{},mt=vt=>{V[it]={...st(),...vt,timeStamp:Date.now()}},G=()=>st().error,gt=vt=>{G()||(mt({error:vt}),tt(ut+"error",{...st()}))};return{start(){tt(ut+"start")},onabort(){mt({abort:!0}),tt(ut+"abort",{...st()})},ontaskstart(vt,lt){G()||(mt({index:vt,task:lt,taskProgress:void 0,taskLengthComputable:void 0}),tt(ut+"taskstart",{...st()}))},ontaskprogress(vt,lt,St){G()||(mt({index:vt,task:lt,taskProgress:St.loaded/St.total,taskLengthComputable:St.lengthComputable}),tt(ut+"taskprogress",{...st()}),tt(ut+"progress",{...st()}))},ontaskend(vt,lt){G()||(mt({index:vt,task:lt}),tt(ut+"taskend",{...st()}))},ontaskerror(vt){gt(vt)},error(vt){gt(vt)},beforeComplete(vt){G()||(mt({beforeComplete:!0}),tt("before"+ut,vt))},complete(vt){G()||(mt({complete:!0}),tt(ut,vt))}}};return Cu(V,{read:(it,{reader:ut},st={})=>{if(!ut)return;Object.assign(V,{file:void 0,size:void 0,loadState:void 0});let mt={cancel:$e},G=!1;const gt=N("loadState","load"),vt={token:mt,...gt},lt={src:it,size:void 0,dest:void 0,duration:void 0};return Promise.resolve().then(async()=>{try{if(gt.start(),G)return gt.onabort();const St=await r$(lt,ut,st,vt);if(G)return gt.onabort();const{size:J,duration:q,dest:Z}=St||{};if(!J||!J.width||!J.height)throw new Pc("Image size missing","IMAGE_SIZE_MISSING",St);if(q>0&&q<B)throw new Pc("Video too short","VIDEO_TOO_SHORT",{...St,minDuration:B});if(J.width<W.width||J.height<W.height)throw new Pc("Image too small","IMAGE_TOO_SMALL",{...St,minWidth:W.width,minHeight:W.height});Object.assign(V,{file:Z,size:J,duration:q}),gt.beforeComplete(St),gt.complete(St)}catch(St){gt.error(St)}finally{mt=void 0}}),()=>{G=!0,mt&&mt.cancel(),gt.onabort()}},write:(it,ut)=>{if(!V.loadState.complete)return;V.processState=void 0;const st=N("processState","process"),mt={src:V.file,imageState:V.state,dest:void 0};if(cn(it)&&(it=it(V.file,V.state)),!it)return st.start(),void st.complete(mt);let G={cancel:$e},gt=!1;const vt=ut,lt={token:G,...st};return Promise.resolve().then(async()=>{try{if(st.start(),gt)return st.onabort();const St=await r$(mt,it,vt,lt);if(gt)return st.onabort();st.complete(St)}catch(St){st.error(St)}finally{G=void 0}}),()=>{gt=!0,G&&G.cancel()}},on:k}),{accessors:V,stores:y}})({minSize:M,minDuration:D}),n2.map(W=>{return S.accessors.on(W,(B=W,y=>n(B,y)));var B});const T=()=>{o={},F.forEach(W=>W())},F=[];F.push(S.accessors.on("loaderror",W=>{T(),w(W)})),F.push(S.accessors.on("loadabort",()=>{T(),w({name:"AbortError"})})),F.push(S.accessors.on("load",W=>{u=void 0,T(),b(W)})),F.push(S.accessors.on("beforeload",()=>((W,B)=>{if(o$(B))return void(e.imageState=B);if(!B.imageCrop){const tt=W.accessors.size,k=B.imageRotation||0,N=ny(io(tt),k),it=Fr(N);it.width=ai(Math.abs(it.width),6),it.height=ai(Math.abs(it.height),6);const ut=B.imageCropAspectRatio||(B.imageCropLimitToImage?rr(tt):rr(it));let st;B.imageCropLimitToImage?st=Ur(it,ut):(st=rs(it,ut),st.x=(tt.width-st.width)/2,st.y=(tt.height-st.height)/2),B.imageCrop=st}if(W.accessors.duration&&!B.imageTrim&&B.imageMaxDuration){const{duration:tt}=W.accessors;B.imageTrim=[[0,Math.min(B.imageMaxDuration/tt,1)]]}const y=["imageCropLimitToImage","imageCrop","imageCropAspectRatio","imageRotation"];y.filter(tt=>Ie(B,tt)).forEach(tt=>{e[tt]=B[tt],delete B[tt]});const V=Object.keys(B).filter(tt=>!y.includes(tt)).reduce((tt,k)=>(tt[k]=B[k],tt),{});Object.assign(e,V)})(S,f))),e.images=[S],f.imageReader&&(e.imageReader=f.imageReader),f.imageWriter&&(e.imageWriter=f.imageWriter),u=S.accessors.read(m,{reader:e.imageReader},{willRequest:e.willRequest})});let h;const g=()=>{const m=s();m&&(u&&u(),m.accessors.loadState=void 0,e.images=[])};return Object.defineProperty(e,"stores",{get:()=>t}),Cu(e,{on:i,loadImage:p,abortLoadImage:()=>{u&&u(),e.images=[]},editImage:(m,f)=>new Promise((b,w)=>{p(m,f).then(()=>{const{images:S}=e,C=S[0],R=()=>{M(),D()},M=C.accessors.on("processerror",T=>{R(),w(T)}),D=C.accessors.on("process",T=>{R(),b(T)})}).catch(w)}),removeImage:g,processImage:(m,f)=>new Promise((b,w)=>{try{const S=[],C=()=>{h=void 0,S.forEach(R=>R())};(async()=>{if((M=>Ve(M)||Ol(M)||Bl(M))(m))try{await p(m,f)}catch(M){w(M)}else m&&(o$(m)?e.imageState=m:Object.assign(e,m));const R=s();if(!R)return w("no image");S.push(R.accessors.on("processerror",M=>{C(),w(M)})),S.push(R.accessors.on("processabort",()=>{C(),w({name:"AbortError"})})),S.push(R.accessors.on("process",M=>{C(),b(M)})),h=R.accessors.write(e.imageWriter,{redactionRenderStyle:e.imageRedactionRendering,shapePreprocessor:e.shapePreprocessor||Ji,imageScrambler:e.imageScrambler,willRequest:e.willRequest,csp:e.csp||{},willRequestResource:e.willRequestResource})})()}catch(S){w(S)}}),abortProcessImage:()=>{const m=s();m&&(h&&h(),m.accessors.processState=void 0)},destroy:()=>{l&&l(),c&&c()}}),e};const dv=(t,e)=>{const{processImage:i}=r2();return i(t,e)};var o2=()=>La()?ra()?/15_|16_/.test(navigator.userAgent)?14745600:16777216:/15_/.test(navigator.userAgent)?16777216:1/0:1/0,a2=(t,e)=>Object.keys(t).filter(i=>!e.includes(i)).reduce((i,n)=>(i[n]=t[n],i),{}),s2=t=>new Promise(e=>{if(t.duration===1/0)return t.ontimeupdate=()=>{t.ontimeupdate=void 0,e(t)},void(t.currentTime=Number.MAX_SAFE_INTEGER);e(t)});const uv=t=>new Promise(e=>{const i=new FileReader;i.onload=()=>e(i.result),i.readAsArrayBuffer(t)}),Sp=(t,e=0,i=t.byteLength)=>{const n=[],r=e+i;for(;e<r;){const o=t.getUint32(e);if(o<0)break;const a=t.getUint32(e+4);if(n.push({type:a,size:o,offset:e,bodyOffset:e+8,bodySize:o-8}),o<8)break;e+=o}return n},pv=(t,{limit:e=1024}={})=>{let i=0;if(i+=4,t.getUint32(i)!==1718909296)return 0;i+=4;const n=t.getUint32(i);return n===1836069938?((r,o,a)=>{let s=!1,l=-1;for(let h=o;h<a;h++)if(s||r.getUint32(h)!==1953653099||(s=!0,h+=4),s&&r.getUint8(h)==64){l=h;break}if(l<0)return 0;const c=r.getUint32(l-28),d=r.getUint32(l-20),u=r.getUint32(l-32),p=r.getUint32(l-16);return c===65536&&d===4294901760?90:u===4294901760&&p===4294901760?180:c===4294901760&&d===65536?270:0})(t,i,e):n===1903435808?(r=>{const o=Sp(r).find(c=>c.type===1836019574);if(!o)return 0;const a=Sp(r,o.bodyOffset,o.bodySize);a.filter(c=>c.type===1953653099).forEach(c=>{a.push(...Sp(r,c.bodyOffset,c.bodySize))});const s=[1836476516,1953196132],l=a.filter(c=>s.includes(c.type));for(const{type:c,bodyOffset:d}of l){const u=r.getUint8(d);let p=d+4;p+=c===1836476516?32:36,p+=u===1?12:0;const h=r.getInt32(p),g=r.getInt32(p+4);if(h===0&&g>0)return 90;if(h<0&&g===0)return 180;if(h===0&&g<0)return 270}return 0})(t):0};var l2=t=>new Promise((e,i)=>{(wa()?(async n=>{const r=await uv(n),o=new DataView(r);return pv(o)})(t):Promise.resolve(0)).then(n=>{const r=document.createElement("video");r.onerror=()=>i(r.error),r.playsInline=!0,r.preload="auto",r.onseeked=()=>{r.onseeked=void 0,e(r)},r.onloadeddata=()=>{r.onloadeddata=void 0,r.dataset.rotation=n?""+n:"0",s2(r).then(e),r.currentTime=0},r.src=URL.createObjectURL(t),(o=>{ra()&&(o.load(),o.play().catch(()=>{}),o.pause())})(r)})}),c2=(t,e)=>new Promise(i=>{if(t.currentTime===e)return i(t);let n=t.onseeked;t.onseeked=()=>{t.onseeked=n,i(t)},t.currentTime=rn(e,0,t.duration)}),d2=(t,e=0)=>new Promise((i,n)=>{l2(t).then(r=>{c2(r,e).then(o=>{const a=fn("canvas");hy(o).then(({width:s,height:l})=>{a.width=s,a.height=l;const c=a.getContext("2d",{willReadFrequently:!0}),d=()=>{c.drawImage(o,0,0,a.width,a.height);const u=c.getImageData(0,0,a.width,a.height);Kn(a),URL.revokeObjectURL(o.src),i(u)};La()?setTimeout(d,16):d()})})})}),cl=t=>/video/.test(t.type);const Vh=({imageDataResizer:t,canvasMemoryLimit:e}={})=>async(i,n,r,o,a)=>{r.width=Math.max(r.width,1),r.height=Math.max(r.height,1),o.width=Math.max(o.width,1),o.height=Math.max(o.height,1);const{dest:s}=await dv(n,{imageReader:g2(),imageWriter:f2({format:"canvas",targetSize:{...o,upscale:!0},imageDataResizer:t,canvasMemoryLimit:e}),imageCrop:r}),{feather:l=0}=a||{};if(l>0){const c=fn("canvas");c.width=s.width,c.height=s.height;const d=c.getContext("2d",{willReadFrequently:!0}),u=1/l;let p=0;for(p=0;p<l;p++){const g=p*u;d.strokeStyle=`rgba(0,0,0,${g*g})`,d.strokeRect(p+.5,p+.5,s.width-2*p-1,s.height-2*p-1)}d.fillStyle="#000",d.fillRect(p,p,s.width+.5-2*p,s.height+.5-2*p);const h=s.getContext("2d");h.globalCompositeOperation="destination-in",h.drawImage(c,0,0),Kn(c)}i.drawImage(s,o.x,o.y,o.width,o.height),Kn(s)},kn=(t,e=(...n)=>n,i)=>async(n,r,o)=>{o(Pl(0,!1));let a=!1;const s=await t(...e(n,r,l=>{a=!0,o(l)}));return i&&i(n,s),a||o(Pl(1,!1)),n},hv=({willRequest:t,srcProp:e="src",destProp:i="dest"}={})=>[kn(fb,(n,r,o)=>[n[e],o,{...r,willRequest:t}],(n,r)=>n[i]=r),"any-to-file"],mv=({srcProp:t="dest",destProp:e="dest"}={})=>[kn(async i=>{if(/octet-stream/.test(i.type)){console.warn(`Pintura: File has unknown mime type "${i.type}", make sure your server sets the correct Content-Type header.`);let n="image";const r=await Ch(i);/video/i.test(r.nodeName)&&(n="video");const o={type:n+"/unknown"};return Hc(i)?new File([i],i.name,{...o,lastModified:i.lastModified}):new Blob([i],o)}return i},i=>[i[t]],(i,n)=>i[e]=n),"any-to-file"],u2=({srcProp:t="src",destProp:e="size"}={})=>[kn(my,i=>[i[t]],(i,n)=>i[e]=n),"read-image-size"],$v=async t=>{const e=await Ch(t);if(yu(e))return await(i=>new Promise((n,r)=>{const o=()=>{s2(i).then(()=>{n(i.duration)})};if(i.readyState>=1)return o();i.onloadedmetadata=o,i.onerror=()=>r(i.error)}))(e)},gv=({srcProp:t="src",destProp:e="duration"}={})=>[kn($v,i=>[i[t]],(i,n)=>i[e]=n),"read-media-duration"],p2=({srcSize:t="size",srcOrientation:e="orientation",destSize:i="size"}={})=>[kn(yb,n=>[n[t],n[e]],(n,r)=>n[i]=r),"image-size-match-orientation"],h2=({srcProp:t="src",destProp:e="head"}={})=>[kn((i,n)=>fy(i)?Zf(i,n):void 0,i=>[i[t],[0,262144],onprogress],(i,n)=>i[e]=n),"read-image-head"],m2=({srcProp:t="head",destProp:e="orientation"}={})=>[kn(gh,i=>[i[t],274],(i,n=1)=>i[e]=n),"read-exif-orientation-tag"],fv=({srcProp:t="head"}={})=>[kn(gh,e=>[e[t],274,1]),"clear-exif-orientation-tag"],yv=({srcImageSize:t="size",srcCanvasSize:e="imageData",srcImageState:i="imageState",destImageSize:n="size",destScalar:r="scalar"}={})=>[kn((o,a)=>[Math.min(a.width/o.width,a.height/o.height),Fa(a)],o=>[o[t],o[e],o[i]],(o,[a,s])=>{o[r]=a,o[n]=s}),"calculate-canvas-scalar"],xv=({srcProp:t="src",destProp:e="imageData",canvasMemoryLimit:i,srcImageState:n="imageState"}={})=>[kn((r,o,a)=>cl(r)?d2(r,a.currentTime):Qf(r,o),r=>[r[t],i,r[n]],(r,o)=>r[e]=o),"blob-to-image-data"],bv=({srcImageData:t="imageData",srcOrientation:e="orientation"}={})=>[kn(Yf,i=>[i[t],i[e]],(i,n)=>i.imageData=n),"image-data-match-orientation"],vv=({srcImageData:t="imageData",srcImageState:e="imageState"}={})=>[kn(Yb,i=>[i[t],{backgroundColor:i[e].backgroundColor,backgroundImage:i[e].backgroundImage}],(i,n)=>i.imageData=n),"image-data-fill"],wv=({srcImageData:t="imageData",srcImageState:e="imageState",destScalar:i="scalar"}={})=>[kn(bb,n=>{const r=n[i];let{crop:o}=n[e];return o&&r!==1&&(o=Cr(Ci(o),r,ln())),[n[t],{crop:o,rotation:n[e].rotation,flipX:n[e].flipX,flipY:n[e].flipY}]},(n,r)=>n.imageData=r),"image-data-crop"],Sv=({targetSize:t={width:void 0,height:void 0,fit:void 0,upscale:void 0},imageDataResizer:e,srcProp:i="imageData",srcImageState:n="imageState",destImageScaledSize:r="imageScaledSize"})=>[kn(wb,o=>{const a=Math.min(t.width||Number.MAX_SAFE_INTEGER,o[n].targetSize&&o[n].targetSize.width||Number.MAX_SAFE_INTEGER),s=Math.min(t.height||Number.MAX_SAFE_INTEGER,o[n].targetSize&&o[n].targetSize.height||Number.MAX_SAFE_INTEGER);return[o[i],{width:a,height:s,fit:t.fit||"contain",upscale:(l=o[n],!!(l.targetSize&&l.targetSize.width||l.targetSize&&l.targetSize.height)||t.upscale||!1)},e];var l},(o,a)=>{Lc(o.imageData,a)||(o[r]=Fa(a)),o.imageData=a}),"image-data-resize"],kv=({srcImageData:t="imageData",srcImageState:e="imageState",destImageData:i="imageData"}={})=>[kn(Mb,n=>{const{colorMatrix:r}=n[e],o=r&&Object.keys(r).map(a=>r[a]).filter(Boolean);return[n[t],{colorMatrix:o&&Dh(o),convolutionMatrix:n[e].convolutionMatrix,gamma:n[e].gamma,noise:n[e].noise,vignette:n[e].vignette}]},(n,r)=>n[i]=r),"image-data-filter"],Cv=({srcImageData:t="imageData",srcImageState:e="imageState",destImageData:i="imageData",destScalar:n="scalar"}={})=>[kn(async(r,o,a,s,l,c)=>{if(!o||!s.length)return r;let d;try{const m={dataSizeScalar:Oy(r,s)};a&&a[3]>0&&(m.backgroundColor=[...a]),d=await o(r,m)}catch{}const u=fn("canvas");u.width=r.width,u.height=r.height;const p=u.getContext("2d",{willReadFrequently:!0});if(p.putImageData(r,0,0),c==="auto"){const m=Math.sqrt(r.width*r.height);p.filter=`blur(${Math.round(m/100)}px)`}const h=new Path2D;s.forEach(m=>{const f=In(m.x,m.y,m.width,m.height);Ss(f,l);const b=$r(Ci(f),m.rotation),w=new Path2D;b.forEach((S,C)=>{if(C===0)return w.moveTo(S.x,S.y);w.lineTo(S.x,S.y)}),h.addPath(w)}),p.clip(h,"nonzero"),p.imageSmoothingEnabled=!1,p.drawImage(d,0,0,u.width,u.height),Kn(d);const g=p.getImageData(0,0,u.width,u.height);return Kn(u),g},(r,{imageScrambler:o,redactionRenderStyle:a})=>[r[t],o,r[e].backgroundColor,r[e].redaction,r[n],a],(r,o)=>r[i]=o),"image-data-redact"],kp=({srcImageData:t="imageData",srcSize:e="size",srcImageState:i="imageState",srcShapes:n="annotation",destImageData:r="imageData",destImageScaledSize:o="imageScaledSize",destScalar:a="scalar",imageDataResizer:s,canvasMemoryLimit:l,shapeFilter:c=Ji,shapeClip:d=!0,destImageContext:u="imageContext"}={})=>[kn(Fh,(p,{shapePreprocessor:h,willRequestResource:g,csp:m,willRequest:f})=>{const b=p[i][n].filter(c);if(!b.length)return[p[t]];const w=p[a],{crop:S}=p[i],C=p[e];let R=w;const M=p[o];M&&(R=Math.min(M.width/S.width,M.height/S.height));const D={width:C.width/w,height:C.height/w};return[p[t],{shapes:b,computeShape:T=>(T=Zn(T,D),T=a2(T,["left","right","top","bottom"]),T=Ly(T,R)),transform:T=>{const F=p[e],{rotation:W=0,flipX:B,flipY:y,cropLimitToImage:V}=p[i],tt=p[a],{crop:k=Fr(F)}=p[i],N=p[o],it=N?Math.min(N.width/k.width,N.height/k.height):1,ut={width:F.width/tt*it,height:F.height/tt*it},st=ub(ut,W),mt=st.width,G=st.height,gt=.5*ut.width-.5*mt,vt=.5*ut.height-.5*G,lt=Dl(ut);T.translate(-gt,-vt),T.translate(-k.x*it,-k.y*it),T.translate(lt.x,lt.y),T.rotate(W),T.translate(-lt.x,-lt.y);const St=p[u]||{x:0,y:0};T.translate(St.x,St.y),T.scale(B?-1:1,y?-1:1),T.translate(B?-ut.width*tt:0,y?-ut.height*tt:0),V&&d&&(T.rect(0,0,ut.width,ut.height),T.clip())},drawImage:Vh({imageDataResizer:s,canvasMemoryLimit:l}),preprocessShape:T=>h(T,{isPreview:!1,...p[i]}),canvasMemoryLimit:l,willRequest:f||g,styleNonce:m.styleNonce}]},(p,h)=>p[r]=h),"image-data-annotate"],a$=({srcImageData:t="imageData",srcImageState:e="imageState",destImageData:i="imageData",destImageScaledSize:n="imageScaledSize",imageDataResizer:r,canvasMemoryLimit:o,destScalar:a="scalar",shapeFilter:s=Ji,destImageContext:l="imageContext"}={})=>[kn(Fh,(c,{shapePreprocessor:d,willRequestResource:u,willRequest:p,csp:h})=>{let g=c[e].decoration.filter(s);if(typeof window<"u"&&(w=>{if(w&&w._4ijgope)return;const[S]=[[85,110,108,105,99,101,110,115,101,100,32,80,105,110,116,117,114,97,32,105,110,115,116,97,110,99,101,32]].map(D=>D.map(T=>String.fromCharCode(T)).join("")),{width:C,height:R}=c[e].crop,M=R/15;g=[...g,{x:.5*-M,y:.5*-M,width:1.5*C,height:1.25*R,text:Array(50).fill(S).join(""),fontWeight:900,lineHeight:M,fontSize:M,color:[1,1,1,.05]}]})(window),!g.length)return[c[t]];let m=c[a];const{crop:f}=c[e],b=c[n];return b&&(m=Math.min(b.width/f.width,b.height/f.height)),[c[t],{shapes:g,drawImage:Vh({imageDataResizer:r,canvasMemoryLimit:o}),computeShape:w=>(w=Zn(w,f),w=a2(w,["left","right","top","bottom"]),w=Ly(w,m)),preprocessShape:w=>d(w,{isPreview:!1,...c[e]}),canvasMemoryLimit:o,willRequest:p||u,styleNonce:h.styleNonce,transform:w=>{const S=c[l]||{x:0,y:0};w.translate(S.x,S.y)}}]},(c,d)=>c[i]=d),"image-data-decorate"],Tv=({srcImageData:t="imageData",srcImageState:e="imageState",destImageData:i="imageData",destImageScaledSize:n="imageScaledSize",imageDataResizer:r,canvasMemoryLimit:o,destScalar:a="scalar",destImageContext:s="imageContext"}={})=>[kn((l,c)=>new Promise(d=>{if(!c)return d([l]);Fh(l,c).then(u=>{d([u,c.contextBounds])})}),(l,{shapePreprocessor:c,willRequestResource:d,willRequest:u,csp:p})=>{const h=l[e].frame;if(!h)return[l[t]];const g=l[a];let{crop:m}=l[e];m&&g!==1&&(m=Cr(Ci(m),g,ln()));const f={...m},b=Iy(Ey(h,f,c),f);f.x=Math.abs(b.left),f.y=Math.abs(b.top),f.width+=Math.abs(b.left)+Math.abs(b.right),f.height+=Math.abs(b.top)+Math.abs(b.bottom);const w=l[n],S=w?Math.min(w.width/m.width,w.height/m.height):1;return Ss(f,S),f.x=Math.floor(f.x),f.y=Math.floor(f.y),f.width=Math.floor(f.width),f.height=Math.floor(f.height),[l[t],{shapes:[h],contextBounds:f,computeShape:C=>Zn(C,l[t]),transform:C=>{C.translate(f.x,f.y)},drawImage:Vh({imageDataResizer:r,canvasMemoryLimit:o}),preprocessShape:C=>c(C,{isPreview:!1,...l[e]}),canvasMemoryLimit:o,willRequest:u||d,styleNonce:p.styleNonce}]},(l,[c,d])=>{l[s]=d,l[i]=c}),"image-data-frame"],Mv=({mimeType:t,quality:e,srcImageData:i="imageData",srcFile:n="src",destBlob:r="blob"}={})=>[kn(ob,o=>[o[i],t||bh(o[n].name)||o[n].type,e],(o,a)=>o[r]=a),"image-data-to-blob"],Pv=({srcImageData:t="imageData",srcOrientation:e="orientation",destCanvas:i="dest"}={})=>[kn(Nl,n=>[n[t],n[e]],(n,r)=>n[i]=r),"image-data-to-canvas"],Rv=async(t,e)=>{if(!fy(t)||!e)return t;const i=new DataView(e),n=Gf(i);if(!n||!n.exif)return t;const r=["exif","mpf","xmp"].reduce((o,a)=>n[a]?Math.max(o,n[a].offset+n[a].size):o,0);return((o,a,s=[0,o.size])=>a?new Blob([a,o.slice(...s)],{type:o.type}):o)(t,e.slice(0,r+2),[20])},Iv=(t="blob",e="head",i="blob")=>[kn(Rv,n=>[n[t],n[e]],(n,r)=>n[i]=r),"blob-write-image-head"],Ev=({renameFile:t,srcBlob:e="blob",srcFile:i="src",destFile:n="dest",defaultFilename:r}={})=>[kn(Ec,o=>[o[e],t?t(o[i]):o[i].name||`${r}.${ty(o[e].type)}`],(o,a)=>o[n]=a),"blob-to-file"],s$=({url:t="./",dataset:e=o=>[["dest",o.dest,o.dest.name],["imageState",o.imageState]],destStore:i="store",credentials:n,headers:r={}})=>[kn(async(o,a)=>await((s,l,c)=>new Promise((d,u)=>{const{token:p={},beforeSend:h=$e,onprogress:g=$e}=c;p.cancel=()=>m.abort();const m=new XMLHttpRequest;m.upload.onprogress=g,m.onload=()=>m.status>=200&&m.status<300?d(m):u(m),m.onerror=()=>u(m),m.ontimeout=()=>u(m),m.open("POST",encodeURI(s)),h(m),m.send(l instanceof FormData?l:l.reduce((f,b)=>(f.append(...b.map(xb)),f),new FormData))}))(t,o,{onprogress:a,beforeSend:s=>$y(s,{headers:r,credentials:n})}),(o,a,s)=>[e(o),s],(o,a)=>o[i]=a),"store"],$2=t=>[kn(e=>(t&&t.length&&Object.keys(e).forEach(i=>{t.includes(i)||delete e[i]}),e)),"prop-filter"],g2=(t={})=>{const{orientImage:e=!0,outputProps:i=["src","dest","size","duration"],preprocessImageFile:n,request:r={}}=t;return[hv({willRequest:()=>r}),mv(),n&&[kn(n,(o,a,s)=>[o.dest,a,s],(o,a)=>o.dest=a),"preprocess-image-file"],u2({srcProp:"dest"}),gv({srcProp:"dest"}),e&&h2({srcProp:"dest"}),e&&m2(),e&&p2(),$2(i)].filter(Boolean)},Av=t=>t&&(Ve(t)?s$({url:t}):cn(t)?[t,"store"]:s$(t)),f2=(t={})=>(e,i,n={})=>{let{canvasMemoryLimit:r=o2(),orientImage:o=!0,copyImageHead:a=!0,mimeType:s,quality:l,renameFile:c,targetSize:d,imageDataResizer:u,store:p,format:h="file",outputProps:g=["src","dest","imageState","store"],preprocessImageSource:m,preprocessImageState:f,postprocessImageData:b,postprocessImageBlob:w,testSrcSupport:S=!1}={...t,...n};if(!S||Iu(e))return h==="blob"&&(h="file"),[m&&[kn(m,(C,R,M)=>[C.src,R,M,C.imageState],(C,R)=>C.src=R),"preprocess-image-source"],(o||a)&&h2(),o&&m2(),u2(),f&&[kn(f,(C,R,M,D)=>[C.imageState,R,M,{size:C.size,orientation:C.orientation}],(C,R)=>C.imageState=R),"preprocess-image-state"],xv({canvasMemoryLimit:r}),o&&p2(),o&&bv(),yv(),Cv(),wv(),Sv({imageDataResizer:u,targetSize:d}),kp({imageDataResizer:u,canvasMemoryLimit:r,srcShapes:"manipulation"}),kv(),vv(),kp({imageDataResizer:u,canvasMemoryLimit:r,srcShapes:"annotation",shapeFilter:C=>!C.aboveFrame}),a$({imageDataResizer:u,canvasMemoryLimit:r,shapeFilter:C=>!C.aboveFrame}),Tv({imageDataResizer:u,canvasMemoryLimit:r}),kp({imageDataResizer:u,canvasMemoryLimit:r,srcShapes:"annotation",shapeFilter:C=>C.aboveFrame,shapeClip:!1}),a$({imageDataResizer:u,canvasMemoryLimit:r,shapeFilter:C=>C.aboveFrame}),b&&[kn(b,(C,R,M)=>[C.imageData,R,M],(C,R)=>C.imageData=R),"postprocess-image-data"],h==="file"?Mv({mimeType:s,quality:l}):h==="canvas"?Pv():[C=>(C.dest=C.imageData,C)],h==="file"&&o&&fv(),h==="file"&&a&&Iv(),w&&[kn(w,({blob:C,imageData:R,src:M},D,T)=>[{blob:C,imageData:R,src:M},D,T],(C,R)=>C.blob=R),"postprocess-image-file"],h==="file"&&Ev({defaultFilename:"image",renameFile:c}),h==="file"?Av(p):cn(p)&&[p,"store"],$2(g)].filter(Boolean)};var Lv=(t,e,i,n,r,o,a,s,l,c,d)=>{if(!(t&&e&&i&&n&&s))return;s*=o;const u=zc(Ci(e)),p=Ti(u),h=Ti(t),g=Fr(i),m=Ti(g),f=Wh(i,n,l),b=Ti(f),w=Dn(Oe(m),b),S=Dn(Oe(h),p);w.x+=S.x,w.y+=S.y;const C=El(Oe(w));C.x+=S.x,C.y+=S.y;const R=Ti(ta(ta(Ci(r),a),t)),M=Dn(R,h);return Fn(w,M),{origin:C,translation:w,rotation:{x:d?Math.PI:0,y:c?Math.PI:0,z:l},scale:s}};let gc=null;var Nh=()=>{if(gc===null)if("WebGL2RenderingContext"in window){let t;try{t=fn("canvas"),gc=!!t.getContext("webgl2")}catch{gc=!1}t&&Kn(t),t=void 0}else gc=!1;return gc},l$=t=>(t&t-1)==0,Hh=(t,e={},i="",n="")=>Object.keys(e).filter(r=>!sl(e[r])).reduce((r,o)=>r.replace(new RegExp(i+o+n),e[o]),t);const zv={head:`#version 300 es

in vec4 aPosition;uniform mat4 uMatrix;`,text:`
in vec2 aTexCoord;out vec2 vTexCoord;`,matrix:`
gl_Position=uMatrix*vec4(aPosition.x,aPosition.y,0,1);`},Fv={head:`#version 300 es
precision highp float;

out vec4 fragColor;`,mask:`
uniform float uMaskFeather[8];uniform float uMaskBounds[4];uniform float uMaskOpacity;float mask(float x,float y,float bounds[4],float opacity){return 1.0-(1.0-(smoothstep(bounds[3],bounds[3]+1.0,x)*(1.0-smoothstep(bounds[1]-1.0,bounds[1],x))*(1.0-step(bounds[0],y))*step(bounds[2],y)))*(1.0-opacity);}`,init:`
float a=1.0;vec4 fillColor=uColor;vec4 textureColor=texture(uTexture,vTexCoord);textureColor*=(1.0-step(uRepeat.y,vTexCoord.y))*step(0.0,vTexCoord.y)*(1.0-step(uRepeat.x,vTexCoord.x))*step(0.0,vTexCoord.x);`,colorize:`
if(uTextureColor.a!=0.0&&textureColor.a>0.0){vec3 colorFlattened=textureColor.rgb/textureColor.a;if(colorFlattened.r>=.9999&&colorFlattened.g==0.0&&colorFlattened.b>=.9999){textureColor.rgb=uTextureColor.rgb*textureColor.a;}textureColor*=uTextureColor.a;}`,maskapply:`
float m=mask(gl_FragCoord.x,gl_FragCoord.y,uMaskBounds,uMaskOpacity);`,maskfeatherapply:`
float leftFeatherOpacity=step(uMaskFeather[1],gl_FragCoord.x)*uMaskFeather[0]+((1.0-uMaskFeather[0])*smoothstep(uMaskFeather[1],uMaskFeather[3],gl_FragCoord.x));float rightFeatherOpacity=(1.0-step(uMaskFeather[7],gl_FragCoord.x))*uMaskFeather[4]+((1.0-uMaskFeather[4])*smoothstep(uMaskFeather[7],uMaskFeather[5],gl_FragCoord.x));a*=leftFeatherOpacity*rightFeatherOpacity;`,rectaa:`
vec2 scaledPoint=vec2(vRectCoord.x*uSize.x,vRectCoord.y*uSize.y);a*=smoothstep(0.0,uEdgeFeather,uSize.x-scaledPoint.x);a*=smoothstep(0.0,uEdgeFeather,uSize.y-scaledPoint.y);a*=smoothstep(0.0,uEdgeFeather,scaledPoint.x);a*=smoothstep(0.0,uEdgeFeather,scaledPoint.y);`,cornerradius:`
vec2 s=(uSize-2.0)*.5;vec2 r=(vRectCoord*uSize)-1.0;vec2 p=r-s;float cornerRadius=uCornerRadius[0];bool left=r.x<s.x;bool top=r.y<s.y;if(!left&&top){cornerRadius=uCornerRadius[1];}if(!left&&!top){cornerRadius=uCornerRadius[3];}if(left&&!top){cornerRadius=uCornerRadius[2];}a*=1.0-clamp(length(max(abs(p)-(s-cornerRadius),0.0))-cornerRadius,0.0,1.0);`,fragcolor:`
if(m<=0.0)discard;fillColor.a*=a;fillColor.rgb*=fillColor.a;fillColor.rgb*=m;fillColor.rgb+=(1.0-m)*(uCanvasColor.rgb*fillColor.a);textureColor*=uTextureOpacity;textureColor.a*=a;textureColor.rgb*=m*a;textureColor.rgb+=(1.0-m)*(uCanvasColor.rgb*textureColor.a);fragColor=textureColor+(fillColor*(1.0-textureColor.a));`},c$=(t,e,i)=>{const n=t.createShader(i),r=((o,a,s)=>(a=Hh(a,s===o.VERTEX_SHADER?zv:Fv,"##").trim(),Nh()?a:(a=(a=a.replace(/#version.+/gm,"").trim()).replace(/^\/\/\#/gm,"#"),s===o.VERTEX_SHADER&&(a=a.replace(/in /gm,"attribute ").replace(/out /g,"varying ")),s===o.FRAGMENT_SHADER&&(a=a.replace(/in /gm,"varying ").replace(/out.*?;/gm,"").replace(/texture\(/g,"texture2D(").replace(/fragColor/g,"gl_FragColor")),""+a)))(t,e,i);return t.shaderSource(n,r),t.compileShader(n),t.getShaderParameter(n,t.COMPILE_STATUS)||console.error(t.getShaderInfoLog(n)),n},fc=(t,e,i,n,r)=>{const o=c$(t,e,t.VERTEX_SHADER),a=c$(t,i,t.FRAGMENT_SHADER),s=t.createProgram();t.attachShader(s,o),t.attachShader(s,a),t.linkProgram(s);const l={};return n.forEach(c=>{l[c]=t.getAttribLocation(s,c)}),r.forEach(c=>{l[c]=t.getUniformLocation(s,c)}),{program:s,locations:l,destroy(){t.detachShader(s,o),t.detachShader(s,a),t.deleteShader(o),t.deleteShader(a),t.deleteProgram(s)}}},d$=t=>t.nodeName!=="VIDEO"&&(!!Nh()||l$(t.width)&&l$(t.height)),Dv=(t,e,i,n)=>(t.bindTexture(t.TEXTURE_2D,e),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,i),((r,o,a)=>{r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,d$(o)?r.LINEAR_MIPMAP_LINEAR:r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,a.filterParam),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,a.wrapParam),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,a.wrapParam),d$(o)&&r.generateMipmap(r.TEXTURE_2D)})(t,i,n),t.bindTexture(t.TEXTURE_2D,null),e),Ks=(t,e=1)=>t?[t[0],t[1],t[2],ui(t[3])?e*t[3]:e]:[0,0,0,0],Cp=()=>{const t=new Float32Array(16);return t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},Tp=(t,e,i,n,r,o,a)=>{const s=1/(e-i),l=1/(n-r),c=1/(o-a);t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+i)*s,t[13]=(r+n)*l,t[14]=(a+o)*c,t[15]=1},Js=(t,e,i,n)=>{t[12]=t[0]*e+t[4]*i+t[8]*n+t[12],t[13]=t[1]*e+t[5]*i+t[9]*n+t[13],t[14]=t[2]*e+t[6]*i+t[10]*n+t[14],t[15]=t[3]*e+t[7]*i+t[11]*n+t[15]},u$=(t,e)=>{t[0]*=e,t[1]*=e,t[2]*=e,t[3]*=e,t[4]*=e,t[5]*=e,t[6]*=e,t[7]*=e,t[8]*=e,t[9]*=e,t[10]*=e,t[11]*=e},p$=(t,e)=>{const i=Math.sin(e),n=Math.cos(e),r=t[4],o=t[5],a=t[6],s=t[7],l=t[8],c=t[9],d=t[10],u=t[11];t[4]=r*n+l*i,t[5]=o*n+c*i,t[6]=a*n+d*i,t[7]=s*n+u*i,t[8]=l*n-r*i,t[9]=c*n-o*i,t[10]=d*n-a*i,t[11]=u*n-s*i},h$=(t,e)=>{const i=Math.sin(e),n=Math.cos(e),r=t[0],o=t[1],a=t[2],s=t[3],l=t[8],c=t[9],d=t[10],u=t[11];t[0]=r*n-l*i,t[1]=o*n-c*i,t[2]=a*n-d*i,t[3]=s*n-u*i,t[8]=r*i+l*n,t[9]=o*i+c*n,t[10]=a*i+d*n,t[11]=s*i+u*n},m$=(t,e)=>{const i=Math.sin(e),n=Math.cos(e),r=t[0],o=t[1],a=t[2],s=t[3],l=t[4],c=t[5],d=t[6],u=t[7];t[0]=r*n+l*i,t[1]=o*n+c*i,t[2]=a*n+d*i,t[3]=s*n+u*i,t[4]=l*n-r*i,t[5]=c*n-o*i,t[6]=d*n-a*i,t[7]=u*n-s*i};var Bv=t=>t*Math.PI/180,zu=(t,e)=>Nh()?t.getContext("webgl2",e):t.getContext("webgl",e)||t.getContext("experimental-webgl",e);const Mp=(t,e)=>{const i=t.length;return e>=i?t[e%i]:e<0?t[e%i+i]:t[e]},Ov=(t,e,i,n)=>{const r=ot(i.x-e.x,i.y-e.y),o=ot(n.x-i.x,n.y-i.y),a=ot(e.x-n.x,e.y-n.y),s=ot(t.x-e.x,t.y-e.y),l=ot(t.x-i.x,t.y-i.y),c=ot(t.x-n.x,t.y-n.y),d=ou(r,s),u=ou(o,l),p=ou(a,c);return d<=0&&u<=0&&p<=0},Wv=t=>{if(t.length<3)return[];if((b=>{const w=b.length;for(let S=0;S<w;S++){const C=Is(b[S],Mp(b,S+1));if(ly(C,b,{ignoreIdenticalLines:!0,breakOnIntersection:!0}))return!0}return!1})(t))return[];(b=>{let w,S,C,R,M,D=0;const T=b.length;for(w=0;w<T;w++)S=b[w],C=b[(w+1)%T],R=C.x-S.x,M=(C.y+S.y)/2,D+=R*M;return D})(t)<0&&t.reverse();const e=t.length,i=[...Array(e).keys()],n=[];let r,o,a,s,l,c,d,u,p,h,g,m,f=1024;for(;i.length>3;){if(f<=0)return[];for(f--,r=0;r<i.length;r++)if(a=i[r],s=Mp(i,r-1),l=Mp(i,r+1),c=t[a],d=t[s],u=t[l],p=ot(d.x-c.x,d.y-c.y),h=ot(u.x-c.x,u.y-c.y),!(ou(p,h)<0)){for(g=!0,o=0;o<e;o++)if(o!==a&&o!==s&&o!==l&&(m=t[o],Ov(m,d,c,u))){g=!1;break}if(g){n.push([d,c,u]),i.splice(r,1);break}}}return n.push([t[i[0]],t[i[1]],t[i[2]]]),n},$$=(t,e,i,n,r)=>{const o=no(ot(n.x-i.x,n.y-i.y)),a=no(ot(r.x-n.x,r.y-n.y)),s=no(ot(o.x+a.x,o.y+a.y)),l=ot(-s.y,s.x),c=ot(-o.y,o.x),d=Math.min(1/ru(l,c),5);t[e]=n.x,t[e+1]=n.y,t[e+2]=l.x*d,t[e+3]=l.y*d,t[e+4]=-1,t[e+5]=n.x,t[e+6]=n.y,t[e+7]=l.x*d,t[e+8]=l.y*d,t[e+9]=1},g$=t=>{const e=new Float32Array(8);return e[0]=t[3].x,e[1]=t[3].y,e[2]=t[0].x,e[3]=t[0].y,e[4]=t[2].x,e[5]=t[2].y,e[6]=t[1].x,e[7]=t[1].y,e},f$=(t,e=0,i,n)=>{const r=Bo(t),o=t.x+.5*t.width,a=t.y+.5*t.height;return(i||n)&&Al(r,i,n,o,a),e!==0&&rl(r,e,o,a),r},Xd=(t,e,i,n,r)=>{const o=Math.min(20,Math.max(4,Math.round(n/2)));let a=0,s=0,l=0,c=0,d=0;for(;d<o;d++)a=d/o,s=r*Oo+a*Oo,l=n*Math.cos(s),c=n*Math.sin(s),t.push(ot(e+l,i+c))};let Yd=null;var jh=()=>{if(Yd!==null)return Yd;let t=fn("canvas");const e=zu(t);return Yd=e?e.getParameter(e.MAX_TEXTURE_SIZE):void 0,Kn(t),t=void 0,Yd},Uh=()=>Mr()&&!!window.chrome;const kc=new Float32Array([0,1,0,0,1,1,1,0]),_v=new Float32Array([1,0,0,0,1,1,0,1]),Vv=Mr()&&wa(),y$=[0,0,0,0,1,0,0,0,0],Nv=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],Pp=[0,0,0,0],Hv=[0,0,0,0],x$=(t,e,i,n,r)=>{if(!i||!n)return kc;let o=n.x/i.width,a=n.y/i.height,s=t/i.width/r,l=e/i.height/r;return s-=o,l-=a,new Float32Array([-o,l,-o,-a,s,l,s,-a])};var jv=(t,e={})=>{const{alpha:i=!1}=e,n={width:0,height:0},r={width:0,height:0},o=jh()||1024;let a,s,l;const c=Cp(),d=Cp();let u,p,h,g,m,f,b,w,S,C=0,R=0,M=0,D=1;const T=new Map([]),F=()=>{y.stencilOp(y.KEEP,y.KEEP,y.KEEP),y.stencilFunc(y.ALWAYS,1,255),y.stencilMask(255)},W=Bv(30),B=Math.tan(W/2),y=zu(t,{alpha:i,antialias:!1,premultipliedAlpha:!0,stencil:!0});if(!y)return;y.getExtension("OES_standard_derivatives"),y.disable(y.DEPTH_TEST),y.enable(y.STENCIL_TEST),y.enable(y.BLEND),y.blendFunc(y.ONE,y.ONE_MINUS_SRC_ALPHA),y.pixelStorei(y.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!(!i&&wa())),F();const V=y.createTexture();y.bindTexture(y.TEXTURE_2D,V),y.texImage2D(y.TEXTURE_2D,0,y.RGBA,1,1,0,y.RGBA,y.UNSIGNED_BYTE,new Uint8Array(Pp)),T.set(0,V);const tt=y.createTexture();T.set(2,tt);const k=y.createFramebuffer(),N=y.createTexture();T.set(1,N);const it=y.createFramebuffer(),ut=fc(y,`
##head
##text
void main(){vTexCoord=aTexCoord;gl_Position=uMatrix*aPosition;}`,`
##head
in vec2 vTexCoord;uniform sampler2D uTexture;uniform sampler2D uTextureOverlay;uniform sampler2D uTextureBlend;uniform vec2 uTextureSize;uniform float uOpacity;uniform int uAntialias;uniform vec4 uOverlayColor;uniform mat4 uColorMatrix;uniform vec4 uColorOffset;uniform float uClarityKernel[9];uniform float uClarityKernelWeight;uniform float uColorGamma;uniform float uColorVignette;uniform float uMaskClip;uniform float uMaskOpacity;uniform float uMaskBounds[4];uniform float uMaskCornerRadius[4];uniform float uMaskFeather[8];vec4 applyGamma(vec4 c,float g){c.r=pow(c.r,g);c.g=pow(c.g,g);c.b=pow(c.b,g);return c;}vec4 applyColorMatrix(vec4 c,mat4 m,vec4 o){return(c*m)+(o*c.a);}vec4 applyConvolutionMatrix(vec4 c,float k0,float k1,float k2,float k3,float k4,float k5,float k6,float k7,float k8,float w){vec2 pixel=vec2(1)/uTextureSize;vec4 colorSum=texture(uTexture,vTexCoord-pixel)*k0+texture(uTexture,vTexCoord+pixel*vec2(0.0,-1.0))*k1+texture(uTexture,vTexCoord+pixel*vec2(1.0,-1.0))*k2+texture(uTexture,vTexCoord+pixel*vec2(-1.0,0.0))*k3+texture(uTexture,vTexCoord)*k4+texture(uTexture,vTexCoord+pixel*vec2(1.0,0.0))*k5+texture(uTexture,vTexCoord+pixel*vec2(-1.0,1.0))*k6+texture(uTexture,vTexCoord+pixel*vec2(0.0,1.0))*k7+texture(uTexture,vTexCoord+pixel)*k8;vec4 color=vec4(clamp((colorSum/w),0.0,1.0).rgb,c.a);return color;}vec4 applyVignette(vec4 c,vec2 pos,vec2 center,float v){float d=distance(pos,center)/length(center);float f=1.0-(d*abs(v));if(v>0.0){c.rgb*=f;}else if(v<0.0){c.rgb+=(1.0-f)*(1.0-c.rgb);}return c;}vec4 blendPremultipliedAlpha(vec4 back,vec4 front){return front+(back*(1.0-front.a));}void main(){float x=gl_FragCoord.x;float y=gl_FragCoord.y;float a=1.0;float maskTop=uMaskBounds[0];float maskRight=uMaskBounds[1];float maskBottom=uMaskBounds[2];float maskLeft=uMaskBounds[3];float leftFeatherOpacity=step(uMaskFeather[1],x)*uMaskFeather[0]+((1.0-uMaskFeather[0])*smoothstep(uMaskFeather[1],uMaskFeather[3],x));float rightFeatherOpacity=(1.0-step(uMaskFeather[7],x))*uMaskFeather[4]+((1.0-uMaskFeather[4])*smoothstep(uMaskFeather[7],uMaskFeather[5],x));a*=leftFeatherOpacity*rightFeatherOpacity;float overlayColorAlpha=(smoothstep(maskLeft,maskLeft+1.0,x)*(1.0-smoothstep(maskRight-1.0,maskRight,x))*(1.0-step(maskTop,y))*step(maskBottom,y));if(uOverlayColor.a==0.0){a*=overlayColorAlpha;}vec2 offset=vec2(maskLeft,maskBottom);vec2 size=vec2(maskRight-maskLeft,maskTop-maskBottom)*.5;vec2 center=offset.xy+size.xy;int pixelX=int(step(center.x,x));int pixelY=int(step(y,center.y));float cornerRadius=0.0;if(pixelX==0&&pixelY==0)cornerRadius=uMaskCornerRadius[0];if(pixelX==1&&pixelY==0)cornerRadius=uMaskCornerRadius[1];if(pixelX==0&&pixelY==1)cornerRadius=uMaskCornerRadius[2];if(pixelX==1&&pixelY==1)cornerRadius=uMaskCornerRadius[3];float cornerOffset=sign(cornerRadius)*length(max(abs(gl_FragCoord.xy-size-offset)-size+cornerRadius,0.0))-cornerRadius;float cornerOpacity=1.0-smoothstep(0.0,1.0,cornerOffset);a*=cornerOpacity;if(uAntialias==1){vec2 scaledPoint=vec2(vTexCoord.x*uTextureSize.x,vTexCoord.y*uTextureSize.y);a*=smoothstep(0.0,1.0,uTextureSize.x-scaledPoint.x);a*=smoothstep(0.0,1.0,uTextureSize.y-scaledPoint.y);a*=smoothstep(0.0,1.0,scaledPoint.x);a*=smoothstep(0.0,1.0,scaledPoint.y);}vec4 color=texture(uTexture,vTexCoord);if(uClarityKernelWeight!=-1.0){color=applyConvolutionMatrix(color,uClarityKernel[0],uClarityKernel[1],uClarityKernel[2],uClarityKernel[3],uClarityKernel[4],uClarityKernel[5],uClarityKernel[6],uClarityKernel[7],uClarityKernel[8],uClarityKernelWeight);}color=blendPremultipliedAlpha(color,texture(uTextureBlend,vTexCoord));color=applyGamma(color,uColorGamma);color=applyColorMatrix(color,uColorMatrix,uColorOffset);color*=a;if(uColorVignette!=0.0){vec2 pos=gl_FragCoord.xy-offset;color=applyVignette(color,pos,center-offset,uColorVignette);}color=blendPremultipliedAlpha(color,texture(uTextureOverlay,vTexCoord));if(overlayColorAlpha<=0.0){color*=1.0-uOverlayColor.a;}color*=uOpacity;fragColor=color;}`,["aPosition","aTexCoord"],["uMatrix","uTexture","uTextureBlend","uTextureOverlay","uTextureSize","uColorGamma","uColorVignette","uColorOffset","uColorMatrix","uClarityKernel","uClarityKernelWeight","uOpacity","uMaskOpacity","uMaskBounds","uMaskCornerRadius","uMaskFeather","uOverlayColor","uAntialias"]),st=y.createBuffer(),mt=y.createBuffer();y.bindBuffer(y.ARRAY_BUFFER,mt),y.bufferData(y.ARRAY_BUFFER,kc,y.STATIC_DRAW);const G=y.createBuffer();y.bindBuffer(y.ARRAY_BUFFER,G),y.bufferData(y.ARRAY_BUFFER,_v,y.STATIC_DRAW);const gt=fc(y,`#version 300 es

in vec4 aPosition;in vec2 aNormal;in float aMiter;out vec2 vNormal;out float vMiter;out float vWidth;uniform float uWidth;uniform float uSharpness;uniform mat4 uMatrix;void main(){vMiter=aMiter;vNormal=aNormal;vWidth=(uWidth*.5)+uSharpness;gl_Position=uMatrix*vec4(aPosition.x+(aNormal.x*vWidth*aMiter),aPosition.y+(aNormal.y*vWidth*aMiter),0,1);}`,`
##head
##mask
in vec2 vNormal;in float vMiter;in float vWidth;uniform float uWidth;uniform vec4 uColor;uniform vec4 uCanvasColor;void main(){vec4 fillColor=uColor;float m=mask(gl_FragCoord.x,gl_FragCoord.y,uMaskBounds,uMaskOpacity);if(m<=0.0)discard;fillColor.a*=clamp(smoothstep(vWidth-.5,vWidth-1.0,abs(vMiter)*vWidth),0.0,1.0);fillColor.rgb*=fillColor.a;fillColor.rgb*=m;fillColor.rgb+=(1.0-m)*(uCanvasColor.rgb*fillColor.a);fragColor=fillColor;}`,["aPosition","aNormal","aMiter"],["uColor","uCanvasColor","uMatrix","uWidth","uSharpness","uMaskBounds","uMaskOpacity"]),vt=y.createBuffer();Uh()&&(y.bindBuffer(y.ARRAY_BUFFER,vt),y.bufferData(y.ARRAY_BUFFER,1,y.DYNAMIC_DRAW));const lt=(ct,Jt,de,ee=!1)=>{const{program:be,locations:ve}=gt;y.useProgram(be),y.enableVertexAttribArray(ve.aPosition),y.enableVertexAttribArray(ve.aNormal),y.enableVertexAttribArray(ve.aMiter);const _=((Bt,Ae)=>{let Ee,We,oi,xt=0;const ge=Bt.length,Ue=new Float32Array(10*(Ae?ge+1:ge)),ze=Bt[0],At=Bt[ge-1];for(xt=0;xt<ge;xt++)Ee=Bt[xt-1],We=Bt[xt],oi=Bt[xt+1],Ee||(Ee=Ae?At:ot(We.x+(We.x-oi.x),We.y+(We.y-oi.y))),oi||(oi=Ae?ze:ot(We.x+(We.x-Ee.x),We.y+(We.y-Ee.y))),$$(Ue,10*xt,Ee,We,oi);return Ae&&$$(Ue,10*ge,At,ze,Bt[1]),Ue})(ct,ee),Ce=5*Float32Array.BYTES_PER_ELEMENT,pi=2*Float32Array.BYTES_PER_ELEMENT,we=4*Float32Array.BYTES_PER_ELEMENT;y.uniform1f(ve.uWidth,Jt),y.uniform1f(ve.uSharpness,l),y.uniform4fv(ve.uColor,de),y.uniformMatrix4fv(ve.uMatrix,!1,u),y.uniform4f(ve.uCanvasColor,C,R,M,D),y.uniform1fv(ve.uMaskBounds,b),y.uniform1f(ve.uMaskOpacity,f),y.bindBuffer(y.ARRAY_BUFFER,vt),y.bufferData(y.ARRAY_BUFFER,_,y.STATIC_DRAW),y.vertexAttribPointer(ve.aPosition,2,y.FLOAT,!1,Ce,0),y.vertexAttribPointer(ve.aNormal,2,y.FLOAT,!1,Ce,pi),y.vertexAttribPointer(ve.aMiter,1,y.FLOAT,!1,Ce,we),y.drawArrays(y.TRIANGLE_STRIP,0,_.length/5),y.disableVertexAttribArray(ve.aPosition),y.disableVertexAttribArray(ve.aNormal),y.disableVertexAttribArray(ve.aMiter)},St=fc(y,`
##head
void main(){
##matrix
}`,`
##head
##mask
uniform vec4 uColor;uniform vec4 uCanvasColor;void main(){vec4 fillColor=uColor;
##maskapply
fillColor.rgb*=fillColor.a;fillColor.rgb*=m;fillColor.rgb+=(1.0-m)*(uCanvasColor.rgb*fillColor.a);fragColor=fillColor;}`,["aPosition"],["uColor","uCanvasColor","uMatrix","uMaskBounds","uMaskOpacity"]),J=y.createBuffer(),q=fc(y,`
##head
##text
in vec2 aRectCoord;out vec2 vRectCoord;void main(){vTexCoord=aTexCoord;vRectCoord=aRectCoord;
##matrix
}`,`
##head
##mask
in vec2 vTexCoord;in vec2 vRectCoord;uniform sampler2D uTexture;uniform vec4 uTextureColor;uniform float uTextureOpacity;uniform vec2 uRepeat;uniform vec4 uColor;uniform float uCornerRadius[4];uniform vec2 uSize;uniform vec2 uPosition;uniform vec4 uCanvasColor;uniform int uInverted;uniform float uEdgeFeather;void main(){
##init
##colorize
##rectaa
##cornerradius
##maskfeatherapply
if(uInverted==1)a=1.0-a;
##maskapply
##fragcolor
}`,["aPosition","aTexCoord","aRectCoord"],["uTexture","uColor","uMatrix","uCanvasColor","uTextureColor","uTextureOpacity","uRepeat","uPosition","uSize","uMaskBounds","uMaskOpacity","uMaskFeather","uCornerRadius","uInverted","uEdgeFeather"]),Z=y.createBuffer(),bt=y.createBuffer(),nt=y.createBuffer(),$t=fc(y,`
##head
##text
out vec2 vTexCoordDouble;void main(){vTexCoordDouble=vec2(aTexCoord.x*2.0-1.0,aTexCoord.y*2.0-1.0);vTexCoord=aTexCoord;
##matrix
}`,`
##head
##mask
in vec2 vTexCoord;in vec2 vTexCoordDouble;uniform sampler2D uTexture;uniform float uTextureOpacity;uniform vec2 uRepeat;uniform vec2 uRadius;uniform vec4 uColor;uniform int uInverted;uniform vec4 uCanvasColor;void main(){
##init
float ar=uRadius.x/uRadius.y;vec2 rAA=vec2(uRadius.x-1.0,uRadius.y-(1.0/ar));vec2 scaledPointSq=vec2((vTexCoordDouble.x*uRadius.x)*(vTexCoordDouble.x*uRadius.x),(vTexCoordDouble.y*uRadius.y)*(vTexCoordDouble.y*uRadius.y));float p=(scaledPointSq.x/(uRadius.x*uRadius.x))+(scaledPointSq.y/(uRadius.y*uRadius.y));float pAA=(scaledPointSq.x/(rAA.x*rAA.x))+(scaledPointSq.y/(rAA.y*rAA.y));a=smoothstep(1.0,p/pAA,p);if(uInverted==1)a=1.0-a;
##maskapply
##fragcolor
}`,["aPosition","aTexCoord"],["uTexture","uTextureOpacity","uRepeat","uColor","uCanvasColor","uMatrix","uRadius","uInverted","uMaskBounds","uMaskOpacity"]),Lt=y.createBuffer(),ie=y.createBuffer(),Vt=new Map,te={2:{width:0,height:0},1:{width:0,height:0}},Yt=(ct,Jt,de,ee=1)=>{const be=Math.min(Math.min(4096,o)/de.width,Math.min(4096,o)/de.height,ee),ve=Math.floor(be*de.width),_=Math.floor(be*de.height);Lc(de,te[ct])?y.bindFramebuffer(y.FRAMEBUFFER,Jt):(y.bindTexture(y.TEXTURE_2D,T.get(ct)),y.texImage2D(y.TEXTURE_2D,0,y.RGBA,ve,_,0,y.RGBA,y.UNSIGNED_BYTE,null),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MIN_FILTER,y.LINEAR),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_S,y.CLAMP_TO_EDGE),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_T,y.CLAMP_TO_EDGE),y.bindFramebuffer(y.FRAMEBUFFER,Jt),y.framebufferTexture2D(y.FRAMEBUFFER,y.COLOR_ATTACHMENT0,y.TEXTURE_2D,T.get(ct),0),te[ct]=de);const Ce=de.width*s,pi=de.height*s;var we,Bt;Tp(d,0,Ce,pi,0,-1,1),Js(d,0,pi,0),Bt=1,(we=d)[0]*=Bt,we[1]*=Bt,we[2]*=Bt,we[3]*=Bt,((Ae,Ee)=>{Ae[4]*=Ee,Ae[5]*=Ee,Ae[6]*=Ee,Ae[7]*=Ee})(d,-1),u=d,y.viewport(0,0,ve,_),y.colorMask(!0,!0,!0,!0),y.clearColor(0,0,0,0),y.clear(y.COLOR_BUFFER_BIT),S=[1,0,1,0,1,Math.max(n.width,de.width),1,Math.max(n.width,de.width)]},U=(ct,Jt)=>{const{forceRelease:de=!1}=Jt||{},{src:ee}=Vt.get(ct);ee instanceof HTMLCanvasElement&&(de||ee.dataset.retain||Kn(ee)),Vt.delete(ct),y.deleteTexture(ct)},Tt=ct=>Vt.get(ct).isRotatedVideo;return{drawPath:(ct,Jt=0,de=!1,ee=!1,be,ve,_,Ce,pi)=>{if(ct.length<2)return;const we=ct.map(We=>({x:We.x*s,y:We.y*s})),Bt=be*s;if(Bt>0&&lt(we,Bt,Ks(ve,pi),_),we.length<3||!Ce||Ce[3]===0||!_)return;const Ae=Wv(we),Ee=new Float32Array(6*Ae.length);Ae.forEach(([We,oi,xt],ge)=>{const Ue=6*ge;Ee[Ue+0]=We.x,Ee[Ue+1]=We.y,Ee[Ue+2]=oi.x,Ee[Ue+3]=oi.y,Ee[Ue+4]=xt.x,Ee[Ue+5]=xt.y}),((We,oi)=>{const{program:xt,locations:ge}=St;y.useProgram(xt),y.enableVertexAttribArray(ge.aPosition),y.uniform4fv(ge.uColor,oi),y.uniformMatrix4fv(ge.uMatrix,!1,u),y.uniform1fv(ge.uMaskBounds,b),y.uniform1f(ge.uMaskOpacity,f),y.uniform4f(ge.uCanvasColor,C,R,M,D),y.bindBuffer(y.ARRAY_BUFFER,J),y.bufferData(y.ARRAY_BUFFER,We,y.STATIC_DRAW),y.vertexAttribPointer(ge.aPosition,2,y.FLOAT,!1,0,0),y.drawArrays(y.TRIANGLES,0,We.length/2),y.disableVertexAttribArray(ge.aPosition)})(Ee,Ks(Ce,pi))},drawRect:(ct,Jt=0,de=!1,ee=!1,be,ve,_,Ce,pi,we=!1,Bt,Ae,Ee,We,oi,xt=1/s,ge,Ue)=>{const ze=Ss(Ci(ct),s),At=be.map(Ge=>((Ke,gi)=>Math.floor(rn(Ke,0,Math.min(.5*(gi.width-1),.5*(gi.height-1)))))(Ge||0,ct)).map(Ge=>Ge*s);if(ve||_){const Ge=Ci(ze);Ge.x-=.5,Ge.y-=.5,Ge.width+=1,Ge.height+=1;const Ke=f$(Ge,Jt,de,ee),gi=g$(Ke);let yi;ge&&(yi=Ks(ge),yi[3]===0&&(yi[3]=.001));const Li=Ce&&we?[Ge.width/Ce.width,Ge.height/Ce.height]:[1,1];((Si,X,Zt,H,qt,le=V,Ut,fe=1,Xt=Pp,Le=kc,Je=S,_e=1,dt)=>{const{program:jt,locations:ne}=q;y.useProgram(jt),y.enableVertexAttribArray(ne.aPosition),y.enableVertexAttribArray(ne.aTexCoord),y.enableVertexAttribArray(ne.aRectCoord),y.uniform4fv(ne.uColor,qt),y.uniform2fv(ne.uSize,[X,Zt]),y.uniform2fv(ne.uPosition,[Si[2],Si[3]]),y.uniform2fv(ne.uRepeat,Ut),y.uniform1i(ne.uInverted,dt?1:0),y.uniform1fv(ne.uCornerRadius,H),y.uniform4f(ne.uCanvasColor,C,R,M,D),y.uniform1fv(ne.uMaskFeather,Je.map((Fe,Nt)=>Nt%2==0?Fe:Fe*s)),y.uniform1fv(ne.uMaskBounds,b),y.uniform1f(ne.uMaskOpacity,f),y.uniform1f(ne.uEdgeFeather,Math.max(0,_e)),y.uniformMatrix4fv(ne.uMatrix,!1,u),y.uniform1i(ne.uTexture,4),y.uniform4fv(ne.uTextureColor,Xt),y.uniform1f(ne.uTextureOpacity,fe),y.activeTexture(y.TEXTURE0+4),y.bindTexture(y.TEXTURE_2D,le),y.bindBuffer(y.ARRAY_BUFFER,bt),y.bufferData(y.ARRAY_BUFFER,Le,y.STATIC_DRAW),y.vertexAttribPointer(ne.aTexCoord,2,y.FLOAT,!1,0,0),y.bindBuffer(y.ARRAY_BUFFER,nt),y.bufferData(y.ARRAY_BUFFER,kc,y.STATIC_DRAW),y.vertexAttribPointer(ne.aRectCoord,2,y.FLOAT,!1,0,0),y.bindBuffer(y.ARRAY_BUFFER,Z),y.bufferData(y.ARRAY_BUFFER,Si,y.STATIC_DRAW),y.vertexAttribPointer(ne.aPosition,2,y.FLOAT,!1,0,0),y.drawArrays(y.TRIANGLE_STRIP,0,Si.length/2),y.disableVertexAttribArray(ne.aPosition),y.disableVertexAttribArray(ne.aTexCoord),y.disableVertexAttribArray(ne.aRectCoord)})(gi,Ge.width,Ge.height,At,Ks(ve,We),_,Li,We,yi,Bt?new Float32Array(Bt):x$(Ge.width,Ge.height,Ce,pi,s),oi,xt*s,Ue)}Ae&&(Ae=Math.min(Ae,ze.width,ze.height),lt(((Ge,Ke,gi,yi,Li,Si,X,Zt)=>{const H=[];if(Si.every(qt=>qt===0))H.push(ot(Ge,Ke),ot(Ge+gi,Ke),ot(Ge+gi,Ke+yi),ot(Ge,Ke+yi));else{const[qt,le,Ut,fe]=Si,Xt=Ge,Le=Ge+gi,Je=Ke,_e=Ke+yi;H.push(ot(Xt+qt,Je)),Xd(H,Le-le,Je+le,le,-1),H.push(ot(Le,Je+le)),Xd(H,Le-fe,_e-fe,fe,0),H.push(ot(Le-fe,_e)),Xd(H,Xt+Ut,_e-Ut,Ut,1),H.push(ot(Xt,_e-Ut)),Xd(H,Xt+qt,Je+qt,qt,2)}return(X||Zt)&&Al(H,X,Zt,Ge+.5*gi,Ke+.5*yi),Li&&rl(H,Li,Ge+.5*gi,Ke+.5*yi),H})(ze.x,ze.y,ze.width,ze.height,Jt,At,de,ee),Ae*s,Ks(Ee,We),!0))},drawEllipse:(ct,Jt,de,ee,be,ve,_,Ce,pi,we,Bt,Ae,Ee,We,oi)=>{const xt=Ss(In(ct.x-Jt,ct.y-de,2*Jt,2*de),s);if(_||Ce){const ge=Ci(xt);oi||(ge.x-=.5,ge.y-=.5,ge.width+=1,ge.height+=1);const Ue=f$(ge,ee,be,ve);((ze,At,Ge,Ke,gi=V,yi=kc,Li=1,Si=!1)=>{const{program:X,locations:Zt}=$t;y.useProgram(X),y.enableVertexAttribArray(Zt.aPosition),y.enableVertexAttribArray(Zt.aTexCoord),y.uniformMatrix4fv(Zt.uMatrix,!1,u),y.uniform2fv(Zt.uRadius,[.5*At,.5*Ge]),y.uniform1i(Zt.uInverted,Si?1:0),y.uniform4fv(Zt.uColor,Ke),y.uniform4f(Zt.uCanvasColor,C,R,M,D),y.uniform2fv(Zt.uRepeat,[1,1]),y.uniform1fv(Zt.uMaskBounds,b),y.uniform1f(Zt.uMaskOpacity,f),y.uniform1i(Zt.uTexture,4),y.uniform1f(Zt.uTextureOpacity,Li),y.activeTexture(y.TEXTURE0+4),y.bindTexture(y.TEXTURE_2D,gi),y.bindBuffer(y.ARRAY_BUFFER,ie),y.bufferData(y.ARRAY_BUFFER,yi,y.STATIC_DRAW),y.vertexAttribPointer(Zt.aTexCoord,2,y.FLOAT,!1,0,0),y.bindBuffer(y.ARRAY_BUFFER,Lt),y.bufferData(y.ARRAY_BUFFER,ze,y.STATIC_DRAW),y.vertexAttribPointer(Zt.aPosition,2,y.FLOAT,!1,0,0),y.drawArrays(y.TRIANGLE_STRIP,0,ze.length/2),y.disableVertexAttribArray(Zt.aPosition),y.disableVertexAttribArray(Zt.aTexCoord)})(g$(Ue),ge.width,ge.height,Ks(_,We),Ce,Bt?new Float32Array(Bt):x$(ge.width,ge.height,pi,we,s),We,oi)}Ae&&lt(((ge,Ue,ze,At,Ge,Ke,gi)=>{const yi=.5*Math.abs(ze),Li=.5*Math.abs(At),Si=Math.abs(ze)+Math.abs(At),X=Math.max(20,Math.round(Si/6));return gu(ot(ge+yi,Ue+Li),yi,Li,Ge,Ke,gi,X)})(xt.x,xt.y,xt.width,xt.height,ee,be,ve),Ae*s,Ks(Ee,We),!0)},drawImage:(ct,Jt,de,ee,be,ve,_,Ce,pi,we,Bt=Nv,Ae=1,Ee,We=1,oi=0,xt=w,ge=Hv,Ue=Pp,ze=!1,At=!1,Ge=!0)=>{const Ke=Jt.width*s,gi=Jt.height*s,yi=-.5*Ke,Li=.5*gi,Si=.5*Ke,X=-.5*gi,Zt=new Float32Array([yi,X,0,yi,Li,0,Si,X,0,Si,Li,0]);y.bindBuffer(y.ARRAY_BUFFER,st),y.bufferData(y.ARRAY_BUFFER,Zt,y.STATIC_DRAW);const H=Jt.height/2/B*(n.height/Jt.height)*-1;be*=s,ve*=s,de*=s,ee*=s;const{program:qt,locations:le}=ut,Ut=Cp();((jt,ne,Fe,Nt,K)=>{const Qt=1/Math.tan(ne/2),Gt=1/(Nt-K);jt[0]=Qt/Fe,jt[1]=0,jt[2]=0,jt[3]=0,jt[4]=0,jt[5]=Qt,jt[6]=0,jt[7]=0,jt[8]=0,jt[9]=0,jt[10]=(K+Nt)*Gt,jt[11]=-1,jt[12]=0,jt[13]=0,jt[14]=2*K*Nt*Gt,jt[15]=0})(Ut,W,a,1,2*-H),Js(Ut,be,-ve,H),Js(Ut,de,-ee,0),m$(Ut,-pi),u$(Ut,we),Js(Ut,-de,ee,0),h$(Ut,Ce),p$(Ut,_),y.useProgram(qt),y.enableVertexAttribArray(le.aPosition),y.enableVertexAttribArray(le.aTexCoord),y.uniform1i(le.uTexture,3),y.uniform2f(le.uTextureSize,Jt.width,Jt.height),y.activeTexture(y.TEXTURE0+3),y.bindTexture(y.TEXTURE_2D,ct);const fe=At?1:0,Xt=T.get(fe);y.uniform1i(le.uTextureBlend,fe),y.activeTexture(y.TEXTURE0+fe),y.bindTexture(y.TEXTURE_2D,Xt);const Le=ze?2:0,Je=T.get(Le);y.uniform1i(le.uTextureOverlay,Le),y.activeTexture(y.TEXTURE0+Le),y.bindTexture(y.TEXTURE_2D,Je),y.bindBuffer(y.ARRAY_BUFFER,st),y.vertexAttribPointer(le.aPosition,3,y.FLOAT,!1,0,0);const _e=Vv&&Tt(ct);let dt;y.bindBuffer(y.ARRAY_BUFFER,_e?G:mt),y.vertexAttribPointer(le.aTexCoord,2,y.FLOAT,!1,0,0),y.uniformMatrix4fv(le.uMatrix,!1,Ut),y.uniform4fv(le.uOverlayColor,Ue),!Ee||os(Ee,y$)?(Ee=y$,dt=-1):(dt=Ee.reduce((jt,ne)=>jt+ne,0),dt=dt<=0?1:dt),y.uniform1fv(le.uClarityKernel,Ee),y.uniform1f(le.uClarityKernelWeight,dt),y.uniform1f(le.uColorGamma,1/We),y.uniform1f(le.uColorVignette,oi),y.uniform1i(le.uAntialias,Ge?1:0),y.uniform4f(le.uColorOffset,Bt[4],Bt[9],Bt[14],Bt[19]),y.uniformMatrix4fv(le.uColorMatrix,!1,[Bt[0],Bt[1],Bt[2],Bt[3],Bt[5],Bt[6],Bt[7],Bt[8],Bt[10],Bt[11],Bt[12],Bt[13],Bt[15],Bt[16],Bt[17],Bt[18]]),y.uniform1f(le.uOpacity,Ae),y.uniform1f(le.uMaskOpacity,f),y.uniform1fv(le.uMaskBounds,b),y.uniform1fv(le.uMaskCornerRadius,ge.map(jt=>jt*s)),y.uniform1fv(le.uMaskFeather,xt.map((jt,ne)=>ne%2==0?jt:jt*s)),y.drawArrays(y.TRIANGLE_STRIP,0,4),y.disableVertexAttribArray(le.aPosition),y.disableVertexAttribArray(le.aTexCoord)},textureFilterNearest:y.NEAREST,textureFilterLinear:y.LINEAR,textureClamp:y.CLAMP_TO_EDGE,textureRepeat:y.REPEAT,textureCreate:()=>y.createTexture(),textureUpdate:(ct,Jt,de)=>(Vt.set(ct,{src:Jt,options:de,isRotatedVideo:Jt.nodeName==="VIDEO"&&(Jt.dataset&&Jt.dataset.rotation==90||Jt.dataset.rotation==270)}),Dv(y,ct,Jt,de)),textureGetSize:ct=>{const{src:Jt,options:de}=Vt.get(ct),ee=Fa(Jt);return de.scalar?is(ee,be=>be/de.scalar):ee},textureDelete:U,enablePreviewStencil:()=>{y.stencilOp(y.KEEP,y.KEEP,y.REPLACE),y.stencilFunc(y.ALWAYS,1,255),y.stencilMask(255)},applyPreviewStencil:()=>{y.stencilFunc(y.EQUAL,1,255),y.stencilMask(0)},disablePreviewStencil:F,setCanvasColor(ct){C=ct[0],R=ct[1],M=ct[2],D=i?ct[3]:1,y.clear(y.COLOR_BUFFER_BIT)},resetCanvasMatrix:()=>{Tp(c,0,n.width,n.height,0,-1,1)},updateCanvasMatrix(ct,Jt,de,ee,be){const ve=ct.width,_=ct.height,Ce=n.width*(.5/s),pi=n.height*(.5/s),we={x:Ce+(de.x+Jt.x),y:pi+(de.y+Jt.y)},Bt={x:we.x-Jt.x,y:we.y-Jt.y},Ae=.5*ve,Ee=.5*_;Lr(Bt,be.z,we),lb(Bt,ee,we),Js(c,(Bt.x-Ae)*s,(Bt.y-Ee)*s,0),Js(c,Ae*s,Ee*s,0),m$(c,be.z);const We=be.x>Math.PI/2;p$(c,We?Math.PI:0);const oi=be.y>Math.PI/2;h$(c,oi?Math.PI:0),u$(c,ee),Js(c,-Ae*s,-Ee*s,0)},drawToCanvas(){y.bindFramebuffer(y.FRAMEBUFFER,null),u=c,y.viewport(0,0,y.drawingBufferWidth,y.drawingBufferHeight),y.colorMask(!0,!0,!0,!0),y.clearColor(C,R,M,D),y.clear(y.COLOR_BUFFER_BIT),S=[1,0,1,0,1,n.width,1,n.width]},drawToImageBlendBuffer(ct,Jt){Yt(1,it,ct,Jt)},drawToImageOverlayBuffer(ct,Jt){Yt(2,k,ct,Jt)},enableMask(ct,Jt){const de=ct.x*s,ee=ct.y*s,be=ct.width*s,ve=ct.height*s;m=de,h=m+be,p=n.height-ee,g=n.height-(ee+ve),f=1-Jt,b=[p,h,g,m]},disableMask(){m=0,h=n.width,p=n.height,g=0,f=1,b=[p,h,g,m]},resize:(ct,Jt,de)=>{s=Math.max(1,de),l=s===1?.75:1,r.width=ct,r.height=Jt,n.width=ct*s,n.height=Jt*s,a=Jo(n.width,n.height),t.width=n.width,t.height=n.height,Tp(c,0,n.width,n.height,0,-1,1),w=[1,0,1,0,1,r.width,1,r.width]},release(){Array.from(Vt.keys()).forEach(ct=>U(ct,{forceRelease:!0})),Vt.clear(),T.forEach(ct=>{y.deleteTexture(ct)}),T.clear(),ut.destroy(),gt.destroy(),St.destroy(),q.destroy(),$t.destroy(),t.width=1,t.height=1,t=void 0}}},Uv=(t,e)=>{const{imageData:i,amount:n=1}=t,r=Math.round(2*Math.max(1,n)),o=Math.round(.5*r),a=i.width,s=i.height,l=new Uint8ClampedArray(a*s*4),c=i.data;let d,u,p,h,g,m=0,f=0,b=0;const w=a*s*4-4;for(p=0;p<s;p++)for(d=crypto.getRandomValues(new Uint8ClampedArray(s)),u=0;u<a;u++)h=d[p]/255,f=0,b=0,h<.5&&(f=4*(-o+Math.round(Math.random()*r))),h>.5&&(b=(-o+Math.round(Math.random()*r))*(4*a)),g=Math.min(Math.max(0,m+f+b),w),l[m]=c[g],l[m+1]=c[g+1],l[m+2]=c[g+2],l[m+3]=c[g+3],m+=4;e(null,{data:l,width:i.width,height:i.height})};const Gv=[.0625,.125,.0625,.125,.25,.125,.0625,.125,.0625];function Zv(t){return Math.sqrt(1- --t*t)}function b$(t){return Object.prototype.toString.call(t)==="[object Date]"}function nh(t,e){if(t===e||t!=t)return()=>t;const i=typeof t;if(i!==typeof e||Array.isArray(t)!==Array.isArray(e))throw new Error("Cannot interpolate values of different type");if(Array.isArray(t)){const n=e.map((r,o)=>nh(t[o],r));return r=>n.map(o=>o(r))}if(i==="object"){if(!t||!e)throw new Error("Object cannot be null");if(b$(t)&&b$(e)){t=t.getTime();const o=(e=e.getTime())-t;return a=>new Date(t+a*o)}const n=Object.keys(e),r={};return n.forEach(o=>{r[o]=nh(t[o],e[o])}),o=>{const a={};return n.forEach(s=>{a[s]=r[s](o)}),a}}if(i==="number"){const n=e-t;return r=>t+r*n}throw new Error(`Cannot interpolate ${i} values`)}function Gh(t,e={}){const i=he(t);let n,r=t;function o(a,s){if(t==null)return i.set(t=a),Promise.resolve();r=a;let l=n,c=!1,{delay:d=0,duration:u=400,easing:p=Wy,interpolate:h=nh}=Tn(Tn({},e),s);if(u===0)return l&&(l.abort(),l=null),i.set(t=r),Promise.resolve();const g=Hy()+d;let m;return n=Oh(f=>{if(f<g)return!0;c||(m=h(t,a),typeof u=="function"&&(u=u(t,a)),c=!0),l&&(l.abort(),l=null);const b=f-g;return b>u?(i.set(t=a),!1):(i.set(t=m(p(b/u))),!0)}),n.promise}return{set:o,update:(a,s)=>o(a(r,t),s),subscribe:i.subscribe}}function rh(t,e,i,n){if(typeof i=="number"){const r=n-i,o=(i-e)/(t.dt||1/60),a=(o+(t.opts.stiffness*r-t.opts.damping*o)*t.inv_mass)*t.dt;return Math.abs(a)<t.opts.precision&&Math.abs(r)<t.opts.precision?n:(t.settled=!1,i+a)}if(En(i))return i.map((r,o)=>rh(t,e[o],i[o],n[o]));if(typeof i=="object"){const r={};for(const o in i)r[o]=rh(t,e[o],i[o],n[o]);return r}throw new Error(`Cannot spring ${typeof i} values`)}function di(t,e={}){const i=he(t),{stiffness:n=.15,damping:r=.8,precision:o=.01}=e;let a,s,l,c=t,d=t,u=1,p=0,h=!1;function g(f,b={}){d=f;const w=l={};if(t==null||b.hard||m.stiffness>=1&&m.damping>=1)return h=!0,a=null,c=f,i.set(t=d),Promise.resolve();if(b.soft&&(p=1/(60*(b.soft===!0?.5:+b.soft)),u=0),!s){a=null,h=!1;const S={inv_mass:void 0,opts:m,settled:!0,dt:void 0};s=Oh(C=>{if(a===null&&(a=C),h)return h=!1,s=null,!1;u=Math.min(u+p,1),S.inv_mass=u,S.opts=m,S.settled=!0,S.dt=60*(C-a)/1e3;const R=rh(S,c,t,d);return a=C,c=t,i.set(t=R),S.settled&&(s=null),!S.settled})}return new Promise(S=>{s.promise.then(()=>{w===l&&S()})})}const m={set:g,update:(f,b)=>g(f(d,t),b),subscribe:i.subscribe,stiffness:n,damping:r,precision:o};return m}var Xv=Rl(!1,t=>{const e=window.matchMedia("(prefers-reduced-motion:reduce)"),i=()=>t(e.matches);return i(),e.addListener(i),()=>e.removeListener(i)}),v$=()=>"ResizeObserver"in window;const Rp=ws(),y2=(t,e,i,n,r)=>{t.rect||(t.rect=ws());const o=t.rect;oy(Rp,e,i,n,r),ea(o,Rp)||(Ru(o,Rp),t.dispatchEvent(new CustomEvent("measure",{detail:o})))},qd=Math.round,Yv=t=>{const e=t.getBoundingClientRect();xa&&y2(t,qd(e.x),qd(e.y),qd(e.width),qd(e.height))},Ip=t=>{xa&&y2(t,t.offsetLeft,t.offsetTop,t.offsetWidth,t.offsetHeight)},Ic=[];let Qs,ya,xa;function oh(){Ic.length?(Ic.forEach(t=>t.measure(t)),xa=requestAnimationFrame(oh)):xa=void 0}let Kd=new Map([]),yc=0,Ep=0;var xr=(t,e={})=>{const{observePosition:i=!1,observeViewRect:n=!1,once:r=!1,disabled:o=!1,isMeasureRoot:a=!1}=e;if(v$()&&a&&(ya||(ya=new ResizeObserver(s=>{s.forEach(c=>{Kd.set(c.target,c.contentRect)});const l=Array.from(Kd.values()).some(({width:c,height:d})=>c>0&&d>0);l?l&&xa===!1&&oh():(xa&&cancelAnimationFrame(xa),xa=!1)})),ya.observe(t),yc++),!o)return!v$()||i||n?(t.measure=n?Yv:Ip,Ic.push(t),xa===void 0&&(xa=requestAnimationFrame(oh)),t.measure(t),{destroy(){a&&ya&&(Kd.delete(t),ya.unobserve(t),yc--,yc===0&&(ya.disconnect(),ya=void 0));const s=Ic.indexOf(t);Ic.splice(s,1),delete t.measure}}):(Qs||(Qs=new ResizeObserver(s=>{s.forEach(l=>{xa&&Ip(l.target)})})),Qs.observe(t),Ip(t),r?Qs.unobserve(t):Ep++,{destroy(){a&&ya&&(Kd.delete(t),ya.unobserve(t),yc--,yc===0&&(ya.disconnect(),ya=void 0)),r||(Qs.unobserve(t),Ep--,Ep===0&&(Qs.disconnect(),Qs=void 0))}})},qv=t=>{let e=!1;const i={pointerdown:()=>{e=!1},keydown:()=>{e=!0},keyup:()=>{e=!1},focus:n=>{e&&(n.target.dataset.focusVisible="")},blur:n=>{delete n.target.dataset.focusVisible}};return Object.keys(i).forEach(n=>t.addEventListener(n,i[n],!0)),{destroy(){Object.keys(i).forEach(n=>t.removeEventListener(n,i[n],!0))}}};const Kv=async t=>new Promise(e=>{if(t.kind==="file")return e(t.getAsFile());t.getAsString(e)});var x2=(t,e={})=>{const i=r=>{r.preventDefault()},n=async r=>{r.preventDefault(),r.stopPropagation();try{const o=await(a=>new Promise((s,l)=>{const{items:c}=a.dataTransfer;if(!c)return s([]);Promise.all(Array.from(c).map(Kv)).then(d=>{s(d.filter(u=>Ol(u)&&Iu(u)||/^http/.test(u)))}).catch(l)}))(r);t.dispatchEvent(new CustomEvent("dropfiles",{detail:{event:r,resources:o},...e}))}catch{}};return t.addEventListener("drop",n),t.addEventListener("dragover",i),{destroy(){t.removeEventListener("drop",n),t.removeEventListener("dragover",i)}}};let Jd=null;var Zh=()=>{if(Jd===null)if(Mr()){const t=fn("canvas");Jd=!zu(t,{failIfMajorPerformanceCaveat:!0}),Kn(t)}else Jd=!1;return Jd},Ap=t=>t instanceof WebGLTexture,w$=([t,e,i,n])=>[n.x,n.y,t.x,t.y,i.x,i.y,e.x,e.y];function Jv(t){let e,i,n,r;return{c(){e=ht("div"),i=ht("canvas"),v(e,"class","PinturaCanvas")},m(o,a){et(o,e,a),kt(e,i),t[37](i),n||(r=[Pt(i,"measure",t[38]),Xi(xr.call(null,i))],n=!0)},p:ii,i:ii,o:ii,d(o){o&&Q(e),t[37](null),n=!1,Ui(r)}}}function Qv(t,e,i){let n,r,o,a,s,l,c;const d=[0,0,0,0],u=ln(),p=Mr()&&(X=>{const Zt=.5*X,H=fn("canvas",{"data-retain":!0,width:X,height:X}),qt=H.getContext("2d");return qt.fillStyle="#f0f",qt.fillRect(0,0,Zt,Zt),qt.fillRect(Zt,Zt,Zt,Zt),H})(128),h=Sa();let g,{isAnimated:m}=e,{isTransparent:f}=e,{maskRect:b}=e,{maskOpacity:w=1}=e,{maskFrameOpacity:S=.95}=e,{maskMarkupOpacity:C=1}=e,{clipAnnotationsToImage:R=!0}=e,{pixelRatio:M=1}=e,{textPixelRatio:D=M}=e,{backgroundColor:T}=e,{willRender:F=Ji}=e,{didRender:W=Ji}=e,{willRequest:B}=e,{csp:y}=e,{loadImageData:V=Ji}=e,{enableGrid:tt=!1}=e,{gridColors:k}=e,{gridSize:N}=e,{gridOpacity:it=0}=e,{images:ut=[]}=e,{interfaceImages:st=[]}=e,{selectionColor:mt}=e,G=null,gt=null,vt=null;const lt=(X,Zt)=>X.set(Zt,{hard:!m}),St={precision:1e-4*.01};let J=0;const q=Gh(void 0,{duration:0});E(t,q,X=>i(36,c=X));const Z=di(1,St);E(t,Z,X=>i(35,s=X));const bt=di(1,St);E(t,bt,X=>i(51,o=X));const nt=he();E(t,nt,X=>i(53,l=X));const $t=he();E(t,$t,X=>i(52,a=X));const Lt={},ie=(X,Zt)=>{let H=Lt[X.id];const qt=Math.min(1,2048/Zt.width);let le=H?H.element:fn("canvas",{width:Zt.width*qt,height:Zt.height*qt,"data-retain":!0});if(!H||((Ut,fe)=>{if(Ut.total!==fe.length)return!0;const Xt=Ut.last,Le=fe[fe.length-1];return Xt.drawMode!==Le.drawMode||!(!vo(Xt)||vo(Le)&&ea(Xt,Le))||!(!qn(Xt)||qn(Le)&&Xt.x===Le.x&&Xt.y===Le.y&&Xt.rx===Le.rx&&Xt.ry===Le.ry)||!(!On(Xt)||On(Le)&&Le.points.length===Xt.points.length)})(H,X.actions)){le=le.cloneNode(),((fe,Xt,Le)=>{const{selectionColor:Je=[1,1,1],scalar:_e=1}=Le||{};let dt=!1;for(const jt of Xt){const ne=jt.drawMode==="subtract";if(ne&&!dt)continue;fe.globalCompositeOperation=ne?"destination-out":"source-over",fe.save(),fe.beginPath();const Fe=zy(jt);yy(fe,_e,_e),Mh(fe,jt.rotation,Fe),Dy(fe,jt.flipX,jt.flipY,Fe),jt.width?Lh(fe,{...jt,backgroundColor:Je}):jt.points?Qp(fe,Object.assign({},jt,jt.pathClose?{backgroundColor:Je,strokeColor:[0,0,0,0]}:{strokeColor:Je,strokeJoin:"round",strokeCap:"round"})):jt.rx&&zh(fe,{...jt,backgroundColor:Je,strokeColor:[0,0,0,0],strokeJoin:"round",strokeCap:"round"}),fe.restore(),dt=!0}})(le.getContext("2d"),X.actions,{selectionColor:[1,0,1],scalar:qt});const Ut=X.actions.length;Lt[X.id]={total:Ut,last:{...X.actions[Ut-1]},element:le}}return{x:0,y:0,...Zt,fillColor:X.color||[1,1,1],backgroundImage:le}};let Vt;const te=()=>{cancelAnimationFrame(Vt),Vt=requestAnimationFrame(()=>{oi=!0,Li=0,r()})},Yt=new Map([]),U=new Map([]),Tt=(X,Zt)=>({filterParam:X==="pixelated"?G.textureFilterNearest:G.textureFilterLinear,wrapParam:Zt==="repeat"?G.textureRepeat:G.textureClamp}),ct=(X,Zt,H)=>{if(!Yt.has(X)){Yt.set(X,X);const Ut=Tt(Zt,H);if(!Ve(qt=X)&&(gy(qt)||Fl(qt)||jc(qt)||yu(qt))){const fe=G.textureCreate();G.textureUpdate(fe,X,Ut),Yt.set(X,fe)}else V(X).then(fe=>{if(!G||!fe)return;const Xt=G.textureCreate();G.textureUpdate(Xt,fe,Ut),Yt.set(X,Xt),te()}).catch(fe=>{Yt.set(X,fe)})}var qt,le;if(yu(X)&&((le=X).currentTime>0&&!le.paused&&!le.ended&&le.readyState>2||X.dataset.redraw==="true")){const Ut=Yt.get(X),fe=Tt(Zt,H);return G.textureUpdate(Ut,X,fe),X.dataset.redraw=!1,Ut}return Yt.get(X)},Jt=(X,Zt={})=>{const H=Zt.id||X.id;if(X.width&&X.width<1||X.height&&X.height<1||!X.text.length)return void U.delete(H);let{text:qt,textAlign:le,fontFamily:Ut,fontSize:fe=16,fontWeight:Xt,fontVariant:Le,fontStyle:Je,letterSpacing:_e,lineHeight:dt=fe,width:jt,height:ne}=X,{outline:Fe=0,blur:Nt=0,paddingTop:K=0,paddingRight:Qt=0,paddingBottom:Gt=0,paddingLeft:oe=0}=Zt;jt=ui(jt)?Math.floor(jt):jt,ne=ui(ne)?Math.floor(ne):ne;const{textSize:He,signature:Ne}=((De="",ce)=>{let{width:Ye=0,height:Me="auto",fontSize:Ze,fontFamily:Ni,lineHeight:ue,fontWeight:Se,fontStyle:dn,fontVariant:bn,letterSpacing:vn}=ce;const Nn=su({text:De,fontFamily:Ni,fontWeight:Se,fontStyle:dn,fontVariant:bn,fontSize:Ze,lineHeight:ue,letterSpacing:vn,width:Ye,height:Me});let Hn=Pm.get(Nn);if(Hn)return Hn;let dr=1;Ze>1e3&&wa()&&(dr=Ze/1e3,Ze=1e3,ue*=dr);const oo=kh(fn("pre",{contenteditable:"true",spellcheck:"false",style:`${Sy}${Rh({fontFamily:Ni,fontWeight:Se,fontStyle:dn,fontVariant:bn,fontSize:Ze,letterSpacing:vn,lineHeight:ue})};${Ih(De,ce)}"`,innerHTML:De})),Pn=oo.getBoundingClientRect();return Hn={signature:wy(oo).flat().map(br=>br.text).join("_;_"),textSize:is(Fa(Pn),br=>Math.ceil(br*dr))},Pm.set(Nn,Hn),oo.remove(),Hn})(qt,{...X,width:jt,height:void 0}),Te=su({text:qt,textAlign:le,fontFamily:Ut,fontSize:fe,fontWeight:Xt,fontVariant:Le,fontStyle:Je,lineHeight:dt,letterSpacing:_e,outline:Fe,blur:Nt,signature:Ne});if(!Yt.has(Te)){Yt.set(Te,qt);const De=Math.ceil(He.width),ce=Math.ceil(He.height);if(De===0||ce===0)return;const Ye=jh(),Me=Math.min(1,(Ye-(oe+Qt)*D)/(De*D),(Ye-(K+Gt)*D)/(ce*D));Cy(qt,{fontSize:fe,fontFamily:Ut,fontWeight:Xt,fontVariant:Le,fontStyle:Je,letterSpacing:_e,textAlign:le,lineHeight:dt,width:jt,height:ne,imageWidth:De,imageHeight:ce,paddingLeft:oe,paddingTop:K,paddingRight:Qt,paddingBottom:Gt,pixelRatio:D*Me,willRequest:B,outline:Fe,blur:Nt,styleNonce:y.styleNonce,color:[1,0,1]}).then(Ze=>{if(!G)return;const Ni=G.textureCreate();G.textureUpdate(Ni,Ze,{filterParam:G.textureFilterLinear,wrapParam:G.textureClamp,scalar:Me}),Yt.set(Te,Ni),U.set(H,Ni),te()}).catch(console.error)}const Qe=Yt.get(Te);return Ap(Qe)?Qe:U.get(H)},de=new Map,ee=X=>{let Zt;return X.backgroundImage?Zt=ct(X.backgroundImage,X.backgroundImageRendering,X.backgroundRepeat==="repeat"?"repeat":void 0):X.bitmap&&X.points&&(Zt=(H=>{const{id:qt,points:le,strokeWidth:Ut,strokeCap:fe,strokeJoin:Xt,strokeColor:Le}=H;let Je=Yt.get(qt),_e=de.get(qt);const dt=su({points:le.map(He=>`${He.x},${He.y}`).join(","),strokeWidth:Ut,strokeCap:fe,strokeJoin:Xt,strokeColor:Le});if(_e){const{hash:He}=_e;if(Yt.has(qt)){if(dt===He)return Yt.get(qt)}else _e=void 0}if(!_e){const He=fn("canvas",{width:1,height:1});_e={canvas:He,hash:void 0},de.set(H.id,_e),Je=G.textureCreate(),G.textureUpdate(Je,He,{filterParam:G.textureFilterLinear,wrapParam:G.textureClamp}),Yt.set(qt,Je)}const{canvas:jt}=_e,ne=Math.ceil(H.strokeWidth),Fe=nr(le),Nt=Math.floor(Fe.x)-.5*ne,K=Math.floor(Fe.y)-.5*ne,Qt=Math.ceil(Fe.width+ne),Gt=Math.ceil(Fe.height+ne);jt.width=Math.max(Qt,1),jt.height=Math.max(Gt,1);const oe=jt.getContext("2d");return oe.clearRect(0,0,jt.width,jt.height),Qt>=1&&Gt>=1&&(oe.translate(-Nt,-K),Qp(oe,H),oe.resetTransform()),G.textureUpdate(Je,jt,{filterParam:G.textureFilterLinear,wrapParam:G.textureClamp}),de.set(qt,{canvas:jt,hash:dt}),Yt.get(qt)})(X)),Zt},be=({texture:X,size:Zt,origin:H,translation:qt,rotation:le,scale:Ut,colorMatrix:fe,opacity:Xt,convolutionMatrix:Le,gamma:Je,vignette:_e,maskFeather:dt,maskCornerRadius:jt,overlayColor:ne,enableOverlay:Fe,enableManipulation:Nt,enableAntialiasing:K})=>{let Qt=0,Gt=0;if(M===1){const oe=Math.abs(1-Ut)<Number.EPSILON;Qt=oe&&gt%2!=0?.5:0,Gt=oe&&vt%2!=0?.5:0}return G.drawImage(X,Zt,H.x,H.y,qt.x+Qt,qt.y+Gt,le.x,le.y,le.z,Ut,fe,rn(Xt,0,1),Le,Je,_e,dt,jt,ne,Fe,Nt,K),X},ve=(X,Zt,H)=>{const qt=Ti(Zt),le=Ti(X),Ut=qt.x-le.x,fe=qt.y-le.y,Xt=Lr(qt,H,le);return{x:Xt.x-le.x-Ut,y:Xt.y-le.y-fe}},_=(X=[],Zt)=>{X.forEach(H=>{let qt=ee(H);const le=H.status!=="complete"&&(H.status==="loading"||H.backgroundImage&&qt===H.backgroundImage);le&&te();const Ut=H.status==="error"||H.backgroundImage&&qt instanceof Error;let fe=Ap(qt)?qt:void 0;const Xt=H._scale||1,Le=H._translate||u,Je=H.strokeWidth&&H.strokeWidth*Xt,_e=H.cornerRadius?((Nt,K)=>[Nt,Nt,Nt,Nt].map(Qt=>Qt*K))(H.cornerRadius,Xt):d,dt=!!H.width,jt=Ve(H.text),ne=En(H.points),Fe=qn(H);if(ne){const Nt=H.points.map(K=>ot(K.x*Xt+Le.x,K.y*Xt+Le.y));if(H.bitmap){qt&&Zt.push(qt);const K=nr(Nt),Qt=Math.ceil(H.strokeWidth*Xt);G.drawRect({x:Math.floor(K.x)-.5*Qt,y:Math.floor(K.y)-.5*Qt,width:Math.ceil(K.width+Qt),height:Math.ceil(K.height+Qt)},H.rotation,H.flipX,H.flipY,[0,0,0,0],void 0,fe,void 0,void 0,void 0,void 0,void 0,void 0,H.opacity,void 0,void 0,!1,!1)}else G.drawPath(Nt,H.rotation,H.flipX,H.flipY,Je,H.strokeColor,H.pathClose,H.backgroundColor,H.opacity)}else if(Fe){let Nt=H.x,K=H.y;Nt*=Xt,K*=Xt,Nt+=Le.x,K+=Le.y;const Qt=ot(Nt,K);G.drawEllipse(Qt,H.rx*Xt,H.ry*Xt,H.rotation,H.flipX,H.flipY,H.backgroundColor,fe,void 0,void 0,H.backgroundCorners&&w$(H.backgroundCorners),Je,H.strokeColor,H.opacity,H.inverted),qt&&Zt.push(qt),(le||Ut)&&(H.backgroundColor||H.strokeColor&&H.strokeWidth||G.drawEllipse(Qt,H.rx*Xt,H.ry*Xt,H.rotation,H.flipX,H.flipY,Ut?[1,0,0,.25*H.opacity]:[0,0,0,.25*H.opacity]),Ut&&Ee(Qt),le&&Ae(Qt))}else if(jt){const Nt=H.fontSize>1e3&&wa()?H.fontSize/1e3:1,K=Math.max(16,Math.ceil(H.fontSize/Nt*.25)),Qt=Math.abs(H.rotation)>0,Gt=zo(H.text,H),oe={x:H.x*Xt+Le.x,y:H.y*Xt+Le.y,width:Gt.width*Xt,height:Gt.height*Xt};(H.backgroundColor||H.strokeColor)&&G.drawRect(oe,H.rotation,H.flipX,H.flipY,_e,H.backgroundColor,void 0,void 0,void 0,!1,void 0,Je,H.strokeColor,H.opacity,void 0,void 0,void 0,H.inverted);const{textShadowX:He,textShadowY:Ne,textShadowBlur:Te}=H;if(He||Ne||Te){const De=Math.ceil(.5*Te),ce=Math.max(K,De),Ye=Jt(H,{id:H.id+"shadow",blur:Te,paddingTop:ce,paddingRight:ce,paddingBottom:ce,paddingLeft:ce});if(Ye&&!H._prerender){Zt.push(Ye);const Me=G.textureGetSize(Ye),Ze={x:0,y:0},Ni={width:Me.width/D*Xt,height:Me.height/D*Xt},ue=K*Xt/Nt,Se={x:H.x*Xt+Le.x-ue,y:H.y*Xt+Le.y-ue,width:Ni.width,height:H.height?Gt.height+ue-Ne:Ni.height};if(Qt){const dn=ve(oe,Se,H.rotation);Se.x+=dn.x,Se.y+=dn.y;const bn=Lr(ot(He,Ne),H.rotation);Se.x+=bn.x,Se.y+=bn.y}else Se.x+=He,Se.y+=Ne;G.drawRect(Se,H.rotation,H.flipX,H.flipY,[0,0,0,0],void 0,Ye,Ni,Ze,!1,void 0,void 0,void 0,H.opacity,void 0,0,H.textShadowColor)}}if(H.textOutlineWidth){const De=Math.ceil(.5*H.textOutlineWidth),ce=K+De,Ye=Jt(H,{id:H.id+"outline",outline:H.textOutlineWidth,paddingTop:ce,paddingRight:ce,paddingBottom:ce,paddingLeft:ce});if(Ye&&!H._prerender){Zt.push(Ye);const Me=G.textureGetSize(Ye),Ze={x:0,y:0},Ni={width:Me.width/D*Xt,height:Me.height/D*Xt},ue=(K+De)*Xt/Nt,Se={x:H.x*Xt+Le.x-ue,y:H.y*Xt+Le.y-ue,width:Ni.width,height:H.height?Gt.height+ue:Ni.height};if(Qt){const dn=ve(oe,Se,H.rotation);Se.x+=dn.x,Se.y+=dn.y}G.drawRect(Se,H.rotation,H.flipX,H.flipY,[0,0,0,0],void 0,Ye,Ni,Ze,!1,void 0,void 0,void 0,H.opacity,void 0,0,H.textOutlineColor)}}const Qe=Jt(H,{id:H.id+"text",paddingTop:K,paddingRight:K,paddingBottom:K,paddingLeft:K});if(Qe&&!H._prerender){Zt.push(Qe);const De=G.textureGetSize(Qe),ce={x:0,y:0},Ye={width:De.width/D*Xt,height:De.height/D*Xt},Me=K*Xt/Nt,Ze={x:H.x*Xt+Le.x-Me,y:H.y*Xt+Le.y-Me,width:Ye.width,height:H.height?Gt.height+Me:Ye.height};if(Qt){const ue=ve(oe,Ze,H.rotation);Ze.x+=ue.x,Ze.y+=ue.y}const Ni=H.color||[0,0,0];H._prerender&&(Ni[3]=0),G.drawRect(Ze,H.rotation,H.flipX,H.flipY,d,!1,Qe,Ye,ce,!1,!1,void 0,void 0,H.opacity,void 0,H.feather,Ni,H.inverted)}}else if(dt){qt&&Zt.push(qt);const Nt=fs(H);let K,Qt;Xt&&Le&&(Nt.x*=Xt,Nt.y*=Xt,Nt.x+=Le.x,Nt.y+=Le.y,Nt.width*=Xt,Nt.height*=Xt);const{backgroundRepeat:Gt="no-repeat"}=H,oe=fe&&G.textureGetSize(fe);if(oe&&H.backgroundImage&&(H.backgroundSize||H.backgroundPosition||H.backgroundRepeat)){const He=Jo(oe.width,oe.height);if(H.backgroundRepeat==="repeat"&&(K={...oe},Qt={x:0,y:0}),H.backgroundSize==="contain"){const Ne=Ur(Nt,He,Nt);K=ol(Ne),Qt=H.backgroundPosition?H.backgroundPosition:ot(.5*(Nt.width-K.width),.5*(Nt.height-K.height))}else if(H.backgroundSize==="cover"){const Ne=rs(Nt,He,Nt);K=ol(Ne),H.backgroundPosition?Qt=H.backgroundPosition:(Qt=ot(Ne.x,Ne.y),Qt=ot(.5*(Nt.width-K.width),.5*(Nt.height-K.height)))}else H.backgroundSize?(K=H.backgroundSize,Qt=H.backgroundPosition||{x:0,y:0}):H.backgroundPosition&&(K={...oe},Qt=H.backgroundPosition)}if(G.drawRect(Nt,H.rotation,H.flipX,H.flipY,_e,H.backgroundColor,fe,K,Qt,Gt==="repeat",H.backgroundCorners&&w$(H.backgroundCorners),Je,H.strokeColor,H.opacity,void 0,H.feather,H.fillColor,H.inverted),le||Ut){H.backgroundColor&&H.backgroundColor[3]!==0||H.strokeColor&&H.strokeWidth||G.drawRect(Nt,H.rotation,H.flipX,H.flipY,_e,Ut?[1,.2549,.2118,.25*H.opacity]:[0,0,0,.25*H.opacity]);const He=Ti(Nt);Ut&&Ee(He),le&&Ae(He)}}else qt&&Zt.push(qt)})};let Ce=0;const pi=[{x:-5,y:-5},{x:5,y:5}],we=[{x:5,y:-5},{x:-5,y:5}],Bt=gu({x:0,y:0},10,10,0,!1,!1,16);Bt.length=9;const Ae=X=>{Ce=Date.now()/50,G.drawEllipse(X,15,15,0,!1,!1,[0,0,0,.5]);const Zt=rl(Bt.map(H=>({x:H.x+X.x,y:H.y+X.y})),Ce,X.x,X.y);G.drawPath(Zt,0,!1,!1,2,[1,1,1])},Ee=X=>{G.drawEllipse(X,13,13,0,!1,!1,[1,.2549,.2118,.75]);const Zt=pi.map(qt=>({x:qt.x+X.x,y:qt.y+X.y})),H=we.map(qt=>({x:qt.x+X.x,y:qt.y+X.y}));G.drawPath(Zt,0,!1,!1,3,[1,1,1]),G.drawPath(H,0,!1,!1,3,[1,1,1])},We=(X,Zt,H,qt,le,Ut)=>G.drawRect(Zt,0,!1,!1,d,d,X,qt,H,!0,void 0,0,void 0,Ut,void 0,void 0,le);let oi=!1,xt=!0,ge=!1;const Ue=[],ze=[],At=[],Ge=X=>!X.aboveFrame,Ke=X=>X.aboveFrame,gi=()=>{At.length=0;const X=ut[0],{manipulationShapes:Zt,manipulationShapesDirty:H,annotationShapes:qt,annotationShapesDirty:le,interfaceShapes:Ut,decorationShapes:fe,frameShapes:Xt,selectionShapes:Le}=F({opacity:X.opacity,rotation:X.rotation,scale:X.scale,images:ut,size:Vn(gt,vt),backgroundColor:[...c],selectionRect:l}),Je=[...c],_e=l,dt=rn(s,0,1),jt=a,ne=Math.abs(X.rotation.x/Math.PI*2-1),Fe=Math.abs(X.rotation.y/Math.PI*2-1),Nt=ne<.99||Fe<.99,K={...X.size},Qt=X.backgroundColor,Gt=X.backgroundImage,oe=Zt.length>0,He=qt.length>0,Ne=qt.filter(Ke).length>0,Te=fe.filter(Ke).length>0,Qe=Qt[3]>0,De=!!R&&C>=1;if(dt<1&&Qe){const ce=Je[0],Ye=Je[1],Me=Je[2],Ze=1-dt,Ni=Qt[0]*Ze,ue=Qt[1]*Ze,Se=Qt[2]*Ze,dn=1-Ze;Je[0]=Ni+ce*dn,Je[1]=ue+Ye*dn,Je[2]=Se+Me*dn,Je[3]=1}if(G.setCanvasColor(f?d:Je),oe&&(H||oi)?(G.disableMask(),G.drawToImageBlendBuffer(K),Ue.length=0,_(Zt,Ue)):oe||(Ue.length=0),At.push(...Ue),xt&&(G.drawToImageOverlayBuffer(K,D),xt=!1),Nt){if(He&&(le||oi)||!ge){G.disableMask(),G.drawToImageOverlayBuffer(K,D),ze.length=0;const ce=Ne?qt.filter(Ge):qt;_(ce,ze)}else He||(ze.length=0);ge=!0}else ge=!1;if(G.drawToCanvas(),G.enableMask(_e,dt),tt&&N>=1&&k.length===2&&it&&((ce,Ye,Me,Ze,Ni)=>{const ue=Vn(Ye,Ye),Se=ct(p,"pixelated","repeat"),dn=ot(-ce.x%Ye,-ce.y%Ye),bn=ot(dn.x+.5*ue.width,dn.y);We(Se,ce,dn,ue,Me,Ni),We(Se,ce,bn,ue,Ze,Ni)})(_e,N,k[0],k[1],it),Qe&&G.drawRect(_e,0,!1,!1,d,Qt),Gt){G.enableMask(_e,1);const ce=Math.max(b.width/Gt.width,b.height/Gt.height),Ye=Gt.width*ce,Me=Gt.height*ce,Ze={x:b.x+.5*b.width-.5*Ye,y:b.y+.5*b.height-.5*Me,width:Ye,height:Me};G.drawRect(Ze,0,!1,!1,d,d,ct(Gt,"linear")),G.enableMask(_e,dt)}if(De&&G.enablePreviewStencil(),At.push(...[...ut].reverse().map(ce=>be({...ce,texture:ct(ce.data),enableOverlay:Nt&&He,enableManipulation:oe,enableAntialiasing:!0,mask:_e,maskOpacity:dt,overlayColor:jt}))),G.enableMask(_e,C),!Nt){De&&G.applyPreviewStencil(),G.resetCanvasMatrix(),G.updateCanvasMatrix(K,X.origin,X.translation,X.scale,X.rotation),ze.length=0;const ce=Ne?qt.filter(Ge):qt;_(ce,ze),De&&G.disablePreviewStencil()}if(At.push(...ze),G.resetCanvasMatrix(),G.enableMask(_e,C),_(Te?fe.filter(Ge):fe,At),Xt.length){G.enableMask(_e,1);const ce=Xt.filter(Me=>!Me.expandsCanvas),Ye=Xt.filter(Me=>Me.expandsCanvas);ce.length&&_(ce,At),Ye.length&&(G.enableMask({x:_e.x+.5,y:_e.y+.5,width:_e.width-1,height:_e.height-1},o),_(Ye,At))}if(Ne&&(G.resetCanvasMatrix(),G.updateCanvasMatrix(K,X.origin,X.translation,X.scale,X.rotation),_(qt.filter(Ke),At),G.resetCanvasMatrix()),Te&&(G.resetCanvasMatrix(),_(fe.filter(Ke),At),G.resetCanvasMatrix()),mt&&Le.length&&!Nt){G.resetCanvasMatrix(),G.updateCanvasMatrix(K,X.origin,X.translation,X.scale,X.rotation);const ce=[...mt];ce[3]=.5;const Ye=[{id:"selection",color:ce,actions:[...Le]}].map(Me=>ie(Me,K));_(Ye,At),G.resetCanvasMatrix()}G.disableMask(),_(Ut,At),st.forEach(ce=>{if(G.enableMask(ce.mask,ce.maskOpacity),ce.backgroundColor){const Me=Gt&&rs({...ce.mask},Gt.width/Gt.height),Ze=Gt&&ct(Gt,"linear");G.drawRect(ce.mask,0,!1,!1,ce.maskCornerRadius,ce.backgroundColor,Ze,Me,Me,void 0,void 0,void 0,void 0,ce.opacity,ce.maskFeather),Ze&&At.push(Ze)}const Ye=be({...ce,texture:ct(ce.data),enableAntialiasing:!1,translation:{x:ce.translation.x+ce.offset.x-.5*gt,y:ce.translation.y+ce.offset.y-.5*vt}});At.push(Ye)}),G.disableMask(),(ce=>{Yt.forEach((Ye,Me)=>{!ce.find(Ze=>Ze===Ye)&&Ap(Ye)&&(Array.from(U.values()).includes(Ye)||(Yt.delete(Me),G.textureDelete(Ye)))})})(At),W(),oi=!1};let yi,Li=0;const Si=()=>{clearTimeout(yi);const X=Date.now();X-Li<48?yi=setTimeout(Si,48):(Li=X,gi())};return tv(()=>r()),Es(()=>i(31,G=jv(g,{alpha:f}))),Wo(()=>{G&&(de.forEach(({canvas:X})=>Kn(X)),de.clear(),G.release(),i(31,G=void 0),i(0,g=void 0))}),t.$$set=X=>{"isAnimated"in X&&i(9,m=X.isAnimated),"isTransparent"in X&&i(10,f=X.isTransparent),"maskRect"in X&&i(11,b=X.maskRect),"maskOpacity"in X&&i(12,w=X.maskOpacity),"maskFrameOpacity"in X&&i(13,S=X.maskFrameOpacity),"maskMarkupOpacity"in X&&i(14,C=X.maskMarkupOpacity),"clipAnnotationsToImage"in X&&i(15,R=X.clipAnnotationsToImage),"pixelRatio"in X&&i(16,M=X.pixelRatio),"textPixelRatio"in X&&i(17,D=X.textPixelRatio),"backgroundColor"in X&&i(18,T=X.backgroundColor),"willRender"in X&&i(19,F=X.willRender),"didRender"in X&&i(20,W=X.didRender),"willRequest"in X&&i(21,B=X.willRequest),"csp"in X&&i(22,y=X.csp),"loadImageData"in X&&i(23,V=X.loadImageData),"enableGrid"in X&&i(24,tt=X.enableGrid),"gridColors"in X&&i(25,k=X.gridColors),"gridSize"in X&&i(26,N=X.gridSize),"gridOpacity"in X&&i(27,it=X.gridOpacity),"images"in X&&i(28,ut=X.images),"interfaceImages"in X&&i(29,st=X.interfaceImages),"selectionColor"in X&&i(30,mt=X.selectionColor)},t.$$.update=()=>{if(1&t.$$.dirty[0]&&g){const X=getComputedStyle(g).getPropertyValue("--color-transition-duration");i(32,J=(Zt=>{let H=parseFloat(Zt);return/^[0-9]+s$/.test(Zt)?1e3*H:H})(X))}262656&t.$$.dirty[0]|2&t.$$.dirty[1]&&T&&q.set(T,{duration:m?J:0}),4096&t.$$.dirty[0]&&lt(Z,ui(w)?w:1),8192&t.$$.dirty[0]&&lt(bt,ui(S)?S:1),2048&t.$$.dirty[0]&&b&&nt.set(b),48&t.$$.dirty[1]&&c&&$t.set([c[0],c[1],c[2],rn(s,0,1)]),268435462&t.$$.dirty[0]|1&t.$$.dirty[1]&&i(34,n=!!(G&&gt&&vt&&ut.length)),65542&t.$$.dirty[0]|1&t.$$.dirty[1]&&gt&&vt&&G&&(Li=0,G.resize(gt,vt,M)),8&t.$$.dirty[1]&&i(33,r=n?Zh()?Si:gi:$e),12&t.$$.dirty[1]&&n&&r&&r()},[g,gt,vt,h,q,Z,bt,nt,$t,m,f,b,w,S,C,R,M,D,T,F,W,B,y,V,tt,k,N,it,ut,st,mt,G,J,r,n,s,c,function(X){Fi[X?"unshift":"push"](()=>{g=X,i(0,g)})},X=>{i(1,gt=X.detail.width),i(2,vt=X.detail.height),h("measure",{width:gt,height:vt})}]}class t4 extends li{constructor(e){super(),si(this,e,Qv,Jv,ri,{isAnimated:9,isTransparent:10,maskRect:11,maskOpacity:12,maskFrameOpacity:13,maskMarkupOpacity:14,clipAnnotationsToImage:15,pixelRatio:16,textPixelRatio:17,backgroundColor:18,willRender:19,didRender:20,willRequest:21,csp:22,loadImageData:23,enableGrid:24,gridColors:25,gridSize:26,gridOpacity:27,images:28,interfaceImages:29,selectionColor:30},null,[-1,-1,-1])}}var $i=(t,e=Boolean,i=" ")=>t.filter(e).join(i);function S$(t,e,i){const n=t.slice();return n[17]=e[i],n}const e4=t=>({tab:4&t}),k$=t=>({tab:t[17]});function C$(t){let e,i,n,r=[],o=new Map,a=t[2];const s=l=>l[17].id;for(let l=0;l<a.length;l+=1){let c=S$(t,a,l),d=s(c);o.set(d,r[l]=T$(d,c))}return{c(){e=ht("ul");for(let l=0;l<r.length;l+=1)r[l].c();v(e,"class",i=$i(["PinturaTabList",t[0]])),v(e,"role","tablist"),v(e,"data-layout",t[1])},m(l,c){et(l,e,c);for(let d=0;d<r.length;d+=1)r[d].m(e,null);t[14](e),n=!0},p(l,c){1124&c&&(a=l[2],Pe(),r=Da(r,c,s,1,l,a,o,e,As,T$,null,S$),Re()),(!n||1&c&&i!==(i=$i(["PinturaTabList",l[0]])))&&v(e,"class",i),(!n||2&c)&&v(e,"data-layout",l[1])},i(l){if(!n){for(let c=0;c<a.length;c+=1)P(r[c]);n=!0}},o(l){for(let c=0;c<r.length;c+=1)z(r[c]);n=!1},d(l){l&&Q(e);for(let c=0;c<r.length;c+=1)r[c].d();t[14](null)}}}function T$(t,e){let i,n,r,o,a,s,l,c,d,u;const p=e[11].default,h=ar(p,e,e[10],k$);function g(...f){return e[12](e[17],...f)}function m(...f){return e[13](e[17],...f)}return{key:t,first:null,c(){i=ht("li"),n=ht("button"),h&&h.c(),o=me(),v(n,"type","button"),n.disabled=r=e[17].disabled,v(i,"role","tab"),v(i,"aria-controls",a=e[17].href.substr(1)),v(i,"id",s=e[17].tabId),v(i,"aria-selected",l=e[17].selected),this.first=i},m(f,b){et(f,i,b),kt(i,n),h&&h.m(n,null),kt(i,o),c=!0,d||(u=[Pt(n,"keydown",g),Pt(n,"click",m)],d=!0)},p(f,b){e=f,h&&h.p&&(!c||1028&b)&&lr(h,p,e,e[10],c?sr(p,e[10],b,e4):cr(e[10]),k$),(!c||4&b&&r!==(r=e[17].disabled))&&(n.disabled=r),(!c||4&b&&a!==(a=e[17].href.substr(1)))&&v(i,"aria-controls",a),(!c||4&b&&s!==(s=e[17].tabId))&&v(i,"id",s),(!c||4&b&&l!==(l=e[17].selected))&&v(i,"aria-selected",l)},i(f){c||(P(h,f),c=!0)},o(f){z(h,f),c=!1},d(f){f&&Q(i),h&&h.d(f),d=!1,Ui(u)}}}function i4(t){let e,i,n=t[4]&&C$(t);return{c(){n&&n.c(),e=Mn()},m(r,o){n&&n.m(r,o),et(r,e,o),i=!0},p(r,[o]){r[4]?n?(n.p(r,o),16&o&&P(n,1)):(n=C$(r),n.c(),P(n,1),n.m(e.parentNode,e)):n&&(Pe(),z(n,1,1,()=>{n=null}),Re())},i(r){i||(P(n),i=!0)},o(r){z(n),i=!1},d(r){n&&n.d(r),r&&Q(e)}}}function n4(t,e,i){let n,r,o,{$$slots:a={},$$scope:s}=e,{class:l}=e,{name:c}=e,{selected:d}=e,{tabs:u=[]}=e,{layout:p}=e;const h=Sa(),g=b=>{const w=o.querySelectorAll('[role="tab"] button')[b];w&&w.focus()},m=(b,w)=>{b.preventDefault(),b.stopPropagation(),h("select",w)},f=({key:b},w)=>{if(!/arrow/i.test(b))return;const S=u.findIndex(C=>C.id===w);return/right|down/i.test(b)?g(S<u.length-1?S+1:0):/left|up/i.test(b)?g(S>0?S-1:u.length-1):void 0};return t.$$set=b=>{"class"in b&&i(0,l=b.class),"name"in b&&i(7,c=b.name),"selected"in b&&i(8,d=b.selected),"tabs"in b&&i(9,u=b.tabs),"layout"in b&&i(1,p=b.layout),"$$scope"in b&&i(10,s=b.$$scope)},t.$$.update=()=>{896&t.$$.dirty&&i(2,n=u.map(b=>{const w=b.id===d;return{...b,tabId:`tab-${c}-${b.id}`,href:`#panel-${c}-${b.id}`,selected:w}})),4&t.$$.dirty&&i(4,r=n.length>1)},[l,p,n,o,r,m,f,c,d,u,s,a,(b,w)=>f(w,b.id),(b,w)=>m(w,b.id),function(b){Fi[b?"unshift":"push"](()=>{o=b,i(3,o)})}]}class Fu extends li{constructor(e){super(),si(this,e,n4,i4,ri,{class:0,name:7,selected:8,tabs:9,layout:1})}}const r4=t=>({panel:16&t}),M$=t=>({panel:t[4][0].id,panelIsActive:!0});function P$(t,e,i){const n=t.slice();return n[14]=e[i].id,n[15]=e[i].shouldDraw,n[16]=e[i].panelId,n[17]=e[i].tabindex,n[18]=e[i].labelledBy,n[19]=e[i].isActive,n[20]=e[i].hidden,n[3]=e[i].visible,n}const o4=t=>({panel:16&t,panelIsActive:16&t}),R$=t=>({panel:t[14],panelIsActive:t[19]});function a4(t){let e,i,n,r,o,a;const s=t[11].default,l=ar(s,t,t[10],M$);return{c(){e=ht("div"),i=ht("div"),l&&l.c(),v(i,"class",n=$i([t[1]])),v(e,"class",t[0]),v(e,"style",t[2])},m(c,d){et(c,e,d),kt(e,i),l&&l.m(i,null),r=!0,o||(a=[Pt(e,"measure",t[13]),Xi(xr.call(null,e))],o=!0)},p(c,d){l&&l.p&&(!r||1040&d)&&lr(l,s,c,c[10],r?sr(s,c[10],d,r4):cr(c[10]),M$),(!r||2&d&&n!==(n=$i([c[1]])))&&v(i,"class",n),(!r||1&d)&&v(e,"class",c[0]),(!r||4&d)&&v(e,"style",c[2])},i(c){r||(P(l,c),r=!0)},o(c){z(l,c),r=!1},d(c){c&&Q(e),l&&l.d(c),o=!1,Ui(a)}}}function s4(t){let e,i,n,r,o,a=[],s=new Map,l=t[4];const c=d=>d[14];for(let d=0;d<l.length;d+=1){let u=P$(t,l,d),p=c(u);s.set(p,a[d]=E$(p,u))}return{c(){e=ht("div");for(let d=0;d<a.length;d+=1)a[d].c();v(e,"class",i=$i(["PinturaTabPanels",t[0]])),v(e,"style",t[2])},m(d,u){et(d,e,u);for(let p=0;p<a.length;p+=1)a[p].m(e,null);n=!0,r||(o=[Pt(e,"measure",t[12]),Xi(xr.call(null,e,{observePosition:!0}))],r=!0)},p(d,u){1042&u&&(l=d[4],Pe(),a=Da(a,u,c,1,d,l,s,e,As,E$,null,P$),Re()),(!n||1&u&&i!==(i=$i(["PinturaTabPanels",d[0]])))&&v(e,"class",i),(!n||4&u)&&v(e,"style",d[2])},i(d){if(!n){for(let u=0;u<l.length;u+=1)P(a[u]);n=!0}},o(d){for(let u=0;u<a.length;u+=1)z(a[u]);n=!1},d(d){d&&Q(e);for(let u=0;u<a.length;u+=1)a[u].d();r=!1,Ui(o)}}}function I$(t){let e;const i=t[11].default,n=ar(i,t,t[10],R$);return{c(){n&&n.c()},m(r,o){n&&n.m(r,o),e=!0},p(r,o){n&&n.p&&(!e||1040&o)&&lr(n,i,r,r[10],e?sr(i,r[10],o,o4):cr(r[10]),R$)},i(r){e||(P(n,r),e=!0)},o(r){z(n,r),e=!1},d(r){n&&n.d(r)}}}function E$(t,e){let i,n,r,o,a,s,l,c,d,u=e[15]&&I$(e);return{key:t,first:null,c(){i=ht("div"),u&&u.c(),n=me(),v(i,"class",r=$i(["PinturaTabPanel",e[1]])),i.hidden=o=e[20],v(i,"id",a=e[16]),v(i,"tabindex",s=e[17]),v(i,"aria-labelledby",l=e[18]),v(i,"data-inert",c=!e[3]),this.first=i},m(p,h){et(p,i,h),u&&u.m(i,null),kt(i,n),d=!0},p(p,h){(e=p)[15]?u?(u.p(e,h),16&h&&P(u,1)):(u=I$(e),u.c(),P(u,1),u.m(i,n)):u&&(Pe(),z(u,1,1,()=>{u=null}),Re()),(!d||2&h&&r!==(r=$i(["PinturaTabPanel",e[1]])))&&v(i,"class",r),(!d||16&h&&o!==(o=e[20]))&&(i.hidden=o),(!d||16&h&&a!==(a=e[16]))&&v(i,"id",a),(!d||16&h&&s!==(s=e[17]))&&v(i,"tabindex",s),(!d||16&h&&l!==(l=e[18]))&&v(i,"aria-labelledby",l),(!d||16&h&&c!==(c=!e[3]))&&v(i,"data-inert",c)},i(p){d||(P(u),d=!0)},o(p){z(u),d=!1},d(p){p&&Q(i),u&&u.d()}}}function l4(t){let e,i,n,r;const o=[s4,a4],a=[];function s(l,c){return l[5]?0:1}return e=s(t),i=a[e]=o[e](t),{c(){i.c(),n=Mn()},m(l,c){a[e].m(l,c),et(l,n,c),r=!0},p(l,[c]){let d=e;e=s(l),e===d?a[e].p(l,c):(Pe(),z(a[d],1,1,()=>{a[d]=null}),Re(),i=a[e],i?i.p(l,c):(i=a[e]=o[e](l),i.c()),P(i,1),i.m(n.parentNode,n))},i(l){r||(P(i),r=!0)},o(l){z(i),r=!1},d(l){a[e].d(l),l&&Q(n)}}}function c4(t,e,i){let n,r,{$$slots:o={},$$scope:a}=e,{class:s}=e,{name:l}=e,{selected:c}=e,{panelClass:d}=e,{panels:u=[]}=e,{visible:p}=e,{style:h}=e;const g={};return t.$$set=m=>{"class"in m&&i(0,s=m.class),"name"in m&&i(6,l=m.name),"selected"in m&&i(7,c=m.selected),"panelClass"in m&&i(1,d=m.panelClass),"panels"in m&&i(8,u=m.panels),"visible"in m&&i(3,p=m.visible),"style"in m&&i(2,h=m.style),"$$scope"in m&&i(10,a=m.$$scope)},t.$$.update=()=>{968&t.$$.dirty&&i(4,n=u.map(m=>{const f=m===c;f&&i(9,g[m]=!0,g);const b=p?p.indexOf(m)!==-1:f;return{id:m,panelId:`panel-${l}-${m}`,labelledBy:`tab-${l}-${m}`,isActive:f,hidden:!f,visible:b,tabindex:f?0:-1,shouldDraw:f||g[m]}})),16&t.$$.dirty&&i(5,r=n.length>1)},[s,d,h,p,n,r,l,c,u,g,a,o,function(m){Dr.call(this,t,m)},function(m){Dr.call(this,t,m)}]}class Du extends li{constructor(e){super(),si(this,e,c4,l4,ri,{class:0,name:6,selected:7,panelClass:1,panels:8,visible:3,style:2})}}var Xh=t=>{const e=Object.getOwnPropertyDescriptors(t.prototype);return Object.keys(e).filter(i=>!!e[i].get)};function A$(t){let e,i,n,r;const o=[t[5],{locale:t[1]}];function a(c){t[22](c)}var s=t[10];function l(c){let d={};for(let u=0;u<o.length;u+=1)d=Tn(d,o[u]);return c[3]!==void 0&&(d.name=c[3]),{props:d}}return s&&(e=Su(s,l(t)),Fi.push(()=>go(e,"name",a)),t[23](e),e.$on("measure",t[11])),{c(){e&&Et(e.$$.fragment),n=Mn()},m(c,d){e&&Rt(e,c,d),et(c,n,d),r=!0},p(c,d){const u=34&d[0]?yr(o,[32&d[0]&&Pr(c[5]),2&d[0]&&{locale:c[1]}]):{};if(!i&&8&d[0]&&(i=!0,u.name=c[3],So(()=>i=!1)),s!==(s=c[10])){if(e){Pe();const p=e;z(p.$$.fragment,1,0,()=>{It(p,1)}),Re()}s?(e=Su(s,l(c)),Fi.push(()=>go(e,"name",a)),c[23](e),e.$on("measure",c[11]),Et(e.$$.fragment),P(e.$$.fragment,1),Rt(e,n.parentNode,n)):e=null}else s&&e.$set(u)},i(c){r||(e&&P(e.$$.fragment,c),r=!0)},o(c){e&&z(e.$$.fragment,c),r=!1},d(c){t[23](null),c&&Q(n),e&&It(e,c)}}}function d4(t){let e,i,n,r=t[6]&&A$(t);return{c(){e=ht("div"),r&&r.c(),v(e,"data-util",t[3]),v(e,"class",i=$i(["PinturaUtilPanel",t[2]])),v(e,"style",t[7])},m(o,a){et(o,e,a),r&&r.m(e,null),t[24](e),n=!0},p(o,a){o[6]?r?(r.p(o,a),64&a[0]&&P(r,1)):(r=A$(o),r.c(),P(r,1),r.m(e,null)):r&&(Pe(),z(r,1,1,()=>{r=null}),Re()),(!n||8&a[0])&&v(e,"data-util",o[3]),(!n||4&a[0]&&i!==(i=$i(["PinturaUtilPanel",o[2]])))&&v(e,"class",i),(!n||128&a[0])&&v(e,"style",o[7])},i(o){n||(P(r),n=!0)},o(o){z(r),n=!1},d(o){o&&Q(e),r&&r.d(),t[24](null)}}}function u4(t,e,i){let n,r,o,a,s;const l=Sa();let{isActive:c=!0}=e,{stores:d}=e,{view:u}=e,{props:p}=e,{component:h}=e,{locale:g}=e,{class:m}=e;const f=un("isAnimated");let b;E(t,f,N=>i(21,s=N));const w=di(0),S=Ai(w,N=>rn(N,0,1));E(t,S,N=>i(20,a=N));let C=!c;const R=he(c),M={isActive:Ai(R,async(N,it)=>{if(!N)return it(N);await Yy(),it(N)},!1),isActiveFraction:Ai(S,N=>N),isVisible:Ai(S,N=>N>0)},D=u,T=Xh(D),F=Object.keys(p||{}).reduce((N,it)=>(T.includes(it)&&(N[it]=p[it]),N),{}),W=Object.keys(M).reduce((N,it)=>(T.includes(it)&&(N[it]=M[it]),N),{});let B,y;const V=N=>{i(17,b={...N.detail}),k&&c&&l("measure",{...b})};mo("measurable",xr);const tt=ll().$$.context;let k=!1;return Es(()=>{if(i(19,k=!0),o)return;i(0,h=new D({target:y,props:{...r,locale:g},context:tt})),i(3,B=h.name);const N=h.$on("measure",V);return()=>{N(),h.$destroy()}}),t.$$set=N=>{"isActive"in N&&i(12,c=N.isActive),"stores"in N&&i(13,d=N.stores),"view"in N&&i(14,u=N.view),"props"in N&&i(15,p=N.props),"component"in N&&i(0,h=N.component),"locale"in N&&i(1,g=N.locale),"class"in N&&i(2,m=N.class)},t.$$.update=()=>{135169&t.$$.dirty[0]&&b&&c&&h&&l("measure",b),2101248&t.$$.dirty[0]&&w.set(c?1:0,{hard:s===!1}),1310720&t.$$.dirty[0]&&(a<=0&&!C?i(18,C=!0):a>0&&C&&i(18,C=!1)),786432&t.$$.dirty[0]&&k&&l(C?"hide":"show"),1048576&t.$$.dirty[0]&&l("fade",a),1048576&t.$$.dirty[0]&&i(7,n=a<1?"opacity: "+a:void 0),4096&t.$$.dirty[0]&&R.set(c),8192&t.$$.dirty[0]&&i(5,r={...F,...W,stores:d})},i(6,o=!T.includes("external")),[h,g,m,B,y,r,o,n,f,S,D,V,c,d,u,p,w,b,C,k,a,s,function(N){B=N,i(3,B)},function(N){Fi[N?"unshift":"push"](()=>{h=N,i(0,h)})},function(N){Fi[N?"unshift":"push"](()=>{y=N,i(4,y)})}]}class b2 extends li{constructor(e){super(),si(this,e,u4,d4,ri,{isActive:12,stores:13,view:14,props:15,component:0,locale:1,class:2,opacity:16},null,[-1,-1])}get opacity(){return this.$$.ctx[16]}}function p4(t){let e,i,n;const r=t[5].default,o=ar(r,t,t[4],null);return{c(){e=fr("svg"),o&&o.c(),v(e,"class",t[3]),v(e,"style",t[2]),v(e,"width",t[0]),v(e,"height",t[1]),v(e,"viewBox",i="0 0 "+t[0]+`
    `+t[1]),v(e,"xmlns","http://www.w3.org/2000/svg"),v(e,"aria-hidden","true"),v(e,"focusable","false"),v(e,"stroke-linecap","round"),v(e,"stroke-linejoin","round")},m(a,s){et(a,e,s),o&&o.m(e,null),n=!0},p(a,[s]){o&&o.p&&(!n||16&s)&&lr(o,r,a,a[4],n?sr(r,a[4],s,null):cr(a[4]),null),(!n||8&s)&&v(e,"class",a[3]),(!n||4&s)&&v(e,"style",a[2]),(!n||1&s)&&v(e,"width",a[0]),(!n||2&s)&&v(e,"height",a[1]),(!n||3&s&&i!==(i="0 0 "+a[0]+`
    `+a[1]))&&v(e,"viewBox",i)},i(a){n||(P(o,a),n=!0)},o(a){z(o,a),n=!1},d(a){a&&Q(e),o&&o.d(a)}}}function h4(t,e,i){let{$$slots:n={},$$scope:r}=e,{width:o=24}=e,{height:a=24}=e,{style:s}=e,{class:l}=e;return t.$$set=c=>{"width"in c&&i(0,o=c.width),"height"in c&&i(1,a=c.height),"style"in c&&i(2,s=c.style),"class"in c&&i(3,l=c.class),"$$scope"in c&&i(4,r=c.$$scope)},[o,a,s,l,r,n]}class ko extends li{constructor(e){super(),si(this,e,h4,p4,ri,{width:0,height:1,style:2,class:3})}}var v2=(t,e)=>e===t.target||e.contains(t.target),L$=(t,e,i)=>{const n=Ve(e)?e:t;return i?`${n} (${r=i,r.map(o=>o==="CMD"?Eu()?"⌘":"Ctrl":o).join("+")})`:n;var r};function z$(t){let e,i;return e=new ko({props:{class:"PinturaButtonIcon",$$slots:{default:[m4]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};536870920&r&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function m4(t){let e;return{c(){e=fr("g")},m(i,n){et(i,e,n),e.innerHTML=t[3]},p(i,n){8&n&&(e.innerHTML=i[3])},d(i){i&&Q(e)}}}function F$(t){let e;return{c(){e=ht("span"),v(e,"class",t[11])},m(i,n){et(i,e,n),e.innerHTML=t[0]},p(i,n){1&n&&(e.innerHTML=i[0]),2048&n&&v(e,"class",i[11])},d(i){i&&Q(e)}}}function $4(t){let e,i,n,r,o;const a=t[27].default,s=ar(a,t,t[29],null),l=s||function(c){let d,u,p,h=c[3]&&z$(c),g=c[0]&&F$(c);return{c(){d=ht("span"),h&&h.c(),u=me(),g&&g.c(),v(d,"class",c[13])},m(m,f){et(m,d,f),h&&h.m(d,null),kt(d,u),g&&g.m(d,null),p=!0},p(m,f){m[3]?h?(h.p(m,f),8&f&&P(h,1)):(h=z$(m),h.c(),P(h,1),h.m(d,u)):h&&(Pe(),z(h,1,1,()=>{h=null}),Re()),m[0]?g?g.p(m,f):(g=F$(m),g.c(),g.m(d,null)):g&&(g.d(1),g=null),(!p||8192&f)&&v(d,"class",m[13])},i(m){p||(P(h),p=!0)},o(m){z(h),p=!1},d(m){m&&Q(d),h&&h.d(),g&&g.d()}}}(t);return{c(){e=ht("button"),l&&l.c(),v(e,"type",t[6]),v(e,"style",t[4]),e.disabled=t[5],v(e,"class",t[12]),v(e,"title",i=L$(t[0],t[1],t[2]))},m(c,d){et(c,e,d),l&&l.m(e,null),t[28](e),n=!0,r||(o=[Pt(e,"keydown",function(){Zi(t[8])&&t[8].apply(this,arguments)}),Pt(e,"click",function(){Zi(t[7])&&t[7].apply(this,arguments)}),Pt(e,"pointerdown",function(){Zi(t[14])&&t[14].apply(this,arguments)}),Xi(t[9].call(null,e))],r=!0)},p(c,[d]){t=c,s?s.p&&(!n||536870912&d)&&lr(s,a,t,t[29],n?sr(a,t[29],d,null):cr(t[29]),null):l&&l.p&&(!n||10249&d)&&l.p(t,n?d:-1),(!n||64&d)&&v(e,"type",t[6]),(!n||16&d)&&v(e,"style",t[4]),(!n||32&d)&&(e.disabled=t[5]),(!n||4096&d)&&v(e,"class",t[12]),(!n||7&d&&i!==(i=L$(t[0],t[1],t[2])))&&v(e,"title",i)},i(c){n||(P(l,c),n=!0)},o(c){z(l,c),n=!1},d(c){c&&Q(e),l&&l.d(c),t[28](null),r=!1,Ui(o)}}}function g4(t,e,i){let n,r,o,a,s,l,{$$slots:c={},$$scope:d}=e,{class:u}=e,{label:p}=e,{title:h}=e,{shortcut:g}=e,{labelClass:m}=e,{innerClass:f}=e,{hideLabel:b=!1}=e,{icon:w}=e,{style:S}=e,{disabled:C}=e,{type:R="button"}=e,{onclick:M}=e,{onkeydown:D}=e,{onhold:T}=e,{action:F=()=>{}}=e,{holdThreshold:W=500}=e,{holdSpeedUpFactor:B=.5}=e,{holdSpeedMin:y=20}=e;const V=k=>{i(25,l=setTimeout(()=>{T(),V(Math.max(k*B,y))},k))};let tt;return t.$$set=k=>{"class"in k&&i(15,u=k.class),"label"in k&&i(0,p=k.label),"title"in k&&i(1,h=k.title),"shortcut"in k&&i(2,g=k.shortcut),"labelClass"in k&&i(16,m=k.labelClass),"innerClass"in k&&i(17,f=k.innerClass),"hideLabel"in k&&i(18,b=k.hideLabel),"icon"in k&&i(3,w=k.icon),"style"in k&&i(4,S=k.style),"disabled"in k&&i(5,C=k.disabled),"type"in k&&i(6,R=k.type),"onclick"in k&&i(7,M=k.onclick),"onkeydown"in k&&i(8,D=k.onkeydown),"onhold"in k&&i(19,T=k.onhold),"action"in k&&i(9,F=k.action),"holdThreshold"in k&&i(20,W=k.holdThreshold),"holdSpeedUpFactor"in k&&i(21,B=k.holdSpeedUpFactor),"holdSpeedMin"in k&&i(22,y=k.holdSpeedMin),"$$scope"in k&&i(29,d=k.$$scope)},t.$$.update=()=>{101187584&t.$$.dirty&&i(26,r=T?()=>{l&&(clearTimeout(l),i(25,l=void 0),document.documentElement.removeEventListener("pointerup",r))}:$e),68681728&t.$$.dirty&&i(14,n=T?()=>{document.documentElement.addEventListener("pointerup",r),V(W)}:$e),131072&t.$$.dirty&&i(13,o=$i(["PinturaButtonInner",f])),294912&t.$$.dirty&&i(12,a=$i(["PinturaButton",b&&"PinturaButtonIconOnly",u])),327680&t.$$.dirty&&i(11,s=$i([b?"implicit":"PinturaButtonLabel",m]))},[p,h,g,w,S,C,R,M,D,F,tt,s,a,o,n,u,m,f,b,T,W,B,y,k=>v2(k,tt),()=>tt,l,r,c,function(k){Fi[k?"unshift":"push"](()=>{tt=k,i(10,tt)})},d]}class Ls extends li{constructor(e){super(),si(this,e,g4,$4,ri,{class:15,label:0,title:1,shortcut:2,labelClass:16,innerClass:17,hideLabel:18,icon:3,style:4,disabled:5,type:6,onclick:7,onkeydown:8,onhold:19,action:9,holdThreshold:20,holdSpeedUpFactor:21,holdSpeedMin:22,isEventTarget:23,getElement:24})}get isEventTarget(){return this.$$.ctx[23]}get getElement(){return this.$$.ctx[24]}}var w2=(t,e)=>{const i=t.findIndex(e);if(i>=0)return t.splice(i,1)};const f4=80;var zs=(t,e={})=>{const{inertia:i=!1,inertiaDurationMultiplier:n=f4,shouldStartInteraction:r=()=>!0,pinch:o=!1,multiTouch:a,getEventPosition:s=lt=>ot(lt.clientX,lt.clientY),observeKeys:l=!1}=e;function c(lt,St){t.dispatchEvent(new CustomEvent(lt,{detail:St}))}function d(){M&&M(),M=void 0}const u=[],p=lt=>lt.timeStamp===0?Date.now():lt.timeStamp,h=()=>{const lt=Oe(u[0].position);if(u[1]){const St=.5*(u[1].position.x-lt.x),J=.5*(u[1].position.y-lt.y);lt.x+=St,lt.y+=J}return lt},g=lt=>{lt.origin.x=lt.position.x,lt.origin.y=lt.position.y,lt.translation.x=0,lt.translation.y=0},m=lt=>{const St=(J=>u.findIndex(q=>q.event.pointerId===J.pointerId))(lt);if(!(St<0))return u[St]},f=()=>u.length===1,b=()=>u.length===2,w=lt=>{const St=Fo(lt.map(J=>J.position));return{center:St,distance:((J,q)=>J.reduce((Z,bt)=>Z+$o(q,bt.position),0)/J.length)(lt,St),velocity:Fo(lt.map(J=>J.velocity)),translation:Fo(lt.map(J=>J.translation))}};let S,C,R,M,D,T,F,W,B=0,y;t.addEventListener("pointerdown",it);const V=["Meta","Control","Alt","Shift"];function tt(lt){if(!V.includes(lt.key))return;const{metaKey:St,ctrlKey:J,altKey:q,shiftKey:Z}=lt;N({metaKey:St,ctrlKey:J,altKey:q,shiftKey:Z})}let k=Date.now();const N=lt=>{const St=Oe(u[0].translation);let J=F;o&&b()&&(J*=$o(u[0].position,u[1].position)/D,Fn(St,u[1].translation)),Fn(St,T);const q=Date.now();q-k<16||(k=q,c("interactionupdate",{position:h(),translation:St,scalar:o?J:void 0,isMultiTouching:b(),...lt}))};function it(lt){if(!b()&&!(St=>ui(St.button)&&St.button!==0)(lt)&&r(lt,t)){if(d(),(St=>{const J=p(St),q={timeStamp:J,timeStampInitial:J,position:s(St),origin:s(St),velocity:ln(),velocityHistory:[],velocityAverage:ln(),translation:ln(),interactionState:void 0,event:St};u.push(q),q.interactionState=w(u)})(lt),l&&(window.addEventListener("keydown",tt),window.addEventListener("keyup",tt)),f())document.documentElement.addEventListener("pointermove",ut),document.documentElement.addEventListener("pointerup",st),document.documentElement.addEventListener("pointercancel",st),document.addEventListener("visibilitychange",G),W=!1,F=1,T=ln(),D=void 0,c("interactionstart",{origin:Oe(m(lt).origin)});else if(o)W=!0,D=$o(u[0].position,u[1].position),T.x+=u[0].translation.x,T.y+=u[0].translation.y,g(u[0]);else if(a===!1)return u.length=0,vt(),c("interactioncancel")}}function ut(lt){lt.preventDefault(),(bt=>{const nt=m(bt);if(!nt)return;const $t=p(bt),Lt=s(bt),ie=Math.max(1,$t-nt.timeStamp);nt.velocity.x=(Lt.x-nt.position.x)/ie,nt.velocity.y=(Lt.y-nt.position.y)/ie,nt.velocityHistory.push(Oe(nt.velocity)),nt.velocityHistory=nt.velocityHistory.slice(-3),nt.velocityAverage=nt.velocityHistory.reduce((Vt,te,Yt,U)=>(Vt.x+=te.x/U.length,Vt.y+=te.y/U.length,Vt),ln()),nt.translation.x=Lt.x-nt.origin.x,nt.translation.y=Lt.y-nt.origin.y,nt.timeStamp=$t,nt.position.x=Lt.x,nt.position.y=Lt.y,nt.event=bt})(lt);const{metaKey:St=!1,ctrlKey:J=!1,altKey:q=!1,shiftKey:Z=!1}=l?lt:{};N({metaKey:St,ctrlKey:J,altKey:q,shiftKey:Z})}function st(lt){if(!m(lt))return;const St=h(),J=(ie=>{const Vt=w2(u,te=>te.event.pointerId===ie.pointerId);if(Vt)return Vt[0]})(lt);if(o&&f()){const ie=$o(u[0].position,J.position);F*=ie/D,T.x+=u[0].translation.x+J.translation.x,T.y+=u[0].translation.y+J.translation.y,g(u[0])}let q=!1,Z=!1;if(!W&&J){const ie=performance.now(),Vt=ie-J.timeStampInitial;q=bo(J.translation)<64&&Vt<300,Z=!!(y&&q&&ie-B<700&&bo(y,J.position)<128),q&&(y=Oe(J.position),B=ie)}if(u.length>0)return;vt();const bt=Oe(J.translation),nt=Oe(J.velocityAverage);let $t=!1;c("interactionrelease",{isTap:q,isDoubleTap:Z,position:St,translation:bt,scalar:F,preventInertia:()=>$t=!0});const Lt=$o(nt);if($t||!i||Lt<.25)return gt(bt,{isTap:q,isDoubleTap:Z});C=Oe(St),R=Oe(bt),S=Gh(Oe(bt),{easing:Zv,duration:Lt*n}),S.set({x:bt.x+50*nt.x,y:bt.y+50*nt.y}).then(()=>{M&&gt(va(S),{isTap:q,isDoubleTap:Z})}),M=S.subscribe(mt)}function mt(lt){lt&&c("interactionupdate",{position:ot(C.x+(lt.x-R.x),C.y+(lt.y-R.y)),translation:lt,scalar:o?F:void 0})}function G(lt){if(document.visibilityState==="visible"||!u.length)return;const St=w(u);d(),c("interactionend",{...St}),u.length=0,vt()}function gt(lt,St){d(),c("interactionend",{...St,translation:lt,scalar:o?F:void 0})}function vt(){l&&window.removeEventListener("keydown",tt),l&&window.removeEventListener("keyup",tt),document.documentElement.removeEventListener("pointermove",ut),document.documentElement.removeEventListener("pointerup",st),document.documentElement.removeEventListener("pointercancel",st),document.addEventListener("visibilitychange",G)}return{destroy(){d(),t.removeEventListener("pointerdown",it)}}},Fs=(t,e={})=>{const{direction:i,shiftMultiplier:n=10,bubbles:r=!1,preventDefault:o=!1,stopKeydownPropagation:a=!0}=e,s=i==="horizontal",l=i==="vertical",c=d=>{const{key:u}=d,p=d.shiftKey,h=/up|down/i.test(u),g=/left|right/i.test(u);if(!g&&!h||s&&h||l&&g)return;const m=p?n:1;a&&d.stopPropagation(),o&&d.preventDefault(),t.dispatchEvent(new CustomEvent("nudge",{bubbles:r,detail:ot((/left/i.test(u)?-1:/right/i.test(u)?1:0)*m,(/up/i.test(u)?-1:/down/i.test(u)?1:0)*m)}))};return t.addEventListener("keydown",c),{destroy(){t.removeEventListener("keydown",c)}}};function bs(t,e){return e?e*Math.sign(t)*Math.log10(1+Math.abs(t)/e):t}const D$=(t,e,i)=>{if(!e||!i)return{...t};const n=t.x+bs(e.x-t.x,i),r=t.x+t.width+bs(e.x+e.width-(t.x+t.width),i),o=t.y+bs(e.y-t.y,i);return{x:n,y:o,width:r-n,height:t.y+t.height+bs(e.y+e.height-(t.y+t.height),i)-o}},y4=(t,e,i)=>e&&i?ot(t.x+bs(e.x-t.x,i),t.y+bs(e.y-t.y,i)):{...t};var S2=(t,e)=>{if(t)return/em/.test(t)?16*parseInt(t,10):/px/.test(t)?parseInt(t,10):void 0},Bu=(t,e)=>{let i=t.detail||0;const{deltaX:n,deltaY:r,wheelDelta:o,wheelDeltaX:a,wheelDeltaY:s}=t,{fixScrollDirection:l=!1}=e||{};return ui(a)&&Math.abs(a)>Math.abs(s)?i=a/-120:ui(n)&&Math.abs(n)>Math.abs(r)?i=n/20:(o||s)&&(i=(o||s)/-120),i||(i=r/20),(wa()||La())&&(i*=2),l&&Eu()&&(i*=-1),i};function x4(t){let e,i,n,r,o,a,s;const l=t[37].default,c=ar(l,t,t[36],null);return{c(){e=ht("div"),i=ht("div"),c&&c.c(),v(i,"style",t[5]),v(e,"class",n=$i(["PinturaScrollable",t[0]])),v(e,"style",t[4]),v(e,"data-direction",t[1]),v(e,"data-state",t[6])},m(d,u){et(d,e,u),kt(e,i),c&&c.m(i,null),t[39](e),o=!0,a||(s=[Pt(i,"interactionstart",t[9]),Pt(i,"interactionupdate",t[11]),Pt(i,"interactionend",t[12]),Pt(i,"interactionrelease",t[10]),Xi(zs.call(null,i,{inertia:!0})),Pt(i,"measure",t[38]),Xi(xr.call(null,i)),Pt(e,"wheel",t[14],{passive:!1}),Pt(e,"scroll",t[16]),Pt(e,"focusin",t[15]),Pt(e,"nudge",t[17]),Pt(e,"measure",t[13]),Xi(xr.call(null,e,{observePosition:!0})),Xi(r=Fs.call(null,e,{direction:t[1]==="x"?"horizontal":"vertical",stopKeydownPropagation:!1}))],a=!0)},p(d,u){c&&c.p&&(!o||32&u[1])&&lr(c,l,d,d[36],o?sr(l,d[36],u,null):cr(d[36]),null),(!o||32&u[0])&&v(i,"style",d[5]),(!o||1&u[0]&&n!==(n=$i(["PinturaScrollable",d[0]])))&&v(e,"class",n),(!o||16&u[0])&&v(e,"style",d[4]),(!o||2&u[0])&&v(e,"data-direction",d[1]),(!o||64&u[0])&&v(e,"data-state",d[6]),r&&Zi(r.update)&&2&u[0]&&r.update.call(null,{direction:d[1]==="x"?"horizontal":"vertical",stopKeydownPropagation:!1})},i(d){o||(P(c,d),o=!0)},o(d){z(c,d),o=!1},d(d){d&&Q(e),c&&c.d(d),t[39](null),a=!1,Ui(s)}}}function b4(t,e,i){let n,r,o,a,s,l,c,d,u,{$$slots:p={},$$scope:h}=e;const g=Sa();let m,f,b,w,S="idle",C=di(0);E(t,C,q=>i(35,d=q));let{class:R}=e,{scrollBlockInteractionDist:M=5}=e,{scrollStep:D=10}=e,{scrollFocusMargin:T=64}=e,{scrollDirection:F="x"}=e,{scrollAutoCancel:W=!1}=e,{elasticity:B=0}=e,{onscroll:y=$e}=e,{maskFeatherSize:V}=e,{maskFeatherStartOpacity:tt}=e,{maskFeatherEndOpacity:k}=e,{scroll:N}=e;const it=un("fixScrollDirection");let ut;E(t,it,q=>i(46,u=q));let st="",mt=!0;const G=C.subscribe(q=>{const Z=ln();Z[F]=q,y(Z)}),gt=q=>Math.max(Math.min(0,q),b[n]-f[n]);let vt,lt,St;const J=(q,Z={})=>{const{elastic:bt=!1,animate:nt=!1,preventScrollState:$t=!1}=Z;Math.abs(q-m)>M&&S==="idle"&&!w&&!$t&&i(28,S="scrolling");const Lt=gt(q),ie=bt&&B&&!w?Lt+bs(q-Lt,B):Lt;let Vt=!0;nt?Vt=!1:mt||(Vt=!w),mt=!1,C.set(ie,{hard:Vt}).then(te=>{w&&(mt=!0)})};return Wo(()=>{G()}),t.$$set=q=>{"class"in q&&i(0,R=q.class),"scrollBlockInteractionDist"in q&&i(21,M=q.scrollBlockInteractionDist),"scrollStep"in q&&i(22,D=q.scrollStep),"scrollFocusMargin"in q&&i(23,T=q.scrollFocusMargin),"scrollDirection"in q&&i(1,F=q.scrollDirection),"scrollAutoCancel"in q&&i(24,W=q.scrollAutoCancel),"elasticity"in q&&i(25,B=q.elasticity),"onscroll"in q&&i(26,y=q.onscroll),"maskFeatherSize"in q&&i(20,V=q.maskFeatherSize),"maskFeatherStartOpacity"in q&&i(18,tt=q.maskFeatherStartOpacity),"maskFeatherEndOpacity"in q&&i(19,k=q.maskFeatherEndOpacity),"scroll"in q&&i(27,N=q.scroll),"$$scope"in q&&i(36,h=q.$$scope)},t.$$.update=()=>{if(2&t.$$.dirty[0]&&i(32,n=F==="x"?"width":"height"),2&t.$$.dirty[0]&&i(30,r=F.toUpperCase()),8&t.$$.dirty[0]&&i(34,o=ut&&getComputedStyle(ut)),8&t.$$.dirty[0]|8&t.$$.dirty[1]&&i(33,a=o&&S2(o.getPropertyValue("--scrollable-feather-size"))),537657348&t.$$.dirty[0]|22&t.$$.dirty[1]&&d!=null&&b&&a!=null&&f){const q=-1*d/a,Z=-(b[n]-f[n]-d)/a;i(18,tt=rn(1-q,0,1)),i(19,k=rn(1-Z,0,1)),i(20,V=a),i(4,st=`--scrollable-feather-start-opacity: ${tt};--scrollable-feather-end-opacity: ${k}`)}134217736&t.$$.dirty[0]&&ut&&N!==void 0&&(ui(N)?J(N):J(N.scrollOffset,N)),536870916&t.$$.dirty[0]|2&t.$$.dirty[1]&&i(31,s=b&&f?f[n]>b[n]:void 0),268435456&t.$$.dirty[0]|1&t.$$.dirty[1]&&i(6,l=$i([S,s?"overflows":void 0])),1073741824&t.$$.dirty[0]|17&t.$$.dirty[1]&&i(5,c=s?`transform: translate${r}(${d}px)`:void 0)},[R,F,f,ut,st,c,l,C,it,()=>{s&&(lt=!1,vt=!0,St=ot(0,0),w=!1,i(28,S="idle"),m=va(C))},({detail:q})=>{s&&(w=!0,i(28,S="idle"))},({detail:q})=>{s&&(lt||vt&&(vt=!1,bo(q.translation)<.1)||(!W||F!=="x"||(Z=>{const bt=wo(ot(Z.x-St.x,Z.y-St.y),Math.abs);St=Oe(Z);const nt=bo(bt),$t=bt.x-bt.y;return!(nt>1&&$t<-.5)})(q.translation)?J(m+q.translation[F],{elastic:!0}):lt=!0))},({detail:q})=>{if(!s||lt)return;const Z=m+q.translation[F],bt=gt(Z);mt=!1,C.set(bt).then(nt=>{w&&(mt=!0)})},({detail:q})=>{i(29,b=q),g("measure",{x:q.x,y:q.y,width:q.width,height:q.height})},q=>{if(!s)return;q.preventDefault(),q.stopPropagation();const Z=q.shiftKey,bt=Bu(q,{fixScrollDirection:u})*(Z?-1:1),nt=va(C);J(nt+bt*D,{animate:!0})},q=>{if(!s||!w)return;let Z=q.target;q.target.classList.contains("implicit")&&(Z=Z.parentNode);const bt=Z[F==="x"?"offsetLeft":"offsetTop"],nt=bt+Z[F==="x"?"offsetWidth":"offsetHeight"],$t=va(C),Lt=T+V;$t+bt<Lt?J(-bt+Lt):$t+nt>b[n]-Lt&&J(b[n]-nt-Lt,{animate:!0})},()=>{i(3,ut[F==="x"?"scrollLeft":"scrollTop"]=0,ut)},({detail:q})=>{if(ut.querySelector("[data-focus-visible]"))return;const Z=-2*q[F],bt=va(C);J(bt+Z*D,{animate:!0,preventScrollState:!0})},tt,k,V,M,D,T,W,B,y,N,S,b,r,s,n,a,o,d,h,p,q=>i(2,f=q.detail),function(q){Fi[q?"unshift":"push"](()=>{ut=q,i(3,ut)})}]}class ka extends li{constructor(e){super(),si(this,e,b4,x4,ri,{class:0,scrollBlockInteractionDist:21,scrollStep:22,scrollFocusMargin:23,scrollDirection:1,scrollAutoCancel:24,elasticity:25,onscroll:26,maskFeatherSize:20,maskFeatherStartOpacity:18,maskFeatherEndOpacity:19,scroll:27},null,[-1,-1])}}function v4(t){let e,i,n,r,o;return{c(){e=ht("span"),v(e,"class","PinturaStatusMessage")},m(a,s){et(a,e,s),e.innerHTML=t[0],n=!0,r||(o=[Pt(e,"measure",function(){Zi(t[1])&&t[1].apply(this,arguments)}),Xi(xr.call(null,e))],r=!0)},p(a,[s]){t=a,(!n||1&s)&&(e.innerHTML=t[0])},i(a){n||(Wl(()=>{i||(i=Qm(e,t[4],{duration:t[2]},!0)),i.run(1)}),n=!0)},o(a){i||(i=Qm(e,t[4],{duration:t[2]},!1)),i.run(0),n=!1},d(a){a&&Q(e),a&&i&&i.end(),r=!1,Ui(o)}}}function w4(t,e,i){let n,r,{text:o}=e,{onmeasure:a=$e}=e;const s=un("isAnimated");return E(t,s,l=>i(5,r=l)),t.$$set=l=>{"text"in l&&i(0,o=l.text),"onmeasure"in l&&i(1,a=l.onmeasure)},t.$$.update=()=>{32&t.$$.dirty&&i(2,n=r?500:0)},[o,a,n,s,function(l,{duration:c}){return{duration:c,tick:d=>{l.style.opacity=d}}},r]}class k2 extends li{constructor(e){super(),si(this,e,w4,v4,ri,{text:0,onmeasure:1})}}function S4(t){let e,i,n,r,o,a,s,l,c;return{c(){e=ht("span"),i=fr("svg"),n=fr("g"),r=fr("circle"),o=fr("circle"),a=me(),s=ht("span"),l=$n(t[3]),v(r,"class","PinturaProgressIndicatorBar"),v(r,"r","8.5"),v(r,"cx","10"),v(r,"cy","10"),v(r,"stroke-linecap","round"),v(r,"opacity",".25"),v(o,"class","PinturaProgressIndicatorFill"),v(o,"r","8.5"),v(o,"stroke-dasharray",t[2]),v(o,"cx","10"),v(o,"cy","10"),v(o,"transform","rotate(-90) translate(-20)"),v(n,"fill","none"),v(n,"stroke","currentColor"),v(n,"stroke-width","2.5"),v(n,"stroke-linecap","round"),v(n,"opacity",t[1]),v(i,"width","20"),v(i,"height","20"),v(i,"viewBox","0 0 20 20"),v(i,"xmlns","http://www.w3.org/2000/svg"),v(i,"aria-hidden","true"),v(i,"focusable","false"),v(s,"class","implicit"),v(e,"class","PinturaProgressIndicator"),v(e,"data-status",t[0]),v(e,"style",c="opacity:"+t[4])},m(d,u){et(d,e,u),kt(e,i),kt(i,n),kt(n,r),kt(n,o),kt(e,a),kt(e,s),kt(s,l)},p(d,[u]){4&u&&v(o,"stroke-dasharray",d[2]),2&u&&v(n,"opacity",d[1]),8&u&&An(l,d[3]),1&u&&v(e,"data-status",d[0]),16&u&&c!==(c="opacity:"+d[4])&&v(e,"style",c)},i:ii,o:ii,d(d){d&&Q(e)}}}function k4(t,e,i){let n,r,o,a,s,l,c,d;const u=Sa();let{progress:p}=e,{min:h=0}=e,{max:g=100}=e,{labelBusy:m="Busy"}=e,{opacity:f}=e;const b=un("isAnimated");E(t,b,D=>i(14,s=D));const w=di(f,{precision:.01});E(t,w,D=>i(4,d=D));const S=di(0,{precision:.01}),C=di(0,{precision:.01});E(t,C,D=>i(15,l=D));const R=Ai([S],D=>rn(D,h,g));E(t,R,D=>i(16,c=D));const M=R.subscribe(D=>{p===1&&Math.round(D)>=100&&u("complete")});return Es(()=>{C.set(1,{hard:!s})}),Wo(()=>{M()}),t.$$set=D=>{"progress"in D&&i(9,p=D.progress),"min"in D&&i(10,h=D.min),"max"in D&&i(11,g=D.max),"labelBusy"in D&&i(12,m=D.labelBusy),"opacity"in D&&i(13,f=D.opacity)},t.$$.update=()=>{24576&t.$$.dirty&&ui(f)&&w.set(f,{hard:!s}),16896&t.$$.dirty&&p&&p!==1/0&&S.set(100*p,{hard:!s}),70144&t.$$.dirty&&i(3,n=p===1/0?m:Math.round(c)+"%"),66048&t.$$.dirty&&i(2,r=p===1/0?"26.5 53":c/100*53+" 53"),32768&t.$$.dirty&&i(1,o=l),512&t.$$.dirty&&i(0,a=p===1/0?"busy":"loading")},[a,o,r,n,d,b,w,C,R,p,h,g,m,f,s,l,c]}class C2 extends li{constructor(e){super(),si(this,e,k4,S4,ri,{progress:9,min:10,max:11,labelBusy:12,opacity:13})}}function C4(t){let e,i,n;const r=t[5].default,o=ar(r,t,t[4],null);return{c(){e=ht("span"),o&&o.c(),v(e,"class",i="PinturaStatusAside "+t[0]),v(e,"style",t[1])},m(a,s){et(a,e,s),o&&o.m(e,null),n=!0},p(a,[s]){o&&o.p&&(!n||16&s)&&lr(o,r,a,a[4],n?sr(r,a[4],s,null):cr(a[4]),null),(!n||1&s&&i!==(i="PinturaStatusAside "+a[0]))&&v(e,"class",i),(!n||2&s)&&v(e,"style",a[1])},i(a){n||(P(o,a),n=!0)},o(a){z(o,a),n=!1},d(a){a&&Q(e),o&&o.d(a)}}}function T4(t,e,i){let n,{$$slots:r={},$$scope:o}=e,{offset:a=0}=e,{opacity:s=0}=e,{class:l}=e;return t.$$set=c=>{"offset"in c&&i(2,a=c.offset),"opacity"in c&&i(3,s=c.opacity),"class"in c&&i(0,l=c.class),"$$scope"in c&&i(4,o=c.$$scope)},t.$$.update=()=>{12&t.$$.dirty&&i(1,n=`transform:translateX(${a}px);opacity:${s}`)},[l,n,a,s,o,r]}class T2 extends li{constructor(e){super(),si(this,e,T4,C4,ri,{offset:2,opacity:3,class:0})}}const{document:B$}=qy;function M4(t){let e,i,n,r;return{c(){e=me(),i=ht("button"),v(i,"class","PinturaImageButton"),v(i,"type","button"),v(i,"title",t[1]),i.disabled=t[2]},m(o,a){et(o,e,a),et(o,i,a),i.innerHTML=t[0],t[11](i),n||(r=[Pt(B$.body,"load",t[5],!0),Pt(B$.body,"error",t[6],!0),Pt(i,"pointerdown",t[4])],n=!0)},p(o,[a]){1&a&&(i.innerHTML=o[0]),2&a&&v(i,"title",o[1]),4&a&&(i.disabled=o[2])},i:ii,o:ii,d(o){o&&Q(e),o&&Q(i),t[11](null),n=!1,Ui(r)}}}function P4(t,e,i){let n,{html:r}=e,{title:o}=e,{onclick:a}=e,{disabled:s=!1}=e,{ongrab:l=$e}=e,{ondrag:c=$e}=e,{ondrop:d=$e}=e;const u=f=>bo(p,ot(f.pageX,f.pageY))<256;let p;const h=f=>{document.documentElement.removeEventListener("pointermove",g),document.documentElement.removeEventListener("pointerup",h);const b=ot(f.pageX,f.pageY);if(bo(p,b)<32)return a(f);u(f)||d(f)},g=f=>{u(f)||c(f)},m=f=>n&&n.contains(f)&&f.nodeName==="IMG";return t.$$set=f=>{"html"in f&&i(0,r=f.html),"title"in f&&i(1,o=f.title),"onclick"in f&&i(7,a=f.onclick),"disabled"in f&&i(2,s=f.disabled),"ongrab"in f&&i(8,l=f.ongrab),"ondrag"in f&&i(9,c=f.ondrag),"ondrop"in f&&i(10,d=f.ondrop)},t.$$.update=()=>{8&t.$$.dirty&&n&&n.querySelector("img")&&i(3,n.dataset.loader=!0,n)},[r,o,s,n,f=>{p=ot(f.pageX,f.pageY),l(f),document.documentElement.addEventListener("pointermove",g),document.documentElement.addEventListener("pointerup",h)},({target:f})=>{m(f)&&i(3,n.dataset.load=!0,n)},({target:f})=>{m(f)&&i(3,n.dataset.error=!0,n)},a,l,c,d,function(f){Fi[f?"unshift":"push"](()=>{n=f,i(3,n)})}]}class M2 extends li{constructor(e){super(),si(this,e,P4,M4,ri,{html:0,title:1,onclick:7,disabled:2,ongrab:8,ondrag:9,ondrop:10})}}function O$(t,e,i){const n=t.slice();return n[14]=e[i],n}function W$(t,e){let i,n,r,o,a,s,l;function c(){return e[10](e[14])}function d(...h){return e[11](e[14],...h)}function u(...h){return e[12](e[14],...h)}function p(...h){return e[13](e[14],...h)}return n=new M2({props:{onclick:c,ongrab:d,ondrag:u,ondrop:p,disabled:e[1]||e[14].disabled,title:e[14].title,html:e[14].thumb}}),{key:t,first:null,c(){i=ht("li"),Et(n.$$.fragment),r=me(),v(i,"style",e[6]),this.first=i},m(h,g){et(h,i,g),Rt(n,i,null),kt(i,r),a=!0,s||(l=Xi(o=e[8].call(null,i,e[14])),s=!0)},p(h,g){e=h;const m={};5&g&&(m.onclick=c),9&g&&(m.ongrab=d),17&g&&(m.ondrag=u),33&g&&(m.ondrop=p),3&g&&(m.disabled=e[1]||e[14].disabled),1&g&&(m.title=e[14].title),1&g&&(m.html=e[14].thumb),n.$set(m),(!a||64&g)&&v(i,"style",e[6]),o&&Zi(o.update)&&1&g&&o.update.call(null,e[14])},i(h){a||(P(n.$$.fragment,h),a=!0)},o(h){z(n.$$.fragment,h),a=!1},d(h){h&&Q(i),It(n),s=!1,l()}}}function R4(t){let e,i,n=[],r=new Map,o=t[0];const a=s=>s[14].id;for(let s=0;s<o.length;s+=1){let l=O$(t,o,s),c=a(l);r.set(c,n[s]=W$(c,l))}return{c(){e=ht("ul");for(let s=0;s<n.length;s+=1)n[s].c();v(e,"class","PinturaImageButtonList")},m(s,l){et(s,e,l);for(let c=0;c<n.length;c+=1)n[c].m(e,null);i=!0},p(s,[l]){127&l&&(o=s[0],Pe(),n=Da(n,l,a,1,s,o,r,e,As,W$,null,O$),Re())},i(s){if(!i){for(let l=0;l<o.length;l+=1)P(n[l]);i=!0}},o(s){for(let l=0;l<n.length;l+=1)z(n[l]);i=!1},d(s){s&&Q(e);for(let l=0;l<n.length;l+=1)n[l].d()}}}function I4(t,e,i){let n,r,{items:o}=e,{disabled:a}=e,{onclickitem:s}=e,{ongrabitem:l}=e,{ondragitem:c}=e,{ondropitem:d}=e;const u=di(0,{stiffness:.25,damping:.9});return E(t,u,p=>i(9,r=p)),Es(()=>u.set(1)),t.$$set=p=>{"items"in p&&i(0,o=p.items),"disabled"in p&&i(1,a=p.disabled),"onclickitem"in p&&i(2,s=p.onclickitem),"ongrabitem"in p&&i(3,l=p.ongrabitem),"ondragitem"in p&&i(4,c=p.ondragitem),"ondropitem"in p&&i(5,d=p.ondropitem)},t.$$.update=()=>{512&t.$$.dirty&&i(6,n="opacity:"+r)},[o,a,s,l,c,d,n,u,(p,h)=>h.mount&&h.mount(p.firstChild,h),r,p=>s(p.id),(p,h)=>l&&l(p.id,h),(p,h)=>c&&c(p.id,h),(p,h)=>d&&d(p.id,h)]}class Yh extends li{constructor(e){super(),si(this,e,I4,R4,ri,{items:0,disabled:1,onclickitem:2,ongrabitem:3,ondragitem:4,ondropitem:5})}}var Cc=()=>Mr()&&window.devicePixelRatio||1;let Lp=null;var Bc=t=>(Lp===null&&(Lp=Cc()===1?Math.round:e=>e),Lp(t)),ah=(t,e={})=>{if(t){if(e.preventScroll&&La()){const i=document.body.scrollTop;return t.focus(),void(document.body.scrollTop=i)}t.focus(e)}},P2=t=>/date|email|number|search|text|url/.test(t.type),Oc=t=>(e=>/textarea/i.test(e.nodeName))(t)||P2(t)||t.isContentEditable;const E4=t=>({}),_$=t=>({}),A4=t=>({}),V$=t=>({});function L4(t){let e,i;const n=[t[7]];let r={$$slots:{default:[F4]},$$scope:{ctx:t}};for(let o=0;o<n.length;o+=1)r=Tn(r,n[o]);return e=new Ls({props:r}),t[46](e),{c(){Et(e.$$.fragment)},m(o,a){Rt(e,o,a),i=!0},p(o,a){const s=128&a[0]?yr(n,[Pr(o[7])]):{};524288&a[1]&&(s.$$scope={dirty:a,ctx:o}),e.$set(s)},i(o){i||(P(e.$$.fragment,o),i=!0)},o(o){z(e.$$.fragment,o),i=!1},d(o){t[46](null),It(e,o)}}}function z4(t){let e,i;const n=[t[7]];let r={};for(let o=0;o<n.length;o+=1)r=Tn(r,n[o]);return e=new Ls({props:r}),t[45](e),{c(){Et(e.$$.fragment)},m(o,a){Rt(e,o,a),i=!0},p(o,a){const s=128&a[0]?yr(n,[Pr(o[7])]):{};e.$set(s)},i(o){i||(P(e.$$.fragment,o),i=!0)},o(o){z(e.$$.fragment,o),i=!1},d(o){t[45](null),It(e,o)}}}function F4(t){let e;const i=t[44].label,n=ar(i,t,t[50],V$);return{c(){n&&n.c()},m(r,o){n&&n.m(r,o),e=!0},p(r,o){n&&n.p&&(!e||524288&o[1])&&lr(n,i,r,r[50],e?sr(i,r[50],o,A4):cr(r[50]),V$)},i(r){e||(P(n,r),e=!0)},o(r){z(n,r),e=!1},d(r){n&&n.d(r)}}}function N$(t){let e,i,n,r,o,a,s;const l=t[44].details,c=ar(l,t,t[50],_$);return{c(){e=ht("div"),c&&c.c(),i=me(),n=ht("span"),v(n,"class","PinturaPanelTip"),v(n,"style",t[10]),v(e,"class",r=$i(["PinturaPanel","pintura-editor-panel",t[2]])),v(e,"tabindex","-1"),v(e,"style",t[11])},m(d,u){et(d,e,u),c&&c.m(e,null),kt(e,i),kt(e,n),t[47](e),o=!0,a||(s=[Pt(e,"close",t[48]),Pt(e,"keydown",t[18]),Pt(e,"measure",t[49]),Xi(xr.call(null,e))],a=!0)},p(d,u){c&&c.p&&(!o||524288&u[1])&&lr(c,l,d,d[50],o?sr(l,d[50],u,E4):cr(d[50]),_$),(!o||1024&u[0])&&v(n,"style",d[10]),(!o||4&u[0]&&r!==(r=$i(["PinturaPanel","pintura-editor-panel",d[2]])))&&v(e,"class",r),(!o||2048&u[0])&&v(e,"style",d[11])},i(d){o||(P(c,d),o=!0)},o(d){z(c,d),o=!1},d(d){d&&Q(e),c&&c.d(d),t[47](null),a=!1,Ui(s)}}}function D4(t){let e,i,n,r,o,a,s,l,c;const d=[z4,L4],u=[];function p(g,m){return g[1]?0:1}i=p(t),n=u[i]=d[i](t);let h=t[6]&&N$(t);return{c(){e=me(),n.c(),r=me(),h&&h.c(),o=me(),a=Mn()},m(g,m){et(g,e,m),u[i].m(g,m),et(g,r,m),h&&h.m(g,m),et(g,o,m),et(g,a,m),s=!0,l||(c=[Pt(document.body,"pointerdown",function(){Zi(t[9])&&t[9].apply(this,arguments)}),Pt(document.body,"pointerup",function(){Zi(t[8])&&t[8].apply(this,arguments)})],l=!0)},p(g,m){let f=i;i=p(t=g),i===f?u[i].p(t,m):(Pe(),z(u[f],1,1,()=>{u[f]=null}),Re(),n=u[i],n?n.p(t,m):(n=u[i]=d[i](t),n.c()),P(n,1),n.m(r.parentNode,r)),t[6]?h?(h.p(t,m),64&m[0]&&P(h,1)):(h=N$(t),h.c(),P(h,1),h.m(o.parentNode,o)):h&&(Pe(),z(h,1,1,()=>{h=null}),Re())},i(g){s||(P(n),P(h),P(!1),s=!0)},o(g){z(n),z(h),z(!1),s=!1},d(g){g&&Q(e),u[i].d(g),g&&Q(r),h&&h.d(g),g&&Q(o),g&&Q(a),l=!1,Ui(c)}}}function B4(t,e,i){let n,r,o,a,s,l,c,d,u,p,h,g,m,f,b,w,S,C,R,{$$slots:M={},$$scope:D}=e,{buttonClass:T}=e,{buttonLabel:F}=e,{buttonLabelClass:W}=e,{buttonHideLabel:B}=e,{buttonIcon:y}=e,{buttonTitle:V}=e,{panelClass:tt}=e,{isActive:k=!1}=e,{onshow:N=({panel:U})=>ah(U,{preventScroll:!0})}=e,{onhide:it=$e}=e;const ut=un("isAnimated");E(t,ut,U=>i(43,R=U));const st=un("rootPortal");E(t,st,U=>i(38,f=U));const mt=un("rootRect");let G,gt,vt;E(t,mt,U=>i(41,S=U));const lt=()=>i(26,vt=n&&n.getBoundingClientRect());let St=ln(),J=di(0);E(t,J,U=>i(40,w=U));let q=ln();const Z=he({x:0,y:0});E(t,Z,U=>i(39,b=U));const bt=di(-5,{stiffness:.1,damping:.35,precision:.001});E(t,bt,U=>i(42,C=U));let nt=!0;const $t=U=>v2(U,f)||gt.isEventTarget(U);let Lt,ie,Vt=!1;const te=U=>{Oc(U.target)||(k||lt(),i(31,ie=U),i(0,k=!k))},Yt=U=>{/down/i.test(U.key)&&(i(0,k=!0),i(31,ie=U))};return Wo(()=>{if(!f||!Lt)return;const U=Lt;Yy().then(()=>{U.parentNode&&U.remove()})}),t.$$set=U=>{"buttonClass"in U&&i(19,T=U.buttonClass),"buttonLabel"in U&&i(1,F=U.buttonLabel),"buttonLabelClass"in U&&i(20,W=U.buttonLabelClass),"buttonHideLabel"in U&&i(21,B=U.buttonHideLabel),"buttonIcon"in U&&i(22,y=U.buttonIcon),"buttonTitle"in U&&i(23,V=U.buttonTitle),"panelClass"in U&&i(2,tt=U.panelClass),"isActive"in U&&i(0,k=U.isActive),"onshow"in U&&i(24,N=U.onshow),"onhide"in U&&i(25,it=U.onhide),"$$scope"in U&&i(50,D=U.$$scope)},t.$$.update=()=>{if(16&t.$$.dirty[0]&&(n=gt&&gt.getElement()),1073741825&t.$$.dirty[0]&&i(8,g=k?U=>{Vt&&(i(30,Vt=!1),$t(U)||i(0,k=!1))}:void 0),1&t.$$.dirty[0]|4096&t.$$.dirty[1]&&J.set(k?1:0,{hard:R===!1}),1&t.$$.dirty[0]|4096&t.$$.dirty[1]&&bt.set(k?0:-5,{hard:R===!1}),2048&t.$$.dirty[1]&&i(34,r=1-C/-5),1&t.$$.dirty[0]|1024&t.$$.dirty[1]&&S&&k&&lt(),67108873&t.$$.dirty[0]|1024&t.$$.dirty[1]&&S&&G&&vt&&k){i(29,nt=!0);let U=vt.x-S.x+.5*vt.width-.5*G.width,Tt=vt.y-S.y+vt.height;const ct=12,Jt=12,de=S.width-12,ee=S.height-12,be=U,ve=Tt,_=be+G.width,Ce=ve+G.height;be<ct&&(i(28,q.x=be-ct,q),U=ct),_>de&&(i(28,q.x=_-de,q),U=de-G.width),Ce>ee?(i(27,St.y=-1,St),Jt<Tt-G.height-vt.height?(i(28,q.y=0,q),Tt-=G.height+vt.height):(i(28,q.y=Tt-(Ce-ee),q),Tt-=Ce-ee-12,i(29,nt=!1))):i(27,St.y=1,St),wt(Z,b=wo(ot(U,Tt),Bc),b)}512&t.$$.dirty[1]&&i(6,o=w>0),512&t.$$.dirty[1]&&i(37,a=w<1),134217728&t.$$.dirty[0]|2304&t.$$.dirty[1]&&i(36,s=`translateX(${Math.round(b.x)+12*St.x}px) translateY(${Math.round(b.y)+12*St.y+St.y*C}px)`),1024&t.$$.dirty[1]&&i(35,l=`--panel-max-height:${S.height-24}px`),624&t.$$.dirty[1]&&i(11,c=a?`opacity: ${w}; pointer-events: ${w<1?"none":"all"}; transform: ${s};${l}`:`transform: ${s};${l}`),8&t.$$.dirty[1]&&i(32,d=.5+.5*r),8&t.$$.dirty[1]&&i(33,u=r),939524104&t.$$.dirty[0]|262&t.$$.dirty[1]&&i(10,p=b&&G&&`opacity:${nt?u:0};transform:scaleX(${d})rotate(45deg);top:${St.y<0?q.y+G.height:0}px;left:${q.x+.5*G.width}px`),1&t.$$.dirty[0]&&i(9,h=k?U=>{$t(U)||i(30,Vt=!0)}:void 0),96&t.$$.dirty[0]|128&t.$$.dirty[1]&&o&&f&&Lt&&Lt.parentNode!==f&&f.append(Lt),1&t.$$.dirty[0]&&(k||i(31,ie=void 0)),16777313&t.$$.dirty[0]|1&t.$$.dirty[1]&&k&&o&&Lt&&N({e:ie,panel:Lt}),33554497&t.$$.dirty[0]&&o&&!k&&it(),16252930&t.$$.dirty[0]&&i(7,m={label:F,icon:y,class:$i(["PinturaPanelButton",T]),onkeydown:Yt,onclick:te,hideLabel:B,labelClass:W,title:V})},[k,F,tt,G,gt,Lt,o,m,g,h,p,c,ut,st,mt,J,Z,bt,U=>{/esc/i.test(U.key)&&(i(0,k=!1),n.focus())},T,W,B,y,V,N,it,vt,St,q,nt,Vt,ie,d,u,r,l,s,a,f,b,w,S,C,R,M,function(U){Fi[U?"unshift":"push"](()=>{gt=U,i(4,gt)})},function(U){Fi[U?"unshift":"push"](()=>{gt=U,i(4,gt)})},function(U){Fi[U?"unshift":"push"](()=>{Lt=U,i(5,Lt)})},U=>{U.stopPropagation(),i(0,k=!1)},U=>i(3,G=Fa(U.detail)),D]}class Ou extends li{constructor(e){super(),si(this,e,B4,D4,ri,{buttonClass:19,buttonLabel:1,buttonLabelClass:20,buttonHideLabel:21,buttonIcon:22,buttonTitle:23,panelClass:2,isActive:0,onshow:24,onhide:25},null,[-1,-1])}}var O4={Up:38,Down:40,Left:37,Right:39};function W4(t){let e,i,n,r,o,a,s,l;const c=t[15].default,d=ar(c,t,t[14],null);return{c(){e=ht("li"),i=ht("input"),n=me(),r=ht("label"),d&&d.c(),v(i,"type","radio"),v(i,"class","implicit"),v(i,"id",t[7]),v(i,"name",t[0]),i.value=t[3],i.disabled=t[6],i.hidden=t[5],i.checked=t[4],v(r,"for",t[7]),v(r,"title",t[2]),v(e,"class",o=$i(["PinturaRadioGroupOption",t[1]])),v(e,"data-hidden",t[5]),v(e,"data-disabled",t[6]),v(e,"data-selected",t[4])},m(u,p){et(u,e,p),kt(e,i),kt(e,n),kt(e,r),d&&d.m(r,null),a=!0,s||(l=[Pt(i,"change",Jb(t[16])),Pt(i,"keydown",t[9]),Pt(i,"click",t[10])],s=!0)},p(u,[p]){(!a||128&p)&&v(i,"id",u[7]),(!a||1&p)&&v(i,"name",u[0]),(!a||8&p)&&(i.value=u[3]),(!a||64&p)&&(i.disabled=u[6]),(!a||32&p)&&(i.hidden=u[5]),(!a||16&p)&&(i.checked=u[4]),d&&d.p&&(!a||16384&p)&&lr(d,c,u,u[14],a?sr(c,u[14],p,null):cr(u[14]),null),(!a||128&p)&&v(r,"for",u[7]),(!a||4&p)&&v(r,"title",u[2]),(!a||2&p&&o!==(o=$i(["PinturaRadioGroupOption",u[1]])))&&v(e,"class",o),(!a||32&p)&&v(e,"data-hidden",u[5]),(!a||64&p)&&v(e,"data-disabled",u[6]),(!a||16&p)&&v(e,"data-selected",u[4])},i(u){a||(P(d,u),a=!0)},o(u){z(d,u),a=!1},d(u){u&&Q(e),d&&d.d(u),s=!1,Ui(l)}}}function _4(t,e,i){let n,r,{$$slots:o={},$$scope:a}=e,{name:s}=e,{class:l}=e,{label:c}=e,{id:d}=e,{value:u}=e,{checked:p}=e,{onkeydown:h}=e,{onclick:g}=e,{hidden:m=!1}=e,{disabled:f=!1}=e;const b=Object.values(O4),w=un("keysPressed");return E(t,w,S=>i(17,r=S)),t.$$set=S=>{"name"in S&&i(0,s=S.name),"class"in S&&i(1,l=S.class),"label"in S&&i(2,c=S.label),"id"in S&&i(11,d=S.id),"value"in S&&i(3,u=S.value),"checked"in S&&i(4,p=S.checked),"onkeydown"in S&&i(12,h=S.onkeydown),"onclick"in S&&i(13,g=S.onclick),"hidden"in S&&i(5,m=S.hidden),"disabled"in S&&i(6,f=S.disabled),"$$scope"in S&&i(14,a=S.$$scope)},t.$$.update=()=>{2049&t.$$.dirty&&i(7,n=`${s}-${d}`)},[s,l,c,u,p,m,f,n,w,S=>{h(S)},S=>{r.some(C=>b.includes(C))||g(S)},d,h,g,a,o,function(S){Dr.call(this,t,S)}]}class R2 extends li{constructor(e){super(),si(this,e,_4,W4,ri,{name:0,class:1,label:2,id:11,value:3,checked:4,onkeydown:12,onclick:13,hidden:5,disabled:6})}}var ks=(t=[])=>t.reduce((e,i)=>(En(i)?En(i[1]):i.options)?e.concat(En(i)?i[1]:i.options):(e.push(i),e),[]);const Qd=(t,e,i)=>{let n;return En(t)?n={id:e,value:t[0],label:t[1],...t[2]||{}}:(n=t,n.id=n.id!=null?n.id:e),i?i(n):n};var or=(t,e,i)=>cn(t)?t(e,i):t;const I2=(t,e)=>t.map(([i,n,r])=>{if(En(n))return[or(i,e),I2(n,e)];{const o=[i,or(n,e)];if(r){let a={...r};r.icon&&(a.icon=or(r.icon,e)),o.push(a)}return o}});var E2=(t,e)=>I2(t,e),A2=(t,e)=>Array.isArray(t)&&Array.isArray(e)?os(t,e):t===e;function H$(t,e,i){const n=t.slice();return n[27]=e[i],n}const V4=t=>({option:1024&t[0]}),j$=t=>({option:t[27]});function U$(t,e,i){const n=t.slice();return n[27]=e[i],n}const N4=t=>({option:1024&t[0]}),G$=t=>({option:t[27]}),H4=t=>({option:1024&t[0]}),Z$=t=>({option:t[27]});function X$(t){let e,i,n,r,o,a=[],s=new Map,l=t[1]&&Y$(t),c=t[10];const d=u=>u[27].id;for(let u=0;u<c.length;u+=1){let p=H$(t,c,u),h=d(p);s.set(h,a[u]=eg(h,p))}return{c(){e=ht("fieldset"),l&&l.c(),i=me(),n=ht("ul");for(let u=0;u<a.length;u+=1)a[u].c();v(n,"class","PinturaRadioGroupOptions"),v(e,"class",r=$i(["PinturaRadioGroup",t[3]])),v(e,"data-layout",t[5]),v(e,"title",t[7])},m(u,p){et(u,e,p),l&&l.m(e,null),kt(e,i),kt(e,n);for(let h=0;h<a.length;h+=1)a[h].m(n,null);o=!0},p(u,p){u[1]?l?l.p(u,p):(l=Y$(u),l.c(),l.m(e,i)):l&&(l.d(1),l=null),8419153&p[0]&&(c=u[10],Pe(),a=Da(a,p,d,1,u,c,s,n,As,eg,null,H$),Re()),(!o||8&p[0]&&r!==(r=$i(["PinturaRadioGroup",u[3]])))&&v(e,"class",r),(!o||32&p[0])&&v(e,"data-layout",u[5]),(!o||128&p[0])&&v(e,"title",u[7])},i(u){if(!o){for(let p=0;p<c.length;p+=1)P(a[p]);o=!0}},o(u){for(let p=0;p<a.length;p+=1)z(a[p]);o=!1},d(u){u&&Q(e),l&&l.d();for(let p=0;p<a.length;p+=1)a[p].d()}}}function Y$(t){let e,i,n;return{c(){e=ht("legend"),i=$n(t[1]),v(e,"class",n=t[2]&&"implicit")},m(r,o){et(r,e,o),kt(e,i)},p(r,o){2&o[0]&&An(i,r[1]),4&o[0]&&n!==(n=r[2]&&"implicit")&&v(e,"class",n)},d(r){r&&Q(e)}}}function j4(t){let e,i;return e=new R2({props:{name:t[4],label:t[27].label,id:t[27].id,value:t[27].value,disabled:t[27].disabled,hidden:t[27].hidden,class:t[8],checked:t[12](t[27])===t[0],onkeydown:t[13](t[27]),onclick:t[14](t[27]),$$slots:{default:[Z4]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};16&r[0]&&(o.name=n[4]),1024&r[0]&&(o.label=n[27].label),1024&r[0]&&(o.id=n[27].id),1024&r[0]&&(o.value=n[27].value),1024&r[0]&&(o.disabled=n[27].disabled),1024&r[0]&&(o.hidden=n[27].hidden),256&r[0]&&(o.class=n[8]),1025&r[0]&&(o.checked=n[12](n[27])===n[0]),1024&r[0]&&(o.onkeydown=n[13](n[27])),1024&r[0]&&(o.onclick=n[14](n[27])),8389696&r[0]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function U4(t){let e,i,n,r,o,a,s=[],l=new Map;const c=t[22].group,d=ar(c,t,t[23],Z$),u=d||function(g){let m,f,b=g[27].label+"";return{c(){m=ht("span"),f=$n(b),v(m,"class","PinturaRadioGroupOptionGroupLabel")},m(w,S){et(w,m,S),kt(m,f)},p(w,S){1024&S[0]&&b!==(b=w[27].label+"")&&An(f,b)},d(w){w&&Q(m)}}}(t);let p=t[27].options;const h=g=>g[27].id;for(let g=0;g<p.length;g+=1){let m=U$(t,p,g),f=h(m);l.set(f,s[g]=tg(f,m))}return{c(){e=ht("li"),u&&u.c(),i=me(),n=ht("ul");for(let g=0;g<s.length;g+=1)s[g].c();r=me(),v(n,"class","PinturaRadioGroupOptions"),v(e,"class",o=$i(["PinturaRadioGroupOptionGroup",t[9]]))},m(g,m){et(g,e,m),u&&u.m(e,null),kt(e,i),kt(e,n);for(let f=0;f<s.length;f+=1)s[f].m(n,null);kt(e,r),a=!0},p(g,m){d?d.p&&(!a||8389632&m[0])&&lr(d,c,g,g[23],a?sr(c,g[23],m,H4):cr(g[23]),Z$):u&&u.p&&(!a||1024&m[0])&&u.p(g,a?m:[-1,-1]),8418641&m[0]&&(p=g[27].options,Pe(),s=Da(s,m,h,1,g,p,l,n,As,tg,null,U$),Re()),(!a||512&m[0]&&o!==(o=$i(["PinturaRadioGroupOptionGroup",g[9]])))&&v(e,"class",o)},i(g){if(!a){P(u,g);for(let m=0;m<p.length;m+=1)P(s[m]);a=!0}},o(g){z(u,g);for(let m=0;m<s.length;m+=1)z(s[m]);a=!1},d(g){g&&Q(e),u&&u.d(g);for(let m=0;m<s.length;m+=1)s[m].d()}}}function q$(t){let e,i;return e=new ko({props:{$$slots:{default:[G4]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};8389632&r[0]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function G4(t){let e,i=t[27].icon+"";return{c(){e=fr("g")},m(n,r){et(n,e,r),e.innerHTML=i},p(n,r){1024&r[0]&&i!==(i=n[27].icon+"")&&(e.innerHTML=i)},d(n){n&&Q(e)}}}function K$(t){let e,i,n=t[27].label+"";return{c(){e=ht("span"),i=$n(n),v(e,"class",t[6])},m(r,o){et(r,e,o),kt(e,i)},p(r,o){1024&o[0]&&n!==(n=r[27].label+"")&&An(i,n),64&o[0]&&v(e,"class",r[6])},d(r){r&&Q(e)}}}function Z4(t){let e;const i=t[22].option,n=ar(i,t,t[23],j$),r=n||function(o){let a,s,l,c=o[27].icon&&q$(o),d=!o[27].hideLabel&&K$(o);return{c(){c&&c.c(),a=me(),d&&d.c(),s=me()},m(u,p){c&&c.m(u,p),et(u,a,p),d&&d.m(u,p),et(u,s,p),l=!0},p(u,p){u[27].icon?c?(c.p(u,p),1024&p[0]&&P(c,1)):(c=q$(u),c.c(),P(c,1),c.m(a.parentNode,a)):c&&(Pe(),z(c,1,1,()=>{c=null}),Re()),u[27].hideLabel?d&&(d.d(1),d=null):d?d.p(u,p):(d=K$(u),d.c(),d.m(s.parentNode,s))},i(u){l||(P(c),l=!0)},o(u){z(c),l=!1},d(u){c&&c.d(u),u&&Q(a),d&&d.d(u),u&&Q(s)}}}(t);return{c(){r&&r.c()},m(o,a){r&&r.m(o,a),e=!0},p(o,a){n?n.p&&(!e||8389632&a[0])&&lr(n,i,o,o[23],e?sr(i,o[23],a,V4):cr(o[23]),j$):r&&r.p&&(!e||1088&a[0])&&r.p(o,e?a:[-1,-1])},i(o){e||(P(r,o),e=!0)},o(o){z(r,o),e=!1},d(o){r&&r.d(o)}}}function J$(t){let e,i;return e=new ko({props:{$$slots:{default:[X4]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};8389632&r[0]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function X4(t){let e,i=t[27].icon+"";return{c(){e=fr("g")},m(n,r){et(n,e,r),e.innerHTML=i},p(n,r){1024&r[0]&&i!==(i=n[27].icon+"")&&(e.innerHTML=i)},d(n){n&&Q(e)}}}function Q$(t){let e,i,n=t[27].label+"";return{c(){e=ht("span"),i=$n(n),v(e,"class",t[6])},m(r,o){et(r,e,o),kt(e,i)},p(r,o){1024&o[0]&&n!==(n=r[27].label+"")&&An(i,n),64&o[0]&&v(e,"class",r[6])},d(r){r&&Q(e)}}}function Y4(t){let e;const i=t[22].option,n=ar(i,t,t[23],G$),r=n||function(o){let a,s,l,c=o[27].icon&&J$(o),d=!o[27].hideLabel&&Q$(o);return{c(){c&&c.c(),a=me(),d&&d.c(),s=me()},m(u,p){c&&c.m(u,p),et(u,a,p),d&&d.m(u,p),et(u,s,p),l=!0},p(u,p){u[27].icon?c?(c.p(u,p),1024&p[0]&&P(c,1)):(c=J$(u),c.c(),P(c,1),c.m(a.parentNode,a)):c&&(Pe(),z(c,1,1,()=>{c=null}),Re()),u[27].hideLabel?d&&(d.d(1),d=null):d?d.p(u,p):(d=Q$(u),d.c(),d.m(s.parentNode,s))},i(u){l||(P(c),l=!0)},o(u){z(c),l=!1},d(u){c&&c.d(u),u&&Q(a),d&&d.d(u),u&&Q(s)}}}(t);return{c(){r&&r.c()},m(o,a){r&&r.m(o,a),e=!0},p(o,a){n?n.p&&(!e||8389632&a[0])&&lr(n,i,o,o[23],e?sr(i,o[23],a,N4):cr(o[23]),G$):r&&r.p&&(!e||1088&a[0])&&r.p(o,e?a:[-1,-1])},i(o){e||(P(r,o),e=!0)},o(o){z(r,o),e=!1},d(o){r&&r.d(o)}}}function tg(t,e){let i,n,r;return n=new R2({props:{name:e[4],label:e[27].label,id:e[27].id,value:e[27].value,disabled:e[27].disabled,hidden:e[27].hidden,class:e[8],checked:e[12](e[27])===e[0],onkeydown:e[13](e[27]),onclick:e[14](e[27]),$$slots:{default:[Y4]},$$scope:{ctx:e}}}),{key:t,first:null,c(){i=Mn(),Et(n.$$.fragment),this.first=i},m(o,a){et(o,i,a),Rt(n,o,a),r=!0},p(o,a){e=o;const s={};16&a[0]&&(s.name=e[4]),1024&a[0]&&(s.label=e[27].label),1024&a[0]&&(s.id=e[27].id),1024&a[0]&&(s.value=e[27].value),1024&a[0]&&(s.disabled=e[27].disabled),1024&a[0]&&(s.hidden=e[27].hidden),256&a[0]&&(s.class=e[8]),1025&a[0]&&(s.checked=e[12](e[27])===e[0]),1024&a[0]&&(s.onkeydown=e[13](e[27])),1024&a[0]&&(s.onclick=e[14](e[27])),8389696&a[0]&&(s.$$scope={dirty:a,ctx:e}),n.$set(s)},i(o){r||(P(n.$$.fragment,o),r=!0)},o(o){z(n.$$.fragment,o),r=!1},d(o){o&&Q(i),It(n,o)}}}function eg(t,e){let i,n,r,o,a;const s=[U4,j4],l=[];function c(d,u){return d[27].options?0:1}return n=c(e),r=l[n]=s[n](e),{key:t,first:null,c(){i=Mn(),r.c(),o=Mn(),this.first=i},m(d,u){et(d,i,u),l[n].m(d,u),et(d,o,u),a=!0},p(d,u){let p=n;n=c(e=d),n===p?l[n].p(e,u):(Pe(),z(l[p],1,1,()=>{l[p]=null}),Re(),r=l[n],r?r.p(e,u):(r=l[n]=s[n](e),r.c()),P(r,1),r.m(o.parentNode,o))},i(d){a||(P(r),a=!0)},o(d){z(r),a=!1},d(d){d&&Q(i),l[n].d(d),d&&Q(o)}}}function q4(t){let e,i,n,r=t[11].length&&X$(t);return{c(){r&&r.c(),e=me(),i=Mn()},m(o,a){r&&r.m(o,a),et(o,e,a),et(o,i,a),n=!0},p(o,a){o[11].length?r?(r.p(o,a),2048&a[0]&&P(r,1)):(r=X$(o),r.c(),P(r,1),r.m(e.parentNode,e)):r&&(Pe(),z(r,1,1,()=>{r=null}),Re())},i(o){n||(P(r),P(!1),n=!0)},o(o){z(r),z(!1),n=!1},d(o){r&&r.d(o),o&&Q(e),o&&Q(i)}}}function K4(t,e,i){let n,r,o,{$$slots:a={},$$scope:s}=e;const l=Sa();let{label:c}=e,{hideLabel:d=!0}=e,{class:u}=e,{name:p="radio-group-"+na()}=e,{selectedIndex:h=-1}=e,{options:g=[]}=e,{onchange:m}=e,{layout:f}=e,{optionMapper:b}=e,{optionFilter:w}=e,{value:S}=e,{optionLabelClass:C}=e,{title:R}=e,{locale:M}=e,{optionClass:D}=e,{optionGroupClass:T}=e;const F=B=>o.findIndex(y=>y.id===B.id),W=(B,y)=>{i(0,h=F(B));const V={index:h,...B};((tt,...k)=>{tt&&tt(...k)})(m,V,y),l("change",V)};return t.$$set=B=>{"label"in B&&i(1,c=B.label),"hideLabel"in B&&i(2,d=B.hideLabel),"class"in B&&i(3,u=B.class),"name"in B&&i(4,p=B.name),"selectedIndex"in B&&i(0,h=B.selectedIndex),"options"in B&&i(15,g=B.options),"onchange"in B&&i(16,m=B.onchange),"layout"in B&&i(5,f=B.layout),"optionMapper"in B&&i(17,b=B.optionMapper),"optionFilter"in B&&i(18,w=B.optionFilter),"value"in B&&i(19,S=B.value),"optionLabelClass"in B&&i(6,C=B.optionLabelClass),"title"in B&&i(7,R=B.title),"locale"in B&&i(20,M=B.locale),"optionClass"in B&&i(8,D=B.optionClass),"optionGroupClass"in B&&i(9,T=B.optionGroupClass),"$$scope"in B&&i(23,s=B.$$scope)},t.$$.update=()=>{1343488&t.$$.dirty[0]&&i(11,n=E2(w?g.filter(w):g,M)),133120&t.$$.dirty[0]&&i(10,r=((B=[],y)=>{let V=0;return B.map(tt=>(V++,En(tt)?En(tt[1])?{id:V,label:tt[0],options:tt[1].map(k=>Qd(k,++V,y))}:Qd(tt,V,y):tt.options?{id:tt.id||V,label:tt.label,options:tt.options.map(k=>Qd(k,++V,y))}:Qd(tt,V,y)))})(n,b)),1024&t.$$.dirty[0]&&i(21,o=ks(r)),2654209&t.$$.dirty[0]&&h<0&&(i(0,h=o.findIndex(B=>A2(B.value,S))),h<0&&i(0,h=(B=>B.findIndex(y=>y[0]===void 0))(g)))},[h,c,d,u,p,f,C,R,D,T,r,n,F,B=>y=>{var V;V=y.key,/enter| /i.test(V)&&W(B,y)},B=>y=>{W(B,y)},g,m,b,w,S,M,o,a,s]}class as extends li{constructor(e){super(),si(this,e,K4,q4,ri,{label:1,hideLabel:2,class:3,name:4,selectedIndex:0,options:15,onchange:16,layout:5,optionMapper:17,optionFilter:18,value:19,optionLabelClass:6,title:7,locale:20,optionClass:8,optionGroupClass:9},null,[-1,-1])}}function ig(t){let e,i,n,r,o,a,s,l,c,d;return{c(){e=ht("div"),i=ht("button"),n=$n("▲"),o=me(),a=ht("button"),s=$n("▼"),v(i,"type","button"),v(i,"tabindex","-1"),v(i,"aria-label",r="increase "+t[7]),v(a,"type","button"),v(a,"tabindex","-1"),v(a,"aria-label",l="decrease "+t[7]),v(e,"class","PinturaInputSpinners")},m(u,p){et(u,e,p),kt(e,i),kt(i,n),kt(e,o),kt(e,a),kt(a,s),c||(d=[Pt(i,"click",t[17]),Pt(a,"click",t[18])],c=!0)},p(u,p){128&p&&r!==(r="increase "+u[7])&&v(i,"aria-label",r),128&p&&l!==(l="decrease "+u[7])&&v(a,"aria-label",l)},d(u){u&&Q(e),c=!1,Ui(d)}}}function J4(t){let e,i,n,r,o,a,s=t[1]==="number"&&t[9]&&ig(t);return{c(){e=ht("div"),i=ht("input"),r=me(),s&&s.c(),v(i,"class","PinturaInputField"),v(i,"title",t[7]),v(i,"type",t[1]),v(i,"min",t[4]),v(i,"max",t[5]),v(i,"step",t[6]),v(i,"inputmode",t[3]),i.value=n=t[14]?t[13]:t[0],v(i,"style",t[11]),v(i,"placeholder",t[8]),v(i,"maxlength",t[12]),i.disabled=t[2],v(i,"spellcheck","false"),v(i,"autocorrect","off"),v(i,"autocapitalize","off"),v(e,"class","PinturaInput")},m(l,c){et(l,e,c),kt(e,i),t[27](i),kt(e,r),s&&s.m(e,null),o||(a=[Pt(i,"input",t[16]),Pt(i,"blur",function(){Zi(t[14]&&t[15])&&(t[14]&&t[15]).apply(this,arguments)}),Pt(i,"keydown",t[19]),Pt(i,"keyup",t[20])],o=!0)},p(l,[c]){t=l,128&c&&v(i,"title",t[7]),2&c&&v(i,"type",t[1]),16&c&&v(i,"min",t[4]),32&c&&v(i,"max",t[5]),64&c&&v(i,"step",t[6]),8&c&&v(i,"inputmode",t[3]),24577&c&&n!==(n=t[14]?t[13]:t[0])&&i.value!==n&&(i.value=n),2048&c&&v(i,"style",t[11]),256&c&&v(i,"placeholder",t[8]),4096&c&&v(i,"maxlength",t[12]),4&c&&(i.disabled=t[2]),t[1]==="number"&&t[9]?s?s.p(t,c):(s=ig(t),s.c(),s.m(e,null)):s&&(s.d(1),s=null)},i:ii,o:ii,d(l){l&&Q(e),t[27](null),s&&s.d(),o=!1,Ui(a)}}}function Q4(t,e,i){let n,r,o,a,s,l,c,{value:d}=e,{type:u="text"}=e,{disabled:p=!1}=e,{inputmode:h}=e,{min:g}=e,{max:m}=e,{step:f}=e,{onchange:b=$e}=e,{onkeydown:w=$e}=e,{title:S}=e,{stepMultiplier:C=10}=e,{placeholder:R}=e,{enableSpinButtons:M=!0}=e,{enableStopPropagation:D=!1}=e;const T=()=>{let y=l.value;return u==="number"&&(y=h==="numeric"?parseInt(y,10):parseFloat(y),!ui(y)||Number.isNaN(y)?y=g||0:n&&(y=rn(y,g,m))),y};let F=d;const W=()=>{const y=rn(T()+(c?f*C:f),g,m);y!==d&&(i(25,F=y),i(0,d=y),b(d))},B=()=>{const y=rn(T()-(c?f*C:f),g,m);y!==d&&(i(25,F=y),i(0,d=y),b(d))};return t.$$set=y=>{"value"in y&&i(0,d=y.value),"type"in y&&i(1,u=y.type),"disabled"in y&&i(2,p=y.disabled),"inputmode"in y&&i(3,h=y.inputmode),"min"in y&&i(4,g=y.min),"max"in y&&i(5,m=y.max),"step"in y&&i(6,f=y.step),"onchange"in y&&i(21,b=y.onchange),"onkeydown"in y&&i(22,w=y.onkeydown),"title"in y&&i(7,S=y.title),"stepMultiplier"in y&&i(23,C=y.stepMultiplier),"placeholder"in y&&i(8,R=y.placeholder),"enableSpinButtons"in y&&i(9,M=y.enableSpinButtons),"enableStopPropagation"in y&&i(24,D=y.enableStopPropagation)},t.$$.update=()=>{48&t.$$.dirty&&i(14,n=ui(g)&&ui(m)),33555457&t.$$.dirty&&i(13,r=l===document.activeElement?F:d),32&t.$$.dirty&&i(26,o=m?(m+"").length:void 0),67108872&t.$$.dirty&&i(12,a=h==="numeric"&&o?o:void 0),67108864&t.$$.dirty&&i(11,s=o?`min-width:${o}em`:void 0)},[d,u,p,h,g,m,f,S,R,M,l,s,a,r,n,()=>{i(25,F=T()),b(d)},()=>{i(25,F=l.value),b(T())},W,B,y=>{c=y.shiftKey,w(y);const{key:V}=y;D&&y.stopPropagation(),/up|down/i.test(V)&&(/up/i.test(V)&&W(),/down/i.test(V)&&B(),y.preventDefault(),y.stopPropagation())},y=>{const{key:V}=y;/up|down/i.test(V)&&(y.preventDefault(),y.stopPropagation())},b,w,C,D,F,o,function(y){Fi[y?"unshift":"push"](()=>{l=y,i(10,l)})}]}class L2 extends li{constructor(e){super(),si(this,e,Q4,J4,ri,{value:0,type:1,disabled:2,inputmode:3,min:4,max:5,step:6,onchange:21,onkeydown:22,title:7,stepMultiplier:23,placeholder:8,enableSpinButtons:9,enableStopPropagation:24})}}const t5=t=>({}),ng=t=>({});function e5(t){let e,i,n,r,o=(t[2]||t[21])+"",a=t[6]&&rg(t);return{c(){a&&a.c(),e=me(),i=ht("span"),v(i,"class",n=$i(["PinturaButtonLabel",t[3],t[5]&&"implicit"]))},m(s,l){a&&a.m(s,l),et(s,e,l),et(s,i,l),i.innerHTML=o,r=!0},p(s,l){s[6]?a?(a.p(s,l),64&l[0]&&P(a,1)):(a=rg(s),a.c(),P(a,1),a.m(e.parentNode,e)):a&&(Pe(),z(a,1,1,()=>{a=null}),Re()),(!r||2097156&l[0])&&o!==(o=(s[2]||s[21])+"")&&(i.innerHTML=o),(!r||40&l[0]&&n!==(n=$i(["PinturaButtonLabel",s[3],s[5]&&"implicit"])))&&v(i,"class",n)},i(s){r||(P(a),r=!0)},o(s){z(a),r=!1},d(s){a&&a.d(s),s&&Q(e),s&&Q(i)}}}function i5(t){let e,i;return e=new L2({props:{value:t[10],onchange:t[17],enableStopPropagation:!0,type:"number",inputmode:"numeric",min:t[8].reduce(lg,1/0),max:t[8].reduce(cg,-1/0),enableSpinButtons:!1}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};1024&r[0]&&(o.value=n[10]),131072&r[0]&&(o.onchange=n[17]),256&r[0]&&(o.min=n[8].reduce(lg,1/0)),256&r[0]&&(o.max=n[8].reduce(cg,-1/0)),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function rg(t){let e,i;return e=new ko({props:{class:"PinturaButtonIcon",$$slots:{default:[n5]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};536870976&r[0]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function n5(t){let e;return{c(){e=fr("g")},m(i,n){et(i,e,n),e.innerHTML=t[6]},p(i,n){64&n[0]&&(e.innerHTML=i[6])},d(i){i&&Q(e)}}}function r5(t){let e,i,n,r,o,a;const s=[i5,e5],l=[];function c(d,u){return d[18]?0:1}return i=c(t),n=l[i]=s[i](t),{c(){e=ht("span"),n.c(),v(e,"slot","label"),v(e,"title",r=or(t[1],t[16])),v(e,"class",o=$i(["PinturaButtonInner",t[18]&&"PinturaComboBox",t[4]]))},m(d,u){et(d,e,u),l[i].m(e,null),a=!0},p(d,u){let p=i;i=c(d),i===p?l[i].p(d,u):(Pe(),z(l[p],1,1,()=>{l[p]=null}),Re(),n=l[i],n?n.p(d,u):(n=l[i]=s[i](d),n.c()),P(n,1),n.m(e,null)),(!a||65538&u[0]&&r!==(r=or(d[1],d[16])))&&v(e,"title",r),(!a||262160&u[0]&&o!==(o=$i(["PinturaButtonInner",d[18]&&"PinturaComboBox",d[4]])))&&v(e,"class",o)},i(d){a||(P(n),a=!0)},o(d){z(n),a=!1},d(d){d&&Q(e),l[i].d()}}}function o5(t){let e,i,n=t[31].label+"";return{c(){e=ht("span"),i=$n(n),v(e,"slot","group")},m(r,o){et(r,e,o),kt(e,i)},p(r,o){1&o[1]&&n!==(n=r[31].label+"")&&An(i,n)},d(r){r&&Q(e)}}}function og(t){let e,i;return e=new ko({props:{style:cn(t[14])?t[14](t[31].value):t[14],$$slots:{default:[a5]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};16384&r[0]|1&r[1]&&(o.style=cn(n[14])?n[14](n[31].value):n[14]),536870912&r[0]|1&r[1]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function a5(t){let e,i=t[31].icon+"";return{c(){e=fr("g")},m(n,r){et(n,e,r),e.innerHTML=i},p(n,r){1&r[1]&&i!==(i=n[31].icon+"")&&(e.innerHTML=i)},d(n){n&&Q(e)}}}function ag(t){let e,i,n,r,o,a=t[31].label+"",s=t[31].sublabel&&sg(t);return{c(){e=ht("span"),i=new Lu(!1),n=me(),s&&s.c(),i.a=n,v(e,"style",r=cn(t[15])?t[15](t[31].value):t[15]),v(e,"class",o=$i(["PinturaDropdownOptionLabel",t[11]]))},m(l,c){et(l,e,c),i.m(a,e),kt(e,n),s&&s.m(e,null)},p(l,c){1&c[1]&&a!==(a=l[31].label+"")&&i.p(a),l[31].sublabel?s?s.p(l,c):(s=sg(l),s.c(),s.m(e,null)):s&&(s.d(1),s=null),32768&c[0]|1&c[1]&&r!==(r=cn(l[15])?l[15](l[31].value):l[15])&&v(e,"style",r),2048&c[0]&&o!==(o=$i(["PinturaDropdownOptionLabel",l[11]]))&&v(e,"class",o)},d(l){l&&Q(e),s&&s.d()}}}function sg(t){let e,i=t[31].sublabel+"";return{c(){e=ht("span"),v(e,"class","PinturaDropdownOptionSublabel")},m(n,r){et(n,e,r),e.innerHTML=i},p(n,r){1&r[1]&&i!==(i=n[31].sublabel+"")&&(e.innerHTML=i)},d(n){n&&Q(e)}}}function s5(t){let e,i,n,r=t[31].icon&&og(t),o=!t[31].hideLabel&&ag(t);return{c(){e=ht("span"),r&&r.c(),i=me(),o&&o.c(),v(e,"slot","option")},m(a,s){et(a,e,s),r&&r.m(e,null),kt(e,i),o&&o.m(e,null),n=!0},p(a,s){a[31].icon?r?(r.p(a,s),1&s[1]&&P(r,1)):(r=og(a),r.c(),P(r,1),r.m(e,i)):r&&(Pe(),z(r,1,1,()=>{r=null}),Re()),a[31].hideLabel?o&&(o.d(1),o=null):o?o.p(a,s):(o=ag(a),o.c(),o.m(e,null))},i(a){n||(P(r),n=!0)},o(a){z(r),n=!1},d(a){a&&Q(e),r&&r.d(),o&&o.d()}}}function l5(t){let e,i,n,r,o,a;const s=t[27].controls,l=ar(s,t,t[29],ng);return n=new as({props:{class:"PinturaOptionsList PinturaScrollableContent",name:t[7],value:t[10],selectedIndex:t[9],optionFilter:t[12],optionMapper:t[13],optionLabelClass:$i(["PinturaDropdownOptionLabel",t[11]]),optionGroupClass:"PinturaListOptionGroup",optionClass:"PinturaListOption",options:t[19],onchange:t[22],$$slots:{option:[s5,({option:c})=>({31:c}),({option:c})=>[0,c?1:0]],group:[o5,({option:c})=>({31:c}),({option:c})=>[0,c?1:0]]},$$scope:{ctx:t}}}),{c(){e=ht("div"),l&&l.c(),i=me(),Et(n.$$.fragment),v(e,"slot","details"),v(e,"class","PinturaOptionsListWrapper")},m(c,d){et(c,e,d),l&&l.m(e,null),kt(e,i),Rt(n,e,null),r=!0,o||(a=Pt(e,"keydown",t[24]),o=!0)},p(c,d){l&&l.p&&(!r||536870912&d[0])&&lr(l,s,c,c[29],r?sr(s,c[29],d,t5):cr(c[29]),ng);const u={};128&d[0]&&(u.name=c[7]),1024&d[0]&&(u.value=c[10]),512&d[0]&&(u.selectedIndex=c[9]),4096&d[0]&&(u.optionFilter=c[12]),8192&d[0]&&(u.optionMapper=c[13]),2048&d[0]&&(u.optionLabelClass=$i(["PinturaDropdownOptionLabel",c[11]])),524288&d[0]&&(u.options=c[19]),536922112&d[0]|1&d[1]&&(u.$$scope={dirty:d,ctx:c}),n.$set(u)},i(c){r||(P(l,c),P(n.$$.fragment,c),r=!0)},o(c){z(l,c),z(n.$$.fragment,c),r=!1},d(c){c&&Q(e),l&&l.d(c),It(n),o=!1,a()}}}function c5(t){let e,i,n;function r(a){t[28](a)}let o={onshow:t[23],buttonClass:$i(["PinturaDropdownButton",t[0],t[5]&&"PinturaDropdownIconOnly"]),$$slots:{details:[l5],label:[r5]},$$scope:{ctx:t}};return t[20]!==void 0&&(o.isActive=t[20]),e=new Ou({props:o}),Fi.push(()=>go(e,"isActive",r)),{c(){Et(e.$$.fragment)},m(a,s){Rt(e,a,s),n=!0},p(a,s){const l={};33&s[0]&&(l.buttonClass=$i(["PinturaDropdownButton",a[0],a[5]&&"PinturaDropdownIconOnly"])),540016638&s[0]&&(l.$$scope={dirty:s,ctx:a}),!i&&1048576&s[0]&&(i=!0,l.isActive=a[20],So(()=>i=!1)),e.$set(l)},i(a){n||(P(e.$$.fragment,a),n=!0)},o(a){z(e.$$.fragment,a),n=!1},d(a){It(e,a)}}}const lg=(t,[e])=>e<t?e:t,cg=(t,[e])=>e>t?e:t;function d5(t,e,i){let n,r,{$$slots:o={},$$scope:a}=e,{class:s}=e,{title:l}=e,{label:c}=e,{labelClass:d}=e,{innerClass:u}=e,{hideLabel:p=!1}=e,{icon:h}=e,{name:g}=e,{options:m=[]}=e,{selectedIndex:f=-1}=e,{value:b}=e,{optionLabelClass:w}=e,{optionFilter:S}=e,{optionMapper:C}=e,{optionIconStyle:R}=e,{optionLabelStyle:M}=e,{locale:D}=e,{onchange:T=$e}=e,{onload:F=$e}=e,{ondestroy:W=$e}=e,{enableInput:B=!1}=e,y;return Es(()=>F({options:m})),Wo(()=>W({options:m})),t.$$set=V=>{"class"in V&&i(0,s=V.class),"title"in V&&i(1,l=V.title),"label"in V&&i(2,c=V.label),"labelClass"in V&&i(3,d=V.labelClass),"innerClass"in V&&i(4,u=V.innerClass),"hideLabel"in V&&i(5,p=V.hideLabel),"icon"in V&&i(6,h=V.icon),"name"in V&&i(7,g=V.name),"options"in V&&i(8,m=V.options),"selectedIndex"in V&&i(9,f=V.selectedIndex),"value"in V&&i(10,b=V.value),"optionLabelClass"in V&&i(11,w=V.optionLabelClass),"optionFilter"in V&&i(12,S=V.optionFilter),"optionMapper"in V&&i(13,C=V.optionMapper),"optionIconStyle"in V&&i(14,R=V.optionIconStyle),"optionLabelStyle"in V&&i(15,M=V.optionLabelStyle),"locale"in V&&i(16,D=V.locale),"onchange"in V&&i(17,T=V.onchange),"onload"in V&&i(25,F=V.onload),"ondestroy"in V&&i(26,W=V.ondestroy),"enableInput"in V&&i(18,B=V.enableInput),"$$scope"in V&&i(29,a=V.$$scope)},t.$$.update=()=>{65792&t.$$.dirty[0]&&i(19,n=D?E2(m,D):m),525312&t.$$.dirty[0]&&i(21,r=n.reduce((V,tt)=>{if(V)return V;const k=Array.isArray(tt)?tt:[tt,tt],[N,it]=k;return A2(N,b)?it:void 0},void 0)||(V=>{const tt=V.find(k=>k[0]===void 0);if(tt)return tt[1]})(n)||b)},[s,l,c,d,u,p,h,g,m,f,b,w,S,C,R,M,D,T,B,n,y,r,V=>{i(21,r=V.value),T(V),i(20,y=!1)},({e:V,panel:tt})=>{if(V&&V.key&&/up|down/i.test(V.key))return ah(tt.querySelector("input:not([disabled])"));ah(tt.querySelector("fieldset"))},V=>{/tab/i.test(V.key)&&V.preventDefault()},F,W,o,function(V){y=V,i(20,y)},a]}class qh extends li{constructor(e){super(),si(this,e,d5,c5,ri,{class:0,title:1,label:2,labelClass:3,innerClass:4,hideLabel:5,icon:6,name:7,options:8,selectedIndex:9,value:10,optionLabelClass:11,optionFilter:12,optionMapper:13,optionIconStyle:14,optionLabelStyle:15,locale:16,onchange:17,onload:25,ondestroy:26,enableInput:18},null,[-1,-1])}}function u5(t){let e;return{c(){e=ht("div"),v(e,"slot","details")},m(i,n){et(i,e,n),t[14](e)},p:ii,d(i){i&&Q(e),t[14](null)}}}function p5(t){let e,i,n;function r(a){t[15](a)}let o={buttonLabel:t[0],buttonClass:t[1],buttonIcon:t[2],buttonHideLabel:t[3],buttonTitle:t[4],buttonLabelClass:t[5],onshow:t[6],onhide:t[7],$$slots:{details:[u5]},$$scope:{ctx:t}};return t[9]!==void 0&&(o.isActive=t[9]),e=new Ou({props:o}),Fi.push(()=>go(e,"isActive",r)),{c(){Et(e.$$.fragment)},m(a,s){Rt(e,a,s),n=!0},p(a,[s]){const l={};1&s&&(l.buttonLabel=a[0]),2&s&&(l.buttonClass=a[1]),4&s&&(l.buttonIcon=a[2]),8&s&&(l.buttonHideLabel=a[3]),16&s&&(l.buttonTitle=a[4]),32&s&&(l.buttonLabelClass=a[5]),64&s&&(l.onshow=a[6]),128&s&&(l.onhide=a[7]),65792&s&&(l.$$scope={dirty:s,ctx:a}),!i&&512&s&&(i=!0,l.isActive=a[9],So(()=>i=!1)),e.$set(l)},i(a){n||(P(e.$$.fragment,a),n=!0)},o(a){z(e.$$.fragment,a),n=!1},d(a){It(e,a)}}}function h5(t,e,i){let{buttonLabel:n}=e,{buttonClass:r}=e,{buttonIcon:o}=e,{buttonHideLabel:a}=e,{buttonTitle:s}=e,{buttonLabelClass:l}=e,{root:c}=e,{ondestroy:d=$e}=e,{onshow:u=$e}=e,{onhide:p=$e}=e,h,g=!1;return Wo(d),t.$$set=m=>{"buttonLabel"in m&&i(0,n=m.buttonLabel),"buttonClass"in m&&i(1,r=m.buttonClass),"buttonIcon"in m&&i(2,o=m.buttonIcon),"buttonHideLabel"in m&&i(3,a=m.buttonHideLabel),"buttonTitle"in m&&i(4,s=m.buttonTitle),"buttonLabelClass"in m&&i(5,l=m.buttonLabelClass),"root"in m&&i(10,c=m.root),"ondestroy"in m&&i(11,d=m.ondestroy),"onshow"in m&&i(6,u=m.onshow),"onhide"in m&&i(7,p=m.onhide)},t.$$.update=()=>{1280&t.$$.dirty&&h&&c&&h.firstChild!==c&&(h.hasChildNodes()?h.replaceChild(c,h.firstChild):h.append(c))},[n,r,o,a,s,l,u,p,h,g,c,d,()=>i(9,g=!1),()=>i(9,g=!0),function(m){Fi[m?"unshift":"push"](()=>{h=m,i(8,h)})},function(m){g=m,i(9,g)}]}class m5 extends li{constructor(e){super(),si(this,e,h5,p5,ri,{buttonLabel:0,buttonClass:1,buttonIcon:2,buttonHideLabel:3,buttonTitle:4,buttonLabelClass:5,root:10,ondestroy:11,onshow:6,onhide:7,hide:12,show:13})}get hide(){return this.$$.ctx[12]}get show(){return this.$$.ctx[13]}}var Tc=(t,e,i)=>(t-e)/(i-e);const $5=t=>({}),dg=t=>({});function ug(t){let e,i,n,r,o,a,s,l;return i=new ko({props:{$$slots:{default:[g5]},$$scope:{ctx:t}}}),o=new ko({props:{$$slots:{default:[f5]},$$scope:{ctx:t}}}),{c(){e=ht("button"),Et(i.$$.fragment),n=me(),r=ht("button"),Et(o.$$.fragment),v(e,"type","button"),v(e,"aria-label","Increase"),v(r,"type","button"),v(r,"aria-label","Decrease")},m(c,d){et(c,e,d),Rt(i,e,null),et(c,n,d),et(c,r,d),Rt(o,r,null),a=!0,s||(l=[Pt(e,"pointerdown",t[20](1)),Pt(r,"pointerdown",t[20](-1))],s=!0)},p(c,d){const u={};128&d[1]&&(u.$$scope={dirty:d,ctx:c}),i.$set(u);const p={};128&d[1]&&(p.$$scope={dirty:d,ctx:c}),o.$set(p)},i(c){a||(P(i.$$.fragment,c),P(o.$$.fragment,c),a=!0)},o(c){z(i.$$.fragment,c),z(o.$$.fragment,c),a=!1},d(c){c&&Q(e),It(i),c&&Q(n),c&&Q(r),It(o),s=!1,Ui(l)}}}function g5(t){let e;return{c(){e=fr("path"),v(e,"d","M8 12 h8 M12 8 v8")},m(i,n){et(i,e,n)},p:ii,d(i){i&&Q(e)}}}function f5(t){let e;return{c(){e=fr("path"),v(e,"d","M9 12 h6")},m(i,n){et(i,e,n)},p:ii,d(i){i&&Q(e)}}}function y5(t){let e,i,n,r,o,a,s,l,c,d,u,p,h,g,m,f,b;const w=t[36].default,S=ar(w,t,t[38],null),C=t[36].knob,R=ar(C,t,t[38],dg);let M=t[9]&&ug(t);return{c(){e=ht("div"),i=ht("div"),n=ht("input"),o=me(),a=ht("div"),S&&S.c(),l=me(),c=ht("div"),d=ht("div"),R&&R.c(),h=me(),M&&M.c(),v(n,"type","range"),v(n,"id",t[3]),v(n,"min",t[0]),v(n,"max",t[1]),v(n,"step",t[2]),n.value=t[14],v(n,"style",r=t[10]?"pointer-events:none":""),v(a,"class",s=$i(["PinturaSliderTrack",t[5]])),v(a,"style",t[4]),v(d,"class",u=$i(["PinturaSliderKnob",t[7]])),v(d,"style",t[6]),v(c,"class","PinturaSliderKnobController"),v(c,"style",t[17]),v(i,"class","PinturaSliderControl"),v(i,"style",p="--slider-position:"+Math.round(t[15])),v(e,"class",g=$i(["PinturaSlider",t[12]])),v(e,"data-direction",t[8])},m(D,T){et(D,e,T),kt(e,i),kt(i,n),t[37](n),kt(i,o),kt(i,a),S&&S.m(a,null),kt(i,l),kt(i,c),kt(c,d),R&&R.m(d,null),kt(e,h),M&&M.m(e,null),m=!0,f||(b=[Pt(n,"input",t[18]),Pt(n,"nudge",t[19]),Xi(Fs.call(null,n)),Pt(i,"pointerdown",function(){Zi(t[11]&&t[13])&&(t[11]&&t[13]).apply(this,arguments)})],f=!0)},p(D,T){t=D,(!m||8&T[0])&&v(n,"id",t[3]),(!m||1&T[0])&&v(n,"min",t[0]),(!m||2&T[0])&&v(n,"max",t[1]),(!m||4&T[0])&&v(n,"step",t[2]),(!m||16384&T[0])&&(n.value=t[14]),(!m||1024&T[0]&&r!==(r=t[10]?"pointer-events:none":""))&&v(n,"style",r),S&&S.p&&(!m||128&T[1])&&lr(S,w,t,t[38],m?sr(w,t[38],T,null):cr(t[38]),null),(!m||32&T[0]&&s!==(s=$i(["PinturaSliderTrack",t[5]])))&&v(a,"class",s),(!m||16&T[0])&&v(a,"style",t[4]),R&&R.p&&(!m||128&T[1])&&lr(R,C,t,t[38],m?sr(C,t[38],T,$5):cr(t[38]),dg),(!m||128&T[0]&&u!==(u=$i(["PinturaSliderKnob",t[7]])))&&v(d,"class",u),(!m||64&T[0])&&v(d,"style",t[6]),(!m||131072&T[0])&&v(c,"style",t[17]),(!m||32768&T[0]&&p!==(p="--slider-position:"+Math.round(t[15])))&&v(i,"style",p),t[9]?M?(M.p(t,T),512&T[0]&&P(M,1)):(M=ug(t),M.c(),P(M,1),M.m(e,null)):M&&(Pe(),z(M,1,1,()=>{M=null}),Re()),(!m||4096&T[0]&&g!==(g=$i(["PinturaSlider",t[12]])))&&v(e,"class",g),(!m||256&T[0])&&v(e,"data-direction",t[8])},i(D){m||(P(S,D),P(R,D),P(M),m=!0)},o(D){z(S,D),z(R,D),z(M),m=!1},d(D){D&&Q(e),t[37](null),S&&S.d(D),R&&R.d(D),M&&M.d(),f=!1,Ui(b)}}}function x5(t,e,i){let n,r,o,a,s,l,c,d,u,p,h,g,m,f,b,{$$slots:w={},$$scope:S}=e,{min:C=0}=e,{max:R=100}=e,{step:M=1}=e,{id:D}=e,{value:T=0}=e,{valueMin:F}=e,{valueMax:W}=e,{trackStyle:B}=e,{trackClass:y}=e,{knobStyle:V}=e,{knobClass:tt}=e,{ongrab:k=$e}=e,{onchange:N=$e}=e,{onrelease:it=$e}=e,{onexceed:ut=$e}=e,{direction:st="x"}=e,{getValue:mt=Ji}=e,{setValue:G=Ji}=e,{enableSpinButtons:gt=!0}=e,{enableForceUseKnob:vt=!1}=e,{enableStopPropagation:lt=!0}=e,{enablePointerdownListener:St=!0}=e,{maxInteractionDistance:J=6}=e,{class:q}=e;const Z=Tt=>G(((ct,Jt)=>(Jt=1/Jt,Math.round(ct*Jt)/Jt))(rn(Tt,C,R),M),T),bt=(Tt,ct,Jt={})=>{const{grabbed:de=!1,released:ee=!1}=Jt,be=Z(C+Tt/ct*r),ve=F||C,_=W||R;i(21,T=Ve(be)?be:rn(be,ve,_)),b!==be&&(b=be,!Ve(be)&&(be<ve||be>_)&&ut(T,be),T!==f&&(f=T,de&&k(T),N(T),ee&&it(T)))};let nt;const $t=Tt=>{const ct=Tt[d]-m;bt(g+ct,h)},Lt=Tt=>{h=void 0,document.documentElement.removeEventListener("pointermove",$t),document.documentElement.removeEventListener("pointerup",Lt),N(T),it(T)},ie=()=>{i(21,T=Z(n+te*M)),N(T)};let Vt,te=1,Yt=!1;const U=Tt=>{clearTimeout(Vt),Yt||ie(),it(T),document.removeEventListener("pointerup",U)};return t.$$set=Tt=>{"min"in Tt&&i(0,C=Tt.min),"max"in Tt&&i(1,R=Tt.max),"step"in Tt&&i(2,M=Tt.step),"id"in Tt&&i(3,D=Tt.id),"value"in Tt&&i(21,T=Tt.value),"valueMin"in Tt&&i(22,F=Tt.valueMin),"valueMax"in Tt&&i(23,W=Tt.valueMax),"trackStyle"in Tt&&i(4,B=Tt.trackStyle),"trackClass"in Tt&&i(5,y=Tt.trackClass),"knobStyle"in Tt&&i(6,V=Tt.knobStyle),"knobClass"in Tt&&i(7,tt=Tt.knobClass),"ongrab"in Tt&&i(24,k=Tt.ongrab),"onchange"in Tt&&i(25,N=Tt.onchange),"onrelease"in Tt&&i(26,it=Tt.onrelease),"onexceed"in Tt&&i(27,ut=Tt.onexceed),"direction"in Tt&&i(8,st=Tt.direction),"getValue"in Tt&&i(28,mt=Tt.getValue),"setValue"in Tt&&i(29,G=Tt.setValue),"enableSpinButtons"in Tt&&i(9,gt=Tt.enableSpinButtons),"enableForceUseKnob"in Tt&&i(10,vt=Tt.enableForceUseKnob),"enableStopPropagation"in Tt&&i(30,lt=Tt.enableStopPropagation),"enablePointerdownListener"in Tt&&i(11,St=Tt.enablePointerdownListener),"maxInteractionDistance"in Tt&&i(31,J=Tt.maxInteractionDistance),"class"in Tt&&i(12,q=Tt.class),"$$scope"in Tt&&i(38,S=Tt.$$scope)},t.$$.update=()=>{270532608&t.$$.dirty[0]&&i(14,n=T!==void 0?mt(T):0),3&t.$$.dirty[0]&&(r=R-C),16387&t.$$.dirty[0]&&i(33,o=Tc(n,C,R)),4&t.$$.dirty[1]&&i(15,a=100*o),256&t.$$.dirty[0]&&i(34,s=st.toUpperCase()),256&t.$$.dirty[0]&&i(35,l=st==="x"?"Width":"Height"),16&t.$$.dirty[1]&&(c="offset"+l),t.$$.dirty[1],8&t.$$.dirty[1]&&(d="page"+s),32768&t.$$.dirty[0]|8&t.$$.dirty[1]&&i(17,u=`transform: translate${s}(${a}%)`)},[C,R,M,D,B,y,V,tt,st,gt,vt,St,q,Tt=>{let ct=!1;lt&&Tt.stopPropagation(),clearTimeout(nt);const Jt=p.getBoundingClientRect();if(h=p[c],m=Tt[d],g=m-Jt[st],vt){if(Math.abs(g-o*h)>J)return;ct=!0,Tt.stopPropagation()}return document.activeElement!==p&&p.focus(),bt(g,h,{grabbed:!0}),document.documentElement.addEventListener("pointermove",$t),document.documentElement.addEventListener("pointerup",Lt),ct},n,a,p,u,Tt=>{h||(i(21,T=G(parseFloat(Tt.target.value))),T!==f&&(f=T,N(T)))},Tt=>{const ct=p[c];bt(n/r*ct+Tt.detail[st],ct),clearTimeout(nt),nt=setTimeout(()=>{it(T)},250)},Tt=>ct=>{clearTimeout(nt),te=Tt,Yt=!1,Vt=setInterval(()=>{Yt=!0,ie()},100),document.addEventListener("pointercancel",U),document.addEventListener("pointerup",U)},T,F,W,k,N,it,ut,mt,G,lt,J,Tt=>{const ct=p.getBoundingClientRect(),Jt=Tt[d]-ct[st],de=p[c];return Math.abs(Jt-o*de)},o,s,l,w,function(Tt){Fi[Tt?"unshift":"push"](()=>{p=Tt,i(16,p)})},S]}class Kh extends li{constructor(e){super(),si(this,e,x5,y5,ri,{min:0,max:1,step:2,id:3,value:21,valueMin:22,valueMax:23,trackStyle:4,trackClass:5,knobStyle:6,knobClass:7,ongrab:24,onchange:25,onrelease:26,onexceed:27,direction:8,getValue:28,setValue:29,enableSpinButtons:9,enableForceUseKnob:10,enableStopPropagation:30,enablePointerdownListener:11,maxInteractionDistance:31,class:12,eventDistanceToKnob:32,handlePointerDown:13},null,[-1,-1])}get eventDistanceToKnob(){return this.$$.ctx[32]}get handlePointerDown(){return this.$$.ctx[13]}}function pg(t){let e,i;return e=new ko({props:{class:"PinturaButtonIcon",$$slots:{default:[b5]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};1048580&r&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function b5(t){let e;return{c(){e=fr("g")},m(i,n){et(i,e,n),e.innerHTML=t[2]},p(i,n){4&n&&(e.innerHTML=i[2])},d(i){i&&Q(e)}}}function hg(t){let e,i,n=or(t[8],t[6])+"";return{c(){e=ht("span"),i=$n(n),v(e,"class","PinturaButtonLabelPrefix")},m(r,o){et(r,e,o),kt(e,i)},p(r,o){320&o&&n!==(n=or(r[8],r[6])+"")&&An(i,n)},d(r){r&&Q(e)}}}function v5(t){let e,i,n,r,o,a,s,l,c,d=t[2]&&pg(t),u=t[8]&&hg(t);return{c(){e=ht("span"),d&&d.c(),i=me(),u&&u.c(),n=me(),r=ht("span"),o=$n(t[9]),v(r,"class",a=$i(["PinturaButtonLabel",t[3],t[5]&&"implicit"])),v(e,"slot","label"),v(e,"title",s=or(t[1],t[6])),v(e,"class",l=$i(["PinturaButtonInner",t[4]]))},m(p,h){et(p,e,h),d&&d.m(e,null),kt(e,i),u&&u.m(e,null),kt(e,n),kt(e,r),kt(r,o),c=!0},p(p,h){p[2]?d?(d.p(p,h),4&h&&P(d,1)):(d=pg(p),d.c(),P(d,1),d.m(e,i)):d&&(Pe(),z(d,1,1,()=>{d=null}),Re()),p[8]?u?u.p(p,h):(u=hg(p),u.c(),u.m(e,n)):u&&(u.d(1),u=null),(!c||512&h)&&An(o,p[9]),(!c||40&h&&a!==(a=$i(["PinturaButtonLabel",p[3],p[5]&&"implicit"])))&&v(r,"class",a),(!c||66&h&&s!==(s=or(p[1],p[6])))&&v(e,"title",s),(!c||16&h&&l!==(l=$i(["PinturaButtonInner",p[4]])))&&v(e,"class",l)},i(p){c||(P(d),c=!0)},o(p){z(d),c=!1},d(p){p&&Q(e),d&&d.d(),u&&u.d()}}}function w5(t){let e,i,n,r,o;const a=[t[12],{value:t[7]},{onchange:t[11]}];let s={};for(let l=0;l<a.length;l+=1)s=Tn(s,a[l]);return i=new Kh({props:s}),{c(){e=ht("div"),Et(i.$$.fragment),v(e,"slot","details")},m(l,c){et(l,e,c),Rt(i,e,null),n=!0,r||(o=Pt(e,"keydown",t[10]),r=!0)},p(l,c){const d=6272&c?yr(a,[4096&c&&Pr(l[12]),128&c&&{value:l[7]},2048&c&&{onchange:l[11]}]):{};i.$set(d)},i(l){n||(P(i.$$.fragment,l),n=!0)},o(l){z(i.$$.fragment,l),n=!1},d(l){l&&Q(e),It(i),r=!1,o()}}}function S5(t){let e,i;return e=new Ou({props:{panelClass:"PinturaSliderPanel",buttonClass:$i(["PinturaSliderButton",t[0],t[5]&&"PinturaSliderIconOnly"]),$$slots:{details:[w5],label:[v5]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,[r]){const o={};33&r&&(o.buttonClass=$i(["PinturaSliderButton",n[0],n[5]&&"PinturaSliderIconOnly"])),1053694&r&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function k5(t,e,i){const n=["class","title","label","icon","labelClass","innerClass","hideLabel","locale","value","onchange","labelPrefix"];let r=Xm(e,n),{class:o}=e,{title:a}=e,{label:s=Math.round}=e,{icon:l}=e,{labelClass:c}=e,{innerClass:d}=e,{hideLabel:u=!1}=e,{locale:p}=e,{value:h}=e,{onchange:g=$e}=e,{labelPrefix:m}=e;const{min:f,max:b,getValue:w=Ji}=r;let S;const C=R=>i(9,S=(M=>cn(s)?s(w(M),f,b,M):s)(R));return t.$$set=R=>{e=Tn(Tn({},e),Fc(R)),i(12,r=Xm(e,n)),"class"in R&&i(0,o=R.class),"title"in R&&i(1,a=R.title),"label"in R&&i(13,s=R.label),"icon"in R&&i(2,l=R.icon),"labelClass"in R&&i(3,c=R.labelClass),"innerClass"in R&&i(4,d=R.innerClass),"hideLabel"in R&&i(5,u=R.hideLabel),"locale"in R&&i(6,p=R.locale),"value"in R&&i(7,h=R.value),"onchange"in R&&i(14,g=R.onchange),"labelPrefix"in R&&i(8,m=R.labelPrefix)},t.$$.update=()=>{8320&t.$$.dirty&&C(h)},[o,a,l,c,d,u,p,h,m,S,R=>{/tab/i.test(R.key)&&R.preventDefault()},R=>{C(R),g(R)},r,s,g]}class C5 extends li{constructor(e){super(),si(this,e,k5,S5,ri,{class:0,title:1,label:13,icon:2,labelClass:3,innerClass:4,hideLabel:5,locale:6,value:7,onchange:14,labelPrefix:8})}}function mg(t){let e,i,n=or(t[0],t[1])+"";return{c(){e=ht("span"),i=$n(n),v(e,"class",t[3])},m(r,o){et(r,e,o),kt(e,i)},p(r,o){3&o&&n!==(n=or(r[0],r[1])+"")&&An(i,n),8&o&&v(e,"class",r[3])},d(r){r&&Q(e)}}}function T5(t){let e,i,n,r,o=t[0]&&mg(t);return n=new ro({props:{items:t[2]}}),{c(){e=ht("li"),o&&o.c(),i=me(),Et(n.$$.fragment),v(e,"class","PinturaShapeStyle")},m(a,s){et(a,e,s),o&&o.m(e,null),kt(e,i),Rt(n,e,null),r=!0},p(a,[s]){a[0]?o?o.p(a,s):(o=mg(a),o.c(),o.m(e,i)):o&&(o.d(1),o=null);const l={};4&s&&(l.items=a[2]),n.$set(l)},i(a){r||(P(n.$$.fragment,a),r=!0)},o(a){z(n.$$.fragment,a),r=!1},d(a){a&&Q(e),o&&o.d(),It(n)}}}function M5(t,e,i){let n,{title:r}=e,{locale:o}=e,{items:a}=e,{hideTitle:s=!1}=e;return t.$$set=l=>{"title"in l&&i(0,r=l.title),"locale"in l&&i(1,o=l.locale),"items"in l&&i(2,a=l.items),"hideTitle"in l&&i(4,s=l.hideTitle)},t.$$.update=()=>{16&t.$$.dirty&&i(3,n="PinturaShapeStyleLabel"+(s?" implicit":""))},[r,o,a,n,s]}class P5 extends li{constructor(e){super(),si(this,e,M5,T5,ri,{title:0,locale:1,items:2,hideTitle:4})}}var $g=(t,e,i)=>{let n,r,o;const a=Math.floor(6*t),s=6*t-a,l=i*(1-e),c=i*(1-s*e),d=i*(1-(1-s)*e);switch(a%6){case 0:n=i,r=d,o=l;break;case 1:n=c,r=i,o=l;break;case 2:n=l,r=i,o=d;break;case 3:n=l,r=c,o=i;break;case 4:n=d,r=l,o=i;break;case 5:n=i,r=l,o=c}return[n,r,o]};function R5(t){let e,i,n;return{c(){e=ht("div"),i=ht("span"),v(e,"class","PinturaColorPreview"),v(e,"title",t[0]),v(e,"style",n="--color:"+t[1])},m(r,o){et(r,e,o),kt(e,i)},p(r,[o]){1&o&&v(e,"title",r[0]),2&o&&n!==(n="--color:"+r[1])&&v(e,"style",n)},i:ii,o:ii,d(r){r&&Q(e)}}}function I5(t,e,i){let n,{color:r}=e,{title:o}=e;return t.$$set=a=>{"color"in a&&i(2,r=a.color),"title"in a&&i(0,o=a.title)},t.$$.update=()=>{4&t.$$.dirty&&i(1,n=r?gr(r):"transparent")},[o,n,r]}class Jh extends li{constructor(e){super(),si(this,e,I5,R5,ri,{color:2,title:0})}}var z2=t=>(t=t.trim(),/^rgba/.test(t)?t.substr(5).split(",").map(parseFloat).map((e,i)=>e/(i===3?1:255)):/^rgb/.test(t)?t.substr(4).split(",").map(parseFloat).map(e=>e/255):/^#/.test(t)?(e=>{const[,i,n,r,o]=e.split("");e=e.length>=4&&e.length<=5?`#${i}${i}${n}${n}${r}${r}${o?`${o}${o}`:""}`:e;const[a,s,l,c,d]=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})?$/i.exec(e)||[];if(a)return[s,l,c,d].filter(u=>u!==void 0).map(u=>parseInt(u,16)/255)})(t):/[0-9]{1,3}\s?,\s?[0-9]{1,3}\s?,\s?[0-9]{1,3}/.test(t)?t.split(",").map(e=>parseInt(e,10)).map(e=>e/255):void 0);function gg(t){let e,i;return{c(){e=ht("span"),i=$n(t[0])},m(n,r){et(n,e,r),kt(e,i)},p(n,r){1&r[0]&&An(i,n[0])},d(n){n&&Q(e)}}}function E5(t){let e,i,n,r;i=new Jh({props:{color:t[4],title:or(t[8],t[10])}});let o=!t[9]&&gg(t);return{c(){e=ht("span"),Et(i.$$.fragment),n=me(),o&&o.c(),v(e,"slot","label"),v(e,"class","PinturaButtonLabel")},m(a,s){et(a,e,s),Rt(i,e,null),kt(e,n),o&&o.m(e,null),r=!0},p(a,s){const l={};16&s[0]&&(l.color=a[4]),1280&s[0]&&(l.title=or(a[8],a[10])),i.$set(l),a[9]?o&&(o.d(1),o=null):o?o.p(a,s):(o=gg(a),o.c(),o.m(e,null))},i(a){r||(P(i.$$.fragment,a),r=!0)},o(a){z(i.$$.fragment,a),r=!1},d(a){a&&Q(e),It(i),o&&o.d()}}}function fg(t){let e,i,n,r,o,a,s,l,c,d,u,p,h,g;c=new Kh({props:{class:"PinturaHuePicker",knobStyle:"background-color:"+t[20],onchange:t[26],value:t[15],min:0,max:1,step:.01}});let m=t[11]&&yg(t),f=t[14]&&xg(t);return{c(){e=ht("div"),i=ht("div"),n=ht("div"),r=ht("div"),l=me(),Et(c.$$.fragment),d=me(),m&&m.c(),u=me(),f&&f.c(),v(r,"role","button"),v(r,"aria-label","Saturation slider"),v(r,"class","PinturaPickerKnob"),v(r,"tabindex","0"),v(r,"style",o=`background-color:${t[19]};`),v(n,"class","PinturaPickerKnobController"),v(n,"style",a=`transform:translate(${t[24]}%,${t[23]}%)`),v(i,"class","PinturaSaturationPicker"),v(i,"style",s="background-color: "+t[20]),v(e,"class","PinturaPicker")},m(b,w){et(b,e,w),kt(e,i),kt(i,n),kt(n,r),t[38](i),kt(e,l),Rt(c,e,null),kt(e,d),m&&m.m(e,null),kt(e,u),f&&f.m(e,null),p=!0,h||(g=[Pt(r,"nudge",t[29]),Xi(Fs.call(null,r,{preventDefault:!0})),Pt(i,"pointerdown",t[28])],h=!0)},p(b,w){(!p||524288&w[0]&&o!==(o=`background-color:${b[19]};`))&&v(r,"style",o),(!p||25165824&w[0]&&a!==(a=`transform:translate(${b[24]}%,${b[23]}%)`))&&v(n,"style",a),(!p||1048576&w[0]&&s!==(s="background-color: "+b[20]))&&v(i,"style",s);const S={};1048576&w[0]&&(S.knobStyle="background-color:"+b[20]),32768&w[0]&&(S.value=b[15]),c.$set(S),b[11]?m?(m.p(b,w),2048&w[0]&&P(m,1)):(m=yg(b),m.c(),P(m,1),m.m(e,u)):m&&(Pe(),z(m,1,1,()=>{m=null}),Re()),b[14]?f?f.p(b,w):(f=xg(b),f.c(),f.m(e,null)):f&&(f.d(1),f=null)},i(b){p||(P(c.$$.fragment,b),P(m),p=!0)},o(b){z(c.$$.fragment,b),z(m),p=!1},d(b){b&&Q(e),t[38](null),It(c),m&&m.d(),f&&f.d(),h=!1,Ui(g)}}}function yg(t){let e,i;return e=new Kh({props:{class:"PinturaOpacityPicker",knobStyle:"background-color:"+t[17],trackStyle:`background-image:linear-gradient(to right,${t[18]},${t[19]})`,onchange:t[27],value:t[16],min:0,max:1,step:.01}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};131072&r[0]&&(o.knobStyle="background-color:"+n[17]),786432&r[0]&&(o.trackStyle=`background-image:linear-gradient(to right,${n[18]},${n[19]})`),65536&r[0]&&(o.value=n[16]),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function xg(t){let e,i,n;return{c(){e=ht("input"),v(e,"class","PinturaColorPickerInput"),v(e,"type","text"),e.value=t[22]},m(r,o){et(r,e,o),i||(n=[Pt(e,"keydown",t[31]),Pt(e,"input",t[30])],i=!0)},p(r,o){4194304&o[0]&&e.value!==r[22]&&(e.value=r[22])},d(r){r&&Q(e),i=!1,Ui(n)}}}function bg(t){let e,i;return e=new as({props:{label:or(t[10].labelColorPalette,t[10]),class:$i(["PinturaColorPresets",t[9]?"PinturaColorPresetsGrid":"PinturaColorPresetsList"]),hideLabel:!1,name:t[1],value:t[4],optionGroupClass:"PinturaListOptionGroup",optionClass:"PinturaListOption",options:t[2].map(t[39]),selectedIndex:t[3],optionMapper:t[7],optionLabelClass:t[6],onchange:t[40],$$slots:{option:[L5,({option:n})=>({52:n}),({option:n})=>[0,n?2097152:0]],group:[A5,({option:n})=>({52:n}),({option:n})=>[0,n?2097152:0]]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};1024&r[0]&&(o.label=or(n[10].labelColorPalette,n[10])),512&r[0]&&(o.class=$i(["PinturaColorPresets",n[9]?"PinturaColorPresetsGrid":"PinturaColorPresetsList"])),2&r[0]&&(o.name=n[1]),16&r[0]&&(o.value=n[4]),1028&r[0]&&(o.options=n[2].map(n[39])),8&r[0]&&(o.selectedIndex=n[3]),128&r[0]&&(o.optionMapper=n[7]),64&r[0]&&(o.optionLabelClass=n[6]),512&r[0]|6291456&r[1]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function A5(t){let e,i,n=t[52].label+"";return{c(){e=ht("span"),i=$n(n),v(e,"slot","group")},m(r,o){et(r,e,o),kt(e,i)},p(r,o){2097152&o[1]&&n!==(n=r[52].label+"")&&An(i,n)},d(r){r&&Q(e)}}}function vg(t){let e,i,n=t[52].label+"";return{c(){e=ht("span"),i=$n(n),v(e,"class","PinturaButtonLabel")},m(r,o){et(r,e,o),kt(e,i)},p(r,o){2097152&o[1]&&n!==(n=r[52].label+"")&&An(i,n)},d(r){r&&Q(e)}}}function L5(t){let e,i,n,r;i=new Jh({props:{title:t[52].label,color:t[52].value}});let o=!t[9]&&vg(t);return{c(){e=ht("span"),Et(i.$$.fragment),n=me(),o&&o.c(),v(e,"slot","option")},m(a,s){et(a,e,s),Rt(i,e,null),kt(e,n),o&&o.m(e,null),r=!0},p(a,s){const l={};2097152&s[1]&&(l.title=a[52].label),2097152&s[1]&&(l.color=a[52].value),i.$set(l),a[9]?o&&(o.d(1),o=null):o?o.p(a,s):(o=vg(a),o.c(),o.m(e,null))},i(a){r||(P(i.$$.fragment,a),r=!0)},o(a){z(i.$$.fragment,a),r=!1},d(a){a&&Q(e),It(i),o&&o.d()}}}function z5(t){let e,i,n,r=t[13]&&fg(t),o=t[12]&&bg(t);return{c(){e=ht("div"),r&&r.c(),i=me(),o&&o.c(),v(e,"slot","details"),v(e,"class","PinturaColorPickerPanel")},m(a,s){et(a,e,s),r&&r.m(e,null),kt(e,i),o&&o.m(e,null),n=!0},p(a,s){a[13]?r?(r.p(a,s),8192&s[0]&&P(r,1)):(r=fg(a),r.c(),P(r,1),r.m(e,i)):r&&(Pe(),z(r,1,1,()=>{r=null}),Re()),a[12]?o?(o.p(a,s),4096&s[0]&&P(o,1)):(o=bg(a),o.c(),P(o,1),o.m(e,null)):o&&(Pe(),z(o,1,1,()=>{o=null}),Re())},i(a){n||(P(r),P(o),n=!0)},o(a){z(r),z(o),n=!1},d(a){a&&Q(e),r&&r.d(),o&&o.d()}}}function F5(t){let e,i;return e=new Ou({props:{buttonClass:$i(["PinturaColorPickerButton",t[5]]),$$slots:{details:[z5],label:[E5]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};32&r[0]&&(o.buttonClass=$i(["PinturaColorPickerButton",n[5]])),33554399&r[0]|4194304&r[1]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function D5(t,e,i){let n,r,o,a,s,l,c,d,u,p,h,g,m,f,{label:b}=e,{name:w}=e,{options:S=[]}=e,{selectedIndex:C=-1}=e,{value:R}=e,{buttonClass:M}=e,{optionLabelClass:D}=e,{optionMapper:T}=e,{onchange:F}=e,{title:W}=e,{hidePresetLabel:B=!0}=e,{locale:y}=e,{enableOpacity:V=!0}=e,{enablePresets:tt=!0}=e,{enablePicker:k=!0}=e,{enableInput:N=!1}=e;const it=(Z,bt)=>{if(u=[Z[0],Z[1],Z[2]],bt){let nt=(($t,Lt,ie)=>{let Vt=Math.max($t,Lt,ie),te=Vt-Math.min($t,Lt,ie),Yt=te&&(Vt==$t?(Lt-ie)/te:Vt==Lt?2+(ie-$t)/te:4+($t-Lt)/te);return[60*(Yt<0?Yt+6:Yt)/360,Vt&&te/Vt,Vt]})(...u);i(15,s=nt[0]),i(33,l=nt[1]),i(34,c=nt[2]),i(16,d=ui(Z[3])?Z[3]:1)}i(17,p=gr(Z)),i(18,h=gr([...u,0])),i(19,g=gr([...u,1])),i(20,m=gr($g(s,1,1)))},ut=()=>{const Z=[...$g(s,l,c),d];it(Z),F(Z)},st=Z=>{const bt=Z.length===3?[...Z,1]:Z;it(bt,!0),F(bt)},mt=(Z,bt)=>{const nt=rn(Z.x/bt.width,0,1),$t=rn(Z.y/bt.height,0,1);var Lt;Lt=1-$t,i(33,l=nt),i(34,c=Lt),d===0&&i(16,d=1),ut()};let G,gt,vt,lt;const St=Z=>{const bt=Dn($m(Z),lt);mt(Fn(Oe(vt),bt),gt)},J=Z=>{gt=void 0,document.documentElement.removeEventListener("pointermove",St),document.documentElement.removeEventListener("pointerup",J)};let q;return t.$$set=Z=>{"label"in Z&&i(0,b=Z.label),"name"in Z&&i(1,w=Z.name),"options"in Z&&i(2,S=Z.options),"selectedIndex"in Z&&i(3,C=Z.selectedIndex),"value"in Z&&i(4,R=Z.value),"buttonClass"in Z&&i(5,M=Z.buttonClass),"optionLabelClass"in Z&&i(6,D=Z.optionLabelClass),"optionMapper"in Z&&i(7,T=Z.optionMapper),"onchange"in Z&&i(32,F=Z.onchange),"title"in Z&&i(8,W=Z.title),"hidePresetLabel"in Z&&i(9,B=Z.hidePresetLabel),"locale"in Z&&i(10,y=Z.locale),"enableOpacity"in Z&&i(11,V=Z.enableOpacity),"enablePresets"in Z&&i(12,tt=Z.enablePresets),"enablePicker"in Z&&i(13,k=Z.enablePicker),"enableInput"in Z&&i(14,N=Z.enableInput)},t.$$.update=()=>{16&t.$$.dirty[0]|16&t.$$.dirty[1]&&(!R||f&&os(R,f)||(i(35,f=[...R]),it(R,!0))),4&t.$$.dirty[1]&&i(24,n=100*l),8&t.$$.dirty[1]&&i(23,r=100-100*c),32&t.$$.dirty[1]&&i(37,o=!!q&&q.length>=4&&q.length<=5),18448&t.$$.dirty[0]|64&t.$$.dirty[1]&&i(22,a=N&&R?((Z,bt,nt)=>{let $t=Z.map(Lt=>Math.round(255*Lt).toString(16).toLowerCase().padStart(2,"0"));return(!bt&&$t.length>3||$t[3]==="ff")&&$t.pop(),nt&&($t=$t.map(Lt=>Lt.substring(0,1))),"#"+$t.join("")})(R,V,o):void 0)},[b,w,S,C,R,M,D,T,W,B,y,V,tt,k,N,s,d,p,h,g,m,G,a,r,n,st,Z=>{i(15,s=Z),d===0&&i(16,d=1),ut()},Z=>{i(16,d=Z),ut()},Z=>{Z.stopPropagation(),gt=Vn(G.offsetWidth,G.offsetHeight),vt=(bt=>ot(bt.offsetX,bt.offsetY))(Z),lt=$m(Z),mt(vt,gt),document.documentElement.addEventListener("pointermove",St),document.documentElement.addEventListener("pointerup",J)},Z=>{gt=Vn(G.offsetWidth,G.offsetHeight);const bt=n/100*gt.width,nt=r/100*gt.height;mt({x:bt+Z.detail.x,y:nt+Z.detail.y},gt)},Z=>{const{value:bt}=Z.target,nt=bt.length;if(!bt.startsWith("#")||nt<4||nt===6||nt===8||nt>9||!V&&nt>7)return;const $t=z2(bt);$t&&(i(36,q=bt),it($t),F($t))},Z=>{Z.stopPropagation()},F,l,c,f,q,o,function(Z){Fi[Z?"unshift":"push"](()=>{G=Z,i(21,G)})},([Z,bt])=>[Z,cn(bt)?bt(y):bt],Z=>st(Z.value)]}class B5 extends li{constructor(e){super(),si(this,e,D5,F5,ri,{label:0,name:1,options:2,selectedIndex:3,value:4,buttonClass:5,optionLabelClass:6,optionMapper:7,onchange:32,title:8,hidePresetLabel:9,locale:10,enableOpacity:11,enablePresets:12,enablePicker:13,enableInput:14},null,[-1,-1])}}function O5(t){let e,i,n;return i=new ro({props:{items:t[0]}}),{c(){e=ht("div"),Et(i.$$.fragment),v(e,"class","PinturaShorthandControl PinturaShapeStyle")},m(r,o){et(r,e,o),Rt(i,e,null),n=!0},p(r,[o]){const a={};1&o&&(a.items=r[0]),i.$set(a)},i(r){n||(P(i.$$.fragment,r),n=!0)},o(r){z(i.$$.fragment,r),n=!1},d(r){r&&Q(e),It(i)}}}function W5(t,e,i){let n,r,{value:o}=e,{onchange:a}=e,{controls:s=[]}=e;return t.$$set=l=>{i(6,e=Tn(Tn({},e),Fc(l))),"value"in l&&i(1,o=l.value),"onchange"in l&&i(2,a=l.onchange),"controls"in l&&i(3,s=l.controls)},t.$$.update=()=>{i(4,n=(l=>{const{controls:c,...d}=l;return d})(e)),30&t.$$.dirty&&i(0,r=s.map((l,c)=>{const[d,u,p]=l;return[d,u,{...n,...p,value:o[c],onchange:h=>{const g=[...o];g[c]=h,a(g)}}]}))},e=Fc(e),[r,o,a,s,n]}class _5 extends li{constructor(e){super(),si(this,e,W5,O5,ri,{value:1,onchange:2,controls:3})}}function V5(t){let e,i;return e=new qh({props:{label:t[4],options:t[1],title:t[2],selectedIndex:t[5],onchange:t[10]}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,[r]){const o={};16&r&&(o.label=n[4]),2&r&&(o.options=n[1]),4&r&&(o.title=n[2]),32&r&&(o.selectedIndex=n[5]),9&r&&(o.onchange=n[10]),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function N5(t,e,i){let n,r,o,a,{options:s}=e,{title:l}=e,{onchange:c}=e,{selectedIndex:d=-1}=e,{value:u}=e,{label:p}=e;return t.$$set=h=>{"options"in h&&i(1,s=h.options),"title"in h&&i(2,l=h.title),"onchange"in h&&i(3,c=h.onchange),"selectedIndex"in h&&i(0,d=h.selectedIndex),"value"in h&&i(6,u=h.value),"label"in h&&i(7,p=h.label)},t.$$.update=()=>{67&t.$$.dirty&&i(9,n=((h,g,m)=>{if(h)return g>-1?h[g]:m!==void 0?h.find(f=>f[0]===m):h[0]})(s,d,u)),514&t.$$.dirty&&i(5,r=s&&s.findIndex(h=>h===n)),512&t.$$.dirty&&i(8,o=n&&n[1]),384&t.$$.dirty&&i(4,a=p||o)},[d,s,l,c,a,r,u,p,o,n,h=>{i(0,d=h.index),c&&c(h)}]}class H5 extends li{constructor(e){super(),si(this,e,N5,V5,ri,{options:1,title:2,onchange:3,selectedIndex:0,value:6,label:7})}}function wg(t,e,i){const n=t.slice();return n[9]=e[i][0],n[0]=e[i][1],n[10]=e[i][2],n[2]=e[i][3],n}function j5(t){let e,i,n;const r=[t[10]];var o=t[3][t[9]]||t[9];function a(s){let l={};for(let c=0;c<r.length;c+=1)l=Tn(l,r[c]);return{props:l}}return o&&(e=Su(o,a())),{c(){e&&Et(e.$$.fragment),i=Mn()},m(s,l){e&&Rt(e,s,l),et(s,i,l),n=!0},p(s,l){const c=4&l?yr(r,[Pr(s[10])]):{};if(o!==(o=s[3][s[9]]||s[9])){if(e){Pe();const d=e;z(d.$$.fragment,1,0,()=>{It(d,1)}),Re()}o?(e=Su(o,a()),Et(e.$$.fragment),P(e.$$.fragment,1),Rt(e,i.parentNode,i)):e=null}else o&&e.$set(c)},i(s){n||(e&&P(e.$$.fragment,s),n=!0)},o(s){e&&z(e.$$.fragment,s),n=!1},d(s){s&&Q(i),e&&It(e,s)}}}function U5(t){let e,i=t[9],n=t[9]&&zp(t);return{c(){n&&n.c(),e=Mn()},m(r,o){n&&n.m(r,o),et(r,e,o)},p(r,o){r[9]?i?ri(i,r[9])?(n.d(1),n=zp(r),n.c(),n.m(e.parentNode,e)):n.p(r,o):(n=zp(r),n.c(),n.m(e.parentNode,e)):i&&(n.d(1),n=null),i=r[9]},i:ii,o(r){z(n)},d(r){r&&Q(e),n&&n.d(r)}}}function G5(t){let e,i,n=t[10].innerHTML+"";return{c(){e=new Lu(!1),i=Mn(),e.a=i},m(r,o){e.m(n,r,o),et(r,i,o)},p(r,o){4&o&&n!==(n=r[10].innerHTML+"")&&e.p(n)},i:ii,o:ii,d(r){r&&Q(i),r&&e.d()}}}function Z5(t){let e,i=t[10].textContent+"";return{c(){e=$n(i)},m(n,r){et(n,e,r)},p(n,r){4&r&&i!==(i=n[10].textContent+"")&&An(e,i)},i:ii,o:ii,d(n){n&&Q(e)}}}function X5(t){let e,i;return e=new ro({props:{items:t[2],discardEmptyItems:!0}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};4&r&&(o.items=n[2]),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function zp(t){let e,i,n,r,o;const a=[X5,Z5,G5],s=[];function l(u,p){return u[2]&&u[2].length?0:u[10].textContent?1:u[10].innerHTML?2:-1}~(i=l(t))&&(n=s[i]=a[i](t));let c=[t[4](t[10])],d={};for(let u=0;u<c.length;u+=1)d=Tn(d,c[u]);return{c(){e=ht(t[9]),n&&n.c(),r=me(),/-/.test(t[9])?qm(e,d):Ym(e,d)},m(u,p){et(u,e,p),~i&&s[i].m(e,null),kt(e,r),o=!0},p(u,p){let h=i;i=l(u),i===h?~i&&s[i].p(u,p):(n&&(Pe(),z(s[h],1,1,()=>{s[h]=null}),Re()),~i?(n=s[i],n?n.p(u,p):(n=s[i]=a[i](u),n.c()),P(n,1),n.m(e,r)):n=null),d=yr(c,[4&p&&u[4](u[10])]),/-/.test(u[9])?qm(e,d):Ym(e,d)},i(u){o||(P(n),o=!0)},o(u){z(n),o=!1},d(u){u&&Q(e),~i&&s[i].d()}}}function Sg(t,e){let i,n,r,o,a,s;const l=[U5,j5],c=[];function d(u,p){return 4&p&&(n=null),n==null&&(n=!u[5](u[9])),n?0:1}return r=d(e,-1),o=c[r]=l[r](e),{key:t,first:null,c(){i=Mn(),o.c(),a=Mn(),this.first=i},m(u,p){et(u,i,p),c[r].m(u,p),et(u,a,p),s=!0},p(u,p){let h=r;r=d(e=u,p),r===h?c[r].p(e,p):(Pe(),z(c[h],1,1,()=>{c[h]=null}),Re(),o=c[r],o?o.p(e,p):(o=c[r]=l[r](e),o.c()),P(o,1),o.m(a.parentNode,a))},i(u){s||(P(o),s=!0)},o(u){z(o),s=!1},d(u){u&&Q(i),c[r].d(u),u&&Q(a)}}}function Y5(t){let e,i,n=[],r=new Map,o=t[2];const a=s=>s[0]+s[1];for(let s=0;s<o.length;s+=1){let l=wg(t,o,s),c=a(l);r.set(c,n[s]=Sg(c,l))}return{c(){for(let s=0;s<n.length;s+=1)n[s].c();e=Mn()},m(s,l){for(let c=0;c<n.length;c+=1)n[c].m(s,l);et(s,e,l),i=!0},p(s,[l]){62&l&&(o=s[2],Pe(),n=Da(n,l,a,1,s,o,r,e.parentNode,As,Sg,e,wg),Re())},i(s){if(!i){for(let l=0;l<o.length;l+=1)P(n[l]);i=!0}},o(s){for(let l=0;l<n.length;l+=1)z(n[l]);i=!1},d(s){for(let l=0;l<n.length;l+=1)n[l].d(s);s&&Q(e)}}}function q5(t,e,i){let n,r,{items:o}=e,{discardEmptyItems:a=!0}=e,{key:s=""}=e;const l={Button:Ls,ImageButton:M2,ImageButtonList:Yh,Dropdown:qh,Select:H5,RadioGroup:as,Input:L2,Panel:m5,ProgressIndicator:C2,ShapeStyle:P5,ToggleSlider:C5,ColorPicker:B5,ShorthandControl:_5},c=u=>!Ve(u)||!!l[u],d=u=>{if(!u)return!1;const[p,,h,g=[]]=u;return!!c(p)||g.some(d)||h.textContent||h.innerHTML};return t.$$set=u=>{"items"in u&&i(6,o=u.items),"discardEmptyItems"in u&&i(7,a=u.discardEmptyItems),"key"in u&&i(0,s=u.key)},t.$$.update=()=>{1&t.$$.dirty&&i(1,n=s),192&t.$$.dirty&&i(2,r=(o&&a?o.filter(d):o)||[])},[s,n,r,l,(u={})=>{const{textContent:p,innerHTML:h,...g}=u;return g},c,o,a]}class ro extends li{constructor(e){super(),si(this,e,q5,Y5,ri,{items:6,discardEmptyItems:7,key:0})}get items(){return this.$$.ctx[6]}set items(e){this.$$set({items:e}),I()}get discardEmptyItems(){return this.$$.ctx[7]}set discardEmptyItems(e){this.$$set({discardEmptyItems:e}),I()}get key(){return this.$$.ctx[0]}set key(e){this.$$set({key:e}),I()}}let Fp=null;var K5=t=>{if(Fp===null&&(Fp=Mr()&&"visualViewport"in window),!Fp)return!1;const e=visualViewport.height,i=()=>{t(visualViewport.height<e?"visible":"hidden")};return visualViewport.addEventListener("resize",i),()=>visualViewport.removeEventListener("resize",i)};function kg(t){let e,i;const n=[{onclick:t[1]},t[3]];let r={};for(let o=0;o<n.length;o+=1)r=Tn(r,n[o]);return e=new Ls({props:r}),{c(){Et(e.$$.fragment)},m(o,a){Rt(e,o,a),i=!0},p(o,a){const s=10&a[0]?yr(n,[2&a[0]&&{onclick:o[1]},8&a[0]&&Pr(o[3])]):{};e.$set(s)},i(o){i||(P(e.$$.fragment,o),i=!0)},o(o){z(e.$$.fragment,o),i=!1},d(o){It(e,o)}}}function Cg(t){let e,i;const n=[{onclick:t[0]},{class:"PinturaInputFormButtonConfirm"},t[2]];let r={};for(let o=0;o<n.length;o+=1)r=Tn(r,n[o]);return e=new Ls({props:r}),{c(){Et(e.$$.fragment)},m(o,a){Rt(e,o,a),i=!0},p(o,a){const s=5&a[0]?yr(n,[1&a[0]&&{onclick:o[0]},n[1],4&a[0]&&Pr(o[2])]):{};e.$set(s)},i(o){i||(P(e.$$.fragment,o),i=!0)},o(o){z(e.$$.fragment,o),i=!1},d(o){It(e,o)}}}function J5(t){let e,i,n,r,o,a,s,l,c=t[3]&&kg(t);const d=t[24].default,u=ar(d,t,t[23],null);let p=t[2]&&Cg(t);return{c(){e=ht("div"),i=ht("div"),c&&c.c(),n=me(),r=ht("div"),u&&u.c(),o=me(),p&&p.c(),v(r,"class","PinturaInputFormFields"),v(i,"class","PinturaInputFormInner"),v(e,"class","PinturaInputForm"),v(e,"data-layout",t[4]),v(e,"style",t[6])},m(h,g){et(h,e,g),kt(e,i),c&&c.m(i,null),kt(i,n),kt(i,r),u&&u.m(r,null),kt(i,o),p&&p.m(i,null),t[25](e),a=!0,s||(l=[Pt(r,"keydown",t[10]),Pt(e,"focusin",t[7]),Pt(e,"focusout",t[8]),Pt(e,"measure",t[9]),Xi(xr.call(null,e))],s=!0)},p(h,g){h[3]?c?(c.p(h,g),8&g[0]&&P(c,1)):(c=kg(h),c.c(),P(c,1),c.m(i,n)):c&&(Pe(),z(c,1,1,()=>{c=null}),Re()),u&&u.p&&(!a||8388608&g[0])&&lr(u,d,h,h[23],a?sr(d,h[23],g,null):cr(h[23]),null),h[2]?p?(p.p(h,g),4&g[0]&&P(p,1)):(p=Cg(h),p.c(),P(p,1),p.m(i,null)):p&&(Pe(),z(p,1,1,()=>{p=null}),Re()),(!a||16&g[0])&&v(e,"data-layout",h[4]),(!a||64&g[0])&&v(e,"style",h[6])},i(h){a||(P(c),P(u,h),P(p),a=!0)},o(h){z(c),z(u,h),z(p),a=!1},d(h){h&&Q(e),c&&c.d(),u&&u.d(h),p&&p.d(),t[25](null),s=!1,Ui(l)}}}function Q5(t,e,i){let n,r,o,a,s,{$$slots:l={},$$scope:c}=e,{onconfirm:d}=e,{oncancel:u}=e,{autoFocus:p=!0}=e,{autoPositionCursor:h=!0}=e,{buttonConfirm:g}=e,{buttonCancel:m}=e,{layout:f="stack"}=e,{parentRect:b}=e,{align:w}=e,{justify:S}=e,{parentMargin:C=16}=e,{panelOffset:R=ln()}=e,M=!1,D,T,F="",W=0;const B=()=>{const k=s.querySelector("input, textarea");k.focus(),W>=1||k.select()},y=()=>{M=!0,tt||!ra()&&!Pu()||i(19,F="top:1em;bottom:auto;"),ra()&&(k=>{let N;const it=st=>N=st.touches[0].screenY,ut=st=>{const mt=st.touches[0].screenY,G=st.target;/textarea/i.test(G.nodeName)?(mt>N?G.scrollTop==0&&st.preventDefault():mt<N?G.scrollTop+G.offsetHeight==G.scrollHeight&&st.preventDefault():st.preventDefault(),N=mt):st.preventDefault()};k.addEventListener("touchstart",it),k.addEventListener("touchmove",ut)})(s),i(20,W=1)};let V;const tt=K5(k=>{o?k!=="hidden"||M?(clearTimeout(T),T=void 0,i(19,F=`top:${visualViewport.height-D.height-R.y}px`),k==="visible"?(i(5,s.dataset.stick=!0,s),B(),y()):(M=!1,i(20,W=0))):B():i(19,F="top: 4.5em; bottom: auto")});return Es(()=>{p&&B()}),Wo(()=>{tt&&tt()}),t.$$set=k=>{"onconfirm"in k&&i(0,d=k.onconfirm),"oncancel"in k&&i(1,u=k.oncancel),"autoFocus"in k&&i(11,p=k.autoFocus),"autoPositionCursor"in k&&i(12,h=k.autoPositionCursor),"buttonConfirm"in k&&i(2,g=k.buttonConfirm),"buttonCancel"in k&&i(3,m=k.buttonCancel),"layout"in k&&i(4,f=k.layout),"parentRect"in k&&i(13,b=k.parentRect),"align"in k&&i(14,w=k.align),"justify"in k&&i(15,S=k.justify),"parentMargin"in k&&i(16,C=k.parentMargin),"panelOffset"in k&&i(17,R=k.panelOffset),"$$scope"in k&&i(23,c=k.$$scope)},t.$$.update=()=>{385024&t.$$.dirty[0]&&i(21,n=b&&D?((k,N,it,ut,st)=>{let mt,G;return mt=ut==="center"?k.x+.5*k.width-.5*N.width:ut==="right"?k.x+k.width-N.width-st:k.x+st,G=it==="center"?k.y+.5*k.height-.5*N.height:it==="bottom"?k.y+k.height-N.height-st:k.y+st,`left:${mt}px;top:${G}px;right:auto;bottom:auto;`})(b,D,w,S,C):void 0),32&t.$$.dirty[0]&&i(22,r=s&&getComputedStyle(s)),4194304&t.$$.dirty[0]&&(o=r&&r.getPropertyValue("--editor-modal")==="1"),3670016&t.$$.dirty[0]&&i(6,a=`opacity:${W};${n||F}`)},[d,u,g,m,f,s,a,k=>{var N;((it=>/textarea/i.test(it))(k.target)||P2(k.target))&&(V=Date.now(),h&&((N=k.target).selectionStart=N.selectionEnd=N.value.length),clearTimeout(T),T=setTimeout(y,200))},k=>{Date.now()-V>50||(k.stopPropagation(),B())},({detail:k})=>{i(18,D={width:k.width,height:k.height})},k=>k.key==="Enter"?d():k.key==="Escape"?u():void 0,p,h,b,w,S,C,R,D,F,W,n,r,c,l,function(k){Fi[k?"unshift":"push"](()=>{s=k,i(5,s)})}]}class F2 extends li{constructor(e){super(),si(this,e,Q5,J5,ri,{onconfirm:0,oncancel:1,autoFocus:11,autoPositionCursor:12,buttonConfirm:2,buttonCancel:3,layout:4,parentRect:13,align:14,justify:15,parentMargin:16,panelOffset:17},null,[-1,-1])}}var Tg=(t,e)=>{t.fastSeek&&t.fastSeek(e),t.currentTime=e};const t3=["aspectRatio","isRotatedSideways","flip","cropSize"],Mg=_h.map(([t])=>t).filter(t=>!t3.includes(t));var gs=(t,e)=>new CustomEvent("ping",{detail:{type:t,data:e},cancelable:!0,bubbles:!0}),D2=(t,e)=>(e?Hh(t,e):t).replace(/([a-z])([A-Z])/g,"$1-$2").replace(/\s+/g,"-").toLowerCase(),Pg=(t,e=Ji)=>{const{subscribe:i,set:n}=he(void 0);return{subscribe:i,destroy:((r,o)=>{const a=matchMedia(r);return a.addListener(o),o(a),{get matches(){return a.matches},destroy:()=>a.removeListener(o)}})(t,({matches:r})=>n(e(r))).destroy}},Rg=(t,e,i)=>new Promise((n,r)=>{(async()=>{cl(t)&&n(await d2(t));const o=await e.read(t),a=l=>Qf(l,i).then(c=>e.apply(c,o)).then(n).catch(r);if(Jf(t)||!Kf()||La()||ra())return a(t);let s;try{s=await Nc((l,c)=>createImageBitmap(l).then(d=>c(null,d)).catch(c),[t])}catch{}s&&s.width?await Mu()?Uh()&&o>1?n(await(async l=>Vc(await Nl(l)))(s)):n(s):n(e.apply(s,o)):a(t)})()}),Ig=(t,e)=>new Promise(async i=>{if(t.width<e.width&&t.height<e.height)return i(t);const n=Math.min(e.width/t.width,e.height/t.height),r=n*t.width,o=n*t.height,a=fn("canvas",{width:r,height:o}),s=a.getContext("2d",{willReadFrequently:!0}),l=Fl(t)?await Nl(t):t;s.drawImage(l,0,0,r,o),i(Vc(a))});let Dp=null;var e3=()=>{if(Dp===null){let t=fn("canvas");Dp=!!zu(t),Kn(t),t=void 0}return Dp};const Eg=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],il={precision:1e-4},tu={precision:.01*il.precision};var i3=()=>{const t=[],e=[],i=[],n=()=>{e.forEach(o=>o(i))},r=o=>{o.unsub=o.subscribe(a=>((s,l)=>{const c=t.indexOf(s);c<0||(i[c]=l,n())})(o,a)),n()};return{get length(){return t.length},clear:()=>{t.forEach(o=>o.unsub()),t.length=0,i.length=0},unshift:o=>{t.unshift(o),r(o)},get:o=>t[o],push:o=>{t.push(o),r(o)},remove:o=>{o.unsub();const a=t.indexOf(o);t.splice(a,1),i.splice(a,1)},forEach:o=>t.forEach(o),filter:o=>t.filter(o),subscribe:o=>(e.push(o),o(i),()=>{e.splice(e.indexOf(o),1)})}},Bp=t=>t[0]<.25&&t[1]<.25&&t[2]<.25,B2=(t={})=>new Promise(e=>{const{accept:i="image/*"}=t,n=fn("input",{style:"position:absolute;visibility:hidden;width:0;height:0;",type:"file",accept:i}),r=()=>{const[o]=n.files;n.parentNode&&n.remove(),n.removeEventListener("change",r),e(o)};n.addEventListener("change",r),ra()&&document.body.append(n),n.click()}),Wc=t=>{try{return t()}catch(e){console.error(e)}},n3=([t,e])=>t+.5*(e-t),Cs=t=>Math.round(100*t),Qh=t=>ot(t.clientX,t.clientY),sh=(t,e,i)=>{const n=Qh(t);return Dn(Dn(n,e),i)};function r3(t,e,i){let n,r,o,a,s,l,c,d,u,p,h,g,m,f,b,w,S,C,R,M,D,{root:T}=e,{locale:F}=e,{stores:W}=e,{allowPan:B=!0}=e,{allowZoom:y=!0}=e,{enablePan:V=!0}=e,{enableZoom:tt=!0}=e,{enableZoomControls:k=tt}=e,{enableZoomInput:N=!0}=e,{enablePanInput:it=!0}=e,{enablePanLimit:ut=!0}=e,{panLimitGutterScalar:st=0}=e,{zoomOptions:mt=[.25,.5,1,1.25,1.5,2,3,4,6,8,16]}=e,{zoomAdjustStep:G=.25}=e,{zoomAdjustFactor:gt=.1}=e,{zoomAdjustWheelFactor:vt=1}=e,{elasticity:lt=5}=e,{imageSelectionRectCentered:St}=e,{imageSelectionRectScalar:J}=e,{zoomLevel:q=null}=e,{zoomControls:Z}=e,{zoomMultiTouching:bt=!1}=e;const{isAnimated:nt,isInteracting:$t,rootRect:Lt,stageRect:ie,stageScalar:Vt,imageSelectionPan:te,imageSelectionZoom:Yt,imageSelectionStageFitScalar:U,imageSelectionRect:Tt,imageSelectionStoredState:ct,imagePreviewUpscale:Jt}=W;E(t,nt,K=>i(70,M=K)),E(t,$t,K=>i(69,C=K)),E(t,Lt,K=>i(66,b=K)),E(t,ie,K=>i(65,f=K)),E(t,Vt,K=>i(46,R=K)),E(t,te,K=>i(64,h=K)),E(t,Yt,K=>i(43,p=K)),E(t,U,K=>i(44,g=K)),E(t,Tt,K=>i(67,w=K)),E(t,ct,K=>i(71,D=K)),E(t,Jt,K=>i(45,m=K));const de=un("fixScrollDirection");E(t,de,K=>i(68,S=K));let ee=!1,be,ve,_,Ce;const pi=K=>{const Qt=T.querySelector(".PinturaMain > .PinturaUtilMain")||T.querySelector('div[tabindex="0"] .PinturaUtilMain');return!!Qt&&!!Qt.contains(K.target)&&!Oc(K.target)},we=(K={})=>{const{pan:Qt=h,zoom:Gt=p}=K;wt(ct,D={translation:Qt,zoom:Gt},D)},Bt=()=>h&&h.x===0&&h.y===0,Ae=()=>{wt(Yt,p=void 0,p),Bt()||wt(te,h=ln(),h),We.set(void 0,{hard:!0})},Ee=()=>{Ae(),we()},We=di(void 0,{precision:.01});We.subscribe(K=>{if(K===void 0)return wt(Yt,p=void 0,p),void(Bt()||wt(te,h=ln(),h));const Qt=p;K<=1?Bt()||wt(te,h=ln(),h):K<=Qt&&wt(te,h=Tr(h,.8),h),wt(Yt,p=K,p)});const oi=K=>{We.update(Qt=>{const Gt=K(Qt||g);return we({zoom:Gt}),Gt})},xt=K=>{K?We.set(K,{hard:M===!1}):(K=void 0,We.set(void 0,{hard:!0})),wt(Yt,p=K,p),we({zoom:K})},ge=(K,Qt)=>{const Gt=J*Qt,oe={...St},He=1-rn(st,0,1);Cr(oe,Gt<He?Gt:He);const Ne={...St};Cr(Ne,Gt),ta(Ne,K);const Te={...Ne};return Ne.x>oe.x&&(Te.x=oe.x),Ne.y>oe.y&&(Te.y=oe.y),Ne.x+Ne.width<oe.x+oe.width&&(Te.x=oe.x+oe.width-Ne.width),Ne.y+Ne.height<oe.y+oe.height&&(Te.y=oe.y+oe.height-Ne.height),Dn(Ti(Te),Ti(oe))},Ue=({translation:K,zoom:Qt=1,elastify:Gt=!0})=>{if(!be)return;let oe=K;const He=ot(be.x+oe.x,be.y+oe.y);if(!ut)return He;const Ne=ge(He,Qt);return Gt?y4(Ne,He,lt):Ne};let ze,At;const Ge=()=>{At=void 0,wt($t,C=!0,C),i(34,ee=it),ze=!1,_=!1,be={...h},ve=m?p||g:o?p||1:p||g},Ke=K=>{const{scalar:Qt,translation:Gt,isMultiTouching:oe}=K.detail;if(!be||!oe&&!it)return;oe&&Tr(Gt,.5),(it||oe)&&(ze=!0),bt||i(13,bt=oe);const He=n?rn(ve*Qt,s,l):1,Ne=Ue({translation:Gt,zoom:He,elastify:!0}),Te=vs(Ne);Ce=vs(h),_=Te<Ce,n&&Yt.set(He),te.set(Ne),At=bt&&{translation:K.detail.translation,scalar:Qt}},gi=K=>{wt($t,C=!1,C),i(34,ee=!1),i(13,bt=!1),_&&Ce<50&&(be=void 0,ve=void 0,te.set(ln()))},yi=K=>{wt($t,C=!1,C),i(34,ee=!1),i(13,bt=!1),Promise.resolve().then(()=>{if(ze&&be){const Qt=At||K.detail,Gt=n?rn(ve*Qt.scalar,s,l):1,oe=Ue({elastify:!1,translation:Qt.translation,zoom:Gt});te.set(oe)}be=void 0,ve=void 0,it&&K.detail.isDoubleTap&&Ee(),we()})};let Li,Si=Date.now(),X=0,Zt=!1,H=!1;const qt=K=>{if(!pi(K)||(K.preventDefault(),K.stopPropagation(),H))return;clearTimeout(Li);const Qt=Bu(K,{fixScrollDirection:S}),Gt=Date.now(),oe=Gt-Si;Si=Gt;const He=Math.abs(Qt/oe)>.2;X=He?X+1:0;const Ne=1+-1*Qt*vt/(He?50:100),Te=sh(K,b,f);le(Te,Ne,{isZoomingFast:He})},le=(K,Qt,{isZoomingFast:Gt})=>{const oe=m?p||g:o?p||1:p||g,He=oe*Qt,Ne=ln(),Te=h,Qe=m?g:o?1:g,De=Math.abs(He-Qe),ce=He<oe,Ye=oe>Qe&&ce||oe<Qe&&He>oe,Me=X>=5;if(Gt||(Zt=!1),X>0&&!Zt&&(Zt=Ye),Me&&Zt)return Ee(),H=!0,void setTimeout(()=>{H=!1},100);if(Me)return;!Gt&&Ye&&De<=.05&&(Li=setTimeout(()=>{Ee()},250)),wt(Yt,p=rn(He,s,l),p);const Ze=Ci(w);Cr(Ze,oe),ta(Ze,Te);const Ni=Ti(Ze),ue=Ci(Ze);Cr(ue,p-oe+1,K);const Se=Ti(ue),dn=gm(Dn(Se,Ni),oe);((bn,vn,Nn)=>{bn.x=vn,bn.y=Nn})(Ne,Te.x+dn.x,Te.y+dn.y),wt(te,h=ce&&Gt?Tr(Oe(h),.85):ge(Ne,oe),h),we()},Ut=K=>(K?"add":"remove")+"EventListener";let fe,Xt,Le,Je;const _e=K=>{K.preventDefault(),Xt={...h},Je=Ci(w),Le=sh(K,b,f),fe=m?p||g:o?p||1:p||g},dt=K=>{K.preventDefault(),wt(Yt,p=rn(K.scale*fe,s,l),p);const Qt=Ci(Je);Cr(Qt,fe),ta(Qt,Xt);const Gt=Ti(Qt),oe=Ci(Qt);Cr(oe,p-fe+1,Le);const He=Ti(oe),Ne=gm(Dn(He,Gt),fe),Te={x:Xt.x+Ne.x,y:Xt.y+Ne.y};wt(te,h=ge(Te,p),h)},jt=K=>{K.preventDefault()},ne=K=>{T[Ut(K)]("wheel",qt),ra()||(T[Ut(K)]("gesturestart",_e),T[Ut(K)]("gesturechange",dt),T[Ut(K)]("gestureend",jt))},Fe=K=>{const Qt=Ut(K);T[Qt]("interactionstart",Ge),T[Qt]("interactionupdate",Ke),T[Qt]("interactionrelease",gi),T[Qt]("interactionend",yi)};let Nt;return Es(()=>{Nt=zs(T,{drag:!0,pinch:!0,inertia:!0,inertiaDurationMultiplier:10,shouldStartInteraction:pi})}),Wo(()=>{ne(!1),Fe(!1),Nt.destroy(),Nt=void 0}),t.$$set=K=>{"root"in K&&i(14,T=K.root),"locale"in K&&i(15,F=K.locale),"stores"in K&&i(16,W=K.stores),"allowPan"in K&&i(17,B=K.allowPan),"allowZoom"in K&&i(18,y=K.allowZoom),"enablePan"in K&&i(19,V=K.enablePan),"enableZoom"in K&&i(20,tt=K.enableZoom),"enableZoomControls"in K&&i(21,k=K.enableZoomControls),"enableZoomInput"in K&&i(22,N=K.enableZoomInput),"enablePanInput"in K&&i(23,it=K.enablePanInput),"enablePanLimit"in K&&i(24,ut=K.enablePanLimit),"panLimitGutterScalar"in K&&i(25,st=K.panLimitGutterScalar),"zoomOptions"in K&&i(26,mt=K.zoomOptions),"zoomAdjustStep"in K&&i(27,G=K.zoomAdjustStep),"zoomAdjustFactor"in K&&i(28,gt=K.zoomAdjustFactor),"zoomAdjustWheelFactor"in K&&i(29,vt=K.zoomAdjustWheelFactor),"elasticity"in K&&i(30,lt=K.elasticity),"imageSelectionRectCentered"in K&&i(31,St=K.imageSelectionRectCentered),"imageSelectionRectScalar"in K&&i(32,J=K.imageSelectionRectScalar),"zoomLevel"in K&&i(33,q=K.zoomLevel),"zoomControls"in K&&i(12,Z=K.zoomControls),"zoomMultiTouching"in K&&i(13,bt=K.zoomMultiTouching)},t.$$.update=()=>{var K,Qt;5505024&t.$$.dirty[0]&&i(36,n=y&&tt&&N),655360&t.$$.dirty[0]&&i(35,r=B&&V),393216&t.$$.dirty[0]&&(B||y?(wt(Yt,p=tt?D.zoom:void 0,p),wt(te,h=V?Oe(D.translation):Bt()?h:ln(),h),We.set(p)):Ae()),32768&t.$$.dirty[1]&&(o=R>=1),67141632&t.$$.dirty[0]|57344&t.$$.dirty[1]&&i(40,a=[(m||R<1)&&[g,Cs(g)+"%",{sublabel:F.labelZoomFit}],...mt.map(Gt=>[Gt,Cs(Gt)+"%"])].filter(Boolean).map(Gt=>(Gt[0]===1&&(Gt[2]={sublabel:F.labelZoomActual}),Gt)).sort((Gt,oe)=>{const He=Gt[0]||g,Ne=oe[0]||g;return He<Ne?-1:Ne<He?1:0})),8704&t.$$.dirty[1]&&i(38,s=Math.min(a.reduce((Gt,[oe])=>oe<Gt?oe:Gt,Number.MAX_SAFE_INTEGER),g)),512&t.$$.dirty[1]&&i(37,l=a.reduce((Gt,[oe])=>oe>Gt?oe:Gt,Number.MIN_SAFE_INTEGER)),4&t.$$.dirty[1]&&q!==null&&xt(q),61440&t.$$.dirty[1]&&i(42,d=p||(m||R<1?g:1)),2560&t.$$.dirty[1]&&i(39,(K=a.map(([Gt])=>Gt),Qt=d,c=K.findIndex(Gt=>Gt===Qt))),2048&t.$$.dirty[1]&&i(41,u=Cs(d)+"%"),405045248&t.$$.dirty[0]|6080&t.$$.dirty[1]&&i(12,Z=(y||y)&&k?[["Button","zoom-out",{hideLabel:!0,label:F.labelZoomOut,icon:F.iconZoomOut,disabled:p===s,onclick:()=>oi(Gt=>Math.max(s,Gt-G)),onhold:()=>oi(Gt=>Math.max(s,Gt*(1-gt)))}],["Dropdown","zoom-level",{label:u,labelClass:"PinturaFixedWidthCharacters",options:a,selectedIndex:c,onchange:Gt=>xt(Gt.value)}],["Button","zoom-in",{hideLabel:!0,label:F.labelZoomIn,icon:F.iconZoomIn,disabled:p===l,onclick:()=>oi(Gt=>Math.min(l,Gt+G)),onhold:()=>oi(Gt=>Math.min(l,Gt*(1+gt)))}]]:[]),16384&t.$$.dirty[0]|32&t.$$.dirty[1]&&T&&ne(n),16384&t.$$.dirty[0]|16&t.$$.dirty[1]&&T&&Fe(r),8404992&t.$$.dirty[0]|24&t.$$.dirty[1]&&T&&T.style.setProperty("--cursor",r&&it?ee?"grabbing":"grab":"")},[nt,$t,Lt,ie,Vt,te,Yt,U,Tt,ct,Jt,de,Z,bt,T,F,W,B,y,V,tt,k,N,it,ut,st,mt,G,gt,vt,lt,St,J,q,ee,r,n,l,s,c,a,u,d,p,g,m,R]}class o3 extends li{constructor(e){super(),si(this,e,r3,null,ri,{root:14,locale:15,stores:16,allowPan:17,allowZoom:18,enablePan:19,enableZoom:20,enableZoomControls:21,enableZoomInput:22,enablePanInput:23,enablePanLimit:24,panLimitGutterScalar:25,zoomOptions:26,zoomAdjustStep:27,zoomAdjustFactor:28,zoomAdjustWheelFactor:29,elasticity:30,imageSelectionRectCentered:31,imageSelectionRectScalar:32,zoomLevel:33,zoomControls:12,zoomMultiTouching:13},null,[-1,-1,-1,-1])}}const{window:nl}=qy;function Ag(t){let e,i,n,r=t[41]&&Lg(t),o=t[38]&&Bg(t);return{c(){r&&r.c(),e=me(),o&&o.c(),i=Mn()},m(a,s){r&&r.m(a,s),et(a,e,s),o&&o.m(a,s),et(a,i,s),n=!0},p(a,s){a[41]?r?(r.p(a,s),1024&s[1]&&P(r,1)):(r=Lg(a),r.c(),P(r,1),r.m(e.parentNode,e)):r&&(Pe(),z(r,1,1,()=>{r=null}),Re()),a[38]?o?(o.p(a,s),128&s[1]&&P(o,1)):(o=Bg(a),o.c(),P(o,1),o.m(i.parentNode,i)):o&&(Pe(),z(o,1,1,()=>{o=null}),Re())},i(a){n||(P(r),P(o),n=!0)},o(a){z(r),z(o),n=!1},d(a){r&&r.d(a),a&&Q(e),o&&o.d(a),a&&Q(i)}}}function Lg(t){let e,i,n,r,o,a;const s=[s3,a3],l=[];function c(d,u){return d[39]?0:d[35]?1:-1}return~(n=c(t))&&(r=l[n]=s[n](t)),{c(){e=ht("div"),i=ht("p"),r&&r.c(),v(i,"style",t[72]),v(e,"class","PinturaStatus"),v(e,"style",o="opacity: "+t[54])},m(d,u){et(d,e,u),kt(e,i),~n&&l[n].m(i,null),a=!0},p(d,u){let p=n;n=c(d),n===p?~n&&l[n].p(d,u):(r&&(Pe(),z(l[p],1,1,()=>{l[p]=null}),Re()),~n?(r=l[n],r?r.p(d,u):(r=l[n]=s[n](d),r.c()),P(r,1),r.m(i,null)):r=null),(!a||1024&u[2])&&v(i,"style",d[72]),(!a||8388608&u[1]&&o!==(o="opacity: "+d[54]))&&v(e,"style",o)},i(d){a||(P(r),a=!0)},o(d){z(r),a=!1},d(d){d&&Q(e),~n&&l[n].d()}}}function a3(t){let e,i,n,r;e=new k2({props:{text:t[35].text||"",onmeasure:t[221]}});let o=t[35].aside&&zg(t);return{c(){Et(e.$$.fragment),i=me(),o&&o.c(),n=Mn()},m(a,s){Rt(e,a,s),et(a,i,s),o&&o.m(a,s),et(a,n,s),r=!0},p(a,s){const l={};16&s[1]&&(l.text=a[35].text||""),e.$set(l),a[35].aside?o?(o.p(a,s),16&s[1]&&P(o,1)):(o=zg(a),o.c(),P(o,1),o.m(n.parentNode,n)):o&&(Pe(),z(o,1,1,()=>{o=null}),Re())},i(a){r||(P(e.$$.fragment,a),P(o),r=!0)},o(a){z(e.$$.fragment,a),z(o),r=!1},d(a){It(e,a),a&&Q(i),o&&o.d(a),a&&Q(n)}}}function s3(t){let e,i,n,r;return e=new k2({props:{text:t[39],onmeasure:t[221]}}),n=new T2({props:{class:"PinturaStatusIcon",offset:t[82],opacity:t[83],$$slots:{default:[d3]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment),i=me(),Et(n.$$.fragment)},m(o,a){Rt(e,o,a),et(o,i,a),Rt(n,o,a),r=!0},p(o,a){const s={};256&a[1]&&(s.text=o[39]),e.$set(s);const l={};1048576&a[2]&&(l.offset=o[82]),2097152&a[2]&&(l.opacity=o[83]),8&a[0]|16384&a[19]&&(l.$$scope={dirty:a,ctx:o}),n.$set(l)},i(o){r||(P(e.$$.fragment,o),P(n.$$.fragment,o),r=!0)},o(o){z(e.$$.fragment,o),z(n.$$.fragment,o),r=!1},d(o){It(e,o),o&&Q(i),It(n,o)}}}function zg(t){let e,i;return e=new T2({props:{class:"PinturaStatusButton",offset:t[82],opacity:t[83],$$slots:{default:[l3]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};1048576&r[2]&&(o.offset=n[82]),2097152&r[2]&&(o.opacity=n[83]),16&r[1]|16384&r[19]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function Fg(t){let e,i;return e=new C2({props:{progress:t[35].progressIndicator.progress}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};16&r[1]&&(o.progress=n[35].progressIndicator.progress),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function Dg(t){let e,i;const n=[t[35].closeButton,{hideLabel:!0}];let r={};for(let o=0;o<n.length;o+=1)r=Tn(r,n[o]);return e=new Ls({props:r}),{c(){Et(e.$$.fragment)},m(o,a){Rt(e,o,a),i=!0},p(o,a){const s=16&a[1]?yr(n,[Pr(o[35].closeButton),n[1]]):{};e.$set(s)},i(o){i||(P(e.$$.fragment,o),i=!0)},o(o){z(e.$$.fragment,o),i=!1},d(o){It(e,o)}}}function l3(t){let e,i,n,r=t[35].progressIndicator.visible&&Fg(t),o=t[35].closeButton&&t[35].text&&Dg(t);return{c(){r&&r.c(),e=me(),o&&o.c(),i=Mn()},m(a,s){r&&r.m(a,s),et(a,e,s),o&&o.m(a,s),et(a,i,s),n=!0},p(a,s){a[35].progressIndicator.visible?r?(r.p(a,s),16&s[1]&&P(r,1)):(r=Fg(a),r.c(),P(r,1),r.m(e.parentNode,e)):r&&(Pe(),z(r,1,1,()=>{r=null}),Re()),a[35].closeButton&&a[35].text?o?(o.p(a,s),16&s[1]&&P(o,1)):(o=Dg(a),o.c(),P(o,1),o.m(i.parentNode,i)):o&&(Pe(),z(o,1,1,()=>{o=null}),Re())},i(a){n||(P(r),P(o),n=!0)},o(a){z(r),z(o),n=!1},d(a){r&&r.d(a),a&&Q(e),o&&o.d(a),a&&Q(i)}}}function c3(t){let e,i=t[3].iconSupportError+"";return{c(){e=fr("g")},m(n,r){et(n,e,r),e.innerHTML=i},p(n,r){8&r[0]&&i!==(i=n[3].iconSupportError+"")&&(e.innerHTML=i)},d(n){n&&Q(e)}}}function d3(t){let e,i;return e=new ko({props:{$$slots:{default:[c3]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};8&r[0]|16384&r[19]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function Bg(t){let e,i,n,r,o,a,s,l,c,d,u,p,h,g,m=t[10]&&Og(t),f=t[46]&&t[45]&&Wg(t);const b=[f3,g3],w=[];function S(T,F){return T[46]?0:1}function C(T){t[438](T)}function R(T){t[439](T)}function M(T){t[440](T)}n=S(t),r=w[n]=b[n](t),a=new t4({props:{isAnimated:t[53],isTransparent:t[20],pixelRatio:t[57],textPixelRatio:t[6],backgroundColor:t[56],maskRect:t[58],maskOpacity:t[73]?t[73].maskOpacity:1,maskMarkupOpacity:t[7],maskFrameOpacity:t[5],clipAnnotationsToImage:t[85],images:t[55],interfaceImages:t[86],loadImageData:t[28],enableGrid:t[11],gridSize:t[87],gridColors:[t[88],t[89]],gridOpacity:t[90],selectionColor:t[91],csp:t[92]||{},willRequest:t[81]||t[93],willRender:t[435],didRender:t[436]}});let D={root:t[2],locale:t[3],stores:t[202],allowPan:t[95],enablePan:t[17],enablePanLimit:t[21],panLimitGutterScalar:t[22],enablePanInput:t[96],allowZoom:t[97],enableZoom:t[18],enableZoomInput:t[19]!==void 0?t[19]:t[98],enableZoomControls:t[99],zoomOptions:t[13]||t[23],zoomAdjustStep:t[14]||t[24],zoomAdjustFactor:t[15]||t[25],zoomAdjustWheelFactor:t[16]||t[26],imageSelectionRectCentered:t[100],imageSelectionRectScalar:t[101],elasticity:lh*t[8]};return t[0]!==void 0&&(D.zoomLevel=t[0]),t[33]!==void 0&&(D.zoomControls=t[33]),t[34]!==void 0&&(D.zoomMultiTouching=t[34]),d=new o3({props:D}),Fi.push(()=>go(d,"zoomLevel",C)),Fi.push(()=>go(d,"zoomControls",R)),Fi.push(()=>go(d,"zoomMultiTouching",M)),{c(){m&&m.c(),e=me(),f&&f.c(),i=me(),r.c(),o=me(),Et(a.$$.fragment),s=me(),l=ht("div"),c=me(),Et(d.$$.fragment),v(l,"class","PinturaRootPortal")},m(T,F){m&&m.m(T,F),et(T,e,F),f&&f.m(T,F),et(T,i,F),w[n].m(T,F),et(T,o,F),Rt(a,T,F),et(T,s,F),et(T,l,F),t[437](l),et(T,c,F),Rt(d,T,F),g=!0},p(T,F){T[10]?m?(m.p(T,F),1024&F[0]&&P(m,1)):(m=Og(T),m.c(),P(m,1),m.m(e.parentNode,e)):m&&(Pe(),z(m,1,1,()=>{m=null}),Re()),T[46]&&T[45]?f?(f.p(T,F),49152&F[1]&&P(f,1)):(f=Wg(T),f.c(),P(f,1),f.m(i.parentNode,i)):f&&(Pe(),z(f,1,1,()=>{f=null}),Re());let W=n;n=S(T),n===W?w[n].p(T,F):(Pe(),z(w[W],1,1,()=>{w[W]=null}),Re(),r=w[n],r?r.p(T,F):(r=w[n]=b[n](T),r.c()),P(r,1),r.m(o.parentNode,o));const B={};4194304&F[1]&&(B.isAnimated=T[53]),1048576&F[0]&&(B.isTransparent=T[20]),67108864&F[1]&&(B.pixelRatio=T[57]),64&F[0]&&(B.textPixelRatio=T[6]),33554432&F[1]&&(B.backgroundColor=T[56]),134217728&F[1]&&(B.maskRect=T[58]),2048&F[2]&&(B.maskOpacity=T[73]?T[73].maskOpacity:1),128&F[0]&&(B.maskMarkupOpacity=T[7]),32&F[0]&&(B.maskFrameOpacity=T[5]),8388608&F[2]&&(B.clipAnnotationsToImage=T[85]),16777216&F[1]&&(B.images=T[55]),16777216&F[2]&&(B.interfaceImages=T[86]),268435456&F[0]&&(B.loadImageData=T[28]),2048&F[0]&&(B.enableGrid=T[11]),33554432&F[2]&&(B.gridSize=T[87]),201326592&F[2]&&(B.gridColors=[T[88],T[89]]),268435456&F[2]&&(B.gridOpacity=T[90]),536870912&F[2]&&(B.selectionColor=T[91]),1073741824&F[2]&&(B.csp=T[92]||{}),524288&F[2]|1&F[3]&&(B.willRequest=T[81]||T[93]),512&F[0]|270991424&F[1]|2&F[3]&&(B.willRender=T[435]),62&F[2]&&(B.didRender=T[436]),a.$set(B);const y={};4&F[0]&&(y.root=T[2]),8&F[0]&&(y.locale=T[3]),4&F[3]&&(y.allowPan=T[95]),131072&F[0]&&(y.enablePan=T[17]),2097152&F[0]&&(y.enablePanLimit=T[21]),4194304&F[0]&&(y.panLimitGutterScalar=T[22]),8&F[3]&&(y.enablePanInput=T[96]),16&F[3]&&(y.allowZoom=T[97]),262144&F[0]&&(y.enableZoom=T[18]),524288&F[0]|32&F[3]&&(y.enableZoomInput=T[19]!==void 0?T[19]:T[98]),64&F[3]&&(y.enableZoomControls=T[99]),8396800&F[0]&&(y.zoomOptions=T[13]||T[23]),16793600&F[0]&&(y.zoomAdjustStep=T[14]||T[24]),33587200&F[0]&&(y.zoomAdjustFactor=T[15]||T[25]),67174400&F[0]&&(y.zoomAdjustWheelFactor=T[16]||T[26]),128&F[3]&&(y.imageSelectionRectCentered=T[100]),256&F[3]&&(y.imageSelectionRectScalar=T[101]),256&F[0]&&(y.elasticity=lh*T[8]),!u&&1&F[0]&&(u=!0,y.zoomLevel=T[0],So(()=>u=!1)),!p&&4&F[1]&&(p=!0,y.zoomControls=T[33],So(()=>p=!1)),!h&&8&F[1]&&(h=!0,y.zoomMultiTouching=T[34],So(()=>h=!1)),d.$set(y)},i(T){g||(P(m),P(f),P(r),P(a.$$.fragment,T),P(d.$$.fragment,T),g=!0)},o(T){z(m),z(f),z(r),z(a.$$.fragment,T),z(d.$$.fragment,T),g=!1},d(T){m&&m.d(T),T&&Q(e),f&&f.d(T),T&&Q(i),w[n].d(T),T&&Q(o),It(a,T),T&&Q(s),T&&Q(l),t[437](null),T&&Q(c),It(d,T)}}}function Og(t){let e,i,n,r,o;return i=new ro({props:{items:t[69]}}),{c(){e=ht("div"),Et(i.$$.fragment),v(e,"class","PinturaNav PinturaNavTools")},m(a,s){et(a,e,s),Rt(i,e,null),n=!0,r||(o=[Pt(e,"measure",t[424]),Xi(xr.call(null,e))],r=!0)},p(a,s){const l={};128&s[2]&&(l.items=a[69]),i.$set(l)},i(a){n||(P(i.$$.fragment,a),n=!0)},o(a){z(i.$$.fragment,a),n=!1},d(a){a&&Q(e),It(i),r=!1,Ui(o)}}}function Wg(t){let e,i,n;return i=new ka({props:{elasticity:t[8]*ch,scrollDirection:t[76]?"y":"x",$$slots:{default:[$3]},$$scope:{ctx:t}}}),{c(){e=ht("div"),Et(i.$$.fragment),v(e,"class","PinturaNav PinturaNavMain")},m(r,o){et(r,e,o),Rt(i,e,null),n=!0},p(r,o){const a={};256&o[0]&&(a.elasticity=r[8]*ch),16384&o[2]&&(a.scrollDirection=r[76]?"y":"x"),12288&o[1]|135168&o[2]|16384&o[19]&&(a.$$scope={dirty:o,ctx:r}),i.$set(a)},i(r){n||(P(i.$$.fragment,r),n=!0)},o(r){z(i.$$.fragment,r),n=!1},d(r){r&&Q(e),It(i)}}}function u3(t){let e,i;const n=[t[79],{tabs:t[44]}];let r={$$slots:{default:[m3,({tab:o})=>({602:o}),({tab:o})=>[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,o?8192:0]]},$$scope:{ctx:t}};for(let o=0;o<n.length;o+=1)r=Tn(r,n[o]);return e=new Fu({props:r}),e.$on("select",t[425]),{c(){Et(e.$$.fragment)},m(o,a){Rt(e,o,a),i=!0},p(o,a){const s=8192&a[1]|131072&a[2]?yr(n,[131072&a[2]&&Pr(o[79]),8192&a[1]&&{tabs:o[44]}]):{};24576&a[19]&&(s.$$scope={dirty:a,ctx:o}),e.$set(s)},i(o){i||(P(e.$$.fragment,o),i=!0)},o(o){z(e.$$.fragment,o),i=!1},d(o){It(e,o)}}}function p3(t){let e,i;return e=new ro({props:{items:t[44]}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};8192&r[1]&&(o.items=n[44]),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function h3(t){let e,i=t[602].icon+"";return{c(){e=fr("g")},m(n,r){et(n,e,r),e.innerHTML=i},p(n,r){8192&r[19]&&i!==(i=n[602].icon+"")&&(e.innerHTML=i)},d(n){n&&Q(e)}}}function m3(t){let e,i,n,r,o,a=t[602].label+"";return e=new ko({props:{$$slots:{default:[h3]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment),i=me(),n=ht("span"),r=$n(a)},m(s,l){Rt(e,s,l),et(s,i,l),et(s,n,l),kt(n,r),o=!0},p(s,l){const c={};24576&l[19]&&(c.$$scope={dirty:l,ctx:s}),e.$set(c),(!o||8192&l[19])&&a!==(a=s[602].label+"")&&An(r,a)},i(s){o||(P(e.$$.fragment,s),o=!0)},o(s){z(e.$$.fragment,s),o=!1},d(s){It(e,s),s&&Q(i),s&&Q(n)}}}function $3(t){let e,i,n,r;const o=[p3,u3],a=[];function s(l,c){return l[74]?0:1}return e=s(t),i=a[e]=o[e](t),{c(){i.c(),n=Mn()},m(l,c){a[e].m(l,c),et(l,n,c),r=!0},p(l,c){let d=e;e=s(l),e===d?a[e].p(l,c):(Pe(),z(a[d],1,1,()=>{a[d]=null}),Re(),i=a[e],i?i.p(l,c):(i=a[e]=o[e](l),i.c()),P(i,1),i.m(n.parentNode,n))},i(l){r||(P(i),r=!0)},o(l){z(i),r=!1},d(l){a[e].d(l),l&&Q(n)}}}function g3(t){let e,i,n;function r(a){t[431](a)}let o={locale:t[3],class:"PinturaMain",view:t[207](t[43]),props:t[206](t[43],t[27]),stores:t[202]};return t[1][t[43]]!==void 0&&(o.component=t[1][t[43]]),e=new b2({props:o}),Fi.push(()=>go(e,"component",r)),e.$on("measure",t[233]),e.$on("show",t[432]),e.$on("hide",t[433]),e.$on("fade",t[434]),{c(){Et(e.$$.fragment)},m(a,s){Rt(e,a,s),n=!0},p(a,s){const l={};8&s[0]&&(l.locale=a[3]),4096&s[1]&&(l.view=a[207](a[43])),134217728&s[0]|4096&s[1]&&(l.props=a[206](a[43],a[27])),!i&&2&s[0]|4096&s[1]&&(i=!0,l.component=a[1][a[43]],So(()=>i=!1)),e.$set(l)},i(a){n||(P(e.$$.fragment,a),n=!0)},o(a){z(e.$$.fragment,a),n=!1},d(a){It(e,a)}}}function f3(t){let e,i;const n=[{class:"PinturaMain"},{visible:t[62]},t[79],{panels:t[78]}];let r={$$slots:{default:[y3,({panel:o,panelIsActive:a})=>({600:o,601:a}),({panel:o,panelIsActive:a})=>[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,(o?2048:0)|(a?4096:0)]]},$$scope:{ctx:t}};for(let o=0;o<n.length;o+=1)r=Tn(r,n[o]);return e=new Du({props:r}),e.$on("measure",t[430]),{c(){Et(e.$$.fragment)},m(o,a){Rt(e,o,a),i=!0},p(o,a){const s=196609&a[2]?yr(n,[n[0],1&a[2]&&{visible:o[62]},131072&a[2]&&Pr(o[79]),65536&a[2]&&{panels:o[78]}]):{};134217738&a[0]|22528&a[19]&&(s.$$scope={dirty:a,ctx:o}),e.$set(s)},i(o){i||(P(e.$$.fragment,o),i=!0)},o(o){z(e.$$.fragment,o),i=!1},d(o){It(e,o)}}}function y3(t){let e,i,n;function r(a){t[426](a,t[600])}let o={locale:t[3],view:t[207](t[600]),props:t[206](t[600],t[27]),isActive:t[601],stores:t[202]};return t[1][t[600]]!==void 0&&(o.component=t[1][t[600]]),e=new b2({props:o}),Fi.push(()=>go(e,"component",r)),e.$on("measure",t[233]),e.$on("show",function(){return t[427](t[600])}),e.$on("hide",function(){return t[428](t[600])}),e.$on("fade",function(...a){return t[429](t[600],...a)}),{c(){Et(e.$$.fragment)},m(a,s){Rt(e,a,s),n=!0},p(a,s){t=a;const l={};8&s[0]&&(l.locale=t[3]),2048&s[19]&&(l.view=t[207](t[600])),134217728&s[0]|2048&s[19]&&(l.props=t[206](t[600],t[27])),4096&s[19]&&(l.isActive=t[601]),!i&&2&s[0]|2048&s[19]&&(i=!0,l.component=t[1][t[600]],So(()=>i=!1)),e.$set(l)},i(a){n||(P(e.$$.fragment,a),n=!0)},o(a){z(e.$$.fragment,a),n=!1},d(a){It(e,a)}}}function _g(t){let e,i;return{c(){e=ht("span"),v(e,"class","PinturaEditorOverlay"),v(e,"style",i="opacity:"+t[102])},m(n,r){et(n,e,r)},p(n,r){512&r[3]&&i!==(i="opacity:"+n[102])&&v(e,"style",i)},d(n){n&&Q(e)}}}function Vg(t){let e,i;const n=[{layout:"row"},{parentRect:t[50]},t[60]];let r={$$slots:{default:[x3]},$$scope:{ctx:t}};for(let o=0;o<n.length;o+=1)r=Tn(r,n[o]);return e=new F2({props:r}),{c(){Et(e.$$.fragment)},m(o,a){Rt(e,o,a),i=!0},p(o,a){const s=537395200&a[1]?yr(n,[n[0],524288&a[1]&&{parentRect:o[50]},536870912&a[1]&&Pr(o[60])]):{};1610612736&a[1]|16384&a[19]&&(s.$$scope={dirty:a,ctx:o}),e.$set(s)},i(o){i||(P(e.$$.fragment,o),i=!0)},o(o){z(e.$$.fragment,o),i=!1},d(o){It(e,o)}}}function x3(t){let e,i,n;return{c(){e=ht("input"),e.value=i=t[60].text,v(e,"placeholder",n=t[60].placeholder),v(e,"type","text"),v(e,"spellcheck","false"),v(e,"autocorrect","off"),v(e,"autocapitalize","off")},m(r,o){et(r,e,o),t[441](e)},p(r,o){536870912&o[1]&&i!==(i=r[60].text)&&e.value!==i&&(e.value=i),536870912&o[1]&&n!==(n=r[60].placeholder)&&v(e,"placeholder",n)},d(r){r&&Q(e),t[441](null)}}}function b3(t){let e,i,n,r,o,a;Wl(t[423]);let s=t[40]&&Ag(t),l=t[102]>0&&_g(t),c=t[60]&&Vg(t);return{c(){e=ht("div"),s&&s.c(),i=me(),l&&l.c(),n=me(),c&&c.c(),v(e,"id",t[4]),v(e,"class",t[77]),v(e,"data-env",t[75]),v(e,"dir",t[12])},m(d,u){et(d,e,u),s&&s.m(e,null),kt(e,i),l&&l.m(e,null),kt(e,n),c&&c.m(e,null),t[442](e),r=!0,o||(a=[Pt(nl,"keydown",t[224]),Pt(nl,"keyup",t[225]),Pt(nl,"blur",t[226]),Pt(nl,"paste",t[230]),Pt(nl,"resize",t[423]),Pt(e,"ping",function(){Zi(t[68])&&t[68].apply(this,arguments)}),Pt(e,"contextmenu",t[227]),Pt(e,"touchstart",t[222],{passive:!1}),Pt(e,"touchmove",function(){Zi(t[71])&&t[71].apply(this,arguments)}),Pt(e,"pointermove",function(){Zi(t[70])&&t[70].apply(this,arguments)}),Pt(e,"transitionend",t[212]),Pt(e,"dropfiles",t[228]),Pt(e,"measure",t[443]),Pt(e,"click",function(){Zi(t[42]?t[229]:$e)&&(t[42]?t[229]:$e).apply(this,arguments)}),Xi(xr.call(null,e,{observeViewRect:!0,isMeasureRoot:!0})),Xi(qv.call(null,e)),Xi(x2.call(null,e))],o=!0)},p(d,u){(t=d)[40]?s?(s.p(t,u),512&u[1]&&P(s,1)):(s=Ag(t),s.c(),P(s,1),s.m(e,i)):s&&(Pe(),z(s,1,1,()=>{s=null}),Re()),t[102]>0?l?l.p(t,u):(l=_g(t),l.c(),l.m(e,n)):l&&(l.d(1),l=null),t[60]?c?(c.p(t,u),536870912&u[1]&&P(c,1)):(c=Vg(t),c.c(),P(c,1),c.m(e,null)):c&&(Pe(),z(c,1,1,()=>{c=null}),Re()),(!r||16&u[0])&&v(e,"id",t[4]),(!r||32768&u[2])&&v(e,"class",t[77]),(!r||8192&u[2])&&v(e,"data-env",t[75]),(!r||4096&u[0])&&v(e,"dir",t[12])},i(d){r||(P(s),P(c),r=!0)},o(d){z(s),z(c),r=!1},d(d){d&&Q(e),s&&s.d(),l&&l.d(),c&&c.d(),t[442](null),o=!1,Ui(a)}}}const lh=1,ch=10;function v3(t,e,i){let n,r,o,a,s,l,c,d,u,p,h,g,m,f,b,w,S,C,R,M,D,T,F,W,B,y,V,tt,k,N,it,ut,st,mt,G,gt,vt,lt,St,J,q,Z,bt,nt,$t,Lt,ie,Vt,te,Yt,U,Tt,ct,Jt,de,ee,be,ve,_,Ce,pi,we,Bt,Ae,Ee,We,oi,xt,ge,Ue,ze,At,Ge,Ke,gi,yi,Li,Si,X,Zt,H,qt,le,Ut,fe,Xt,Le,Je,_e,dt,jt,ne,Fe,Nt,K,Qt,Gt,oe,He,Ne,Te,Qe,De,ce,Ye,Me,Ze,Ni,ue,Se,dn,bn,vn,Nn,Hn,dr,oo,Pn,br,yn,ao,Qi,Gr,wn,Xn,ki,_o,Zr,Vo,so,fo,Ln,Bn,tn,No,Br,mr,Or,da,Co,To,Wr,lo,vr,Rr,co,Sn,Di,Gi,wr,en,Sr,uo,Xr,ur,pr,Wn,po,Jn,Ho,jn,zn,ho,Yr,Rn,hr,O,re,xi,qe,Mt,ye,Mi,_i,pn,bi,Hi,_r,ua,Ba,pa,Mo,qr,jo,yo,Ca,Vr,A,ae,Be,vi,Pi,Vi,ti,hi,Ri,Bi,hn,Cn,gn,Oi,Ei,Ir,Uo,Oa,Ta,Wa,_a,Go,ss,ul,Va,Na,Kr,Nr=ii,Jr=ii;E(t,Xv,$=>i(411,pn=$)),t.$$.on_destroy.push(()=>Nr()),t.$$.on_destroy.push(()=>Jr());const Er=ns(),an=Sa();let{class:Zo}=e,{layout:Ha}=e,{stores:Hr}=e,{locale:on}=e,{id:Uc}=e,{util:ls}=e,{utils:Ds}=e,{animations:ja="auto"}=e,{disabled:ha=!1}=e,{status:xo}=e,{previewUpscale:Ma=!1}=e,{previewPad:x=!1}=e,{previewMaskOpacity:j=.95}=e,{previewImageDataMaxSize:L}=e,{previewImageTextPixelRatio:rt}=e,{markupMaskOpacity:at=1}=e,{zoomMaskOpacity:zt=.85}=e,{elasticityMultiplier:Dt=10}=e,{willRevert:Ht=()=>Promise.resolve(!0)}=e,{willProcessImage:Ot=()=>Promise.resolve(!0)}=e,{willRenderCanvas:Ft=Ji}=e,{willRenderToolbar:Wt=Ji}=e,{willRenderUtilTabs:Kt=Ji}=e,{willSetHistoryInitialState:ni=Ji}=e,{enableButtonExport:pe=!0}=e,{enableButtonRevert:se=!0}=e,{enableNavigateHistory:ke=!0}=e,{enableToolbar:xe=!0}=e,{enableUtils:Xe=!0}=e,{enableButtonClose:ei=!1}=e,{enableDropImage:wi=!1}=e,{enablePasteImage:ci=!1}=e,{enableBrowseImage:Ii=!1}=e,{enableTransparencyGrid:mn=!1}=e,{layoutDirectionPreference:ji="auto"}=e,{layoutHorizontalUtilsPreference:zi="left"}=e,{layoutVerticalUtilsPreference:xn="bottom"}=e,{layoutVerticalToolbarPreference:Yi="top"}=e,{layoutVerticalControlGroupsPreference:Un="bottom"}=e,{layoutVerticalControlTabsPreference:sn="bottom"}=e,{textDirection:jr}=e,{markupEditorZoomLevel:kr=null}=e,{markupEditorZoomLevels:Qr}=e,{markupEditorZoomAdjustStep:Ua}=e,{markupEditorZoomAdjustFactor:Ga}=e,{markupEditorZoomAdjustWheelFactor:Bs}=e,{markupEditorInteractionMode:cs=!1}=e,{muteAudio:Xo=!0}=e,{willSetMediaInitialTimeOffset:Po=($,Y)=>$*n3(Y[0])}=e,{enablePan:Ro=!0}=e,{enableZoom:ds=!0}=e,{enableZoomControls:ma=!0}=e,{enableZoomInput:Os}=e,{enablePanInput:Io}=e,{enableCanvasAlpha:$a=!1}=e,{enablePanLimit:us}=e,{panLimitGutterScalar:Ws}=e,{zoomPresetOptions:jl=[.25,.5,1,1.25,1.5,2,3,4,6,8,16]}=e,{zoomAdjustStep:Pa=.25}=e,{zoomAdjustFactor:Za=.1}=e,{zoomAdjustWheelFactor:Qn=1}=e,{zoomLevel:to=null}=e,{fixScrollDirection:Gc=!1}=e;const a0=he(Gc);let Ul,Zc;mo("fixScrollDirection",a0);let{imagePreviewSrc:Nu}=e,{imageOrienter:Xc={read:()=>1,apply:$=>$}}=e,{pluginComponents:pl}=e,{pluginOptions:_s={}}=e;const nx=Er.sub,Eo={};let{root:tr}=e;const Hu=()=>{Te.setAttribute("data-redraw","true"),Ns.set({})},ju=he(!0);E(t,ju,$=>i(476,ao=$));const Gl=he(void 0);E(t,Gl,$=>i(421,Pi=$));const Xa=he(0);E(t,Xa,$=>i(418,ae=$));const s0=he(!1),Yc=$=>{s0.set($.type==="play"),Er.pub($.type)};let l0,Uu,c0,Gu,Zu=!1;const Xu=()=>{if(!o||!hl())return;Gu=u,wt(Gl,Pi=void 0,Pi);const $=Te;Zu=!1;const Y=1/24,ft=Ya();(Math.abs(c*ft-ae*ft)<=Y||ft-ft*ae<=Y)&&wt(Xa,ae=l,ae),qc(ae*Ya()),$.play().catch(()=>{});let Ct=Xl();const pt=()=>{if(hl())return;c0=requestAnimationFrame(pt);let yt=Xl();yt-Ct<=0&&(yt=Ct+.01),Ct=yt,wt(Xa,ae=yt/Ya(),ae),Gu>=0&&ae>=c&&(wt(Xa,ae=c,ae),Vs()),u>-1&&(Zu=!0),Zu&&u===-1&&p>0&&(wt(Xa,ae=s[p][0],ae),qc(ae*Ya())),wt(Jc,yo=ae*Ya(),yo),Hu()};pt()},Vs=()=>{o&&!hl()&&(wt(Gl,Pi=void 0,Pi),Gu=void 0,Te.pause(),cancelAnimationFrame(c0),Hu())},hl=()=>Te&&Te.paused,Yu=()=>{if(o)return hl()?Xu():Vs()},qu=()=>{o&&(Te.muted=!0)},Ku=()=>{o&&(Te.muted=!1)},d0=()=>{o&&wt(Zl,vi=!vi,vi)},Zl=he(Xo);E(t,Zl,$=>i(420,vi=$));const Ya=()=>{if(o)return Te.duration},Xl=()=>{if(o)return Te.currentTime},qc=$=>{o&&(Tg(Te,$),wt(Xa,ae=$/Be,ae))},Ns=he({});E(t,Ns,$=>i(52,wn=$)),mo("redrawTrigger",Ns);const Kc=he(Dt);E(t,Kc,$=>i(493,Vr=$)),mo("elasticityMultiplier",Kc);let Yl=[];const Ju=di();E(t,Ju,$=>i(102,Kr=$));const u0=jh()||1024,p0=Vn(u0,u0),h0=o2(),rx=$=>Promise.resolve(Ca&&Ca($,{resourceType:"image"})).then(Y=>{if(Y===!1)return;const{headers:ft,credentials:Ct}=Y||{};return fetch($,{headers:ft,credentials:Ct}).then(pt=>{if(pt.status!==200)throw`${pt.status} (${pt.statusText})`;return pt.blob()}).then(pt=>Rg(pt,Xc,h0)).then(pt=>Ig(pt,m))});let{imageSourceToImageData:Qu=$=>Ve($)?rx($):Bl($)?new Promise(Y=>Y(Vc($))):Th($)||Hc($)?Rg($,Xc,h0).then(Y=>Ig(Y,m)):void 0}=e;const t1=(()=>{let $,Y;const ft=Mg.reduce((Ct,pt)=>(Ct[pt]=function(yt,_t,je){let mi=[];return{set:_t,update:je,publish:Wi=>{mi.forEach(qi=>qi(Wi))},subscribe:Wi=>(mi.push(Wi),yt(Wi),()=>{mi=mi.filter(qi=>qi!==Wi)})}}(yt=>{if(!Y)return yt();Y.stores[pt].subscribe(yt)()},yt=>{Y&&Y.stores[pt].set(yt)},yt=>{Y&&Y.stores[pt].update(yt)}),Ct),{});return{update:Ct=>{if(Y=Ct,$&&($.forEach(pt=>pt()),$=void 0),!Ct)return ft.file.publish(void 0),void ft.loadState.publish(void 0);$=Mg.map(pt=>Ct.stores[pt].subscribe(yt=>{ft[pt].publish(yt)}))},stores:ft,destroy:()=>{$&&$.forEach(Ct=>Ct())}}})(),{file:e1,size:Hs,duration:i1,currentTime:Jc,trim:n1,volume:m0,minDuration:ox,maxDuration:r1,loadState:Qc,processState:o1,cropAspectRatio:td,cropLimitToImage:a1,crop:ga,cropMinSize:ax,cropMaxSize:sx,cropRange:lx,cropOrigin:cx,cropRectAspectRatio:dx,rotation:ml,rotationRange:ux,targetSize:px,flipX:ed,flipY:id,backgroundColor:nd,backgroundImage:$0,colorMatrix:g0,convolutionMatrix:f0,gamma:y0,vignette:x0,noise:b0,decoration:rd,annotation:od,manipulation:ad,redaction:sd,frame:js,selection:s1,state:ld}=t1.stores;E(t,e1,$=>i(395,vr=$)),E(t,Hs,$=>i(368,ce=$)),E(t,i1,$=>i(419,Be=$)),E(t,Jc,$=>i(492,yo=$)),E(t,n1,$=>i(416,jo=$)),E(t,m0,$=>i(417,A=$)),E(t,r1,$=>i(422,Vi=$)),E(t,Qc,$=>i(387,tn=$)),E(t,o1,$=>i(386,Bn=$)),E(t,td,$=>i(489,Hi=$)),E(t,a1,$=>i(85,Bi=$)),E(t,ga,$=>i(406,zn=$)),E(t,ml,$=>i(371,Ze=$)),E(t,ed,$=>i(370,Me=$)),E(t,id,$=>i(369,Ye=$)),E(t,nd,$=>i(377,Pn=$)),E(t,rd,$=>i(48,De=$)),E(t,od,$=>i(49,Ni=$)),E(t,ad,$=>i(374,Hn=$)),E(t,sd,$=>i(375,dr=$)),E(t,js,$=>i(47,Qe=$)),E(t,s1,$=>i(59,pa=$)),E(t,ld,$=>i(478,Sn=$)),mo("components",{DynamicComponentTree:ro}),mo("previewcontrols",{play:Xu,pause:Vs,togglePlayPause:Yu,mute:qu,unmute:Ku,toggleMute:d0,setCurrentTime:qc,getCurrentTime:Xl,getDuration:Ya,frameOffset:Xa,framePeekOffset:Gl,isPlaying:s0,isMuted:Zl});const v0=($,Y,ft=0)=>new Promise((Ct,pt)=>{if(cl($))return void l2($).then(mi=>{const Wi=ui(yo)?yo:Po(mi.duration,jo||[[0,1]]);c2(mi,Wi).then(Ct)});let yt,_t=!1;Y.cancel=()=>_t=!0;const je=Date.now();Qu($).then(mi=>{const Wi=Date.now()-je;clearTimeout(yt),yt=setTimeout(()=>{_t||Ct(mi)},Math.max(0,ft-Wi))}).catch(pt)}),{images:w0,shapePreprocessor:S0,imageScrambler:k0,imageRedactionRendering:C0,willRequest:T0,willRequestResource:M0,csp:P0}=Hr;let ql;E(t,w0,$=>i(415,qr=$)),E(t,S0,$=>i(414,Mo=$)),E(t,k0,$=>i(378,br=$)),E(t,C0,$=>i(376,oo=$)),E(t,T0,$=>i(81,Ca=$)),E(t,M0,$=>i(93,Oa=$)),E(t,P0,$=>i(92,Uo=$));const hx=Ai($0,($,Y)=>{if(!$)return Y(void 0);ql&&(ql.cancel(),ql=void 0),ql={cancel:$e},v0($,ql).then(Y).catch(ft=>{})}),mx=ld.subscribe($=>Er.pub("update",$)),$x=he();mo("ui",he({})),mo("selection",s1);const l1=he(!0);E(t,l1,$=>i(95,Wa=$));const c1=he(!0);E(t,c1,$=>i(97,Go=$));const d1=he(!0);E(t,d1,$=>i(413,Ba=$));const cd=he(!0);E(t,cd,$=>i(490,_r=$));const u1=he(!0);E(t,u1,$=>i(98,ss=$));const p1=he();E(t,p1,$=>i(99,ul=$));const dd=he();E(t,dd,$=>i(491,ua=$));const h1=Ai([dd,cd],()=>ua!==void 0?ua:_r);E(t,h1,$=>i(96,_a=$));const Kl=he([0,0,0]);E(t,Kl,$=>i(56,Sr=$));const ud=he([1,1,1]);E(t,ud,$=>i(474,Nn=$));const Jl=di([1,1,1]);E(t,Jl,$=>i(473,vn=$));const m1=he();E(t,m1,$=>i(91,Ir=$));const R0=he(),$1=he();E(t,$1,$=>i(51,Qi=$));const $l=he();E(t,$l,$=>i(372,Se=$));const gl=he(ws());E(t,gl,$=>i(80,Di=$));const g1=he(0);E(t,g1,$=>i(412,bi=$));const Ql=he(ws());E(t,Ql,$=>i(84,Ri=$));const Us=he();E(t,Us,$=>i(471,Ne=$));const pd=Pg("(pointer: fine)",$=>$?"pointer-fine":"pointer-coarse");E(t,pd,$=>i(393,Wr=$));const hd=Pg("(hover: hover)",$=>$?"pointer-hover":"pointer-no-hover");E(t,hd,$=>i(392,To=$));const I0=he(!1),tc=he(!1);E(t,tc,$=>i(373,bn=$));const f1=Rl(void 0,$=>{const Y=di(0),ft=[tc.subscribe(Ct=>{Y.set(Ct?1:0,{hard:!ki})}),Y.subscribe($)];return()=>ft.forEach(Ct=>Ct())});E(t,f1,$=>i(472,dn=$));const md=he();E(t,md,$=>i(477,Or=$));const $d=he();let y1;E(t,$d,$=>i(53,ki=$)),mo("isAnimated",$d);const gd=he(Ma);E(t,gd,$=>i(396,Rr=$));const Gs=he(!1);E(t,Gs,$=>i(483,Rn=$)),mo("imageIsStatic",Gs);const ec=he();E(t,ec,$=>i(484,hr=$));const x1=he();E(t,x1,$=>i(481,ho=$));const E0=Rl(void 0,$=>{const Y=he(void 0),ft=[ga.subscribe(()=>{if(!zn)return;if(Rn)return Y.set(Ci(zn));const Ct=D$(zn,ho,5*Dt);Y.set(Ct)}),Y.subscribe($)];return()=>ft.forEach(Ct=>Ct())}),Yo=he();E(t,Yo,$=>i(480,jn=$));const fd=he();E(t,fd,$=>i(482,Yr=$));const b1=he(void 0);E(t,b1,$=>i(487,ye=$));const A0=he(ln());E(t,A0,$=>i(488,Mi=$));const L0=($,Y)=>{if(!Y||!$)return{top:0,right:0,bottom:0,left:0};const ft=Ey(Y,$,f),Ct=Iy(ft,$);return{top:Math.abs(Ct.top),right:Math.abs(Ct.right),bottom:Math.abs(Ct.bottom),left:Math.abs(Ct.left)}},z0=he({}),v1=Ai([Us,gl,Ql,z0],([$,Y,ft,Ct],pt)=>{if(!$)return pt(void 0);let yt=0;N.length!==1||h||Yi==="bottom"||(yt=ft.y+ft.height),pt(In($.x+Y.x,$.y+Y.y+yt,$.width,$.height))});let ic={left:0,right:0,top:0,bottom:0};const yd=he(!1),fl=Ai([yd,js,v1,tc],([$,Y,ft,Ct],pt)=>{if(!ft)return pt({left:0,right:0,top:0,bottom:0});if(!$)return;const yt=Math.min(ft.width,ft.height),_t=L0({width:yt,height:yt},Y);ai(ic.top,4)===ai(_t.top,4)&&ai(ic.bottom,4)===ai(_t.bottom,4)&&ai(ic.right,4)===ai(_t.right,4)&&ai(ic.left,4)===ai(_t.left,4)||(ic=_t,pt(_t))});E(t,fl,$=>i(404,po=$));const yl=Ai([yd,fl],([$,Y],ft)=>{if(!$)return ft(!1);ft(Object.values(Y).some(Ct=>Ct>0))});E(t,yl,$=>i(405,Jn=$));const gx=Ai([yd,Us,yl,fl],([$,Y,ft,Ct],pt)=>{if(Y)return $&&ft?void pt(In(Y.x+Ct.left,Y.y+Ct.top,Y.width-Ct.left-Ct.right,Y.height-Ct.top-Ct.bottom)):pt({...Y})}),Ra=Ai([v1,yl,fl],([$,Y,ft],Ct)=>$?Y?void Ct(In($.x+ft.left,$.y+ft.top,$.width-ft.left-ft.right,$.height-ft.top-ft.bottom)):Ct($):Ct(void 0));E(t,Ra,$=>i(50,ue=$));const fx=Ai([Gs,Hs,ml],([$,Y,ft],Ct)=>{if(!$||!Y)return Ct(void 0);const pt=Fr(Y);Ct($r(pt,ft))}),w1=Ai([fx],([$],Y)=>{if(!$)return Y(void 0);const ft=nr($);Y(zc(ft))});E(t,w1,$=>i(408,xi=$));const qa=Ai([Ra,ga,w1,gd],([$,Y,ft,Ct],pt)=>{if(!$||!Y||!(!hr&&!ho))return;const{width:yt,height:_t}=ft||Y,je=Math.min($.width/yt,$.height/_t);pt(Ct?je:Math.min(1,je))});E(t,qa,$=>i(407,re=$)),mo("imageStaticVisualCorners",Ai([Gs,Hs,ml,Ra,Us,qa],([$,Y,ft,Ct,pt,yt],_t)=>{if(!($&&Ct&&pt&&Y))return _t(void 0);const je=Fr(Y),mi=zc(Cr(je,yt)),Wi=au(Ct,mi);mi.x=Wi.x,mi.y=Wi.y,_t($r(mi,ft))}));const xl=he(void 0);E(t,xl,$=>i(410,_i=$));const F0=Ai([ga,Ra],([$,Y])=>{if(Y&&$)return Math.min(Y.width/$.width,Y.height/$.height)}),S1=Ai([ga,Yo],([$,Y])=>$&&Y?Math.min($.width/Y.width,$.height/Y.height):1);E(t,S1,$=>i(101,Na=$));const nc=Ai([xl,S1],([$,Y])=>$&&Y?Y*$:1);E(t,nc,$=>i(486,qe=$));const bl=he(ln());E(t,bl,$=>i(409,Mt=$));const D0=he({scalar:qe,translation:Mt}),B0=()=>{D0.set({scalar:void 0,translation:ln()})},xd=Rl(void 0,$=>{const Y=di(void 0,{precision:1e-4}),ft=Cc()===1?yt=>Do(yt,Math.round):Ji,Ct=()=>{if(!jn)return;const yt=bn||!Or;if(Rn){const je=Ci(jn);return ta(je,Mi),ta(je,ue),Y.set(je,{hard:yt})}const _t=D$(jn,ye,lh*Dt);_t.width<0&&(_t.width=0,_t.x=jn.x),_t.height<0&&(_t.height=0,_t.y=jn.y),ta(_t,ue),ta(_t,Mt),Cr(_t,qe),!yt&&ft(_t),Y.set(_t,{hard:yt})},pt=[Ra.subscribe(Ct),Yo.subscribe(Ct),nc.subscribe(Ct),bl.subscribe(Ct),js.subscribe(Ct),Y.subscribe($)];return()=>pt.forEach(yt=>yt())});E(t,xd,$=>i(58,Wn=$));const k1=he(1);E(t,k1,$=>i(479,Ho=$));const C1=()=>{if(!zn||!ue)return;let $=Ss(Ci(zn),re||1);const Y=au(ue,Ss(Ci(xi),re));ta($,Y);const ft=Ne.width/$.width,Ct=Ne.height/$.height,pt=Math.min(1,ft,Ct);k1.set(pt),Cr($,pt),((yt,_t)=>{const[je,mi,Wi,qi]=al(yt);je<_t.y&&(yt.y=Math.max(_t.y,yt.y)),mi>_t.width&&(yt.x=_t.width-yt.width),Wi>_t.height&&(yt.y=_t.height-yt.height),qi<_t.x&&(yt.x=Math.max(_t.x,yt.x))})($,{...Ne,x:0,y:0}),Yo.set($)},O0=Ai([Ra,qa,ga,Hs],([$,Y,ft,Ct],pt)=>{$&&(ft||Ct)&&pt(W0($,Y||1,ft||Ct))});E(t,O0,$=>i(100,Va=$));const W0=($,Y,ft)=>ft.width<=$.width&&ft.height<=$.height?au($,Ss(Ci(ft),Y)):Ur($,rr(ft));let T1,_0;const M1=$=>{if(h&&T1&&ea(T1,$)&&_0===re)return;if(Rn)return C1();T1=$,_0=re;const Y=W0($,re,zn||ce);Yo.set(Y)};let V0=!1;const yx=qa.subscribe($=>{!V0&&$!==void 0&&zn&&(M1(ue),V0=!0)}),xx=Ra.subscribe($=>{$&&re!==void 0&&zn&&M1($)}),bx=Gs.subscribe($=>{!$&&ue&&M1(ue)});let P1;const vx=fd.subscribe($=>{if(!$)return P1=void 0,void wt(ec,hr=void 0,hr);P1=O;const Y=Ci(zn);ec.set(Y)}),wx=Yo.subscribe($=>{if(!$||!Yr)return;const Y=(ft=Ci($),Ct=Yr,ft.x-=Ct.x,ft.y-=Ct.y,ft.width-=Ct.width,ft.height-=Ct.height,ft);var ft,Ct;((yt,_t)=>{yt.x/=_t,yt.y/=_t,yt.width/=_t,yt.height/=_t})(Y,P1);const pt=((yt,_t)=>(yt.x+=_t.x,yt.y+=_t.y,yt.width+=_t.width,yt.height+=_t.height,yt))(Ci(hr),Y);ga.set(pt)}),Sx=ga.subscribe($=>{if(!$||!jn)return;if(Rn)return void(Yr||C1());if(bn||Yr||ho)return;const Y=rr(jn),ft=rr($);if(ai(Y,6)===ai(ft,6))return;const{width:Ct,height:pt}=zn,yt=Math.min(ue.width/Ct,ue.height/pt),_t=Vn($.width*yt,$.height*yt),je=.5*(jn.width-_t.width),mi=.5*(jn.height-_t.height),Wi=In(Math.max(0,Math.min(ue.width-_t.width,jn.x+je)),Math.max(0,Math.min(ue.height-_t.height,jn.y+mi)),_t.width,_t.height);Yo.set(Wi)}),N0=Ai([qa,ga,Yo,Gs],([$,Y,ft,Ct],pt)=>{if(!$||!Y||!ft)return;if(Ct)return pt(Ho);const yt=ft.width/Y.width,_t=ft.height/Y.height;pt(Math.max(yt,_t)/$)}),bd=Ai([qa,N0],([$,Y],ft)=>{Y&&ft($*Y)});E(t,bd,$=>i(485,O=$));let vl={left:0,right:0,top:0,bottom:0};const H0=Ai([js,Yo],([$,Y],ft)=>{if(!Y)return ft(vl);const Ct=L0(Y,$);ai(vl.top,4)===ai(Ct.top,4)&&ai(vl.bottom,4)===ai(Ct.bottom,4)&&ai(vl.right,4)===ai(Ct.right,4)&&ai(vl.left,4)===ai(Ct.left,4)||(vl=Ct,ft(Ct))}),kx=Ai([H0],([$],Y)=>{Y(Object.values($).some(ft=>ft>0))}),R1=di(.075,{stiffness:.03,damping:.4,precision:.001}),Cx=Ai([Jl,Kl,R1,xd,nc,js,kx,H0,yl],([$,Y,ft,Ct,pt,yt,_t,je,mi],Wi)=>{if(!Ct||h)return Wi([]);let{x:qi,y:fi,width:Gn,height:nn}=Ct;qi+=.5,fi+=.5,Gn-=.5,nn-=.5;const er=[];if(yt){if(_t){let{left:Ki,right:Ko,top:Ys,bottom:Sl}=je;Ki*=pt,Ko*=pt,Ys*=pt,Sl*=pt;const ip=Bp(Y)?[1,1,1,.125]:[0,0,0,.075];er.push({x:qi-Ki-.5,y:fi-Ys-.5,width:Gn+Ki+Ko+1,height:nn+Ys+Sl+1,strokeWidth:1,strokeColor:ip,opacity:mi?1:.5})}const Ao=Bp($);yt&&yt.frameColor&&Bp(yt.frameColor)||Ao||(er.push({x:qi-1,y:fi-1,width:Gn+2,height:nn+2,strokeWidth:2,strokeColor:[0,0,0,.1],opacity:ft}),er.push({x:qi+1,y:fi+1,width:Gn-2,height:nn-2,strokeWidth:2,strokeColor:[0,0,0,.1],opacity:ft}))}Wi([...er,{x:qi,y:fi,width:Gn,height:nn,strokeWidth:1,strokeColor:$,opacity:ft}])}),rc=he([]);E(t,rc,$=>i(398,Gi=$));const j0=Ai([Cx,rc],([$,Y],ft)=>{ft([...$,...Y])});E(t,j0,$=>i(94,Ta=$));const I1=di(0,{precision:.001});E(t,I1,$=>i(400,en=$));const E1=di();E(t,E1,$=>i(403,ur=$));const A1=di();E(t,A1,$=>i(402,Xr=$));const L1=di();E(t,L1,$=>i(401,uo=$));const z1=di();E(t,z1,$=>i(399,wr=$));const oc=he(!1);E(t,oc,$=>i(385,Ln=$));const ac=he();let ps;E(t,ac,$=>i(388,No=$));const F1=Ai([oc,ac],([$,Y],ft)=>{if(!$||!Y)return void ft(void 0);if(ps&&(ps.cancel(),i(291,ps=void 0)),jc(Y))return ft(Xf(Y));const Ct=qo.length?0:ki?250:0;i(291,ps={cancel:$e}),v0(Y,ps,Ct).then(ft).catch(pt=>{wt(Qc,tn.error=pt,tn)}).finally(()=>{i(291,ps=void 0)})});Nr(),Nr=zr(F1,$=>i(367,Te=$));let{imagePreviewCurrent:sc}=e;const D1=he({});E(t,D1,$=>i(390,da=$));const vd=he([]);E(t,vd,$=>i(86,hn=$));const wd=Ai([Ra,$l,Hs,E0,Yo,bd,ml,ed,id,nc,bl,I0],([$,Y,ft,Ct,pt,yt,_t,je,mi,Wi,qi,fi],Gn)=>{if(!$||!pt)return;const nn=Lv($,Y,ft,Ct,pt,Wi,qi,yt,_t,je,mi);!fi&&y(nn),Gn(nn)});E(t,wd,$=>i(391,Co=$));const U0=Ai([g0,f0,y0,x0,b0],([$,Y,ft,Ct,pt],yt)=>{const _t=$&&Object.keys($).map(je=>$[je]).filter(Boolean);yt({gamma:ft||void 0,vignette:Ct||void 0,noise:pt||void 0,convolutionMatrix:Y||void 0,colorMatrix:_t&&_t.length&&Dh(_t)})});let Sd,B1;const G0=(()=>{if(!ra())return!1;const $=navigator.userAgent.match(/OS (\d+)_(\d+)_?(\d+)?/i)||[],[,Y,ft]=$.map(Ct=>parseInt(Ct,10)||0);return Y>13||Y===13&&ft>=4})(),lc=he({});E(t,lc,$=>i(379,Gr=$)),mo("env",lc);const Z0=Cc(),O1=Rl(Z0,$=>{const Y=()=>$(Cc()),ft=matchMedia(`(resolution: ${Z0}dppx)`);return ft.addListener(Y),()=>ft.removeListener(Y)});E(t,O1,$=>i(57,pr=$));const Ia=(($,Y,ft)=>{const{sub:Ct,pub:pt}=ns(),{willUndo:yt=()=>!0}=ft||{},_t=[],je=he(0),mi=[],Wi=()=>mi.forEach(fi=>fi({index:va(je),length:_t.length})),qi={get index(){return va(je)},set index(fi){fi=Number.isInteger(fi)?fi:0,fi=rn(fi,0,_t.length-1),je.set(fi),Y(_t[qi.index]),Wi()},get state(){return _t[_t.length-1]},length:()=>_t.length,undo(){if(yt()===!1)return;const fi=qi.index--;return pt("undo",fi),fi},redo(){const fi=qi.index++;return pt("redo",qi.index),fi},revert(){_t.length=1,qi.index=0,pt("revert")},write(fi){fi&&Y({...$(),...fi});const Gn=$(),nn=_t[_t.length-1];JSON.stringify(Gn)!==JSON.stringify(nn)&&(_t.length=qi.index+1,_t.push(Gn),je.set(_t.length-1),Wi(),pt("writehistory"))},set(fi={}){_t.length=0,qi.index=0;const Gn=Array.isArray(fi)?fi:[fi];_t.push(...Gn),qi.index=_t.length-1},get:()=>[..._t],subscribe:fi=>(mi.push(fi),fi({index:qi.index,length:_t.length}),()=>mi.splice(mi.indexOf(fi),1)),on:Ct};return qi})(()=>Sn,$=>{wt(ld,Sn=$,Sn),gl.set(Di)},{willUndo:()=>!Ix()||(Rx(),!1)});Jr(),Jr=zr(Ia,$=>i(397,co=$));const X0=()=>{const $={x:0,y:0,...ce},Y=Do(Ur($,Sn.cropAspectRatio),Math.round),ft=ni({...Sn,rotation:0,crop:Y},Sn),Ct=[ft];JSON.stringify(ft)!==JSON.stringify(Sn)&&Ct.push({...Sn}),Ia.set(Ct)},Tx=Qc.subscribe($=>{$&&$.complete&&X0()}),Mx=()=>Ht().then($=>$&&Ia.revert()),Px=[od,rd,sd,ad],Rx=()=>{Px.forEach($=>{$.update(Y=>Y.length&&eo(Y[Y.length-1])?Y.slice(0,-1):Y)})},Ix=()=>k.filter($=>$.length).some($=>eo($[$.length-1])),hs=he(!1);E(t,hs,$=>i(380,Xn=$));const Ex=()=>{wt(hs,Xn=!0,Xn),Ot().then($=>{if(!$)return void wt(hs,Xn=!1,Xn);let Y;Y=dc.subscribe(ft=>{ft===1&&(Y&&Y(),an("processImage"))})})},Ax=o1.subscribe($=>{if(!$)return void wt(hs,Xn=!1,Xn);wt(hs,Xn=!0,Xn);const{complete:Y,abort:ft}=$;(Y||ft)&&wt(hs,Xn=!1,Xn)}),qo=i3();E(t,qo,$=>i(55,Br=$));const Lx=Ai([qo],([$],Y)=>{if(!$.length)return Y();const{origin:ft,translation:Ct,rotation:pt,scale:yt}=$[0];Y({origin:ft,translation:Ct,rotation:pt,scale:yt})}),kd=he();E(t,kd,$=>i(394,lo=$));let Cd,Td=[];const Y0=he(),W1=he(),zx=Ai([xl,W1,qa,F0],([$,Y,ft,Ct])=>$||(Y||ft<1?Ct:1)),q0={...Hr,imageFile:e1,imageSize:Hs,mediaDuration:i1,mediaMinDuration:ox,mediaMaxDuration:r1,mediaTrim:n1,imageBackgroundColor:nd,imageBackgroundImage:$0,imageCropAspectRatio:td,imageCropMinSize:ax,imageCropMaxSize:sx,imageCropLimitToImage:a1,imageCropRect:ga,imageCropRectOrigin:cx,imageCropRectSnapshot:ec,imageCropRectAspectRatio:dx,imageCropRange:lx,imageRotation:ml,imageRotationRange:ux,imageFlipX:ed,imageFlipY:id,imageOutputSize:px,imageColorMatrix:g0,imageConvolutionMatrix:f0,imageGamma:y0,imageVignette:x0,imageNoise:b0,imageManipulation:ad,imageDecoration:rd,imageAnnotation:od,imageRedaction:sd,imageFrame:js,imagePreview:F1,imagePreviewSource:ac,imageTransforms:wd,imagePreviewModifiers:D1,history:Ia,animation:md,pixelRatio:O1,elasticityMultiplier:Dt,scrollElasticity:ch,rangeInputElasticity:5,redrawTrigger:Ns,pointerAccuracy:pd,pointerHoverable:hd,env:lc,rootRect:$l,stageRect:Ra,stageRectBase:v1,stageRecenter:z0,stageScalar:qa,stagePadding:fl,stagePadded:yl,presentationScalar:bd,imagePreviewUpscale:W1,utilRect:Us,utilRectPadded:gx,allowPlayPause:ju,allowPan:l1,allowZoom:c1,allowZoomControls:d1,enableZoomInput:u1,enablePanInput:cd,enablePanInputStatus:h1,imageSelectionMultiTouching:Y0,rootBackgroundColor:Kl,rootForegroundColor:ud,rootLineColor:Jl,rootColorSecondary:R0,imageOutlineOpacity:R1,utilTools:kd,imageSelectionPan:bl,imageSelectionZoom:xl,imageSelectionZoomCurrent:zx,imageSelectionStageFitScalar:F0,imageSelectionStoredState:D0,imageOverlayMarkup:rc,interfaceImages:vd,isInteracting:tc,isTransformingImage:I0,isInteractingFraction:f1,imageCropRectIntent:x1,imageCropRectPresentation:E0,imageSelectionRect:Yo,imageSelectionRectIntent:b1,imageSelectionRectPresentation:xd,imageSelectionRectSnapshot:fd,imageScalar:N0,imageTransformsInterpolated:Lx,imageEffects:U0};delete q0.image;const Fx="util-"+na();let _1=[];const K0=$=>it.find(([Y])=>$===Y);let cc=[];const V1=$=>{i(62,cc=cc.concat($))},N1=$=>{i(62,cc=cc.filter(Y=>Y!==$))},H1=($,Y)=>{i(297,G[$]=Y,G)};let J0=ra();const Q0=($,Y,ft)=>{let Ct=pi.getPropertyValue($);Ct=ft?ft(Ct):/^[0-9]+$/.test(Ct)?parseFloat(Ct):void 0,Y.set(Ct,{hard:!ki})},Zs=($,Y,ft=!1)=>{const Ct=(pt=>{const yt=pi.getPropertyValue(pt);return z2(yt)})($);Ct&&Ct[3]!==0&&(ft||(Ct.length=3),Y.set(Ct,{hard:!ki}))},j1=he();E(t,j1,$=>i(87,Cn=$));const U1=he();E(t,U1,$=>i(88,gn=$));const G1=he();E(t,G1,$=>i(89,Oi=$));const Md=di(0,{damping:.9});E(t,Md,$=>i(90,Ei=$));const tm=()=>{Zs("color",ud),Zs($a?"--color-background":"background-color",Kl),Zs("outline-color",Jl),Zs("--color-primary",m1),Zs("--color-secondary",R0),Zs("--grid-color-even",U1,!0),Zs("--grid-color-odd",G1,!0),Q0("--grid-size",j1),Q0("--editor-inset-top",g1,$=>parseInt($,10))},em=Ai([wd,U0,nd,hx],([$,Y,ft,Ct])=>$&&{...$,...Y,backgroundColor:ft,backgroundImage:Ct});E(t,em,$=>i(389,mr=$));const Dx=()=>{const $=qo.length?void 0:{resize:1.05},Y=((ft,Ct,pt={})=>{const{resize:yt=1,opacity:_t=0}=pt,je={opacity:[di(_t,{...il,stiffness:.1}),Ji],resize:[di(yt,{...il,stiffness:.1}),Ji],translation:[di(void 0,il),Ji],rotation:[di(void 0,tu),Ji],origin:[di(void 0,il),Ji],scale:[di(void 0,tu),Ji],gamma:[di(void 0,tu),nn=>nn||1],vignette:[di(void 0,tu),nn=>nn||0],colorMatrix:[di([...Eg],il),nn=>nn||[...Eg]],convolutionMatrix:[he(void 0),nn=>nn&&nn.clarity||void 0],backgroundColor:[di(void 0,il),(nn,er,Ao)=>{if(Array.isArray(nn)){if(Array.isArray(er)){const Ki=[...nn];er[3]===0?(Ki[3]=0,Ao(Ki)):Ki[3]===0&&((nn=[...er])[3]=0)}return nn}}],backgroundImage:[he(void 0),Ji]},mi=Object.entries(je).map(([nn,er])=>[nn,er[0]]),Wi=mi.map(([,nn])=>nn),qi=Object.entries(je).reduce((nn,[er,Ao])=>{const[Ki,Ko]=Ao;return nn[er]=(Ys,Sl)=>Ki.set(Ko(Ys,fi[er],ip=>{Ki.set(ip,{hard:!0})}),Sl),nn},{});let fi;const Gn=Ai(Wi,nn=>(fi=nn.reduce((er,Ao,Ki)=>(er[mi[Ki][0]]=Ao,er),{}),fi.data=ft,fi.size=Ct,fi.scale*=nn[1],fi));return Gn.get=()=>fi,Gn.set=(nn,er)=>{const Ao={hard:!er};Object.entries(nn).forEach(([Ki,Ko])=>{qi[Ki]&&qi[Ki](Ko,Ao)})},Gn})(Te,ce,$);qo.unshift(Y),im(mr)},im=$=>{qo.forEach((Y,ft)=>{const Ct=ft===0?1:0;Y.set({...$,opacity:Ct,resize:1},Or)})};let Pd;const dc=Gh(void 0,{duration:500});let Z1;E(t,dc,$=>i(54,so=$));const Rd=he(!1);let Ka;E(t,Rd,$=>i(384,fo=$));const Id=di(void 0,{stiffness:.1,damping:.7,precision:.25});E(t,Id,$=>i(82,ti=$));const Ed=di(0,{stiffness:.1,precision:.05});E(t,Ed,$=>i(83,hi=$));const uc=di(0,{stiffness:.02,damping:.5,precision:.25});E(t,uc,$=>i(382,Zr=$));const X1=di(void 0,{stiffness:.02,damping:.5,precision:.25});E(t,X1,$=>i(383,Vo=$));const Ad=di(void 0,{stiffness:.02,damping:.5,precision:.25});let Ld;E(t,Ad,$=>i(381,_o=$));const Bx=()=>{an("abortLoadImage")},Ox=()=>{an("abortProcessImage"),wt(hs,Xn=!1,Xn)},nm=$=>{$.target&&$.target.dataset.touchScroll==="true"||$.preventDefault()},Wx=G0?$=>{const Y=$.touches?$.touches[0]:$;Y.pageX>20&&Y.pageX<window.innerWidth-20||nm($)}:$e,Xs=he([]);E(t,Xs,$=>i(475,yn=$)),mo("keysPressed",Xs);const Y1=$=>{!$||Ol($)&&!(Y=>/^image/.test(Y.type)&&!/svg/.test(Y.type))($)||!Ol($)&&!/^http/.test($)||an("loadImage",$)},_x=$=>{$&&Y1($)};let wl,pc,q1=[];const rm=he();mo("rootPortal",rm),mo("rootRect",$l);const om=()=>({foregroundColor:[...Nn],lineColor:[...vn],utilVisibility:{...G},isInteracting:bn,isInteractingFraction:dn,rootRect:Ci(Se),stageRect:Ci(ue),manipulationShapesDirty:Wd,annotationShapesDirty:Fd,decorationShapesDirty:Bd,frameShapesDirty:Od}),am=($,Y,ft)=>Zn($,Vn(Math.round(Y.width/ft),Math.round(Y.height/ft))),sm=($,Y,ft)=>{var Ct;return $._translate=ot((Ct=Y).x,Ct.y),$._scale=ft,$},zd=$=>{const Y=[];return $.forEach(ft=>Y.push(Vx(ft))),Y.filter(Boolean)},Vx=$=>ir($)?($.points=[ot($.x1,$.y1),ot($.x2,$.y2)],$):(!(Y=>Yn(Y)&&!Y.text.length)($)||$.backgroundColor&&$.backgroundColor[3]!==0||(bu($)&&($.width=5,$.height=$.lineHeight),$.strokeWidth=1,$.strokeColor=[1,1,1,.5],$.backgroundColor=[0,0,0,.1]),$);let lm,K1=[],J1=[],Q1=[],tp=[],ep=[],cm={};const dm=($,Y,ft,Ct,pt,yt,_t)=>{const{manipulationShapesDirty:je,annotationShapesDirty:mi,decorationShapesDirty:Wi,frameShapesDirty:qi,selectionRect:fi,scale:Gn}=$,nn=lm!==Gn,er=nn||!ea(cm,fi);er&&(lm=Gn,cm=fi),je&&(Q1=Y.filter(jd).map(_n).map(Ki=>Zn(Ki,ce))),(mi||ft!==Ni)&&(K1=ft.filter(jd).map(_n).sort((Ki,Ko)=>Ki.alwaysOnTop?1:Ko.alwaysOnTop?-1:0).map(Ki=>Zn(Ki,ce))),(nn||Dd||mi||ft!==Ni)&&(J1=zd(K1.map(Ki=>f(Ki,{flipX:Me,flipY:Ye,rotation:Ze,scale:Gn,context:Fr(ce)})).flat())),(Wi||Ct!==De||er)&&(tp=zd(Ct.filter(jd).map(_n).sort((Ki,Ko)=>Ki.alwaysOnTop?1:Ko.alwaysOnTop?-1:0).map(Ki=>am(Ki,fi,Gn)).map(Ki=>f(Ki,{context:fi})).flat().map(Ki=>sm(Ki,fi,Gn)))),(qi||yt!==Qe||er)&&(ep=yt?zd([yt].map(_n).map(Ki=>am(Ki,fi,Gn)).map(f).flat().map(Ki=>sm(Ki,fi,Gn))):[]);let Ao=zd(pt.filter(jd));return typeof window<"u"&&(Ki=>{if(Ki&&Ki._4ijgope)return;const[Ko]=[[85,110,108,105,99,101,110,115,101,100,32,80,105,110,116,117,114,97,32,105,110,115,116,97,110,99,101]].map(Ys=>Ys.map(Sl=>String.fromCharCode(Sl)).join(""));Ao=[...Ao,{x:fi.x+.5*fi.width-82,y:fi.y+fi.height-16-12,width:164,height:16,text:Ko,fontWeight:900,fontSize:12,color:[1,1,1,.25]}]})(window),{manipulationShapesDirty:je,manipulationShapes:Q1,annotationShapesDirty:mi,annotationShapes:J1,decorationShapesDirty:Wi,decorationShapes:tp,frameShapesDirty:qi,frameShapes:ep,interfaceShapes:Ao,selectionShapes:_t.map(_n).map(Ki=>Zn(Ki,ce))}};let Fd=!0,Dd=!0,Bd=!0,Od=!0,Wd=!0;return Wo(()=>{Vs(),Te&&Ve(Te.src)&&/^blob:/.test(Te.src)&&URL.revokeObjectURL(Te.src),mx(),xx(),yx(),bx(),vx(),wx(),Sx(),Tx(),Ax(),pd.destroy(),hd.destroy(),t1.destroy(),qo.clear(),K1.length=0,J1.length=0,Q1.length=0,tp.length=0,ep.length=0;try{i(235,sc=void 0),i(292,Pd=void 0)}catch{}}),t.$$set=$=>{"class"in $&&i(236,Zo=$.class),"layout"in $&&i(237,Ha=$.layout),"stores"in $&&i(238,Hr=$.stores),"locale"in $&&i(3,on=$.locale),"id"in $&&i(4,Uc=$.id),"util"in $&&i(239,ls=$.util),"utils"in $&&i(240,Ds=$.utils),"animations"in $&&i(241,ja=$.animations),"disabled"in $&&i(242,ha=$.disabled),"status"in $&&i(234,xo=$.status),"previewUpscale"in $&&i(243,Ma=$.previewUpscale),"previewPad"in $&&i(244,x=$.previewPad),"previewMaskOpacity"in $&&i(5,j=$.previewMaskOpacity),"previewImageDataMaxSize"in $&&i(245,L=$.previewImageDataMaxSize),"previewImageTextPixelRatio"in $&&i(6,rt=$.previewImageTextPixelRatio),"markupMaskOpacity"in $&&i(7,at=$.markupMaskOpacity),"zoomMaskOpacity"in $&&i(246,zt=$.zoomMaskOpacity),"elasticityMultiplier"in $&&i(8,Dt=$.elasticityMultiplier),"willRevert"in $&&i(247,Ht=$.willRevert),"willProcessImage"in $&&i(248,Ot=$.willProcessImage),"willRenderCanvas"in $&&i(9,Ft=$.willRenderCanvas),"willRenderToolbar"in $&&i(249,Wt=$.willRenderToolbar),"willRenderUtilTabs"in $&&i(250,Kt=$.willRenderUtilTabs),"willSetHistoryInitialState"in $&&i(251,ni=$.willSetHistoryInitialState),"enableButtonExport"in $&&i(252,pe=$.enableButtonExport),"enableButtonRevert"in $&&i(253,se=$.enableButtonRevert),"enableNavigateHistory"in $&&i(254,ke=$.enableNavigateHistory),"enableToolbar"in $&&i(10,xe=$.enableToolbar),"enableUtils"in $&&i(255,Xe=$.enableUtils),"enableButtonClose"in $&&i(256,ei=$.enableButtonClose),"enableDropImage"in $&&i(257,wi=$.enableDropImage),"enablePasteImage"in $&&i(258,ci=$.enablePasteImage),"enableBrowseImage"in $&&i(259,Ii=$.enableBrowseImage),"enableTransparencyGrid"in $&&i(11,mn=$.enableTransparencyGrid),"layoutDirectionPreference"in $&&i(260,ji=$.layoutDirectionPreference),"layoutHorizontalUtilsPreference"in $&&i(261,zi=$.layoutHorizontalUtilsPreference),"layoutVerticalUtilsPreference"in $&&i(262,xn=$.layoutVerticalUtilsPreference),"layoutVerticalToolbarPreference"in $&&i(263,Yi=$.layoutVerticalToolbarPreference),"layoutVerticalControlGroupsPreference"in $&&i(264,Un=$.layoutVerticalControlGroupsPreference),"layoutVerticalControlTabsPreference"in $&&i(265,sn=$.layoutVerticalControlTabsPreference),"textDirection"in $&&i(12,jr=$.textDirection),"markupEditorZoomLevel"in $&&i(266,kr=$.markupEditorZoomLevel),"markupEditorZoomLevels"in $&&i(13,Qr=$.markupEditorZoomLevels),"markupEditorZoomAdjustStep"in $&&i(14,Ua=$.markupEditorZoomAdjustStep),"markupEditorZoomAdjustFactor"in $&&i(15,Ga=$.markupEditorZoomAdjustFactor),"markupEditorZoomAdjustWheelFactor"in $&&i(16,Bs=$.markupEditorZoomAdjustWheelFactor),"markupEditorInteractionMode"in $&&i(267,cs=$.markupEditorInteractionMode),"muteAudio"in $&&i(268,Xo=$.muteAudio),"willSetMediaInitialTimeOffset"in $&&i(269,Po=$.willSetMediaInitialTimeOffset),"enablePan"in $&&i(17,Ro=$.enablePan),"enableZoom"in $&&i(18,ds=$.enableZoom),"enableZoomControls"in $&&i(270,ma=$.enableZoomControls),"enableZoomInput"in $&&i(19,Os=$.enableZoomInput),"enablePanInput"in $&&i(271,Io=$.enablePanInput),"enableCanvasAlpha"in $&&i(20,$a=$.enableCanvasAlpha),"enablePanLimit"in $&&i(21,us=$.enablePanLimit),"panLimitGutterScalar"in $&&i(22,Ws=$.panLimitGutterScalar),"zoomPresetOptions"in $&&i(23,jl=$.zoomPresetOptions),"zoomAdjustStep"in $&&i(24,Pa=$.zoomAdjustStep),"zoomAdjustFactor"in $&&i(25,Za=$.zoomAdjustFactor),"zoomAdjustWheelFactor"in $&&i(26,Qn=$.zoomAdjustWheelFactor),"zoomLevel"in $&&i(0,to=$.zoomLevel),"fixScrollDirection"in $&&i(272,Gc=$.fixScrollDirection),"imagePreviewSrc"in $&&i(275,Nu=$.imagePreviewSrc),"imageOrienter"in $&&i(276,Xc=$.imageOrienter),"pluginComponents"in $&&i(277,pl=$.pluginComponents),"pluginOptions"in $&&i(27,_s=$.pluginOptions),"root"in $&&i(2,tr=$.root),"imageSourceToImageData"in $&&i(28,Qu=$.imageSourceToImageData),"imagePreviewCurrent"in $&&i(235,sc=$.imagePreviewCurrent)},t.$$.update=()=>{if(16777216&t.$$.dirty[8]&&a0.set(Gc),8&t.$$.dirty[0]&&i(349,n=!!on),1&t.$$.dirty[0]|262144&t.$$.dirty[8]&&i(0,to=to===null?kr:to),2&t.$$.dirty[0]|536870912&t.$$.dirty[8]){let pt=!1;pl.forEach(([yt])=>{Eo[yt]||(i(1,Eo[yt]={},Eo),pt=!0)}),pt&&i(289,Yl=[...pl])}var $,Y,ft,Ct;if(8388608&t.$$.dirty[7]|1024&t.$$.dirty[9]|256&t.$$.dirty[11]&&i(347,N=n&&Yl.length?Ds||Yl.map(([pt])=>pt):[]),134217728&t.$$.dirty[0]|1024&t.$$.dirty[9]|64&t.$$.dirty[11]|8388608&t.$$.dirty[12]&&i(348,it=((pt,yt,_t,je)=>{const mi=yt.filter(([Wi])=>pt.includes(Wi)).filter(([Wi,{isSupported:qi}])=>qi({...je,..._t[Wi]})).map(([Wi,qi])=>[Wi,qi.Component]);return os(mi,_1,(Wi,qi)=>Wi[0]===qi[0]&&Wi[1]===qi[1])?_1:(_1=mi,mi)})(N,Yl,_s,{src:vr})),128&t.$$.dirty[11]&&i(301,ut=it.length),8&t.$$.dirty[0]|4194304&t.$$.dirty[9]|64&t.$$.dirty[11]&&i(346,st=ut&&N.map(pt=>{const yt=K0(pt);if(yt)return{id:pt,view:yt[1],tabIcon:on[pt+"Icon"],tabLabel:on[pt+"Label"]}}).filter(Boolean)||[]),32&t.$$.dirty[11]&&i(366,r=!!st.find(pt=>pt.id==="trim")),100663296&t.$$.dirty[11]|65536&t.$$.dirty[13]&&i(300,o=!!(Be&&Te&&r)),4194304&t.$$.dirty[7]|4194304&t.$$.dirty[9]&&i(43,mt=ut&&ls&&typeof ls=="string"&&K0(ls)?ls:ut>0?it[0][0]:void 0),4096&t.$$.dirty[1]|2097152&t.$$.dirty[9]&&o&&mt&&Vs(),2097152&t.$$.dirty[9]|67108864&t.$$.dirty[11]&&(o?(Te.addEventListener("play",Yc),Te.addEventListener("pause",Yc)):Te&&Te.nodeName==="video"&&(Te.removeEventListener("play",Yc),Te.removeEventListener("pause",Yc))),2097152&t.$$.dirty[9]&&o&&Xa.set(Xl()/Ya()),294912&t.$$.dirty[13]&&(pt=>{if(!hl())return;const yt=Date.now();if(Uu&&yt-Uu<16)return;Uu=yt;const _t=Be*pt;if(_t.toFixed(1)===l0)return;l0=_t.toFixed(1);const je=Te,mi=()=>{je.removeEventListener("seeked",mi),Hu()};je.addEventListener("seeked",mi),Tg(je,_t)})(Pi||ae),32768&t.$$.dirty[13]&&i(364,a=ae&&ai(ae,6)),598016&t.$$.dirty[13]&&i(362,s=jo||[[0,Math.min(Be,Vi)/Be]]),2097152&t.$$.dirty[11]&&(l=s[0][0]),2097152&t.$$.dirty[11]&&(c=s[s.length-1][1]),2097152&t.$$.dirty[11]&&i(365,d=s.map(([pt,yt])=>[ai(pt,6),ai(yt,6)])),25165824&t.$$.dirty[11]&&i(363,u=d.findIndex(([pt,yt])=>a>=pt&&a<=yt)),29360128&t.$$.dirty[11]&&(p=u===-1&&d.findIndex((pt,yt,_t)=>{const je=_t[yt-1];return je?a<=pt[0]&&a>=je[1]:a<=pt[0]})),1048576&t.$$.dirty[8]&&Zl.set(Xo),67108864&t.$$.dirty[11]|131072&t.$$.dirty[13]&&(Te&&vi?qu():Ku()),2097152&t.$$.dirty[9]|32768&t.$$.dirty[13]&&o&&Jc.set(Ya()*ae),67108864&t.$$.dirty[11]|16384&t.$$.dirty[13]&&Te&&(pt=>{o&&(Te.volume=Math.min(1,pt))})(A),256&t.$$.dirty[0]&&wt(Kc,Vr=Dt,Vr),1048576&t.$$.dirty[7]&&i(358,h=Ha==="overlay"),128&t.$$.dirty[8]|131072&t.$$.dirty[11]&&i(45,g=Xe&&!h),134217730&t.$$.dirty[0]&&_s&&Object.entries(_s).forEach(([pt,yt])=>{Object.entries(yt).forEach(([_t,je])=>{Eo[pt]&&i(1,Eo[pt][_t]=je,Eo)})}),256&t.$$.dirty[13]&&i(359,S=!pn),16777216&t.$$.dirty[7]|786432&t.$$.dirty[11]&&wt($d,ki=ja==="always"?b:ja!=="never"&&b&&S,ki),4194304&t.$$.dirty[1]|33554432&t.$$.dirty[7]&&Ju.set(ha?1:0,{hard:!ki}),268435456&t.$$.dirty[7]&&(m=L?($=L,Y=p0,Vn(Math.min($.width,Y.width),Math.min($.height,Y.height))):p0),4096&t.$$.dirty[13]&&t1.update(qr[0]),2048&t.$$.dirty[13]&&(f=Mo?(pt,yt)=>Mo(pt,{flipX:void 0,flipY:void 0,rotation:void 0,...yt,isPreview:!0}):Ji),268435456&t.$$.dirty[1]&&Array.isArray(pa)&&an("selectionchange",[...pa]),4194304&t.$$.dirty[8]|1024&t.$$.dirty[13]&&p1.set(Ba&&ma),8912896&t.$$.dirty[8]&&dd.set(cs==="pan"||Io),1048576&t.$$.dirty[1]&&Qi&&$l.set(In(Qi.x,Qi.y,Qi.width,Qi.height)),131072&t.$$.dirty[11]|32769&t.$$.dirty[12]&&Se&&h&&tn&&tn.complete&&(()=>{const pt=Hi,yt=rr(Se);pt&&pt===yt||(td.set(rr(Se)),X0())})(),64&t.$$.dirty[11]&&i(46,St=N.length>1),32768&t.$$.dirty[1]&&(St||gl.set(ws())),1024&t.$$.dirty[0]|512&t.$$.dirty[13]&&(xe||Ql.set(In(0,bi,0,0))),524288&t.$$.dirty[11]|2&t.$$.dirty[12]&&i(361,w=!bn&&b),1048576&t.$$.dirty[1]&&i(302,Fe=Qi&&Qi.width>0&&Qi.height>0),8&t.$$.dirty[0]|12582912&t.$$.dirty[9]&&i(40,Nt=Fe&&on&&!!ut),512&t.$$.dirty[1]&&setTimeout(()=>i(290,y1=Nt),1),16777216&t.$$.dirty[7]|2048&t.$$.dirty[9]|1310720&t.$$.dirty[11]&&wt(md,Or=ja==="always"?w:ja!=="never"&&w&&y1&&S,Or),67108864&t.$$.dirty[7]|131072&t.$$.dirty[11]&&gd.set(Ma||h),134217728&t.$$.dirty[7]&&yd.set(x),4&t.$$.dirty[0]|144&t.$$.dirty[13]&&tr&&(tr.dispatchEvent(gs("markupzoom",_i)),tr.dispatchEvent(gs("zoom",ui(_i)?_i:re))),4&t.$$.dirty[0]|64&t.$$.dirty[13]&&tr&&(tr.dispatchEvent(gs("markuppan",Mt)),tr.dispatchEvent(gs("pan",Mt))),8&t.$$.dirty[13]&&zn&&B0(),32&t.$$.dirty[13]&&xi&&C1(),4198400&t.$$.dirty[1]&&mt&&R1.set(.075,{hard:!ki}),536870912&t.$$.dirty[7]&&i(356,C=zt),6&t.$$.dirty[13]&&i(357,R=Jn?-Math.max(...Object.values(po)):0),138936320&t.$$.dirty[1]|98304&t.$$.dirty[11]&&Wn){let pt=Wn.x-ue.x,yt=ue.x+ue.width-(Wn.x+Wn.width),_t=Wn.y-ue.y,je=ue.y+ue.height-(Wn.y+Wn.height),mi=Math.min(pt,_t,yt,je);I1.set(mi>R?0:Math.min(C,Math.abs(mi/64)),{hard:!ki})}if(67108864&t.$$.dirty[1]&&i(355,M=.55/pr),4718592&t.$$.dirty[1]|16384&t.$$.dirty[11]&&ue&&E1.set({x:0,y:ue.y,width:ue.x<64?0:ue.x,height:ue.height+M},{hard:!ki}),4718592&t.$$.dirty[1]|16384&t.$$.dirty[11]|1&t.$$.dirty[12]&&ue&&A1.set({x:0,y:0,width:Se.width,height:ue.y+M},{hard:!ki}),4718592&t.$$.dirty[1]|16384&t.$$.dirty[11]|1&t.$$.dirty[12]&&ue){let pt=ue.x+ue.width,yt=Se.width-(ue.x+ue.width);yt<64&&(pt+=yt,yt=0),L1.set({x:pt,y:ue.y,width:yt,height:ue.height+M},{hard:!ki})}if(4718592&t.$$.dirty[1]|1&t.$$.dirty[12]&&ue&&z1.set({x:0,y:ue.y+ue.height,width:Se.width,height:Se.height-(ue.y+ue.height)},{hard:!ki}),33554432&t.$$.dirty[1]|268435456&t.$$.dirty[12]|1&t.$$.dirty[13]&&i(351,D=ur&&{id:"stage-overlay",backgroundColor:Sr,opacity:en,...ur}),33554432&t.$$.dirty[1]|1342177280&t.$$.dirty[12]&&i(354,T=Xr&&{id:"stage-overlay",backgroundColor:Sr,opacity:en,...Xr}),33554432&t.$$.dirty[1]|805306368&t.$$.dirty[12]&&i(353,F=uo&&{id:"stage-overlay",backgroundColor:Sr,opacity:en,...uo}),33554432&t.$$.dirty[1]|402653184&t.$$.dirty[12]&&i(352,W=wr&&{id:"stage-overlay",backgroundColor:Sr,opacity:en,...wr}),15360&t.$$.dirty[11]&&i(350,B=[T,F,W,D].filter(Boolean)),512&t.$$.dirty[11]|67108864&t.$$.dirty[12]&&B&&Gi&&rc.update(pt=>[...pt.filter(yt=>yt.id!=="stage-overlay"),...B]),134217728&t.$$.dirty[8]|8388608&t.$$.dirty[12]&&ac.set(Nu||vr||void 0),4&t.$$.dirty[0]|262144&t.$$.dirty[7]|67108864&t.$$.dirty[11]&&(i(235,sc=Te),Te&&tr.dispatchEvent(gs("loadpreview",sc))),65536&t.$$.dirty[12]&&No&&(bl.set(ln()),xl.set(void 0),B0(),vd.set([])),33554432&t.$$.dirty[12]&&i(306,V=co.index>0),33554432&t.$$.dirty[12]&&i(305,tt=co.index<co.length-1),393216&t.$$.dirty[1]|12&t.$$.dirty[12]&&(k=[Ni,De,dr,Hn]),8&t.$$.dirty[1]&&Y0.set(Cd),16777216&t.$$.dirty[12]&&W1.set(Rr),4096&t.$$.dirty[1]&&$x.set(mt),262144&t.$$.dirty[9]|32&t.$$.dirty[11]&&i(297,G=st.reduce((pt,yt)=>(pt[yt.id]=G&&G[yt.id]||0,pt),{})),4096&t.$$.dirty[1]&&i(79,gt={name:Fx,selected:mt}),32&t.$$.dirty[11]&&i(328,vt=st.map(pt=>({id:pt.id,icon:pt.tabIcon,label:pt.tabLabel}))),32&t.$$.dirty[11]&&i(78,lt=st.map(pt=>pt.id)),524288&t.$$.dirty[7]&&i(77,J=$i(["PinturaRoot","PinturaRootComponent",Zo])),1&t.$$.dirty[12]&&i(342,q=Se&&(Se.width>1e3?"wide":Se.width<600?"narrow":void 0)),1&t.$$.dirty[12]&&i(329,Z=Se&&(Se.width<=320||Se.height<=460)),1&t.$$.dirty[12]&&i(341,bt=Se&&(Se.height>1e3?"tall":Se.height<600?"short":void 0)),4&t.$$.dirty[0]&&i(308,nt=tr&&tr.parentNode&&tr.parentNode.classList.contains("PinturaModal")),1&t.$$.dirty[1]|536870912&t.$$.dirty[9]|1&t.$$.dirty[12]&&i(334,$t=nt&&Se&&Sd>Se.width),2&t.$$.dirty[1]|536870912&t.$$.dirty[9]|1&t.$$.dirty[12]&&i(333,Lt=nt&&Se&&B1>Se.height),25165824&t.$$.dirty[10]&&i(335,ie=$t&&Lt),1048576&t.$$.dirty[0]&&i(332,Vt=$a),2&t.$$.dirty[11]&&i(303,te=q==="narrow"),4096&t.$$.dirty[8]|1&t.$$.dirty[12]&&i(343,(ft=Se,Ct=ji,Yt=Se?Ct==="auto"?ft.width>ft.height?"landscape":"portrait":Ct==="horizontal"?ft.width<500?"portrait":"landscape":Ct==="vertical"?ft.height<400?"landscape":"portrait":void 0:"landscape")),4&t.$$.dirty[11]&&i(76,U=Yt==="landscape"),16777216&t.$$.dirty[9]|1&t.$$.dirty[11]&&i(331,Tt=te||bt==="short"),1&t.$$.dirty[1]|1&t.$$.dirty[12]&&i(330,ct=J0&&Se&&Sd===Se.width&&!G0),4&t.$$.dirty[1]|4194304&t.$$.dirty[12]&&i(304,Jt=[...lo||[],...Td].filter(Boolean)),8192&t.$$.dirty[8]&&i(340,de="has-navigation-preference-"+zi),16384&t.$$.dirty[8]&&i(339,ee="has-navigation-preference-"+xn),32768&t.$$.dirty[8]&&i(336,be="has-toolbar-preference-"+Yi),65536&t.$$.dirty[8]&&i(338,ve="has-controlgroups-preference-"+Un),131072&t.$$.dirty[8]&&i(337,_="has-controltabs-preference-"+sn),1&t.$$.dirty[12]&&i(345,Ce=Se!==void 0&&Se.width>0&&Se.height>0),4&t.$$.dirty[0]|16&t.$$.dirty[11]&&i(344,pi=Ce&&tr&&getComputedStyle(tr)),8&t.$$.dirty[11]&&pi&&tm(),1024&t.$$.dirty[0]|4243456&t.$$.dirty[1]|34603008&t.$$.dirty[7]|536870912&t.$$.dirty[9]|2146959360&t.$$.dirty[10]|7&t.$$.dirty[11]|3145856&t.$$.dirty[12]&&lc.set({...Gr,layoutMode:Ha,orientation:Yt,horizontalSpace:q,verticalSpace:bt,navigationHorizontalPreference:de,navigationVerticalPreference:ee,controlGroupsVerticalPreference:ve,controlTabsVerticalpreference:_,toolbarVerticalPreference:be,isModal:nt,isDisabled:ha,isCentered:ie,isCenteredHorizontally:$t,isCenteredVertically:Lt,isAnimated:ki,isTransparent:Vt,pointerAccuracy:Wr,pointerHoverable:To,isCompact:Tt,hasSwipeNavigation:ct,hasLimitedSpace:Z,hasToolbar:xe,hasNavigation:St&&g,isIOS:J0,browserVersion:Uh()?"chrome-"+(navigator.userAgent.match(/Chrome\/([0-9]+)/)||[])[1]:void 0}),128&t.$$.dirty[12]&&i(75,we=Object.entries(Gr).map(([pt,yt])=>/^is|has/.test(pt)?yt?D2(pt):void 0:yt).filter(Boolean).join(" ")),4096&t.$$.dirty[1]&&mt&&kd.set([]),4096&t.$$.dirty[1]|4&t.$$.dirty[8]|262144&t.$$.dirty[10]|128&t.$$.dirty[12]&&i(44,Bt=Kt(vt.map(pt=>({...pt,selected:mt===pt.id})),{...Gr},()=>Ns.set({}))),8192&t.$$.dirty[1]&&i(74,Ae=!!Bt.find(pt=>Array.isArray(pt))),786432&t.$$.dirty[12]&&i(73,Ee=Co&&Object.entries(da).filter(([,pt])=>pt!=null).reduce((pt,[,yt])=>pt={...pt,...yt},{})),32768&t.$$.dirty[12]&&i(325,ge=tn&&tn.task==="any-to-file"),32768&t.$$.dirty[10]&&ge&&qo&&qo.clear(),131072&t.$$.dirty[12]&&i(327,We=!!mr&&!!mr.translation),8192&t.$$.dirty[9]|131072&t.$$.dirty[10]|67108864&t.$$.dirty[11]&&We&&Te&&Te!==Pd&&(i(292,Pd=Te),Dx()),131072&t.$$.dirty[10]|131072&t.$$.dirty[12]&&We&&im(mr),16777216&t.$$.dirty[1]&&Br&&Br.length>1){let pt=[];qo.forEach((yt,_t)=>{_t!==0&&yt.get().opacity<=0&&pt.push(yt)}),pt.forEach(yt=>qo.remove(yt))}if(8&t.$$.dirty[0]|65536&t.$$.dirty[10]&&i(39,xt=on&&oi.length&&on.labelSupportError(oi)),32768&t.$$.dirty[12]&&i(317,Ue=tn&&!!tn.error),32768&t.$$.dirty[12]&&i(42,ze=!tn||!tn.complete&&tn.task===void 0),32768&t.$$.dirty[12]&&i(318,At=tn&&(tn.taskLengthComputable?tn.taskProgress:1/0)),32768&t.$$.dirty[10]&&ge&&wt(oc,Ln=!1,Ln),4194304&t.$$.dirty[1]|16384&t.$$.dirty[9]|32768&t.$$.dirty[12]&&tn&&tn.complete){const pt=ki?250:0;clearTimeout(Z1),i(293,Z1=setTimeout(()=>{wt(oc,Ln=!0,Ln)},pt))}if(2048&t.$$.dirty[1]|128&t.$$.dirty[10]|40960&t.$$.dirty[12]&&i(322,Ge=tn&&!Ue&&!ze&&!Ln),4096&t.$$.dirty[9]|67108864&t.$$.dirty[11]|65536&t.$$.dirty[12]&&i(321,Ke=!(!No||Te&&!ps)),4194304&t.$$.dirty[1]|8192&t.$$.dirty[12]&&(Ln?setTimeout(()=>Md.set(1,{hard:!ki}),ki?500:0):Md.set(0,{hard:!ki})),16640&t.$$.dirty[12]&&i(316,gi=!!(Xn||Bn&&Bn.progress!==void 0&&!Bn.complete)),64&t.$$.dirty[10]&&gi&&Vs(),2048&t.$$.dirty[1]|32768&t.$$.dirty[12]&&i(319,yi=tn&&!(tn.error||ze)),8&t.$$.dirty[0]|32768&t.$$.dirty[12]&&i(320,Li=on&&(tn?!tn.complete||tn.error?Hh(on.statusLabelLoadImage(tn),tn.error&&tn.error.metadata,"{","}"):on.statusLabelLoadImage({progress:1/0,task:"blob-to-bitmap"}):on.statusLabelLoadImage(tn))),8&t.$$.dirty[0]|16384&t.$$.dirty[12]&&i(315,Si=Bn&&on&&on.statusLabelProcessImage(Bn)),16384&t.$$.dirty[12]&&i(313,X=Bn&&(Bn.taskLengthComputable?Bn.taskProgress:1/0)),16384&t.$$.dirty[12]&&i(314,Zt=Bn&&!Bn.error),16384&t.$$.dirty[12]&&i(312,H=!(!Bn||!Bn.error)),8&t.$$.dirty[0]|2048&t.$$.dirty[1]|131072&t.$$.dirty[7]|8188&t.$$.dirty[10])if(xo){let pt,yt,_t,je,mi;Ve(xo)&&(pt=xo),ui(xo)?yt=xo:Array.isArray(xo)&&([pt,yt,mi]=xo,yt===!1&&(je=!0),ui(yt)&&(_t=!0)),i(35,Ka=(pt||yt)&&{text:pt,aside:je||_t,progressIndicator:{visible:_t,progress:yt},closeButton:je&&{label:on.statusLabelButtonClose,icon:on.statusIconButtonClose,onclick:mi||(()=>i(234,xo=void 0))}})}else i(35,Ka=on&&ze||Ue||Ge||Ke?{text:Li,aside:Ue||yi,progressIndicator:{visible:yi,progress:At},closeButton:Ue&&{label:on.statusLabelButtonClose,icon:on.statusIconButtonClose,onclick:Bx}}:on&&gi&&Si?{text:Si,aside:H||Zt,progressIndicator:{visible:Zt,progress:X},closeButton:H&&{label:on.statusLabelButtonClose,icon:on.statusIconButtonClose,onclick:Ox}}:void 0);if(131072&t.$$.dirty[7]&&i(324,qt=xo!==void 0),4194304&t.$$.dirty[1]|536870912&t.$$.dirty[9]|16384&t.$$.dirty[12]&&nt&&Bn&&Bn.complete&&(Rd.set(!0),setTimeout(()=>Rd.set(!1),ki?100:0)),4&t.$$.dirty[0]|4096&t.$$.dirty[1]|8192&t.$$.dirty[12]&&Ln&&tr&&tr.dispatchEvent(gs("selectutil",mt)),2304&t.$$.dirty[1]|22720&t.$$.dirty[10]|4096&t.$$.dirty[12]&&i(323,le=fo||xt||ze||Ue||Ge||Ke||gi||qt),8192&t.$$.dirty[10]&&wt(dc,so=le?1:0,so),4194304&t.$$.dirty[1]|8192&t.$$.dirty[10]&&dc.set(le?1:0,{duration:ki?500:1}),8388608&t.$$.dirty[1]&&i(41,Ut=so>0),16&t.$$.dirty[1]&&i(311,fe=!(!Ka||!Ka.aside)),4195344&t.$$.dirty[1]|32768&t.$$.dirty[9]|2&t.$$.dirty[10]|2048&t.$$.dirty[12]&&Ut&&Ka){clearTimeout(Ld);const pt={hard:ki===!1};if(fe){const yt=!!Ka.error||!ki;Ed.set(1,pt),Id.set(Vo,{hard:yt}),i(294,Ld=setTimeout(()=>{uc.set(16,pt)},1))}else Ed.set(0,pt),i(294,Ld=setTimeout(()=>{uc.set(0,pt)},1))}if(1024&t.$$.dirty[1]&&(Ut||(Ad.set(void 0,{hard:!0}),Id.set(void 0,{hard:!0}),uc.set(0,{hard:!0}))),1024&t.$$.dirty[12]&&i(310,Xt=.5*Zr),1&t.$$.dirty[10]|512&t.$$.dirty[12]&&i(72,Le=`transform: translateX(${_o-Xt}px)`),256&t.$$.dirty[1]|201326592&t.$$.dirty[11]&&i(38,He=Te&&ce&&!xt),128&t.$$.dirty[1]|1610612736&t.$$.dirty[9]&&i(307,_e=Je&&(He||nt)?nm:$e),268435456&t.$$.dirty[9]&&i(71,dt=_e),268435456&t.$$.dirty[9]&&i(70,jt=_e),8&t.$$.dirty[0]|2097152&t.$$.dirty[1]|370&t.$$.dirty[8]|251658240&t.$$.dirty[9]|128&t.$$.dirty[12]&&i(69,ne=on&&wn&&Wc(()=>Wt([["div","alpha",{class:"PinturaNavGroup"},[["div","alpha-set",{class:"PinturaNavSet"},[ei&&["Button","close",{label:on.labelClose,icon:on.iconButtonClose,onclick:()=>an("close"),hideLabel:!0}],se&&["Button","revert",{label:on.labelButtonRevert,icon:on.iconButtonRevert,disabled:!V,onclick:Mx,hideLabel:!0}]]]]],["div","beta",{class:"PinturaNavGroup PinturaNavGroupFloat"},[ke&&["div","history",{class:"PinturaNavSet"},[["Button","undo",{label:on.labelButtonUndo,icon:on.iconButtonUndo,disabled:!V,onclick:Ia.undo,hideLabel:!0}],["Button","redo",{label:on.labelButtonRedo,icon:on.iconButtonRedo,disabled:!tt,onclick:Ia.redo,hideLabel:!0}]]],Jt.length&&["div","plugin-tools",{class:"PinturaNavSet"},Jt.filter(Boolean).map(([pt,yt,_t])=>[pt,yt,{..._t}])]]],["div","gamma",{class:"PinturaNavGroup"},[pe&&["Button","export",{label:on.labelButtonExport,icon:te&&on.iconButtonExport,class:"PinturaButtonExport",onclick:Ex,hideLabel:te}]]]],{...Gr},()=>Ns.set({})))),8&t.$$.dirty[12]&&i(299,K=dr&&!!dr.length),1048576&t.$$.dirty[9]|134217728&t.$$.dirty[11]|8&t.$$.dirty[12]&&i(298,Qt=K&&Oy(ce,dr)),1572864&t.$$.dirty[9]|67108864&t.$$.dirty[11]|96&t.$$.dirty[12]&&K&&((pt,yt,_t,je)=>{if(!yt)return;const mi={dataSizeScalar:_t};je&&je[3]>0&&(mi.backgroundColor=[...je]),yt(pt,mi).then(Wi=>{wl&&Kn(wl),i(295,wl=Wi)})})(Te,br,Qt,Pn),65536&t.$$.dirty[9]|134217728&t.$$.dirty[11]|24&t.$$.dirty[12]&&dr&&wl&&ce){const{width:pt,height:yt}=ce,_t=La()?"pixelated":oo==="auto"?"auto":"pixelated";i(296,q1=dr.map(je=>{const mi=In(je.x,je.y,je.width,je.height),Wi=$r(Ci(mi),je.rotation).map(qi=>ot(qi.x/pt,qi.y/yt));return{...je,id:"redaction",flipX:!1,flipY:!1,cornerRadius:0,strokeWidth:0,strokeColor:void 0,backgroundColor:[0,0,0,0],backgroundImage:wl,backgroundImageRendering:_t,backgroundCorners:Wi}}))}131072&t.$$.dirty[9]|4&t.$$.dirty[12]&&i(37,Gt=[...q1,...Hn||[]]),32&t.$$.dirty[1]&&pc&&rm.set(pc),4&t.$$.dirty[0]|128&t.$$.dirty[1]&&He&&tr&&tr.dispatchEvent(gs("ready")),262144&t.$$.dirty[1]&&i(63,Fd=!0),2013265920&t.$$.dirty[11]&&i(64,Dd=!0),131072&t.$$.dirty[1]&&i(65,Bd=!0),65536&t.$$.dirty[1]&&i(66,Od=!0),64&t.$$.dirty[1]&&i(67,Wd=!0)},i(360,b=!Zh()),y=Cc()===1?$=>{$&&(wo($.origin,Math.round),wo($.translation,Math.round))}:Ji,i(326,oi=[!e3()&&"WebGL"].filter(Boolean)),i(309,Je=ra()||Pu()&&wa()),i(68,oe=(($,Y=!0)=>ft=>{ft.type==="ping"&&(Y&&ft.stopPropagation(),$(ft.detail.type,ft.detail.data))})(Er.pub)),[to,Eo,tr,on,Uc,j,rt,at,Dt,Ft,xe,mn,jr,Qr,Ua,Ga,Bs,Ro,ds,Os,$a,us,Ws,jl,Pa,Za,Qn,_s,Qu,F1,Ia,Sd,B1,Td,Cd,Ka,pc,Gt,He,xt,Nt,Ut,ze,mt,Bt,g,St,Qe,De,Ni,ue,Qi,wn,ki,so,Br,Sr,pr,Wn,pa,Ul,Zc,cc,Fd,Dd,Bd,Od,Wd,oe,ne,jt,dt,Le,Ee,Ae,we,U,J,lt,gt,Di,Ca,ti,hi,Ri,Bi,hn,Cn,gn,Oi,Ei,Ir,Uo,Oa,Ta,Wa,_a,Go,ss,ul,Va,Na,Kr,ju,Gl,Xa,Zl,Ns,Kc,Ju,e1,Hs,i1,Jc,n1,m0,r1,Qc,o1,td,a1,ga,ml,ed,id,nd,rd,od,ad,sd,js,s1,ld,w0,S0,k0,C0,T0,M0,P0,l1,c1,d1,cd,u1,p1,dd,h1,Kl,ud,Jl,m1,$1,$l,gl,g1,Ql,Us,pd,hd,tc,f1,md,$d,gd,Gs,ec,x1,Yo,fd,b1,A0,fl,yl,Ra,w1,qa,xl,S1,nc,bl,xd,k1,O0,bd,rc,j0,I1,E1,A1,L1,z1,oc,ac,D1,vd,wd,lc,O1,hs,qo,kd,q0,V1,N1,H1,($,Y)=>Y[$],$=>st.find(Y=>Y.id===$).view,j1,U1,G1,Md,({target:$,propertyName:Y})=>{$===tr&&/background|outline/.test(Y)&&pi&&tm()},em,dc,Rd,Id,Ed,uc,X1,Ad,$=>{const Y=!(!Ka||!Ka.closeButton)||!ki;X1.set($.detail.width,{hard:Y}),Ad.set(Math.round(.5*-$.detail.width),{hard:Y})},Wx,Xs,$=>{const{keyCode:Y,metaKey:ft,ctrlKey:Ct,shiftKey:pt}=$;if(Y===9&&ha)return void $.preventDefault();if($.target&&Y===32&&tr.contains($.target)&&!Oc($.target)&&(ao&&o&&Yu(),$.preventDefault()),Y===90&&(ft||Ct))return void(pt&&ft?Ia.redo():Ia.undo());if(Y===89&&Ct)return void Ia.redo();if(Y===229)return;const yt=new Set([...yn,Y]);Xs.set(Array.from(yt))},({key:$,keyCode:Y})=>{if($==="Meta")return Xs.set([]);Xs.set(yn.filter(ft=>ft!==Y))},()=>{Xs.set([])},$=>{Oc($.target)||$.preventDefault()},$=>{wi&&Y1($.detail.resources[0])},()=>{Ii&&B2().then(_x)},$=>{if(!ci)return;const Y=rn((window.innerWidth-Math.abs(Se.x))/Se.width,0,1),ft=rn((window.innerHeight-Math.abs(Se.y))/Se.height,0,1);Y<.75&&ft<.75||Y1(($.clipboardData||window.clipboardData).files[0])},om,dm,$=>{Ne&&ea($.detail,Ne)||wt(Us,Ne=$.detail,Ne)},xo,sc,Zo,Ha,Hr,ls,Ds,ja,ha,Ma,x,L,zt,Ht,Ot,Wt,Kt,ni,pe,se,ke,Xe,ei,wi,ci,Ii,ji,zi,xn,Yi,Un,sn,kr,cs,Xo,Po,ma,Io,Gc,()=>i(60,Ul=void 0),($,Y,ft)=>{const{text:Ct="",placeholder:pt="",autoClose:yt=!0,align:_t="top",justify:je="center",buttonConfirm:mi,buttonCancel:Wi}=ft;i(60,Ul={align:_t,justify:je,text:Ct,placeholder:pt,buttonConfirm:mi,buttonCancel:Wi,onconfirm:()=>{$(Zc.value),yt&&i(60,Ul=void 0)},oncancel:()=>{Y(void 0),i(60,Ul=void 0)}})},Nu,Xc,pl,nx,Xu,Vs,hl,Yu,qu,Ku,d0,Ya,Xl,qc,Yl,y1,ps,Pd,Z1,Ld,wl,q1,G,Qt,K,o,ut,Fe,te,Jt,tt,V,_e,nt,Je,Xt,fe,H,X,Zt,Si,gi,Ue,At,yi,Li,Ke,Ge,le,qt,ge,oi,We,vt,Z,ct,Tt,Vt,Lt,$t,ie,be,_,ve,ee,de,bt,q,Yt,pi,Ce,st,N,it,n,B,D,W,F,T,M,C,R,h,S,b,w,s,u,a,d,r,Te,ce,Ye,Me,Ze,Se,bn,Hn,dr,oo,Pn,br,Gr,Xn,_o,Zr,Vo,fo,Ln,Bn,tn,No,mr,da,Co,To,Wr,lo,vr,Rr,co,Gi,wr,en,uo,Xr,ur,po,Jn,zn,re,xi,Mt,_i,pn,bi,Ba,Mo,qr,jo,A,ae,Be,vi,Pi,Vi,function(){i(31,Sd=nl.innerWidth),i(32,B1=nl.innerHeight)},$=>wt(Ql,Ri=$.detail,Ri),({detail:$})=>i(43,mt=$),function($,Y){t.$$.not_equal(Eo[Y],$)&&(Eo[Y]=$,i(1,Eo),i(277,pl),i(27,_s))},$=>V1($),$=>N1($),($,{detail:Y})=>H1($,Y),$=>wt(gl,Di=$.detail,Di),function($){t.$$.not_equal(Eo[mt],$)&&(Eo[mt]=$,i(1,Eo),i(277,pl),i(27,_s))},()=>V1(mt),()=>N1(mt),({detail:$})=>H1(mt,$),$=>{const Y={...$,...om()},{annotationShapes:ft,decorationShapes:Ct,interfaceShapes:pt,frameShapes:yt,selectionShapes:_t}=Ft({annotationShapes:Ni,decorationShapes:De,interfaceShapes:Ta,frameShapes:Qe,selectionShapes:pa},Y);return dm(Y,Gt,ft,Ct,pt,yt,_t)},()=>{i(63,Fd=!1),i(64,Dd=!1),i(65,Bd=!1),i(66,Od=!1),i(67,Wd=!1)},function($){Fi[$?"unshift":"push"](()=>{pc=$,i(36,pc)})},function($){to=$,i(0,to),i(266,kr)},function($){Td=$,i(33,Td)},function($){Cd=$,i(34,Cd)},function($){Fi[$?"unshift":"push"](()=>{Zc=$,i(61,Zc)})},function($){Fi[$?"unshift":"push"](()=>{tr=$,i(2,tr)})},$=>wt($1,Qi=$.detail,Qi)]}class Ng extends li{constructor(e){super(),si(this,e,v3,b3,ri,{class:236,layout:237,stores:238,locale:3,id:4,util:239,utils:240,animations:241,disabled:242,status:234,previewUpscale:243,previewPad:244,previewMaskOpacity:5,previewImageDataMaxSize:245,previewImageTextPixelRatio:6,markupMaskOpacity:7,zoomMaskOpacity:246,elasticityMultiplier:8,willRevert:247,willProcessImage:248,willRenderCanvas:9,willRenderToolbar:249,willRenderUtilTabs:250,willSetHistoryInitialState:251,enableButtonExport:252,enableButtonRevert:253,enableNavigateHistory:254,enableToolbar:10,enableUtils:255,enableButtonClose:256,enableDropImage:257,enablePasteImage:258,enableBrowseImage:259,enableTransparencyGrid:11,layoutDirectionPreference:260,layoutHorizontalUtilsPreference:261,layoutVerticalUtilsPreference:262,layoutVerticalToolbarPreference:263,layoutVerticalControlGroupsPreference:264,layoutVerticalControlTabsPreference:265,textDirection:12,markupEditorZoomLevel:266,markupEditorZoomLevels:13,markupEditorZoomAdjustStep:14,markupEditorZoomAdjustFactor:15,markupEditorZoomAdjustWheelFactor:16,markupEditorInteractionMode:267,muteAudio:268,willSetMediaInitialTimeOffset:269,enablePan:17,enableZoom:18,enableZoomControls:270,enableZoomInput:19,enablePanInput:271,enableCanvasAlpha:20,enablePanLimit:21,panLimitGutterScalar:22,zoomPresetOptions:23,zoomAdjustStep:24,zoomAdjustFactor:25,zoomAdjustWheelFactor:26,zoomLevel:0,fixScrollDirection:272,hideTextInput:273,showTextInput:274,imagePreviewSrc:275,imageOrienter:276,pluginComponents:277,pluginOptions:27,sub:278,pluginInterface:1,root:2,play:279,pause:280,isPaused:281,togglePlayPause:282,mute:283,unmute:284,toggleMute:285,getDuration:286,getCurrentTime:287,setCurrentTime:288,imageSourceToImageData:28,imagePreview:29,imagePreviewCurrent:235,history:30},null,[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1])}get class(){return this.$$.ctx[236]}set class(e){this.$$set({class:e}),I()}get layout(){return this.$$.ctx[237]}set layout(e){this.$$set({layout:e}),I()}get stores(){return this.$$.ctx[238]}set stores(e){this.$$set({stores:e}),I()}get locale(){return this.$$.ctx[3]}set locale(e){this.$$set({locale:e}),I()}get id(){return this.$$.ctx[4]}set id(e){this.$$set({id:e}),I()}get util(){return this.$$.ctx[239]}set util(e){this.$$set({util:e}),I()}get utils(){return this.$$.ctx[240]}set utils(e){this.$$set({utils:e}),I()}get animations(){return this.$$.ctx[241]}set animations(e){this.$$set({animations:e}),I()}get disabled(){return this.$$.ctx[242]}set disabled(e){this.$$set({disabled:e}),I()}get status(){return this.$$.ctx[234]}set status(e){this.$$set({status:e}),I()}get previewUpscale(){return this.$$.ctx[243]}set previewUpscale(e){this.$$set({previewUpscale:e}),I()}get previewPad(){return this.$$.ctx[244]}set previewPad(e){this.$$set({previewPad:e}),I()}get previewMaskOpacity(){return this.$$.ctx[5]}set previewMaskOpacity(e){this.$$set({previewMaskOpacity:e}),I()}get previewImageDataMaxSize(){return this.$$.ctx[245]}set previewImageDataMaxSize(e){this.$$set({previewImageDataMaxSize:e}),I()}get previewImageTextPixelRatio(){return this.$$.ctx[6]}set previewImageTextPixelRatio(e){this.$$set({previewImageTextPixelRatio:e}),I()}get markupMaskOpacity(){return this.$$.ctx[7]}set markupMaskOpacity(e){this.$$set({markupMaskOpacity:e}),I()}get zoomMaskOpacity(){return this.$$.ctx[246]}set zoomMaskOpacity(e){this.$$set({zoomMaskOpacity:e}),I()}get elasticityMultiplier(){return this.$$.ctx[8]}set elasticityMultiplier(e){this.$$set({elasticityMultiplier:e}),I()}get willRevert(){return this.$$.ctx[247]}set willRevert(e){this.$$set({willRevert:e}),I()}get willProcessImage(){return this.$$.ctx[248]}set willProcessImage(e){this.$$set({willProcessImage:e}),I()}get willRenderCanvas(){return this.$$.ctx[9]}set willRenderCanvas(e){this.$$set({willRenderCanvas:e}),I()}get willRenderToolbar(){return this.$$.ctx[249]}set willRenderToolbar(e){this.$$set({willRenderToolbar:e}),I()}get willRenderUtilTabs(){return this.$$.ctx[250]}set willRenderUtilTabs(e){this.$$set({willRenderUtilTabs:e}),I()}get willSetHistoryInitialState(){return this.$$.ctx[251]}set willSetHistoryInitialState(e){this.$$set({willSetHistoryInitialState:e}),I()}get enableButtonExport(){return this.$$.ctx[252]}set enableButtonExport(e){this.$$set({enableButtonExport:e}),I()}get enableButtonRevert(){return this.$$.ctx[253]}set enableButtonRevert(e){this.$$set({enableButtonRevert:e}),I()}get enableNavigateHistory(){return this.$$.ctx[254]}set enableNavigateHistory(e){this.$$set({enableNavigateHistory:e}),I()}get enableToolbar(){return this.$$.ctx[10]}set enableToolbar(e){this.$$set({enableToolbar:e}),I()}get enableUtils(){return this.$$.ctx[255]}set enableUtils(e){this.$$set({enableUtils:e}),I()}get enableButtonClose(){return this.$$.ctx[256]}set enableButtonClose(e){this.$$set({enableButtonClose:e}),I()}get enableDropImage(){return this.$$.ctx[257]}set enableDropImage(e){this.$$set({enableDropImage:e}),I()}get enablePasteImage(){return this.$$.ctx[258]}set enablePasteImage(e){this.$$set({enablePasteImage:e}),I()}get enableBrowseImage(){return this.$$.ctx[259]}set enableBrowseImage(e){this.$$set({enableBrowseImage:e}),I()}get enableTransparencyGrid(){return this.$$.ctx[11]}set enableTransparencyGrid(e){this.$$set({enableTransparencyGrid:e}),I()}get layoutDirectionPreference(){return this.$$.ctx[260]}set layoutDirectionPreference(e){this.$$set({layoutDirectionPreference:e}),I()}get layoutHorizontalUtilsPreference(){return this.$$.ctx[261]}set layoutHorizontalUtilsPreference(e){this.$$set({layoutHorizontalUtilsPreference:e}),I()}get layoutVerticalUtilsPreference(){return this.$$.ctx[262]}set layoutVerticalUtilsPreference(e){this.$$set({layoutVerticalUtilsPreference:e}),I()}get layoutVerticalToolbarPreference(){return this.$$.ctx[263]}set layoutVerticalToolbarPreference(e){this.$$set({layoutVerticalToolbarPreference:e}),I()}get layoutVerticalControlGroupsPreference(){return this.$$.ctx[264]}set layoutVerticalControlGroupsPreference(e){this.$$set({layoutVerticalControlGroupsPreference:e}),I()}get layoutVerticalControlTabsPreference(){return this.$$.ctx[265]}set layoutVerticalControlTabsPreference(e){this.$$set({layoutVerticalControlTabsPreference:e}),I()}get textDirection(){return this.$$.ctx[12]}set textDirection(e){this.$$set({textDirection:e}),I()}get markupEditorZoomLevel(){return this.$$.ctx[266]}set markupEditorZoomLevel(e){this.$$set({markupEditorZoomLevel:e}),I()}get markupEditorZoomLevels(){return this.$$.ctx[13]}set markupEditorZoomLevels(e){this.$$set({markupEditorZoomLevels:e}),I()}get markupEditorZoomAdjustStep(){return this.$$.ctx[14]}set markupEditorZoomAdjustStep(e){this.$$set({markupEditorZoomAdjustStep:e}),I()}get markupEditorZoomAdjustFactor(){return this.$$.ctx[15]}set markupEditorZoomAdjustFactor(e){this.$$set({markupEditorZoomAdjustFactor:e}),I()}get markupEditorZoomAdjustWheelFactor(){return this.$$.ctx[16]}set markupEditorZoomAdjustWheelFactor(e){this.$$set({markupEditorZoomAdjustWheelFactor:e}),I()}get markupEditorInteractionMode(){return this.$$.ctx[267]}set markupEditorInteractionMode(e){this.$$set({markupEditorInteractionMode:e}),I()}get muteAudio(){return this.$$.ctx[268]}set muteAudio(e){this.$$set({muteAudio:e}),I()}get willSetMediaInitialTimeOffset(){return this.$$.ctx[269]}set willSetMediaInitialTimeOffset(e){this.$$set({willSetMediaInitialTimeOffset:e}),I()}get enablePan(){return this.$$.ctx[17]}set enablePan(e){this.$$set({enablePan:e}),I()}get enableZoom(){return this.$$.ctx[18]}set enableZoom(e){this.$$set({enableZoom:e}),I()}get enableZoomControls(){return this.$$.ctx[270]}set enableZoomControls(e){this.$$set({enableZoomControls:e}),I()}get enableZoomInput(){return this.$$.ctx[19]}set enableZoomInput(e){this.$$set({enableZoomInput:e}),I()}get enablePanInput(){return this.$$.ctx[271]}set enablePanInput(e){this.$$set({enablePanInput:e}),I()}get enableCanvasAlpha(){return this.$$.ctx[20]}set enableCanvasAlpha(e){this.$$set({enableCanvasAlpha:e}),I()}get enablePanLimit(){return this.$$.ctx[21]}set enablePanLimit(e){this.$$set({enablePanLimit:e}),I()}get panLimitGutterScalar(){return this.$$.ctx[22]}set panLimitGutterScalar(e){this.$$set({panLimitGutterScalar:e}),I()}get zoomPresetOptions(){return this.$$.ctx[23]}set zoomPresetOptions(e){this.$$set({zoomPresetOptions:e}),I()}get zoomAdjustStep(){return this.$$.ctx[24]}set zoomAdjustStep(e){this.$$set({zoomAdjustStep:e}),I()}get zoomAdjustFactor(){return this.$$.ctx[25]}set zoomAdjustFactor(e){this.$$set({zoomAdjustFactor:e}),I()}get zoomAdjustWheelFactor(){return this.$$.ctx[26]}set zoomAdjustWheelFactor(e){this.$$set({zoomAdjustWheelFactor:e}),I()}get zoomLevel(){return this.$$.ctx[0]}set zoomLevel(e){this.$$set({zoomLevel:e}),I()}get fixScrollDirection(){return this.$$.ctx[272]}set fixScrollDirection(e){this.$$set({fixScrollDirection:e}),I()}get hideTextInput(){return this.$$.ctx[273]}get showTextInput(){return this.$$.ctx[274]}get imagePreviewSrc(){return this.$$.ctx[275]}set imagePreviewSrc(e){this.$$set({imagePreviewSrc:e}),I()}get imageOrienter(){return this.$$.ctx[276]}set imageOrienter(e){this.$$set({imageOrienter:e}),I()}get pluginComponents(){return this.$$.ctx[277]}set pluginComponents(e){this.$$set({pluginComponents:e}),I()}get pluginOptions(){return this.$$.ctx[27]}set pluginOptions(e){this.$$set({pluginOptions:e}),I()}get sub(){return this.$$.ctx[278]}get pluginInterface(){return this.$$.ctx[1]}get root(){return this.$$.ctx[2]}set root(e){this.$$set({root:e}),I()}get play(){return this.$$.ctx[279]}get pause(){return this.$$.ctx[280]}get isPaused(){return this.$$.ctx[281]}get togglePlayPause(){return this.$$.ctx[282]}get mute(){return this.$$.ctx[283]}get unmute(){return this.$$.ctx[284]}get toggleMute(){return this.$$.ctx[285]}get getDuration(){return this.$$.ctx[286]}get getCurrentTime(){return this.$$.ctx[287]}get setCurrentTime(){return this.$$.ctx[288]}get imageSourceToImageData(){return this.$$.ctx[28]}set imageSourceToImageData(e){this.$$set({imageSourceToImageData:e}),I()}get imagePreview(){return this.$$.ctx[29]}get imagePreviewCurrent(){return this.$$.ctx[235]}set imagePreviewCurrent(e){this.$$set({imagePreviewCurrent:e}),I()}get history(){return this.$$.ctx[30]}}typeof window<"u"&&(t=>{if(t&&t._4ijgope)return;const[e,i,n]=[[99,111,110,115,111,108,101],[108,111,103],[84,104,105,115,32,118,101,114,115,105,111,110,32,111,102,32,80,105,110,116,117,114,97,32,105,115,32,102,111,114,32,116,101,115,116,105,110,103,32,112,117,114,112,111,115,101,115,32,111,110,108,121,46,32,86,105,115,105,116,32,104,116,116,112,115,58,47,47,112,113,105,110,97,46,110,108,47,112,105,110,116,117,114,97,32,116,111,32,112,117,114,99,104,97,115,101,32,97,32,108,105,99,101,110,115,101,46,32,86,105,115,105,116,32,104,116,116,112,115,58,47,47,112,113,105,110,97,46,110,108,47,112,105,110,116,117,114,97,47,99,104,97,116,32,105,102,32,121,111,117,32,104,97,118,101,32,97,110,121,32,113,117,101,115,116,105,111,110,115,46]].map(r=>r.map(o=>String.fromCharCode(o)).join(""));t&&t[e]&&t[e][i](n)})(window);const w3=["klass","stores","isVisible","isActive","isActiveFraction","locale"],S3=["history","klass","stores","navButtons","pluginComponents","pluginInterface","pluginOptions","sub","imagePreviewSrc","imagePreview","imagePreviewCurrent"],k3=["locale"];let Op;const O2=new Set([]),pu={},dh=new Map,C3=(...t)=>{t.filter(e=>!!e.util).forEach(e=>{const[i,n,r=()=>!0]=e.util;dh.has(i)||(dh.set(i,{Component:n,isSupported:r}),Xh(n).filter(o=>!w3.includes(o)).forEach(o=>{O2.add(o),pu[o]?pu[o].push(i):pu[o]=[i]}))})};var W2=[...n2,"init","update","undo","redo","revert","writehistory","destroy","show","hide","close","ready","zoom","pan","loadpreview","selectshape","blurshape","updateshape","addshape","removeshape","selectstyle","markuptap","markupzoom","markuppan","selectutil","selectcontrol","selectiondown","selectionup","selectionchange"],_2=(t,e,i={})=>{const{prefix:n="pintura:"}=i;return W2.map(r=>t.on(r,o=>Bl(e)?((a,s,l)=>a.dispatchEvent(new CustomEvent(s,{detail:l,bubbles:!0,cancelable:!0})))(e,`${n}${r}`,o):e(r,o)))};const T3=t=>Ve(t[0]),M3=t=>!T3(t),V2=t=>t[1],uh=t=>t[3]||[],P3=(t,e)=>{const i=ph(t,e);return w2(i,n=>V2(n)===t),i},ph=(t,e)=>{if(M3(e)){if(e.find(n=>V2(n)===t))return e;const i=e.find(n=>ph(t,uh(n)));return i&&i[3]}return ph(t,uh(e))},R3=()=>[.75,.25,.25,0,0,.25,.75,.25,0,0,.25,.25,.75,0,0,0,0,0,1,0],I3=()=>[1.398,-.316,.065,-.273,.201,-.051,1.278,-.08,-.273,.201,-.051,.119,1.151,-.29,.215,0,0,0,1,0],E3=()=>[1.073,-.015,.092,-.115,-.017,.107,.859,.184,-.115,-.017,.015,.077,1.104,-.115,-.017,0,0,0,1,0],A3=()=>[1.06,0,0,0,0,0,1.01,0,0,0,0,0,.93,0,0,0,0,0,1,0],L3=()=>[1.1,0,0,0,-.1,0,1.1,0,0,-.1,0,0,1.2,0,-.1,0,0,0,1,0],z3=()=>[.212,.715,.114,0,0,.212,.715,.114,0,0,.212,.715,.114,0,0,0,0,0,1,0],F3=()=>[.15,1.3,-.25,.1,-.2,.15,1.3,-.25,.1,-.2,.15,1.3,-.25,.1,-.2,0,0,0,1,0],D3=()=>[.163,.518,.084,-.01,.208,.163,.529,.082,-.02,.21,.171,.529,.084,0,.214,0,0,0,1,0],B3=()=>[.338,.991,.117,.093,-.196,.302,1.049,.096,.078,-.196,.286,1.016,.146,.101,-.196,0,0,0,1,0],O3=()=>[.393,.768,.188,0,0,.349,.685,.167,0,0,.272,.533,.13,0,0,0,0,0,1,0],W3=()=>[.289,.62,.185,0,.077,.257,.566,.163,0,.115,.2,.43,.128,0,.188,0,0,0,1,0],_3=()=>[.269,.764,.172,.05,.1,.239,.527,.152,0,.176,.186,.4,.119,0,.159,0,0,0,1,0],V3=()=>[.547,.764,.134,0,-.147,.281,.925,.12,0,-.135,.225,.558,.33,0,-.113,0,0,0,1,0],N3={chrome:I3,fade:E3,pastel:R3,cold:L3,warm:A3,monoDefault:z3,monoWash:D3,monoNoir:F3,monoStark:B3,sepiaDefault:O3,sepiaRust:_3,sepiaBlues:W3,sepiaColor:V3};var H3={filterFunctions:N3,filterOptions:[["Default",[[void 0,t=>t.labelDefault]]],["Classic",[["chrome",t=>t.filterLabelChrome],["fade",t=>t.filterLabelFade],["cold",t=>t.filterLabelCold],["warm",t=>t.filterLabelWarm],["pastel",t=>t.filterLabelPastel]]],["Monochrome",[["monoDefault",t=>t.filterLabelMonoDefault],["monoNoir",t=>t.filterLabelMonoNoir],["monoStark",t=>t.filterLabelMonoStark],["monoWash",t=>t.filterLabelMonoWash]]],["Sepia",[["sepiaDefault",t=>t.filterLabelSepiaDefault],["sepiaRust",t=>t.filterLabelSepiaRust],["sepiaBlues",t=>t.filterLabelSepiaBlues],["sepiaColor",t=>t.filterLabelSepiaColor]]]]};const j3={base:0,min:-.25,max:.25,getLabel:t=>Cs(t/.25),getStore:({imageColorMatrix:t})=>t,getValue:t=>{if(t.brightness)return t.brightness[4]},setValue:(t,e)=>t.update(i=>({...i,brightness:[1,0,0,0,e,0,1,0,0,e,0,0,1,0,e,0,0,0,1,0]}))},U3={base:1,min:.5,max:1.5,getLabel:t=>Cs(2*(t-.5)-1),getStore:({imageColorMatrix:t})=>t,getValue:t=>{if(t.contrast)return t.contrast[0]},setValue:(t,e)=>t.update(i=>({...i,contrast:[e,0,0,0,.5*(1-e),0,e,0,0,.5*(1-e),0,0,e,0,.5*(1-e),0,0,0,1,0]}))},G3={base:1,min:0,max:2,getLabel:t=>Cs(t-1),getStore:({imageColorMatrix:t})=>t,getValue:t=>{if(t.saturation)return(t.saturation[0]-.213)/.787},setValue:(t,e)=>t.update(i=>({...i,saturation:[.213+.787*e,.715-.715*e,.072-.072*e,0,0,.213-.213*e,.715+.285*e,.072-.072*e,0,0,.213-.213*e,.715-.715*e,.072+.928*e,0,0,0,0,0,1,0]}))},Z3={base:1,min:.5,max:1.5,getLabel:t=>Cs(2*(t-.5)-1),getStore:({imageColorMatrix:t})=>t,getValue:t=>{if(t.exposure)return t.exposure[0]},setValue:(t,e)=>t.update(i=>({...i,exposure:[e,0,0,0,0,0,e,0,0,0,0,0,e,0,0,0,0,0,1,0]}))},X3={base:1,min:.15,max:4,getLabel:t=>Cs(t<1?(t-.15)/.85-1:(t-1)/3),getStore:({imageGamma:t})=>t},Y3={base:0,min:-1,max:1,getStore:({imageVignette:t})=>t},q3={base:0,min:-1,max:1,getStore:({imageConvolutionMatrix:t})=>t,getValue:t=>{if(t.clarity)return t.clarity[0]===0?t.clarity[1]/-1:t.clarity[1]/-2},setValue:(t,e)=>{t.update(i=>({...i,clarity:e>=0?[0,-1*e,0,-1*e,1+4*e,-1*e,0,-1*e,0]:[-1*e,-2*e,-1*e,-2*e,1+-3*e,-2*e,-1*e,-2*e,-1*e]}))}},K3={base:0,min:-1,max:1,getStore:({imageColorMatrix:t})=>t,getValue:t=>{if(!t.temperature)return;const e=t.temperature[0];return e>=1?(e-1)/.1:(1-e)/-.15},setValue:(t,e)=>t.update(i=>({...i,temperature:e>0?[1+.1*e,0,0,0,0,0,1,0,0,0,0,0,1+.1*-e,0,0,0,0,0,1,0]:[1+.15*e,0,0,0,0,0,1+.05*e,0,0,0,0,0,1+.15*-e,0,0,0,0,0,1,0]}))};var J3={finetuneControlConfiguration:{gamma:X3,brightness:j3,contrast:U3,saturation:G3,exposure:Z3,temperature:K3,clarity:q3,vignette:Y3},finetuneOptions:[["brightness",t=>t.finetuneLabelBrightness],["contrast",t=>t.finetuneLabelContrast],["saturation",t=>t.finetuneLabelSaturation],["exposure",t=>t.finetuneLabelExposure],["temperature",t=>t.finetuneLabelTemperature],["gamma",t=>t.finetuneLabelGamma],!Zh()&&["clarity",t=>t.finetuneLabelClarity],["vignette",t=>t.finetuneLabelVignette]].filter(Boolean)};const Q3={shape:{frameColor:[1,1,1],frameStyle:"solid",frameSize:"2.5%"},thumb:'<rect stroke-width="5" x="0" y="0" width="100%" height="100%"/>'},tw={shape:{frameColor:[1,1,1],frameStyle:"solid",frameSize:"2.5%",frameRound:!0},thumb:'<rect stroke-width="5" x="0" y="0" width="100%" height="100%" rx="12%"/>'},ew={shape:{frameColor:[1,1,1],frameStyle:"line",frameInset:"2.5%",frameSize:".3125%",frameRadius:0},thumb:'<div style="top:.5em;left:.5em;right:.5em;bottom:.5em;box-shadow:inset 0 0 0 1px currentColor"></div>'},iw={shape:{frameColor:[1,1,1],frameStyle:"line",frameAmount:2,frameInset:"2.5%",frameSize:".3125%",frameOffset:"1.25%",frameRadius:0},thumb:'<div style="top:.75em;left:.75em;right:.75em;bottom:.75em; outline: 3px double"></div>'},nw={shape:{frameColor:[1,1,1],frameStyle:"edge",frameInset:"2.5%",frameOffset:"5%",frameSize:".3125%"},thumb:'<div style="top:.75em;left:.5em;bottom:.75em;border-left:1px solid"></div><div style="top:.75em;right:.5em;bottom:.75em;border-right:1px solid"></div><div style="top:.5em;left:.75em;right:.75em;border-top:1px solid"></div><div style="bottom:.5em;left:.75em;right:.75em;border-bottom:1px solid"></div>'},rw={shape:{frameColor:[1,1,1],frameStyle:"edge",frameInset:"2.5%",frameSize:".3125%"},thumb:'<div style="top:-.5em;left:.5em;right:.5em;bottom:-.5em; box-shadow: inset 0 0 0 1px currentColor"></div><div style="top:.5em;left:-.5em;right:-.5em;bottom:.5em;box-shadow:inset 0 0 0 1px currentColor"></div>'},ow={shape:{frameColor:[1,1,1],frameStyle:"edge",frameOffset:"1.5%",frameSize:".3125%"},thumb:'<div style="top:.3125em;left:.5em;bottom:.3125em;border-left:1px solid"></div><div style="top:.3125em;right:.5em;bottom:.3125em;border-right:1px solid"></div><div style="top:.5em;left:.3125em;right:.3125em;border-top:1px solid"></div><div style="bottom:.5em;left:.3125em;right:.3125em;border-bottom:1px solid"></div>'},aw={shape:{frameColor:[1,1,1],frameStyle:"hook",frameInset:"2.5%",frameSize:".3125%",frameLength:"5%"},thumb:'<div style="top:.5em;left:.5em;width:.75em;height:.75em; border-left: 1px solid;border-top: 1px solid;"></div><div style="top:.5em;right:.5em;width:.75em;height:.75em; border-right: 1px solid;border-top: 1px solid;"></div><div style="bottom:.5em;left:.5em;width:.75em;height:.75em; border-left: 1px solid;border-bottom: 1px solid;"></div><div style="bottom:.5em;right:.5em;width:.75em;height:.75em; border-right: 1px solid;border-bottom: 1px solid;"></div>'},sw={shape:{frameColor:[1,1,1],frameStyle:"polaroid"},thumb:'<rect stroke-width="20%" x="-5%" y="-5%" width="110%" height="96%"/>'};var lw={frameStyles:{solidSharp:Q3,solidRound:tw,lineSingle:ew,lineMultiple:iw,edgeSeparate:nw,edgeCross:rw,edgeOverlap:ow,hook:aw,polaroid:sw},frameOptions:[[void 0,t=>t.labelNone],["solidSharp",t=>t.frameLabelMatSharp],["solidRound",t=>t.frameLabelMatRound],["lineSingle",t=>t.frameLabelLineSingle],["lineMultiple",t=>t.frameLabelLineMultiple],["edgeCross",t=>t.frameLabelEdgeCross],["edgeSeparate",t=>t.frameLabelEdgeSeparate],["edgeOverlap",t=>t.frameLabelEdgeOverlap],["hook",t=>t.frameLabelCornerHooks],["polaroid",t=>t.frameLabelPolaroid]]},_l=t=>t.charAt(0).toUpperCase()+t.slice(1);let xc=null;var Wp=()=>{if(xc===null)if(Mr())try{xc=document.fonts.check("16px TestNonExistingFont")===!1}catch{xc=!1}else xc=!1;return xc};const _c=(t,e)=>i=>i[e?`${e}${_l(t)}`:t],cw=t=>[t,""+t],Wu=(t,e)=>i=>[t[i],_c(i,e)],N2=t=>Array.isArray(t)&&t.every(ui)?t.map(cw):t,tl=[1,.2549,.2118],Hg=[1,1,1,0],dw=t=>{const{hideLabel:e=!0}=t||{};return Cw(["new","add","subtract"].map(i=>[i,_c(i,"shapeLabelSelectionMode"),{icon:_c(i,"shapeIconSelectionMode"),hideLabel:e}]),{title:i=>i.shapeTitleSelectionMode,layout:"radio"})},uw=t=>j2(t,{title:e=>e.shapeTitleBrushSize,layout:"radio",optionHideLabel:!0,optionIcon:(e,i)=>`<circle fill="currentColor" stroke-width=".05em" stroke="currentColor" fill-opacity=".25" cx="12" cy="12" r="${2+8*i}"/>`}),jg={eraser:()=>({eraseRadius:8,cursorStyle:"ellipse",cursorSize:"eraseRadius"}),path:()=>({points:[],disableAddPoints:!1}),line:()=>({x1:0,y1:0,x2:0,y2:0,disableErase:!1}),rectangle:()=>({x:0,y:0,width:0,height:0}),ellipse:()=>({x:0,y:0,rx:0,ry:0}),text:()=>({x:0,y:0,text:"Text"})},ms=(t,e={},i)=>{if(!jg[t])return;const{position:n="relative",inputMode:r="drag",isSelection:o=!1}=i||{};return[{...jg[t](),...e},{position:n,inputMode:r,isSelection:o}]},pw=t=>({sharpie:ms("path",{bitmap:!0,strokeJoin:"round",strokeCap:"round",strokeWidth:"0.5%",strokeColor:[...tl],cursorStyle:"ellipse",cursorSize:"strokeWidth",disableErase:!1,disableResize:!0,disableMove:!0}),eraser:ms("eraser"),path:ms("path",{pathClose:void 0,strokeWidth:"0.5%",strokeColor:[...tl],backgroundColor:[0,0,0,0]},{inputMode:"step"}),line:ms("line",{strokeColor:[...tl],strokeWidth:"0.5%"}),arrow:ms("line",{lineStart:"none",lineEnd:"arrow-solid",strokeColor:[...tl],strokeWidth:"0.5%"}),rectangle:ms("rectangle",{strokeColor:[...Hg],backgroundColor:[...tl]}),ellipse:ms("ellipse",{strokeColor:[...Hg],backgroundColor:[...tl]}),text:ms("text",{color:[...tl],fontSize:"2%"}),...t}),_p=(t,e,i)=>[t,e||_c(t,"shapeLabelTool"),{icon:_c(t,"shapeIconTool"),...i}],hw=(t=["move","view","sharpie","eraser","path","line","arrow","rectangle","ellipse","text","preset"])=>t.map(e=>Ve(e)?_p(e):Array.isArray(e)?sl(e[1])?_p(e[0],void 0,e[1]):_p(e[0],e[1],e[2]):void 0).filter(Boolean),mw=t=>Object.keys(t).map(Wu(t,"shapeTitleColor")),$w=t=>Object.keys(t).map(Wu(t,"labelSize")),gw=t=>Object.keys(t).map(Wu(t,"labelSize")),Ug=t=>Object.keys(t).map(Wu(t,"labelSize")),fw=t=>[...t],yw=t=>t.map(e=>[e,i=>i["shapeLabelFontStyle"+e.filter(n=>n!=="normal").map(_l).join("")]]),xw=t=>t.map(e=>[D2(e),i=>i["shapeTitleLineDecoration"+_l(e)],{icon:i=>i["shapeIconLineDecoration"+_l(e)]}]),za=(t,e)=>{const{defaultKey:i,defaultValue:n,defaultOptions:r}=e||{},o=[];return i&&(o[0]=[n,a=>a[i],{...r}]),[...o,...t]},Gg=t=>t.split(",").map(e=>e.trim()).some(e=>document.fonts.check("16px "+e)),Zg=(t={})=>["ToggleSlider",{...t}],bw=(t,e={defaultKey:"labelDefault"})=>["Dropdown",{title:i=>i.shapeTitleFontFamily,onload:({options:i=[]})=>{Wp()&&i.map(([n])=>n).filter(Boolean).filter(n=>!Gg(n)).forEach(n=>{const r="PinturaFontTest-"+n.replace(/[^a-zA-Z0-9]+/g,"").toLowerCase();document.getElementById(r)||document.body.append(fn("span",{textContent:" ",id:r,class:"PinturaFontTest",style:`font-family:${n};font-size:0;color:transparent;`}))})},ondestroy:()=>{Wp()&&document.querySelectorAll(".PinturaFontTest").forEach(i=>i.remove())},optionLabelStyle:i=>"font-family: "+i,options:za(t,e),optionFilter:i=>{if(!Wp())return!0;const[n]=i;return n?Gg(n):!0}}],t0=(t,e={})=>["ColorPicker",{options:za(t),...e}],vw=(t,e={})=>t0(t,{title:i=>i.labelColor,...e}),H2=t=>(e,i={})=>t0(e,{title:n=>n[t],...i}),ww=H2("shapeTitleBackgroundColor"),Sw=H2("shapeTitleTextColor"),kw=(t,e={})=>t0(t,{title:i=>i.shapeTitleStrokeColor,options:za(t),buttonClass:"PinturaColorPickerButtonStroke",onchange:(i,n)=>{const r=n.strokeWidth;(ui(r)||Ve(r)?parseFloat(r):0)>0||(n.strokeWidth=e&&e.defaultStrokeWidth||"0.5%")},...e}),j2=(t,e)=>{const{title:i,optionHideLabel:n=!1,layout:r,optionIcon:o=!1}=e||{},a=N2(t),s=t.map(([u])=>Ve(u)?parseFloat(u):u),l=Math.max(...s),c=Math.min(...s),d=l-c;return[r==="radio"?"RadioGroup":"Dropdown",{title:i===!1?void 0:i||(u=>u.shapeTitleStrokeWidth),options:u=>{const p=e?a.map(h=>{const[g,m,f={}]=h,b=Ve(g)?parseFloat(g):g,w=(b-c)/d;let S;return o==="line"?S=`<path stroke="currentColor" stroke-linecap="square" stroke-width="${.1+.875*w}em" d="M3,12 H20"/>`:o==="dot"?S=`<circle fill="currentColor" cx="12" cy="12" r="${2+8*w}"/>`:Ve(o)?S=o:cn(o)&&(S=o(b,w)),[g,m,{icon:S,hideLabel:n,...f}]}):a;return Ie(u,"backgroundColor")?za(p,{defaultKey:"shapeLabelStrokeNone"}):za(p)},onchange:(u,p)=>{if(!u)return;const h=p.strokeColor||[];if(h[3])return;const g=[...h];g[3]=1,p.strokeColor=g}}]},Cw=(t,e)=>{const{title:i,layout:n}=e||{};return[n==="radio"?"RadioGroup":"Dropdown",{title:i,options:za(t)}]},U2=(t,e,i)=>["Dropdown",{title:n=>n[e],options:za(t,{defaultKey:"labelNone",defaultOptions:{icon:'<g stroke="currentColor" stroke-linecap="round" stroke-width=".125em"><path d="M5,12 H14"/></g>'}}),optionIconStyle:i}],Tw=t=>U2(t,"shapeTitleLineStart","transform: scaleX(-1)"),Mw=t=>U2(t,"shapeTitleLineEnd"),Pw=t=>["Dropdown",{title:e=>e.shapeTitleFontStyle,optionLabelStyle:e=>e&&`font-style:${e[0]};font-weight:${e[1]}`,options:za(t,{defaultKey:"shapeLabelFontStyleNormal"})}],G2=t=>["ShorthandControl",t],Z2=(t,e,i,n)=>{n||t.find(([o])=>o===i)||(n={defaultKey:"labelAuto",defaultValue:i});const r=N2(t);return["Dropdown",{title:e,options:za(r,n),...n}]},Rw=(t,e)=>Z2(t,i=>i.shapeTitleFontSize,"4%",e),Iw=(t,e)=>Z2(t,i=>i.shapeTitleLineHeight,"120%",e),Ew=t=>["RadioGroup",{title:e=>e.shapeTitleTextAlign,options:za(t)}],Vp={colorOptions:()=>mw({transparent:[1,1,1,0],white:[1,1,1],silver:[.8667,.8667,.8667],gray:[.6667,.6667,.6667],black:[0,0,0],navy:[0,.1216,.2471],blue:[0,.4549,.851],aqua:[.498,.8588,1],teal:[.2235,.8,.8],olive:[.2392,.6,.4392],green:[.1804,.8,.251],yellow:[1,.8627,0],orange:[1,.5216,.1059],red:[1,.2549,.2118],maroon:[.5216,.0784,.2941],fuchsia:[.9412,.0706,.7451],purple:[.6941,.051,.7882]}),lineEndStyleOptions:()=>xw(["bar","arrow","arrowSolid","circle","circleSolid","square","squareSolid"]),fontFamilyOptions:()=>fw([["Helvetica, Arial, Verdana, 'Droid Sans', sans-serif","Sans Serif"],["'Arial Black', 'Avenir-Black', 'Arial Bold'","Black"],["'Arial Narrow', 'Futura-CondensedMedium'","Narrow"],["'Trebuchet MS'","Humanist"],["Georgia, 'Avenir-Black', 'Times New Roman', 'Droid Serif', serif","Serif"],["Palatino","Old-Style"],["'Times New Roman', 'TimesNewRomanPSMT'","Transitional"],["Menlo, Monaco, 'Lucida Console', monospace","Monospaced"],["'Courier New', monospace","Slab Serif"]]),fontStyleOptions:()=>yw([["normal","bold"],["italic","normal"],["italic","bold"]]),textAlignOptions:()=>["left","center","right"].map(t=>[t,e=>e["shapeTitleTextAlign"+_l(t)],{hideLabel:!0,icon:e=>e["shapeIconTextAlign"+_l(t)]}]),strokeWidthOptions:()=>Ug({extraSmall:"0.25%",small:"0.5%",mediumSmall:"1%",medium:"1.75%",mediumLarge:"2.5%",large:"3.5%",extraLarge:"5%"}),brushSizeOptions:()=>Ug(Object.entries({extraSmall:"0.25%",small:"0.5%",mediumSmall:"1%",medium:"1.75%",mediumLarge:"2.5%",large:"3.5%",extraLarge:"5%"}).reduce((t,[e,i])=>(t[e]=2*parseFloat(i)+"%",t),{})),fontSizeOptions:()=>$w({extraSmall:"2%",small:"4%",mediumSmall:"8%",medium:"10%",mediumLarge:"15%",large:"20%",extraLarge:"25%"}),lineHeightOptions:()=>gw({extraSmall:"40%",small:"60%",mediumSmall:"100%",medium:"120%",mediumLarge:"140%",large:"180%",extraLarge:"220%"})},Aw=new Intl.NumberFormat("default",{minimumFractionDigits:1,maximumFractionDigits:1}),X2=(t,e)=>Ve(e)?t+"%":t,Y2=(t,e,i,n)=>Ve(n)?Math.round(t/i*100)+"%":""+Aw.format(t),Np={getValue:t=>parseFloat(t),setValue:X2,label:Y2,step:.05,labelClass:"PinturaPercentageLabel"},Lw={factory:G2,options:{title:"Text shadow",controls:[["ToggleSlider","x",{...Np,min:-100,max:100,labelPrefix:"X"}],["ToggleSlider","y",{...Np,min:-100,max:100,labelPrefix:"Y"}],["ToggleSlider","blur",{...Np,min:0,max:25,labelPrefix:t=>t.shapeTitleTextShadowBlur}],["ColorPicker","color",{enablePresets:!1}]]}},eu={defaultColor:{factory:vw,items:"colorOptions"},defaultNumber:{factory:Zg},defaultPercentage:{factory:Zg,options:{getValue:t=>parseFloat(t),setValue:t=>t+"%",step:.05,label:(t,e,i)=>Math.round(t/i*100)+"%",labelClass:"PinturaPercentageLabel"}},backgroundColor:{items:"colorOptions",factory:ww},strokeColor:{items:"colorOptions",factory:kw},strokeWidth:{items:"strokeWidthOptions",factory:j2},brushSize:{items:"brushSizeOptions",factory:uw},drawMode:{factory:dw},lineStart:{items:"lineEndStyleOptions",factory:Tw},lineEnd:{items:"lineEndStyleOptions",factory:Mw},color:{items:"colorOptions",factory:Sw},fontFamily:{items:"fontFamilyOptions",factory:bw},fontStyle_fontWeight:{items:"fontStyleOptions",factory:Pw},fontSize:{items:"fontSizeOptions",factory:Rw},lineHeight:{items:"lineHeightOptions",factory:Iw},textAlign:{items:"textAlignOptions",factory:Ew},textShadowX_textShadowY_textShadowBlur_textShadowColor:Lw,textOutlineWidth_textOutlineColor:{factory:G2,options:{title:"Text outline",controls:[["ToggleSlider","width",{getValue:t=>parseFloat(t),setValue:X2,label:Y2,min:0,max:15,step:.05,labelClass:"PinturaPercentageLabel",labelPrefix:t=>t.shapeTitleTextOutlineWidth}],["ColorPicker","color",{enablePresets:!1}]]}},cornerRadius:{factory:"defaultPercentage",options:{min:0,max:50,title:t=>t.shapeTitleCornerRadius}},frameColor:{factory:"defaultColor"},frameSize:{factory:"defaultPercentage",options:{min:.2,max:10,title:t=>t.labelSize}},frameInset:{factory:"defaultPercentage",options:{min:.5,max:10,title:t=>t.labelOffset}},frameOffset:{factory:"defaultPercentage",options:{min:.5,max:10,title:t=>t.labelOffset}},frameRadius:{factory:"defaultPercentage",options:{min:.5,max:10,title:t=>t.labelRadius}},frameAmount:{factory:"defaultNumber",options:{min:1,max:5,step:1,title:t=>t.labelAmount}}},q2=(t={})=>{const e={...eu,...t},i={};return Object.entries(e).forEach(([n,r])=>{if(!/Options$/.test(n))if(eu[n]&&sl(r)&&!En(r)){const{component:o,factory:a,items:s,options:l={}}=e[n];if(Ve(a))i[n]=[a,l];else{const c=eu[n].items;let d=Ve(c)?e[c]||Vp[c]():void 0;Ve(s)&&Vp[s]?d=e[s]?e[s].every(p=>!Array.isArray(p))?e[s].map(p=>[p,p]):e[s]:Vp[s]():(s||l.items)&&(d=s||l.items);let u=a||eu[n].factory;cn(u)?i[n]=d?u(d,l):u(l):o&&(i[n]=[o,{...l,items:s}])}}else i[n]=r}),i};function zw(t){let e,i,n,r,o;const a=t[7].default,s=ar(a,t,t[6],null);return{c(){e=ht("div"),i=ht("div"),s&&s.c(),v(i,"class","PinturaToolbarInner"),v(e,"class","PinturaToolbar"),v(e,"data-layout",t[1]),v(e,"data-overflow",t[0])},m(l,c){et(l,e,c),kt(e,i),s&&s.m(i,null),n=!0,r||(o=[Pt(i,"measure",t[3]),Xi(xr.call(null,i)),Pt(e,"measure",t[2]),Xi(xr.call(null,e))],r=!0)},p(l,[c]){s&&s.p&&(!n||64&c)&&lr(s,a,l,l[6],n?sr(a,l[6],c,null):cr(l[6]),null),(!n||2&c)&&v(e,"data-layout",l[1]),(!n||1&c)&&v(e,"data-overflow",l[0])},i(l){n||(P(s,l),n=!0)},o(l){z(s,l),n=!1},d(l){l&&Q(e),s&&s.d(l),r=!1,Ui(o)}}}function Fw(t,e,i){let n,r,{$$slots:o={},$$scope:a}=e,s=0,l=0,c=0;const d=()=>{i(0,r=n==="compact"&&s>c?"overflow":void 0)};return t.$$set=u=>{"$$scope"in u&&i(6,a=u.$$scope)},t.$$.update=()=>{48&t.$$.dirty&&i(1,n=l>c?"compact":"default")},[r,n,({detail:u})=>{const{width:p}=u;i(5,c=p),d()},({detail:u})=>{const{width:p}=u;p>l&&i(4,l=p),s=p,r||d()},l,c,a,o]}class K2 extends li{constructor(e){super(),si(this,e,Fw,zw,ri,{})}}function Dw(t){let e,i,n,r;const o=t[5].default,a=ar(o,t,t[4],null);return{c(){e=ht("div"),a&&a.c(),v(e,"class",t[0])},m(s,l){et(s,e,l),a&&a.m(e,null),i=!0,n||(r=[Pt(e,"measure",function(){Zi(t[1]&&t[3])&&(t[1]&&t[3]).apply(this,arguments)}),Xi(t[2].call(null,e))],n=!0)},p(s,[l]){t=s,a&&a.p&&(!i||16&l)&&lr(a,o,t,t[4],i?sr(o,t[4],l,null):cr(t[4]),null),(!i||1&l)&&v(e,"class",t[0])},i(s){i||(P(a,s),i=!0)},o(s){z(a,s),i=!1},d(s){s&&Q(e),a&&a.d(s),n=!1,Ui(r)}}}function Bw(t,e,i){let{$$slots:n={},$$scope:r}=e;const o=Sa();let{class:a=null}=e;const s=un("measurable");let l=!1;return Es(()=>i(1,l=!0)),t.$$set=c=>{"class"in c&&i(0,a=c.class),"$$scope"in c&&i(4,r=c.$$scope)},[a,l,s,({detail:c})=>o("measure",c),r,n]}class Ow extends li{constructor(e){super(),si(this,e,Bw,Dw,ri,{class:0})}}const Ww=t=>({}),Xg=t=>({}),_w=t=>({}),Yg=t=>({}),Vw=t=>({}),qg=t=>({});function Kg(t){let e,i;const n=t[4].header,r=ar(n,t,t[3],qg);return{c(){e=ht("div"),r&&r.c(),v(e,"class","PinturaUtilHeader")},m(o,a){et(o,e,a),r&&r.m(e,null),i=!0},p(o,a){r&&r.p&&(!i||8&a)&&lr(r,n,o,o[3],i?sr(n,o[3],a,Vw):cr(o[3]),qg)},i(o){i||(P(r,o),i=!0)},o(o){z(r,o),i=!1},d(o){o&&Q(e),r&&r.d(o)}}}function Jg(t){let e,i;const n=t[4].footer,r=ar(n,t,t[3],Xg);return{c(){e=ht("div"),r&&r.c(),v(e,"class","PinturaUtilFooter")},m(o,a){et(o,e,a),r&&r.m(e,null),i=!0},p(o,a){r&&r.p&&(!i||8&a)&&lr(r,n,o,o[3],i?sr(n,o[3],a,Ww):cr(o[3]),Xg)},i(o){i||(P(r,o),i=!0)},o(o){z(r,o),i=!1},d(o){o&&Q(e),r&&r.d(o)}}}function Nw(t){let e,i,n,r,o,a,s=t[1]&&Kg(t);const l=t[4].main,c=ar(l,t,t[3],Yg),d=c||function(p){let h,g;return h=new Ow({props:{class:"PinturaStage"}}),h.$on("measure",p[5]),{c(){Et(h.$$.fragment)},m(m,f){Rt(h,m,f),g=!0},p:ii,i(m){g||(P(h.$$.fragment,m),g=!0)},o(m){z(h.$$.fragment,m),g=!1},d(m){It(h,m)}}}(t);let u=t[2]&&Jg(t);return{c(){s&&s.c(),e=me(),i=ht("div"),d&&d.c(),n=me(),u&&u.c(),r=me(),o=Mn(),v(i,"class","PinturaUtilMain")},m(p,h){s&&s.m(p,h),et(p,e,h),et(p,i,h),d&&d.m(i,null),t[6](i),et(p,n,h),u&&u.m(p,h),et(p,r,h),et(p,o,h),a=!0},p(p,[h]){p[1]?s?(s.p(p,h),2&h&&P(s,1)):(s=Kg(p),s.c(),P(s,1),s.m(e.parentNode,e)):s&&(Pe(),z(s,1,1,()=>{s=null}),Re()),c&&c.p&&(!a||8&h)&&lr(c,l,p,p[3],a?sr(l,p[3],h,_w):cr(p[3]),Yg),p[2]?u?(u.p(p,h),4&h&&P(u,1)):(u=Jg(p),u.c(),P(u,1),u.m(r.parentNode,r)):u&&(Pe(),z(u,1,1,()=>{u=null}),Re())},i(p){a||(P(s),P(d,p),P(u),P(!1),a=!0)},o(p){z(s),z(d,p),z(u),z(!1),a=!1},d(p){s&&s.d(p),p&&Q(e),p&&Q(i),d&&d.d(p),t[6](null),p&&Q(n),u&&u.d(p),p&&Q(r),p&&Q(o)}}}function Hw(t,e,i){let{$$slots:n={},$$scope:r}=e,{hasHeader:o=!!e.$$slots.header}=e,{hasFooter:a=!!e.$$slots.footer}=e,{root:s}=e;return t.$$set=l=>{i(7,e=Tn(Tn({},e),Fc(l))),"hasHeader"in l&&i(1,o=l.hasHeader),"hasFooter"in l&&i(2,a=l.hasFooter),"root"in l&&i(0,s=l.root),"$$scope"in l&&i(3,r=l.$$scope)},e=Fc(e),[s,o,a,r,n,function(l){Dr.call(this,t,l)},function(l){Fi[l?"unshift":"push"](()=>{s=l,i(0,s)})}]}class dl extends li{constructor(e){super(),si(this,e,Hw,Nw,ri,{hasHeader:1,hasFooter:2,root:0})}}function Qg(t){let e,i;return{c(){e=ht("div"),v(e,"class","PinturaRangeInputMeter"),v(e,"style",i=`transform: translateX(${t[9].x-t[12].x}px) translateY(${t[9].y-t[12].y}px)`)},m(n,r){et(n,e,r),e.innerHTML=t[7]},p(n,r){128&r[0]&&(e.innerHTML=n[7]),512&r[0]&&i!==(i=`transform: translateX(${n[9].x-n[12].x}px) translateY(${n[9].y-n[12].y}px)`)&&v(e,"style",i)},d(n){n&&Q(e)}}}function jw(t){let e,i,n,r,o,a,s,l,c,d,u,p=t[9]&&Qg(t);return{c(){e=ht("div"),i=ht("span"),n=me(),r=ht("button"),o=$n(t[1]),s=me(),l=ht("div"),p&&p.c(),v(i,"class","PinturaRangeInputValue"),v(r,"class","PinturaRangeInputReset"),v(r,"type","button"),r.disabled=a=t[0]===t[2],v(l,"class","PinturaRangeInputInner"),v(l,"style",t[8]),v(l,"data-value-limited",t[5]),v(e,"class","PinturaRangeInput"),v(e,"tabindex","0")},m(h,g){et(h,e,g),kt(e,i),i.innerHTML=t[3],kt(e,n),kt(e,r),kt(r,o),kt(e,s),kt(e,l),p&&p.m(l,null),d||(u=[Pt(r,"click",t[17]),Pt(l,"interactionstart",t[13]),Pt(l,"interactionupdate",t[15]),Pt(l,"interactionend",t[16]),Pt(l,"interactionrelease",t[14]),Xi(c=zs.call(null,l,{inertia:t[6]})),Pt(l,"measure",t[37]),Xi(xr.call(null,l)),Pt(e,"wheel",t[19],{passive:!1}),Pt(e,"nudge",t[20]),Xi(Fs.call(null,e,{direction:"horizontal",preventDefault:!0}))],d=!0)},p(h,g){8&g[0]&&(i.innerHTML=h[3]),2&g[0]&&An(o,h[1]),5&g[0]&&a!==(a=h[0]===h[2])&&(r.disabled=a),h[9]?p?p.p(h,g):(p=Qg(h),p.c(),p.m(l,null)):p&&(p.d(1),p=null),256&g[0]&&v(l,"style",h[8]),32&g[0]&&v(l,"data-value-limited",h[5]),c&&Zi(c.update)&&64&g[0]&&c.update.call(null,{inertia:h[6]})},i:ii,o:ii,d(h){h&&Q(e),p&&p.d(),d=!1,Ui(u)}}}function Uw(t,e,i){let n,r,o,a,s,l,c,d,u,p,{labelReset:h="Reset"}=e,{direction:g="x"}=e,{min:m=0}=e,{max:f=1}=e,{base:b=m}=e,{value:w=0}=e,{valueLabel:S=0}=e,{valueMin:C}=e,{valueMax:R}=e,{oninputstart:M=$e}=e,{oninputmove:D=$e}=e,{oninputend:T=$e}=e,{elasticity:F=0}=e,{nudgeMultiplier:W}=e,{step:B=8}=e;const y=un("isAnimated");E(t,y,nt=>i(6,d=nt));const V=un("fixScrollDirection");E(t,V,nt=>i(43,u=nt));const tt=(nt,$t,Lt)=>Math.ceil((nt-Lt)/$t)*$t+Lt;let k,N,it;const ut={x:2,y:0},st=(nt,$t,Lt)=>`M ${nt-Lt} ${$t} a ${Lt} ${Lt} 0 1 0 0 -1`;let mt,G,gt=!1,vt={snap:!1,elastic:!1};const lt=(nt,$t,Lt)=>{const ie=nt[g]+$t[g],Vt=rn(ie,mt[1][g],mt[0][g]),te=F?Vt+bs(ie-Vt,F):Vt,Yt=Lt.elastic?te:Vt,U=ot(0,0);return U[g]=Yt,St.set(U,{hard:Lt.snap}),rn(q(U,g),m,f)},St=di();E(t,St,nt=>i(9,p=nt));const J=(nt,$t)=>{const Lt=.5*(k[$t]-a[$t])-(Tc(nt,m,f)*a[$t]-.5*a[$t]);return{x:$t==="x"?Lt:0,y:$t==="y"?Lt:0}},q=(nt,$t)=>{const Lt=-(nt[$t]-.5*k[$t])/a[$t];return m+Lt*n},Z=St.subscribe(nt=>{nt&&G&&D(rn(q(nt,g),m,f))}),bt=nt=>{const $t=[J(C??m,g),J(R??f,g)],Lt={x:g==="x"?p.x+nt:0,y:g==="y"?p.y+nt:0},ie=rn(Lt[g],$t[1][g],$t[0][g]),Vt={...p,[g]:ie};wt(St,p=Vt,p);const te=rn(q(Vt,g),m,f);M(),D(te),T(te)};return Wo(()=>{Z()}),t.$$set=nt=>{"labelReset"in nt&&i(1,h=nt.labelReset),"direction"in nt&&i(21,g=nt.direction),"min"in nt&&i(22,m=nt.min),"max"in nt&&i(23,f=nt.max),"base"in nt&&i(2,b=nt.base),"value"in nt&&i(0,w=nt.value),"valueLabel"in nt&&i(3,S=nt.valueLabel),"valueMin"in nt&&i(24,C=nt.valueMin),"valueMax"in nt&&i(25,R=nt.valueMax),"oninputstart"in nt&&i(26,M=nt.oninputstart),"oninputmove"in nt&&i(27,D=nt.oninputmove),"oninputend"in nt&&i(28,T=nt.oninputend),"elasticity"in nt&&i(29,F=nt.elasticity),"nudgeMultiplier"in nt&&i(30,W=nt.nudgeMultiplier),"step"in nt&&i(31,B=nt.step)},t.$$.update=()=>{if(12582912&t.$$.dirty[0]&&i(33,n=f-m),20971520&t.$$.dirty[0]&&i(35,r=C!=null?Math.max(C,m):m),41943040&t.$$.dirty[0]&&i(34,o=R!=null?Math.min(R,f):f),12582916&t.$$.dirty[0]&&i(36,s=Tc(b,m,f)),16&t.$$.dirty[0]|32&t.$$.dirty[1]&&k){const nt=.5*k.y;let $t,Lt=40*s,ie="",Vt=k.y,te="";for(let Yt=0;Yt<=40;Yt++){const U=ut.x+10*Yt,Tt=nt;ie+=st(U,Tt,Yt%5==0?2:.75)+" ",$t=U+ut.x,Yt===Lt&&(te=`<path d="M${U} ${Tt-4} l2 3 l-2 -1 l-2 1 z"/>`)}i(7,N=`<svg width="${$t}" height="${Vt}" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 ${$t} ${Vt}" aria-hidden="true" focusable="false">
        ${te}
        <rect rx="4" ry="4" y="${nt-4}"" height="8"/>
        <path fill-rule="evenodd" d="${ie.trim()}"/></svg>`),i(32,it={x:$t-2*ut.x,y:Vt})}16&t.$$.dirty[0]|2&t.$$.dirty[1]&&(a=k&&it),12582912&t.$$.dirty[0]|24&t.$$.dirty[1]&&i(5,l=r!==m||o!==f),32&t.$$.dirty[0]|24&t.$$.dirty[1]&&i(8,c=l?function(nt,$t){const ie=Tc(nt,m,f),Vt=Tc($t,m,f);return`--range-mask-from:${100*ai(tt(ie,.025,0)-.0125)}%;--range-mask-to:${100*ai(tt(Vt,.025,0)-.0125)}%`}(r,o):""),2097233&t.$$.dirty[0]|4&t.$$.dirty[1]&&n&&k&&k.x&&k.y&&St.set(J(w,g),{hard:d===!1})},[w,h,b,S,k,l,d,N,c,p,y,V,ut,()=>{gt=!1,G=va(St),mt=[J(C??m,g),J(R??f,g)],M()},()=>{gt=!0},({detail:nt})=>{vt.snap=!gt,vt.elastic=!gt,lt(G,nt.translation,vt)},({detail:nt})=>{vt.snap=!1,vt.elastic=!1;const $t=lt(G,nt.translation,vt);if(G=void 0,mt=void 0,Math.abs($t-b)<.01)return T(b);T($t)},()=>{i(0,w=rn(b,r,o)),M(),T(w)},St,nt=>{nt.preventDefault(),nt.stopPropagation();const $t=Bu(nt,{fixScrollDirection:u})*B;bt($t)},({detail:nt})=>{bt(nt[g]*Math.abs(W||8))},g,m,f,C,R,M,D,T,F,W,B,it,n,o,r,s,nt=>i(4,k=($t=>ot($t.width,$t.height))(nt.detail))]}class e0 extends li{constructor(e){super(),si(this,e,Uw,jw,ri,{labelReset:1,direction:21,min:22,max:23,base:2,value:0,valueLabel:3,valueMin:24,valueMax:25,oninputstart:26,oninputmove:27,oninputend:28,elasticity:29,nudgeMultiplier:30,step:31},null,[-1,-1])}}var Gw={[Ts]:t=>({x:t.x,y:t.y}),[aa]:t=>({x:t.x+t.width,y:t.y}),[Ms]:t=>({x:t.x+t.width,y:t.y}),[sa]:t=>({x:t.x+t.width,y:t.y+t.height}),[Ps]:t=>({x:t.x,y:t.y+t.height}),[la]:t=>({x:t.x,y:t.y+t.height}),[Rs]:t=>({x:t.x,y:t.y}),[oa]:t=>({x:t.x,y:t.y})};function tf(t,e,i){const n=t.slice();return n[14]=e[i].key,n[15]=e[i].translate,n[16]=e[i].scale,n[17]=e[i].type,n[18]=e[i].opacity,n}function ef(t,e){let i,n,r,o,a,s,l,c;return{key:t,first:null,c(){i=ht("div"),v(i,"role","button"),v(i,"aria-label",n=`Drag ${e[17]} ${e[14]}`),v(i,"tabindex",r=e[17]==="edge"?-1:0),v(i,"class","PinturaRectManipulator"),v(i,"data-direction",o=e[14]),v(i,"data-shape",a=e[17]==="edge"?"edge":""+e[0]),v(i,"style",s=`--tx:${e[15].x};--ty:${e[15].y};--sx:${e[16].x};--sy:${e[16].y};opacity:${e[18]}`),this.first=i},m(d,u){et(d,i,u),l||(c=[Pt(i,"nudge",function(){Zi(e[6](e[14]))&&e[6](e[14]).apply(this,arguments)}),Xi(Fs.call(null,i,{preventDefault:!0})),Pt(i,"interactionstart",function(){Zi(e[5]("resizestart",e[14]))&&e[5]("resizestart",e[14]).apply(this,arguments)}),Pt(i,"interactionupdate",function(){Zi(e[5]("resizemove",e[14]))&&e[5]("resizemove",e[14]).apply(this,arguments)}),Pt(i,"interactionend",function(){Zi(e[5]("resizeend",e[14]))&&e[5]("resizeend",e[14]).apply(this,arguments)}),Xi(zs.call(null,i))],l=!0)},p(d,u){e=d,2&u&&n!==(n=`Drag ${e[17]} ${e[14]}`)&&v(i,"aria-label",n),2&u&&r!==(r=e[17]==="edge"?-1:0)&&v(i,"tabindex",r),2&u&&o!==(o=e[14])&&v(i,"data-direction",o),3&u&&a!==(a=e[17]==="edge"?"edge":""+e[0])&&v(i,"data-shape",a),2&u&&s!==(s=`--tx:${e[15].x};--ty:${e[15].y};--sx:${e[16].x};--sy:${e[16].y};opacity:${e[18]}`)&&v(i,"style",s)},d(d){d&&Q(i),l=!1,Ui(c)}}}function Zw(t){let e,i=[],n=new Map,r=t[1];const o=a=>a[14];for(let a=0;a<r.length;a+=1){let s=tf(t,r,a),l=o(s);n.set(l,i[a]=ef(l,s))}return{c(){for(let a=0;a<i.length;a+=1)i[a].c();e=Mn()},m(a,s){for(let l=0;l<i.length;l+=1)i[l].m(a,s);et(a,e,s)},p(a,[s]){99&s&&(r=a[1],i=Da(i,s,o,1,a,r,n,e.parentNode,Ky,ef,e,tf))},i:ii,o:ii,d(a){for(let s=0;s<i.length;s+=1)i[s].d(a);a&&Q(e)}}}function Xw(t,e,i){let n,r,o,a,{rect:s=null}=e,{visible:l=!1}=e,{style:c}=e;const d=un("isAnimated");E(t,d,m=>i(11,a=m));const u=di(void 0,{precision:1e-4,stiffness:.2,damping:.4});E(t,u,m=>i(10,o=m));const p=di(0,{precision:.001});let h;E(t,p,m=>i(9,r=m));const g=Sa();return t.$$set=m=>{"rect"in m&&i(7,s=m.rect),"visible"in m&&i(8,l=m.visible),"style"in m&&i(0,c=m.style)},t.$$.update=()=>{2304&t.$$.dirty&&u.set(l?1:.5,{hard:a===!1}),2304&t.$$.dirty&&p.set(l?1:0,{hard:a===!1}),1664&t.$$.dirty&&i(1,n=Object.keys(jp).map((m,f)=>{const b=jp[m],w=Gw[b](s),S=b.length===1?"edge":"corner",C=S==="corner";return{key:b,type:S,scale:{x:/^(t|b)$/.test(b)?s.width:C?rn(o,.5,1.25):1,y:/^(r|l)$/.test(b)?s.height:C?rn(o,.5,1.25):1},translate:{x:w.x,y:w.y},opacity:r}}))},[c,n,d,u,p,(m,f)=>({detail:b})=>{h&&f!==h||m!=="resizestart"&&h===void 0||(m==="resizestart"&&(h=f),m==="resizeend"&&(h=void 0),g(m,{direction:f,translation:b&&b.translation}))},m=>({detail:f})=>{g("resizestart",{direction:m,translation:{x:0,y:0}}),g("resizemove",{direction:m,translation:f}),g("resizeend",{direction:m,translation:{x:0,y:0}})},s,l,r,o,a]}class Yw extends li{constructor(e){super(),si(this,e,Xw,Zw,ri,{rect:7,visible:8,style:0})}}var qw=t=>{function e(a,s){t.dispatchEvent(new CustomEvent(a,{detail:s}))}const i=a=>{a.preventDefault(),t.addEventListener("gesturechange",n),t.addEventListener("gestureend",r),e("gesturedown")},n=a=>{a.preventDefault(),e("gestureupdate",a.scale)},r=a=>{e("gestureup",a.scale),a.preventDefault(),o()},o=()=>{t.removeEventListener("gesturechange",n),t.removeEventListener("gestureend",r)};return t.addEventListener("gesturestart",i),{destroy:()=>{o(),t.removeEventListener("gesturestart",i)}}},i0={[Ts]:Ps,[Ms]:Rs,[Ps]:Ts,[Rs]:Ms,[oa]:sa,[aa]:la,[sa]:oa,[la]:aa},n0=t=>{const e=t===Rs||t===Ms,i=t===Ts||t===Ps;return[t===Ms||t===aa||t===sa,t===Rs||t===la||t===oa,t===Ts||t===aa||t===oa,t===Ps||t===sa||t===la,e,i,e||i]},nf=(t,e,i,n={})=>{const{target:r,translate:o}=e,{aspectRatio:a,minSize:s,maxSize:l}=n,c=Ac[i0[r]],d=Fn(ot(t.x,t.y),ot(c[0]*t.width,c[1]*t.height)),u=Ac[r],p=Fn(Ci(t),ot(u[0]*t.width,u[1]*t.height)),[h,g,m,f,b,w,S]=n0(r);let C=o.x,R=o.y;b?R=0:w&&(C=0);const{inner:M,outer:D}=Kw(d,r,i,{aspectRatio:a,minSize:s,maxSize:l});let[T,F,W,B]=al(t);if(h?B=d.x:g&&(F=d.x),f?T=d.y:m&&(W=d.y),h){const y=M.x+M.width,V=D.x+D.width;F=rn(p.x+C,y,V)}else if(g){const y=D.x,V=M.x;B=rn(p.x+C,y,V)}if(f){const y=M.y+M.height,V=D.y+D.height;W=rn(p.y+R,y,V)}else if(m){const y=D.y,V=M.y;T=rn(p.y+R,y,V)}if(B>M.x&&(B=M.x),F<M.x+M.width&&(F=M.x+M.width),T>M.y&&(T=M.y),W<M.y+M.height&&(W=M.y+M.height),B<D.x){const y=D.x-B;B=D.x,F+=y}if(F>D.x+D.width){const y=F-(D.x+D.width);F=D.x+D.width,B-=y}if(T<D.y){const y=D.y-T;T=D.y,W+=y}if(W>D.y+D.height){const y=W-(D.y+D.height);W=D.y+D.height,T-=y}if(a)if(S){let y=F-B,V=W-T;b?(V=y/a,T=d.y-.5*V,W=d.y+.5*V):w&&(y=V*a,B=d.x-.5*y,F=d.x+.5*y)}else{const y=ot(p.x+C-d.x,p.y+R-d.y);r===aa?(y.x=Math.max(0,y.x),y.y=Math.min(0,y.y)):r===sa?(y.x=Math.max(0,y.x),y.y=Math.max(0,y.y)):r===la?(y.x=Math.min(0,y.x),y.y=Math.max(0,y.y)):r===oa&&(y.x=Math.min(0,y.x),y.y=Math.min(0,y.y));const V=vs(y),tt=vs(ot(M.width,M.height)),k=vs(ot(D.width,D.height)),N=rn(V,tt,k),it=ot(a,1),ut=Tr(no(it),N);r===aa?(F=d.x+ut.x,T=d.y-ut.y):r===sa?(F=d.x+ut.x,W=d.y+ut.y):r===la?(B=d.x-ut.x,W=d.y+ut.y):r===oa&&(B=d.x-ut.x,T=d.y-ut.y)}return In(B,T,F-B,W-T)};const Kw=(t,e,i,n)=>{const{aspectRatio:r,minSize:o,maxSize:a}=n,s=e===Ms||e===aa||e===sa,l=e===Rs||e===la||e===oa,c=e===Ts||e===aa||e===oa,d=e===Ps||e===sa||e===la,u=e===Rs||e===Ms,p=e===Ts||e===Ps,h=Ci(i);s?(h.x=t.x,h.width-=t.x):l&&(h.width=t.x),d?(h.y=t.y,h.height-=t.y):c&&(h.height=t.y);const g=((M,D)=>ca(0,0,M,D))(Math.min(h.width,a.width),Math.min(h.height,a.height));if(r){if(u){const M=Math.min(t.y,i.height-t.y);g.height=Math.min(2*M,g.height)}else if(p){const M=Math.min(t.x,i.width-t.x);g.width=Math.min(2*M,g.width)}}const m=r?ol(rs(Fr(o),r)):o,f=r?ol(Ur(g,r)):g;let b,w,S,C;s?b=t.x:l&&(w=t.x),d?S=t.y:c&&(C=t.y),s?w=b+m.width:l&&(b=w-m.width),d?C=S+m.height:c&&(S=C-m.height),u?(S=t.y-.5*m.height,C=t.y+.5*m.height):p&&(b=t.x-.5*m.width,w=t.x+.5*m.width);const R=nr([ot(b,S),ot(w,C)]);return s?w=b+f.width:l&&(b=w-f.width),d?C=S+f.height:c&&(S=C-f.height),u?(S=t.y-.5*f.height,C=t.y+.5*f.height):p&&(b=t.x-.5*f.width,w=t.x+.5*f.width),b=Math.max(i.x,b),w=Math.min(i.x+i.width,w),S=Math.max(i.y,S),C=Math.min(i.y+i.height,C),{inner:R,outer:nr([ot(b,S),ot(w,C)])}};var rf=t=>180*t/Math.PI;function Jw(t){let e,i,n;return i=new e0({props:{elasticity:t[5],min:t[9],max:t[10],value:t[11],valueMin:Math.max(t[9],t[0]),valueMax:Math.min(t[10],t[1]),labelReset:t[6],base:t[12],valueLabel:Math.round(rf(t[11]))+"&deg;",oninputstart:t[2],oninputmove:t[17],oninputend:t[18]}}),{c(){e=ht("div"),Et(i.$$.fragment),v(e,"class","PinturaImageRotator")},m(r,o){et(r,e,o),Rt(i,e,null),n=!0},p(r,[o]){const a={};32&o&&(a.elasticity=r[5]),512&o&&(a.min=r[9]),1024&o&&(a.max=r[10]),2048&o&&(a.value=r[11]),513&o&&(a.valueMin=Math.max(r[9],r[0])),1026&o&&(a.valueMax=Math.min(r[10],r[1])),64&o&&(a.labelReset=r[6]),4096&o&&(a.base=r[12]),2048&o&&(a.valueLabel=Math.round(rf(r[11]))+"&deg;"),4&o&&(a.oninputstart=r[2]),392&o&&(a.oninputmove=r[17]),400&o&&(a.oninputend=r[18]),i.$set(a)},i(r){n||(P(i.$$.fragment,r),n=!0)},o(r){z(i.$$.fragment,r),n=!1},d(r){r&&Q(e),It(i)}}}function Qw(t,e,i){let n,r,o,a,s,l,c,{rotation:d}=e,{valueMin:u}=e,{valueMax:p}=e,{oninputstart:h=$e}=e,{oninputmove:g=$e}=e,{oninputend:m=$e}=e,{elasticity:f=0}=e,{labelReset:b}=e,{rotationMin:w}=e,{rotationMax:S}=e;return t.$$set=C=>{"rotation"in C&&i(13,d=C.rotation),"valueMin"in C&&i(0,u=C.valueMin),"valueMax"in C&&i(1,p=C.valueMax),"oninputstart"in C&&i(2,h=C.oninputstart),"oninputmove"in C&&i(3,g=C.oninputmove),"oninputend"in C&&i(4,m=C.oninputend),"elasticity"in C&&i(5,f=C.elasticity),"labelReset"in C&&i(6,b=C.labelReset),"rotationMin"in C&&i(14,w=C.rotationMin),"rotationMax"in C&&i(15,S=C.rotationMax)},t.$$.update=()=>{16384&t.$$.dirty&&i(9,n=w+1e-9),32768&t.$$.dirty&&i(10,r=S-1e-9),1536&t.$$.dirty&&i(12,o=n+.5*(r-n)),32768&t.$$.dirty&&i(16,a=2*S),8192&t.$$.dirty&&i(8,s=Math.sign(d)),73728&t.$$.dirty&&i(7,l=Math.round(Math.abs(d)/a)*a),8576&t.$$.dirty&&i(11,c=d-s*l)},[u,p,h,g,m,f,b,l,s,n,r,c,o,d,w,S,a,C=>g(s*l+C),C=>m(s*l+C)]}class tS extends li{constructor(e){super(),si(this,e,Qw,Jw,ri,{rotation:13,valueMin:0,valueMax:1,oninputstart:2,oninputmove:3,oninputend:4,elasticity:5,labelReset:6,rotationMin:14,rotationMax:15})}}function eS(t){let e,i,n,r,o;return{c(){e=ht("div"),i=ht("p"),n=$n(t[0]),r=$n(" × "),o=$n(t[1]),v(e,"class","PinturaImageInfo")},m(a,s){et(a,e,s),kt(e,i),kt(i,n),kt(i,r),kt(i,o)},p(a,[s]){1&s&&An(n,a[0]),2&s&&An(o,a[1])},i:ii,o:ii,d(a){a&&Q(e)}}}function iS(t,e,i){let{width:n}=e,{height:r}=e;return t.$$set=o=>{"width"in o&&i(0,n=o.width),"height"in o&&i(1,r=o.height)},[n,r]}class nS extends li{constructor(e){super(),si(this,e,iS,eS,ri,{width:0,height:1})}}function rS(t){let e,i;return e=new as({props:{class:"PinturaPresetListFilter",layout:"row",options:t[8],selectedIndex:t[7],onchange:t[10]}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};256&r&&(o.options=n[8]),128&r&&(o.selectedIndex=n[7]),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function oS(t){let e,i;return e=new qh({props:{icon:t[0],label:t[1],labelClass:t[2],hideLabel:t[3],options:t[9],selectedIndex:t[4],onchange:t[5],optionMapper:t[6],$$slots:{controls:[rS]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,[r]){const o={};1&r&&(o.icon=n[0]),2&r&&(o.label=n[1]),4&r&&(o.labelClass=n[2]),8&r&&(o.hideLabel=n[3]),512&r&&(o.options=n[9]),16&r&&(o.selectedIndex=n[4]),32&r&&(o.onchange=n[5]),64&r&&(o.optionMapper=n[6]),262528&r&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}const of='fill="none" stroke="currentColor"';function aS(t,e,i){let n,r,o,{icon:a}=e,{label:s}=e,{labelClass:l}=e,{hideLabel:c}=e,{options:d}=e,{selectedIndex:u}=e,{onchange:p}=e,{optionMapper:h}=e,{filter:g="landscape"}=e,{onfilterchange:m=$e}=e;const f=(w,S,C,R,M)=>`
    <rect ${of} x="${w}" y="${S}" width="${C}" height="${R}" rx="${M}"/>`,b=(w,S)=>`<path ${of} d="M${w} ${S} l2 2 l3 -4"/>`;return t.$$set=w=>{"icon"in w&&i(0,a=w.icon),"label"in w&&i(1,s=w.label),"labelClass"in w&&i(2,l=w.labelClass),"hideLabel"in w&&i(3,c=w.hideLabel),"options"in w&&i(12,d=w.options),"selectedIndex"in w&&i(4,u=w.selectedIndex),"onchange"in w&&i(5,p=w.onchange),"optionMapper"in w&&i(6,h=w.optionMapper),"filter"in w&&i(11,g=w.filter),"onfilterchange"in w&&i(13,m=w.onfilterchange)},t.$$.update=()=>{6144&t.$$.dirty&&i(9,n=((w,S)=>(w||[]).map(C=>Ve(C[0])?(C[1]=C[1].map(S),C):S(C)))(d,(w=>S=>{const[C,R,M={}]=S;return ui(C)&&(M.hidden=w==="landscape"?C<1:C>1),[C,R,M]})(g))),2048&t.$$.dirty&&i(7,r=g==="landscape"?0:1),128&t.$$.dirty&&i(8,o=[["landscape","Landscape",{hideLabel:!0,icon:f(2,6,19,12,2)+(r===0?b(9,12):"")}],["portrait","Portrait",{hideLabel:!0,icon:f(5,3,13,18,2)+(r===1?b(9,12):"")}]])},[a,s,l,c,u,p,h,r,o,n,w=>{i(11,g=w.value),m(w.value)},g,d,m]}class sS extends li{constructor(e){super(),si(this,e,aS,oS,ri,{icon:0,label:1,labelClass:2,hideLabel:3,options:12,selectedIndex:4,onchange:5,optionMapper:6,filter:11,onfilterchange:13})}}const af=t=>wo(t,e=>ai(e,6)),sf=t=>Do(t,e=>ai(e,6)),$s=(t,e,i=1e-4)=>Math.abs(t-e)<i;var lS=(t,e,i,n,r={})=>{const{aspectRatio:o}=r;t=sf(t),n=n.map(af);const a=xm(t,i0[i.target]),s=wo(a,b=>ai(b,6)),l=o?rs(r.minSize,o):r.minSize,c=o?Ur(r.maxSize,o):r.maxSize,d=xm(e,i.target);if($o(d,a)<1){e=Ci(t);const b=Math.min(l.width/t.width,l.height/t.height);Cr(e,b,a)}e=ym(Ci(e),l,c,a);let u=Ci(e);e=sf(e);const p=dy(n,1),h=Bo(t),g=Bo(e),m=h.findIndex(b=>xs(wo(b,w=>ai(w,6)),s)),f=b=>p.map(w=>wh(w,b)).filter(Boolean).pop();if(o){const b=g.map((w,S)=>{if(S===m)return;const C=ot(a.x-w.x,a.y-w.y);no(C),Tr(C,.5);const R=ot(a.x-C.x,a.y-C.y),M=Is(R,af(w)),D=f(M);if(!D)return;const T=h[S];return{intersection:D,cornerDist:$o(a,T),intersectionDist:$o(a,D)}}).filter(Boolean);if(b.length){const w=b.reduce((S,C)=>{const R=C.intersectionDist/C.cornerDist;return R<S?R:S},Number.MAX_SAFE_INTEGER);u=Ci(t),Cr(u,w,a)}}else{const b=i.target.length===1,w=!(n[0].y===n[1].y||n[0].x===n[1].x),S=h.map((C,R)=>{if(R===m)return;const M=g[R],D=!$s(M.x,s.x)&&!$s(M.y,s.y);if(!b&&!w&&D||b&&($s(M.x,s.x)||$s(M.y,s.y)))return;const T=Oe(b?C:a),F=Dn(Oe(T),M);no(F),Tr(F,.5),b?Fn(T,F):Dn(T,F);const W=Is(T,M);return f(W)||void 0}).filter(Boolean);if(S.length){const[C,R,M,D]=n0(i.target);let[T,F,W,B]=al(e);S.forEach(({x:y,y:V})=>{const tt=ai(y,6),k=ai(V,6);M&&!$s(k,s.y)&&(T=Math.max(T,V)),C&&!$s(tt,s.x)&&(F=Math.min(F,y)),D&&!$s(k,s.y)&&(W=Math.min(W,V)),R&&!$s(tt,s.x)&&(B=Math.max(B,y))}),u=db([T,F,W,B]),Cr(u,.9999,a)}}return ym(u,l,c,a),u};function cS(t){let e,i;return e=new ro({props:{items:t[11]}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};2048&r[0]&&(o.items=n[11]),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function dS(t){let e,i,n;return i=new K2({props:{$$slots:{default:[cS]},$$scope:{ctx:t}}}),{c(){e=ht("div"),Et(i.$$.fragment),v(e,"slot","header")},m(r,o){et(r,e,o),Rt(i,e,null),n=!0},p(r,o){const a={};2048&o[0]|4&o[7]&&(a.$$scope={dirty:o,ctx:r}),i.$set(a)},i(r){n||(P(i.$$.fragment,r),n=!0)},o(r){z(i.$$.fragment,r),n=!1},d(r){r&&Q(e),It(i)}}}function lf(t){let e,i;return e=new Ls({props:{onclick:t[88],label:t[4].cropLabelButtonRecenter,icon:t[4].cropIconButtonRecenter,class:"PinturaButtonCenter",disabled:!t[9],hideLabel:!0,style:`opacity: ${t[29]}; transform: translate3d(${t[30].x}px, ${t[30].y}px, 0)`}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};16&r[0]&&(o.label=n[4].cropLabelButtonRecenter),16&r[0]&&(o.icon=n[4].cropIconButtonRecenter),512&r[0]&&(o.disabled=!n[9]),1610612736&r[0]&&(o.style=`opacity: ${n[29]}; transform: translate3d(${n[30].x}px, ${n[30].y}px, 0)`),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function cf(t){let e,i;return e=new Yw({props:{rect:t[8],visible:t[12],style:t[1]}}),e.$on("resizestart",t[68]),e.$on("resizemove",t[69]),e.$on("resizeend",t[70]),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};256&r[0]&&(o.rect=n[8]),4096&r[0]&&(o.visible=n[12]),2&r[0]&&(o.style=n[1]),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function df(t){let e,i;return e=new nS({props:{width:Math.round(t[13].width),height:Math.round(t[13].height)}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};8192&r[0]&&(o.width=Math.round(n[13].width)),8192&r[0]&&(o.height=Math.round(n[13].height)),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function uS(t){let e,i,n,r,o,a,s,l,c=t[21]&&t[10]&&lf(t),d=t[21]&&cf(t),u=t[22]&&df(t);return{c(){e=ht("div"),i=ht("div"),c&&c.c(),n=me(),d&&d.c(),o=me(),u&&u.c(),v(i,"class","PinturaStage"),v(e,"slot","main")},m(p,h){et(p,e,h),kt(e,i),c&&c.m(i,null),kt(i,n),d&&d.m(i,null),t[162](i),kt(e,o),u&&u.m(e,null),a=!0,s||(l=[Xi(xr.call(null,i)),Pt(i,"measure",t[160]),Pt(i,"wheel",function(){Zi(t[2]&&t[87])&&(t[2]&&t[87]).apply(this,arguments)},{passive:!1}),Pt(i,"interactionstart",t[74]),Pt(i,"interactionupdate",t[75]),Pt(i,"interactionrelease",t[77]),Pt(i,"interactionend",t[76]),Xi(r=zs.call(null,i,{drag:!0,inertia:!0,pinch:t[2],shouldStartInteraction:pf,getEventPosition:t[163]})),Pt(i,"gesturedown",t[84]),Pt(i,"gestureupdate",t[85]),Pt(i,"gestureup",t[86]),Xi(qw.call(null,i))],s=!0)},p(p,h){(t=p)[21]&&t[10]?c?(c.p(t,h),2098176&h[0]&&P(c,1)):(c=lf(t),c.c(),P(c,1),c.m(i,n)):c&&(Pe(),z(c,1,1,()=>{c=null}),Re()),t[21]?d?(d.p(t,h),2097152&h[0]&&P(d,1)):(d=cf(t),d.c(),P(d,1),d.m(i,null)):d&&(Pe(),z(d,1,1,()=>{d=null}),Re()),r&&Zi(r.update)&&16777220&h[0]&&r.update.call(null,{drag:!0,inertia:!0,pinch:t[2],shouldStartInteraction:pf,getEventPosition:t[163]}),t[22]?u?(u.p(t,h),4194304&h[0]&&P(u,1)):(u=df(t),u.c(),P(u,1),u.m(e,null)):u&&(Pe(),z(u,1,1,()=>{u=null}),Re())},i(p){a||(P(c),P(d),P(u),a=!0)},o(p){z(c),z(d),z(u),a=!1},d(p){p&&Q(e),c&&c.d(),d&&d.d(),t[162](null),u&&u.d(),s=!1,Ui(l)}}}function uf(t){let e,i,n,r;const o=[{class:"PinturaControlList"},{tabs:t[7]},t[18]];let a={$$slots:{default:[pS,({tab:c})=>({218:c}),({tab:c})=>[0,0,0,0,0,0,0,c?2:0]]},$$scope:{ctx:t}};for(let c=0;c<o.length;c+=1)a=Tn(a,o[c]);e=new Fu({props:a}),e.$on("select",t[161]);const s=[{class:"PinturaControlPanels"},{panelClass:"PinturaControlPanel"},{panels:t[17]},t[18]];let l={$$slots:{default:[$S,({panel:c})=>({217:c}),({panel:c})=>[0,0,0,0,0,0,0,c?1:0]]},$$scope:{ctx:t}};for(let c=0;c<s.length;c+=1)l=Tn(l,s[c]);return n=new Du({props:l}),{c(){Et(e.$$.fragment),i=me(),Et(n.$$.fragment)},m(c,d){Rt(e,c,d),et(c,i,d),Rt(n,c,d),r=!0},p(c,d){const u=262272&d[0]?yr(o,[o[0],128&d[0]&&{tabs:c[7]},262144&d[0]&&Pr(c[18])]):{};6&d[7]&&(u.$$scope={dirty:d,ctx:c}),e.$set(u);const p=393216&d[0]?yr(s,[s[0],s[1],131072&d[0]&&{panels:c[17]},262144&d[0]&&Pr(c[18])]):{};511721496&d[0]|5&d[7]&&(p.$$scope={dirty:d,ctx:c}),n.$set(p)},i(c){r||(P(e.$$.fragment,c),P(n.$$.fragment,c),r=!0)},o(c){z(e.$$.fragment,c),z(n.$$.fragment,c),r=!1},d(c){It(e,c),c&&Q(i),It(n,c)}}}function pS(t){let e,i,n=t[218].label+"";return{c(){e=ht("span"),i=$n(n)},m(r,o){et(r,e,o),kt(e,i)},p(r,o){2&o[7]&&n!==(n=r[218].label+"")&&An(i,n)},d(r){r&&Q(e)}}}function hS(t){let e,i;return e=new e0({props:{elasticity:t[25]*t[44],base:xS,min:t[23],max:yS,valueMin:t[27][0],valueMax:t[27][1],value:t[28],labelReset:t[4].labelReset,valueLabel:Math.round(100*t[28])+"%",oninputstart:t[81],oninputmove:t[82],oninputend:t[83]}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};33554432&r[0]&&(o.elasticity=n[25]*n[44]),8388608&r[0]&&(o.min=n[23]),134217728&r[0]&&(o.valueMin=n[27][0]),134217728&r[0]&&(o.valueMax=n[27][1]),268435456&r[0]&&(o.value=n[28]),16&r[0]&&(o.labelReset=n[4].labelReset),268435456&r[0]&&(o.valueLabel=Math.round(100*n[28])+"%"),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function mS(t){let e,i;return e=new tS({props:{elasticity:t[25]*t[44],rotation:t[14],labelReset:t[4].labelReset,valueMin:t[26][0],valueMax:t[26][1],rotationMin:-t[3],rotationMax:t[3],oninputstart:t[71],oninputmove:t[72],oninputend:t[73]}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};33554432&r[0]&&(o.elasticity=n[25]*n[44]),16384&r[0]&&(o.rotation=n[14]),16&r[0]&&(o.labelReset=n[4].labelReset),67108864&r[0]&&(o.valueMin=n[26][0]),67108864&r[0]&&(o.valueMax=n[26][1]),8&r[0]&&(o.rotationMin=-n[3]),8&r[0]&&(o.rotationMax=n[3]),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function $S(t){let e,i,n,r;const o=[mS,hS],a=[];function s(l,c){return l[217]===l[93]+"-rotation"?0:l[217]===l[93]+"-zoom"?1:-1}return~(e=s(t))&&(i=a[e]=o[e](t)),{c(){i&&i.c(),n=Mn()},m(l,c){~e&&a[e].m(l,c),et(l,n,c),r=!0},p(l,c){let d=e;e=s(l),e===d?~e&&a[e].p(l,c):(i&&(Pe(),z(a[d],1,1,()=>{a[d]=null}),Re()),~e?(i=a[e],i?i.p(l,c):(i=a[e]=o[e](l),i.c()),P(i,1),i.m(n.parentNode,n)):i=null)},i(l){r||(P(i),r=!0)},o(l){z(i),r=!1},d(l){~e&&a[e].d(l),l&&Q(n)}}}function gS(t){let e,i,n=t[19]&&uf(t);return{c(){e=ht("div"),n&&n.c(),v(e,"slot","footer"),v(e,"style",t[16])},m(r,o){et(r,e,o),n&&n.m(e,null),i=!0},p(r,o){r[19]?n?(n.p(r,o),524288&o[0]&&P(n,1)):(n=uf(r),n.c(),P(n,1),n.m(e,null)):n&&(Pe(),z(n,1,1,()=>{n=null}),Re()),(!i||65536&o[0])&&v(e,"style",r[16])},i(r){i||(P(n),i=!0)},o(r){z(n),i=!1},d(r){r&&Q(e),n&&n.d()}}}function fS(t){let e,i,n;function r(a){t[164](a)}let o={hasHeader:t[20],$$slots:{footer:[gS],main:[uS],header:[dS]},$$scope:{ctx:t}};return t[15]!==void 0&&(o.root=t[15]),e=new dl({props:o}),Fi.push(()=>go(e,"root",r)),e.$on("measure",t[165]),{c(){Et(e.$$.fragment)},m(a,s){Rt(e,a,s),n=!0},p(a,s){const l={};1048576&s[0]&&(l.hasHeader=a[20]),2146402302&s[0]|4&s[7]&&(l.$$scope={dirty:s,ctx:a}),!i&&32768&s[0]&&(i=!0,l.root=a[15],So(()=>i=!1)),e.$set(l)},i(a){n||(P(e.$$.fragment,a),n=!0)},o(a){z(e.$$.fragment,a),n=!1},d(a){It(e,a)}}}const yS=1,xS=0,pf=(t,e)=>t.target===e;function bS(t,e,i){let n,r,o,a,s,l,c,d,u,p,h,g,m,f,b,w,S,C,R,M,D,T,F,W,B,y,V,tt,k,N,it,ut,st,mt,G,gt,vt,lt,St,J,q,Z,bt,nt,$t,Lt,ie,Vt,te,Yt,U,Tt,ct,Jt,de,ee,be,ve,_,Ce,pi,we,Bt,Ae,Ee,We,oi,xt,ge,Ue,ze,At,Ge=ii,Ke=()=>(Ge(),Ge=zr(gi,A=>i(12,k=A)),gi);t.$$.on_destroy.push(()=>Ge());let{isActive:gi}=e;Ke();let{stores:yi}=e,{cropImageSelectionCornerStyle:Li="circle"}=e,{cropWillRenderImageSelectionGuides:Si=(A,ae)=>{const Be=A=="rotate";return{rows:Be?5:3,cols:Be?5:3,opacity:.25*ae}}}=e,{cropAutoCenterImageSelectionTimeout:X}=e,{cropEnableZoomMatchImageAspectRatio:Zt=!0}=e,{cropEnableRotateMatchImageAspectRatio:H="never"}=e,{cropEnableRotationInput:qt=!0}=e,{cropEnableZoom:le=!0}=e,{cropEnableZoomInput:Ut=!0}=e,{cropEnableZoomAutoHide:fe=!0}=e,{cropEnableImageSelection:Xt=!0}=e,{cropEnableInfoIndicator:Le=!1}=e,{cropEnableZoomTowardsWheelPosition:Je=!0}=e,{cropEnableLimitWheelInputToCropSelection:_e=!0}=e,{cropEnableCenterImageSelection:dt=!0}=e,{cropEnableButtonRotateLeft:jt=!0}=e,{cropEnableButtonRotateRight:ne=!1}=e,{cropEnableButtonFlipHorizontal:Fe=!0}=e,{cropEnableButtonFlipVertical:Nt=!1}=e,{cropSelectPresetOptions:K}=e,{cropEnableSelectPreset:Qt=!0}=e,{cropEnableFilterMatchAspectRatio:Gt=!0}=e,{cropSelectPresetFilter:oe=!1}=e,{cropEnableButtonToggleCropLimit:He=!1}=e,{cropWillRenderTools:Ne=Ji}=e,{cropActiveTransformTool:Te="rotation"}=e,{cropMinimizeToolbar:Qe="auto"}=e,{cropInteractionFocus:De="image"}=e,{cropRotationRange:ce=Qo}=e,{cropMaskOpacity:Ye=.85}=e,{locale:Me={}}=e;const Ze=un("isAnimated");E(t,Ze,A=>i(139,N=A));const Ni=un("elasticityMultiplier");E(t,Ni,A=>i(25,oi=A));const ue=un("redrawTrigger");E(t,ue,A=>i(159,We=A));const Se=un("imageIsStatic");E(t,Se,A=>i(145,vt=A));const dn=un("imageStaticVisualCorners");E(t,dn,A=>i(181,ve=A));const bn=un("fixScrollDirection");E(t,bn,A=>i(175,U=A));let vn="idle";const Nn=he();E(t,Nn,A=>i(156,Bt=A));const Hn=()=>ee===void 0,dr=A=>1/A,oo=A=>{Gt&&oe!==A&&(i(95,oe=A),ee&&ee!==1&&Pn()&&wt(ur,ee=dr(ee),ee))},Pn=()=>{if(ee===1||!n)return!1;const A=dr(ee);return!!ks(Bt).find(([ae])=>ae===A)},br=(A,ae,Be)=>Ea(Be)?ae.width===Math.round(A.height)||ae.height===Math.round(A.width):ae.width===Math.round(A.width)||ae.height===Math.round(A.height),yn=()=>(Hn()||H==="always"&&Pn())&&((A,ae,Be)=>{const vi=is(ny(io(ae),Be),ti=>Math.abs(Math.round(ti))),Pi=Dl(vi),Vi=Ti(A);return xs(Pi,Vi)})(lt,ie,Vt)&&br(lt,ie,Vt),ao=A=>{if(H!=="never"&&yn()){wt(Wr,Vt+=A,Vt);const ae=Ea(Vt),Be=ae?ie.height:ie.width,vi=ae?ie.width:ie.height;wt(en,lt=In(0,0,Be,vi),lt),Hn()||wt(ur,ee=Jo(Be,vi),ee)}else wt(Wr,Vt+=A,Vt)},{history:Qi,env:Gr,isInteracting:wn,isInteractingFraction:Xn,isTransformingImage:ki,rootRect:_o,stageRect:Zr,utilRect:Vo,utilRectPadded:so,rootLineColor:fo,allowPan:Ln,allowZoom:Bn,allowPlayPause:tn,rangeInputElasticity:No,presentationScalar:Br,utilTools:mr,imagePreviewModifiers:Or,imageOutlineOpacity:da,imageFlipX:Co,imageFlipY:To,imageRotation:Wr,imageRotationRange:lo,imageOutputSize:vr,imageSelectionRect:Rr,imageSelectionRectSnapshot:co,imageSelectionRectIntent:Sn,imageSelectionRectPresentation:Di,imageCropRectIntent:Gi,imageCropRectOrigin:wr,imageCropRect:en,imageCropMinSize:Sr,imageCropMaxSize:uo,imageCropRange:Xr,imageCropAspectRatio:ur,imageCropLimitToImage:pr,imageSize:Wn,imageScalar:po,imageOverlayMarkup:Jn,stagePadded:Ho,stageRecenter:jn}=yi;let zn;E(t,Gr,A=>i(140,it=A)),E(t,wn,A=>i(144,gt=A)),E(t,ki,A=>i(173,$t=A)),E(t,_o,A=>i(24,Tt=A)),E(t,Zr,A=>i(151,nt=A)),E(t,so,A=>i(148,q=A)),E(t,Br,A=>i(147,J=A)),E(t,mr,A=>i(183,Ce=A)),E(t,Or,A=>i(172,mt=A)),E(t,Co,A=>i(158,Ee=A)),E(t,To,A=>i(157,Ae=A)),E(t,Wr,A=>i(14,Vt=A)),E(t,lo,A=>i(26,xt=A)),E(t,vr,A=>i(184,pi=A)),E(t,Rr,A=>i(150,bt=A)),E(t,co,A=>i(149,Z=A)),E(t,Sn,A=>i(182,_=A)),E(t,Di,A=>i(143,G=A)),E(t,Gi,A=>i(176,ct=A)),E(t,wr,A=>i(178,de=A)),E(t,en,A=>i(13,lt=A)),E(t,Sr,A=>i(154,Yt=A)),E(t,uo,A=>i(180,be=A)),E(t,Xr,A=>i(177,Jt=A)),E(t,ur,A=>i(179,ee=A)),E(t,pr,A=>i(153,te=A)),E(t,Wn,A=>i(152,ie=A)),E(t,po,A=>i(146,St=A)),E(t,Ho,A=>i(142,st=A));const ho=(A,ae)=>{const Be={target:A,translate:ae},vi=Nd(io(Yt),J),Pi=Nd(io(be),J);let Vi=nf(Z,Be,{...q,x:0,y:0},{aspectRatio:ee,minSize:vi,maxSize:Pi});if(Vi=((hi,Ri,Bi)=>{const[hn,Cn,gn,Oi]=al(hi),Ei={...hi};if(hn<Ri.y&&(hi.height=hi.height-(Ri.y-hn),hi.y=Ri.y),Cn>Ri.x+Ri.width&&(hi.width=Ri.x+Ri.width-hi.x),gn>Ri.y+Ri.height&&(hi.height=Ri.y+Ri.height-hi.y),Oi<Ri.x&&(hi.width=hi.width-(Ri.x-Oi),hi.x=Ri.x),Bi){const Ir=Math.min(1,Ei.width/hi.width,Ei.height/hi.height);return Ss(Ei,Ir)}return hi})(Vi,{...q,x:0,y:0},ee),!te)return{boundsLimited:Vi,boundsIntent:Vi};let ti=lS(Z,Vi,Be,ve,{aspectRatio:ee,minSize:vi,maxSize:Pi});return{boundsLimited:ti,boundsIntent:ti}},Yr=(A,ae)=>{const Be={target:A,translate:ae},vi=Nd(io(Yt),J),Pi=Nd(io(be),J),Vi=((ti,hi,Ri={})=>{const{target:Bi,translate:hn}=hi,{aspectRatio:Cn,minSize:gn}=Ri,Oi=Ac[i0[Bi]],Ei=Fn(Ci(ti),ot(Oi[0]*ti.width,Oi[1]*ti.height)),Ir=Ac[Bi],Uo=Fn(Ci(ti),ot(Ir[0]*ti.width,Ir[1]*ti.height)),[Oa,Ta,Wa,_a,Go,ss,ul]=n0(Bi);let Va=hn.x,Na=hn.y;Go?Na=0:ss&&(Va=0);let[Kr,Nr,Jr,Er]=al(ti);if(Oa?Er=Ei.x:Ta&&(Nr=Ei.x),_a?Kr=Ei.y:Wa&&(Jr=Ei.y),Oa?Nr=Uo.x+Va:Ta&&(Er=Uo.x+Va),_a?Jr=Uo.y+Na:Wa&&(Kr=Uo.y+Na),gn&&Go&&Jr-Kr<gn.height){const an=gn.height-(Jr-Kr);Kr-=.5*an,Jr+=.5*an}if(gn&&ss&&Nr-Er<gn.width){const an=gn.width-(Nr-Er);Er-=.5*an,Nr+=.5*an}if(Cn)if(ul){let an=Nr-Er,Zo=Jr-Kr;Go?(Zo=an/Cn,Kr=Ei.y-.5*Zo,Jr=Ei.y+.5*Zo):ss&&(an=Zo*Cn,Er=Ei.x-.5*an,Nr=Ei.x+.5*an)}else{const an=ot(Uo.x+Va-Ei.x,Uo.y+Na-Ei.y);Bi===aa?(an.x=Math.max(0,an.x),an.y=Math.min(0,an.y)):Bi===sa?(an.x=Math.max(0,an.x),an.y=Math.max(0,an.y)):Bi===la?(an.x=Math.min(0,an.x),an.y=Math.max(0,an.y)):Bi===oa&&(an.x=Math.min(0,an.x),an.y=Math.min(0,an.y));const Zo=vs(an),Ha=ot(Cn,1),Hr=Tr(no(Ha),Zo);Bi===aa?(Nr=Ei.x+Hr.x,Kr=Ei.y-Hr.y):Bi===sa?(Nr=Ei.x+Hr.x,Jr=Ei.y+Hr.y):Bi===la?(Er=Ei.x-Hr.x,Jr=Ei.y+Hr.y):Bi===oa&&(Er=Ei.x-Hr.x,Kr=Ei.y-Hr.y)}return In(Er,Kr,Nr-Er,Jr-Kr)})(Z,Be,{aspectRatio:ee,minSize:vi});return{boundsLimited:nf(Z,Be,{...q,x:0,y:0},{aspectRatio:ee,minSize:vi,maxSize:Pi}),boundsIntent:Vi}};let Rn,hr;const O=({translation:A,scalar:ae})=>{vt&&(ae=1,A=El(Oe(A)));const Be=Math.min(bt.width/lt.width,bt.height/lt.height),vi=Tr(Oe(A),1/Be);let Pi;if(hr){const Vi=Dn(Oe(hr),A);hr=A,Pi=ta(Ci(lt),Vi)}else Pi=ta(Ci(Rn),El(Oe(vi))),ae!==void 0&&Cr(Pi,1/ae);wt(Gi,ct=Pi,ct),wt(en,lt=Pi,lt)},re=Ai([Xr,en],([A,ae],Be)=>{if(!ae)return;const[vi,Pi]=A,Vi=rr(ae);Be([ol(Do(rs(vi,Vi),ai)),ol(Do(Ur(Pi,Vi),ai))])});E(t,re,A=>i(174,Lt=A));const xi=Ai([Wn,pr,Sr,uo,Xr,Wr],([A,ae,Be,vi,Pi,Vi],ti)=>{if(!A)return;const hi=Pi[0],Ri=Pi[1];let Bi,hn;ae?(Bi=((Cn,gn,Oi)=>Ea(Oi)?1-1/Math.min(Cn.height/gn.width,Cn.width/gn.height):1-1/Math.min(Cn.width/gn.width,Cn.height/gn.height))(A,Ri,Vi),hn=Math.min(hi.width/Be.width,hi.height/Be.height)):(Bi=-1,hn=1),ti([Bi,hn].map(Cn=>ai(Cn)))});E(t,xi,A=>i(27,ge=A));const qe=Ai([Wn,en,Xr,Wr],([A,ae,Be,vi],Pi)=>{if(!A||!ae)return Pi(0);let Vi;const ti=Be[0],hi=Be[1],Ri=ae.width,Bi=ae.height,hn=rr(ae),Cn=Ea(vi)?Vn(A.height,A.width):A,gn=Ur(Cn,hn);if(Ri<=gn.width||Bi<=gn.height){const Oi=gn.width-ti.width,Ei=gn.height-ti.height;Vi=Oi===0||Ei===0?1:1-Math.min((Ri-ti.width)/Oi,(Bi-ti.height)/Ei)}else{const Oi=hi.width-gn.width,Ei=hi.height-gn.height,Ir=Ur({width:Oi,height:Ei},hn);Vi=-Math.min((Ri-gn.width)/Ir.width,(Bi-gn.height)/Ir.height)}Pi(Vi)});E(t,qe,A=>i(28,Ue=A));const Mt=A=>{const ae=rr(Rn);let Be,vi,Pi;const Vi=Ea(Vt)?Vn(ie.height,ie.width):ie,ti=Ur(Vi,ae);if(A>=0){const Bi=ti.width-Jt[0].width,hn=ti.height-Jt[0].height;Be=ti.width-Bi*A,vi=ti.height-hn*A,Pi=rs({width:Be,height:vi},ae)}else{const Bi=Jt[1].width-ti.width,hn=Jt[1].height-ti.height;Be=ti.width+Bi*-A,vi=ti.height+hn*-A,Pi=Ur({width:Be,height:vi},ae)}Be=Pi.width,vi=Pi.height;const hi=Rn.x+.5*Rn.width-.5*Be,Ri=Rn.y+.5*Rn.height-.5*vi;wt(en,lt={x:hi,y:Ri,width:Be,height:vi},lt)};let ye;const Mi=A=>{const ae=Cr(Ci(ye),1/A);wt(Gi,ct=ae,ct),wt(en,lt=ae,lt)};let _i;const pn=()=>{jn.set({})};let bi;const Hi=di(0,{precision:1e-4});E(t,Hi,A=>i(29,ze=A));const _r=di();E(t,_r,A=>i(30,At=A));const ua=Ai([ur,vr,Nn],([A,ae,Be],vi)=>{if(!n)return;const Pi=ks(Be),Vi=[...Pi].map(ti=>ti[0]).sort((ti,hi)=>En(ti[0])&&!En(hi[0])?1:-1).find(ti=>{if(En(ti)&&ae){const[hi,Ri]=ti,Bi=ae.width===hi&&ae.height===Ri,hn=A===Jo(hi,Ri);return Bi&&hn}return ti===A});if(!Vi)return vi(void 0);vi(Pi.map(ti=>ti[0]).findIndex(ti=>En(ti)?os(ti,Vi):ti===Vi))});E(t,ua,A=>i(155,we=A));const Ba=(A,ae)=>{if(!n||A===-1||A===void 0)return;const Be=ks(ae)[A][0];return Be?En(Be)?Jo(Be[0],Be[1]):Be:void 0},pa=Ai([fo,Di,Xn],([A,ae,Be],vi)=>{const{rows:Pi,cols:Vi,opacity:ti}=Si(vn,Be);if(!ae||ti<=0)return vi([]);const{x:hi,y:Ri,width:Bi,height:hn}=ae,Cn=Bi/Vi,gn=hn/Pi,Oi=[];for(let Ei=1;Ei<=Pi-1;Ei++){const Ir=Ri+gn*Ei;Oi.push({id:"image-selection-guide-row-"+Ei,points:[ot(hi,Ir),ot(hi+Bi,Ir)],opacity:ti,strokeWidth:1,strokeColor:A})}for(let Ei=1;Ei<=Vi-1;Ei++){const Ir=hi+Cn*Ei;Oi.push({id:"image-selection-guide-col-"+Ei,points:[ot(Ir,Ri),ot(Ir,Ri+hn)],opacity:ti,strokeWidth:1,strokeColor:A})}vi(Oi)});E(t,pa,A=>i(141,ut=A));const Mo="crop-"+na();let qr,jo=Mo+"-"+(qt?Te:"zoom"),yo=jo,Ca;const Vr=di(N?20:0);return E(t,Vr,A=>i(138,tt=A)),t.$$set=A=>{"isActive"in A&&Ke(i(0,gi=A.isActive)),"stores"in A&&i(97,yi=A.stores),"cropImageSelectionCornerStyle"in A&&i(1,Li=A.cropImageSelectionCornerStyle),"cropWillRenderImageSelectionGuides"in A&&i(98,Si=A.cropWillRenderImageSelectionGuides),"cropAutoCenterImageSelectionTimeout"in A&&i(99,X=A.cropAutoCenterImageSelectionTimeout),"cropEnableZoomMatchImageAspectRatio"in A&&i(100,Zt=A.cropEnableZoomMatchImageAspectRatio),"cropEnableRotateMatchImageAspectRatio"in A&&i(101,H=A.cropEnableRotateMatchImageAspectRatio),"cropEnableRotationInput"in A&&i(102,qt=A.cropEnableRotationInput),"cropEnableZoom"in A&&i(2,le=A.cropEnableZoom),"cropEnableZoomInput"in A&&i(103,Ut=A.cropEnableZoomInput),"cropEnableZoomAutoHide"in A&&i(104,fe=A.cropEnableZoomAutoHide),"cropEnableImageSelection"in A&&i(105,Xt=A.cropEnableImageSelection),"cropEnableInfoIndicator"in A&&i(106,Le=A.cropEnableInfoIndicator),"cropEnableZoomTowardsWheelPosition"in A&&i(107,Je=A.cropEnableZoomTowardsWheelPosition),"cropEnableLimitWheelInputToCropSelection"in A&&i(108,_e=A.cropEnableLimitWheelInputToCropSelection),"cropEnableCenterImageSelection"in A&&i(109,dt=A.cropEnableCenterImageSelection),"cropEnableButtonRotateLeft"in A&&i(110,jt=A.cropEnableButtonRotateLeft),"cropEnableButtonRotateRight"in A&&i(111,ne=A.cropEnableButtonRotateRight),"cropEnableButtonFlipHorizontal"in A&&i(112,Fe=A.cropEnableButtonFlipHorizontal),"cropEnableButtonFlipVertical"in A&&i(113,Nt=A.cropEnableButtonFlipVertical),"cropSelectPresetOptions"in A&&i(114,K=A.cropSelectPresetOptions),"cropEnableSelectPreset"in A&&i(115,Qt=A.cropEnableSelectPreset),"cropEnableFilterMatchAspectRatio"in A&&i(116,Gt=A.cropEnableFilterMatchAspectRatio),"cropSelectPresetFilter"in A&&i(95,oe=A.cropSelectPresetFilter),"cropEnableButtonToggleCropLimit"in A&&i(117,He=A.cropEnableButtonToggleCropLimit),"cropWillRenderTools"in A&&i(118,Ne=A.cropWillRenderTools),"cropActiveTransformTool"in A&&i(119,Te=A.cropActiveTransformTool),"cropMinimizeToolbar"in A&&i(120,Qe=A.cropMinimizeToolbar),"cropInteractionFocus"in A&&i(121,De=A.cropInteractionFocus),"cropRotationRange"in A&&i(3,ce=A.cropRotationRange),"cropMaskOpacity"in A&&i(122,Ye=A.cropMaskOpacity),"locale"in A&&i(4,Me=A.locale)},t.$$.update=()=>{4096&t.$$.dirty[0]|268435456&t.$$.dirty[3]&&Se.set(De==="selection"&&k),2097152&t.$$.dirty[3]&&i(129,n=K&&Array.isArray(K)&&K.length),2097152&t.$$.dirty[3]|32&t.$$.dirty[4]&&Nn.set(n?K:[]),4096&t.$$.dirty[0]|32768&t.$$.dirty[4]&&k&&da.set(1,{hard:!N}),4096&t.$$.dirty[0]&&Ln.set(!k),4096&t.$$.dirty[0]&&Bn.set(!k),4096&t.$$.dirty[0]&&k&&tn.set(!0),65536&t.$$.dirty[4]&&i(124,h=it.layoutMode==="overlay"),4194304&t.$$.dirty[3]|1&t.$$.dirty[4]&&i(128,R=Qt&&!h),83886080&t.$$.dirty[4]&&i(137,l=q&&bt&&au(q,bt)),67117056&t.$$.dirty[4]&&i(135,c=!(!bt||!l)),67119104&t.$$.dirty[4]&&i(133,d=c&&ea(bt,l,A=>ai(A,5))),16400&t.$$.dirty[0]|52297732&t.$$.dirty[3]|1879114288&t.$$.dirty[4]|31&t.$$.dirty[5]&&i(11,r=We&&Ne([jt&&["Button","rotate-left",{label:Me.cropLabelButtonRotateLeft,labelClass:"PinturaToolbarContentWide",icon:Me.cropIconButtonRotateLeft,onclick:()=>{ao(-Math.PI/2),Qi.write()}}],ne&&["Button","rotate-right",{label:Me.cropLabelButtonRotateRight,labelClass:"PinturaToolbarContentWide",icon:Me.cropIconButtonRotateRight,onclick:()=>{ao(Math.PI/2),Qi.write()}}],Fe&&["Button","flip-horizontal",{label:Me.cropLabelButtonFlipHorizontal,labelClass:"PinturaToolbarContentWide",icon:Me.cropIconButtonFlipHorizontal,onclick:()=>{Ea(Vt)?wt(To,Ae=!Ae,Ae):wt(Co,Ee=!Ee,Ee),Qi.write()}}],Nt&&["Button","flip-vertical",{label:Me.cropLabelButtonFlipVertical,labelClass:"PinturaToolbarContentWide",icon:Me.cropIconButtonFlipVertical,onclick:()=>{Ea(Vt)?wt(Co,Ee=!Ee,Ee):wt(To,Ae=!Ae,Ae),Qi.write()}}],R&&n&&[oe===!1?"Dropdown":sS,"select-preset",{icon:or(Me.cropIconSelectPreset,Me,Ba(we,Bt)),label:or(Me.cropLabelSelectPreset,Me,Ba(we,Bt)),labelClass:"PinturaToolbarContentWide",options:Bt,filter:oe,onfilterchange:oo,selectedIndex:we,onchange:({value:A})=>{En(A)?(wt(ur,ee=Jo(A[0],A[1]),ee),wt(vr,pi=iy(A),pi)):wt(ur,ee=A,ee),d&&pn(),Qi.write()},optionMapper:A=>{let ae=!1;const Be=En(A.value)?A.value[0]/A.value[1]:A.value;if(Be){const vi=Il(ie,Vt,Be);ae=vi.width<Yt.width||vi.height<Yt.height}return A.icon=((vi,Pi={})=>{const{width:Vi=24,height:ti=24,bounds:hi=16,radius:Ri=3}=Pi;let Bi,hn,Cn,gn,Oi=En(vi)?Jo(vi[0],vi[1]):vi,Ei=!!Oi;return Oi=Ei?Oi:1,Cn=Oi>1?hi:Oi*hi,gn=Cn/Oi,Bi=Math.round(.5*(Vi-Cn)),hn=Math.round(.5*(ti-gn)),`<rect fill="${Ei?"currentColor":"none"}" stroke="${Ei?"none":"currentColor"}" stroke-width="${Vi/16}" stroke-dasharray="${[Vi/12,Vi/6].join(" ")}" x="${Bi}" y="${hn}" width="${Cn}" height="${gn}" rx="${Ri}"/>`})(A.value,{bounds:14}),{...A,disabled:ae}}}],He&&["Dropdown","select-crop-limit",{icon:or(Me.cropIconCropBoundary,Me,te),label:Me.cropLabelCropBoundary,labelClass:"PinturaToolbarContentWide",onchange:({value:A})=>{wt(pr,te=A,te),Qi.write()},options:[[!0,Me.cropLabelCropBoundaryEdge,{icon:or(Me.cropIconCropBoundary,Me,!0)}],[!1,Me.cropLabelCropBoundaryNone,{icon:or(Me.cropIconCropBoundary,Me,!1)}]]}]].filter(Boolean),it,()=>ue.set({})).filter(Boolean)),6144&t.$$.dirty[0]|134217728&t.$$.dirty[3]|65537&t.$$.dirty[4]&&wt(mr,Ce=k&&Qe!=="never"&&(Qe==="always"||it.verticalSpace==="short"||h)?r.map(([A,ae,Be])=>Array.isArray(Be)?[A,ae,Be]:[A,ae,{...Be,hideLabel:!0}]):[],Ce),536870912&t.$$.dirty[4]&&i(23,o=te?0:-1),150994944&t.$$.dirty[4]&&i(130,a=q&&ot(-(nt.x-q.x),-(nt.y-q.y))),524352&t.$$.dirty[4]&&i(131,s=G&&a&&ot(Bc(G.x+.5*G.width+a.x),Bc(G.y+.5*G.height+a.y))),33554432&t.$$.dirty[4]&&i(134,u=Z!=null),16785408&t.$$.dirty[4]&&i(136,p=q&&l&&(l.height===q.height||l.width===q.width)),12587008&t.$$.dirty[4]&&i(132,g=!p&&J<1&&St<1),3840&t.$$.dirty[4]&&i(9,m=c&&!u&&(!d||g)),8192&t.$$.dirty[0]|8192&t.$$.dirty[3]|1&t.$$.dirty[4]&&i(22,f=Le&&!!lt&&!h),524352&t.$$.dirty[4]&&i(8,S=G&&a&&{x:G.x+a.x,y:G.y+a.y,width:G.width,height:G.height}),256&t.$$.dirty[0]|4096&t.$$.dirty[3]|1&t.$$.dirty[4]&&i(21,b=Xt&&!!S&&!h),65600&t.$$.dirty[3]|2097280&t.$$.dirty[4]&&i(10,w=dt&&!!s&&!X&&!vt),512&t.$$.dirty[0]|1073741888&t.$$.dirty[3]|1048576&t.$$.dirty[4]&&m&&X&&!gt&&(clearTimeout(bi),i(123,bi=setTimeout(pn,X))),1073741824&t.$$.dirty[3]|1048576&t.$$.dirty[4]&&gt&&clearTimeout(bi),1536&t.$$.dirty[0]|32768&t.$$.dirty[4]&&Hi.set(w&&m?1:0,{hard:N===!1}),32896&t.$$.dirty[4]&&_r.set(s,{hard:N===!1}),4096&t.$$.dirty[0]|262144&t.$$.dirty[4]&&(k&&!st?(wt(Or,mt.crop={maskOpacity:Ye,maskMarkupOpacity:Ye},mt),Or.set(mt)):(delete mt.crop,Or.set(mt))),131072&t.$$.dirty[4]&&ut&&Jn.update(A=>{const ae=A.filter(Be=>!/^image\-selection\-guide/.test(Be.id));return k?[...ae,...ut]:ae}),65536&t.$$.dirty[4]&&i(127,C=it.verticalSpace!=="short"),134217728&t.$$.dirty[3]|9&t.$$.dirty[4]&&i(20,M=Qe==="never"&&!h||C&&Qe!=="always"),4&t.$$.dirty[0]|1024&t.$$.dirty[3]&&i(126,D=le&&Ut),2048&t.$$.dirty[3]|12&t.$$.dirty[4]&&i(125,T=fe?C&&D:D),512&t.$$.dirty[3]|2&t.$$.dirty[4]&&i(19,F=qt||T),2&t.$$.dirty[4]&&(T||i(5,yo=jo)),32&t.$$.dirty[0]&&i(18,W={name:Mo,selected:yo}),16&t.$$.dirty[0]|512&t.$$.dirty[3]|2&t.$$.dirty[4]&&i(7,B=[qt&&{id:Mo+"-rotation",label:Me.cropLabelTabRotation},T&&{id:Mo+"-zoom",label:Me.cropLabelTabZoom}].filter(Boolean)),128&t.$$.dirty[0]&&i(17,y=B.map(A=>A.id)),64&t.$$.dirty[0]|1&t.$$.dirty[4]&&qr&&!qr.children.length&&h&&qr.dispatchEvent(new CustomEvent("measure",{detail:qr.rect})),4096&t.$$.dirty[0]|32768&t.$$.dirty[4]&&N&&Vr.set(k?0:20),16384&t.$$.dirty[4]&&i(16,V=tt?`transform: translateY(${tt}px)`:void 0)},[gi,Li,le,ce,Me,yo,qr,B,S,m,w,r,k,lt,Vt,Ca,V,y,W,F,M,b,f,o,Tt,oi,xt,ge,Ue,ze,At,Ze,Ni,ue,Se,dn,bn,Nn,Gr,wn,ki,_o,Zr,so,No,Br,mr,Or,Co,To,Wr,lo,vr,Rr,co,Sn,Di,Gi,wr,en,Sr,uo,Xr,ur,pr,Wn,po,Ho,()=>{vn="select",wt(wn,gt=!0,gt),wt(co,Z=Ci(bt),Z),zn=vt?ho:Yr},({detail:A})=>{const{boundsLimited:ae,boundsIntent:Be}=zn(A.direction,A.translation);wt(ki,$t=!0,$t),wt(Sn,_=Be,_),wt(Rr,bt=ae,bt)},({detail:A})=>{const{boundsLimited:ae}=zn(A.direction,A.translation);wt(ki,$t=!1,$t),wt(wn,gt=!1,gt),wt(Sn,_=void 0,_),vs(A.translation)&&(wt(Rr,bt=ae,bt),Qi.write()),wt(co,Z=void 0,Z),vn=void 0},()=>{vn="rotate",wt(wn,gt=!0,gt),wt(wr,de=Ci(lt),de)},A=>{wt(ki,$t=!0,$t),wt(Wr,Vt=A,Vt)},A=>{wt(ki,$t=!1,$t),wt(wn,gt=!1,gt),wt(Wr,Vt=A,Vt),Qi.write(),wt(wr,de=void 0,de)},()=>{vn="pan",hr=void 0,wt(wn,gt=!0,gt),Rn=Ci(lt)},({detail:A})=>{wt(ki,$t=!0,$t),O(A)},({detail:A})=>{wt(ki,$t=!1,$t),wt(wn,gt=!1,gt),(vs(A.translation)>0||A.scalar!==0)&&(O(A),Qi.write()),wt(Gi,ct=void 0,ct),Rn=void 0},({detail:{translation:A}})=>{vt&&(A=El(Oe(A))),hr=A,wt(wn,gt=!1,gt)},re,xi,qe,()=>{vn="zoom",wt(wn,gt=!0,gt),Rn=Ci(lt)},A=>{wt(ki,$t=!1,$t),Mt(A)},A=>{Mt(A),Qi.write(),wt(ki,$t=!1,$t),wt(wn,gt=!1,gt),Rn=void 0},()=>{vn="zoom",Rn||(ye=Ci(lt),wt(wn,gt=!0,gt))},({detail:A})=>{ye&&(wt(ki,$t=!0,$t),Mi(A))},({detail:A})=>{ye&&(wt(ki,$t=!1,$t),wt(wn,gt=!1,gt),Mi(A),wt(Gi,ct=void 0,ct),ye=void 0,Qi.write())},A=>{const ae=sh(A,Tt,nt);if(_e&&!$u(bt,ae))return;vn="zoom",wt(wn,gt=!0,gt),wt(ki,$t=!0,$t),A.preventDefault(),A.stopPropagation();const Be=Bu(A,{fixScrollDirection:U}),vi=1+Be/100,Pi=Ci(lt),Vi=Math.min(lt.width/Yt.width,lt.height/Yt.height)===1;if(Zt&&te){const Ri=br(lt,ie,Vt);if(Hn()&&Ri&&Be>0&&d){wt(wn,gt=!1,gt),wt(ki,$t=!1,$t);const Bi=Ea(Vt)?Fr({height:ie.width,width:ie.height}):Fr(ie);return ea(Pi,Bi)||(clearTimeout(_i),ea(Qi.state.crop,Bi))?void 0:(wt(en,lt=Bi,lt),void Qi.write())}}let ti=Ti(lt);if(Je&&De!=="selection"&&Be<0&&!Vi){const Ri=Dn(Oe(ae),bt),Bi=Math.min(bt.width/lt.width,bt.height/lt.height),hn=Cr(Ci(bt),1.1);ti=$u(hn,ae)?Fn(Ci(lt),Tr(Ri,1/Bi)):ti}let hi=Cr(Ci(lt),vi,ti);if(mu(Lt[1],hi)||(hi=fm(Ti(hi),Lt[1])),mu(hi,Lt[0])||(hi=fm(Ti(hi),Lt[0])),ea(Pi,hi,ai))return wt(wn,gt=!1,gt),void wt(ki,$t=!1,$t);wt(en,lt=Do(hi,Ri=>ai(Ri,5)),lt),wt(wn,gt=!1,gt),wt(ki,$t=!1,$t),clearTimeout(_i),_i=setTimeout(()=>{Qi.write()},500)},pn,Hi,_r,ua,pa,Mo,Vr,oe,"crop",yi,Si,X,Zt,H,qt,Ut,fe,Xt,Le,Je,_e,dt,jt,ne,Fe,Nt,K,Qt,Gt,He,Ne,Te,Qe,De,Ye,bi,h,T,D,C,R,n,a,s,g,d,u,c,p,l,tt,N,it,ut,st,G,gt,vt,St,J,q,Z,bt,nt,ie,te,Yt,we,Bt,Ae,Ee,We,function(A){Dr.call(this,t,A)},({detail:A})=>i(5,yo=A),function(A){Fi[A?"unshift":"push"](()=>{qr=A,i(6,qr)})},A=>Qh(A),function(A){Ca=A,i(15,Ca)},function(A){Dr.call(this,t,A)}]}var vS={util:["crop",class extends li{constructor(t){super(),si(this,t,bS,fS,ri,{name:96,isActive:0,stores:97,cropImageSelectionCornerStyle:1,cropWillRenderImageSelectionGuides:98,cropAutoCenterImageSelectionTimeout:99,cropEnableZoomMatchImageAspectRatio:100,cropEnableRotateMatchImageAspectRatio:101,cropEnableRotationInput:102,cropEnableZoom:2,cropEnableZoomInput:103,cropEnableZoomAutoHide:104,cropEnableImageSelection:105,cropEnableInfoIndicator:106,cropEnableZoomTowardsWheelPosition:107,cropEnableLimitWheelInputToCropSelection:108,cropEnableCenterImageSelection:109,cropEnableButtonRotateLeft:110,cropEnableButtonRotateRight:111,cropEnableButtonFlipHorizontal:112,cropEnableButtonFlipVertical:113,cropSelectPresetOptions:114,cropEnableSelectPreset:115,cropEnableFilterMatchAspectRatio:116,cropSelectPresetFilter:95,cropEnableButtonToggleCropLimit:117,cropWillRenderTools:118,cropActiveTransformTool:119,cropMinimizeToolbar:120,cropInteractionFocus:121,cropRotationRange:3,cropMaskOpacity:122,locale:4},null,[-1,-1,-1,-1,-1,-1,-1,-1])}get name(){return this.$$.ctx[96]}get isActive(){return this.$$.ctx[0]}set isActive(t){this.$$set({isActive:t}),I()}get stores(){return this.$$.ctx[97]}set stores(t){this.$$set({stores:t}),I()}get cropImageSelectionCornerStyle(){return this.$$.ctx[1]}set cropImageSelectionCornerStyle(t){this.$$set({cropImageSelectionCornerStyle:t}),I()}get cropWillRenderImageSelectionGuides(){return this.$$.ctx[98]}set cropWillRenderImageSelectionGuides(t){this.$$set({cropWillRenderImageSelectionGuides:t}),I()}get cropAutoCenterImageSelectionTimeout(){return this.$$.ctx[99]}set cropAutoCenterImageSelectionTimeout(t){this.$$set({cropAutoCenterImageSelectionTimeout:t}),I()}get cropEnableZoomMatchImageAspectRatio(){return this.$$.ctx[100]}set cropEnableZoomMatchImageAspectRatio(t){this.$$set({cropEnableZoomMatchImageAspectRatio:t}),I()}get cropEnableRotateMatchImageAspectRatio(){return this.$$.ctx[101]}set cropEnableRotateMatchImageAspectRatio(t){this.$$set({cropEnableRotateMatchImageAspectRatio:t}),I()}get cropEnableRotationInput(){return this.$$.ctx[102]}set cropEnableRotationInput(t){this.$$set({cropEnableRotationInput:t}),I()}get cropEnableZoom(){return this.$$.ctx[2]}set cropEnableZoom(t){this.$$set({cropEnableZoom:t}),I()}get cropEnableZoomInput(){return this.$$.ctx[103]}set cropEnableZoomInput(t){this.$$set({cropEnableZoomInput:t}),I()}get cropEnableZoomAutoHide(){return this.$$.ctx[104]}set cropEnableZoomAutoHide(t){this.$$set({cropEnableZoomAutoHide:t}),I()}get cropEnableImageSelection(){return this.$$.ctx[105]}set cropEnableImageSelection(t){this.$$set({cropEnableImageSelection:t}),I()}get cropEnableInfoIndicator(){return this.$$.ctx[106]}set cropEnableInfoIndicator(t){this.$$set({cropEnableInfoIndicator:t}),I()}get cropEnableZoomTowardsWheelPosition(){return this.$$.ctx[107]}set cropEnableZoomTowardsWheelPosition(t){this.$$set({cropEnableZoomTowardsWheelPosition:t}),I()}get cropEnableLimitWheelInputToCropSelection(){return this.$$.ctx[108]}set cropEnableLimitWheelInputToCropSelection(t){this.$$set({cropEnableLimitWheelInputToCropSelection:t}),I()}get cropEnableCenterImageSelection(){return this.$$.ctx[109]}set cropEnableCenterImageSelection(t){this.$$set({cropEnableCenterImageSelection:t}),I()}get cropEnableButtonRotateLeft(){return this.$$.ctx[110]}set cropEnableButtonRotateLeft(t){this.$$set({cropEnableButtonRotateLeft:t}),I()}get cropEnableButtonRotateRight(){return this.$$.ctx[111]}set cropEnableButtonRotateRight(t){this.$$set({cropEnableButtonRotateRight:t}),I()}get cropEnableButtonFlipHorizontal(){return this.$$.ctx[112]}set cropEnableButtonFlipHorizontal(t){this.$$set({cropEnableButtonFlipHorizontal:t}),I()}get cropEnableButtonFlipVertical(){return this.$$.ctx[113]}set cropEnableButtonFlipVertical(t){this.$$set({cropEnableButtonFlipVertical:t}),I()}get cropSelectPresetOptions(){return this.$$.ctx[114]}set cropSelectPresetOptions(t){this.$$set({cropSelectPresetOptions:t}),I()}get cropEnableSelectPreset(){return this.$$.ctx[115]}set cropEnableSelectPreset(t){this.$$set({cropEnableSelectPreset:t}),I()}get cropEnableFilterMatchAspectRatio(){return this.$$.ctx[116]}set cropEnableFilterMatchAspectRatio(t){this.$$set({cropEnableFilterMatchAspectRatio:t}),I()}get cropSelectPresetFilter(){return this.$$.ctx[95]}set cropSelectPresetFilter(t){this.$$set({cropSelectPresetFilter:t}),I()}get cropEnableButtonToggleCropLimit(){return this.$$.ctx[117]}set cropEnableButtonToggleCropLimit(t){this.$$set({cropEnableButtonToggleCropLimit:t}),I()}get cropWillRenderTools(){return this.$$.ctx[118]}set cropWillRenderTools(t){this.$$set({cropWillRenderTools:t}),I()}get cropActiveTransformTool(){return this.$$.ctx[119]}set cropActiveTransformTool(t){this.$$set({cropActiveTransformTool:t}),I()}get cropMinimizeToolbar(){return this.$$.ctx[120]}set cropMinimizeToolbar(t){this.$$set({cropMinimizeToolbar:t}),I()}get cropInteractionFocus(){return this.$$.ctx[121]}set cropInteractionFocus(t){this.$$set({cropInteractionFocus:t}),I()}get cropRotationRange(){return this.$$.ctx[3]}set cropRotationRange(t){this.$$set({cropRotationRange:t}),I()}get cropMaskOpacity(){return this.$$.ctx[122]}set cropMaskOpacity(t){this.$$set({cropMaskOpacity:t}),I()}get locale(){return this.$$.ctx[4]}set locale(t){this.$$set({locale:t}),I()}}]};function wS(t){let e,i,n,r,o,a,s,l=t[77],c=(cn(t[77].label)?t[77].label(t[2]):t[77].label)+"";function d(...h){return t[51](t[77],...h)}const u=()=>t[52](i,l),p=()=>t[52](null,l);return{c(){e=ht("div"),i=ht("div"),n=me(),r=ht("span"),o=$n(c),v(i,"class",J2),v(e,"slot","option"),v(e,"class","PinturaFilterOption")},m(h,g){et(h,e,g),kt(e,i),u(),kt(e,n),kt(e,r),kt(r,o),a||(s=[Pt(i,"measure",d),Xi(xr.call(null,i))],a=!0)},p(h,g){l!==(t=h)[77]&&(p(),l=t[77],u()),4&g[0]|32768&g[2]&&c!==(c=(cn(t[77].label)?t[77].label(t[2]):t[77].label)+"")&&An(o,c)},d(h){h&&Q(e),p(),a=!1,Ui(s)}}}function SS(t){let e,i;return e=new as({props:{locale:t[2],layout:"row",options:t[3],selectedIndex:t[12],onchange:t[32],$$slots:{option:[wS,({option:n})=>({77:n}),({option:n})=>[0,0,n?32768:0]]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};4&r[0]&&(o.locale=n[2]),8&r[0]&&(o.options=n[3]),4096&r[0]&&(o.selectedIndex=n[12]),1028&r[0]|98304&r[2]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function kS(t){let e,i,n,r,o,a,s,l;function c(h){t[54](h)}function d(h){t[55](h)}function u(h){t[56](h)}let p={elasticity:t[13]*t[19],onscroll:t[53],$$slots:{default:[SS]},$$scope:{ctx:t}};return t[4]!==void 0&&(p.maskFeatherStartOpacity=t[4]),t[5]!==void 0&&(p.maskFeatherEndOpacity=t[5]),t[6]!==void 0&&(p.maskFeatherSize=t[6]),i=new ka({props:p}),Fi.push(()=>go(i,"maskFeatherStartOpacity",c)),Fi.push(()=>go(i,"maskFeatherEndOpacity",d)),Fi.push(()=>go(i,"maskFeatherSize",u)),i.$on("measure",t[57]),{c(){e=ht("div"),Et(i.$$.fragment),v(e,"slot","footer"),v(e,"style",t[11])},m(h,g){et(h,e,g),Rt(i,e,null),a=!0,s||(l=[Pt(e,"transitionend",t[30]),Pt(e,"measure",t[58]),Xi(xr.call(null,e,{observePosition:!0}))],s=!0)},p(h,g){const m={};8192&g[0]&&(m.elasticity=h[13]*h[19]),128&g[0]&&(m.onscroll=h[53]),5132&g[0]|65536&g[2]&&(m.$$scope={dirty:g,ctx:h}),!n&&16&g[0]&&(n=!0,m.maskFeatherStartOpacity=h[4],So(()=>n=!1)),!r&&32&g[0]&&(r=!0,m.maskFeatherEndOpacity=h[5],So(()=>r=!1)),!o&&64&g[0]&&(o=!0,m.maskFeatherSize=h[6],So(()=>o=!1)),i.$set(m),(!a||2048&g[0])&&v(e,"style",h[11])},i(h){a||(P(i.$$.fragment,h),a=!0)},o(h){z(i.$$.fragment,h),a=!1},d(h){h&&Q(e),It(i),s=!1,Ui(l)}}}function CS(t){let e,i;return e=new dl({props:{$$slots:{footer:[kS]},$$scope:{ctx:t}}}),e.$on("measure",t[59]),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};16380&r[0]|65536&r[2]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}let J2="PinturaFilterPreview";function TS(t,e,i){let n,r,o,a,s,l,c,d,u,p,h,g,m,f,b,w,S,C,R,M,D=ii,T=()=>(D(),D=zr(y,xt=>i(43,d=xt)),y),F=ii,W=()=>(F(),F=zr(B,xt=>i(49,S=xt)),B);t.$$.on_destroy.push(()=>D()),t.$$.on_destroy.push(()=>F());let{isActive:B}=e;W();let{isActiveFraction:y}=e;T();let{stores:V}=e,{locale:tt}=e,{filterFunctions:k}=e,{filterOptions:N}=e;const it=un("elasticityMultiplier");E(t,it,xt=>i(13,M=xt));const{history:ut,interfaceImages:st,stageRectBase:mt,utilRect:G,animation:gt,scrollElasticity:vt,imageSize:lt,imagePreview:St,imageCropRect:J,imageRotation:q,imageFlipX:Z,imageFlipY:bt,imageBackgroundColor:nt,imageGamma:$t,imageColorMatrix:Lt,allowPan:ie,allowZoom:Vt,allowZoomControls:te,allowPlayPause:Yt}=V;E(t,st,xt=>i(60,u=xt)),E(t,mt,xt=>i(48,w=xt)),E(t,G,xt=>i(47,b=xt)),E(t,gt,xt=>i(50,C=xt)),E(t,lt,xt=>i(62,h=xt)),E(t,St,xt=>i(42,c=xt)),E(t,nt,xt=>i(61,p=xt)),E(t,$t,xt=>i(44,g=xt)),E(t,Lt,xt=>i(40,s=xt));const U=he({});E(t,U,xt=>i(46,f=xt));const Tt=(xt,ge)=>wt(U,f[xt.value]=ge,f),ct=Ai(U,xt=>{if(!xt[void 0])return;const ge=xt[void 0];return R&&Lc(R,ge)?R:io(ge)});E(t,ct,xt=>i(63,R=xt));const Jt=Ai([B,ct,J,lt,q,Z,bt],([xt,ge,Ue,ze,At,Ge,Ke],gi)=>{if(!xt||!ge||!ze)return m;const yi=Fr(ze),Li=Ti(yi),Si=Wh(ze,Ue,At),X=Ti(Si),Zt=Dn(Oe(Li),X),H=El(Oe(Zt)),qt=Math.max(ge.width/Ue.width,ge.height/Ue.height);gi({origin:H,translation:Zt,rotation:{x:Ke?Math.PI:0,y:Ge?Math.PI:0,z:At},scale:qt})});E(t,Jt,xt=>i(45,m=xt));const de=di(C?20:0);let ee;E(t,de,xt=>i(39,a=xt));const be={};let ve,_,Ce,pi,we,Bt,Ae={x:0,y:0};const Ee=he([]);E(t,Ee,xt=>i(41,l=xt));const We=xt=>{const ge={...xt,data:c,size:h,offset:{...xt.offset},mask:{...xt.mask},backgroundColor:p};return ge.opacity=d,ge.offset.y+=a,ge.mask.y+=a,ge.id="filter",ge},oi=()=>u.filter(xt=>xt.id!=="filter");return Wo(()=>{st.set([])}),t.$$set=xt=>{"isActive"in xt&&W(i(0,B=xt.isActive)),"isActiveFraction"in xt&&T(i(1,y=xt.isActiveFraction)),"stores"in xt&&i(34,V=xt.stores),"locale"in xt&&i(2,tt=xt.locale),"filterFunctions"in xt&&i(35,k=xt.filterFunctions),"filterOptions"in xt&&i(3,N=xt.filterOptions)},t.$$.update=()=>{if(262144&t.$$.dirty[1]&&ie.set(S),262144&t.$$.dirty[1]&&Vt.set(S),262144&t.$$.dirty[1]&&te.set(S),262144&t.$$.dirty[1]&&S&&Yt.set(!1),8&t.$$.dirty[0]&&i(38,n=ks(N)),640&t.$$.dirty[1]&&i(12,r=((xt,ge)=>{if(!xt||!xt.filter||!ge)return 0;const Ue=xt.filter;return ge.findIndex(([ze])=>{if(!k[ze])return!1;const At=k[ze]();return os(At,Ue)})})(s,n)),786432&t.$$.dirty[1]&&C&&de.set(S?0:20),512&t.$$.dirty[0]|458752&t.$$.dirty[1]&&S&&b&&w&&Bt&&i(37,we={x:w.x-b.x,y:w.y-b.y+Bt.y}),496&t.$$.dirty[0]|58096&t.$$.dirty[1]&&m&&we&&Ae&&pi&&ee){const xt=we.x+pi.x+Ae.x,ge=we.y,Ue=pi.x+we.x,ze=Ue+pi.width;Ee.set(n.map(([At],Ge)=>{const Ke=f[At],gi=Ae.x+Ke.x,yi=gi+Ke.width;if(yi<0||gi>pi.width)return!1;const Li=xt+Ke.x,Si=ge+Ke.y,X=(H=>({origin:Oe(H.origin),translation:Oe(H.translation),rotation:{...H.rotation},scale:H.scale}))(m);X.offset=ot(.5*Ke.width+Li,.5*Ke.height+Si),X.maskOpacity=1,X.mask=In(Li+0,Si,Ke.width+0,Ke.height),X.maskFeather=[1,0,1,0,1,ze,1,ze],gi<Ce&&ve<1&&(X.maskFeather[0]=ve,X.maskFeather[1]=Ue,X.maskFeather[2]=1,X.maskFeather[3]=Ue+Ce),yi>pi.width-Ce&&_<1&&(X.maskFeather[4]=_,X.maskFeather[5]=ze-Ce,X.maskFeather[6]=1,X.maskFeather[7]=ze),X.maskCornerRadius=ee[At];let Zt=s&&Object.keys(s).filter(H=>H!="filter").map(H=>s[H])||[];return cn(k[At])&&Zt.push(k[At]()),X.colorMatrix=Zt.length?Dh(Zt):void 0,X.gamma=g,X}).filter(Boolean))}if(7424&t.$$.dirty[1])if(d>0&&l){const xt=[...oi(),...l.map(We)];st.set(xt)}else st.set(oi());256&t.$$.dirty[1]&&i(11,o=a?`transform: translateY(${a}px)`:void 0)},[B,y,tt,N,ve,_,Ce,Ae,pi,Bt,be,o,r,M,it,st,mt,G,gt,vt,lt,St,nt,$t,Lt,U,Tt,ct,Jt,de,xt=>{xt.target.className===J2&&i(36,ee=Object.keys(be).reduce((ge,Ue)=>{const ze=be[Ue],At=getComputedStyle(ze),Ge=["top-left","top-right","bottom-left","bottom-right"].map(Ke=>At.getPropertyValue(`border-${Ke}-radius`)).map(S2).map(Ke=>1.25*Ke);return ge[Ue]=Ge,ge},{}))},Ee,({value:xt})=>{wt(Lt,s={...s,filter:cn(k[xt])?k[xt]():void 0},s),ut.write()},"filter",V,k,ee,we,n,a,s,l,c,d,g,m,f,b,w,S,C,(xt,ge)=>Tt(xt,ge.detail),function(xt,ge){Fi[xt?"unshift":"push"](()=>{be[ge.value]=xt,i(10,be)})},xt=>i(7,Ae=xt),function(xt){ve=xt,i(4,ve)},function(xt){_=xt,i(5,_)},function(xt){Ce=xt,i(6,Ce)},xt=>i(8,pi=xt.detail),xt=>i(9,Bt=xt.detail),function(xt){Dr.call(this,t,xt)}]}var MS={util:["filter",class extends li{constructor(t){super(),si(this,t,TS,CS,ri,{name:33,isActive:0,isActiveFraction:1,stores:34,locale:2,filterFunctions:35,filterOptions:3},null,[-1,-1,-1])}get name(){return this.$$.ctx[33]}get isActive(){return this.$$.ctx[0]}set isActive(t){this.$$set({isActive:t}),I()}get isActiveFraction(){return this.$$.ctx[1]}set isActiveFraction(t){this.$$set({isActiveFraction:t}),I()}get stores(){return this.$$.ctx[34]}set stores(t){this.$$set({stores:t}),I()}get locale(){return this.$$.ctx[2]}set locale(t){this.$$set({locale:t}),I()}get filterFunctions(){return this.$$.ctx[35]}set filterFunctions(t){this.$$set({filterFunctions:t}),I()}get filterOptions(){return this.$$.ctx[3]}set filterOptions(t){this.$$set({filterOptions:t}),I()}}]};function hf(t){let e,i,n,r;e=new ka({props:{elasticity:t[6]*t[9],class:"PinturaControlListScroller",$$slots:{default:[RS]},$$scope:{ctx:t}}});const o=[{class:"PinturaControlPanels"},{panelClass:"PinturaControlPanel"},{panels:t[4]},t[5]];let a={$$slots:{default:[IS,({panel:s})=>({42:s}),({panel:s})=>[0,s?2048:0]]},$$scope:{ctx:t}};for(let s=0;s<o.length;s+=1)a=Tn(a,o[s]);return n=new Du({props:a}),{c(){Et(e.$$.fragment),i=me(),Et(n.$$.fragment)},m(s,l){Rt(e,s,l),et(s,i,l),Rt(n,s,l),r=!0},p(s,l){const c={};64&l[0]&&(c.elasticity=s[6]*s[9]),38&l[0]|8192&l[1]&&(c.$$scope={dirty:l,ctx:s}),e.$set(c);const d=48&l[0]?yr(o,[o[0],o[1],16&l[0]&&{panels:s[4]},32&l[0]&&Pr(s[5])]):{};128&l[0]|10240&l[1]&&(d.$$scope={dirty:l,ctx:s}),n.$set(d)},i(s){r||(P(e.$$.fragment,s),P(n.$$.fragment,s),r=!0)},o(s){z(e.$$.fragment,s),z(n.$$.fragment,s),r=!1},d(s){It(e,s),s&&Q(i),It(n,s)}}}function PS(t){let e,i,n=t[43].label+"";return{c(){e=ht("span"),i=$n(n)},m(r,o){et(r,e,o),kt(e,i)},p(r,o){4096&o[1]&&n!==(n=r[43].label+"")&&An(i,n)},d(r){r&&Q(e)}}}function RS(t){let e,i;const n=[{class:"PinturaControlList"},{tabs:t[1]},t[5]];let r={$$slots:{default:[PS,({tab:o})=>({43:o}),({tab:o})=>[0,o?4096:0]]},$$scope:{ctx:t}};for(let o=0;o<n.length;o+=1)r=Tn(r,n[o]);return e=new Fu({props:r}),e.$on("select",t[24]),{c(){Et(e.$$.fragment)},m(o,a){Rt(e,o,a),i=!0},p(o,a){const s=34&a[0]?yr(n,[n[0],2&a[0]&&{tabs:o[1]},32&a[0]&&Pr(o[5])]):{};12288&a[1]&&(s.$$scope={dirty:a,ctx:o}),e.$set(s)},i(o){i||(P(e.$$.fragment,o),i=!0)},o(o){z(e.$$.fragment,o),i=!1},d(o){It(e,o)}}}function IS(t){let e,i;const n=[t[7][t[42]]];let r={};for(let o=0;o<n.length;o+=1)r=Tn(r,n[o]);return e=new e0({props:r}),{c(){Et(e.$$.fragment)},m(o,a){Rt(e,o,a),i=!0},p(o,a){const s=128&a[0]|2048&a[1]?yr(n,[Pr(o[7][o[42]])]):{};e.$set(s)},i(o){i||(P(e.$$.fragment,o),i=!0)},o(o){z(e.$$.fragment,o),i=!1},d(o){It(e,o)}}}function ES(t){let e,i,n=t[5]&&hf(t);return{c(){e=ht("div"),n&&n.c(),v(e,"slot","footer"),v(e,"style",t[3])},m(r,o){et(r,e,o),n&&n.m(e,null),i=!0},p(r,o){r[5]?n?(n.p(r,o),32&o[0]&&P(n,1)):(n=hf(r),n.c(),P(n,1),n.m(e,null)):n&&(Pe(),z(n,1,1,()=>{n=null}),Re()),(!i||8&o[0])&&v(e,"style",r[3])},i(r){i||(P(n),i=!0)},o(r){z(n),i=!1},d(r){r&&Q(e),n&&n.d()}}}function AS(t){let e,i;return e=new dl({props:{$$slots:{footer:[ES]},$$scope:{ctx:t}}}),e.$on("measure",t[25]),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};254&r[0]|8192&r[1]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function LS(t,e,i){let n,r,o,a,s,l,c,d,u,p,h,g=ii,m=()=>(g(),g=zr(b,J=>i(21,c=J)),b);t.$$.on_destroy.push(()=>g());let{stores:f}=e,{isActive:b}=e;m();let{locale:w={}}=e,{finetuneControlConfiguration:S}=e,{finetuneOptions:C}=e,{finetuneNudgePrecision:R}=e;const{history:M,animation:D,scrollElasticity:T,rangeInputElasticity:F,imageColorMatrix:W,imageConvolutionMatrix:B,imageGamma:y,imageVignette:V,imageNoise:tt,allowPan:k,allowZoom:N,allowZoomControls:it,allowPlayPause:ut}=f;E(t,D,J=>i(22,d=J));const st={imageColorMatrix:W,imageConvolutionMatrix:B,imageGamma:y,imageVignette:V,imageNoise:tt},mt=un("elasticityMultiplier");E(t,mt,J=>i(6,p=J));const G="finetune-"+na(),gt=he({});E(t,gt,J=>i(23,u=J));const vt=he({});E(t,vt,J=>i(7,h=J));let lt=[];const St=di(d?20:0);return E(t,St,J=>i(20,l=J)),t.$$set=J=>{"stores"in J&&i(15,f=J.stores),"isActive"in J&&m(i(0,b=J.isActive)),"locale"in J&&i(16,w=J.locale),"finetuneControlConfiguration"in J&&i(17,S=J.finetuneControlConfiguration),"finetuneOptions"in J&&i(18,C=J.finetuneOptions),"finetuneNudgePrecision"in J&&i(19,R=J.finetuneNudgePrecision)},t.$$.update=()=>{var J;2097152&t.$$.dirty[0]&&k.set(c),2097152&t.$$.dirty[0]&&N.set(c),2097152&t.$$.dirty[0]&&it.set(c),2097152&t.$$.dirty[0]&&c&&ut.set(!0),327680&t.$$.dirty[0]&&i(1,n=C?C.map(([q,Z])=>({id:q,label:cn(Z)?Z(w):Z})):[]),2&t.$$.dirty[0]&&i(2,r=n.length?n[0].id:void 0),4&t.$$.dirty[0]&&i(5,o=r&&{name:G,selected:r}),2&t.$$.dirty[0]&&i(4,a=n.map(q=>q.id)),131072&t.$$.dirty[0]&&S&&(J=S,lt&&lt.forEach(q=>q()),lt=a.map(q=>{const{getStore:Z,getValue:bt=Ji}=J[q];return Z(st).subscribe(nt=>{const $t=nt!=null?bt(nt):nt;wt(gt,u={...u,[q]:$t},u)})})),8519680&t.$$.dirty[0]&&S&&u&&wt(vt,h=Object.keys(u).reduce((q,Z)=>{const{base:bt,min:nt,max:$t,getLabel:Lt,getStore:ie,setValue:Vt=(U,Tt)=>U.set(Tt)}=S[Z],te=ie(st),Yt=u[Z]!=null?u[Z]:bt;return q[Z]={base:bt,min:nt,max:$t,value:Yt,valueLabel:Lt?Lt(Yt,nt,$t,$t-nt):Math.round(100*Yt),oninputmove:U=>{Vt(te,U)},oninputend:U=>{Vt(te,U),M.write()},elasticity:p*F,labelReset:w.labelReset,nudgeMultiplier:R},q},{}),h),6291456&t.$$.dirty[0]&&d&&St.set(c?0:20),1048576&t.$$.dirty[0]&&i(3,s=l?`transform: translateY(${l}px)`:void 0)},[b,n,r,s,a,o,p,h,D,T,mt,gt,vt,St,"finetune",f,w,S,C,R,l,c,d,u,({detail:J})=>i(2,r=J),function(J){Dr.call(this,t,J)}]}var zS={util:["finetune",class extends li{constructor(t){super(),si(this,t,LS,AS,ri,{name:14,stores:15,isActive:0,locale:16,finetuneControlConfiguration:17,finetuneOptions:18,finetuneNudgePrecision:19},null,[-1,-1])}get name(){return this.$$.ctx[14]}get stores(){return this.$$.ctx[15]}set stores(t){this.$$set({stores:t}),I()}get isActive(){return this.$$.ctx[0]}set isActive(t){this.$$set({isActive:t}),I()}get locale(){return this.$$.ctx[16]}set locale(t){this.$$set({locale:t}),I()}get finetuneControlConfiguration(){return this.$$.ctx[17]}set finetuneControlConfiguration(t){this.$$set({finetuneControlConfiguration:t}),I()}get finetuneOptions(){return this.$$.ctx[18]}set finetuneOptions(t){this.$$set({finetuneOptions:t}),I()}get finetuneNudgePrecision(){return this.$$.ctx[19]}set finetuneNudgePrecision(t){this.$$set({finetuneNudgePrecision:t}),I()}}]},Tu=(t,e)=>{const i=e.length;return t<0?t%i+i:t>=i?t%i:t};function mf(t,e,i){const n=t.slice();return n[46]=e[i].key,n[47]=e[i].index,n[48]=e[i].translate,n[49]=e[i].scale,n[50]=e[i].selected,n[12]=e[i].rotate,n[51]=e[i].dir,n[52]=e[i].center,n[53]=e[i].type,n[2]=e[i].visible,n}function $f(t){let e,i;return{c(){e=ht("div"),v(e,"class","PinturaShapeManipulator"),v(e,"data-control","point"),v(e,"style",i=`pointer-events:none;transform: translate3d(${t[52].x}px, ${t[52].y}px, 0) scale(${t[5]}, ${t[5]}); opacity: ${t[4]}`)},m(n,r){et(n,e,r)},p(n,r){56&r[0]&&i!==(i=`pointer-events:none;transform: translate3d(${n[52].x}px, ${n[52].y}px, 0) scale(${n[5]}, ${n[5]}); opacity: ${n[4]}`)&&v(e,"style",i)},d(n){n&&Q(e)}}}function gf(t,e){let i,n,r,o,a,s,l,c,d,u;function p(...g){return e[18](e[47],...g)}let h=e[53]==="edge"&&e[2]&&$f(e);return{key:t,first:null,c(){i=ht("div"),l=me(),h&&h.c(),c=Mn(),v(i,"role","button"),v(i,"aria-label",n=`Drag ${e[53]} ${e[46]}`),v(i,"tabindex",r=e[53]==="edge"?-1:0),v(i,"class","PinturaShapeManipulator"),v(i,"data-control",o=e[53]),v(i,"data-selected",a=e[50]),v(i,"style",s=`cursor:${e[51]?e[51]+"-resize":"move"};opacity:${e[4]};--tx:${e[48].x};--ty:${e[48].y};--r:${e[53]==="edge"?e[12]:0}rad;--sx:${e[53]==="point"?e[5]:e[49].x};--sy:${e[53]==="point"?e[5]:e[49].y};`),this.first=i},m(g,m){et(g,i,m),et(g,l,m),h&&h.m(g,m),et(g,c,m),d||(u=[Pt(i,"nudge",p),Xi(Fs.call(null,i,{preventDefault:!0})),Pt(i,"interactionstart",function(){Zi(e[9]("start",e[47]))&&e[9]("start",e[47]).apply(this,arguments)}),Pt(i,"interactionupdate",function(){Zi(e[9]("move",e[47]))&&e[9]("move",e[47]).apply(this,arguments)}),Pt(i,"interactionend",function(){Zi(e[9]("end",e[47]))&&e[9]("end",e[47]).apply(this,arguments)}),Xi(zs.call(null,i,{observeKeys:!0}))],d=!0)},p(g,m){e=g,8&m[0]&&n!==(n=`Drag ${e[53]} ${e[46]}`)&&v(i,"aria-label",n),8&m[0]&&r!==(r=e[53]==="edge"?-1:0)&&v(i,"tabindex",r),8&m[0]&&o!==(o=e[53])&&v(i,"data-control",o),8&m[0]&&a!==(a=e[50])&&v(i,"data-selected",a),56&m[0]&&s!==(s=`cursor:${e[51]?e[51]+"-resize":"move"};opacity:${e[4]};--tx:${e[48].x};--ty:${e[48].y};--r:${e[53]==="edge"?e[12]:0}rad;--sx:${e[53]==="point"?e[5]:e[49].x};--sy:${e[53]==="point"?e[5]:e[49].y};`)&&v(i,"style",s),e[53]==="edge"&&e[2]?h?h.p(e,m):(h=$f(e),h.c(),h.m(c.parentNode,c)):h&&(h.d(1),h=null)},d(g){g&&Q(i),g&&Q(l),h&&h.d(g),g&&Q(c),d=!1,Ui(u)}}}function ff(t){let e,i,n,r;return{c(){e=ht("div"),v(e,"role","button"),v(e,"aria-label","Drag rotator"),v(e,"tabindex","0"),v(e,"class","PinturaShapeManipulator"),v(e,"data-control","rotate"),v(e,"style",i=`transform: translate3d(${t[0].x}px, ${t[0].y}px, 0) scale(${t[5]}, ${t[5]}); opacity: ${t[4]}`)},m(o,a){et(o,e,a),n||(r=[Pt(e,"nudge",t[11]),Xi(Fs.call(null,e,{preventDefault:!0})),Pt(e,"interactionstart",t[12]("start")),Pt(e,"interactionupdate",t[12]("move")),Pt(e,"interactionend",t[12]("end")),Xi(zs.call(null,e,{observeKeys:!0}))],n=!0)},p(o,a){49&a[0]&&i!==(i=`transform: translate3d(${o[0].x}px, ${o[0].y}px, 0) scale(${o[5]}, ${o[5]}); opacity: ${o[4]}`)&&v(e,"style",i)},d(o){o&&Q(e),n=!1,Ui(r)}}}function FS(t){let e,i,n=[],r=new Map,o=t[3];const a=l=>l[46];for(let l=0;l<o.length;l+=1){let c=mf(t,o,l),d=a(c);r.set(d,n[l]=gf(d,c))}let s=t[1]&&ff(t);return{c(){for(let l=0;l<n.length;l+=1)n[l].c();e=me(),s&&s.c(),i=Mn()},m(l,c){for(let d=0;d<n.length;d+=1)n[d].m(l,c);et(l,e,c),s&&s.m(l,c),et(l,i,c)},p(l,c){1592&c[0]&&(o=l[3],n=Da(n,c,a,1,l,o,r,e.parentNode,Ky,gf,e,mf)),l[1]?s?s.p(l,c):(s=ff(l),s.c(),s.m(i.parentNode,i)):s&&(s.d(1),s=null)},i:ii,o:ii,d(l){for(let c=0;c<n.length;c+=1)n[c].d(l);l&&Q(e),s&&s.d(l),l&&Q(i)}}}function DS(t,e,i){let n,r,o,a;const s=Sa(),l=.5*Qo,c=Oo-l,d=Oo+l,u=-Oo,p=u-l,h=u+l,g=lp-l,m=-lp+l,f=l,b=-l,w=Oo-Qo,S=w-l,C=w+l,R=lp-Qo,M=R-l,D=R+l,T=u-Qo,F=T+l,W=T-l,B=u+Qo,y=B+l,V=B-l;let{visible:tt=!1}=e,{points:k=[]}=e,{rotatorPoint:N}=e,{selectedPoint:it}=e,{enableDragEdges:ut=!0}=e,{enableDragPoints:st=!0}=e,{enableRotatePoints:mt=!0}=e;const G=un("isAnimated");E(t,G,J=>i(17,r=J));const gt=di(.5,{precision:1e-4,stiffness:.3,damping:.7});E(t,gt,J=>i(5,a=J));const vt=di(0,{precision:.001,stiffness:.3,damping:.7});E(t,vt,J=>i(4,o=J));const lt=J=>{let q="";return(J<=d&&J>=c||J>=p&&J<=h)&&(q="ns"),(J<=m||J>=g||J>=b&&J<=f)&&(q="ew"),(J>=M&&J<=D||J<=y&&J>=V)&&(q="nesw"),(J>=S&&J<=C||J<=F&&J>=W)&&(q="nwse"),q},St=(J,q)=>{s("resizestart",{indexes:J,translation:ln(),isNudge:!0}),s("resizemove",{indexes:J,translation:q,isNudge:!0}),s("resizeend",{indexes:J,translation:ln(),isNudge:!0})};return t.$$set=J=>{"visible"in J&&i(2,tt=J.visible),"points"in J&&i(13,k=J.points),"rotatorPoint"in J&&i(0,N=J.rotatorPoint),"selectedPoint"in J&&i(14,it=J.selectedPoint),"enableDragEdges"in J&&i(15,ut=J.enableDragEdges),"enableDragPoints"in J&&i(16,st=J.enableDragPoints),"enableRotatePoints"in J&&i(1,mt=J.enableRotatePoints)},t.$$.update=()=>{131076&t.$$.dirty[0]&&gt.set(tt?1:.5,{hard:r===!1}),131076&t.$$.dirty[0]&&vt.set(tt?1:0,{hard:r===!1}),8192&t.$$.dirty[0]&&i(3,n=((J,q)=>{let Z=0;const bt=Fo(J),nt=[],$t=J.length;for(;Z<$t;Z++){const Lt=Tu(Z-1,J),ie=Tu(Z+1,J),Vt=J[Lt],te=J[Z],Yt=J[ie],U=Math.atan2(Yt.y-te.y,Yt.x-te.x);if(st){const ct=no(ot(Vt.x-te.x,Vt.y-te.y)),Jt=no(ot(Yt.x-te.x,Yt.y-te.y)),de=ot(ct.x+Jt.x,ct.y+Jt.y),ee=ut?st&&lt(Math.atan2(de.y,de.x)):void 0;nt.push({index:[Z],key:"point-"+Z,type:"point",selected:it===Z,scale:{x:1,y:1},translate:{x:te.x,y:te.y},angle:void 0,rotate:mt,center:te,dir:ee})}if(!ut||Array.isArray(ut)&&!ut.some(([ct,Jt])=>Z===ct&&ie===Jt))continue;const Tt=ot(te.x+.5*(Yt.x-te.x),te.y+.5*(Yt.y-te.y));nt.push({index:[Z,ie],key:"edge-"+Z,type:"edge",scale:{x:$o(te,Yt),y:1},translate:{x:te.x,y:te.y},angle:U,rotate:U,center:Tt,visible:Array.isArray(ut),dir:lt(Math.atan2(bt.y-Tt.y,bt.x-Tt.x))})}return nt})(k))},[N,mt,tt,n,o,a,G,gt,vt,(J,q)=>({detail:Z})=>{const bt=Z&&Z.translation?Z.translation:ot(0,0);s("resize"+J,{...Z,indexes:q,translation:bt})},St,({detail:J})=>{s("rotatestart",{translation:ln(),isNudge:!0}),s("rotatemove",{translation:J,isNudge:!0}),s("rotateend",{translation:ln(),isNudge:!0})},J=>({detail:q})=>{const Z=q&&q.translation?q.translation:ot(0,0);s("rotate"+J,{...q,translation:Z})},k,it,ut,st,r,(J,{detail:q})=>St(J,q)]}class BS extends li{constructor(e){super(),si(this,e,DS,FS,ri,{visible:2,points:13,rotatorPoint:0,selectedPoint:14,enableDragEdges:15,enableDragPoints:16,enableRotatePoints:1},null,[-1,-1])}}var hh=(t,e)=>{const i=Qh(t);return Dn(i,e)},iu=t=>document.createTextNode(t),Q2=t=>(La()&&t.endsWith("<div><br></div>")?t.replace(/<div><br><\/div>$/,"<br><br>"):t).replace(/<div><br><\/div>/g,"<br>").replace(/<\/div>/g,"").replace(/<div>/g,"<br>");function yf(t){let e,i;return{c(){e=ht("pre"),v(e,"class","PinturaContentEditable"),v(e,"style",i=t[7]+";position:absolute;z-index:-1;pointer-events:none;")},m(n,r){et(n,e,r),e.innerHTML=t[0]},p(n,r){1&r[0]&&(e.innerHTML=n[0]),128&r[0]&&i!==(i=n[7]+";position:absolute;z-index:-1;pointer-events:none;")&&v(e,"style",i)},d(n){n&&Q(e)}}}function OS(t){let e,i,n,r,o,a,s=t[8]&&yf(t);return{c(){s&&s.c(),e=me(),i=ht("pre"),v(i,"class","PinturaContentEditable"),v(i,"data-wrap-content",n=t[4]||t[5]?"wrap":"nowrap"),v(i,"contenteditable",""),v(i,"spellcheck",t[1]),v(i,"autocorrect",t[2]),v(i,"autocapitalize",t[3]),v(i,"style",r=t[8]?t[15](t[7]):t[7])},m(l,c){s&&s.m(l,c),et(l,e,c),et(l,i,c),t[26](i),o||(a=[Pt(i,"input",t[13]),Pt(i,"compositionend",t[12]),Pt(i,"paste",t[14]),Pt(i,"keydown",t[10]),Pt(i,"keyup",t[11]),Pt(i,"blur",t[9])],o=!0)},p(l,c){l[8]?s?s.p(l,c):(s=yf(l),s.c(),s.m(e.parentNode,e)):s&&(s.d(1),s=null),48&c[0]&&n!==(n=l[4]||l[5]?"wrap":"nowrap")&&v(i,"data-wrap-content",n),2&c[0]&&v(i,"spellcheck",l[1]),4&c[0]&&v(i,"autocorrect",l[2]),8&c[0]&&v(i,"autocapitalize",l[3]),384&c[0]&&r!==(r=l[8]?l[15](l[7]):l[7])&&v(i,"style",r)},i:ii,o:ii,d(l){s&&s.d(l),l&&Q(e),l&&Q(i),t[26](null),o=!1,Ui(a)}}}function WS(t,e,i){let n,r,{spellcheck:o="false"}=e,{autocorrect:a="off"}=e,{autocapitalize:s="off"}=e,{wrapLines:l=!0}=e,{allowNewline:c=!0}=e,{textFormat:d="text"}=e,{formatInput:u=Ji}=e,{formatPaste:p=Ji}=e,{style:h}=e,{innerHTML:g}=e,{oninput:m=$e}=e,{enableTextStyleShortcuts:f=!1}=e;const b=()=>{if(!S)return;const k=document.createRange();k.selectNodeContents(S);const N=W();N.removeAllRanges(),N.addRange(k)},w=Sa();let S;document.execCommand("defaultParagraphSeparator",!1,"br");const C=k=>k.replace(/<\/?(?:i|b|em|u|s|strike|strong|font)>/,"").replace(/style=".*?"/g,"").replace(/\n/gim,"<br>"),R=()=>{i(0,g=S.innerHTML);const k=Q2(g);w("input",k),m(k),requestAnimationFrame(()=>S&&S.scrollTo(0,0))},M=()=>{B(S);const k=d==="html"?S.innerHTML:C(S.innerHTML);i(6,S.innerHTML=u(k),S),y(S),R()},D={b:"bold",i:"italic",u:"underline",s:"strikethrough"},T=k=>{const N=fn("span");return N.dataset.bookmark=k,N},F=(k,N,it)=>{const ut=T(it);if(k.nodeType===Node.TEXT_NODE){const st=k.textContent;if(it==="start"){const mt=iu(st.substr(0,N)),G=iu(st.substr(N));k.replaceWith(mt,ut,G)}else{const mt=iu(st.substr(0,N)),G=iu(st.substr(N));k.replaceWith(mt,ut,G)}}else k.nodeType===Node.ELEMENT_NODE&&k.insertBefore(ut,k.childNodes[N])},W=()=>{const k=S.getRootNode();return"getSelection"in k?k.getSelection():document.getSelection()},B=k=>{const N=W();if(!N.getRangeAt||!N.rangeCount)return;const it=N.getRangeAt(0),{startOffset:ut,endOffset:st,startContainer:mt,endContainer:G}=it;if(k.contains(it.startContainer)&&k.contains(it.endContainer))if(mt.nodeType===Node.TEXT_NODE&&mt===G){const gt=mt.textContent,vt=gt.substr(0,ut),lt=T("start"),St=st-ut>0?gt.substr(ut,st):"",J=T("end"),q=gt.substr(st);mt.replaceWith(vt,lt,St,J,q)}else F(mt,ut,"start"),F(G,st+(mt===G?1:0),"end")},y=k=>{const N=V(k,"start"),it=V(k,"end");if(!N||!it)return;const ut=document.createRange();ut.setStart(N,0),ut.setEnd(it,0);const st=W();st.removeAllRanges(),st.addRange(ut),N.remove(),it.remove()},V=(k,N)=>{const it=k.children;for(let ut=0;ut<it.length;ut++){const st=it[ut];if(st.dataset.bookmark===N)return st;if(st.children.length){const mt=V(st,N);if(mt)return mt}}};let tt;return t.$$set=k=>{"spellcheck"in k&&i(1,o=k.spellcheck),"autocorrect"in k&&i(2,a=k.autocorrect),"autocapitalize"in k&&i(3,s=k.autocapitalize),"wrapLines"in k&&i(4,l=k.wrapLines),"allowNewline"in k&&i(5,c=k.allowNewline),"textFormat"in k&&i(16,d=k.textFormat),"formatInput"in k&&i(17,u=k.formatInput),"formatPaste"in k&&i(18,p=k.formatPaste),"style"in k&&i(19,h=k.style),"innerHTML"in k&&i(0,g=k.innerHTML),"oninput"in k&&i(20,m=k.oninput),"enableTextStyleShortcuts"in k&&i(21,f=k.enableTextStyleShortcuts)},t.$$.update=()=>{var k;if(64&t.$$.dirty[0]&&i(25,n=!!S),33554433&t.$$.dirty[0]&&n&&g&&(k=g)!==S.innerHTML&&(i(6,S.innerHTML=k,S),S===document.activeElement&&b()),524336&t.$$.dirty[0])if(!l&&c){const N=h.includes(":right")?"text-indent:-100px!important":h.includes(":center")?"":"min-width:calc(100% + 100px)!important";i(7,tt=h+";overflow:visible;"+N)}else i(7,tt=h);524288&t.$$.dirty[0]&&i(8,r=h.includes("text-stroke"))},[g,o,a,s,l,c,S,tt,r,()=>{w("blur")},k=>{if(/escape/i.test(k.code))return k.stopPropagation(),void w("cancel");const N=k.ctrlKey||k.metaKey;if(d==="html"&&N&&/b|i|u|s/.test(k.key))return f&&(it=>{const ut=D[it];ut&&document.execCommand(ut)})(k.key),void k.preventDefault();/enter/i.test(k.code)&&(k.stopPropagation(),k.isComposing||(N?w("confirm"):(c||k.preventDefault(),document.execCommand("insertLineBreak"),k.preventDefault())))},()=>{},k=>{k.data!==""&&M()},k=>{const{inputType:N}=k;N!=="insertCompositionText"&&N!=="deleteCompositionText"&&M()},k=>{k.preventDefault();const N=k.clipboardData.getData("text/plain"),it=d==="html"?N:C(N),ut=p(it);if(!ut.length)return;const st=W().getRangeAt(0);st.deleteContents(),st.insertNode(document.createTextNode(ut)),R()},k=>k.replace("-webkit-text-stroke","--text-stroke").replace("text-shadow","--text-shadow"),d,u,p,h,m,f,()=>M(),()=>S&&S.focus(),b,n,function(k){Fi[k?"unshift":"push"](()=>{S=k,i(6,S)})}]}class _S extends li{constructor(e){super(),si(this,e,WS,OS,ri,{spellcheck:1,autocorrect:2,autocapitalize:3,wrapLines:4,allowNewline:5,textFormat:16,formatInput:17,formatPaste:18,style:19,innerHTML:0,oninput:20,enableTextStyleShortcuts:21,confirm:22,focus:23,select:24},null,[-1,-1])}get spellcheck(){return this.$$.ctx[1]}set spellcheck(e){this.$$set({spellcheck:e}),I()}get autocorrect(){return this.$$.ctx[2]}set autocorrect(e){this.$$set({autocorrect:e}),I()}get autocapitalize(){return this.$$.ctx[3]}set autocapitalize(e){this.$$set({autocapitalize:e}),I()}get wrapLines(){return this.$$.ctx[4]}set wrapLines(e){this.$$set({wrapLines:e}),I()}get allowNewline(){return this.$$.ctx[5]}set allowNewline(e){this.$$set({allowNewline:e}),I()}get textFormat(){return this.$$.ctx[16]}set textFormat(e){this.$$set({textFormat:e}),I()}get formatInput(){return this.$$.ctx[17]}set formatInput(e){this.$$set({formatInput:e}),I()}get formatPaste(){return this.$$.ctx[18]}set formatPaste(e){this.$$set({formatPaste:e}),I()}get style(){return this.$$.ctx[19]}set style(e){this.$$set({style:e}),I()}get innerHTML(){return this.$$.ctx[0]}set innerHTML(e){this.$$set({innerHTML:e}),I()}get oninput(){return this.$$.ctx[20]}set oninput(e){this.$$set({oninput:e}),I()}get enableTextStyleShortcuts(){return this.$$.ctx[21]}set enableTextStyleShortcuts(e){this.$$set({enableTextStyleShortcuts:e}),I()}get confirm(){return this.$$.ctx[22]}get focus(){return this.$$.ctx[23]}get select(){return this.$$.ctx[24]}}const xf=["i","b","u","strike"].map(t=>({tag:t,tagOpen:new RegExp(`<${t}>`,"g"),tagClose:new RegExp(`</${t}>`,"g"),placeholderOpen:new RegExp(`___${t}O___`,"g"),placeholderClose:new RegExp(`___${t}C___`,"g")}));var VS=t=>t=((e,i=xf)=>(i.forEach(({tag:n,placeholderOpen:r,placeholderClose:o})=>{e=e.replace(r,`<${n}>`).replace(o,`</${n}>`)}),e))(t=(t=((e,i=xf)=>(i.forEach(({tag:n,tagOpen:r,tagClose:o})=>{e=e.replace(r,`___${n}O___`).replace(o,`___${n}C___`)}),e))(t)).replace(/ {2,}/g," ").replace(/\u00a0/g,"&nbsp;").split(`
`).join("<br>")),nu=(t,e)=>Ve(t)?parseFloat(t)/100*e:t,bc=(t,e)=>({x:Ar(t.x,e.width),y:Ar(t.y,e.height)});function bf(t,e,i){const n=t.slice();return n[284]=e[i],n[286]=i,n}function vf(t,e){let i,n,r,o,a,s,l,c,d,u,p,h=e[284].name+"";function g(){return e[183](e[286])}return r=new Jh({props:{color:e[284].color}}),{key:t,first:null,c(){i=ht("li"),n=ht("button"),Et(r.$$.fragment),o=me(),a=ht("span"),s=$n(h),c=me(),v(n,"class","PinturaShapeListItem"),v(n,"type","button"),v(n,"aria-label",l="Select shape "+e[284].name),this.first=i},m(m,f){et(m,i,f),kt(i,n),Rt(r,n,null),kt(n,o),kt(n,a),kt(a,s),kt(i,c),d=!0,u||(p=Pt(n,"click",g),u=!0)},p(m,f){e=m;const b={};2097152&f[0]&&(b.color=e[284].color),r.$set(b),(!d||2097152&f[0])&&h!==(h=e[284].name+"")&&An(s,h),(!d||2097152&f[0]&&l!==(l="Select shape "+e[284].name))&&v(n,"aria-label",l)},i(m){d||(P(r.$$.fragment,m),d=!0)},o(m){z(r.$$.fragment,m),d=!1},d(m){m&&Q(i),It(r),u=!1,p()}}}function wf(t){let e,i;return e=new BS({props:{visible:!0,points:t[12],rotatorPoint:t[27],selectedPoint:t[16],enableDragEdges:t[17],enableDragPoints:t[29],enableRotatePoints:t[14]}}),e.$on("resizestart",t[38]),e.$on("resizemove",t[39]),e.$on("resizeend",t[40]),e.$on("rotatestart",t[41]),e.$on("rotatemove",t[42]),e.$on("rotateend",t[43]),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};4096&r[0]&&(o.points=n[12]),134217728&r[0]&&(o.rotatorPoint=n[27]),65536&r[0]&&(o.selectedPoint=n[16]),131072&r[0]&&(o.enableDragEdges=n[17]),536870912&r[0]&&(o.enableDragPoints=n[29]),16384&r[0]&&(o.enableRotatePoints=n[14]),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function Sf(t){let e,i,n,r;const o=[HS,NS],a=[];function s(l,c){return l[4]==="modal"?0:l[4]==="inline"?1:-1}return~(e=s(t))&&(i=a[e]=o[e](t)),{c(){i&&i.c(),n=Mn()},m(l,c){~e&&a[e].m(l,c),et(l,n,c),r=!0},p(l,c){let d=e;e=s(l),e===d?~e&&a[e].p(l,c):(i&&(Pe(),z(a[d],1,1,()=>{a[d]=null}),Re()),~e?(i=a[e],i?i.p(l,c):(i=a[e]=o[e](l),i.c()),P(i,1),i.m(n.parentNode,n)):i=null)},i(l){r||(P(i),r=!0)},o(l){z(i),r=!1},d(l){~e&&a[e].d(l),l&&Q(n)}}}function NS(t){let e,i,n,r,o,a={formatInput:t[45],wrapLines:!!t[13].width,textFormat:t[13].format,enableTextStyleShortcuts:t[5],allowNewline:t[28],style:t[26]};return i=new _S({props:a}),t[186](i),i.$on("input",t[46]),i.$on("keyup",t[49]),i.$on("cancel",t[51]),i.$on("confirm",t[50]),{c(){e=ht("div"),Et(i.$$.fragment),v(e,"class","PinturaInlineInput"),v(e,"style",t[25])},m(s,l){et(s,e,l),Rt(i,e,null),n=!0,r||(o=Pt(e,"focusout",t[187]),r=!0)},p(s,l){const c={};8192&l[0]&&(c.wrapLines=!!s[13].width),8192&l[0]&&(c.textFormat=s[13].format),32&l[0]&&(c.enableTextStyleShortcuts=s[5]),268435456&l[0]&&(c.allowNewline=s[28]),67108864&l[0]&&(c.style=s[26]),i.$set(c),(!n||33554432&l[0])&&v(e,"style",s[25])},i(s){n||(P(i.$$.fragment,s),n=!0)},o(s){z(i.$$.fragment,s),n=!1},d(s){s&&Q(e),t[186](null),It(i),r=!1,o()}}}function HS(t){let e,i;return e=new F2({props:{panelOffset:t[2],onconfirm:t[50],oncancel:t[51],buttonCancel:{icon:t[6].shapeIconInputCancel,label:t[6].shapeLabelInputCancel},buttonConfirm:{icon:t[6].shapeIconInputConfirm,label:t[6].shapeLabelInputConfirm,hideLabel:!0},$$slots:{default:[jS]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};4&r[0]&&(o.panelOffset=n[2]),64&r[0]&&(o.buttonCancel={icon:n[6].shapeIconInputCancel,label:n[6].shapeLabelInputCancel}),64&r[0]&&(o.buttonConfirm={icon:n[6].shapeIconInputConfirm,label:n[6].shapeLabelInputConfirm,hideLabel:!0}),83886336&r[0]|256&r[9]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function jS(t){let e,i,n;return{c(){e=ht("textarea"),v(e,"spellcheck","false"),v(e,"autocorrect","off"),v(e,"autocapitalize","off"),v(e,"style",t[26])},m(r,o){et(r,e,o),t[184](e),Km(e,t[24]),i||(n=[Pt(e,"keydown",t[48]),Pt(e,"keypress",t[47]),Pt(e,"keyup",t[49]),Pt(e,"input",t[46]),Pt(e,"input",t[185])],i=!0)},p(r,o){67108864&o[0]&&v(e,"style",r[26]),16777216&o[0]&&Km(e,r[24])},d(r){r&&Q(e),t[184](null),i=!1,Ui(n)}}}function kf(t){let e,i,n,r,o;return i=new ro({props:{items:t[22],key:t[10]}}),{c(){e=ht("div"),Et(i.$$.fragment),v(e,"class","PinturaShapeControls"),v(e,"style",t[23])},m(a,s){et(a,e,s),Rt(i,e,null),n=!0,r||(o=[Pt(e,"measure",t[188]),Xi(xr.call(null,e))],r=!0)},p(a,s){const l={};4194304&s[0]&&(l.items=a[22]),1024&s[0]&&(l.key=a[10]),i.$set(l),(!n||8388608&s[0])&&v(e,"style",a[23])},i(a){n||(P(i.$$.fragment,a),n=!0)},o(a){z(i.$$.fragment,a),n=!1},d(a){a&&Q(e),It(i),r=!1,Ui(o)}}}function US(t){let e,i,n,r,o,a,s,l,c,d,u=[],p=new Map,h=t[21];const g=w=>w[284].id;for(let w=0;w<h.length;w+=1){let S=bf(t,h,w),C=g(S);p.set(C,u[w]=vf(C,S))}let m=t[15]&&wf(t),f=t[11]&&Sf(t),b=t[18]>0&&kf(t);return{c(){e=ht("div"),i=ht("nav"),n=ht("ul");for(let w=0;w<u.length;w+=1)u[w].c();r=me(),m&&m.c(),o=me(),f&&f.c(),a=me(),b&&b.c(),v(i,"class","PinturaShapeList"),v(i,"data-visible",t[19]),v(e,"class","PinturaShapeEditor"),v(e,"tabindex","0")},m(w,S){et(w,e,S),kt(e,i),kt(i,n);for(let C=0;C<u.length;C+=1)u[C].m(n,null);kt(e,r),m&&m.m(e,null),kt(e,o),f&&f.m(e,null),kt(e,a),b&&b.m(e,null),t[189](e),l=!0,c||(d=[Pt(i,"focusin",t[54]),Pt(i,"focusout",t[55]),Pt(e,"keydown",function(){Zi(t[0]?$e:t[44])&&(t[0]?$e:t[44]).apply(this,arguments)}),Pt(e,"nudge",function(){Zi(t[0]?$e:t[53])&&(t[0]?$e:t[53]).apply(this,arguments)}),Pt(e,"measure",t[182]),Pt(e,"pointermove",function(){Zi(t[0]?$e:t[56])&&(t[0]?$e:t[56]).apply(this,arguments)}),Pt(e,"pointerleave",function(){Zi(t[0]?$e:t[57])&&(t[0]?$e:t[57]).apply(this,arguments)}),Pt(e,"interactionstart",function(){Zi(t[0]?$e:t[32])&&(t[0]?$e:t[32]).apply(this,arguments)}),Pt(e,"interactionupdate",function(){Zi(t[0]?$e:t[34])&&(t[0]?$e:t[34]).apply(this,arguments)}),Pt(e,"interactioncancel",function(){Zi(t[0]?$e:t[33])&&(t[0]?$e:t[33]).apply(this,arguments)}),Pt(e,"interactionrelease",function(){Zi(t[0]?$e:t[35])&&(t[0]?$e:t[35]).apply(this,arguments)}),Pt(e,"interactionend",function(){Zi(t[0]?$e:t[36])&&(t[0]?$e:t[36]).apply(this,arguments)}),Xi(xr.call(null,e)),Xi(Fs.call(null,e)),Xi(s=zs.call(null,e,{drag:!0,inertia:!0,multiTouch:!1,observeKeys:!0,shouldStartInteraction:Cf,getEventPosition:t[190]}))],c=!0)},p(w,S){t=w,2097282&S[0]&&(h=t[21],Pe(),u=Da(u,S,g,1,t,h,p,n,As,vf,null,bf),Re()),(!l||524288&S[0])&&v(i,"data-visible",t[19]),t[15]?m?(m.p(t,S),32768&S[0]&&P(m,1)):(m=wf(t),m.c(),P(m,1),m.m(e,o)):m&&(Pe(),z(m,1,1,()=>{m=null}),Re()),t[11]?f?(f.p(t,S),2048&S[0]&&P(f,1)):(f=Sf(t),f.c(),P(f,1),f.m(e,a)):f&&(Pe(),z(f,1,1,()=>{f=null}),Re()),t[18]>0?b?(b.p(t,S),262144&S[0]&&P(b,1)):(b=kf(t),b.c(),P(b,1),b.m(e,null)):b&&(Pe(),z(b,1,1,()=>{b=null}),Re()),s&&Zi(s.update)&&8&S[0]&&s.update.call(null,{drag:!0,inertia:!0,multiTouch:!1,observeKeys:!0,shouldStartInteraction:Cf,getEventPosition:t[190]})},i(w){if(!l){for(let S=0;S<h.length;S+=1)P(u[S]);P(m),P(f),P(b),l=!0}},o(w){for(let S=0;S<u.length;S+=1)z(u[S]);z(m),z(f),z(b),l=!1},d(w){w&&Q(e);for(let S=0;S<u.length;S+=1)u[S].d();m&&m.d(),f&&f.d(),b&&b.d(),t[189](null),c=!1,Ui(d)}}}const Cf=(t,e)=>t.target===e;function GS(t,e,i){let n,r,o,a,s,l,c,d,u,p,h,g,m,f,b,w,S,C,R,M,D,T,F,W,B,y,V,tt,k,N,it,ut,st,mt,G,gt,vt,lt,St,J,q,Z,bt,nt,$t,Lt,ie,Vt,te,Yt,U,Tt,ct,Jt,de,ee,be,ve=ii,_=()=>(ve(),ve=zr(Bt,x=>i(178,ct=x)),Bt);t.$$.on_destroy.push(()=>ve());let{uid:Ce=na()}=e,{ui:pi}=e,{disabled:we=!1}=e,{shapes:Bt}=e;_();let{selection:Ae}=e,{offset:Ee}=e,{contextRotation:We=0}=e,{contextFlipX:oi=!1}=e,{contextFlipY:xt=!1}=e,{contextZoom:ge=1}=e,{active:Ue=!1}=e,{opacity:ze=1}=e,{parentRect:At}=e,{rootRect:Ge}=e,{utilRect:Ke}=e,{hoverColor:gi}=e,{caretColor:yi}=e,{gridColor:Li}=e,{snapColor:Si}=e,{textInputMode:X="inline"}=e,{oninteractionstart:Zt=$e}=e,{oninteractionupdate:H=$e}=e,{oninteractionrelease:qt=$e}=e,{oninteractionend:le=$e}=e,{oninteractioncancel:Ut=$e}=e,{onaddshape:fe=$e}=e,{onupdateshape:Xt=$e}=e,{onselectshape:Le=$e}=e,{onblurshape:Je=$e}=e,{onremoveshape:_e=$e}=e,{ontapshape:dt=$e}=e,{onhovershape:jt=$e}=e,{onhovercanvas:ne=$e}=e,{ontapcanvas:Fe=$e}=e,{onleavecanvas:Nt=$e}=e,{beforeSelectShape:K=()=>!0}=e,{beforeDeselectShape:Qt=()=>!0}=e,{beforeRemoveShape:Gt=()=>!0}=e,{beforeUpdateShape:oe=(x,j,L)=>j}=e,{willRenderShapeControls:He=Ji}=e,{willRenderShapeTextControls:Ne=Ji}=e,{willStartInteraction:Te=(x,j)=>!0}=e,{mapEditorPointToImagePoint:Qe}=e,{mapImagePointToEditorPoint:De}=e,{eraseRadius:ce}=e,{selectRadius:Ye}=e,{enableButtonFlipVertical:Me=!1}=e,{enableTapToAddText:Ze=!0}=e,{enableTextStyleControls:Ni=!0}=e,{locale:ue}=e,{snapThreshold:Se=0}=e,{snapPointer:dn=!0}=e,{enableSnapToContext:bn=!0}=e,{gridSize:vn=0}=e;const Nn=x=>{if(Se===0)return[];let j;return bn&&(j={...At,x:0,y:0}),[...ct.filter(L=>L!==x).filter(L=>!eo(L)).filter(L=>(rt=>rt.disableAcceptSnap!==!0)(L)).map(L=>Zn({...L},At)),j].filter(Boolean)},Hn=(x,j,L,rt)=>x===0?{snapTargets:[]}:{snapThreshold:x,gridSize:j,gridRect:L,snapTargets:Nn(rt)},dr=un("isAnimated");E(t,dr,x=>i(179,de=x));const oo=x=>x.set(va(x)),Pn=x=>va(x).find(eo),br=(x,j)=>{if(!Pn(j))return Zp(x),Gr(x,j)},yn=x=>{Pn(x)&&x.update(j=>j.filter(L=>!eo(L)))},ao=x=>{const j=Pn(x);if(j)return Om(j),oo(x),j},Qi=(x,j,L=(rt,at)=>({...rt,...at}))=>{Pn(j)&&j.update(rt=>rt.map(at=>eo(at)?L(at,x):at))},Gr=(x,j=Bt)=>(j.update(L=>[...L,x]),x),wn=(x,j,L)=>{const rt=oe({...x},j,{...L});return ba(x,rt,L),x},Xn=(x,j)=>{const L=$o(x,j),rt=Vd(x,j),at=Math.PI/8,zt=at*Math.round(rt/at)-We%at;j.x=x.x+L*Math.cos(zt),j.y=x.y+L*Math.sin(zt)},ki=un("keysPressed");E(t,ki,x=>i(180,ee=x));const _o=(x,j,L)=>x===0||j&&L?x:j||L?-x:x,Zr=x=>{if(x.x===null&&x.y===null)return Vo();x.x&&i(139,so=Qe({x:x.x,y:0}).x),x.y&&i(140,fo=Qe({x:0,y:x.y}).y)},Vo=()=>{i(139,so=null),i(140,fo=null)};let so=null,fo=null;const Ln=(x,j)=>{const L=De(x);return Qe(Fn(L,j))},Bn=(x,j,L)=>{const rt=(L-j)/x+1;return Array.from({length:rt},(at,zt)=>j+zt*x)},tn=x=>{let j=[],L=[],rt=x.points;if(x.x1!==void 0&&(rt=[{x:x.x1,y:x.y1},{x:x.x2,y:x.y2}]),rt){const at=rt.map(De),zt=nr(at),Dt=at[0],Ht=at[at.length-1];j=[zt.x,zt.x+.5*zt.width,zt.x+zt.width,Dt.x,Ht.x],L=[zt.y,zt.y+.5*zt.height,zt.y+zt.height,Dt.y,Ht.y]}else if(x.text||x.width!==void 0||x.rx!==void 0){let at;if(x.text&&x.height===void 0){const Kt=zo(x.text,x);at=In(x.x,x.y,Kt.width,Kt.height)}else at=x.width!==void 0?fs(x):fs({x:x.x-x.rx,y:x.y-x.ry,width:2*x.rx,height:2*x.ry});const zt=Bo(at).map(De),Dt=Math.abs(x.rotation)>0?$r(at,x.rotation).map(De):zt,Ht=nr(Dt),Ot=Ti(Ht),Ft=.5*Ht.width,Wt=.5*Ht.height;j=[Ot.x-Ft,Ot.x,Ot.x+Ft],L=[Ot.y-Wt,Ot.y,Ot.y+Wt]}else if(x.x!==void 0){const at=De(x);j=[at.x],L=[at.y]}return{x:j,y:L}},No=(x,j,L)=>{let rt,at,zt,Dt=Number.Infinity,Ht=null,Ot=null;for(let Ft=0;Ft<x.length;Ft++){at=x[Ft];for(let Wt=0;Wt<j.length;Wt++)zt=j[Wt],rt=Math.abs(at-zt),rt<L&&(Ot===null||rt<Dt)&&(Dt=rt,Ht=at,Ot=zt)}return{origin:Ht,target:Ot}},Br=(x,j,L,rt,at)=>{const zt={x:null,y:null},Dt={x:null,y:null},Ht=j.map(tn);if(rt>0){const Ot=De({x:0,y:0}),Ft=De({x:rt,y:rt}),Wt=De({x:at.width,y:at.height}),Kt=Ft.x-Ot.x,ni=Bn(Kt,Ot.x,Wt.x),pe=Bn(Kt,Ot.y,Wt.y);Ht.push({x:ni,y:pe})}return Ht.forEach(Ot=>{const{snapTranslation:Ft,snapLine:Wt}=((Kt,ni,pe)=>{const se={x:null,y:null},ke={x:null,y:null},xe=No(Kt.x,ni.x,pe);xe.target!==null&&(se.x=xe.target,ke.x=xe.target-xe.origin);const Xe=No(Kt.y,ni.y,pe);return Xe.target!==null&&(se.y=Xe.target,ke.y=Xe.target-Xe.origin),{snapTranslation:ke,snapLine:se}})(x,Ot,L);Ft.x!==null&&(Dt.x===null||Math.abs(Ft.x)<Math.abs(Dt.x))&&(Dt.x=Ft.x||0,zt.x=Wt.x),Ft.y!==null&&(Dt.y===null||Math.abs(Ft.y)<Math.abs(Dt.y))&&(Dt.y=Ft.y||0,zt.y=Wt.y)}),{snapTranslation:Dt,snapLines:zt}},mr=(x,j)=>(j.x!==null&&(x.x+=j.x),j.y!==null&&(x.y+=j.y),x),Or=(x,j,L,rt)=>{const{snapThreshold:at=0,gridSize:zt=0,gridRect:Dt,snapTargets:Ht=[]}=rt||{};let Ot=null;if(ir(x)){if(at){const Kt=Zn({...x},At),ni=Ln(Qa(j),L),pe=Ln(ts(j),L),se=tn({...Kt,x1:ni.x,y1:ni.y,x2:pe.x,y2:pe.y}),{snapTranslation:ke,snapLines:xe}=Br(se,Ht,at,zt,Dt);mr(L,ke),Zr(xe)}const Ft=Ln(Qa(j),L),Wt=Ln(ts(j),L);Ot={x1:Ft.x,y1:Ft.y,x2:Wt.x,y2:Wt.y}}else if(x.points){if(gp(Mt)&&Gi(Mt,{selectedPoint:void 0}),at){const Ft=Zn({...x},At),Wt=tn({...Ft,points:j.points.map(pe=>Ln(pe,L))}),{snapTranslation:Kt,snapLines:ni}=Br(Wt,Ht,at,zt,Dt);mr(L,Kt),Zr(ni)}Ot={points:j.points.map(Ft=>Ln(Ft,L))}}else if(vo(x)||Yn(x)||qn(x)){if(at){const Ft=Zn({...x},At),Wt=Ln(j,L),Kt=tn({...Ft,...Wt}),{snapTranslation:ni,snapLines:pe}=Br(Kt,Ht,at,zt,Dt);mr(L,ni),Zr(pe)}Ot=Ln(j,L)}Ot&&(wn(x,Ot,At),Sn())},da={0:1,1:0,2:3,3:2},Co={0:3,1:2,2:1,3:0};let To;const Wr=(x,j)=>{const L=x.points.filter((rt,at)=>at!==j);Gi(x,{points:L,selectedPoint:void 0})},lo=()=>{if(ct.length)return ct.find(eo)},vr=()=>{if(ct.length)return ct.findIndex(eo)},Rr=()=>{const x=lo();if(x)return Om(x),Sn(),x},co=()=>{if(!lo())return;const x=[...ct];x.splice(vr(),1),Bt.set(x)},Sn=()=>{Bt.set(ct)},Di=(x,j=[],L=!0)=>{j.filter(Boolean).forEach(rt=>delete x[rt]),L&&Sn()},Gi=(x,j,L=!0)=>{x=Object.assign(x,j),L&&Sn()},wr=(x,j,L,rt=!0)=>{x[j]=L,rt&&Sn()},en=(x,j=!0)=>{ct.forEach(L=>Gi(L,x,!1)),j&&Sn()},Sr=()=>[...ct].reverse().find(ys),uo=()=>!!Sr(),Xr=x=>{if(!Gt(x))return!1;Bt.set(ct.filter(j=>j!==x)),_e(x)},ur=()=>{const x=Sr();if(!x)return;const j=ct.filter(at=>Wm(at)&&fa(at)),L=j.findIndex(at=>at===x);if(Xr(x)===!1)return;if(pr=x,j.length-1<=0)return Wn();const rt=L-1<0?j.length-1:L-1;Jn(j[rt])};let pr;const Wn=(x={})=>{const{storePrevious:j=!0}=x;Object.keys(Go).forEach(rt=>Go[rt]={});const L=po();j&&(pr=L),en({isSelected:!1,isEditing:!1,_prerender:!1}),L&&Je(L)},po=()=>ct.find(ys),Jn=(x,j=!0)=>{if(eo(x))return;const L=po()||pr,rt=ys(x);pr=void 0,K(L,x)&&(Wn(),(at=>{at.isSelected=!0})(x),!rt&&Le(x),j&&Sn())},Ho=x=>{Oi&&Oi.confirm&&x.isEditing&&Oi.confirm();const j={isSelected:!1,isEditing:!1,_prerender:!1};x.selectedPoint>-1&&(j.selectedPoint=void 0),Gi(x,j),Je(x)},jn=x=>{Gi(x,{isSelected:!0,isEditing:!0,_prerender:X==="inline"})},zn=x=>{Gi(x,{isSelected:!0,isEditing:!1,_prerender:!1})},ho=x=>{if(!x.length)return[];const j=x.filter(Gt);return Bt.set(ct.filter(L=>!j.includes(L))),j},Yr=x=>{const j=zo(x.text,x);return In(x.x,x.y,x.width?Math.min(x.width,j.width):j.width,x.height?Math.min(x.height,j.height):j.height)},Rn=x=>{if(el(x))return fs(x);if(qn(x))return cp(x);const j=Yr(x);return j.width=Math.max(10,x.width||j.width),j},hr=(x,j,L=0,rt=()=>!0)=>[...x].reverse().filter(rt).map(at=>({shape:at,priority:1})).filter(at=>{const{shape:zt}=at,Dt=Zn(_n(zt),At),Ht=L+.5*(Dt.strokeWidth||0);if(vo(Dt))return dp(j,Ht,Dt,zt.rotation);if(Yn(Dt)){const Ot=Rn(Dt),Ft=dp(j,Ht,Ot,zt.rotation);let Wt=!1;if(Ft&&!ys(zt)){const Kt=Yr(Dt);zt.textAlign!=="right"||zt.flipX||(Kt.x=Ot.x+Ot.width-Kt.width),zt.textAlign==="center"&&(Kt.x=Ot.x+.5*Ot.width-.5*Kt.width),Wt=dp(j,Ht,Kt,zt.rotation,Ti(Ot)),Wt||(at.priority=-1)}return Ft}return qn(Dt)?((Ot,Ft,Wt,Kt,ni,pe)=>{const se=gu(ot(Wt.x,Wt.y),Wt.rx,Wt.ry,Kt,ni,pe,12);return Gp(Ot,Ft,se)})(j,Ht,Dt,zt.rotation,zt.flipX,zt.flipY):ir(Dt)?fu(j,Math.max(16,Ht),Qa(Dt),ts(Dt)):On(Dt)&&Dt.pathClose?Gp(j,Ht,Dt.points):!!On(Dt)&&(Dt.points.length===1?bo(j,Dt.points[0])<Ht*Ht:uy(j,Math.max(16,Ht),Dt.points))}).sort((at,zt)=>at.priority<zt.priority?1:at.priority>zt.priority?-1:0).map(at=>at.shape),O=(x,j,L,rt=0)=>{const at=Math.abs(rt),zt=Is(j,L),Dt=vh(zt,at),Ht=(({start:Ot,end:Ft},Wt)=>{if(Wt===0)return[ot(Ot.x,Ot.y),ot(Ot.x,Ot.y),ot(Ft.x,Ft.y),ot(Ft.x,Ft.y)];const Kt=Math.atan2(Ft.y-Ot.y,Ft.x-Ot.x),ni=Math.sin(Kt)*Wt,pe=Math.cos(Kt)*Wt;return[ot(ni+Ot.x,-pe+Ot.y),ot(-ni+Ot.x,pe+Ot.y),ot(-ni+Ft.x,pe+Ft.y),ot(ni+Ft.x,-pe+Ft.y)]})(Dt,at);return x.filter(Ot=>{const Ft=Zn(_n(Ot),At);if(ir(Ft)||On(Ft)){const Wt=Ft.points?[...Ft.points]:[Qa(Ft),ts(Ft)];return!!ly(Dt,Wt)}return((Wt,Kt)=>!!Wt.find(ni=>Up(ni,Kt))||!!Kt.find(ni=>Up(ni,Wt)))(Ht,((Wt,Kt=12)=>{if(vo(Wt))return $r(Wt,Wt.rotation,Ti(Wt));if(Yn(Wt)){const ni=Rn(Wt);return $r(ni,Wt.rotation,Ti(ni))}return qn(Wt)?gu(ot(Wt.x,Wt.y),Wt.rx,Wt.ry,Wt.rotation,Wt.flipX,Wt.flipY,Kt):[]})(Ft))})};let re,xi,qe,Mt,ye,Mi,_i=!1,pn=!1,bi=!1;const Hi=()=>{clearTimeout(xi),xi=void 0,i(142,bi=!1),Vo()};let _r=null;const ua=x=>{const j=ui(x.rotation)&&x.rotation!==0;if(vo(x)){if(x.width<1&&x.height<1)return;const L=Ti(x),rt=Bo(x);return(x.flipX||x.flipY)&&Al(rt,x.flipX,x.flipY,L.x,L.y),j?rl(rt,x.rotation,L.x,L.y):rt}if(qn(x)){if(x.rx<1&&x.ry<1)return;const L=x,rt=Bo(cp(x));return(x.flipX||x.flipY)&&Al(rt,x.flipX,x.flipY,L.x,L.y),j?rl(rt,x.rotation,L.x,L.y):rt}if(ir(x))return[Qa(x),ts(x)];if(On(x)){if(x.bitmap&&!x.pathClose){const L=nr(x.points);return L.x-=.5*x.strokeWidth,L.y-=.5*x.strokeWidth,L.width+=x.strokeWidth,L.height+=x.strokeWidth,ua({...x,...L})}return[...x.points]}if(Yn(x)){if(x.width<5&&x.height<5)return;const L=Rn(x);L.width=Math.max(10,L.width);const rt=Ti(L),at=Bo(L);return(x.flipX||x.flipY)&&Al(at,x.flipX,x.flipY,rt.x,rt.y),j?rl(at,x.rotation,rt.x,rt.y):at}return[]},Ba=x=>{const j=ua(x);let L,rt;return x.flipY?(L=Fo([j[0],j[1]]),rt=no(ot(j[1].x-j[2].x,j[1].y-j[2].y))):(L=Fo([j[2],j[3]]),rt=no(ot(j[2].x-j[1].x,j[2].y-j[1].y))),Tr(rt,20/ge),{origin:L,dir:rt}},pa=x=>j=>j.id===x,Mo=x=>{const j=pa(x);return L=>L.filter((rt=>at=>!rt(at))(j))},qr=x=>{const j=pa(x),L=Mo(x);return()=>pi.update(rt=>rt.some(j)?L(rt):rt)},jo=x=>{const j=Mo(x);return(...L)=>{pi.update(rt=>[...j(rt),...L.filter(Boolean)])}},yo=qr("markup-hover"),Ca=jo("markup-hover");let Vr;const A="markup-manipulator-segment-"+Ce,ae=(x,j)=>{const L=x[j],rt=j-1<0?x[x.length-1]:x[j-1],at=j+1<x.length?x[j+1]:x[0],zt=Dn(Oe(rt),L);no(zt);const Dt=Fn(Tr(zt,10),L),Ht=Dn(Oe(at),L);return no(Ht),[Dt,L,Fn(Tr(Ht,10),L)]},Be=qr(A),vi=jo(A),Pi=()=>{i(143,Vr=void 0),yo()},Vi=(x,j)=>{if(Se<=0)return x;if(j)return Vo(),x;const L=Qe(x),rt=Nn(),{snapTranslation:at,snapLines:zt}=Br(tn(L),rt,Se,vn,n);return Zr(zt),mr(x,at),x},ti=di(0);E(t,ti,x=>i(181,be=x));const hi="markup-grid-line-"+Ce,Ri=qr(hi),Bi=jo(hi),hn="markup-snap-line",Cn=qr(hn),gn=jo(hn);let Oi;const Ei=x=>{i(8,Oi.innerHTML=VS(x),Oi)},Ir=x=>{const j=x.value===void 0?x.innerHTML:x.value,L=r.format==="text"?Q2(j).split(/<br>|<br\/>/g).join(`
`).replace(/&nbsp;/g," ").replace(/&amp;/g,"&"):j;return bu(r)&&r.disableNewline!==!1?(rt=>{const at=rt.split(/[\n\r]/g);return at.length>1?at.map(zt=>zt.trim()).filter(zt=>zt.length).join(" "):at[0]})(L):L},Uo=()=>{const x=Ir(Oi),j=Cl(r,x),L=j===!0?x:j;let rt=k.x,at=k.y;if(!r.height){const zt=$r({...it},r.rotation),Dt=zo(L,l),Ht=$r({x:rt,y:at,...Dt},r.rotation),[Ot,,Ft]=zt,[Wt,,Kt]=Ht;let ni=Ot,pe=Wt;r.flipX&&(ni=Ft,pe=Kt);const se=Dn(Oe(ni),pe);rt+=se.x,at+=se.y}Gi(r,{x:Ve(tt.x)?Ar(rt,At.width):rt,y:Ve(tt.y)?Ar(at,At.height):at,text:L})},Oa=()=>{a&&Rr(),Oi&&Oi.confirm&&Oi.confirm(),Uo(),zn(r),Xt(r)},Ta=()=>{a?co():(Gi(r,{text:tt.text,x:tt.x,y:tt.y}),zn(r))},Wa=(x,j,{flipX:L,flipY:rt,rotation:at},zt="top left")=>{let Dt,Ht;const[Ot,Ft,Wt,Kt]=$r(x,at),[ni,pe,se,ke]=$r(j,at);return zt==="top center"?(Dt=Fo(rt?[Kt,Wt]:[Ot,Ft]),Ht=Fo(rt?[ke,se]:[ni,pe])):zt==="top right"&&!L||zt==="top left"&&L?(Dt=rt?Wt:Ft,Ht=rt?se:pe):(Dt=rt?Kt:Ot,Ht=rt?ke:ni),Dn(Oe(Dt),Ht)},_a=(x,j,L)=>ot(Ve(x.x)?Ar(j.x+L.x,At.width):j.x+L.x,Ve(x.y)?Ar(j.y+L.y,At.height):j.y+L.y),Go={},ss=()=>Wr(r,r.selectedPoint),ul=()=>jn(r),Va=()=>{const x=is(zo(r.text,l),Ot=>Math.ceil(Ot)),j=Ie(r,"height"),L=!j&&Ie(r,"width"),rt=r.id;let at=Go[rt];at||(Go[rt]={},at=Go[rt]);const zt=Ot=>{const{width:Ft,...Wt}=l,Kt=zo(r.text,Wt),ni=Wa(In(l.x,l.y,Ot.width,Ot.height),In(l.x,l.y,Kt.width,Kt.height),l,"top "+r.textAlign),pe=l.disableNewline!==!1;Di(r,["width","height",pe&&"textAlign"]),Gi(r,{..._a(r,l,ni)})},Dt=Ot=>{const Ft=Vn(at.width||l.width||x.width,x.height),Wt=at.textAlign||"left",Kt=Wa(In(l.x,l.y,Ot.width,Ot.height),In(l.x,l.y,Ft.width,Ft.height),l,"top "+Wt);Di(r,["height"]),Gi(r,{..._a(r,l,Kt),width:Ve(r.width)?Ar(Ft.width,At.width):Ft.width,textAlign:Wt})},Ht=Ot=>{const Ft=Vn(at.width||x.width,at.height||x.height),Wt=at.textAlign||"left",Kt=Wa(In(l.x,l.y,Ot.width,Ot.height),In(l.x,l.y,Ft.width,Ft.height),l,"top "+Wt);Gi(r,{..._a(r,l,Kt),width:Ve(r.width)?Ar(Ft.width,At.width):Ft.width,height:Ve(r.width)?Ar(Ft.height,At.height):Ft.height,textAlign:Wt})};if(j){at.textAlign=r.textAlign,at.width=l.width,at.height=l.height;const Ot=Vn(l.width,l.height);qs(r,"auto-height")?Dt(Ot):qs(r,"auto-width")&&zt(Ot)}else if(L){at.textAlign=r.textAlign,at.width=l.width;const Ot=Vn(l.width,x.height);qs(r,"auto-width")?zt(Ot):qs(r,"fixed-size")&&Ht(Ot)}else{at.textAlign=r.textAlign;const Ot=Vn(Math.ceil(x.width),Math.ceil(x.height));qs(r,"fixed-size")?Ht(Ot):qs(r,"auto-height")&&Dt(Ot)}},Na=x=>{x.stopPropagation();const j=r.flipX||!1;wr(r,"flipX",!j),Xt(r)},Kr=x=>{x.stopPropagation();const j=r.flipY||!1;wr(r,"flipY",!j),Xt(r)},Nr=x=>{wr(r,"opacity",x)},Jr=x=>{Nr(x),Xt(r)},Er=x=>{x.stopPropagation(),x.target.blur(),ur()},an=x=>{x.stopPropagation(),ct.findIndex(j=>j===r)!==ct.length-1&&(Bt.set(ct.filter(j=>j!==r).concat([r])),Xt(r))},Zo=x=>{x.stopPropagation(),Ha()},Ha=()=>{const x=_n(r);x.id=na();const j=ot(50,-50);if(Ie(x,"points")){const L=Ll(x,["points"],At);L.points.forEach(rt=>{rt.x+=j.x,rt.y+=j.y}),ba(x,L,At)}else if(ir(x)){const L=Ll(x,["x1","y1","x2","y2"],At);L.x1+=j.x,L.y1+=j.y,L.x2+=j.x,L.y2+=j.y,ba(x,L,At)}else{const L=Ll(x,["x","y"],At);L.x+=50,L.y-=50,ba(x,L,At)}Bt.set([...ct,x]),fe(x),Jn(x)},Hr=di(0,{stiffness:.2,damping:.7});E(t,Hr,x=>i(18,Jt=x));let on;const Uc=(x,j)=>{const{disableTextLayout:L=[]}=j;return"height"in j?L.includes("auto-height")?x.shapeIconButtonTextLayoutAutoWidth:x.shapeIconButtonTextLayoutAutoHeight:"width"in j?L.includes("auto-width")?x.shapeIconButtonTextLayoutFixedSize:x.shapeIconButtonTextLayoutAutoWidth:L.includes("fixed-size")?x.shapeIconButtonTextLayoutAutoHeight:x.shapeIconButtonTextLayoutFixedSize},ls=(x,j)=>{const{disableTextLayout:L=[]}=j;return"height"in j?L.includes("auto-height")?x.shapeTitleButtonTextLayoutAutoWidth:x.shapeTitleButtonTextLayoutAutoHeight:"width"in j?L.includes("auto-width")?x.shapeTitleButtonTextLayoutFixedSize:x.shapeTitleButtonTextLayoutAutoWidth:L.includes("fixed-size")?x.shapeTitleButtonTextLayoutAutoHeight:x.shapeTitleButtonTextLayoutFixedSize};let Ds=!1,ja=ln(),ha;const xo=x=>{jt(x),i(143,Vr=x)};let Ma;return Wo(()=>{Cn(),Ri(),Be(),yo()}),t.$$set=x=>{"uid"in x&&i(58,Ce=x.uid),"ui"in x&&i(59,pi=x.ui),"disabled"in x&&i(0,we=x.disabled),"shapes"in x&&_(i(1,Bt=x.shapes)),"selection"in x&&i(60,Ae=x.selection),"offset"in x&&i(2,Ee=x.offset),"contextRotation"in x&&i(61,We=x.contextRotation),"contextFlipX"in x&&i(62,oi=x.contextFlipX),"contextFlipY"in x&&i(63,xt=x.contextFlipY),"contextZoom"in x&&i(64,ge=x.contextZoom),"active"in x&&i(65,Ue=x.active),"opacity"in x&&i(66,ze=x.opacity),"parentRect"in x&&i(67,At=x.parentRect),"rootRect"in x&&i(3,Ge=x.rootRect),"utilRect"in x&&i(68,Ke=x.utilRect),"hoverColor"in x&&i(69,gi=x.hoverColor),"caretColor"in x&&i(70,yi=x.caretColor),"gridColor"in x&&i(71,Li=x.gridColor),"snapColor"in x&&i(72,Si=x.snapColor),"textInputMode"in x&&i(4,X=x.textInputMode),"oninteractionstart"in x&&i(73,Zt=x.oninteractionstart),"oninteractionupdate"in x&&i(74,H=x.oninteractionupdate),"oninteractionrelease"in x&&i(75,qt=x.oninteractionrelease),"oninteractionend"in x&&i(76,le=x.oninteractionend),"oninteractioncancel"in x&&i(77,Ut=x.oninteractioncancel),"onaddshape"in x&&i(78,fe=x.onaddshape),"onupdateshape"in x&&i(79,Xt=x.onupdateshape),"onselectshape"in x&&i(80,Le=x.onselectshape),"onblurshape"in x&&i(81,Je=x.onblurshape),"onremoveshape"in x&&i(82,_e=x.onremoveshape),"ontapshape"in x&&i(83,dt=x.ontapshape),"onhovershape"in x&&i(84,jt=x.onhovershape),"onhovercanvas"in x&&i(85,ne=x.onhovercanvas),"ontapcanvas"in x&&i(86,Fe=x.ontapcanvas),"onleavecanvas"in x&&i(87,Nt=x.onleavecanvas),"beforeSelectShape"in x&&i(88,K=x.beforeSelectShape),"beforeDeselectShape"in x&&i(89,Qt=x.beforeDeselectShape),"beforeRemoveShape"in x&&i(90,Gt=x.beforeRemoveShape),"beforeUpdateShape"in x&&i(91,oe=x.beforeUpdateShape),"willRenderShapeControls"in x&&i(92,He=x.willRenderShapeControls),"willRenderShapeTextControls"in x&&i(93,Ne=x.willRenderShapeTextControls),"willStartInteraction"in x&&i(94,Te=x.willStartInteraction),"mapEditorPointToImagePoint"in x&&i(95,Qe=x.mapEditorPointToImagePoint),"mapImagePointToEditorPoint"in x&&i(96,De=x.mapImagePointToEditorPoint),"eraseRadius"in x&&i(97,ce=x.eraseRadius),"selectRadius"in x&&i(98,Ye=x.selectRadius),"enableButtonFlipVertical"in x&&i(99,Me=x.enableButtonFlipVertical),"enableTapToAddText"in x&&i(100,Ze=x.enableTapToAddText),"enableTextStyleControls"in x&&i(5,Ni=x.enableTextStyleControls),"locale"in x&&i(6,ue=x.locale),"snapThreshold"in x&&i(101,Se=x.snapThreshold),"snapPointer"in x&&i(102,dn=x.snapPointer),"enableSnapToContext"in x&&i(103,bn=x.enableSnapToContext),"gridSize"in x&&i(104,vn=x.gridSize)},t.$$.update=()=>{var x,j;32&t.$$.dirty[2]|2048&t.$$.dirty[3]&&i(169,n=vn>0?{x:0,y:0,...At}:void 0),1&t.$$.dirty[0]|8388608&t.$$.dirty[5]&&i(147,r=!we&&ct&&(lo()||Sr())),8388608&t.$$.dirty[4]&&i(176,o=!!r),8388608&t.$$.dirty[4]&&i(163,a=r&&eo(r)),8388608&t.$$.dirty[4]|256&t.$$.dirty[5]&&i(10,s=r&&!a?r.id:void 0),8&t.$$.dirty[0]|32&t.$$.dirty[2]|8388608&t.$$.dirty[4]&&i(13,l=Ge&&r&&Zn(_n(r),At)),8388608&t.$$.dirty[4]|256&t.$$.dirty[5]&&i(145,c=!(!r||!a)),8192&t.$$.dirty[0]|16&t.$$.dirty[2]|8388608&t.$$.dirty[4]&&i(175,d=r&&ze&&ua(l)||[]),8388608&t.$$.dirty[4]&&i(177,u=r&&Yp(x=r)&&vc(x)&&x.disableResize!==!0&&(el(x)||lu(x)||qn(x)||ir(x)||On(x)&&Ie(x,"pathClose"))&&!Ja(r)),8388608&t.$$.dirty[4]&&i(14,p=r&&(L=>Yp(L)&&L.disableRotate!==!0&&(el(L)||Ie(L,"text")||qn(L)))(r)&&!Ja(r)),8388608&t.$$.dirty[4]|4194304&t.$$.dirty[5]&&i(17,h=u&&Ie(r,"text")&&!r.height?[[1,2],[3,0]]:(!r||!ir(r)&&!On(r))&&u),131072&t.$$.dirty[0]|8388608&t.$$.dirty[4]|4194304&t.$$.dirty[5]&&i(29,g=!!r&&!Array.isArray(h)&&u),8388608&t.$$.dirty[4]|1048576&t.$$.dirty[5]&&i(15,m=r&&d.length>1),8&t.$$.dirty[3]|1048576&t.$$.dirty[5]&&i(173,f=d.map(De)),4&t.$$.dirty[0]|262144&t.$$.dirty[5]&&i(12,b=f.map(L=>ot(L.x-Ee.x,L.y-Ee.y))),8388608&t.$$.dirty[4]&&i(16,w=r&&r.points&&ui(r.selectedPoint)?r.selectedPoint:-1),65536&t.$$.dirty[0]&&i(155,S=w>=0),69632&t.$$.dirty[0]|1&t.$$.dirty[5]&&i(160,C=S?b[w]:void 0),8388608&t.$$.dirty[4]|2097152&t.$$.dirty[5]&&i(28,R=o&&(lu(r)?!Ie(r,"disableNewline")||!r.disableNewline:r.disableNewline===!1)),8&t.$$.dirty[3]|524288&t.$$.dirty[4]&&(Vr&&De&&!ys(Vr)&&fa(Vr)?(L=>{const rt=ua(Zn(_n(L),At));if(!rt)return;const at=rt.map(De),zt=!!L.pathClose||!(!L.bitmap&&(On(L)||ir(L))),Dt=L.selectionStyle==="hook",Ht=Dt?at.map((Ft,Wt,Kt)=>({id:"markup-hover",points:ae(Kt,Wt),strokeColor:[0,0,0,.1],strokeWidth:2})):[{id:"markup-hover",points:at.map(Ft=>ot(Ft.x+1,Ft.y+1)),strokeColor:[0,0,0,.1],strokeWidth:2,pathClose:zt}],Ot=Dt?at.map((Ft,Wt,Kt)=>({id:"markup-hover",points:ae(Kt,Wt),strokeColor:gi,strokeWidth:2})):[{id:"markup-hover",points:at,strokeColor:gi,strokeWidth:2,pathClose:zt}];Ca(...Ht,...Ot)})(Vr):yo()),61440&t.$$.dirty[0]|16&t.$$.dirty[2]&&i(174,M=m&&p&&ze&&b&&(L=>{const rt=Ba(L),at=De({x:rt.origin.x+rt.dir.x,y:rt.origin.y+rt.dir.y});return{origin:De(rt.origin),position:at}})(l)),4&t.$$.dirty[0]|524288&t.$$.dirty[5]&&i(27,D=M&&ot(M.position.x-Ee.x,M.position.y-Ee.y)),33554432&t.$$.dirty[5]&&i(168,B=!!(ee||[]).find(L=>[91,93,17].includes(L))),512&t.$$.dirty[3]|8192&t.$$.dirty[5]&&i(170,T=!(B||!dn)),16&t.$$.dirty[2]|9437184&t.$$.dirty[4]|295168&t.$$.dirty[5]&&r&&f&&ze>0&&(r===Vr&&Pi(),((L,rt,at)=>{if(!fa(rt))return;const zt=On(rt),Dt=zt&&Ie(rt,"pathClose"),Ht=Dt&&(sn=>sn.strokeWidth&&((jr,kr)=>{const Qr=jr.strokeColor;return!!Qr&&(Qr.length===3||Qr[3]>0)})(sn))(rt),Ot=eo(rt),Ft=Ja(rt),Wt=rt.selectionStyle==="hook",Kt=rt.disableShowPoints!==!0,{selectionOpacity:ni=1}=rt;if(Ot&&zt&&!Dt)return;const pe=[],se=[...f],ke=se[se.length-1],xe=se[0],Xe=(Ft?.05:.1)*L*ni,ei=Xe>0,wi=(Ft?.5:1)*L*ni,ci=wi>0,Ii=[0,0,0],mn=[1,1,1],ji=Ft?1:1.5;ee.includes(16)&&ke&&at&&Xn(ke,at);const zi=(se.length&&Dt&&Ot&&at?bo(xe,at):1/0)<=256,xn=(se.length&&Dt&&Ot&&at?bo(ke,at):1/0)<=256;!zi&&at&&se.push(at);const Yi=se.length>1,Un=!!rt.pathClose||!(!rt.bitmap&&(On(rt)||ir(rt)))||se.length>2&&zi;Yi&&ei&&(Wt?pe.push(...se.map((sn,jr,kr)=>({id:A,points:ae(kr,jr),strokeColor:Ii,opacity:Xe}))):pe.push({id:A,points:se.map(sn=>ot(sn.x+1,sn.y+1)),pathClose:Un,strokeColor:Ii,strokeWidth:2,opacity:Xe})),Dt&&ei&&Kt&&pe.push(...se.map(sn=>({id:A,...sn,rx:2*ji,ry:2*ji,backgroundColor:Ii,opacity:Xe}))),M&&ei&&pe.push({id:A,points:[ot(M.origin.x+1,M.origin.y+1),ot(M.position.x+1,M.position.y+1)],strokeColor:Ii,strokeWidth:2,opacity:Xe}),Yi&&ci&&(Wt?pe.push(...se.map((sn,jr,kr)=>({id:A,points:ae(kr,jr),strokeColor:mn,strokeWidth:ji,opacity:wi}))):pe.push({id:A,points:se,pathClose:Un,strokeColor:mn,strokeWidth:ji,backgroundColor:Ot&&Dt&&rt.backgroundColor&&rt.backgroundColor[3]>0?rt.backgroundColor:[0,0,0,0],opacity:wi})),Dt&&Kt&&pe.push(...se.map(sn=>({id:A,...sn,rx:3*ji,ry:3*ji,backgroundColor:[.5,.5,.5],strokeWidth:ji,strokeColor:mn}))),Dt&&Ot&&Kt&&f.length>=3&&pe.push({...xe,id:A,rx:ji*(zi?5:4),ry:ji*(zi?5:4),backgroundColor:zi?gi:[.5,.5,.5],strokeWidth:ji,strokeColor:mn}),Dt&&Ot&&Ht&&Kt&&!zi&&d.length>=2&&pe.push({...ke,id:A,rx:ji*(xn?5:4),ry:ji*(xn?5:4),backgroundColor:xn?gi:[.5,.5,.5],strokeWidth:ji,strokeColor:mn}),M&&ci&&!Wt&&pe.push({id:A,points:[{x:M.origin.x,y:M.origin.y},{x:M.position.x,y:M.position.y}],strokeColor:mn,strokeWidth:ji,opacity:wi}),vi(...pe)})(ze,r,a&&On(r)?Vi({...ha},!T):void 0)),8388608&t.$$.dirty[4]&&(r||(Pi(),Be())),524288&t.$$.dirty[4]&&i(171,F=!!Vr),131072&t.$$.dirty[4]&&i(172,W=!!Mt),1048576&t.$$.dirty[4]|229376&t.$$.dirty[5]&&(!ha||W||F||Vi({...ha},!T)),512&t.$$.dirty[2]|2056&t.$$.dirty[3]|67125248&t.$$.dirty[5]&&vn>0&&n&&De&&((L,rt,at,zt)=>{const Dt=De({x:0,y:0}),Ht=De({x:L,y:L}),Ot=De({x:rt.width,y:rt.height}),Ft=Ht.x-Dt.x;if(ti.set(Ft>6?1:0),zt<=0)return Ri();const Wt=Bn(Ft,Dt.x,Ot.x).map(ni=>({id:hi,opacity:zt,points:[{x:ni,y:Dt.y},{x:ni,y:Ot.y}],strokeWidth:1,strokeColor:at})),Kt=Bn(Ft,Dt.y,Ot.y).map(ni=>({id:hi,opacity:zt,points:[{x:Dt.x,y:ni},{x:Ot.x,y:ni}],strokeWidth:1,strokeColor:at}));Bi(...Kt,...Wt)})(vn,n,Li,be),1024&t.$$.dirty[2]|8&t.$$.dirty[3]|98304&t.$$.dirty[4]|8192&t.$$.dirty[5]&&De&&(B?Cn():((L,rt,at)=>{if(L===null&&rt===null)return Cn();let zt,Dt;L!==null&&(zt={id:hn,strokeColor:at,strokeWidth:1.5,points:[De({x:L,y:0}),De({x:L,y:At.height})]}),rt!==null&&(Dt={id:hn,strokeColor:at,strokeWidth:1.5,points:[De({x:0,y:rt}),De({x:At.width,y:rt})]}),gn(zt,Dt)})(so,fo,Si)),8&t.$$.dirty[2]&&(L=>{if(!L)return en({_prerender:!1});const rt=ct.find(at=>at.isEditing);rt&&Gi(rt,{_prerender:X==="inline"})})(Ue),33554432&t.$$.dirty[5]&&ee&&ee.length&&(()=>{const[L]=ee;L!==8&&L!==46||uo()&&(r.isEditing||(On(r)&&ui(r.selectedPoint)?setTimeout(()=>Wr(r,r.selectedPoint),0):setTimeout(()=>ur(),0)))})(),272&t.$$.dirty[0]&&Oi&&X==="inline"&&Oi.focus(),8388608&t.$$.dirty[4]&&i(167,y=r&&Yn(r)),8388608&t.$$.dirty[4]|4096&t.$$.dirty[5]&&i(11,V=y&&Cl(r)!==!1&&Ja(r)),2048&t.$$.dirty[0]&&i(162,tt=V?{...r}:void 0),32&t.$$.dirty[2]|128&t.$$.dirty[5]&&i(164,k=tt&&Zn({...tt},At)),512&t.$$.dirty[5]&&i(166,N=k&&zo(k.text,k)),2560&t.$$.dirty[5]&&(it=k&&In(k.x,k.y,N.width,N.height)),2048&t.$$.dirty[0]|8388608&t.$$.dirty[4]&&i(24,ut=V?r.text:""),2056&t.$$.dirty[0]|32&t.$$.dirty[2]|8388608&t.$$.dirty[4]&&i(165,st=Ge&&r&&V&&Zn({..._n(r),width:ui(r.width)?Math.floor(r.width):void 0,height:ui(r.height)?Math.floor(r.height):void 0},At)),2064&t.$$.dirty[0]|1024&t.$$.dirty[5]&&i(26,mt=V&&((L,rt)=>{const{textAlign:at="left",fontFamily:zt="sans-serif",fontWeight:Dt="normal",fontStyle:Ht="normal",letterSpacing:Ot="normal",textShadowX:Ft=0,textShadowY:Wt=0,textShadowBlur:Kt=0,textShadowColor:ni,textOutlineWidth:pe=0,textOutlineColor:se}=L,ke="!important",xe=`caret-color:${gt};text-align:${at}${ke};font-family:${zt}${ke};font-weight:${Dt}${ke};font-style:${Ht}${ke};letter-spacing:${ui(Ot)?Ot+"px":"normal"}${ke}`;if(rt==="modal")return xe;const Xe=pe?`;-webkit-text-stroke:${2*pe}px ${gr(se)} ${ke}`:"",ei=Kt||Ft||Wt?`;text-shadow:${Ft}px ${Wt}px ${Kt}px ${gr(ni)} ${ke}`:"";let wi=L.fontSize,ci=1,Ii="";wi>1e3&&wa()&&(ci=wi/1e3,Ii=`transform-origin:0 0;transform:scale(${ci})`,wi=1e3);let mn=L.lineHeight/ci;const ji=gr(L.color),zi=.5*Math.max(0,wi-mn);return`--font-scalar:${ci};--bottom-inset:${zi}px;padding:${zi}px 0 0${ke};color:${ji}${ke};font-size:${wi}px${ke};line-height:${mn}px${ke};${xe};${Ii}${Xe}${ei}`})(st,X)),2052&t.$$.dirty[0]|1073741824&t.$$.dirty[1]|4&t.$$.dirty[2]|1024&t.$$.dirty[5]&&i(25,G=V&&((L,rt,at,zt)=>{let Dt,Ht;L.width&&L.height?(Dt=Ti(L),Ht=Fa(L)):(Ht=zo(r.text,l),Ht.width=l.width||Ht.width,Dt=ot(L.x+.5*Ht.width,L.y+.5*Ht.height));const Ot=Math.max(0,L.fontSize-L.lineHeight)+L.lineHeight,Ft=De(Dt);let Wt=Ft.x-rt.x-.5*Ht.width,Kt=Ft.y-rt.y-.5*Ht.height,ni=L.flipX,pe=L.flipY,se=L.rotation;oi&&xt?(ni=!ni,pe=!pe):oi?(ni=!ni,se=-se):xt&&(pe=!pe,se=-se),se+=zt;const ke=at*(ni?-1:1),xe=at*(pe?-1:1);return`--line-height:${Ot}px;width:${Ht.width}px;height:${Ht.height}px;transform:translate(${Wt}px,${Kt}px) rotate(${se}rad) scale(${ke}, ${xe})`})(st,Ee,ge,We)),256&t.$$.dirty[2]&&(gt=yi?gr(yi):"auto"),2320&t.$$.dirty[0]&&V&&Oi&&X==="inline"&&Ei(ut),144703488&t.$$.dirty[4]&&i(151,vt=r&&!c?r:vt),134217728&t.$$.dirty[4]&&i(153,lt=vt&&Fb(vt)),134217728&t.$$.dirty[4]&&i(148,St=vt&&qs(vt)),134217728&t.$$.dirty[4]&&i(150,J=vt&&(L=>L.disableDuplicate!==!0&&vc(L))(vt)),134217728&t.$$.dirty[4]&&i(149,q=vt&&Wm(vt)),134217728&t.$$.dirty[4]&&i(152,Z=vt&&(L=>L.disableReorder!==!0)(vt)),134217728&t.$$.dirty[4]&&i(146,bt=vt&&Cl(vt)!==!1),134217728&t.$$.dirty[4]&&i(154,nt=vt&&Ie(vt,"backgroundImage")&&Xp(vt,"opacity")),8388608&t.$$.dirty[4]&&i(157,$t=r&&r.format==="html"),10485760&t.$$.dirty[4]|4&t.$$.dirty[5]&&i(161,Lt=r&&(!c||$t)),262144&t.$$.dirty[4]|16777280&t.$$.dirty[5]&&Hr.set(Lt&&!bi?1:0,{hard:de===!1}),4096&t.$$.dirty[0]|80&t.$$.dirty[5]&&i(159,ie=Lt&&b.length?(j=nr(b),wo(ot(j.x+.5*j.width,j.y),Bc)):ie),512&t.$$.dirty[0]|64&t.$$.dirty[2]|48&t.$$.dirty[5]&&i(158,Vt=(C||ie)&&on&&Ke&&((L,rt,at,zt)=>{const Dt=L.x,Ht=L.y,Ot=Dt+L.width;let Ft=Math.max(rt.x-.5*at.width,Dt),Wt=Math.max(rt.y-at.height+zt,Ht);return Ft+at.width>Ot&&(Ft=Ot-at.width),ot(Ft,Wt)})(Ke,C||ie,on,-16)),262144&t.$$.dirty[0]|8&t.$$.dirty[5]&&i(23,te=Vt&&`transform: translate(${Vt.x}px, ${Vt.y}px);opacity:${Jt}`),2048&t.$$.dirty[0]&&i(156,Yt=V?"text":"shape"),1088&t.$$.dirty[0]|1073741824&t.$$.dirty[2]|65&t.$$.dirty[3]|2143289344&t.$$.dirty[4]|8388615&t.$$.dirty[5]&&i(22,U=Yt==="text"&&Ne&&$t?Wc(()=>Ne([["div","text-styles",{class:"PinturaShapeControlsGroup"},[...[["bold",{label:"B",style:"font-weight:900;",title:"Bold",shortcut:["CMD","B"]}],["italic",{label:"I",style:"font-family:Times New Roman;font-style:italic;",title:"Italic",shortcut:["CMD","I"]}],["underline",{label:"U",style:"text-decoration:underline;",title:"Underline",shortcut:["CMD","U"]}],["strikeThrough",{label:"S",style:"text-decoration:line-through;",title:"Strikethrough",shortcut:["CMD","S"]}]].map(([L,rt])=>["Button","style-"+L,{onclick:()=>document.execCommand(L),...rt,style:"font-size:1.25em;text-underline-offset:1px;text-decoration-thickness:1.5px;font-weight:400;"+rt.style}])]],["div","text-reset",{class:"PinturaShapeControlsGroup"},[["Button","style-reset",{onclick:()=>document.execCommand("removeFormat"),style:"font-weight:400;",label:'<span style="font-size:1.25em;font-style:italic;font-family:Times New Roman;text-decoration:underline;">T</span><span style="position:relative;top:.175rem;">&times;</span>',title:"Remove styles"}]]]],s)):Yt==="shape"&&He&&s?Wc(()=>He(S?[["div","epsilon",{class:"PinturaShapeControlsGroup"},[["Button","remove-point",{onclick:ss,label:ue.shapeTitleButtonRemove,icon:ue.shapeIconButtonRemove,shortcut:["Backspace"],hideLabel:!0}]]]]:[nt&&["div","alpha",{class:"PinturaShapeControlsGroup"},[["ToggleSlider","adjust-opacity",{onrelease:Jr,onchange:Nr,step:.01,value:Ie(r,"opacity")?r.opacity:1,label:(L,rt,at)=>Math.round(L/at*100)+"%",min:0,max:1,direction:"x"}]]],["div","beta",{class:"PinturaShapeControlsGroup"},[lt&&["Button","flip-horizontal",{onclick:Na,label:ue.shapeTitleButtonFlipHorizontal,icon:ue.shapeIconButtonFlipHorizontal,hideLabel:!0}],lt&&Me&&["Button","flip-vertical",{onclick:Kr,label:ue.shapeTitleButtonFlipVertical,icon:ue.shapeIconButtonFlipVertical,hideLabel:!0}],Z&&["Button","to-front",{onclick:an,label:ue.shapeTitleButtonMoveToFront,icon:ue.shapeIconButtonMoveToFront,hideLabel:!0,disabled:ct[ct.length-1]===vt}],J&&["Button","duplicate",{onclick:Zo,label:ue.shapeTitleButtonDuplicate,icon:ue.shapeIconButtonDuplicate,shortcut:["CMD","D"],hideLabel:!0}],q&&["Button","remove",{onclick:Er,label:ue.shapeTitleButtonRemove,icon:ue.shapeIconButtonRemove,shortcut:["Backspace"],hideLabel:!0}]].filter(Boolean)],bt&&St&&["div","gamma",{class:"PinturaShapeControlsGroup"},[["Button","text-layout",{onclick:Va,label:or(ls,ue,r),icon:or(Uc,ue,r),hideLabel:!0}]]],bt&&["div","delta",{class:"PinturaShapeControlsGroup"},[["Button","edit-text",{label:ue.shapeLabelInputText,onclick:ul}]]]].filter(Boolean),s)):[]),64&t.$$.dirty[0]|8388608&t.$$.dirty[5]&&i(21,Tt=ct.filter(fa).filter(L=>L.id).filter(L=>!eo(L)).map(L=>({id:L.id,color:Yn(L)?L.color:ir(L)?L.strokeColor:L.backgroundColor,name:L.name||ue["shapeLabelTool"+t2(Wb(L))]})))},[we,Bt,Ee,Ge,X,Ni,ue,Jn,Oi,on,s,V,b,l,p,m,w,h,Jt,Ds,Ma,Tt,U,te,ut,G,mt,D,R,g,dr,ki,x=>{const{origin:j}=x.detail;i(141,Mt=void 0),ye=void 0,Mi=void 0,_i=!1,qe=void 0,pn=!1,Vo(),clearTimeout(xi),xi=setTimeout(()=>i(142,bi=!0),250);const L=lo();if(!L||On(L)&&Ie(L,"pathClose")||Rr(),re=Qe(Oe(j)),L&&On(L)&&Ie(L,"pathClose"))return Zt(x);const rt=hr(ct,re,Ye,zt=>fa(zt)),at=rt.length&&rt.shift();if(r&&Ja(r)&&(Oa(),Ze&&(pn=!0)),!at&&r&&Ja(r)&&Ho(r),!!Te(j)){if(at&&ys(at))return _i=!0,i(141,Mt=at),ye=_n(Mt),void(Mi=Zn(_n(Mt),At));qe=at||void 0,!Zt(x)&&at&&(Jn(at),i(141,Mt=at),ye=_n(Mt),Mi=Zn(_n(Mt),At))}},x=>{Hi(),Ut(x)},x=>{const{translation:j,ctrlKey:L,metaKey:rt,shiftKey:at,position:zt}=x.detail;if(Mt){if(!vc(Mt)||Ja(Mt))return;if(at){let Dt=Math.abs(j.x),Ht=Math.abs(j.y);_r==="x"&&(Ht-=64),_r==="y"&&(Dt-=64),Dt>Ht?(j.y=0,_r="x"):Ht>Dt&&(j.x=0,_r="y")}else _r=null;return Or(Mt,Mi,j,{...Hn(L||rt?0:Se,vn,n,Mt)})}H(x)},x=>{if(Hi(),Mt){if(Ja(Mt)&&Ta(),x.detail.isTap&&On(Mt)&&My(Mt)){const{position:j}=x.detail,L=Qe(Oe(j));return void((rt,at)=>{const zt=rt.points,Dt=[];for(let Wt=0;Wt<zt.length-1;Wt++)Dt.push([zt[Wt],zt[Wt+1]]);Dt.push([zt[zt.length-1],zt[0]]);const Ht=Dt.findIndex(([Wt,Kt])=>fu(at,6,Wt,Kt));let Ot;const Ft=[];for(let Wt=0;Wt<Dt.length;Wt++)Ft.push(Dt[Wt][0]),Wt===Ht&&(Ot=Wt+1,Ft.push(at));Gi(rt,{points:Ft,selectedPoint:Ot})})(Mt,L)}x.detail.isTap&&_i&&Yn(Mt)&&Cl(Mt)!==!1&&jn(Mt)}else qt(x)},x=>{const j=qe&&x.detail.isTap;if(x.detail.isTap&&setTimeout(()=>{Fe({target:Mt||qe,position:re},0)}),Mt)return dt(Mt),L=Mt,rt=ye,JSON.stringify(L)!==JSON.stringify(rt)&&Xt(Mt),void i(141,Mt=void 0);var L,rt;const at=po(),zt=!at||Qt(at,qe||void 0);zt&&Wn({storePrevious:!1}),le(x),zt&&j&&Jn(qe)},ti,x=>{i(142,bi=!0),i(141,Mt=r),Mi=l},x=>{if(!Mt)return void i(142,bi=!1);const{translation:j,indexes:L,shiftKey:rt,ctrlKey:at,metaKey:zt,isNudge:Dt}=x.detail;((Ht,Ot,Ft,Wt,Kt)=>{const{shiftKey:ni,snapThreshold:pe=0,gridSize:se=0,gridRect:ke,snapTargets:xe=[]}=Kt||{},Xe=pe?(ei,wi,ci)=>{const{snapTranslation:Ii,snapLines:mn}=Br(tn(ei),xe,pe,se,ke);mr(wi,Ii),Zr(mn);const ji=Ln(ci(),wi);ei.x=ji.x,ei.y=ji.y}:$e;if(ir(Ht)||On(Ht)&&Ie(Ht,"pathClose")){const[ei]=Ft,wi=ni?Xn:(zi,xn)=>xn;let ci,Ii,mn;if(ir(Ht))ei===0?(ci=()=>Qa(Ot),Ii=zi=>wi(ts(Ot),zi),mn=(zi,xn)=>{zi.x1=xn.x,zi.y1=xn.y}):ei===1&&(ci=()=>ts(Ot),Ii=zi=>wi(Qa(Ot),zi),mn=(zi,xn)=>{zi.x2=xn.x,zi.y2=xn.y});else{const zi=Ot.points;ci=()=>({...zi[ei]}),Ii=xn=>{const Yi=zi[Tu(ei-1,zi)],Un=zi[Tu(ei+1,zi)];wi(Yi,xn),wi(Un,xn)},mn=(xn,Yi)=>xn.points=xn.points.map((Un,sn)=>ei===sn?Yi:Un)}const ji=Ln(ci(),Wt);Xe(ji,Wt,ci),Ii(ji),mn(Ht,ji)}else if(el(Ht)||qn(Ht)||lu(Ht)){let ei,wi,ci=!1;if(qn(Ht))ei=cp(Ot);else if(el(Ht))ei=fs(Ot);else{ci=!0,ei=fs(Ot);const Yi=zo(Ot.text,Ot);ei.height=Yi.height}Ht.aspectRatio?wi=Ht.aspectRatio:Kt.shiftKey&&!ci&&(wi=ei.width/ei.height);const Ii=fs(ei),mn=Ti(Ii),ji=Ht.rotation,zi=Bo(Ii),xn=$r(Ii,ji);if(Ft.length===1){let Yi=Ft[0];Ht.flipX&&(Yi=da[Yi]),Ht.flipY&&(Yi=Co[Yi]);const[Un,sn,jr,kr]=zi,Qr=De(xn[Yi]),Ua=Fn({...Qr},Wt),Ga=Qe(Ua);Xe(Ga,Wt,()=>Qe(Qr));const Bs=ot(Ga.x-xn[Yi].x,Ga.y-xn[Yi].y),cs=Lr(Oe(Bs),-ji),Xo=ot(zi[Yi].x+cs.x,zi[Yi].y+cs.y);let Po;Yi===0&&(Po=jr),Yi===1&&(Po=kr),Yi===2&&(Po=Un),Yi===3&&(Po=sn);const Ro=nr([Po,Xo]);if(wi){const{width:us,height:Ws}=Ur(Ro,wi),[jl,Pa,Za,Qn]=al(Ro);Ro.width=us,Ro.height=Ws,Xo.y<Po.y&&(Ro.y=Za-Ws),Xo.x<Po.x&&(Ro.x=Pa-us)}const ds=$r(Ro,ji,mn),ma=Fo(ds),Os=Lr(ds[0],-ji,ma),Io=Lr(ds[2],-ji,ma),$a=nr([Os,Io]);wn(Ht,qn(Ht)?mm($a):$a,At)}else{Ft=Ft.map(Qn=>(Ht.flipX&&(Qn=da[Qn]),Ht.flipY&&(Qn=Co[Qn]),Qn));const[Yi,Un]=Ft.map(Qn=>xn[Qn]),sn={x:Yi.x+.5*(Un.x-Yi.x),y:Yi.y+.5*(Un.y-Yi.y)},[jr,kr]=Ft.map(Qn=>zi[Qn]),[Qr,Ua]=Ft.map(Qn=>{const to=Qn+2;return to<4?zi[to]:zi[to-4]}),Ga={x:Qr.x+.5*(Ua.x-Qr.x),y:Qr.y+.5*(Ua.y-Qr.y)},Bs=De(sn),cs=Fn({...Bs},Wt),Xo=Qe(cs);Xe(Xo,Wt,()=>Qe(Bs));const Po=ot(Xo.x-sn.x,Xo.y-sn.y),Ro=Lr(Oe(Po),-ji),ds=Dn(Oe(jr),kr),ma=wo(ds,Qn=>1-Math.abs(Math.sign(Qn))),Os=ot(Ro.x*ma.x,Ro.y*ma.y);Fn(jr,Os),Fn(kr,Os);const Io=nr(zi);if(wi){let Qn=Io.width,to=Io.height;ma.y===0?to=Qn/wi:Qn=to*wi,Io.width=Qn,Io.height=to,ma.y===0?Io.y=Ga.y-.5*to:Io.x=Ga.x-.5*Qn}const $a=$r(Io,ji,mn),us=Fo($a),Ws=Lr($a[0],-ji,us),jl=Lr($a[2],-ji,us),Pa=nr([Ws,jl]);let Za;qn(Ht)?Za=mm(Pa):el(Ht)?Za=Pa:ci&&(Za={x:Pa.x,y:Pa.y,width:Pa.width}),wn(Ht,Za,At)}}Sn()})(Mt,Mi,L,j,{shiftKey:!Dt&&rt,...Hn(at||zt?0:Se,vn,n,Mt)}),gp(Mt)&&bo(j)>16&&Gi(Mt,{selectedPoint:void 0})},x=>{if(!Mt)return void i(142,bi=!1);Jn(Mt);const{isTap:j,translation:L,indexes:rt}=x.detail;j&&(gp(Mt)&&Gi(Mt,{selectedPoint:Mt.selectedPoint===rt[0]?void 0:rt[0]}),dt(Mt)),i(141,Mt=void 0),i(142,bi=!1),Xt(r)},x=>{To=Ba(l).origin,i(142,bi=!0),i(141,Mt=r),Mi=l},x=>{if(!Mt)return void i(142,bi=!1);const{translation:j,shiftKey:L}=x.detail;((rt,at,zt,Dt)=>{const Ht=Rn(Zn(_n(rt),At)),Ot=Ti(Ht),Ft=Ln(To,zt);let Wt=Vd(Ft,Ot)+Math.PI/2;if(Dt.shiftKey){const Kt=Math.PI/16;Wt=Kt*Math.round(Wt/Kt)-We%Kt}wn(rt,{rotation:Wt},At),Sn()})(Mt,0,j,{shiftKey:L})},()=>{Mt?(Jn(Mt),i(141,Mt=void 0),i(142,bi=!1),Xt(r)):i(142,bi=!1)},x=>{const{key:j}=x,L=/escape/i.test(j);if(uo())return L?(x.preventDefault(),x.stopPropagation(),Ho(r)):void(J&&j==="d"&&(x.metaKey||x.ctrlKey)&&(x.preventDefault(),x.stopPropagation(),Ha()))},x=>{const j=Cl(r,x);return j===!0?x:j},Uo,x=>{const{target:j,key:L}=x,rt=j.value||j.innerText,at=j.selectionStart||0,zt=j.selectionEnd||rt.length,Dt=rt.substring(0,at)+L+rt.substring(zt);if(Cl(r,Dt)!==Dt)return x.preventDefault()},x=>bu(r)&&/enter/i.test(x.code)&&r.disableNewline!==!1?x.preventDefault():/arrow/i.test(x.code)?x.stopPropagation():/escape/i.test(x.key)?Ta():void 0,x=>{const{key:j,ctrlKey:L,altKey:rt}=x;if(/enter/i.test(j)&&(L||rt))return Oa()},Oa,Ta,Hr,x=>{const j=Sr();j&&(Ja(j)||vc(j)&&(i(141,Mt=j),Mi=Zn(_n(Mt),At),Or(Mt,Mi,x.detail)))},x=>{i(19,Ds=!0)},({relatedTarget:x})=>{x&&x.classList.contains("shape-selector__button")||i(19,Ds=!1)},x=>{if(x.pointerType==="touch"||x.target.className!=="PinturaShapeEditor")return void Nt();(bi||xi)&&xo(void 0);const j=hh(x,Ge);i(144,ha=Oe(j));const L=wo(Qe(j),at=>Math.round(at));if(xs(L,ja)||(ja=Oe(L),ne(bi,j,L),bi||xi)||c)return;const[rt]=hr(ct,L,0,fa);rt&&eo(rt)||xo(rt)},x=>{x.pointerType!=="touch"&&Nt()},Ce,pi,Ae,We,oi,xt,ge,Ue,ze,At,Ke,gi,yi,Li,Si,Zt,H,qt,le,Ut,fe,Xt,Le,Je,_e,dt,jt,ne,Fe,Nt,K,Qt,Gt,oe,He,Ne,Te,Qe,De,ce,Ye,Me,Ze,Se,dn,bn,vn,oo,Pn,br,yn,ao,Qi,Gr,(x,j={})=>{let L,rt,at,zt=qn(x),Dt=Yn(x),Ht=j.position==="relative";const Ot=Nn(),Ft=pe=>{if(!Se)return pe;const se=Qe(pe),{snapTranslation:ke,snapLines:xe}=Br(tn(se),Ot,Se,vn,n);return mr(pe,ke),Zr(xe),pe},Wt=!!po(),Kt=j.isSelection?Ae:Bt,ni=j.inputMode==="step";if(On(x)){if(ni){let pe=!1;const se=(ke,xe)=>{const Xe=Pn(Kt),ei=ke&&ot(nu(ke.x,At.width),nu(ke.y,At.height)),wi=ei&&De(ei);ee.includes(16)&&wi&&Xn(wi,xe);const ci=Qe(xe),Ii=Xe.points.length?Xe.points[0]:ci,mn=ot(nu(Ii.x,At.width),nu(Ii.y,At.height)),ji=De(mn),zi=bo(ji,xe);if(!pe&&Xe.points.length===1&&zi<36)return yn(Kt);if(Xe.points.length>2&&zi<=256){Xe.pathClose=!0,fa(Xe)&&Jn(Xe);const Un=ao(Kt);return void fe(Un)}const xn=Xe.strokeWidth&&Xe.strokeColor&&(Xe.strokeColor[3]===void 0||Xe.strokeColor[3]>0),Yi=bo(wi,xe);if(xn&&Xe.points.length>1&&Yi<256){Xe.pathClose=!1,Xe.backgroundColor=[0,0,0,0],fa(Xe)&&Jn(Xe);const Un=ao(Kt);fe(Un)}else if(!(Xe.points.length>0&&Yi<100))return Ht?bc(ci,At):ci};return{start:ke=>{const xe=Pn(Kt),{origin:Xe}=ke.detail;if(rt=4,L=Ft(Oe(Xe)),at=Oe(L),xe){const ei=xe.points[xe.points.length-1],wi=se(ei,L);return wi&&(xe.points=[...xe.points,wi]),void Qi({points:xe.points},Kt)}pe=!0},update:ke=>{if(!pe)return;const xe=Pn(Kt);if(!xe)return;const Xe=xe.points[0],ei=se(Xe,ot(L.x+ke.detail.translation.x,L.y+ke.detail.translation.y));ei&&(xe.points[1]=ei,Qi({points:xe.points},Kt))},release:ke=>ke.detail.preventInertia(),cancel:()=>{yn(Kt)},end:ke=>{if(!pe)return;const xe=Qe(L),Xe=Ht?bc(xe,At):xe,{isTap:ei}=ke.detail;if(ei&&hr(ct,xe,0,fa).length)return yn(Kt);br({...x,points:[Xe]},Kt)}}}return{start:pe=>{const{origin:se}=pe.detail;rt=4,L=Oe(se),at=Oe(L);const ke=Qe(L),xe=Ht?bc(ke,At):ke;br({...x,points:[xe]},Kt)},update:pe=>{const se=Pn(Kt);if(!se)return;const{translation:ke}=pe.detail,xe=ot(L.x+ke.x,L.y+ke.y),Xe=$o(at,xe);if(ai(Xe,5)<=rt)return;const ei=Vd(xe,at),wi=rt-Xe;at.x+=wi*Math.cos(ei),at.y+=wi*Math.sin(ei);const ci=Qe(at),Ii=Ht?bc(ci,At):ci;Qi({points:se.points.concat(Ii)},Kt)},release:pe=>pe.detail.preventInertia(),cancel:()=>{yn(Kt)},end:pe=>{const se=Pn(Kt);if(!se)return;if(pe.detail.isTap){let xe=!1;if(se.bitmap?(qe&&(xe=!0),Wt&&(xe=!0)):xe=!0,xe)return yn(Kt)}const ke=ao(Kt);fe(ke)}}}return zt||Dt||vo(x)?{start:pe=>{const{origin:se}=pe.detail;L=Ft(Oe(se));const ke=Qe(L),xe=Ht?bc(ke,At):ke,Xe=-1*_o(We,oi,xt),ei={...x,rotation:Xe,...xe};ei.flipX=oi,ei.flipY=xt,delete ei.position,ei.opacity=0,(zt?["rx","ry"]:["width","height"]).forEach(wi=>{ei[wi]=Ht?"0%":0}),br(ei,Kt)},update:pe=>{const se=Pn(Kt);if(!se)return;se.opacity=1;let{aspectRatio:ke}=se,{translation:xe,shiftKey:Xe,ctrlKey:ei}=pe.detail;!ke&&Xe&&(ke=1);const wi=Ft(ot(L.x+xe.x,L.y+xe.y)),ci=Qe(L),Ii=Qe(wi);if(ke){const jr=nr([ci,Ii]),kr=Ur(jr,ke),Qr=Ii.x<ci.x?-1:1,Ua=Ii.y<ci.y?-1:1;Ii.x=ci.x+kr.width*Qr,Ii.y=ci.y+kr.height*Ua}const mn={x:ci.x+.5*(Ii.x-ci.x),y:ci.y+.5*(Ii.y-ci.y)},ji=_o(We,oi,xt);Lr(ci,ji,mn),Lr(Ii,ji,mn);const zi=Math.min(ci.x,Ii.x),xn=Math.min(ci.y,Ii.y);let Yi=Math.max(ci.x,Ii.x)-zi,Un=Math.max(ci.y,Ii.y)-xn,sn={};zt?(ei?(sn.x=ci.x,sn.y=ci.y):(sn.x=zi+.5*Yi,sn.y=xn+.5*Un),sn.rx=.5*Yi,sn.ry=.5*Un):(ei?(sn.x=ci.x-.5*Yi,sn.y=ci.y-.5*Un):(sn.x=zi,sn.y=xn),sn.width=Yi,sn.height=Un),Qi(sn,Kt,(jr,kr)=>wn(jr,kr,At))},release:pe=>{pe.detail.preventInertia()},cancel:()=>{yn(Kt)},end:pe=>{const se=Pn(Kt);if(se){if(pe.detail.isTap){if(Yn(se)&&Ze&&pn||!Yn(se)||!Ze||qe)return yn(Kt);delete se.width,delete se.height,se.disableNewline!==!1&&delete se.textAlign;const ke=Zn({...se},At),xe=zo(se.text,ke),Xe=Qe({x:L.x,y:L.y-.5*xe.height}),ei=Qe({x:L.x+xe.width,y:L.y+.5*xe.height}),wi={x:Xe.x+.5*(ei.x-Xe.x),y:Xe.y+.5*(ei.y-Xe.y)},ci=_o(We,oi,xt);Lr(Xe,ci,wi),Lr(ei,ci,wi);let Ii=Math.min(Xe.x,ei.x),mn=Math.min(Xe.y,ei.y);Ii<0&&(Ii=0),mn<0&&(mn=0),Ii+xe.width>At.width&&(Ii=At.width-xe.width),mn+xe.height>At.height&&(mn=At.height-xe.height),se.x=Ve(se.x)?Ar(Ii,At.width):Ii,se.y=Ve(se.y)?Ar(mn,At.height):mn}if(se.opacity=1,Yn(se))fe(se);else{const ke=ao(Kt);fe(ke)}fa(se)&&Jn(se),Yn(se)&&jn(se)}}}:ir(x)?{start:pe=>{const{origin:se}=pe.detail,ke=Qe(Ft(se)),xe=wo(ke,Bc);L=Oe(se),br({...x,x1:Ht?Ar(xe.x,At.width):xe.x,y1:Ht?Ar(xe.y,At.height):xe.y,x2:Ht?Ar(xe.x,At.width):xe.x,y2:Ht?Ar(xe.y,At.height):xe.y,opacity:0},Kt)},update:pe=>{if(!Pn(Kt))return;const{translation:se}=pe.detail,ke=Ft(Fn(Oe(L),se));if(ee.includes(16)){const Xe=$o(L,ke),ei=Vd(L,ke),wi=Math.PI/4,ci=wi*Math.round(ei/wi);ke.x=L.x+Xe*Math.cos(ci),ke.y=L.y+Xe*Math.sin(ci)}const xe=Qe(ke);Qi({x2:Ht?Ar(xe.x,At.width):xe.x,y2:Ht?Ar(xe.y,At.height):xe.y,opacity:1},Kt)},release:pe=>pe.detail.preventInertia(),cancel:()=>{yn(Kt)},end:pe=>{const se=Pn(Kt);if(!se)return;if(pe.detail.isTap)return yn(Kt);se.opacity=1;const ke=ao(Kt);fe(ke),fa(se)&&Jn(ke)}}:void 0},()=>{let x,j;const L=ce*ce,rt=(at,zt,Dt=!1)=>{const Ht=bo(at,zt);if(!Dt&&Ht<2)return!1;const Ot=ct.filter(Wt=>!Wt.disableErase);let Ft;return Ft=Ht<L?hr(ct,Qe(zt),ce):O(Ot,Qe(at),Qe(zt),ce),ho(Ft).forEach(_e),!0};return{start:at=>{x=ot(Math.round(at.detail.origin.x),Math.round(at.detail.origin.y)),rt(x,x,!0),j=x},update:at=>{const{translation:zt}=at.detail,Dt=ot(Math.round(x.x+zt.x),Math.round(x.y+zt.y));rt(j,Dt)&&(j=Oe(Dt))},release:at=>at.detail.preventInertia(),cancel:()=>{yn(collection)},end:()=>{}}},lo,vr,x=>{if(!lo())return Zp(x),Gr(x)},Rr,co,(x={})=>({id:na(),...x}),Sn,Di,Gi,wr,(x,j,L=!0)=>{ct.forEach(rt=>wr(rt,x,j,!1)),L&&Sn()},en,Sr,uo,Xr,ur,Wn,Ho,jn,zn,ho,Yr,Rn,hr,O,so,fo,Mt,bi,Vr,ha,c,bt,r,St,q,J,vt,Z,lt,nt,S,Yt,$t,Vt,ie,C,Lt,tt,a,k,st,N,y,B,n,T,F,W,f,M,d,o,u,ct,de,ee,be,function(x){Dr.call(this,t,x)},x=>Jn(Bt[x]),function(x){Fi[x?"unshift":"push"](()=>{Oi=x,i(8,Oi)})},function(){ut=this.value,i(24,ut),i(11,V),i(147,r),i(167,y),i(0,we),i(178,ct)},function(x){Fi[x?"unshift":"push"](()=>{Oi=x,i(8,Oi)})},()=>{Ma&&Ma.focus()},x=>i(9,on=x.detail),function(x){Fi[x?"unshift":"push"](()=>{Ma=x,i(20,Ma)})},x=>hh(x,Ge)]}class ZS extends li{constructor(e){super(),si(this,e,GS,US,ri,{uid:58,ui:59,disabled:0,shapes:1,selection:60,offset:2,contextRotation:61,contextFlipX:62,contextFlipY:63,contextZoom:64,active:65,opacity:66,parentRect:67,rootRect:3,utilRect:68,hoverColor:69,caretColor:70,gridColor:71,snapColor:72,textInputMode:4,oninteractionstart:73,oninteractionupdate:74,oninteractionrelease:75,oninteractionend:76,oninteractioncancel:77,onaddshape:78,onupdateshape:79,onselectshape:80,onblurshape:81,onremoveshape:82,ontapshape:83,onhovershape:84,onhovercanvas:85,ontapcanvas:86,onleavecanvas:87,beforeSelectShape:88,beforeDeselectShape:89,beforeRemoveShape:90,beforeUpdateShape:91,willRenderShapeControls:92,willRenderShapeTextControls:93,willStartInteraction:94,mapEditorPointToImagePoint:95,mapImagePointToEditorPoint:96,eraseRadius:97,selectRadius:98,enableButtonFlipVertical:99,enableTapToAddText:100,enableTextStyleControls:5,locale:6,snapThreshold:101,snapPointer:102,enableSnapToContext:103,gridSize:104,syncShapeCollection:105,getShapeDraft:106,addShapeDraft:107,discardShapeDraft:108,confirmShapeDraft:109,updateShapeDraft:110,addShape:111,createShape:112,eraseShape:113,getMarkupItemDraft:114,getMarkupItemDraftIndex:115,addMarkupItemDraft:116,confirmMarkupItemDraft:117,discardMarkupItemDraft:118,createMarkupItem:119,syncShapes:120,removeMarkupShapeProps:121,updateMarkupShape:122,updateMarkupShapeProperty:123,updateMarkupItemsShapeProperty:124,updateMarkupShapeItems:125,getActiveMarkupItem:126,hasActiveMarkupItem:127,removeShape:128,removeActiveMarkupItem:129,blurShapes:130,selectShape:7,deselectMarkupItem:131,editMarkupItem:132,finishEditMarkupItem:133,removeMarkupItems:134,getTextShapeRect:135,getMarkupShapeRect:136,getShapesNearPosition:137,getShapesBetweenPoints:138},null,[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1])}get syncShapeCollection(){return this.$$.ctx[105]}get getShapeDraft(){return this.$$.ctx[106]}get addShapeDraft(){return this.$$.ctx[107]}get discardShapeDraft(){return this.$$.ctx[108]}get confirmShapeDraft(){return this.$$.ctx[109]}get updateShapeDraft(){return this.$$.ctx[110]}get addShape(){return this.$$.ctx[111]}get createShape(){return this.$$.ctx[112]}get eraseShape(){return this.$$.ctx[113]}get getMarkupItemDraft(){return this.$$.ctx[114]}get getMarkupItemDraftIndex(){return this.$$.ctx[115]}get addMarkupItemDraft(){return this.$$.ctx[116]}get confirmMarkupItemDraft(){return this.$$.ctx[117]}get discardMarkupItemDraft(){return this.$$.ctx[118]}get createMarkupItem(){return this.$$.ctx[119]}get syncShapes(){return this.$$.ctx[120]}get removeMarkupShapeProps(){return this.$$.ctx[121]}get updateMarkupShape(){return this.$$.ctx[122]}get updateMarkupShapeProperty(){return this.$$.ctx[123]}get updateMarkupItemsShapeProperty(){return this.$$.ctx[124]}get updateMarkupShapeItems(){return this.$$.ctx[125]}get getActiveMarkupItem(){return this.$$.ctx[126]}get hasActiveMarkupItem(){return this.$$.ctx[127]}get removeShape(){return this.$$.ctx[128]}get removeActiveMarkupItem(){return this.$$.ctx[129]}get blurShapes(){return this.$$.ctx[130]}get selectShape(){return this.$$.ctx[7]}get deselectMarkupItem(){return this.$$.ctx[131]}get editMarkupItem(){return this.$$.ctx[132]}get finishEditMarkupItem(){return this.$$.ctx[133]}get removeMarkupItems(){return this.$$.ctx[134]}get getTextShapeRect(){return this.$$.ctx[135]}get getMarkupShapeRect(){return this.$$.ctx[136]}get getShapesNearPosition(){return this.$$.ctx[137]}get getShapesBetweenPoints(){return this.$$.ctx[138]}}function XS(t){let e,i,n;return i=new ro({props:{items:t[2]}}),{c(){e=ht("ul"),Et(i.$$.fragment),v(e,"class","PinturaShapeStyleList")},m(r,o){et(r,e,o),Rt(i,e,null),n=!0},p(r,o){const a={};4&o&&(a.items=r[2]),i.$set(a)},i(r){n||(P(i.$$.fragment,r),n=!0)},o(r){z(i.$$.fragment,r),n=!1},d(r){r&&Q(e),It(i)}}}function YS(t){let e,i;return e=new ka({props:{class:"PinturaShapeStyles",elasticity:t[0],$$slots:{default:[qS]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};1&r&&(o.elasticity=n[0]),131076&r&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function qS(t){let e,i,n;return i=new ro({props:{items:t[2]}}),{c(){e=ht("ul"),Et(i.$$.fragment),v(e,"class","PinturaShapeStyleList")},m(r,o){et(r,e,o),Rt(i,e,null),n=!0},p(r,o){const a={};4&o&&(a.items=r[2]),i.$set(a)},i(r){n||(P(i.$$.fragment,r),n=!0)},o(r){z(i.$$.fragment,r),n=!1},d(r){r&&Q(e),It(i)}}}function KS(t){let e,i,n,r;const o=[YS,XS],a=[];function s(l,c){return l[1]?0:1}return i=s(t),n=a[i]=o[i](t),{c(){e=ht("div"),n.c(),v(e,"style",t[3])},m(l,c){et(l,e,c),a[i].m(e,null),r=!0},p(l,[c]){let d=i;i=s(l),i===d?a[i].p(l,c):(Pe(),z(a[d],1,1,()=>{a[d]=null}),Re(),n=a[i],n?n.p(l,c):(n=a[i]=o[i](l),n.c()),P(n,1),n.m(e,null)),(!r||8&c)&&v(e,"style",l[3])},i(l){r||(P(n),r=!0)},o(l){z(n),r=!1},d(l){l&&Q(e),a[i].d()}}}function JS(t,e,i){let n,r,o,a,s,l,{isActive:c=!1}=e,{controls:d=[]}=e,{locale:u}=e,{scrollElasticity:p}=e,{scrollEnable:h=!0}=e,{hideTitles:g=!1}=e,{willRenderControls:m=Ji}=e;const f=un("redrawTrigger");E(t,f,C=>i(14,a=C));const b=un("env");E(t,b,C=>i(13,o=C));const w=un("isAnimated");E(t,w,C=>i(16,l=C));const S=di(0,{stiffness:.25,damping:.9});return E(t,S,C=>i(15,s=C)),t.$$set=C=>{"isActive"in C&&i(8,c=C.isActive),"controls"in C&&i(9,d=C.controls),"locale"in C&&i(10,u=C.locale),"scrollElasticity"in C&&i(0,p=C.scrollElasticity),"scrollEnable"in C&&i(1,h=C.scrollEnable),"hideTitles"in C&&i(11,g=C.hideTitles),"willRenderControls"in C&&i(12,m=C.willRenderControls)},t.$$.update=()=>{65792&t.$$.dirty&&S.set(c?1:0,{hard:l===!1}),33024&t.$$.dirty&&i(3,n=`opacity:${s};${c?"":"pointer-events:none;"}${s<=0?"visibility:hidden":""}`),32256&t.$$.dirty&&i(2,r=a&&m(d.map(C=>["ShapeStyle",C.id,{title:C.componentProps.title,locale:u,hideTitle:g,items:[[C.component,C.id,C.componentProps]]}]),o,()=>f.set({})))},[p,h,r,n,f,b,w,S,c,d,u,g,m,o,a,s,l]}class QS extends li{constructor(e){super(),si(this,e,JS,KS,ri,{isActive:8,controls:9,locale:10,scrollElasticity:0,scrollEnable:1,hideTitles:11,willRenderControls:12})}}function Tf(t,e,i){const n=t.slice();return n[15]=e[i].key,n[6]=e[i].controls,n[16]=e[i].isActive,n}function Mf(t,e){let i,n,r;return n=new QS({props:{isActive:e[16],controls:e[6],locale:e[1],scrollElasticity:e[2],scrollEnable:e[3],hideTitles:e[4],willRenderControls:e[5]}}),{key:t,first:null,c(){i=Mn(),Et(n.$$.fragment),this.first=i},m(o,a){et(o,i,a),Rt(n,o,a),r=!0},p(o,a){e=o;const s={};128&a&&(s.isActive=e[16]),128&a&&(s.controls=e[6]),2&a&&(s.locale=e[1]),4&a&&(s.scrollElasticity=e[2]),8&a&&(s.scrollEnable=e[3]),16&a&&(s.hideTitles=e[4]),32&a&&(s.willRenderControls=e[5]),n.$set(s)},i(o){r||(P(n.$$.fragment,o),r=!0)},o(o){z(n.$$.fragment,o),r=!1},d(o){o&&Q(i),It(n,o)}}}function t6(t){let e,i,n,r=[],o=new Map,a=t[7];const s=l=>l[15];for(let l=0;l<a.length;l+=1){let c=Tf(t,a,l),d=s(c);o.set(d,r[l]=Mf(d,c))}return{c(){e=ht("div");for(let l=0;l<r.length;l+=1)r[l].c();v(e,"class",i=$i(["PinturaShapeStyleEditor",!t[3]&&"PinturaShapeStyleEditorOverflow",t[0]]))},m(l,c){et(l,e,c);for(let d=0;d<r.length;d+=1)r[d].m(e,null);n=!0},p(l,[c]){190&c&&(a=l[7],Pe(),r=Da(r,c,s,1,l,a,o,e,As,Mf,null,Tf),Re()),(!n||9&c&&i!==(i=$i(["PinturaShapeStyleEditor",!l[3]&&"PinturaShapeStyleEditorOverflow",l[0]])))&&v(e,"class",i)},i(l){if(!n){for(let c=0;c<a.length;c+=1)P(r[c]);n=!0}},o(l){for(let c=0;c<r.length;c+=1)z(r[c]);n=!1},d(l){l&&Q(e);for(let c=0;c<r.length;c+=1)r[c].d()}}}function e6(t,e,i){let n,r,o,{class:a}=e,{controls:s={}}=e,{shape:l}=e,{onchange:c}=e,{locale:d}=e,{scrollElasticity:u}=e,{scrollEnable:p=!0}=e,{hideTitles:h=!1}=e,{willRenderControls:g}=e;const m=[];return t.$$set=f=>{"class"in f&&i(0,a=f.class),"controls"in f&&i(6,s=f.controls),"shape"in f&&i(8,l=f.shape),"onchange"in f&&i(9,c=f.onchange),"locale"in f&&i(1,d=f.locale),"scrollElasticity"in f&&i(2,u=f.scrollElasticity),"scrollEnable"in f&&i(3,p=f.scrollEnable),"hideTitles"in f&&i(4,h=f.hideTitles),"willRenderControls"in f&&i(5,g=f.willRenderControls)},t.$$.update=()=>{64&t.$$.dirty&&i(11,n=Object.keys(s).filter(f=>s[f])),2304&t.$$.dirty&&i(10,r=l&&Object.keys(l).length&&n&&Xp(l)?(f=>n.filter(b=>b.split("_").every(w=>Ie(f,w)&&Xp(f,w))).map(b=>{const w=(f.settings&&f.settings[b]||{}).control||b,S=b.split("_"),C=S.length>1?S.map(T=>f[T]):f[b];if(cn(s[w])){const{title:T,component:F}=s[w](C,W=>{c({[b]:W})},{selectedShapeId:f.id});return{id:w,component:ro,componentProps:{title:T,items:F}}}let[R,M]=s[w];if(Ve(R)&&s[R]){const T={...M};[R,M]=s[R],M={...M,...T}}const D=cn(M.options)?M.options(f):M.options;return R==="RadioGroup"&&(M.selectedIndex=-1),{id:w,component:R,componentProps:{...M,options:D,locale:d,value:C,optionLabelClass:"PinturaButtonLabel",onchange:T=>{const F=sl(T)&&!En(T)?T.value:T;M.onchange&&M.onchange(F,f);const W=S.length>1?S.reduce((B,y,V)=>({...B,[y]:Array.isArray(F)?F[V]:F}),{}):{[b]:F};c(W)}}}}).filter(Boolean))(l):[]),1280&t.$$.dirty&&i(7,o=((f,b)=>{let w=m.find(S=>S.key===f);return w||(w={key:f,controls:b},m.push(w)),m.forEach(S=>S.isActive=!1),w.controls=b,w.isActive=!0,m})(l&&Object.keys(l).length?Object.keys(l).join("_"):"none",r||[]))},[a,d,u,p,h,g,s,o,l,c,r,n]}class _u extends li{constructor(e){super(),si(this,e,e6,t6,ri,{class:0,controls:6,shape:8,onchange:9,locale:1,scrollElasticity:2,scrollEnable:3,hideTitles:4,willRenderControls:5})}}var tx=t=>/<svg /.test(t);function i6(t){let e,i;return e=new ro({props:{items:t[10]}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};1024&r&&(o.items=n[10]),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function n6(t){let e,i,n,r;const o=[o6,r6],a=[];function s(l,c){return l[8]?0:1}return e=s(t),i=a[e]=o[e](t),{c(){i.c(),n=Mn()},m(l,c){a[e].m(l,c),et(l,n,c),r=!0},p(l,c){let d=e;e=s(l),e===d?a[e].p(l,c):(Pe(),z(a[d],1,1,()=>{a[d]=null}),Re(),i=a[e],i?i.p(l,c):(i=a[e]=o[e](l),i.c()),P(i,1),i.m(n.parentNode,n))},i(l){r||(P(i),r=!0)},o(l){z(i),r=!1},d(l){a[e].d(l),l&&Q(n)}}}function r6(t){let e,i,n,r,o=t[10]&&Pf(t);return n=new ka({props:{scrollAutoCancel:t[9],elasticity:t[0],$$slots:{default:[a6]},$$scope:{ctx:t}}}),{c(){e=ht("div"),o&&o.c(),i=me(),Et(n.$$.fragment),v(e,"class","PinturaShapePresetsFlat")},m(a,s){et(a,e,s),o&&o.m(e,null),kt(e,i),Rt(n,e,null),r=!0},p(a,s){a[10]?o?(o.p(a,s),1024&s&&P(o,1)):(o=Pf(a),o.c(),P(o,1),o.m(e,i)):o&&(Pe(),z(o,1,1,()=>{o=null}),Re());const l={};512&s&&(l.scrollAutoCancel=a[9]),1&s&&(l.elasticity=a[0]),536871070&s&&(l.$$scope={dirty:s,ctx:a}),n.$set(l)},i(a){r||(P(o),P(n.$$.fragment,a),r=!0)},o(a){z(o),z(n.$$.fragment,a),r=!1},d(a){a&&Q(e),o&&o.d(),It(n)}}}function o6(t){let e,i,n,r,o;i=new ka({props:{elasticity:t[0],class:"PinturaShapePresetsGroups",$$slots:{default:[c6]},$$scope:{ctx:t}}});const a=[{class:"PinturaControlPanels"},{panelClass:"PinturaControlPanel"},{panels:t[11]},t[12]];let s={$$slots:{default:[u6,({panel:l,panelIsActive:c})=>({26:l,27:c}),({panel:l,panelIsActive:c})=>(l?67108864:0)|(c?134217728:0)]},$$scope:{ctx:t}};for(let l=0;l<a.length;l+=1)s=Tn(s,a[l]);return r=new Du({props:s}),{c(){e=ht("div"),Et(i.$$.fragment),n=me(),Et(r.$$.fragment),v(e,"class","PinturaShapePresetsGrouped")},m(l,c){et(l,e,c),Rt(i,e,null),kt(e,n),Rt(r,e,null),o=!0},p(l,c){const d={};1&c&&(d.elasticity=l[0]),536876128&c&&(d.$$scope={dirty:c,ctx:l}),i.$set(d);const u=6144&c?yr(a,[a[0],a[1],2048&c&&{panels:l[11]},4096&c&&Pr(l[12])]):{};738206239&c&&(u.$$scope={dirty:c,ctx:l}),r.$set(u)},i(l){o||(P(i.$$.fragment,l),P(r.$$.fragment,l),o=!0)},o(l){z(i.$$.fragment,l),z(r.$$.fragment,l),o=!1},d(l){l&&Q(e),It(i),It(r)}}}function Pf(t){let e,i;return e=new ro({props:{items:t[10]}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};1024&r&&(o.items=n[10]),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function a6(t){let e,i;return e=new Yh({props:{items:t[7],onclickitem:t[1],ongrabitem:t[2],ondragitem:t[3],ondropitem:t[4]}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};128&r&&(o.items=n[7]),2&r&&(o.onclickitem=n[1]),4&r&&(o.ongrabitem=n[2]),8&r&&(o.ondragitem=n[3]),16&r&&(o.ondropitem=n[4]),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function Rf(t){let e,i;return e=new ro({props:{items:t[10]}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};1024&r&&(o.items=n[10]),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function If(t){let e,i;return e=new ko({props:{$$slots:{default:[s6]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};805306368&r&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function s6(t){let e,i=t[28].icon+"";return{c(){e=fr("g")},m(n,r){et(n,e,r),e.innerHTML=i},p(n,r){268435456&r&&i!==(i=n[28].icon+"")&&(e.innerHTML=i)},d(n){n&&Q(e)}}}function Ef(t){let e,i,n=t[28].label+"";return{c(){e=ht("span"),i=$n(n)},m(r,o){et(r,e,o),kt(e,i)},p(r,o){268435456&o&&n!==(n=r[28].label+"")&&An(i,n)},d(r){r&&Q(e)}}}function l6(t){let e,i,n,r=t[28].icon&&If(t),o=!t[28].hideLabel&&Ef(t);return{c(){r&&r.c(),e=me(),o&&o.c(),i=Mn()},m(a,s){r&&r.m(a,s),et(a,e,s),o&&o.m(a,s),et(a,i,s),n=!0},p(a,s){a[28].icon?r?(r.p(a,s),268435456&s&&P(r,1)):(r=If(a),r.c(),P(r,1),r.m(e.parentNode,e)):r&&(Pe(),z(r,1,1,()=>{r=null}),Re()),a[28].hideLabel?o&&(o.d(1),o=null):o?o.p(a,s):(o=Ef(a),o.c(),o.m(i.parentNode,i))},i(a){n||(P(r),n=!0)},o(a){z(r),n=!1},d(a){r&&r.d(a),a&&Q(e),o&&o.d(a),a&&Q(i)}}}function c6(t){let e,i,n,r=t[10]&&Rf(t);const o=[{class:"PinturaControlList"},{tabs:t[5]},t[12],{layout:"compact"}];let a={$$slots:{default:[l6,({tab:s})=>({28:s}),({tab:s})=>s?268435456:0]},$$scope:{ctx:t}};for(let s=0;s<o.length;s+=1)a=Tn(a,o[s]);return i=new Fu({props:a}),i.$on("select",t[18]),{c(){r&&r.c(),e=me(),Et(i.$$.fragment)},m(s,l){r&&r.m(s,l),et(s,e,l),Rt(i,s,l),n=!0},p(s,l){s[10]?r?(r.p(s,l),1024&l&&P(r,1)):(r=Rf(s),r.c(),P(r,1),r.m(e.parentNode,e)):r&&(Pe(),z(r,1,1,()=>{r=null}),Re());const c=4128&l?yr(o,[o[0],32&l&&{tabs:s[5]},4096&l&&Pr(s[12]),o[3]]):{};805306368&l&&(c.$$scope={dirty:l,ctx:s}),i.$set(c)},i(s){n||(P(r),P(i.$$.fragment,s),n=!0)},o(s){z(r),z(i.$$.fragment,s),n=!1},d(s){r&&r.d(s),s&&Q(e),It(i,s)}}}function d6(t){let e,i;return e=new Yh({props:{items:t[13][t[26]].items,disabled:t[13][t[26]].disabled,onclickitem:t[1],ongrabitem:t[2],ondragitem:t[3],ondropitem:t[4]}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};67117056&r&&(o.items=n[13][n[26]].items),67117056&r&&(o.disabled=n[13][n[26]].disabled),2&r&&(o.onclickitem=n[1]),4&r&&(o.ongrabitem=n[2]),8&r&&(o.ondragitem=n[3]),16&r&&(o.ondropitem=n[4]),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function u6(t){let e,i;return e=new ka({props:{scroll:t[27]?{scrollOffset:0,animate:!1}:void 0,scrollAutoCancel:t[9],elasticity:t[0],$$slots:{default:[d6]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};134217728&r&&(o.scroll=n[27]?{scrollOffset:0,animate:!1}:void 0),512&r&&(o.scrollAutoCancel=n[9]),1&r&&(o.elasticity=n[0]),603987998&r&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function p6(t){let e,i,n,r;const o=[n6,i6],a=[];function s(l,c){return l[9]?0:l[10]?1:-1}return~(i=s(t))&&(n=a[i]=o[i](t)),{c(){e=ht("div"),n&&n.c(),v(e,"class","PinturaShapePresetsPalette")},m(l,c){et(l,e,c),~i&&a[i].m(e,null),r=!0},p(l,[c]){let d=i;i=s(l),i===d?~i&&a[i].p(l,c):(n&&(Pe(),z(a[d],1,1,()=>{a[d]=null}),Re()),~i?(n=a[i],n?n.p(l,c):(n=a[i]=o[i](l),n.c()),P(n,1),n.m(e,null)):n=null)},i(l){r||(P(n),r=!0)},o(l){z(n),r=!1},d(l){l&&Q(e),~i&&a[i].d()}}}function h6(t,e,i){let n,r,o,a,s,l,c,d,u,{locale:p}=e,{presets:h}=e,{scrollElasticity:g}=e,{enableSelectImage:m=!0}=e,{willRenderPresetToolbar:f=Ji}=e,{onaddpreset:b=$e}=e,{ongrabpreset:w}=e,{ondragpreset:S}=e,{ondroppreset:C}=e;const R="presets-"+na(),M=(W,B="")=>tx(W)?W:xu(W)?by(W,B):`<img src="${W}" alt="${B}"/>`,D=W=>ey(Sh(W)),T=["src","alt","thumb","shape","id","mount","disabled"],F=W=>W.map(B=>(y=>En(y)&&Ve(y[0])&&En(y[1]))(B)?{...B[2],id:`${R}-${B[0].toLowerCase()}`,label:B[0],items:F(B[1])}:(y=>{let V,tt,k,N,it,ut,st,mt=y;return Ve(y)?xu(y)?(V=y,it=y,N=M(V,it)):(V=y,it=D(V),N=M(V,it)):(V=y.src,it=y.alt||(Ve(V)?D(V):Ve(y.thumb)?D(y.thumb):void 0),N=M(y.thumb||V,it),tt=y.shape,ut=y.mount,st=y.disabled,k=Object.keys(y).reduce((G,gt)=>(T.includes(gt)||(G[gt]=y[gt]),G),{})),{id:mt,src:V,thumb:N,shape:tt,shapeProps:k,alt:it,title:it,mount:ut,disabled:st}})(B));return t.$$set=W=>{"locale"in W&&i(14,p=W.locale),"presets"in W&&i(15,h=W.presets),"scrollElasticity"in W&&i(0,g=W.scrollElasticity),"enableSelectImage"in W&&i(16,m=W.enableSelectImage),"willRenderPresetToolbar"in W&&i(17,f=W.willRenderPresetToolbar),"onaddpreset"in W&&i(1,b=W.onaddpreset),"ongrabpreset"in W&&i(2,w=W.ongrabpreset),"ondragpreset"in W&&i(3,S=W.ondragpreset),"ondroppreset"in W&&i(4,C=W.ondroppreset)},t.$$.update=()=>{32768&t.$$.dirty&&i(7,n=F(h)),128&t.$$.dirty&&i(9,r=n.length),640&t.$$.dirty&&i(8,o=r&&n.some(W=>!!W.items)),384&t.$$.dirty&&i(5,a=o&&n),384&t.$$.dirty&&i(13,s=o&&n.reduce((W,B)=>(W[B.id]=B,W),{})),96&t.$$.dirty&&i(6,l=l||a&&(a.find(W=>!W.disabled)||{}).id),64&t.$$.dirty&&i(12,c={name:R,selected:l}),32&t.$$.dirty&&i(11,d=a&&a.map(W=>W.id)),212994&t.$$.dirty&&i(10,u=p&&f([m&&["Button","browse",{label:p.shapeLabelButtonSelectSticker,icon:p.shapeIconButtonSelectSticker,onclick:()=>{B2().then(W=>{W&&b(W)})}}]]))},[g,b,w,S,C,a,l,n,o,r,u,d,c,s,p,h,m,f,({detail:W})=>i(6,l=W)]}class ex extends li{constructor(e){super(),si(this,e,h6,p6,ri,{locale:14,presets:15,scrollElasticity:0,enableSelectImage:16,willRenderPresetToolbar:17,onaddpreset:1,ongrabpreset:2,ondragpreset:3,ondroppreset:4})}}function m6(t){let e,i,n,r;return e=new ro({props:{items:t[29]}}),n=new _u({props:{locale:t[4],shape:t[48]||t[49],onchange:t[85],controls:t[9],scrollEnable:!1,hideTitles:!0,willRenderControls:t[160]}}),{c(){Et(e.$$.fragment),i=me(),Et(n.$$.fragment)},m(o,a){Rt(e,o,a),et(o,i,a),Rt(n,o,a),r=!0},p(o,a){const s={};536870912&a[0]&&(s.items=o[29]),e.$set(s);const l={};16&a[0]&&(l.locale=o[4]),393216&a[1]&&(l.shape=o[48]||o[49]),512&a[0]&&(l.controls=o[9]),n.$set(l)},i(o){r||(P(e.$$.fragment,o),P(n.$$.fragment,o),r=!0)},o(o){z(e.$$.fragment,o),z(n.$$.fragment,o),r=!1},d(o){It(e,o),o&&Q(i),It(n,o)}}}function $6(t){let e,i,n;return i=new K2({props:{$$slots:{default:[m6]},$$scope:{ctx:t}}}),{c(){e=ht("div"),Et(i.$$.fragment),v(e,"slot","header")},m(r,o){et(r,e,o),Rt(i,e,null),n=!0},p(r,o){const a={};536871440&o[0]|393216&o[1]|524288&o[6]&&(a.$$scope={dirty:o,ctx:r}),i.$set(a)},i(r){n||(P(i.$$.fragment,r),n=!0)},o(r){z(i.$$.fragment,r),n=!1},d(r){r&&Q(e),It(i)}}}function Af(t){let e,i;const n=[{locale:t[4]},{ui:t[69]},{shapes:t[5]},{selection:t[58]},{uid:t[19]},{parentRect:t[36]},{rootRect:t[55]},{utilRect:t[38]},{offset:t[50]},{disabled:t[37]},{contextRotation:t[22]},{contextFlipX:t[23]},{contextFlipY:t[24]},{contextZoom:t[35]?t[35].scale:void 0},{active:t[34]},{opacity:t[56]},{hoverColor:t[57]},{caretColor:t[57]},{snapColor:t[57]},{gridColor:[1,1,1,.125]},{eraseRadius:t[46]},{selectRadius:t[6]},{enableButtonFlipVertical:t[10]},{mapEditorPointToImagePoint:t[20]},{mapImagePointToEditorPoint:t[21]},{enableTapToAddText:t[13]},{textInputMode:t[8]},{snapThreshold:t[15]},{snapPointer:!t[47]},{enableSnapToContext:t[16]},{gridSize:t[14]},{willStartInteraction:t[95]},{oninteractionstart:t[79]},{oninteractionupdate:t[80]},{oninteractionrelease:t[81]},{oninteractionend:t[83]},{oninteractioncancel:t[82]},{onleavecanvas:t[87]},{onhovercanvas:t[86]},{onhovershape:t[89]},{ontapcanvas:t[88]},{onaddshape:t[152]},{onselectshape:t[153]},{onblurshape:t[154]},{ontapshape:t[155]},{onupdateshape:t[156]},{onremoveshape:t[157]},t[41]];let r={};for(let o=0;o<n.length;o+=1)r=Tn(r,n[o]);return e=new ZS({props:r}),t[158](e),{c(){Et(e.$$.fragment)},m(o,a){Rt(e,o,a),i=!0},p(o,a){const s=1106896240&a[0]|252282104&a[1]|255721600&a[2]|12&a[3]?yr(n,[16&a[0]&&{locale:o[4]},128&a[2]&&{ui:o[69]},32&a[0]&&{shapes:o[5]},134217728&a[1]&&{selection:o[58]},524288&a[0]&&{uid:o[19]},32&a[1]&&{parentRect:o[36]},16777216&a[1]&&{rootRect:o[55]},128&a[1]&&{utilRect:o[38]},524288&a[1]&&{offset:o[50]},64&a[1]&&{disabled:o[37]},4194304&a[0]&&{contextRotation:o[22]},8388608&a[0]&&{contextFlipX:o[23]},16777216&a[0]&&{contextFlipY:o[24]},16&a[1]&&{contextZoom:o[35]?o[35].scale:void 0},8&a[1]&&{active:o[34]},33554432&a[1]&&{opacity:o[56]},67108864&a[1]&&{hoverColor:o[57]},67108864&a[1]&&{caretColor:o[57]},67108864&a[1]&&{snapColor:o[57]},n[19],32768&a[1]&&{eraseRadius:o[46]},64&a[0]&&{selectRadius:o[6]},1024&a[0]&&{enableButtonFlipVertical:o[10]},1048576&a[0]&&{mapEditorPointToImagePoint:o[20]},2097152&a[0]&&{mapImagePointToEditorPoint:o[21]},8192&a[0]&&{enableTapToAddText:o[13]},256&a[0]&&{textInputMode:o[8]},32768&a[0]&&{snapThreshold:o[15]},65536&a[1]&&{snapPointer:!o[47]},65536&a[0]&&{enableSnapToContext:o[16]},16384&a[0]&&{gridSize:o[14]},4&a[3]&&{willStartInteraction:o[95]},131072&a[2]&&{oninteractionstart:o[79]},262144&a[2]&&{oninteractionupdate:o[80]},524288&a[2]&&{oninteractionrelease:o[81]},2097152&a[2]&&{oninteractionend:o[83]},1048576&a[2]&&{oninteractioncancel:o[82]},33554432&a[2]&&{onleavecanvas:o[87]},16777216&a[2]&&{onhovercanvas:o[86]},134217728&a[2]&&{onhovershape:o[89]},67108864&a[2]&&{ontapcanvas:o[88]},1073741824&a[0]|8&a[3]&&{onaddshape:o[152]},1073741824&a[0]&&{onselectshape:o[153]},1073741824&a[0]&&{onblurshape:o[154]},1073741824&a[0]&&{ontapshape:o[155]},1073741824&a[0]|8&a[3]&&{onupdateshape:o[156]},1073741824&a[0]|8&a[3]&&{onremoveshape:o[157]},1024&a[1]&&Pr(o[41])]):{};e.$set(s)},i(o){i||(P(e.$$.fragment,o),i=!0)},o(o){z(e.$$.fragment,o),i=!1},d(o){t[158](null),It(e,o)}}}function g6(t){let e,i,n,r,o,a=t[51]&&Af(t);return{c(){e=ht("div"),a&&a.c(),v(e,"slot","main"),v(e,"style",i="cursor:"+t[45])},m(s,l){et(s,e,l),a&&a.m(e,null),t[159](e),n=!0,r||(o=[Pt(e,"keydown",t[84]),Xi(x2.call(null,e)),Pt(e,"dropfiles",function(){Zi(t[12]?t[94]:$e)&&(t[12]?t[94]:$e).apply(this,arguments)}),Xi(xr.call(null,e)),Pt(e,"measure",t[148])],r=!0)},p(s,l){(t=s)[51]?a?(a.p(t,l),1048576&l[1]&&P(a,1)):(a=Af(t),a.c(),P(a,1),a.m(e,null)):a&&(Pe(),z(a,1,1,()=>{a=null}),Re()),(!n||16384&l[1]&&i!==(i="cursor:"+t[45]))&&v(e,"style",i)},i(s){n||(P(a),n=!0)},o(s){z(a),n=!1},d(s){s&&Q(e),a&&a.d(),t[159](null),r=!1,Ui(o)}}}function f6(t){let e,i;return e=new ex({props:{locale:t[4],presets:t[18],enableSelectImage:t[11],willRenderPresetToolbar:t[42],onaddpreset:t[93],ongrabpreset:t[90],ondragpreset:t[91],ondroppreset:t[92],scrollElasticity:t[43]}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};16&r[0]&&(o.locale=n[4]),262144&r[0]&&(o.presets=n[18]),2048&r[0]&&(o.enableSelectImage=n[11]),2048&r[1]&&(o.willRenderPresetToolbar=n[42]),4096&r[1]&&(o.scrollElasticity=n[43]),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function y6(t){let e,i,n,r=t[7]==="stack"&&Lf(t),o=(t[53]&&t[33]||t[7]==="row")&&zf(t);return{c(){r&&r.c(),e=me(),o&&o.c(),i=Mn()},m(a,s){r&&r.m(a,s),et(a,e,s),o&&o.m(a,s),et(a,i,s),n=!0},p(a,s){a[7]==="stack"?r?(r.p(a,s),128&s[0]&&P(r,1)):(r=Lf(a),r.c(),P(r,1),r.m(e.parentNode,e)):r&&(Pe(),z(r,1,1,()=>{r=null}),Re()),a[53]&&a[33]||a[7]==="row"?o?(o.p(a,s),128&s[0]|4194308&s[1]&&P(o,1)):(o=zf(a),o.c(),P(o,1),o.m(i.parentNode,i)):o&&(Pe(),z(o,1,1,()=>{o=null}),Re())},i(a){n||(P(r),P(o),n=!0)},o(a){z(r),z(o),n=!1},d(a){r&&r.d(a),a&&Q(e),o&&o.d(a),a&&Q(i)}}}function Lf(t){let e,i,n,r;const o=[b6,x6],a=[];function s(l,c){return l[44]?0:1}return i=s(t),n=a[i]=o[i](t),{c(){e=ht("div"),n.c(),v(e,"class","PinturaControlPanels")},m(l,c){et(l,e,c),a[i].m(e,null),r=!0},p(l,c){let d=i;i=s(l),i===d?a[i].p(l,c):(Pe(),z(a[d],1,1,()=>{a[d]=null}),Re(),n=a[i],n?n.p(l,c):(n=a[i]=o[i](l),n.c()),P(n,1),n.m(e,null))},i(l){r||(P(n),r=!0)},o(l){z(n),r=!1},d(l){l&&Q(e),a[i].d()}}}function x6(t){let e,i,n;return i=new _u({props:{locale:t[4],shape:t[48]||t[49],onchange:t[85],controls:t[9],scrollElasticity:t[43],willRenderControls:t[17]}}),{c(){e=ht("div"),Et(i.$$.fragment),v(e,"class","PinturaControlPanel")},m(r,o){et(r,e,o),Rt(i,e,null),n=!0},p(r,o){const a={};16&o[0]&&(a.locale=r[4]),393216&o[1]&&(a.shape=r[48]||r[49]),512&o[0]&&(a.controls=r[9]),4096&o[1]&&(a.scrollElasticity=r[43]),131072&o[0]&&(a.willRenderControls=r[17]),i.$set(a)},i(r){n||(P(i.$$.fragment,r),n=!0)},o(r){z(i.$$.fragment,r),n=!1},d(r){r&&Q(e),It(i)}}}function b6(t){let e,i,n;return i=new ex({props:{locale:t[4],presets:t[18],enableSelectImage:t[11],willRenderPresetToolbar:t[42],onaddpreset:t[93],ongrabpreset:t[90],ondragpreset:t[91],ondroppreset:t[92],scrollElasticity:t[43]}}),{c(){e=ht("div"),Et(i.$$.fragment),v(e,"class","PinturaControlPanel")},m(r,o){et(r,e,o),Rt(i,e,null),n=!0},p(r,o){const a={};16&o[0]&&(a.locale=r[4]),262144&o[0]&&(a.presets=r[18]),2048&o[0]&&(a.enableSelectImage=r[11]),2048&o[1]&&(a.willRenderPresetToolbar=r[42]),4096&o[1]&&(a.scrollElasticity=r[43]),i.$set(a)},i(r){n||(P(i.$$.fragment,r),n=!0)},o(r){z(i.$$.fragment,r),n=!1},d(r){r&&Q(e),It(i)}}}function zf(t){let e,i;return e=new ka({props:{class:"PinturaControlListScroller",elasticity:t[43],$$slots:{default:[S6]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};4096&r[1]&&(o.elasticity=n[43]),131729&r[0]|393221&r[1]|524288&r[6]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function Ff(t){let e,i;return e=new as({props:{locale:t[4],class:"PinturaControlList",optionClass:"PinturaControlListOption",layout:"row",options:t[31],selectedIndex:t[31].findIndex(t[149]),onchange:t[78],$$slots:{option:[w6,({option:n})=>({204:n}),({option:n})=>[0,0,0,0,0,0,n?262144:0]]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};16&r[0]&&(o.locale=n[4]),1&r[1]&&(o.options=n[31]),1&r[0]|1&r[1]&&(o.selectedIndex=n[31].findIndex(n[149])),16&r[0]|786432&r[6]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function Df(t){let e,i;return e=new ko({props:{$$slots:{default:[v6]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};16&r[0]|786432&r[6]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function v6(t){let e,i=(cn(t[204].icon)?t[204].icon(t[4]):t[204].icon)+"";return{c(){e=fr("g")},m(n,r){et(n,e,r),e.innerHTML=i},p(n,r){16&r[0]|262144&r[6]&&i!==(i=(cn(n[204].icon)?n[204].icon(n[4]):n[204].icon)+"")&&(e.innerHTML=i)},d(n){n&&Q(e)}}}function Bf(t){let e,i,n=(cn(t[204].label)?t[204].label(t[4]):t[204].label)+"";return{c(){e=ht("span"),i=$n(n)},m(r,o){et(r,e,o),kt(e,i)},p(r,o){16&o[0]|262144&o[6]&&n!==(n=(cn(r[204].label)?r[204].label(r[4]):r[204].label)+"")&&An(i,n)},d(r){r&&Q(e)}}}function w6(t){let e,i,n,r=t[204].icon&&Df(t),o=!t[204].hideLabel&&Bf(t);return{c(){e=ht("div"),r&&r.c(),i=me(),o&&o.c(),v(e,"slot","option")},m(a,s){et(a,e,s),r&&r.m(e,null),kt(e,i),o&&o.m(e,null),n=!0},p(a,s){a[204].icon?r?(r.p(a,s),262144&s[6]&&P(r,1)):(r=Df(a),r.c(),P(r,1),r.m(e,i)):r&&(Pe(),z(r,1,1,()=>{r=null}),Re()),a[204].hideLabel?o&&(o.d(1),o=null):o?o.p(a,s):(o=Bf(a),o.c(),o.m(e,null))},i(a){n||(P(r),n=!0)},o(a){z(r),n=!1},d(a){a&&Q(e),r&&r.d(),o&&o.d()}}}function Of(t){let e,i;return e=new _u({props:{locale:t[4],shape:t[48]||t[49],onchange:t[85],controls:t[9],scrollEnable:!1,hideTitles:!0,willRenderControls:t[150]}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};16&r[0]&&(o.locale=n[4]),393216&r[1]&&(o.shape=n[48]||n[49]),512&r[0]&&(o.controls=n[9]),131072&r[0]&&(o.willRenderControls=n[150]),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function S6(t){let e,i,n,r=t[33]&&Ff(t),o=t[7]==="row"&&Of(t);return{c(){r&&r.c(),e=me(),o&&o.c(),i=Mn()},m(a,s){r&&r.m(a,s),et(a,e,s),o&&o.m(a,s),et(a,i,s),n=!0},p(a,s){a[33]?r?(r.p(a,s),4&s[1]&&P(r,1)):(r=Ff(a),r.c(),P(r,1),r.m(e.parentNode,e)):r&&(Pe(),z(r,1,1,()=>{r=null}),Re()),a[7]==="row"?o?(o.p(a,s),128&s[0]&&P(o,1)):(o=Of(a),o.c(),P(o,1),o.m(i.parentNode,i)):o&&(Pe(),z(o,1,1,()=>{o=null}),Re())},i(a){n||(P(r),P(o),n=!0)},o(a){z(r),z(o),n=!1},d(a){r&&r.d(a),a&&Q(e),o&&o.d(a),a&&Q(i)}}}function Wf(t){let e,i;return e=new ka({props:{class:"PinturaControlListScroller",elasticity:t[43],$$slots:{default:[T6]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};4096&r[1]&&(o.elasticity=n[43]),67108880&r[0]|8388608&r[1]|524288&r[6]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function _f(t){let e,i;return e=new ko({props:{$$slots:{default:[k6]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};16&r[0]|786432&r[6]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function k6(t){let e,i=(cn(t[204].icon)?t[204].icon(t[4]):t[204].icon)+"";return{c(){e=fr("g")},m(n,r){et(n,e,r),e.innerHTML=i},p(n,r){16&r[0]|262144&r[6]&&i!==(i=(cn(n[204].icon)?n[204].icon(n[4]):n[204].icon)+"")&&(e.innerHTML=i)},d(n){n&&Q(e)}}}function C6(t){let e,i,n,r,o,a=(cn(t[204].label)?t[204].label(t[4]):t[204].label)+"",s=t[204].icon&&_f(t);return{c(){e=ht("div"),s&&s.c(),i=me(),n=ht("span"),r=$n(a),v(e,"slot","option")},m(l,c){et(l,e,c),s&&s.m(e,null),kt(e,i),kt(e,n),kt(n,r),o=!0},p(l,c){l[204].icon?s?(s.p(l,c),262144&c[6]&&P(s,1)):(s=_f(l),s.c(),P(s,1),s.m(e,i)):s&&(Pe(),z(s,1,1,()=>{s=null}),Re()),(!o||16&c[0]|262144&c[6])&&a!==(a=(cn(l[204].label)?l[204].label(l[4]):l[204].label)+"")&&An(r,a)},i(l){o||(P(s),o=!0)},o(l){z(s),o=!1},d(l){l&&Q(e),s&&s.d()}}}function T6(t){let e,i;return e=new as({props:{locale:t[4],class:"PinturaControlList",optionClass:"PinturaControlListOption",layout:"row",options:t[54],selectedIndex:t[54].findIndex(t[151]),onchange:t[77],$$slots:{option:[C6,({option:n})=>({204:n}),({option:n})=>[0,0,0,0,0,0,n?262144:0]]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};16&r[0]&&(o.locale=n[4]),8388608&r[1]&&(o.options=n[54]),67108864&r[0]|8388608&r[1]&&(o.selectedIndex=n[54].findIndex(n[151])),16&r[0]|786432&r[6]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function M6(t){let e,i,n,r,o;const a=[y6,f6],s=[];function l(d,u){return d[52]?0:d[44]?1:-1}~(i=l(t))&&(n=s[i]=a[i](t));let c=t[32]&&Wf(t);return{c(){e=ht("div"),n&&n.c(),r=me(),c&&c.c(),v(e,"slot","footer"),v(e,"style",t[39])},m(d,u){et(d,e,u),~i&&s[i].m(e,null),kt(e,r),c&&c.m(e,null),o=!0},p(d,u){let p=i;i=l(d),i===p?~i&&s[i].p(d,u):(n&&(Pe(),z(s[p],1,1,()=>{s[p]=null}),Re()),~i?(n=s[i],n?n.p(d,u):(n=s[i]=a[i](d),n.c()),P(n,1),n.m(e,r)):n=null),d[32]?c?(c.p(d,u),2&u[1]&&P(c,1)):(c=Wf(d),c.c(),P(c,1),c.m(e,null)):c&&(Pe(),z(c,1,1,()=>{c=null}),Re()),(!o||256&u[1])&&v(e,"style",d[39])},i(d){o||(P(n),P(c),o=!0)},o(d){z(n),z(c),o=!1},d(d){d&&Q(e),~i&&s[i].d(),c&&c.d()}}}function P6(t){let e,i;return e=new dl({props:{hasHeader:t[40],$$slots:{footer:[M6],main:[g6],header:[$6]},$$scope:{ctx:t}}}),e.$on("measure",t[161]),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};512&r[1]&&(o.hasHeader=n[40]),2113929201&r[0]|134217215&r[1]|524288&r[6]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function R6(t,e,i){let n,r,o,a,s,l,c,d,u,p,h,g,m,f,b,w,S,C,R,M,D,T,F,W,B,y,V,tt,k,N,it,ut,st,mt,G,gt,vt,lt,St,J,q,Z,bt,nt,$t,Lt,ie,Vt,te,Yt,U,Tt,ct,Jt,de,ee,be,ve,_,Ce,pi,we,Bt,Ae,Ee,We=ii,oi=()=>(We(),We=zr(yi,O=>i(34,Z=O)),yi),xt=ii,ge=()=>(xt(),xt=zr(H,O=>i(141,Lt=O)),H),Ue=ii,ze=()=>(Ue(),Ue=zr(vn,O=>i(36,ct=O)),vn),At=ii,Ge=()=>(At(),At=zr(Si,O=>i(147,pi=O)),Si),Ke=ii,gi=()=>(Ke(),Ke=zr(Li,O=>i(56,Ae=O)),Li);t.$$.on_destroy.push(()=>We()),t.$$.on_destroy.push(()=>xt()),t.$$.on_destroy.push(()=>Ue()),t.$$.on_destroy.push(()=>At()),t.$$.on_destroy.push(()=>Ke());let{isActive:yi}=e;oi();let{isActiveFraction:Li}=e;gi();let{isVisible:Si}=e;Ge();let{stores:X}=e,{locale:Zt={}}=e,{shapes:H}=e;ge();let{toolbar:qt=[]}=e,{toolShapes:le={}}=e,{toolActive:Ut}=e,{toolSelectRadius:fe}=e,{toolRetainStyles:Xt=!1}=e,{toolbarLayout:Le="stack"}=e,{textInputMode:Je}=e,{shapeControls:_e={}}=e,{enableButtonFlipVertical:dt=!1}=e,{enablePresetSelectImage:jt=!0}=e,{enablePresetDropImage:ne=!0}=e,{enableSelectToolToAddShape:Fe=!1}=e,{enableAutoSelectMoveTool:Nt=["line","arrow","path","rectangle","ellipse","text"]}=e,{enableTapToAddText:K=!1}=e,{enableMoveTool:Qt=!1}=e,{enableViewTool:Gt=!1}=e,{enableToolShareStyles:oe=!0}=e,{gridSize:He=0}=e,{snapThreshold:Ne=0}=e,{enableSnapToContext:Te=!0}=e,{willRenderHeaderTools:Qe=Ji}=e,{willRenderPresetToolbar:De}=e,{willRenderShapeStyleControls:ce}=e,{willStartInteraction:Ye}=e,{shapePresets:Me=[]}=e,{utilKey:Ze}=e,{mapScreenPointToImagePoint:Ni}=e,{mapImagePointToScreenPoint:ue}=e,{imageRotation:Se=0}=e,{imageFlipX:dn=!1}=e,{imageFlipY:bn=!1}=e,{parentRect:vn}=e;ze();let{hooks:Nn={}}=e;const Hn=un("selection");E(t,Hn,O=>i(146,ve=O));const dr=un("isAnimated");E(t,dr,O=>i(138,bt=O));const oo=un("elasticityMultiplier");E(t,oo,O=>i(142,ie=O));const Pn=un("ui");E(t,Pn,O=>i(171,_=O));const br=un("keysPressed");let yn;E(t,br,O=>i(145,be=O));const{env:ao,history:Qi,rootRect:Gr,rootColorSecondary:wn,enablePanInput:Xn,enablePanInputStatus:ki,enableZoomInput:_o,stageRect:Zr,utilRectPadded:Vo,scrollElasticity:so,imageOverlayMarkup:fo,imagePreviewModifiers:Ln,imageCropRect:Bn,shapePreprocessor:tn,stageScalar:No,imageSelectionRect:Br,imageTransformsInterpolated:mr,imageSelectionPan:Or,imageSize:da,allowPan:Co,allowZoom:To,allowZoomControls:Wr,allowPlayPause:lo}=X;E(t,ao,O=>i(139,nt=O)),E(t,Gr,O=>i(55,Bt=O)),E(t,wn,O=>i(57,Ee=O)),E(t,ki,O=>i(37,de=O)),E(t,Zr,O=>i(143,Vt=O)),E(t,Vo,O=>i(38,Ce=O)),E(t,Ln,O=>i(172,we=O)),E(t,Bn,O=>i(170,Jt=O)),E(t,No,O=>i(168,U=O)),E(t,Br,O=>i(169,Tt=O)),E(t,mr,O=>i(35,te=O)),E(t,Or,O=>i(167,Yt=O)),E(t,da,O=>i(144,ee=O));let vr=0,Rr={};const co=O=>{const[re,xi]=yn[O];let qe,Mt,ye=xi.position==="relative";const Mi=ye?"0%":0,_i=ye?"0%":0;vo(re)||Yn(re)?(Mt=ye?"20%":.2*ct.width,qe=_n(re),qe.x=Mi,qe.y=_i,ba(qe,{width:Mt,height:Mt},ct)):qn(re)?(Mt=ye?"10%":.1*ct.width,qe=_n(re),qe.x=Mi,qe.y=_i,ba(qe,{rx:Mt,ry:Mt},ct)):ir(re)&&(Mt=ye?"10%":.1*ct.width,qe=_n(re),qe.x1=Mi,qe.y1=_i,qe.x2=Mi,qe.y2=_i),qe&&Promise.resolve().then(()=>{Ho(po(qe,void 0,Mt))})},Sn=O=>Ni(hh(O,Bt));let Di,Gi={},wr,en;const Sr=O=>{if(!(On(O)&&Ie(O,"pathClose")))return;const re=[...O.strokeColor];re[3]=1,Di.updateMarkupShape(O,{pathClose:!1,strokeColor:re},!1),Di.removeMarkupShapeProps(O,["backgroundColor"],!1),Di.confirmMarkupItemDraft(),Di.selectShape(O),mt("addshape",O),Qi.write()};let uo;const Xr=(O,re)=>{if(ui(O))return O;if(O.endsWith("%"))return parseFloat(O)/100*re.width};let ur,pr,Wn;const po=(O,re,xi)=>{let qe=!1;re||(qe=!0,re=st?Ni(Ti(Vt)):Ti(Jt)),re.x-=ct.x||0,re.y-=ct.y||0,(dn||bn)&&(O.flipX=dn,O.flipY=bn);const Mt=Di.getShapesNearPosition(Lt,re);if(qe&&Mt.length){const ye=.1*Math.min(Jt.width,Jt.height);re.x+=Math.round(-ye+Math.random()*ye*2),re.y+=Math.round(-ye+Math.random()*ye*2)}if(Se!==0&&(O.rotation=dn&&bn?-Se:dn||bn?Se:-Se),Ie(O,"width")&&Ie(O,"height")){const{width:ye,height:Mi}=Ll(O,["width","height"],ct);ba(O,{x:re.x-.5*ye,y:re.y-.5*Mi},ct)}else if(qn(O))ba(O,{x:re.x,y:re.y},ct);else if(ir(O)){const{x1:ye,y1:Mi,x2:_i,y2:pn}=Ll(O,["x1","y1","x2","y2"],ct),bi=$o(ot(ye,Mi),ot(_i,pn)),Hi=Ve(xi)?vu(xi,ct.width):bi;ba(O,{x1:re.x-Hi,y1:re.y+Hi,x2:re.x+Hi,y2:re.y-Hi},ct)}else if(On(O)){const{points:ye}=Ll(O,["points"],ct),Mi=Fo(ye);ba(O,{points:ye.map(_i=>({x:_i.x+re.x-Mi.x,y:_i.y+re.y-Mi.y}))},ct)}return O},Jn=(O,re)=>{const xi=po(Bm(O,Jt),re);return O.shape&&(Ie(O.shape,"x")&&(xi.x=O.shape.x),Ie(O.shape,"y")&&(xi.y=O.shape.y)),Ho(xi)},Ho=O=>{const{beforeAddShape:re=()=>!0}=Nn;if(re(O))return Di.addShape(O),Di.selectShape(O),mt("addshape",O),Qi.write(),O};let jn=!1;const zn=()=>{Qi.write()};let ho;const Yr=un("redrawTrigger");E(t,Yr,O=>i(140,$t=O));const Rn=[],hr=di(bt?20:0);return E(t,hr,O=>i(137,q=O)),t.$$set=O=>{"isActive"in O&&oi(i(1,yi=O.isActive)),"isActiveFraction"in O&&gi(i(2,Li=O.isActiveFraction)),"isVisible"in O&&Ge(i(3,Si=O.isVisible)),"stores"in O&&i(100,X=O.stores),"locale"in O&&i(4,Zt=O.locale),"shapes"in O&&ge(i(5,H=O.shapes)),"toolbar"in O&&i(101,qt=O.toolbar),"toolShapes"in O&&i(102,le=O.toolShapes),"toolActive"in O&&i(0,Ut=O.toolActive),"toolSelectRadius"in O&&i(6,fe=O.toolSelectRadius),"toolRetainStyles"in O&&i(103,Xt=O.toolRetainStyles),"toolbarLayout"in O&&i(7,Le=O.toolbarLayout),"textInputMode"in O&&i(8,Je=O.textInputMode),"shapeControls"in O&&i(9,_e=O.shapeControls),"enableButtonFlipVertical"in O&&i(10,dt=O.enableButtonFlipVertical),"enablePresetSelectImage"in O&&i(11,jt=O.enablePresetSelectImage),"enablePresetDropImage"in O&&i(12,ne=O.enablePresetDropImage),"enableSelectToolToAddShape"in O&&i(104,Fe=O.enableSelectToolToAddShape),"enableAutoSelectMoveTool"in O&&i(105,Nt=O.enableAutoSelectMoveTool),"enableTapToAddText"in O&&i(13,K=O.enableTapToAddText),"enableMoveTool"in O&&i(106,Qt=O.enableMoveTool),"enableViewTool"in O&&i(107,Gt=O.enableViewTool),"enableToolShareStyles"in O&&i(108,oe=O.enableToolShareStyles),"gridSize"in O&&i(14,He=O.gridSize),"snapThreshold"in O&&i(15,Ne=O.snapThreshold),"enableSnapToContext"in O&&i(16,Te=O.enableSnapToContext),"willRenderHeaderTools"in O&&i(109,Qe=O.willRenderHeaderTools),"willRenderPresetToolbar"in O&&i(110,De=O.willRenderPresetToolbar),"willRenderShapeStyleControls"in O&&i(17,ce=O.willRenderShapeStyleControls),"willStartInteraction"in O&&i(111,Ye=O.willStartInteraction),"shapePresets"in O&&i(18,Me=O.shapePresets),"utilKey"in O&&i(19,Ze=O.utilKey),"mapScreenPointToImagePoint"in O&&i(20,Ni=O.mapScreenPointToImagePoint),"mapImagePointToScreenPoint"in O&&i(21,ue=O.mapImagePointToScreenPoint),"imageRotation"in O&&i(22,Se=O.imageRotation),"imageFlipX"in O&&i(23,dn=O.imageFlipX),"imageFlipY"in O&&i(24,bn=O.imageFlipY),"parentRect"in O&&ze(i(25,vn=O.parentRect)),"hooks"in O&&i(112,Nn=O.hooks)},t.$$.update=()=>{var O,re,xi,qe;if(2097152&t.$$.dirty[4]&&i(122,n=be.includes(18)),1049088&t.$$.dirty[3]&&(yn&&le===yn||i(113,yn=le)),8&t.$$.dirty[1]&&Co.set(Z),8&t.$$.dirty[1]&&To.set(Z),8&t.$$.dirty[1]&&Wr.set(Z),256&t.$$.dirty[3]&&i(32,r=Array.isArray(qt)&&qt.length>1&&Array.isArray(qt[0][1])),2&t.$$.dirty[1]|256&t.$$.dirty[3]&&i(54,o=r?qt.map((Mt,ye)=>[ye,Mt[0]]):[]),67108864&t.$$.dirty[0]|2&t.$$.dirty[1]|256&t.$$.dirty[3]&&i(136,a=r?qt[vr][1]:qt),262144&t.$$.dirty[0]|155648&t.$$.dirty[3]|4096&t.$$.dirty[4]&&i(31,s=((Mt,{willRenderPresetToolbar:ye,shapePresets:Mi,enableViewTool:_i,enableMoveTool:pn})=>{let bi=Mi.length!==0||ye?Mt:Mt.filter(Hi=>Hi[0]!=="preset");return r&&(bi=[["move",Hi=>Hi.shapeLabelToolMove,{icon:Hi=>Hi.shapeIconToolMove}],["view",Hi=>Hi.shapeLabelToolView,{icon:Hi=>Hi.shapeIconToolView}],...bi]),bi=pn?bi:bi.filter(Hi=>Hi[0]!=="move"),_i?bi:bi.filter(Hi=>Hi[0]!=="view")})(a,{willRenderPresetToolbar:De,shapePresets:Me,enableMoveTool:Qt,enableViewTool:Gt})),1&t.$$.dirty[1]&&i(134,d=!!s.length),1&t.$$.dirty[0]|1&t.$$.dirty[1]|1024&t.$$.dirty[4]&&d&&Ut===void 0&&i(0,Ut=s[0][0]),67108865&t.$$.dirty[0]|2&t.$$.dirty[1]|2097152&t.$$.dirty[3]|4096&t.$$.dirty[4]&&r&&i(114,Rr={...Rr,[vr]:a.map(([Mt])=>Mt).includes(Ut)?Ut:Rr[vr]||a[0][0]}),512&t.$$.dirty[0]&&i(133,l=!!Object.keys(_e).length),1&t.$$.dirty[1]&&i(33,c=s.length>1),6&t.$$.dirty[1]&&i(53,u=c||r),1&t.$$.dirty[0]&&i(135,p=Ut!==void 0),3584&t.$$.dirty[4]&&i(52,h=(!p||d)&&l),268435456&t.$$.dirty[0]&&i(30,mt=ho&&(O=ho,(Mt,ye)=>{O.dispatchEvent(gs(Mt,ye))})),1073741825&t.$$.dirty[0]|8&t.$$.dirty[1]&&Z&&mt&&mt("selectcontrol",Ut),8&t.$$.dirty[1]&&(Z?wt(Ln,we[Ze]={maskMarkupOpacity:.85},we):delete we[Ze]),1&t.$$.dirty[0]|1048576&t.$$.dirty[3]&&i(132,g=Ut&&yn[Ut]?yn[Ut][1]:void 0),256&t.$$.dirty[4]&&i(123,m=g&&g.isSelection?"selection":"shapes"),1610612736&t.$$.dirty[3]&&(Mt=>{if(!Di)return;const ye=Di.getShapeDraft(Hn);ye&&(Mt&&(wr=ye.drawMode),Di.updateShapeDraft({drawMode:Mt?"subtract":wr},Hn))})(m==="selection"&&n),134217729&t.$$.dirty[0]&&Ut&&Di){const Mt=Di.getMarkupItemDraft();Mt&&Sr(Mt)}if(1&t.$$.dirty[0]&&Ut&&Di&&Ut!=="move"&&Di.blurShapes(),8&t.$$.dirty[1]|8388608&t.$$.dirty[4]&&i(51,f=pi&&Z),128&t.$$.dirty[1]|524288&t.$$.dirty[4]&&i(50,b=Ce&&ot(Vt.x-Ce.x,Vt.y-Ce.y)),512&t.$$.dirty[0]&&i(131,w=Object.keys(_e)),8&t.$$.dirty[1]|131072&t.$$.dirty[4]&&i(119,S=Z&&Lt.filter(ys)[0]),8&t.$$.dirty[1]|131072&t.$$.dirty[4]&&i(128,C=Z&&Lt.find(Mt=>$p(Mt))),8&t.$$.dirty[1]|131072&t.$$.dirty[4]&&i(49,R=Z&&Lt.find(Mt=>eo(Mt))),1&t.$$.dirty[0]|8&t.$$.dirty[1]|1048576&t.$$.dirty[3]&&i(125,M=Z&&yn[Ut]?Py(_n({...yn[Ut][0],..._[Ze]?_[Ze][Ut]:{}})):{}),1048576&t.$$.dirty[3]&&yn&&i(115,Gi={}),1&t.$$.dirty[0]|4227072&t.$$.dirty[3]|130&t.$$.dirty[4]&&i(124,D=M&&Object.keys(M).reduce((Mt,ye)=>{const Mi=ye==="disableStyle",_i=ye==="settings",pn=!!w.find(_r=>_r.split("_").includes(ye));if(!Mi&&!_i&&!pn||M[ye]===void 0||M.disableStyle===!0||M.disableStyle&&M.disableStyle.includes(ye))return Mt;if(ye==="strokeWidth"&&Object.keys(Gi).includes("strokeWidth")&&Gi[ye]===void 0&&Ie(M,"points"))return Mt[ye]=M[ye],Mt;const{share:bi=!0}=M.settings&&M.settings[ye]||{},Hi=oe&&bi?Gi:Gi[Ut]||{};return Mt[ye]=Ie(Hi,ye)?Hi[ye]:M[ye],Mt},{})),524289&t.$$.dirty[0]|1024&t.$$.dirty[3]|1&t.$$.dirty[4]&&(Xt?((Mt,ye,Mi)=>{const _i=_[Mt],pn=_i?_i[ye]:{};Pn.set({..._,[Mt]:{..._i,[ye]:{...pn,...Mi}}})})(Ze,Ut,D):(re=Ze,Pn.set({[re]:{}}))),8&t.$$.dirty[1]|67108864&t.$$.dirty[3]|4194305&t.$$.dirty[4]&&i(48,T=ve&&Z?S||D:void 0),1&t.$$.dirty[0]|2&t.$$.dirty[4]&&i(47,F=Ie(M,"eraseRadius")||Ie(M,"points")&&!Ie(M,"pathClose")||Ut==="move"||Ut==="view"),32&t.$$.dirty[1]|2&t.$$.dirty[4]&&i(46,W=M&&M.eraseRadius!==void 0?Xr(M.eraseRadius,ct):void 0),8&t.$$.dirty[1]|2097152&t.$$.dirty[4]&&i(129,B=Z&&be.includes(32)),1&t.$$.dirty[0]|8&t.$$.dirty[1]&&i(130,y=Z&&Ut==="view"),96&t.$$.dirty[4]&&i(127,V=y||B),24&t.$$.dirty[4]&&i(126,tt=!!V&&(!!C||Oc(document.activeElement))),8&t.$$.dirty[1]|12&t.$$.dirty[4]&&Xn.set(!Z||V&&!tt),8&t.$$.dirty[1]|4&t.$$.dirty[4]&&_o.set(!Z||!tt),32&t.$$.dirty[1]|3&t.$$.dirty[4]&&i(120,k=M.cursorStyle?(({cursorStyle:Mt,cursorSize:ye},Mi,_i)=>{let pn;const bi=Mi[ye];if(bi===void 0?pn=Xr(ye,_i):ui(bi)?pn=bi:Ve(bi)&&(pn=Nb(ye,Mi[ye],_i),ye==="strokeWidth"&&(pn*=.5)),!(pn<=0||pn===void 0))return{size:pn,style:Mt}})(M,{...M,...D},ct):void 0),33554432&t.$$.dirty[3]|1048576&t.$$.dirty[4]&&i(121,N=Wn&&(qe=ee,(xi=Wn).x>=0&&xi.y>=0&&xi.x<=qe.width&&xi.y<=qe.height)),524288&t.$$.dirty[0]|80&t.$$.dirty[1]|2038431744&t.$$.dirty[3])if(N&&!ur&&k&&!de){const Mt=k.size*te.scale,ye={id:"cursor-"+Ze,x:pr.x,y:pr.y,strokeWidth:.5,strokeColor:[0,0,0]};k.style==="ellipse"&&(ye.rx=Mt,ye.ry=Mt);const Mi={strokeWidth:2.5,strokeColor:[1,1,1],opacity:.75},_i=[{...ye,...Mi},ye];if(m==="selection"&&n){const pn=Mt,bi=pr.x+pn,Hi=pr.y+pn+4,_r={id:"cursor-"+Ze,strokeWidth:.75,strokeColor:[0,0,0],points:[{x:bi,y:Hi},{x:bi+4,y:Hi}]};_i.push({..._r,...Mi,strokeWidth:2,points:[{x:bi-.5,y:Hi},{x:bi+4.5,y:Hi}]},_r)}(pn=>{fo.update(bi=>[...bi.filter(Hi=>Hi.id!=="cursor-"+Ze),...pn])})(_i)}else fo.update(Mt=>Mt.filter(ye=>ye.id!=="cursor-"+Ze));1&t.$$.dirty[0]|64&t.$$.dirty[1]|478150656&t.$$.dirty[3]&&i(45,it=N?((Mt,ye,Mi,_i,pn,bi)=>{if(_i)return pn?"grabbing":"grab";if(Mt&&!ye)return"none";if(!ye)return bi==="move"?"default":"crosshair";let Hi=ye||Mi;return ys(Hi)?$p(Hi)?Je==="modal"?"default":"text":vc(Hi)?"move":"default":"default"})(k,ur,S,de,!1,Ut):"default"),264193&t.$$.dirty[0]|131072&t.$$.dirty[3]&&i(44,ut=Ut==="preset"&&(Me.length>0||jt||De)),32&t.$$.dirty[1]&&(st=!Ie(ct,"x")&&!Ie(ct,"y")),262144&t.$$.dirty[4]&&i(43,G=ie*so),131072&t.$$.dirty[3]|98304&t.$$.dirty[4]&&i(42,gt=$t&&De?Mt=>Wc(()=>De(Mt,Jn,{...nt},()=>Yr.set({}))):Ji),524288&t.$$.dirty[3]&&i(41,vt=Object.keys(Nn).reduce((Mt,ye)=>(ye==="beforeAddShape"||Nn[ye]===void 0||(Mt[ye]=Nn[ye]),Mt),{})),8&t.$$.dirty[1]&&(Mt=>{Lt&&H.update(ye=>ye.map(Mi=>(Mi._prerender=!!Mt&&$p(Mi),Mi)))})(Z),65536&t.$$.dirty[3]|98304&t.$$.dirty[4]&&i(29,lt=$t&&Qe([],nt,()=>Yr.set({}))),536871424&t.$$.dirty[0]&&i(40,St=!!lt.length||!!Object.keys(_e).some(Mt=>Rn.includes(Mt))),8&t.$$.dirty[1]|16384&t.$$.dirty[4]&&bt&&hr.set(Z?0:20),8192&t.$$.dirty[4]&&i(39,J=q?`transform: translateY(${q}px)`:void 0)},lo.set(!1),[Ut,yi,Li,Si,Zt,H,fe,Le,Je,_e,dt,jt,ne,K,He,Ne,Te,ce,Me,Ze,Ni,ue,Se,dn,bn,vn,vr,Di,ho,lt,mt,s,r,c,Z,te,ct,de,Ce,J,St,vt,gt,G,ut,it,W,F,T,R,b,f,h,u,o,Bt,Ae,Ee,Hn,dr,oo,Pn,br,ao,Gr,wn,ki,Zr,Vo,fo,Ln,Bn,No,Br,mr,Or,da,({index:O},re)=>{i(26,vr=O),i(0,Ut=Rr[O])},({value:O},re)=>{i(0,Ut=O),(Fe||/enter/i.test(re.key))&&co(O)},O=>{if(Ut==="eraser")en=Di.eraseShape();else if(Ut&&yn[Ut]){const[re,xi={}]=yn[Ut],{drawMode:qe}=T;m==="selection"&&qe==="new"&&Hn.set([]);let Mt={};m==="selection"&&(mt("selectiondown",[...ve]),n&&(wr=re.drawMode,Mt.drawMode="subtract")),en=Di.createShape({...re,...D,...Mt},xi)}else en=void 0;return!!en&&(en.start(O),!0)},O=>!!en&&(en.update(O),!0),O=>!!en&&(en.release(O),!0),O=>!!en&&(en.cancel(O),en=void 0,!0),O=>{if(!en)return!1;if(en.end(O),en=void 0,m==="selection"){if(O.detail.isTap){const[qe]=yn[Ut];qe.bitmap||Hn.set([])}mt("selectionup",[...ve])}const re=Di.getMarkupItemDraft(),xi=Qt&&(Nt===!0||Array.isArray(Nt)&&Nt.includes(Ut));return re&&!re.isEditing||!xi||i(0,Ut="move"),!0},O=>{const{key:re}=O,xi=Di.getMarkupItemDraft();/escape/i.test(re)&&xi&&(O.preventDefault(),O.stopPropagation(),Di.discardMarkupItemDraft(),en=void 0),/enter/i.test(re)&&xi&&(O.preventDefault(),O.stopPropagation(),Sr(xi),en=void 0)},function(O){Object.keys(O).forEach(re=>{const{retain:xi=!0,share:qe=!0}=M.settings&&M.settings[re]||{};xi&&(oe&&qe?i(115,Gi[re]=O[re],Gi):(Gi[Ut]||i(115,Gi[Ut]={},Gi),i(115,Gi[Ut][re]=O[re],Gi)))}),mt("selectstyle",O),S&&(Di.updateMarkupShape(S,O),clearTimeout(uo),uo=setTimeout(()=>{zn()},200))},(O,re,xi)=>{i(117,pr=re),i(118,Wn=xi)},()=>{i(118,Wn=void 0),i(117,pr=void 0)},O=>{mt("markuptap",O)},O=>i(116,ur=O),()=>{jn=!1},(O,re)=>{if(jn)return;const{beforeAddShape:xi=()=>!0}=Nn,qe=Sn(re),Mt=Di.getMarkupItemDraft(),ye=$u(Jt,{x:qe.x+(ct.x||0),y:qe.y+(ct.y||0)});if(Mt&&!ye&&Di.discardMarkupItemDraft(),ye){if(!Mt){const Mi=Bm(O,Jt),_i=po(Mi,qe);return xi(_i)?(Zp(_i),void Di.addShape(_i)):(jn=!0,void re.preventDefault())}vo(Mt)&&(qe.x-=.5*Mt.width,qe.y-=.5*Mt.height),O.shape&&(Ie(O.shape,"x")&&(qe.x=O.shape.x),Ie(O.shape,"y")&&(qe.y=O.shape.y)),Di.updateMarkupShape(Mt,qe)}},(O,re)=>{if(jn)return;const xi=Sn(re);if(!$u(Jt,{x:xi.x+(ct.x||0),y:xi.y+(ct.y||0)}))return void Di.discardMarkupItemDraft();const qe=Di.confirmMarkupItemDraft();Di.selectShape(qe),mt("addshape",qe),Qi.write()},O=>Jn(O),O=>{return re=O.detail.resources,xi=Sn(O.detail.event),re.forEach(qe=>Jn(qe,xi));var re,xi},O=>{if(!Ye)return!0;const re=rectClone(Tt);return rectScale(re,1/U),rectTranslate(re,Yt),rectScale(re,te.scale),Ye(O,{...re,x:re.x+Vt.x,y:re.y+Vt.y})},zn,Yr,Rn,hr,X,qt,le,Xt,Fe,Nt,Qt,Gt,oe,Qe,De,Ye,Nn,yn,Rr,Gi,ur,pr,Wn,S,k,N,n,m,D,M,tt,V,C,B,y,w,g,l,d,p,a,q,bt,nt,$t,Lt,ie,Vt,ee,be,ve,pi,function(O){Dr.call(this,t,O)},O=>O[0]===Ut,(O,re,xi)=>{const qe=O.filter(([,Mt])=>!Rn.includes(Mt));return ce?ce(qe,re,xi):qe},O=>O[0]===vr,O=>{Promise.resolve().then(()=>{mt("addshape",O),zn()})},O=>{mt("selectshape",O)},O=>{Promise.resolve().then(()=>{mt("blurshape",O)})},O=>{mt("tapshape",O)},O=>{mt("updateshape",O),zn()},O=>{mt("removeshape",O),zn()},function(O){Fi[O?"unshift":"push"](()=>{Di=O,i(27,Di)})},function(O){Fi[O?"unshift":"push"](()=>{ho=O,i(28,ho)})},O=>O.filter(([,re])=>Rn.includes(re)),function(O){Dr.call(this,t,O)}]}class Vu extends li{constructor(e){super(),si(this,e,R6,P6,ri,{isActive:1,isActiveFraction:2,isVisible:3,stores:100,locale:4,shapes:5,toolbar:101,toolShapes:102,toolActive:0,toolSelectRadius:6,toolRetainStyles:103,toolbarLayout:7,textInputMode:8,shapeControls:9,enableButtonFlipVertical:10,enablePresetSelectImage:11,enablePresetDropImage:12,enableSelectToolToAddShape:104,enableAutoSelectMoveTool:105,enableTapToAddText:13,enableMoveTool:106,enableViewTool:107,enableToolShareStyles:108,gridSize:14,snapThreshold:15,enableSnapToContext:16,willRenderHeaderTools:109,willRenderPresetToolbar:110,willRenderShapeStyleControls:17,willStartInteraction:111,shapePresets:18,utilKey:19,mapScreenPointToImagePoint:20,mapImagePointToScreenPoint:21,imageRotation:22,imageFlipX:23,imageFlipY:24,parentRect:25,hooks:112},null,[-1,-1,-1,-1,-1,-1,-1])}get isActive(){return this.$$.ctx[1]}set isActive(e){this.$$set({isActive:e}),I()}get isActiveFraction(){return this.$$.ctx[2]}set isActiveFraction(e){this.$$set({isActiveFraction:e}),I()}get isVisible(){return this.$$.ctx[3]}set isVisible(e){this.$$set({isVisible:e}),I()}get stores(){return this.$$.ctx[100]}set stores(e){this.$$set({stores:e}),I()}get locale(){return this.$$.ctx[4]}set locale(e){this.$$set({locale:e}),I()}get shapes(){return this.$$.ctx[5]}set shapes(e){this.$$set({shapes:e}),I()}get toolbar(){return this.$$.ctx[101]}set toolbar(e){this.$$set({toolbar:e}),I()}get toolShapes(){return this.$$.ctx[102]}set toolShapes(e){this.$$set({toolShapes:e}),I()}get toolActive(){return this.$$.ctx[0]}set toolActive(e){this.$$set({toolActive:e}),I()}get toolSelectRadius(){return this.$$.ctx[6]}set toolSelectRadius(e){this.$$set({toolSelectRadius:e}),I()}get toolRetainStyles(){return this.$$.ctx[103]}set toolRetainStyles(e){this.$$set({toolRetainStyles:e}),I()}get toolbarLayout(){return this.$$.ctx[7]}set toolbarLayout(e){this.$$set({toolbarLayout:e}),I()}get textInputMode(){return this.$$.ctx[8]}set textInputMode(e){this.$$set({textInputMode:e}),I()}get shapeControls(){return this.$$.ctx[9]}set shapeControls(e){this.$$set({shapeControls:e}),I()}get enableButtonFlipVertical(){return this.$$.ctx[10]}set enableButtonFlipVertical(e){this.$$set({enableButtonFlipVertical:e}),I()}get enablePresetSelectImage(){return this.$$.ctx[11]}set enablePresetSelectImage(e){this.$$set({enablePresetSelectImage:e}),I()}get enablePresetDropImage(){return this.$$.ctx[12]}set enablePresetDropImage(e){this.$$set({enablePresetDropImage:e}),I()}get enableSelectToolToAddShape(){return this.$$.ctx[104]}set enableSelectToolToAddShape(e){this.$$set({enableSelectToolToAddShape:e}),I()}get enableAutoSelectMoveTool(){return this.$$.ctx[105]}set enableAutoSelectMoveTool(e){this.$$set({enableAutoSelectMoveTool:e}),I()}get enableTapToAddText(){return this.$$.ctx[13]}set enableTapToAddText(e){this.$$set({enableTapToAddText:e}),I()}get enableMoveTool(){return this.$$.ctx[106]}set enableMoveTool(e){this.$$set({enableMoveTool:e}),I()}get enableViewTool(){return this.$$.ctx[107]}set enableViewTool(e){this.$$set({enableViewTool:e}),I()}get enableToolShareStyles(){return this.$$.ctx[108]}set enableToolShareStyles(e){this.$$set({enableToolShareStyles:e}),I()}get gridSize(){return this.$$.ctx[14]}set gridSize(e){this.$$set({gridSize:e}),I()}get snapThreshold(){return this.$$.ctx[15]}set snapThreshold(e){this.$$set({snapThreshold:e}),I()}get enableSnapToContext(){return this.$$.ctx[16]}set enableSnapToContext(e){this.$$set({enableSnapToContext:e}),I()}get willRenderHeaderTools(){return this.$$.ctx[109]}set willRenderHeaderTools(e){this.$$set({willRenderHeaderTools:e}),I()}get willRenderPresetToolbar(){return this.$$.ctx[110]}set willRenderPresetToolbar(e){this.$$set({willRenderPresetToolbar:e}),I()}get willRenderShapeStyleControls(){return this.$$.ctx[17]}set willRenderShapeStyleControls(e){this.$$set({willRenderShapeStyleControls:e}),I()}get willStartInteraction(){return this.$$.ctx[111]}set willStartInteraction(e){this.$$set({willStartInteraction:e}),I()}get shapePresets(){return this.$$.ctx[18]}set shapePresets(e){this.$$set({shapePresets:e}),I()}get utilKey(){return this.$$.ctx[19]}set utilKey(e){this.$$set({utilKey:e}),I()}get mapScreenPointToImagePoint(){return this.$$.ctx[20]}set mapScreenPointToImagePoint(e){this.$$set({mapScreenPointToImagePoint:e}),I()}get mapImagePointToScreenPoint(){return this.$$.ctx[21]}set mapImagePointToScreenPoint(e){this.$$set({mapImagePointToScreenPoint:e}),I()}get imageRotation(){return this.$$.ctx[22]}set imageRotation(e){this.$$set({imageRotation:e}),I()}get imageFlipX(){return this.$$.ctx[23]}set imageFlipX(e){this.$$set({imageFlipX:e}),I()}get imageFlipY(){return this.$$.ctx[24]}set imageFlipY(e){this.$$set({imageFlipY:e}),I()}get parentRect(){return this.$$.ctx[25]}set parentRect(e){this.$$set({parentRect:e}),I()}get hooks(){return this.$$.ctx[112]}set hooks(e){this.$$set({hooks:e}),I()}}var r0=(t,e,i,n,r,o,a,s,l)=>{const c=Oe(t),d=.5*i.width,u=.5*i.height,p=.5*e.width,h=.5*e.height,g=r.x+n.x,m=r.y+n.y;s&&(c.x=i.width-c.x),l&&(c.y=i.height-c.y);const f=Math.cos(o),b=Math.sin(o);c.x-=d,c.y-=u;const w=c.x*f-c.y*b,S=c.x*b+c.y*f;c.x=d+w,c.y=u+S,c.x*=a,c.y*=a,c.x+=p,c.y+=h,c.x+=g,c.y+=m,c.x-=d*a,c.y-=u*a;const C=(r.x-g)*a,R=(r.y-m)*a,M=C*f-R*b,D=C*b+R*f;return c.x+=M,c.y+=D,c},o0=(t,e,i,n,r,o,a,s,l)=>{const c=Oe(t),d=Dl(i),u=Dl(e),p=ot(r.x+n.x,r.y+n.y),h=Math.cos(o),g=Math.sin(o);c.x-=u.x,c.y-=u.y;const m=(r.x-p.x)*a,f=(r.y-p.y)*a,b=m*h-f*g,w=m*g+f*h;c.x-=b,c.y-=w,c.x-=p.x,c.y-=p.y,c.x/=a,c.y/=a;const S=c.x*h+c.y*g,C=c.x*g-c.y*h;return c.x=S,c.y=-C,c.x+=d.x,c.y+=d.y,s&&(c.x=i.width-c.x),l&&(c.y=i.height-c.y),c},Vl=t=>typeof t=="boolean";function I6(t){let e,i,n;function r(a){t[59](a)}let o={utilKey:t[1],stores:t[5],locale:t[6],isActive:t[2],isActiveFraction:t[3],isVisible:t[4],mapScreenPointToImagePoint:t[45],mapImagePointToScreenPoint:t[44],imageRotation:t[46],imageFlipX:t[43],imageFlipY:t[42],shapes:t[48],toolbar:t[21]||t[7],toolShapes:t[22]||t[8],toolRetainStyles:t[9],enableSelectToolToAddShape:t[31],enableTapToAddText:t[32],enableViewTool:t[30],enableMoveTool:t[34],enableAutoSelectMoveTool:t[33],snapThreshold:t[16],gridSize:ui(t[18])?t[18]:t[15],enableSnapToContext:Vl(t[19])?t[19]:t[17],enableToolShareStyles:t[13],shapeControls:t[23]||t[10],shapePresets:t[27],enableButtonFlipVertical:t[24],parentRect:t[49],enablePresetDropImage:t[26],enablePresetSelectImage:t[25],toolSelectRadius:t[11],textInputMode:t[12],willStartInteraction:t[14],willRenderPresetToolbar:t[28]||t[20],willRenderShapeStyleControls:t[29],hooks:{willRenderShapeControls:t[35],willRenderShapeTextControls:t[36],beforeAddShape:t[37],beforeRemoveShape:t[38],beforeDeselectShape:t[39],beforeSelectShape:t[40],beforeUpdateShape:t[41]}};return t[0]!==void 0&&(o.toolActive=t[0]),e=new Vu({props:o}),Fi.push(()=>go(e,"toolActive",r)),e.$on("measure",t[60]),{c(){Et(e.$$.fragment)},m(a,s){Rt(e,a,s),n=!0},p(a,s){const l={};32&s[0]&&(l.stores=a[5]),64&s[0]&&(l.locale=a[6]),4&s[0]&&(l.isActive=a[2]),8&s[0]&&(l.isActiveFraction=a[3]),16&s[0]&&(l.isVisible=a[4]),16384&s[1]&&(l.mapScreenPointToImagePoint=a[45]),8192&s[1]&&(l.mapImagePointToScreenPoint=a[44]),32768&s[1]&&(l.imageRotation=a[46]),4096&s[1]&&(l.imageFlipX=a[43]),2048&s[1]&&(l.imageFlipY=a[42]),2097280&s[0]&&(l.toolbar=a[21]||a[7]),4194560&s[0]&&(l.toolShapes=a[22]||a[8]),512&s[0]&&(l.toolRetainStyles=a[9]),1&s[1]&&(l.enableSelectToolToAddShape=a[31]),2&s[1]&&(l.enableTapToAddText=a[32]),1073741824&s[0]&&(l.enableViewTool=a[30]),8&s[1]&&(l.enableMoveTool=a[34]),4&s[1]&&(l.enableAutoSelectMoveTool=a[33]),65536&s[0]&&(l.snapThreshold=a[16]),294912&s[0]&&(l.gridSize=ui(a[18])?a[18]:a[15]),655360&s[0]&&(l.enableSnapToContext=Vl(a[19])?a[19]:a[17]),8192&s[0]&&(l.enableToolShareStyles=a[13]),8389632&s[0]&&(l.shapeControls=a[23]||a[10]),134217728&s[0]&&(l.shapePresets=a[27]),16777216&s[0]&&(l.enableButtonFlipVertical=a[24]),67108864&s[0]&&(l.enablePresetDropImage=a[26]),33554432&s[0]&&(l.enablePresetSelectImage=a[25]),2048&s[0]&&(l.toolSelectRadius=a[11]),4096&s[0]&&(l.textInputMode=a[12]),16384&s[0]&&(l.willStartInteraction=a[14]),269484032&s[0]&&(l.willRenderPresetToolbar=a[28]||a[20]),536870912&s[0]&&(l.willRenderShapeStyleControls=a[29]),2032&s[1]&&(l.hooks={willRenderShapeControls:a[35],willRenderShapeTextControls:a[36],beforeAddShape:a[37],beforeRemoveShape:a[38],beforeDeselectShape:a[39],beforeSelectShape:a[40],beforeUpdateShape:a[41]}),!i&&1&s[0]&&(i=!0,l.toolActive=a[0],So(()=>i=!1)),e.$set(l)},i(a){n||(P(e.$$.fragment,a),n=!0)},o(a){z(e.$$.fragment,a),n=!1},d(a){It(e,a)}}}function E6(t,e,i){let n,r,o,a,s,l,c,d,u,{isActive:p}=e,{isActiveFraction:h}=e,{isVisible:g}=e,{stores:m}=e,{locale:f={}}=e,{markupEditorToolbar:b}=e,{markupEditorToolStyles:w}=e,{markupEditorToolRetainStyles:S}=e,{markupEditorShapeStyleControls:C}=e,{markupEditorToolSelectRadius:R}=e,{markupEditorTextInputMode:M}=e,{markupEditorToolShareStyles:D}=e,{markupEditorWillStartInteraction:T}=e,{markupEditorGridSize:F=0}=e,{markupEditorSnapThreshold:W=0}=e,{markupEditorSnapToContext:B=!1}=e,{annotateGridSize:y}=e,{annotateSnapToContext:V}=e,{willRenderShapePresetToolbar:tt}=e,{annotateTools:k}=e,{annotateToolShapes:N}=e,{annotateShapeControls:it}=e,{annotateActiveTool:ut}=e,{annotateEnableButtonFlipVertical:st=!1}=e,{annotateEnableSelectImagePreset:mt=!1}=e,{annotateEnableDropImagePreset:G=!0}=e,{annotatePresets:gt=[]}=e,{annotateWillRenderShapePresetToolbar:vt}=e,{annotateWillRenderShapeStyleControls:lt}=e,{enableViewTool:St}=e,{enableSelectToolToAddShape:J}=e,{enableTapToAddText:q}=e,{enableAutoSelectMoveTool:Z}=e,{enableMoveTool:bt}=e,{willRenderShapeControls:nt}=e,{willRenderShapeTextControls:$t}=e,{beforeAddShape:Lt}=e,{beforeRemoveShape:ie}=e,{beforeDeselectShape:Vt}=e,{beforeSelectShape:te}=e,{beforeUpdateShape:Yt}=e;const{rootRect:U,imageAnnotation:Tt,imageSize:ct,imageRotation:Jt,imageFlipX:de,imageFlipY:ee,imageTransforms:be,imageTransformsInterpolated:ve}=m;return E(t,U,_=>i(58,d=_)),E(t,ct,_=>i(57,c=_)),E(t,Jt,_=>i(46,u=_)),E(t,de,_=>i(43,a=_)),E(t,ee,_=>i(42,o=_)),E(t,be,_=>i(56,l=_)),E(t,ve,_=>i(55,s=_)),t.$$set=_=>{"isActive"in _&&i(2,p=_.isActive),"isActiveFraction"in _&&i(3,h=_.isActiveFraction),"isVisible"in _&&i(4,g=_.isVisible),"stores"in _&&i(5,m=_.stores),"locale"in _&&i(6,f=_.locale),"markupEditorToolbar"in _&&i(7,b=_.markupEditorToolbar),"markupEditorToolStyles"in _&&i(8,w=_.markupEditorToolStyles),"markupEditorToolRetainStyles"in _&&i(9,S=_.markupEditorToolRetainStyles),"markupEditorShapeStyleControls"in _&&i(10,C=_.markupEditorShapeStyleControls),"markupEditorToolSelectRadius"in _&&i(11,R=_.markupEditorToolSelectRadius),"markupEditorTextInputMode"in _&&i(12,M=_.markupEditorTextInputMode),"markupEditorToolShareStyles"in _&&i(13,D=_.markupEditorToolShareStyles),"markupEditorWillStartInteraction"in _&&i(14,T=_.markupEditorWillStartInteraction),"markupEditorGridSize"in _&&i(15,F=_.markupEditorGridSize),"markupEditorSnapThreshold"in _&&i(16,W=_.markupEditorSnapThreshold),"markupEditorSnapToContext"in _&&i(17,B=_.markupEditorSnapToContext),"annotateGridSize"in _&&i(18,y=_.annotateGridSize),"annotateSnapToContext"in _&&i(19,V=_.annotateSnapToContext),"willRenderShapePresetToolbar"in _&&i(20,tt=_.willRenderShapePresetToolbar),"annotateTools"in _&&i(21,k=_.annotateTools),"annotateToolShapes"in _&&i(22,N=_.annotateToolShapes),"annotateShapeControls"in _&&i(23,it=_.annotateShapeControls),"annotateActiveTool"in _&&i(0,ut=_.annotateActiveTool),"annotateEnableButtonFlipVertical"in _&&i(24,st=_.annotateEnableButtonFlipVertical),"annotateEnableSelectImagePreset"in _&&i(25,mt=_.annotateEnableSelectImagePreset),"annotateEnableDropImagePreset"in _&&i(26,G=_.annotateEnableDropImagePreset),"annotatePresets"in _&&i(27,gt=_.annotatePresets),"annotateWillRenderShapePresetToolbar"in _&&i(28,vt=_.annotateWillRenderShapePresetToolbar),"annotateWillRenderShapeStyleControls"in _&&i(29,lt=_.annotateWillRenderShapeStyleControls),"enableViewTool"in _&&i(30,St=_.enableViewTool),"enableSelectToolToAddShape"in _&&i(31,J=_.enableSelectToolToAddShape),"enableTapToAddText"in _&&i(32,q=_.enableTapToAddText),"enableAutoSelectMoveTool"in _&&i(33,Z=_.enableAutoSelectMoveTool),"enableMoveTool"in _&&i(34,bt=_.enableMoveTool),"willRenderShapeControls"in _&&i(35,nt=_.willRenderShapeControls),"willRenderShapeTextControls"in _&&i(36,$t=_.willRenderShapeTextControls),"beforeAddShape"in _&&i(37,Lt=_.beforeAddShape),"beforeRemoveShape"in _&&i(38,ie=_.beforeRemoveShape),"beforeDeselectShape"in _&&i(39,Vt=_.beforeDeselectShape),"beforeSelectShape"in _&&i(40,te=_.beforeSelectShape),"beforeUpdateShape"in _&&i(41,Yt=_.beforeUpdateShape)},t.$$.update=()=>{251664384&t.$$.dirty[1]&&i(45,n=_=>o0(_,d,c,s.origin,s.translation,l.rotation.z,s.scale,a,o)),251664384&t.$$.dirty[1]&&i(44,r=_=>r0(_,d,c,s.origin,s.translation,l.rotation.z,s.scale,a,o))},[ut,"annotate",p,h,g,m,f,b,w,S,C,R,M,D,T,F,W,B,y,V,tt,k,N,it,st,mt,G,gt,vt,lt,St,J,q,Z,bt,nt,$t,Lt,ie,Vt,te,Yt,o,a,r,n,u,U,Tt,ct,Jt,de,ee,be,ve,s,l,c,d,function(_){ut=_,i(0,ut)},function(_){Dr.call(this,t,_)}]}var A6={util:["annotate",class extends li{constructor(t){super(),si(this,t,E6,I6,ri,{name:1,isActive:2,isActiveFraction:3,isVisible:4,stores:5,locale:6,markupEditorToolbar:7,markupEditorToolStyles:8,markupEditorToolRetainStyles:9,markupEditorShapeStyleControls:10,markupEditorToolSelectRadius:11,markupEditorTextInputMode:12,markupEditorToolShareStyles:13,markupEditorWillStartInteraction:14,markupEditorGridSize:15,markupEditorSnapThreshold:16,markupEditorSnapToContext:17,annotateGridSize:18,annotateSnapToContext:19,willRenderShapePresetToolbar:20,annotateTools:21,annotateToolShapes:22,annotateShapeControls:23,annotateActiveTool:0,annotateEnableButtonFlipVertical:24,annotateEnableSelectImagePreset:25,annotateEnableDropImagePreset:26,annotatePresets:27,annotateWillRenderShapePresetToolbar:28,annotateWillRenderShapeStyleControls:29,enableViewTool:30,enableSelectToolToAddShape:31,enableTapToAddText:32,enableAutoSelectMoveTool:33,enableMoveTool:34,willRenderShapeControls:35,willRenderShapeTextControls:36,beforeAddShape:37,beforeRemoveShape:38,beforeDeselectShape:39,beforeSelectShape:40,beforeUpdateShape:41},null,[-1,-1])}get name(){return this.$$.ctx[1]}get isActive(){return this.$$.ctx[2]}set isActive(t){this.$$set({isActive:t}),I()}get isActiveFraction(){return this.$$.ctx[3]}set isActiveFraction(t){this.$$set({isActiveFraction:t}),I()}get isVisible(){return this.$$.ctx[4]}set isVisible(t){this.$$set({isVisible:t}),I()}get stores(){return this.$$.ctx[5]}set stores(t){this.$$set({stores:t}),I()}get locale(){return this.$$.ctx[6]}set locale(t){this.$$set({locale:t}),I()}get markupEditorToolbar(){return this.$$.ctx[7]}set markupEditorToolbar(t){this.$$set({markupEditorToolbar:t}),I()}get markupEditorToolStyles(){return this.$$.ctx[8]}set markupEditorToolStyles(t){this.$$set({markupEditorToolStyles:t}),I()}get markupEditorToolRetainStyles(){return this.$$.ctx[9]}set markupEditorToolRetainStyles(t){this.$$set({markupEditorToolRetainStyles:t}),I()}get markupEditorShapeStyleControls(){return this.$$.ctx[10]}set markupEditorShapeStyleControls(t){this.$$set({markupEditorShapeStyleControls:t}),I()}get markupEditorToolSelectRadius(){return this.$$.ctx[11]}set markupEditorToolSelectRadius(t){this.$$set({markupEditorToolSelectRadius:t}),I()}get markupEditorTextInputMode(){return this.$$.ctx[12]}set markupEditorTextInputMode(t){this.$$set({markupEditorTextInputMode:t}),I()}get markupEditorToolShareStyles(){return this.$$.ctx[13]}set markupEditorToolShareStyles(t){this.$$set({markupEditorToolShareStyles:t}),I()}get markupEditorWillStartInteraction(){return this.$$.ctx[14]}set markupEditorWillStartInteraction(t){this.$$set({markupEditorWillStartInteraction:t}),I()}get markupEditorGridSize(){return this.$$.ctx[15]}set markupEditorGridSize(t){this.$$set({markupEditorGridSize:t}),I()}get markupEditorSnapThreshold(){return this.$$.ctx[16]}set markupEditorSnapThreshold(t){this.$$set({markupEditorSnapThreshold:t}),I()}get markupEditorSnapToContext(){return this.$$.ctx[17]}set markupEditorSnapToContext(t){this.$$set({markupEditorSnapToContext:t}),I()}get annotateGridSize(){return this.$$.ctx[18]}set annotateGridSize(t){this.$$set({annotateGridSize:t}),I()}get annotateSnapToContext(){return this.$$.ctx[19]}set annotateSnapToContext(t){this.$$set({annotateSnapToContext:t}),I()}get willRenderShapePresetToolbar(){return this.$$.ctx[20]}set willRenderShapePresetToolbar(t){this.$$set({willRenderShapePresetToolbar:t}),I()}get annotateTools(){return this.$$.ctx[21]}set annotateTools(t){this.$$set({annotateTools:t}),I()}get annotateToolShapes(){return this.$$.ctx[22]}set annotateToolShapes(t){this.$$set({annotateToolShapes:t}),I()}get annotateShapeControls(){return this.$$.ctx[23]}set annotateShapeControls(t){this.$$set({annotateShapeControls:t}),I()}get annotateActiveTool(){return this.$$.ctx[0]}set annotateActiveTool(t){this.$$set({annotateActiveTool:t}),I()}get annotateEnableButtonFlipVertical(){return this.$$.ctx[24]}set annotateEnableButtonFlipVertical(t){this.$$set({annotateEnableButtonFlipVertical:t}),I()}get annotateEnableSelectImagePreset(){return this.$$.ctx[25]}set annotateEnableSelectImagePreset(t){this.$$set({annotateEnableSelectImagePreset:t}),I()}get annotateEnableDropImagePreset(){return this.$$.ctx[26]}set annotateEnableDropImagePreset(t){this.$$set({annotateEnableDropImagePreset:t}),I()}get annotatePresets(){return this.$$.ctx[27]}set annotatePresets(t){this.$$set({annotatePresets:t}),I()}get annotateWillRenderShapePresetToolbar(){return this.$$.ctx[28]}set annotateWillRenderShapePresetToolbar(t){this.$$set({annotateWillRenderShapePresetToolbar:t}),I()}get annotateWillRenderShapeStyleControls(){return this.$$.ctx[29]}set annotateWillRenderShapeStyleControls(t){this.$$set({annotateWillRenderShapeStyleControls:t}),I()}get enableViewTool(){return this.$$.ctx[30]}set enableViewTool(t){this.$$set({enableViewTool:t}),I()}get enableSelectToolToAddShape(){return this.$$.ctx[31]}set enableSelectToolToAddShape(t){this.$$set({enableSelectToolToAddShape:t}),I()}get enableTapToAddText(){return this.$$.ctx[32]}set enableTapToAddText(t){this.$$set({enableTapToAddText:t}),I()}get enableAutoSelectMoveTool(){return this.$$.ctx[33]}set enableAutoSelectMoveTool(t){this.$$set({enableAutoSelectMoveTool:t}),I()}get enableMoveTool(){return this.$$.ctx[34]}set enableMoveTool(t){this.$$set({enableMoveTool:t}),I()}get willRenderShapeControls(){return this.$$.ctx[35]}set willRenderShapeControls(t){this.$$set({willRenderShapeControls:t}),I()}get willRenderShapeTextControls(){return this.$$.ctx[36]}set willRenderShapeTextControls(t){this.$$set({willRenderShapeTextControls:t}),I()}get beforeAddShape(){return this.$$.ctx[37]}set beforeAddShape(t){this.$$set({beforeAddShape:t}),I()}get beforeRemoveShape(){return this.$$.ctx[38]}set beforeRemoveShape(t){this.$$set({beforeRemoveShape:t}),I()}get beforeDeselectShape(){return this.$$.ctx[39]}set beforeDeselectShape(t){this.$$set({beforeDeselectShape:t}),I()}get beforeSelectShape(){return this.$$.ctx[40]}set beforeSelectShape(t){this.$$set({beforeSelectShape:t}),I()}get beforeUpdateShape(){return this.$$.ctx[41]}set beforeUpdateShape(t){this.$$set({beforeUpdateShape:t}),I()}}]};function L6(t){let e,i,n;function r(a){t[51](a)}let o={utilKey:t[1],stores:t[5],locale:t[6],isActive:t[2],isActiveFraction:t[3],isVisible:t[4],mapScreenPointToImagePoint:t[43],mapImagePointToScreenPoint:t[42],shapes:t[45],toolbar:t[20]||t[7],toolShapes:t[21]||t[8],toolRetainStyles:t[9],shapeControls:t[22]||t[10],shapePresets:t[26],enableSelectToolToAddShape:t[29],enableTapToAddText:t[30],enableViewTool:t[31],enableMoveTool:t[32],enableAutoSelectMoveTool:t[33],snapThreshold:t[16],gridSize:ui(t[18])?t[18]:t[15],enableSnapToContext:Vl(t[19])?t[19]:t[17],enableToolShareStyles:t[13],enablePresetSelectImage:t[24],enablePresetDropImage:t[25],enableButtonFlipVertical:t[23],parentRect:t[44],toolSelectRadius:t[11],textInputMode:t[12],willStartInteraction:t[41],willRenderPresetToolbar:t[27]||t[14],willRenderShapeStyleControls:t[28],hooks:{willRenderShapeControls:t[34],willRenderShapeTextControls:t[35],beforeAddShape:t[36],beforeRemoveShape:t[37],beforeDeselectShape:t[38],beforeSelectShape:t[39],beforeUpdateShape:t[40]}};return t[0]!==void 0&&(o.toolActive=t[0]),e=new Vu({props:o}),Fi.push(()=>go(e,"toolActive",r)),e.$on("measure",t[52]),{c(){Et(e.$$.fragment)},m(a,s){Rt(e,a,s),n=!0},p(a,s){const l={};32&s[0]&&(l.stores=a[5]),64&s[0]&&(l.locale=a[6]),4&s[0]&&(l.isActive=a[2]),8&s[0]&&(l.isActiveFraction=a[3]),16&s[0]&&(l.isVisible=a[4]),4096&s[1]&&(l.mapScreenPointToImagePoint=a[43]),2048&s[1]&&(l.mapImagePointToScreenPoint=a[42]),1048704&s[0]&&(l.toolbar=a[20]||a[7]),2097408&s[0]&&(l.toolShapes=a[21]||a[8]),512&s[0]&&(l.toolRetainStyles=a[9]),4195328&s[0]&&(l.shapeControls=a[22]||a[10]),67108864&s[0]&&(l.shapePresets=a[26]),536870912&s[0]&&(l.enableSelectToolToAddShape=a[29]),1073741824&s[0]&&(l.enableTapToAddText=a[30]),1&s[1]&&(l.enableViewTool=a[31]),2&s[1]&&(l.enableMoveTool=a[32]),4&s[1]&&(l.enableAutoSelectMoveTool=a[33]),65536&s[0]&&(l.snapThreshold=a[16]),294912&s[0]&&(l.gridSize=ui(a[18])?a[18]:a[15]),655360&s[0]&&(l.enableSnapToContext=Vl(a[19])?a[19]:a[17]),8192&s[0]&&(l.enableToolShareStyles=a[13]),16777216&s[0]&&(l.enablePresetSelectImage=a[24]),33554432&s[0]&&(l.enablePresetDropImage=a[25]),8388608&s[0]&&(l.enableButtonFlipVertical=a[23]),2048&s[0]&&(l.toolSelectRadius=a[11]),4096&s[0]&&(l.textInputMode=a[12]),1024&s[1]&&(l.willStartInteraction=a[41]),134234112&s[0]&&(l.willRenderPresetToolbar=a[27]||a[14]),268435456&s[0]&&(l.willRenderShapeStyleControls=a[28]),1016&s[1]&&(l.hooks={willRenderShapeControls:a[34],willRenderShapeTextControls:a[35],beforeAddShape:a[36],beforeRemoveShape:a[37],beforeDeselectShape:a[38],beforeSelectShape:a[39],beforeUpdateShape:a[40]}),!i&&1&s[0]&&(i=!0,l.toolActive=a[0],So(()=>i=!1)),e.$set(l)},i(a){n||(P(e.$$.fragment,a),n=!0)},o(a){z(e.$$.fragment,a),n=!1},d(a){It(e,a)}}}function z6(t,e,i){let n,r,o,a,s,{isActive:l}=e,{isActiveFraction:c}=e,{isVisible:d}=e,{stores:u}=e,{locale:p={}}=e,{markupEditorToolbar:h}=e,{markupEditorToolStyles:g}=e,{markupEditorToolRetainStyles:m}=e,{markupEditorShapeStyleControls:f}=e,{markupEditorToolSelectRadius:b}=e,{markupEditorTextInputMode:w}=e,{markupEditorToolShareStyles:S}=e,{willRenderShapePresetToolbar:C}=e,{markupEditorGridSize:R}=e,{markupEditorSnapThreshold:M}=e,{markupEditorSnapToContext:D=!0}=e,{decorateGridSize:T}=e,{decorateSnapToContext:F}=e,{decorateTools:W}=e,{decorateToolShapes:B}=e,{decorateShapeControls:y}=e,{decorateActiveTool:V}=e,{decorateEnableButtonFlipVertical:tt=!1}=e,{decorateEnableSelectImagePreset:k=!1}=e,{decorateEnableDropImagePreset:N=!0}=e,{decoratePresets:it=[]}=e,{decorateWillRenderShapePresetToolbar:ut}=e,{decorateWillRenderShapeStyleControls:st}=e,{enableSelectToolToAddShape:mt}=e,{enableTapToAddText:G}=e,{enableViewTool:gt}=e,{enableMoveTool:vt}=e,{enableAutoSelectMoveTool:lt}=e,{willRenderShapeControls:St}=e,{willRenderShapeTextControls:J}=e,{beforeAddShape:q}=e,{beforeRemoveShape:Z}=e,{beforeDeselectShape:bt}=e,{beforeSelectShape:nt}=e,{beforeUpdateShape:$t}=e,{markupEditorWillStartInteraction:Lt}=e;const{imageCropRect:ie,imageDecoration:Vt,imageSelectionRectPresentation:te,imageTransformsInterpolated:Yt}=u;return E(t,te,U=>i(49,a=U)),E(t,Yt,U=>i(50,s=U)),t.$$set=U=>{"isActive"in U&&i(2,l=U.isActive),"isActiveFraction"in U&&i(3,c=U.isActiveFraction),"isVisible"in U&&i(4,d=U.isVisible),"stores"in U&&i(5,u=U.stores),"locale"in U&&i(6,p=U.locale),"markupEditorToolbar"in U&&i(7,h=U.markupEditorToolbar),"markupEditorToolStyles"in U&&i(8,g=U.markupEditorToolStyles),"markupEditorToolRetainStyles"in U&&i(9,m=U.markupEditorToolRetainStyles),"markupEditorShapeStyleControls"in U&&i(10,f=U.markupEditorShapeStyleControls),"markupEditorToolSelectRadius"in U&&i(11,b=U.markupEditorToolSelectRadius),"markupEditorTextInputMode"in U&&i(12,w=U.markupEditorTextInputMode),"markupEditorToolShareStyles"in U&&i(13,S=U.markupEditorToolShareStyles),"willRenderShapePresetToolbar"in U&&i(14,C=U.willRenderShapePresetToolbar),"markupEditorGridSize"in U&&i(15,R=U.markupEditorGridSize),"markupEditorSnapThreshold"in U&&i(16,M=U.markupEditorSnapThreshold),"markupEditorSnapToContext"in U&&i(17,D=U.markupEditorSnapToContext),"decorateGridSize"in U&&i(18,T=U.decorateGridSize),"decorateSnapToContext"in U&&i(19,F=U.decorateSnapToContext),"decorateTools"in U&&i(20,W=U.decorateTools),"decorateToolShapes"in U&&i(21,B=U.decorateToolShapes),"decorateShapeControls"in U&&i(22,y=U.decorateShapeControls),"decorateActiveTool"in U&&i(0,V=U.decorateActiveTool),"decorateEnableButtonFlipVertical"in U&&i(23,tt=U.decorateEnableButtonFlipVertical),"decorateEnableSelectImagePreset"in U&&i(24,k=U.decorateEnableSelectImagePreset),"decorateEnableDropImagePreset"in U&&i(25,N=U.decorateEnableDropImagePreset),"decoratePresets"in U&&i(26,it=U.decoratePresets),"decorateWillRenderShapePresetToolbar"in U&&i(27,ut=U.decorateWillRenderShapePresetToolbar),"decorateWillRenderShapeStyleControls"in U&&i(28,st=U.decorateWillRenderShapeStyleControls),"enableSelectToolToAddShape"in U&&i(29,mt=U.enableSelectToolToAddShape),"enableTapToAddText"in U&&i(30,G=U.enableTapToAddText),"enableViewTool"in U&&i(31,gt=U.enableViewTool),"enableMoveTool"in U&&i(32,vt=U.enableMoveTool),"enableAutoSelectMoveTool"in U&&i(33,lt=U.enableAutoSelectMoveTool),"willRenderShapeControls"in U&&i(34,St=U.willRenderShapeControls),"willRenderShapeTextControls"in U&&i(35,J=U.willRenderShapeTextControls),"beforeAddShape"in U&&i(36,q=U.beforeAddShape),"beforeRemoveShape"in U&&i(37,Z=U.beforeRemoveShape),"beforeDeselectShape"in U&&i(38,bt=U.beforeDeselectShape),"beforeSelectShape"in U&&i(39,nt=U.beforeSelectShape),"beforeUpdateShape"in U&&i(40,$t=U.beforeUpdateShape),"markupEditorWillStartInteraction"in U&&i(41,Lt=U.markupEditorWillStartInteraction)},t.$$.update=()=>{524288&t.$$.dirty[1]&&i(48,n=s?s.scale:1),393216&t.$$.dirty[1]&&i(43,r=U=>{const Tt=Oe(U);return Tt.x-=a.x,Tt.y-=a.y,Tt.x/=n,Tt.y/=n,Tt}),393216&t.$$.dirty[1]&&i(42,o=U=>{const Tt=Oe(U);return Tt.x*=n,Tt.y*=n,Tt.x+=a.x,Tt.y+=a.y,Tt})},[V,"decorate",l,c,d,u,p,h,g,m,f,b,w,S,C,R,M,D,T,F,W,B,y,tt,k,N,it,ut,st,mt,G,gt,vt,lt,St,J,q,Z,bt,nt,$t,Lt,o,r,ie,Vt,te,Yt,n,a,s,function(U){V=U,i(0,V)},function(U){Dr.call(this,t,U)}]}var F6={util:["decorate",class extends li{constructor(t){super(),si(this,t,z6,L6,ri,{name:1,isActive:2,isActiveFraction:3,isVisible:4,stores:5,locale:6,markupEditorToolbar:7,markupEditorToolStyles:8,markupEditorToolRetainStyles:9,markupEditorShapeStyleControls:10,markupEditorToolSelectRadius:11,markupEditorTextInputMode:12,markupEditorToolShareStyles:13,willRenderShapePresetToolbar:14,markupEditorGridSize:15,markupEditorSnapThreshold:16,markupEditorSnapToContext:17,decorateGridSize:18,decorateSnapToContext:19,decorateTools:20,decorateToolShapes:21,decorateShapeControls:22,decorateActiveTool:0,decorateEnableButtonFlipVertical:23,decorateEnableSelectImagePreset:24,decorateEnableDropImagePreset:25,decoratePresets:26,decorateWillRenderShapePresetToolbar:27,decorateWillRenderShapeStyleControls:28,enableSelectToolToAddShape:29,enableTapToAddText:30,enableViewTool:31,enableMoveTool:32,enableAutoSelectMoveTool:33,willRenderShapeControls:34,willRenderShapeTextControls:35,beforeAddShape:36,beforeRemoveShape:37,beforeDeselectShape:38,beforeSelectShape:39,beforeUpdateShape:40,markupEditorWillStartInteraction:41},null,[-1,-1])}get name(){return this.$$.ctx[1]}get isActive(){return this.$$.ctx[2]}set isActive(t){this.$$set({isActive:t}),I()}get isActiveFraction(){return this.$$.ctx[3]}set isActiveFraction(t){this.$$set({isActiveFraction:t}),I()}get isVisible(){return this.$$.ctx[4]}set isVisible(t){this.$$set({isVisible:t}),I()}get stores(){return this.$$.ctx[5]}set stores(t){this.$$set({stores:t}),I()}get locale(){return this.$$.ctx[6]}set locale(t){this.$$set({locale:t}),I()}get markupEditorToolbar(){return this.$$.ctx[7]}set markupEditorToolbar(t){this.$$set({markupEditorToolbar:t}),I()}get markupEditorToolStyles(){return this.$$.ctx[8]}set markupEditorToolStyles(t){this.$$set({markupEditorToolStyles:t}),I()}get markupEditorToolRetainStyles(){return this.$$.ctx[9]}set markupEditorToolRetainStyles(t){this.$$set({markupEditorToolRetainStyles:t}),I()}get markupEditorShapeStyleControls(){return this.$$.ctx[10]}set markupEditorShapeStyleControls(t){this.$$set({markupEditorShapeStyleControls:t}),I()}get markupEditorToolSelectRadius(){return this.$$.ctx[11]}set markupEditorToolSelectRadius(t){this.$$set({markupEditorToolSelectRadius:t}),I()}get markupEditorTextInputMode(){return this.$$.ctx[12]}set markupEditorTextInputMode(t){this.$$set({markupEditorTextInputMode:t}),I()}get markupEditorToolShareStyles(){return this.$$.ctx[13]}set markupEditorToolShareStyles(t){this.$$set({markupEditorToolShareStyles:t}),I()}get willRenderShapePresetToolbar(){return this.$$.ctx[14]}set willRenderShapePresetToolbar(t){this.$$set({willRenderShapePresetToolbar:t}),I()}get markupEditorGridSize(){return this.$$.ctx[15]}set markupEditorGridSize(t){this.$$set({markupEditorGridSize:t}),I()}get markupEditorSnapThreshold(){return this.$$.ctx[16]}set markupEditorSnapThreshold(t){this.$$set({markupEditorSnapThreshold:t}),I()}get markupEditorSnapToContext(){return this.$$.ctx[17]}set markupEditorSnapToContext(t){this.$$set({markupEditorSnapToContext:t}),I()}get decorateGridSize(){return this.$$.ctx[18]}set decorateGridSize(t){this.$$set({decorateGridSize:t}),I()}get decorateSnapToContext(){return this.$$.ctx[19]}set decorateSnapToContext(t){this.$$set({decorateSnapToContext:t}),I()}get decorateTools(){return this.$$.ctx[20]}set decorateTools(t){this.$$set({decorateTools:t}),I()}get decorateToolShapes(){return this.$$.ctx[21]}set decorateToolShapes(t){this.$$set({decorateToolShapes:t}),I()}get decorateShapeControls(){return this.$$.ctx[22]}set decorateShapeControls(t){this.$$set({decorateShapeControls:t}),I()}get decorateActiveTool(){return this.$$.ctx[0]}set decorateActiveTool(t){this.$$set({decorateActiveTool:t}),I()}get decorateEnableButtonFlipVertical(){return this.$$.ctx[23]}set decorateEnableButtonFlipVertical(t){this.$$set({decorateEnableButtonFlipVertical:t}),I()}get decorateEnableSelectImagePreset(){return this.$$.ctx[24]}set decorateEnableSelectImagePreset(t){this.$$set({decorateEnableSelectImagePreset:t}),I()}get decorateEnableDropImagePreset(){return this.$$.ctx[25]}set decorateEnableDropImagePreset(t){this.$$set({decorateEnableDropImagePreset:t}),I()}get decoratePresets(){return this.$$.ctx[26]}set decoratePresets(t){this.$$set({decoratePresets:t}),I()}get decorateWillRenderShapePresetToolbar(){return this.$$.ctx[27]}set decorateWillRenderShapePresetToolbar(t){this.$$set({decorateWillRenderShapePresetToolbar:t}),I()}get decorateWillRenderShapeStyleControls(){return this.$$.ctx[28]}set decorateWillRenderShapeStyleControls(t){this.$$set({decorateWillRenderShapeStyleControls:t}),I()}get enableSelectToolToAddShape(){return this.$$.ctx[29]}set enableSelectToolToAddShape(t){this.$$set({enableSelectToolToAddShape:t}),I()}get enableTapToAddText(){return this.$$.ctx[30]}set enableTapToAddText(t){this.$$set({enableTapToAddText:t}),I()}get enableViewTool(){return this.$$.ctx[31]}set enableViewTool(t){this.$$set({enableViewTool:t}),I()}get enableMoveTool(){return this.$$.ctx[32]}set enableMoveTool(t){this.$$set({enableMoveTool:t}),I()}get enableAutoSelectMoveTool(){return this.$$.ctx[33]}set enableAutoSelectMoveTool(t){this.$$set({enableAutoSelectMoveTool:t}),I()}get willRenderShapeControls(){return this.$$.ctx[34]}set willRenderShapeControls(t){this.$$set({willRenderShapeControls:t}),I()}get willRenderShapeTextControls(){return this.$$.ctx[35]}set willRenderShapeTextControls(t){this.$$set({willRenderShapeTextControls:t}),I()}get beforeAddShape(){return this.$$.ctx[36]}set beforeAddShape(t){this.$$set({beforeAddShape:t}),I()}get beforeRemoveShape(){return this.$$.ctx[37]}set beforeRemoveShape(t){this.$$set({beforeRemoveShape:t}),I()}get beforeDeselectShape(){return this.$$.ctx[38]}set beforeDeselectShape(t){this.$$set({beforeDeselectShape:t}),I()}get beforeSelectShape(){return this.$$.ctx[39]}set beforeSelectShape(t){this.$$set({beforeSelectShape:t}),I()}get beforeUpdateShape(){return this.$$.ctx[40]}set beforeUpdateShape(t){this.$$set({beforeUpdateShape:t}),I()}get markupEditorWillStartInteraction(){return this.$$.ctx[41]}set markupEditorWillStartInteraction(t){this.$$set({markupEditorWillStartInteraction:t}),I()}}]};function D6(t){let e,i;return e=new Vu({props:{stores:t[3],locale:t[4],isActive:t[0],isActiveFraction:t[1],isVisible:t[2],mapScreenPointToImagePoint:t[25],mapImagePointToScreenPoint:t[24],utilKey:"sticker",shapePresets:t[5],shapes:t[6]?t[34]:t[35],toolActive:"preset",imageFlipX:!!t[6]&&t[23],imageFlipY:!!t[6]&&t[22],imageRotation:t[6]?t[30]:0,parentRect:t[6]?t[36]:t[32],snapThreshold:t[28],gridSize:t[27],enableSnapToContext:t[26],enablePresetDropImage:t[7],enablePresetSelectImage:t[29],enableButtonFlipVertical:t[10]||t[8],toolSelectRadius:t[14],willStartInteraction:t[21],willRenderPresetToolbar:t[11]||t[9]||t[15],hooks:{willRenderShapeControls:t[12],willRenderShapeTextControls:t[13],beforeAddShape:t[16],beforeRemoveShape:t[17],beforeDeselectShape:t[18],beforeSelectShape:t[19],beforeUpdateShape:t[20]}}}),e.$on("measure",t[59]),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};8&r[0]&&(o.stores=n[3]),16&r[0]&&(o.locale=n[4]),1&r[0]&&(o.isActive=n[0]),2&r[0]&&(o.isActiveFraction=n[1]),4&r[0]&&(o.isVisible=n[2]),33554432&r[0]&&(o.mapScreenPointToImagePoint=n[25]),16777216&r[0]&&(o.mapImagePointToScreenPoint=n[24]),32&r[0]&&(o.shapePresets=n[5]),64&r[0]&&(o.shapes=n[6]?n[34]:n[35]),8388672&r[0]&&(o.imageFlipX=!!n[6]&&n[23]),4194368&r[0]&&(o.imageFlipY=!!n[6]&&n[22]),1073741888&r[0]&&(o.imageRotation=n[6]?n[30]:0),64&r[0]&&(o.parentRect=n[6]?n[36]:n[32]),268435456&r[0]&&(o.snapThreshold=n[28]),134217728&r[0]&&(o.gridSize=n[27]),67108864&r[0]&&(o.enableSnapToContext=n[26]),128&r[0]&&(o.enablePresetDropImage=n[7]),536870912&r[0]&&(o.enablePresetSelectImage=n[29]),1280&r[0]&&(o.enableButtonFlipVertical=n[10]||n[8]),16384&r[0]&&(o.toolSelectRadius=n[14]),2097152&r[0]&&(o.willStartInteraction=n[21]),35328&r[0]&&(o.willRenderPresetToolbar=n[11]||n[9]||n[15]),2043904&r[0]&&(o.hooks={willRenderShapeControls:n[12],willRenderShapeTextControls:n[13],beforeAddShape:n[16],beforeRemoveShape:n[17],beforeDeselectShape:n[18],beforeSelectShape:n[19],beforeUpdateShape:n[20]}),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function B6(t,e,i){let n,r,o,a,s,l,c,d,u,p,h,g,m,f,b,{isActive:w}=e,{isActiveFraction:S}=e,{isVisible:C}=e,{stores:R}=e,{locale:M={}}=e,{stickers:D=[]}=e,{stickerForceEnable:T=!1}=e,{stickerStickToImage:F=!1}=e,{stickerEnableSelectImagePreset:W=!0}=e,{stickerEnableDropImagePreset:B=!0}=e,{stickerEnableButtonFlipVertical:y=!1}=e,{stickerWillRenderShapePresetToolbar:V}=e,{stickerEnableSelectImage:tt=!0}=e,{stickersEnableButtonFlipVertical:k=!1}=e,{stickersWillRenderShapePresetToolbar:N}=e,{markupEditorGridSize:it=0}=e,{markupEditorSnapThreshold:ut=0}=e,{markupEditorSnapToContext:st=!1}=e,{annotateGridSize:mt}=e,{annotateSnapToContext:G}=e,{decorateGridSize:gt}=e,{decorateSnapToContext:vt}=e,{willRenderShapeControls:lt}=e,{willRenderShapeTextControls:St}=e,{markupEditorToolSelectRadius:J}=e,{willRenderShapePresetToolbar:q}=e,{beforeAddShape:Z}=e,{beforeRemoveShape:bt}=e,{beforeDeselectShape:nt}=e,{beforeSelectShape:$t}=e,{beforeUpdateShape:Lt}=e,{markupEditorWillStartInteraction:ie}=e;const{rootRect:Vt,imageCropRect:te,imageSelectionRectPresentation:Yt,imageAnnotation:U,imageDecoration:Tt,imageSize:ct,imageTransforms:Jt,imageTransformsInterpolated:de,imageRotation:ee,imageFlipX:be,imageFlipY:ve}=R;return E(t,Vt,_=>i(58,f=_)),E(t,Yt,_=>i(54,d=_)),E(t,ct,_=>i(57,m=_)),E(t,Jt,_=>i(56,g=_)),E(t,de,_=>i(55,h=_)),E(t,ee,_=>i(30,b=_)),E(t,be,_=>i(23,p=_)),E(t,ve,_=>i(22,u=_)),t.$$set=_=>{"isActive"in _&&i(0,w=_.isActive),"isActiveFraction"in _&&i(1,S=_.isActiveFraction),"isVisible"in _&&i(2,C=_.isVisible),"stores"in _&&i(3,R=_.stores),"locale"in _&&i(4,M=_.locale),"stickers"in _&&i(5,D=_.stickers),"stickerForceEnable"in _&&i(43,T=_.stickerForceEnable),"stickerStickToImage"in _&&i(6,F=_.stickerStickToImage),"stickerEnableSelectImagePreset"in _&&i(44,W=_.stickerEnableSelectImagePreset),"stickerEnableDropImagePreset"in _&&i(7,B=_.stickerEnableDropImagePreset),"stickerEnableButtonFlipVertical"in _&&i(8,y=_.stickerEnableButtonFlipVertical),"stickerWillRenderShapePresetToolbar"in _&&i(9,V=_.stickerWillRenderShapePresetToolbar),"stickerEnableSelectImage"in _&&i(45,tt=_.stickerEnableSelectImage),"stickersEnableButtonFlipVertical"in _&&i(10,k=_.stickersEnableButtonFlipVertical),"stickersWillRenderShapePresetToolbar"in _&&i(11,N=_.stickersWillRenderShapePresetToolbar),"markupEditorGridSize"in _&&i(46,it=_.markupEditorGridSize),"markupEditorSnapThreshold"in _&&i(47,ut=_.markupEditorSnapThreshold),"markupEditorSnapToContext"in _&&i(48,st=_.markupEditorSnapToContext),"annotateGridSize"in _&&i(49,mt=_.annotateGridSize),"annotateSnapToContext"in _&&i(50,G=_.annotateSnapToContext),"decorateGridSize"in _&&i(51,gt=_.decorateGridSize),"decorateSnapToContext"in _&&i(52,vt=_.decorateSnapToContext),"willRenderShapeControls"in _&&i(12,lt=_.willRenderShapeControls),"willRenderShapeTextControls"in _&&i(13,St=_.willRenderShapeTextControls),"markupEditorToolSelectRadius"in _&&i(14,J=_.markupEditorToolSelectRadius),"willRenderShapePresetToolbar"in _&&i(15,q=_.willRenderShapePresetToolbar),"beforeAddShape"in _&&i(16,Z=_.beforeAddShape),"beforeRemoveShape"in _&&i(17,bt=_.beforeRemoveShape),"beforeDeselectShape"in _&&i(18,nt=_.beforeDeselectShape),"beforeSelectShape"in _&&i(19,$t=_.beforeSelectShape),"beforeUpdateShape"in _&&i(20,Lt=_.beforeUpdateShape),"markupEditorWillStartInteraction"in _&&i(21,ie=_.markupEditorWillStartInteraction)},t.$$.update=()=>{16777216&t.$$.dirty[1]&&i(53,n=h?h.scale:1),24576&t.$$.dirty[1]&&i(29,r=W!==!1&&tt),65536&t.$$.dirty[1]&&i(28,o=ut),64&t.$$.dirty[0]|1343488&t.$$.dirty[1]&&i(27,a=F?ui(mt)?mt:it:ui(gt)?gt:it),64&t.$$.dirty[0]|2752512&t.$$.dirty[1]&&i(26,s=F?Vl(G)?G:st:Vl(vt)?vt:st),12582976&t.$$.dirty[0]|264241152&t.$$.dirty[1]&&i(25,l=F?_=>o0(_,f,m,h.origin,h.translation,g.rotation.z,h.scale,p,u):_=>{const Ce=Oe(_);return Ce.x-=d.x,Ce.y-=d.y,Ce.x/=n,Ce.y/=n,Ce}),12582976&t.$$.dirty[0]|264241152&t.$$.dirty[1]&&i(24,c=F?_=>r0(_,f,m,h.origin,h.translation,g.rotation.z,h.scale,p,u):_=>{const Ce=Oe(_);return Ce.x*=n,Ce.y*=n,Ce.x+=d.x,Ce.y+=d.y,Ce})},[w,S,C,R,M,D,F,B,y,V,k,N,lt,St,J,q,Z,bt,nt,$t,Lt,ie,u,p,c,l,s,a,o,r,b,Vt,te,Yt,U,Tt,ct,Jt,de,ee,be,ve,"sticker",T,W,tt,it,ut,st,mt,G,gt,vt,n,d,h,g,m,f,function(_){Dr.call(this,t,_)}]}var O6={util:["sticker",class extends li{constructor(t){super(),si(this,t,B6,D6,ri,{name:42,isActive:0,isActiveFraction:1,isVisible:2,stores:3,locale:4,stickers:5,stickerForceEnable:43,stickerStickToImage:6,stickerEnableSelectImagePreset:44,stickerEnableDropImagePreset:7,stickerEnableButtonFlipVertical:8,stickerWillRenderShapePresetToolbar:9,stickerEnableSelectImage:45,stickersEnableButtonFlipVertical:10,stickersWillRenderShapePresetToolbar:11,markupEditorGridSize:46,markupEditorSnapThreshold:47,markupEditorSnapToContext:48,annotateGridSize:49,annotateSnapToContext:50,decorateGridSize:51,decorateSnapToContext:52,willRenderShapeControls:12,willRenderShapeTextControls:13,markupEditorToolSelectRadius:14,willRenderShapePresetToolbar:15,beforeAddShape:16,beforeRemoveShape:17,beforeDeselectShape:18,beforeSelectShape:19,beforeUpdateShape:20,markupEditorWillStartInteraction:21},null,[-1,-1])}get name(){return this.$$.ctx[42]}get isActive(){return this.$$.ctx[0]}set isActive(t){this.$$set({isActive:t}),I()}get isActiveFraction(){return this.$$.ctx[1]}set isActiveFraction(t){this.$$set({isActiveFraction:t}),I()}get isVisible(){return this.$$.ctx[2]}set isVisible(t){this.$$set({isVisible:t}),I()}get stores(){return this.$$.ctx[3]}set stores(t){this.$$set({stores:t}),I()}get locale(){return this.$$.ctx[4]}set locale(t){this.$$set({locale:t}),I()}get stickers(){return this.$$.ctx[5]}set stickers(t){this.$$set({stickers:t}),I()}get stickerForceEnable(){return this.$$.ctx[43]}set stickerForceEnable(t){this.$$set({stickerForceEnable:t}),I()}get stickerStickToImage(){return this.$$.ctx[6]}set stickerStickToImage(t){this.$$set({stickerStickToImage:t}),I()}get stickerEnableSelectImagePreset(){return this.$$.ctx[44]}set stickerEnableSelectImagePreset(t){this.$$set({stickerEnableSelectImagePreset:t}),I()}get stickerEnableDropImagePreset(){return this.$$.ctx[7]}set stickerEnableDropImagePreset(t){this.$$set({stickerEnableDropImagePreset:t}),I()}get stickerEnableButtonFlipVertical(){return this.$$.ctx[8]}set stickerEnableButtonFlipVertical(t){this.$$set({stickerEnableButtonFlipVertical:t}),I()}get stickerWillRenderShapePresetToolbar(){return this.$$.ctx[9]}set stickerWillRenderShapePresetToolbar(t){this.$$set({stickerWillRenderShapePresetToolbar:t}),I()}get stickerEnableSelectImage(){return this.$$.ctx[45]}set stickerEnableSelectImage(t){this.$$set({stickerEnableSelectImage:t}),I()}get stickersEnableButtonFlipVertical(){return this.$$.ctx[10]}set stickersEnableButtonFlipVertical(t){this.$$set({stickersEnableButtonFlipVertical:t}),I()}get stickersWillRenderShapePresetToolbar(){return this.$$.ctx[11]}set stickersWillRenderShapePresetToolbar(t){this.$$set({stickersWillRenderShapePresetToolbar:t}),I()}get markupEditorGridSize(){return this.$$.ctx[46]}set markupEditorGridSize(t){this.$$set({markupEditorGridSize:t}),I()}get markupEditorSnapThreshold(){return this.$$.ctx[47]}set markupEditorSnapThreshold(t){this.$$set({markupEditorSnapThreshold:t}),I()}get markupEditorSnapToContext(){return this.$$.ctx[48]}set markupEditorSnapToContext(t){this.$$set({markupEditorSnapToContext:t}),I()}get annotateGridSize(){return this.$$.ctx[49]}set annotateGridSize(t){this.$$set({annotateGridSize:t}),I()}get annotateSnapToContext(){return this.$$.ctx[50]}set annotateSnapToContext(t){this.$$set({annotateSnapToContext:t}),I()}get decorateGridSize(){return this.$$.ctx[51]}set decorateGridSize(t){this.$$set({decorateGridSize:t}),I()}get decorateSnapToContext(){return this.$$.ctx[52]}set decorateSnapToContext(t){this.$$set({decorateSnapToContext:t}),I()}get willRenderShapeControls(){return this.$$.ctx[12]}set willRenderShapeControls(t){this.$$set({willRenderShapeControls:t}),I()}get willRenderShapeTextControls(){return this.$$.ctx[13]}set willRenderShapeTextControls(t){this.$$set({willRenderShapeTextControls:t}),I()}get markupEditorToolSelectRadius(){return this.$$.ctx[14]}set markupEditorToolSelectRadius(t){this.$$set({markupEditorToolSelectRadius:t}),I()}get willRenderShapePresetToolbar(){return this.$$.ctx[15]}set willRenderShapePresetToolbar(t){this.$$set({willRenderShapePresetToolbar:t}),I()}get beforeAddShape(){return this.$$.ctx[16]}set beforeAddShape(t){this.$$set({beforeAddShape:t}),I()}get beforeRemoveShape(){return this.$$.ctx[17]}set beforeRemoveShape(t){this.$$set({beforeRemoveShape:t}),I()}get beforeDeselectShape(){return this.$$.ctx[18]}set beforeDeselectShape(t){this.$$set({beforeDeselectShape:t}),I()}get beforeSelectShape(){return this.$$.ctx[19]}set beforeSelectShape(t){this.$$set({beforeSelectShape:t}),I()}get beforeUpdateShape(){return this.$$.ctx[20]}set beforeUpdateShape(t){this.$$set({beforeUpdateShape:t}),I()}get markupEditorWillStartInteraction(){return this.$$.ctx[21]}set markupEditorWillStartInteraction(t){this.$$set({markupEditorWillStartInteraction:t}),I()}},({stickers:t,stickerEnableSelectImage:e,stickerEnableSelectImagePreset:i,stickerEnableDropImagePreset:n,stickerForceEnable:r})=>t&&t.length||e||i||n||r]};function W6(t){let e,i,n,r,o,a=(t[14](t[34].value)||"")+"",s=(cn(t[34].label)?t[34].label(t[1]):t[34].label)+"";return{c(){e=ht("div"),i=new Lu(!1),n=me(),r=ht("span"),o=$n(s),i.a=n,v(e,"slot","option")},m(l,c){et(l,e,c),i.m(a,e),kt(e,n),kt(e,r),kt(r,o)},p(l,c){8&c[1]&&a!==(a=(l[14](l[34].value)||"")+"")&&i.p(a),2&c[0]|8&c[1]&&s!==(s=(cn(l[34].label)?l[34].label(l[1]):l[34].label)+"")&&An(o,s)},d(l){l&&Q(e)}}}function _6(t){let e,i;return e=new as({props:{locale:t[1],class:"PinturaControlList",layout:"row",options:t[2],selectedIndex:t[6],onchange:t[12],$$slots:{option:[W6,({option:n})=>({34:n}),({option:n})=>[0,n?8:0]]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};2&r[0]&&(o.locale=n[1]),4&r[0]&&(o.options=n[2]),64&r[0]&&(o.selectedIndex=n[6]),2&r[0]|24&r[1]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function V6(t){let e,i,n,r,o;return i=new _u({props:{locale:t[1],class:"PinturaControlPanels",shape:t[4],onchange:t[13],controls:t[3],scrollElasticity:t[7]}}),r=new ka({props:{elasticity:t[10],$$slots:{default:[_6]},$$scope:{ctx:t}}}),{c(){e=ht("div"),Et(i.$$.fragment),n=me(),Et(r.$$.fragment),v(e,"slot","footer"),v(e,"style",t[5])},m(a,s){et(a,e,s),Rt(i,e,null),kt(e,n),Rt(r,e,null),o=!0},p(a,s){const l={};2&s[0]&&(l.locale=a[1]),16&s[0]&&(l.shape=a[4]),8&s[0]&&(l.controls=a[3]),128&s[0]&&(l.scrollElasticity=a[7]),i.$set(l);const c={};70&s[0]|16&s[1]&&(c.$$scope={dirty:s,ctx:a}),r.$set(c),(!o||32&s[0])&&v(e,"style",a[5])},i(a){o||(P(i.$$.fragment,a),P(r.$$.fragment,a),o=!0)},o(a){z(i.$$.fragment,a),z(r.$$.fragment,a),o=!1},d(a){a&&Q(e),It(i),It(r)}}}function N6(t){let e,i;return e=new dl({props:{$$slots:{footer:[V6]},$$scope:{ctx:t}}}),e.$on("measure",t[23]),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};254&r[0]|16&r[1]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function H6(t,e,i){let n,r,o,a,s,l,c,d,u=ii,p=()=>(u(),u=zr(h,k=>i(20,s=k)),h);t.$$.on_destroy.push(()=>u());let{isActive:h}=e;p();let{stores:g}=e,{locale:m={}}=e,{frameStyles:f={}}=e,{frameOptions:b=[]}=e,{markupEditorShapeStyleControls:w}=e;const S=un("elasticityMultiplier");E(t,S,k=>i(22,d=k));const{history:C,animation:R,scrollElasticity:M,imageFrame:D,allowPan:T,allowZoom:F,allowZoomControls:W,allowPlayPause:B}=g;E(t,R,k=>i(21,l=k)),E(t,D,k=>i(4,c=k));let y={},V;const tt=di(l?20:0);return E(t,tt,k=>i(19,a=k)),t.$$set=k=>{"isActive"in k&&p(i(0,h=k.isActive)),"stores"in k&&i(17,g=k.stores),"locale"in k&&i(1,m=k.locale),"frameStyles"in k&&i(18,f=k.frameStyles),"frameOptions"in k&&i(2,b=k.frameOptions),"markupEditorShapeStyleControls"in k&&i(3,w=k.markupEditorShapeStyleControls)},t.$$.update=()=>{1048576&t.$$.dirty[0]&&T.set(s),1048576&t.$$.dirty[0]&&F.set(s),1048576&t.$$.dirty[0]&&W.set(s),1048576&t.$$.dirty[0]&&s&&B.set(!0),4194304&t.$$.dirty[0]&&i(7,n=d*M),20&t.$$.dirty[0]&&i(6,r=c?b.findIndex(([k])=>k===c.id):0),3145728&t.$$.dirty[0]&&l&&tt.set(s?0:20),524288&t.$$.dirty[0]&&i(5,o=a?`transform: translateY(${a}px)`:void 0)},[h,m,b,w,c,o,r,n,S,R,M,D,({value:k})=>{const N=f[k];if(!N||!N.shape)return D.set(void 0),void C.write();const{shape:it}=N,ut={id:k,..._n(it),...Object.keys(y).reduce((st,mt)=>(it[mt]&&(st[mt]=y[mt]),st),{})};D.set(ut),C.write()},function(k){Ie(k,"frameColor")&&(y.frameColor=k.frameColor),c&&(ba(c,k),D.set(c),clearTimeout(V),V=setTimeout(()=>{C.write()},200))},k=>{const N=f[k];var it;if(N&&N.thumb)return it=N.thumb,/div/i.test(it)||tx(it)?it:/rect|path|circle|line|<g>/i.test(it)?`<svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" stroke-width="1" stroke="currentColor" fill="none" aria-hidden="true" focusable="false" stroke-linecap="round" stroke-linejoin="round">${it}</svg>`:`<img src="${it}" alt=""/>`},tt,"frame",g,f,a,s,l,d,function(k){Dr.call(this,t,k)}]}var j6={util:["frame",class extends li{constructor(t){super(),si(this,t,H6,N6,ri,{name:16,isActive:0,stores:17,locale:1,frameStyles:18,frameOptions:2,markupEditorShapeStyleControls:3},null,[-1,-1])}get name(){return this.$$.ctx[16]}get isActive(){return this.$$.ctx[0]}set isActive(t){this.$$set({isActive:t}),I()}get stores(){return this.$$.ctx[17]}set stores(t){this.$$set({stores:t}),I()}get locale(){return this.$$.ctx[1]}set locale(t){this.$$set({locale:t}),I()}get frameStyles(){return this.$$.ctx[18]}set frameStyles(t){this.$$set({frameStyles:t}),I()}get frameOptions(){return this.$$.ctx[2]}set frameOptions(t){this.$$set({frameOptions:t}),I()}get markupEditorShapeStyleControls(){return this.$$.ctx[3]}set markupEditorShapeStyleControls(t){this.$$set({markupEditorShapeStyleControls:t}),I()}},({src:t})=>t&&!cl(t)]};function U6(t){let e,i,n,r,o,a,s,l;return{c(){e=ht("div"),i=ht("input"),r=me(),o=ht("label"),a=$n(t[1]),v(i,"id",t[0]),v(i,"type","number"),v(i,"min","1"),v(i,"inputmode","numeric"),v(i,"pattern","[0-9]*"),v(i,"data-state",t[3]),v(i,"autocomplete","off"),v(i,"placeholder",t[4]),i.value=n=t[5]===void 0?"":t[7](t[5]+""),v(o,"for",t[0]),v(o,"title",t[2]),v(o,"aria-label",t[2]),v(e,"class","PinturaInputDimension")},m(c,d){et(c,e,d),kt(e,i),kt(e,r),kt(e,o),kt(o,a),s||(l=Pt(i,"input",t[8]),s=!0)},p(c,[d]){1&d&&v(i,"id",c[0]),8&d&&v(i,"data-state",c[3]),16&d&&v(i,"placeholder",c[4]),160&d&&n!==(n=c[5]===void 0?"":c[7](c[5]+""))&&i.value!==n&&(i.value=n),2&d&&An(a,c[1]),1&d&&v(o,"for",c[0]),4&d&&v(o,"title",c[2]),4&d&&v(o,"aria-label",c[2])},i:ii,o:ii,d(c){c&&Q(e),s=!1,l()}}}function G6(t,e,i){let{id:n}=e,{label:r}=e,{title:o}=e,{state:a}=e,{placeholder:s}=e,{value:l}=e,{onchange:c}=e,{format:d=u=>u.replace(/\D/g,"")}=e;return t.$$set=u=>{"id"in u&&i(0,n=u.id),"label"in u&&i(1,r=u.label),"title"in u&&i(2,o=u.title),"state"in u&&i(3,a=u.state),"placeholder"in u&&i(4,s=u.placeholder),"value"in u&&i(5,l=u.value),"onchange"in u&&i(6,c=u.onchange),"format"in u&&i(7,d=u.format)},[n,r,o,a,s,l,c,d,u=>c(d(u.currentTarget.value))]}class Vf extends li{constructor(e){super(),si(this,e,G6,U6,ri,{id:0,label:1,title:2,state:3,placeholder:4,value:5,onchange:6,format:7})}}function Z6(t){let e;return{c(){e=fr("g")},m(i,n){et(i,e,n),e.innerHTML=t[2]},p(i,n){4&n&&(e.innerHTML=i[2])},d(i){i&&Q(e)}}}function X6(t){let e,i,n,r,o,a,s,l;return o=new ko({props:{$$slots:{default:[Z6]},$$scope:{ctx:t}}}),{c(){e=ht("div"),i=ht("input"),n=me(),r=ht("label"),Et(o.$$.fragment),v(i,"id",t[0]),v(i,"class","implicit"),v(i,"type","checkbox"),i.checked=t[1],v(r,"for",t[0]),v(r,"title",t[3])},m(c,d){et(c,e,d),kt(e,i),kt(e,n),kt(e,r),Rt(o,r,null),a=!0,s||(l=Pt(i,"change",t[5]),s=!0)},p(c,[d]){(!a||1&d)&&v(i,"id",c[0]),(!a||2&d)&&(i.checked=c[1]);const u={};68&d&&(u.$$scope={dirty:d,ctx:c}),o.$set(u),(!a||1&d)&&v(r,"for",c[0]),(!a||8&d)&&v(r,"title",c[3])},i(c){a||(P(o.$$.fragment,c),a=!0)},o(c){z(o.$$.fragment,c),a=!1},d(c){c&&Q(e),It(o),s=!1,l()}}}function Y6(t,e,i){let{id:n}=e,{locked:r}=e,{icon:o}=e,{title:a}=e,{onchange:s}=e;return t.$$set=l=>{"id"in l&&i(0,n=l.id),"locked"in l&&i(1,r=l.locked),"icon"in l&&i(2,o=l.icon),"title"in l&&i(3,a=l.title),"onchange"in l&&i(4,s=l.onchange)},[n,r,o,a,s,l=>s(l.currentTarget.checked)]}class q6 extends li{constructor(e){super(),si(this,e,Y6,X6,ri,{id:0,locked:1,icon:2,title:3,onchange:4})}}function K6(t){let e;return{c(){e=$n("Save")},m(i,n){et(i,e,n)},d(i){i&&Q(e)}}}function J6(t){let e,i,n,r,o,a,s,l,c,d,u,p,h,g=t[1].resizeLabelFormCaption+"";return l=new ro({props:{items:t[4]}}),d=new Ls({props:{type:"submit",class:"implicit",$$slots:{default:[K6]},$$scope:{ctx:t}}}),{c(){e=ht("form"),i=ht("div"),n=ht("fieldset"),r=ht("legend"),o=$n(g),a=me(),s=ht("div"),Et(l.$$.fragment),c=me(),Et(d.$$.fragment),v(r,"class","implicit"),v(s,"class","PinturaFieldsetInner"),v(i,"class","PinturaFormInner"),v(e,"slot","footer"),v(e,"style",t[3])},m(m,f){et(m,e,f),kt(e,i),kt(i,n),kt(n,r),kt(r,o),kt(n,a),kt(n,s),Rt(l,s,null),t[65](s),kt(i,c),Rt(d,i,null),u=!0,p||(h=[Pt(s,"focusin",t[15]),Pt(s,"focusout",t[16]),Pt(e,"submit",Kb(t[17]))],p=!0)},p(m,f){(!u||2&f[0])&&g!==(g=m[1].resizeLabelFormCaption+"")&&An(o,g);const b={};16&f[0]&&(b.items=m[4]),l.$set(b);const w={};16&f[3]&&(w.$$scope={dirty:f,ctx:m}),d.$set(w),(!u||8&f[0])&&v(e,"style",m[3])},i(m){u||(P(l.$$.fragment,m),P(d.$$.fragment,m),u=!0)},o(m){z(l.$$.fragment,m),z(d.$$.fragment,m),u=!1},d(m){m&&Q(e),It(l),t[65](null),It(d),p=!1,Ui(h)}}}function Q6(t){let e,i;return e=new dl({props:{$$slots:{footer:[J6]},$$scope:{ctx:t}}}),e.$on("measure",t[66]),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};30&r[0]|16&r[3]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function t8(t,e,i){let n,r,o,a,s,l,c,d,u,p,h,g,m,f,b,w,S,C,R,M,D,T,F,W,B,y,V,tt,k,N,it=ii,ut=()=>(it(),it=zr(mt,dt=>i(49,h=dt)),mt);t.$$.on_destroy.push(()=>it());const st=(dt,jt=0,ne=9999)=>{if(Ve(dt)&&!(dt=dt.replace(/\D/g,"")).length)return;const Fe=Math.round(dt);return Number.isNaN(Fe)?void 0:rn(Fe,jt,ne)};let{isActive:mt}=e;ut();let{stores:G}=e,{locale:gt={}}=e,{resizeMinSize:vt=Vn(1,1)}=e,{resizeMaxSize:lt=Vn(9999,9999)}=e,{resizeAspectRatioLocked:St=!1}=e,{resizeEnableButtonLockAspectRatio:J=!0}=e,{resizeSizePresetOptions:q}=e,{resizeWidthPresetOptions:Z}=e,{resizeHeightPresetOptions:bt}=e,{resizeWillRenderFooter:nt=Ji}=e;const $t=di(0,{stiffness:.15,damping:.3});E(t,$t,dt=>i(54,w=dt));const{animation:Lt,imageSize:ie,imageCropRect:Vt,imageCropRectAspectRatio:te,imageCropAspectRatio:Yt,imageOutputSize:U,imageSelectionZoom:Tt,imageSelectionPan:ct,history:Jt,env:de,allowPan:ee,allowZoom:be,allowZoomControls:ve,allowPlayPause:_}=G;E(t,Lt,dt=>i(50,g=dt)),E(t,ie,dt=>i(73,tt=dt)),E(t,Vt,dt=>i(52,f=dt)),E(t,te,dt=>i(53,b=dt)),E(t,Yt,dt=>i(72,W=dt)),E(t,U,dt=>i(61,F=dt)),E(t,Tt,dt=>i(74,k=dt)),E(t,ct,dt=>i(75,N=dt)),E(t,de,dt=>i(51,m=dt));const Ce=na();let pi,we,Bt,Ae,Ee,We,oi=ln();const xt=(dt,jt,ne,Fe,Nt)=>dt!=null&&ne!==jt?dt>=Fe[jt]&&dt<=Nt[jt]?"valid":"invalid":"undetermined",ge=(dt,jt,ne)=>Math.round(dt!=null?dt/jt:ne.height),Ue=()=>{St&&we&&Bt&&(Ae==="width"?i(39,Bt=Math.round(we/b)):Ae==="height"?i(38,we=Math.round(Bt*b)):(Ee==="width"?i(39,Bt=Math.round(we/b)):Ee==="height"&&i(38,we=Math.round(Bt*b)),ze()))},ze=dt=>{let jt=st(we),ne=st(Bt),Fe=jt,Nt=ne,K=Fe&&Nt,Qt=dt||b;if(!Fe&&!Nt)return;Fe&&!Nt?Nt=Math.round(Fe/Qt):Nt&&!Fe&&(Fe=Math.round(Nt*Qt)),Qt=dt||K?Jo(Fe,Nt):b;let Gt=Vn(Fe,Nt);mu(lt,Gt)||(Gt=Ur(lt,Qt)),mu(Gt,vt)||(Gt=rs(vt,Qt)),i(38,we=jt!=null?Math.round(Gt.width):void 0),i(39,Bt=ne!=null?Math.round(Gt.height):void 0)},At=()=>{ze();const{width:dt,height:jt}=F||{};dt===we&&jt===Bt||(we||Bt?(we&&Bt&&wt(Yt,W=we/Bt,W),wt(U,F=Vn(we,Bt),F)):(wt(Yt,W=tt.width/tt.height,W),wt(Yt,W=void 0,W),wt(U,F=void 0,F)),Jt.write())},Ge=U.subscribe(dt=>{if(!dt)return i(38,we=void 0),void i(39,Bt=void 0);i(38,we=dt.width),i(39,Bt=dt.height),ze()}),Ke=Yt.subscribe(dt=>{(we||Bt)&&dt&&(we&&Bt&&Jo(we,Bt)!==dt?(i(39,Bt=we/dt),ze(dt)):ze())}),gi=dt=>Ve(dt[0])?(dt[1]=dt[1].map(gi),dt):ui(dt)?[dt,""+dt]:dt,yi=dt=>{if(Ve(dt[0]))return dt[1]=dt[1].map(yi),dt;let[jt,ne]=dt;if(ui(jt)&&ui(ne)){const[Fe,Nt]=[jt,ne];ne=`${Fe} &times; ${Nt}`,jt=[Fe,Nt]}return[jt,ne]},Li=he();E(t,Li,dt=>i(60,T=dt));const Si=he();E(t,Si,dt=>i(64,V=dt));const X=he();E(t,X,dt=>i(58,M=dt));const Zt=he();E(t,Zt,dt=>i(63,y=dt));const H=he();E(t,H,dt=>i(56,C=dt));const qt=he();E(t,qt,dt=>i(62,B=dt));const le=Ai([U,Si],([dt,jt],ne)=>{if(!jt)return ne(-1);const Fe=jt.findIndex(([Nt])=>{if(!Nt&&!dt)return!0;if(!Nt)return!1;const[K,Qt]=Nt;return dt.width===K&&dt.height===Qt});ne(Fe<0?0:Fe)});E(t,le,dt=>i(59,D=dt));const Ut=Ai([U,Zt],([dt,jt],ne)=>{if(!jt)return ne(-1);const Fe=jt.findIndex(([Nt])=>!Nt&&!dt||!!Nt&&dt.width===Nt);ne(Fe<0?0:Fe)});E(t,Ut,dt=>i(57,R=dt));const fe=Ai([U,qt],([dt,jt],ne)=>{if(!jt)return ne(-1);const Fe=jt.findIndex(([Nt])=>!Nt&&!dt||!!Nt&&dt.height===Nt);ne(Fe<0?0:Fe)});E(t,fe,dt=>i(55,S=dt));let Xt,Le;const Je=un("redrawTrigger"),_e=di(g?20:0);return E(t,_e,dt=>i(48,p=dt)),Wo(()=>{Ge(),Ke()}),t.$$set=dt=>{"isActive"in dt&&ut(i(0,mt=dt.isActive)),"stores"in dt&&i(30,G=dt.stores),"locale"in dt&&i(1,gt=dt.locale),"resizeMinSize"in dt&&i(31,vt=dt.resizeMinSize),"resizeMaxSize"in dt&&i(32,lt=dt.resizeMaxSize),"resizeAspectRatioLocked"in dt&&i(28,St=dt.resizeAspectRatioLocked),"resizeEnableButtonLockAspectRatio"in dt&&i(33,J=dt.resizeEnableButtonLockAspectRatio),"resizeSizePresetOptions"in dt&&i(34,q=dt.resizeSizePresetOptions),"resizeWidthPresetOptions"in dt&&i(35,Z=dt.resizeWidthPresetOptions),"resizeHeightPresetOptions"in dt&&i(36,bt=dt.resizeHeightPresetOptions),"resizeWillRenderFooter"in dt&&i(37,nt=dt.resizeWillRenderFooter)},t.$$.update=()=>{var dt;262144&t.$$.dirty[1]&&ee.set(!h),262144&t.$$.dirty[1]&&be.set(!h),262144&t.$$.dirty[1]&&ve.set(!h),262144&t.$$.dirty[1]&&h&&_.set(!0),536870920&t.$$.dirty[1]&&q&&(wt(Li,T=q.map(yi),T),wt(Si,V=ks(T),V)),536870912&t.$$.dirty[1]&&i(47,a=!!T),268435456&t.$$.dirty[1]|4&t.$$.dirty[2]&&i(46,n=D>-1&&V[D][1]),134217744&t.$$.dirty[1]&&Z&&(wt(X,M=Z.map(gi),M),wt(Zt,y=ks(M),y)),134283264&t.$$.dirty[1]&&i(44,s=!a&&M),67108864&t.$$.dirty[1]|2&t.$$.dirty[2]&&i(45,r=R>-1&&y[R][1]),33554464&t.$$.dirty[1]&&bt&&(wt(H,C=bt.map(gi),C),wt(qt,B=ks(C),B)),33619968&t.$$.dirty[1]&&i(43,l=!a&&C),16777216&t.$$.dirty[1]|1&t.$$.dirty[2]&&i(42,o=S>-1&&B[S][1]),77824&t.$$.dirty[1]&&i(41,c=!a&&!s&&!l),268435458&t.$$.dirty[0]|1072824263&t.$$.dirty[1]&&i(4,d=Je&&Wc(()=>{return nt([a&&["Dropdown","size-presets",{label:n,options:T,onchange:Nt=>{return(K=Nt.value)&&!Xt&&(Xt={...f},Le=W),K?(wt(Yt,W=Jo(K[0],K[1]),W),wt(U,F=iy(K),F)):(wt(Vt,f=Xt,f),wt(Yt,W=Le,W),wt(U,F=void 0,F),Xt=void 0,Le=void 0),void Jt.write();var K},selectedIndex:D}],s&&["Dropdown","width-presets",{label:r,options:M,onchange:Nt=>{i(38,we=Nt.value),At()},selectedIndex:R}],s&&l&&["span","times",{class:"PinturaResizeLabel",innerHTML:"&times;"}],l&&["Dropdown","height-presets",{label:o,options:C,onchange:Nt=>{i(39,Bt=Nt.value),At()},selectedIndex:S}],c&&[Vf,"width-input",{id:"width-"+Ce,title:gt.resizeTitleInputWidth,label:gt.resizeLabelInputWidth,placeholder:(jt=st(Bt),ne=b,Fe=f,Math.round(jt!=null?jt*ne:Fe.width)),value:we,state:xt(st(we),"width",Ae,vt,lt),onchange:Nt=>{i(38,we=Nt),Ue()}}],c&&J&&[q6,"aspect-ratio-lock",{id:"aspect-ratio-lock-"+Ce,title:gt.resizeTitleButtonMaintainAspectRatio,icon:Ve(gt.resizeIconButtonMaintainAspectRatio)?gt.resizeIconButtonMaintainAspectRatio:gt.resizeIconButtonMaintainAspectRatio(St,w),locked:St,onchange:Nt=>{i(28,St=Nt),Ue()}}],c&&[Vf,"height-input",{id:"height-"+Ce,title:gt.resizeTitleInputHeight,label:gt.resizeLabelInputHeight,placeholder:ge(st(we),b,f),value:Bt,state:xt(st(Bt),"height",Ae,vt,lt),onchange:Nt=>{i(39,Bt=Nt),Ue()}}]].filter(Boolean),{...m},()=>Je.set({}));var jt,ne,Fe}).filter(Boolean)),268435456&t.$$.dirty[0]&&$t.set(St?1:0),512&t.$$.dirty[1]&&Ae&&(Ee=Ae),262144&t.$$.dirty[1]&&h&&(oi=N,We=k),1074003968&t.$$.dirty[1]&&(h?(dt=F,wt(ct,N=ln(),N),wt(Tt,k=dt&&f?dt.width/f.width||dt.height/f.height:1,k)):(wt(ct,N=oi,N),wt(Tt,k=We,k))),786432&t.$$.dirty[1]&&g&&_e.set(h?0:20),131072&t.$$.dirty[1]&&i(3,u=p?`transform: translateY(${p}px)`:void 0)},[mt,gt,pi,u,d,$t,Lt,ie,Vt,te,Yt,U,Tt,ct,de,dt=>{const jt=dt.target.id;/width/.test(jt)?i(40,Ae="width"):/height/.test(jt)?i(40,Ae="height"):/aspectRatio/i.test(jt)?i(40,Ae="lock"):i(40,Ae=void 0)},dt=>{pi.contains(dt.relatedTarget)||At(),i(40,Ae=void 0)},At,Li,Si,X,Zt,H,qt,le,Ut,fe,_e,St,"resize",G,vt,lt,J,q,Z,bt,nt,we,Bt,Ae,c,o,l,s,r,n,a,p,h,g,m,f,b,w,S,C,R,M,D,T,F,B,y,V,function(dt){Fi[dt?"unshift":"push"](()=>{pi=dt,i(2,pi)})},function(dt){Dr.call(this,t,dt)}]}var e8={util:["resize",class extends li{constructor(t){super(),si(this,t,t8,Q6,ri,{name:29,isActive:0,stores:30,locale:1,resizeMinSize:31,resizeMaxSize:32,resizeAspectRatioLocked:28,resizeEnableButtonLockAspectRatio:33,resizeSizePresetOptions:34,resizeWidthPresetOptions:35,resizeHeightPresetOptions:36,resizeWillRenderFooter:37},null,[-1,-1,-1,-1])}get name(){return this.$$.ctx[29]}get isActive(){return this.$$.ctx[0]}set isActive(t){this.$$set({isActive:t}),I()}get stores(){return this.$$.ctx[30]}set stores(t){this.$$set({stores:t}),I()}get locale(){return this.$$.ctx[1]}set locale(t){this.$$set({locale:t}),I()}get resizeMinSize(){return this.$$.ctx[31]}set resizeMinSize(t){this.$$set({resizeMinSize:t}),I()}get resizeMaxSize(){return this.$$.ctx[32]}set resizeMaxSize(t){this.$$set({resizeMaxSize:t}),I()}get resizeAspectRatioLocked(){return this.$$.ctx[28]}set resizeAspectRatioLocked(t){this.$$set({resizeAspectRatioLocked:t}),I()}get resizeEnableButtonLockAspectRatio(){return this.$$.ctx[33]}set resizeEnableButtonLockAspectRatio(t){this.$$set({resizeEnableButtonLockAspectRatio:t}),I()}get resizeSizePresetOptions(){return this.$$.ctx[34]}set resizeSizePresetOptions(t){this.$$set({resizeSizePresetOptions:t}),I()}get resizeWidthPresetOptions(){return this.$$.ctx[35]}set resizeWidthPresetOptions(t){this.$$set({resizeWidthPresetOptions:t}),I()}get resizeHeightPresetOptions(){return this.$$.ctx[36]}set resizeHeightPresetOptions(t){this.$$set({resizeHeightPresetOptions:t}),I()}get resizeWillRenderFooter(){return this.$$.ctx[37]}set resizeWillRenderFooter(t){this.$$set({resizeWillRenderFooter:t}),I()}},({src:t})=>t&&!cl(t)]};function i8(t){let e,i;return e=new Vu({props:{stores:t[3],locale:t[4],isActive:t[0],isActiveFraction:t[1],isVisible:t[2],mapScreenPointToImagePoint:t[9],mapImagePointToScreenPoint:t[8],utilKey:"redact",imageRotation:t[10],imageFlipX:t[7],imageFlipY:t[6],shapes:t[11],toolbar:["rect"],toolShapes:{rectangle:[{x:0,y:0,width:0,height:0}]},toolActive:"rectangle",parentRect:t[13],enablePresetDropImage:!1,enablePresetSelectImage:!1,willStartInteraction:t[5],hooks:{willRenderShapeControls:t[24]}}}),e.$on("measure",t[25]),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,[r]){const o={};8&r&&(o.stores=n[3]),16&r&&(o.locale=n[4]),1&r&&(o.isActive=n[0]),2&r&&(o.isActiveFraction=n[1]),4&r&&(o.isVisible=n[2]),512&r&&(o.mapScreenPointToImagePoint=n[9]),256&r&&(o.mapImagePointToScreenPoint=n[8]),1024&r&&(o.imageRotation=n[10]),128&r&&(o.imageFlipX=n[7]),64&r&&(o.imageFlipY=n[6]),32&r&&(o.willStartInteraction=n[5]),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function n8(t,e,i){let n,r,o,a,s,l,c,d,u,{isActive:p}=e,{isActiveFraction:h}=e,{isVisible:g}=e,{stores:m}=e,{locale:f={}}=e,{markupEditorWillStartInteraction:b}=e;const{imageRedaction:w,rootRect:S,imageSize:C,imageRotation:R,imageFlipX:M,imageFlipY:D,imageTransforms:T,imageTransformsInterpolated:F}=m;return E(t,S,W=>i(23,d=W)),E(t,C,W=>i(22,c=W)),E(t,R,W=>i(10,u=W)),E(t,M,W=>i(7,a=W)),E(t,D,W=>i(6,o=W)),E(t,T,W=>i(21,l=W)),E(t,F,W=>i(20,s=W)),t.$$set=W=>{"isActive"in W&&i(0,p=W.isActive),"isActiveFraction"in W&&i(1,h=W.isActiveFraction),"isVisible"in W&&i(2,g=W.isVisible),"stores"in W&&i(3,m=W.stores),"locale"in W&&i(4,f=W.locale),"markupEditorWillStartInteraction"in W&&i(5,b=W.markupEditorWillStartInteraction)},t.$$.update=()=>{15728832&t.$$.dirty&&i(9,n=W=>o0(W,d,c,s.origin,s.translation,l.rotation.z,s.scale,a,o)),15728832&t.$$.dirty&&i(8,r=W=>r0(W,d,c,s.origin,s.translation,l.rotation.z,s.scale,a,o))},[p,h,g,m,f,b,o,a,r,n,u,w,S,C,R,M,D,T,F,"redact",s,l,c,d,W=>{const B=uh(W[0]);return P3("to-front",B),W},function(W){Dr.call(this,t,W)}]}var r8={util:["redact",class extends li{constructor(t){super(),si(this,t,n8,i8,ri,{name:19,isActive:0,isActiveFraction:1,isVisible:2,stores:3,locale:4,markupEditorWillStartInteraction:5})}get name(){return this.$$.ctx[19]}get isActive(){return this.$$.ctx[0]}set isActive(t){this.$$set({isActive:t}),I()}get isActiveFraction(){return this.$$.ctx[1]}set isActiveFraction(t){this.$$set({isActiveFraction:t}),I()}get isVisible(){return this.$$.ctx[2]}set isVisible(t){this.$$set({isVisible:t}),I()}get stores(){return this.$$.ctx[3]}set stores(t){this.$$set({stores:t}),I()}get locale(){return this.$$.ctx[4]}set locale(t){this.$$set({locale:t}),I()}get markupEditorWillStartInteraction(){return this.$$.ctx[5]}set markupEditorWillStartInteraction(t){this.$$set({markupEditorWillStartInteraction:t}),I()}},({src:t})=>t&&!cl(t)]};function Nf(t){let e,i,n=(cn(t[32].label)?t[32].label(t[1]):t[32].label)+"";return{c(){e=ht("span"),i=$n(n)},m(r,o){et(r,e,o),kt(e,i)},p(r,o){2&o[0]|2&o[1]&&n!==(n=(cn(r[32].label)?r[32].label(r[1]):r[32].label)+"")&&An(i,n)},d(r){r&&Q(e)}}}function o8(t){let e,i,n,r=(t[11](t[32].value)||"")+"",o=t[32].label&&Nf(t);return{c(){e=ht("div"),i=new Lu(!1),n=me(),o&&o.c(),i.a=n,v(e,"slot","option")},m(a,s){et(a,e,s),i.m(r,e),kt(e,n),o&&o.m(e,null)},p(a,s){2&s[1]&&r!==(r=(a[11](a[32].value)||"")+"")&&i.p(r),a[32].label?o?o.p(a,s):(o=Nf(a),o.c(),o.m(e,null)):o&&(o.d(1),o=null)},d(a){a&&Q(e),o&&o.d()}}}function a8(t){let e,i;return e=new as({props:{locale:t[1],class:"PinturaControlList",layout:"row",options:t[2],selectedIndex:t[4],onchange:t[10],$$slots:{option:[o8,({option:n})=>({32:n}),({option:n})=>[0,n?2:0]]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};2&r[0]&&(o.locale=n[1]),4&r[0]&&(o.options=n[2]),16&r[0]&&(o.selectedIndex=n[4]),2&r[0]|6&r[1]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function s8(t){let e,i,n;return i=new ka({props:{elasticity:t[5],$$slots:{default:[a8]},$$scope:{ctx:t}}}),{c(){e=ht("div"),Et(i.$$.fragment),v(e,"slot","footer"),v(e,"style",t[3])},m(r,o){et(r,e,o),Rt(i,e,null),n=!0},p(r,o){const a={};32&o[0]&&(a.elasticity=r[5]),22&o[0]|4&o[1]&&(a.$$scope={dirty:o,ctx:r}),i.$set(a),(!n||8&o[0])&&v(e,"style",r[3])},i(r){n||(P(i.$$.fragment,r),n=!0)},o(r){z(i.$$.fragment,r),n=!1},d(r){r&&Q(e),It(i)}}}function l8(t){let e,i;return e=new dl({props:{$$slots:{footer:[s8]},$$scope:{ctx:t}}}),e.$on("measure",t[22]),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};62&r[0]|4&r[1]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(P(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function c8(t,e,i){let n,r,o,a,s,l,c,d,u,p,h=ii,g=()=>(h(),h=zr(m,k=>i(17,l=k)),m);t.$$.on_destroy.push(()=>h());let{isActive:m}=e;g();let{stores:f}=e,{locale:b={}}=e,{fillOptions:w=[]}=e;const S=k=>k.map(N=>(it=>En(it)&&Ve(it[0])&&En(it[1]))(N)?[N[0],S(N[1]),N[2]]:(it=>[Array.isArray(it)&&it.length===3?[...it,1]:it,void 0,{disabled:!1}])(N)),C=un("elasticityMultiplier");E(t,C,k=>i(21,p=k));const{history:R,animation:M,scrollElasticity:D,imageBackgroundColor:T,imageBackgroundImage:F,allowPan:W,allowZoom:B,allowZoomControls:y,allowPlayPause:V}=f;E(t,M,k=>i(18,c=k)),E(t,T,k=>i(20,u=k)),E(t,F,k=>i(19,d=k));const tt=di(c?20:0);return E(t,tt,k=>i(16,s=k)),t.$$set=k=>{"isActive"in k&&g(i(0,m=k.isActive)),"stores"in k&&i(14,f=k.stores),"locale"in k&&i(1,b=k.locale),"fillOptions"in k&&i(15,w=k.fillOptions)},t.$$.update=()=>{32768&t.$$.dirty[0]&&i(2,n=S(w)),131072&t.$$.dirty[0]&&W.set(l),131072&t.$$.dirty[0]&&B.set(l),131072&t.$$.dirty[0]&&y.set(l),131072&t.$$.dirty[0]&&l&&V.set(!0),2097152&t.$$.dirty[0]&&i(5,r=p*D),1572868&t.$$.dirty[0]&&i(4,o=n.findIndex(([k])=>d?k===d:Array.isArray(k)?os(k,u):void 0)||0),393216&t.$$.dirty[0]&&c&&tt.set(l?0:20),65536&t.$$.dirty[0]&&i(3,a=s?`transform: translateY(${s}px)`:void 0)},[m,b,n,a,o,r,C,M,T,F,({value:k})=>{Ve(k)&&(wt(T,u=void 0,u),wt(F,d=k,d)),En(k)&&(wt(T,u=k,u),wt(F,d=void 0,d)),R.write()},k=>{if(Ve(k))return`<div class="PinturaFillTile"><img src="${k}" alt="" width="48" height="64"/></div>`;if(En(k)){const[N,it,ut,st]=k.map((mt,G)=>G<3?Math.round(255*mt):mt);return`<div class="PinturaFillTile" data-transparent="${st<1}"><div style="background-color:rgba(${N},${it},${ut},${st})"></div></div>`}return"<div></div>"},tt,"fill",f,w,s,l,c,d,u,p,function(k){Dr.call(this,t,k)}]}var d8={util:["fill",class extends li{constructor(t){super(),si(this,t,c8,l8,ri,{name:13,isActive:0,stores:14,locale:1,fillOptions:15},null,[-1,-1])}get name(){return this.$$.ctx[13]}get isActive(){return this.$$.ctx[0]}set isActive(t){this.$$set({isActive:t}),I()}get stores(){return this.$$.ctx[14]}set stores(t){this.$$set({stores:t}),I()}get locale(){return this.$$.ctx[1]}set locale(t){this.$$set({locale:t}),I()}get fillOptions(){return this.$$.ctx[15]}set fillOptions(t){this.$$set({fillOptions:t}),I()}},({src:t,fillOptions:e})=>t&&!cl(t)&&e&&e.length]};const Hf='<g fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" stroke-width=".125em"><path d="M18 6L6 18M6 6l12 12"></path></path></g>',Hp='<path fill="none" d="M9 15 L12 9 L15 15 M10 13.5 h3" stroke="currentColor" stroke-width=".125em"/>';var u8={labelReset:"Reset",labelDefault:"Default",labelAuto:"Auto",labelNone:"None",labelEdit:"Edit",labelClose:"Close",labelSupportError:t=>t.join(", ")+" not supported on this browser",labelColor:"Color",labelWidth:"Width",labelSize:"Size",labelOffset:"Offset",labelAmount:"Amount",labelInset:"Inset",labelRadius:"Radius",labelColorPalette:"Color palette",labelSizeExtraSmall:"Extra small",labelSizeSmall:"Small",labelSizeMediumSmall:"Medium small",labelSizeMedium:"Medium",labelSizeMediumLarge:"Medium large",labelSizeLarge:"Large",labelSizeExtraLarge:"Extra large",labelButtonCancel:"Cancel",labelButtonUndo:"Undo",labelButtonRedo:"Redo",labelButtonRevert:"Revert",labelButtonExport:"Done",labelZoomIn:"Zoom in",labelZoomOut:"Zoom out",labelZoomFit:"Fit to view",labelZoomActual:"Actual size",iconZoomIn:'<path stroke="currentColor" stroke-width=".125em" d="M8 12 h8 M12 8 v8" />',iconZoomOut:'<path stroke="currentColor" stroke-width=".125em" d="M9 12 h6" />',iconSupportError:'<g fill="none" stroke="currentColor" stroke-width="2"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/><g><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></g>',iconButtonClose:Hf,iconButtonRevert:'<g fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" stroke-width=".125em"><path d="M7.388 18.538a8 8 0 10-2.992-9.03"/><path fill="currentColor" d="M2.794 11.696L2.37 6.714l5.088 3.18z"/><path d="M12 8v4M12 12l4 2"/></g>',iconButtonUndo:'<g fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" stroke-width=".125em"><path d="M10 8h4c2.485 0 5 2 5 5s-2.515 5-5 5h-4"/><path fill="currentColor" d="M5 8l4-3v6z"/></g>',iconButtonRedo:'<g fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" stroke-width=".125em"><path d="M14 8h-4c-2.485 0-5 2-5 5s2.515 5 5 5h4"/><path fill="currentColor" d="M19 8l-4-3v6z"/></g>',iconButtonExport:'<polyline points="20 6 9 17 4 12" fill="none" stroke="currentColor" stroke-width=".125em"></polyline>',statusLabelButtonClose:"Close",statusIconButtonClose:Hf,statusLabelLoadImage:t=>t&&t.task?t.error?t.error.code==="IMAGE_TOO_SMALL"?"Minimum image size is {minWidth} &times; {minHeight}":"Error loading image":t.task==="blob-to-bitmap"?"Preparing image&hellip;":"Loading image&hellip;":"Waiting for image",statusLabelProcessImage:t=>{if(t&&t.task)return t.task==="store"?t.error?"Error uploading image":"Uploading image&hellip;":t.error?"Error processing image":"Processing image&hellip;"}};const p8={shapeLabelButtonSelectSticker:"Select image",shapeIconButtonSelectSticker:'<g fill="none" stroke="currentColor" stroke-width="0.0625em"><path d="M8 21 L15 11 L19 15"/><path d="M15 2 v5 h5"/><path d="M8 2 h8 l4 4 v12 q0 4 -4 4 h-8 q-4 0 -4 -4 v-12 q0 -4 4 -4z"/></g><circle fill="currentColor" cx="10" cy="8" r="1.5"/>',shapeIconButtonFlipHorizontal:'<g stroke="currentColor" stroke-width=".125em"><path fill="none" d="M6 6.5h5v11H6z"/><path fill="currentColor" d="M15 6.5h3v11h-3z"/><path d="M11 4v16" fill="currentColor"/></g>',shapeIconButtonFlipVertical:'<g stroke="currentColor" stroke-width=".125em"><rect x="7" y="8" width="11" height="5" fill="none"/><rect x="7" y="17" width="11" height="2" fill="currentColor"/><line x1="5" y1="13" x2="20" y2="13"/></g>',shapeIconButtonRemove:'<g fill="none" fill-rule="evenodd"><path stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" d="M7.5 7h9z"/><path d="M7.916 9h8.168a1 1 0 01.99 1.14l-.972 6.862a2 2 0 01-1.473 1.653c-.877.23-1.753.345-2.629.345-.876 0-1.752-.115-2.628-.345a2 2 0 01-1.473-1.653l-.973-6.862A1 1 0 017.916 9z" fill="currentColor"/><rect fill="currentColor" x="10" y="5" width="4" height="3" rx="1"/></g>',shapeIconButtonDuplicate:'<g fill="none" fill-rule="evenodd"><path d="M15 13.994V16a2 2 0 01-2 2H8a2 2 0 01-2-2v-5a2 2 0 012-2h2.142" stroke="currentColor" stroke-width=".125em"/><path d="M15 9V8a1 1 0 00-2 0v1h-1a1 1 0 000 2h1v1a1 1 0 002 0v-1h1a1 1 0 000-2h-1zm-4-4h6a2 2 0 012 2v6a2 2 0 01-2 2h-6a2 2 0 01-2-2V7a2 2 0 012-2z" fill="currentColor"/></g>',shapeIconButtonMoveToFront:'<g fill="none" fill-rule="evenodd"><rect fill="currentColor" x="11" y="13" width="8" height="2" rx="1"/><rect fill="currentColor" x="9" y="17" width="10" height="2" rx="1"/><path d="M11.364 8H10a5 5 0 000 10M12 6.5L14.5 8 12 9.5z" stroke="currentColor" stroke-width=".125em" stroke-linecap="round"/></g>',shapeIconButtonTextLayoutAutoWidth:""+Hp,shapeIconButtonTextLayoutAutoHeight:'<g fill="currentColor"><circle cx="4" cy="12" r="1.5"/><circle cx="20" cy="12" r="1.5"/></g>'+Hp,shapeIconButtonTextLayoutFixedSize:'<g fill="currentColor"><circle cx="5" cy="6" r="1.5"/><circle cx="19" cy="6" r="1.5"/><circle cx="19" cy="19" r="1.5"/><circle cx="5" cy="19" r="1.5"/></g>'+Hp,shapeTitleButtonTextLayoutAutoWidth:"Auto width",shapeTitleButtonTextLayoutAutoHeight:"Auto height",shapeTitleButtonTextLayoutFixedSize:"Fixed size",shapeTitleButtonFlipHorizontal:"Flip Horizontal",shapeTitleButtonFlipVertical:"Flip Vertical",shapeTitleButtonRemove:"Remove",shapeTitleButtonDuplicate:"Duplicate",shapeTitleButtonMoveToFront:"Move to front",shapeLabelInputText:"Edit text",shapeIconInputCancel:'<g fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" stroke-width=".125em"><path d="M18 6L6 18M6 6l12 12"/></g>',shapeIconInputConfirm:'<g fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" stroke-width=".125em"><polyline points="20 6 9 17 4 12"/></g>',shapeLabelInputCancel:"Cancel",shapeLabelInputConfirm:"Confirm",shapeLabelStrokeNone:"No outline",shapeLabelFontStyleNormal:"Normal",shapeLabelFontStyleBold:"Bold",shapeLabelFontStyleItalic:"Italic",shapeLabelFontStyleItalicBold:"Bold Italic",shapeTitleBackgroundColor:"Fill color",shapeTitleCornerRadius:"Corner radius",shapeTitleFontFamily:"Font",shapeTitleFontSize:"Font size",shapeTitleFontStyle:"Font style",shapeTitleLineHeight:"Line height",shapeTitleLineStart:"Start",shapeTitleLineEnd:"End",shapeTitleStrokeWidth:"Line width",shapeTitleStrokeColor:"Line color",shapeTitleLineDecorationBar:"Bar",shapeTitleLineDecorationCircle:"Circle",shapeTitleLineDecorationSquare:"Square",shapeTitleLineDecorationArrow:"Arrow",shapeTitleLineDecorationCircleSolid:"Circle solid",shapeTitleLineDecorationSquareSolid:"Square solid",shapeTitleLineDecorationArrowSolid:"Arrow solid",shapeIconLineDecorationBar:'<g stroke="currentColor" stroke-linecap="round" stroke-width=".125em"><path d="M5,12 H16"/><path d="M16,8 V16"/></g>',shapeIconLineDecorationCircle:'<g stroke="currentColor" stroke-linecap="round"><path stroke-width=".125em" d="M5,12 H12"/><circle fill="none" stroke-width=".125em" cx="16" cy="12" r="4"/></g>',shapeIconLineDecorationSquare:'<g stroke="currentColor" stroke-linecap="round"><path stroke-width=".125em" d="M5,12 H12"/><rect fill="none" stroke-width=".125em" x="12" y="8" width="8" height="8"/></g>',shapeIconLineDecorationArrow:'<g stroke="currentColor" stroke-linecap="round" stroke-width=".125em"><path d="M5,12 H16 M13,7 l6,5 l-6,5" fill="none"/></g>',shapeIconLineDecorationCircleSolid:'<g stroke="currentColor" stroke-linecap="round"><path stroke-width=".125em" d="M5,12 H12"/><circle fill="currentColor" cx="16" cy="12" r="4"/></g>',shapeIconLineDecorationSquareSolid:'<g stroke="currentColor" stroke-linecap="round"><path stroke-width=".125em" d="M5,12 H12"/><rect fill="currentColor" x="12" y="8" width="8" height="8"/></g>',shapeIconLineDecorationArrowSolid:'<g stroke="currentColor" stroke-linecap="round" stroke-width=".125em"><path d="M5,12 H16"/><path d="M13,7 l6,5 l-6,5z" fill="currentColor"/></g>',shapeTitleColorTransparent:"Transparent",shapeTitleColorWhite:"White",shapeTitleColorSilver:"Silver",shapeTitleColorGray:"Gray",shapeTitleColorBlack:"Black",shapeTitleColorNavy:"Navy",shapeTitleColorBlue:"Blue",shapeTitleColorAqua:"Aqua",shapeTitleColorTeal:"Teal",shapeTitleColorOlive:"Olive",shapeTitleColorGreen:"Green",shapeTitleColorYellow:"Yellow",shapeTitleColorOrange:"Orange",shapeTitleColorRed:"Red",shapeTitleColorMaroon:"Maroon",shapeTitleColorFuchsia:"Fuchsia",shapeTitleColorPurple:"Purple",shapeTitleTextOutline:"Text outline",shapeTitleTextOutlineWidth:"Width",shapeTitleTextShadow:"Text shadow",shapeTitleTextShadowBlur:"Blur",shapeTitleTextColor:"Font color",shapeTitleTextAlign:"Text align",shapeTitleTextAlignLeft:"Left align text",shapeTitleTextAlignCenter:"Center align text",shapeTitleTextAlignRight:"Right align text",shapeIconTextAlignLeft:'<g stroke-width=".125em" stroke="currentColor"><line x1="5" y1="8" x2="15" y2="8"/><line x1="5" y1="12" x2="19" y2="12"/><line x1="5" y1="16" x2="14" y2="16"/></g>',shapeIconTextAlignCenter:'<g stroke-width=".125em" stroke="currentColor"><line x1="7" y1="8" x2="17" y2="8"/><line x1="5" y1="12" x2="19" y2="12"/><line x1="8" y1="16" x2="16" y2="16"/></g>',shapeIconTextAlignRight:'<g stroke-width=".125em" stroke="currentColor"><line x1="9" y1="8" x2="19" y2="8"/><line x1="5" y1="12" x2="19" y2="12"/><line x1="11" y1="16" x2="19" y2="16"/></g>',shapeLabelToolMove:"Move",shapeLabelToolView:"View",shapeLabelToolSharpie:"Sharpie",shapeLabelToolEraser:"Eraser",shapeLabelToolPath:"Path",shapeLabelToolRectangle:"Rectangle",shapeLabelToolEllipse:"Ellipse",shapeLabelToolArrow:"Arrow",shapeLabelToolLine:"Line",shapeLabelToolText:"Text",shapeLabelToolPreset:"Stickers",shapeIconToolView:'<g stroke-width=".125em" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path d="M10.98 9.703V2.567c0-1.19 1.19-1.785 1.784-1.785.595 0 1.784.595 1.784 1.785v3.568"/><path d="M14.548 9.703V4.35c0-1.19 1.19-1.784 1.784-1.784.595 0 1.784.594 1.784 1.784v2.973"/><path d="M18.116 10.244V7.271c0-1.19 1.19-1.784 1.784-1.784.595 0 1.785.595 1.785 1.784 0 1.19 0 8.92-1.19 12.488-1.19 3.569-10.704 4.758-13.678 0-2.973-4.757-2.973-4.757-4.163-6.541-1.189-1.784-1.153-2.974-.594-3.568.558-.595 1.784-1.19 2.973.594 1.277 1.916 2.07 2.907 2.379 2.974V5.487c0-1.19 1.19-1.784 1.784-1.784.595 0 1.784.595 1.784 1.784V8.46"/></g>',shapeIconToolMove:'<g stroke-width=".125em" stroke="currentColor" fill="none"><path d="M6 2 L6 19 L18 13 Z M13 18 L16 24" stroke="currentColor" stroke-width=".125em" fill="none" fill-rule="evenodd" stroke-linejoin="round"/></g>',shapeIconToolSharpie:'<g stroke-width=".125em" stroke="currentColor" fill="none"><path d="M2.025 5c5.616-2.732 8.833-3.857 9.65-3.374C12.903 2.351.518 12.666 2.026 14 3.534 15.334 16.536.566 17.73 2.566 18.924 4.566 3.98 17.187 4.831 18c.851.813 9.848-6 11.643-6 1.087 0-2.53 5.11-2.92 7-.086.41 3.323-1.498 4.773-1 .494.17.64 2.317 1.319 3 .439.443 1.332.776 2.679 1" stroke="currentColor" stroke-width=".125em" fill="none" fill-rule="evenodd" stroke-linejoin="round"/></g>',shapeIconToolEraser:'<g stroke-width=".125em" stroke="currentColor" stroke-linecap="round" fill="none"><g transform="translate(3, 15) rotate(-45)"><rect x="0" y="0" width="18" height="10" rx="3"/></g><line x1="11" y1="21" x2="18" y2="21"/><line x1="20" y1="21" x2="22" y2="21"/></g>',shapeIconToolPath:'<g stroke-width=".125em" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" fill="none"><circle cx="21" cy="3" r="2"/><circle cx="9" cy="9" r="2"/><circle cx="3" cy="21" r="2"/><path d="M19 4 11 8 M8 11 4 19"/></g>',shapeIconToolRectangle:'<g stroke-width=".125em" stroke="currentColor" fill="none"><rect x="1" y="1" width="22" height="22" rx="4"/></g>',shapeIconToolEllipse:'<g stroke-width=".125em" stroke="currentColor" fill="none"><circle cx="12" cy="12" r="11"/></g>',shapeIconToolArrow:'<g stroke-width=".125em" stroke="currentColor" fill="none"><line x1="20" y1="3" x2="6" y2="21"/><path d="m10 6 L21.5 1 L20 13.5" fill="currentColor" stroke="none"/></g>',shapeIconToolLine:'<g stroke-width=".125em" stroke="currentColor" fill="none"><line x1="20" y1="3" x2="6" y2="21"/></g>',shapeIconToolText:'<g stroke="none" fill="currentColor" transform="translate(6,0)"><path d="M8.14 20.085c.459 0 .901-.034 1.329-.102a8.597 8.597 0 001.015-.21v1.984c-.281.135-.695.247-1.242.336a9.328 9.328 0 01-1.477.133c-3.312 0-4.968-1.745-4.968-5.235V6.804H.344v-1.25l2.453-1.078L3.89.819h1.5v3.97h4.97v2.015H5.39v10.078c0 1.031.245 1.823.735 2.375s1.161.828 2.015.828z"/>',shapeIconToolPreset:'<g fill="none" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" stroke-width=".125em"><path d="M12 22c2.773 0 1.189-5.177 3-7 1.796-1.808 7-.25 7-3 0-5.523-4.477-10-10-10S2 6.477 2 12s4.477 10 10 10z"></path><path d="M20 17c-3 3-5 5-8 5"></path></g>',shapeTitleSelectionMode:"Selection mode",shapeTitleBrushSize:"Brush size",shapeLabelSelectionModeNew:"New",shapeLabelSelectionModeAdd:"Add",shapeLabelSelectionModeSubtract:"Remove",shapeLabelToolSelectionBrush:"Brush",shapeLabelToolSelectionLassoo:"Lassoo",shapeLabelToolSelectionRectangle:"Rectangle marquee",shapeLabelToolSelectionEllipse:"Ellipse marquee",shapeIconSelectionModeNew:'<g fill="none" fill-rule="evenodd" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"><path d="M6.5 17H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v1.5"/><rect width="12" height="12" x="9" y="9" fill="currentColor" fill-opacity=".25" rx="2"/></g>',shapeIconSelectionModeAdd:'<g fill="none" fill-rule="evenodd" stroke="currentColor"><path fill="currentColor" fill-opacity=".25" stroke-linecap="round" stroke-linejoin="round" d="M15 3a2 2 0 0 1 2 2v4h2a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-8a2 2 0 0 1-2-2v-2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h10Z"/><path d="M13 15h4M15 13v4"/></g>',shapeIconSelectionModeSubtract:'<g fill="none" fill-rule="evenodd" stroke="currentColor"><path fill="currentColor" fill-opacity=".25" stroke-linecap="round" stroke-linejoin="round" d="M15 3a2 2 0 0 1 2 2v4h-6a2 2 0 0 0-1.995 1.85L9 11v6H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h10Z"/><rect width="12" height="12" x="9" y="9" stroke-linecap="round" stroke-linejoin="round" rx="2"/><path d="M13 15h4"/></g>',shapeIconToolSelectionBrush:'<g stroke-width=".125em" stroke="currentColor" fill="none"><path d="M2.025 5c5.616-2.732 8.833-3.857 9.65-3.374C12.903 2.351.518 12.666 2.026 14 3.534 15.334 16.536.566 17.73 2.566 18.924 4.566 3.98 17.187 4.831 18c.851.813 9.848-6 11.643-6 1.087 0-2.53 5.11-2.92 7-.086.41 3.323-1.498 4.773-1 .494.17.64 2.317 1.319 3 .439.443 1.332.776 2.679 1" stroke="currentColor" fill-rule="evenodd" stroke-linejoin="round"/></g>',shapeIconToolSelectionLassoo:'<g fill="none" fill-rule="evenodd" stroke-width=".125em" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M11.428 17.702a18.46 18.46 0 0 0 4.085-1.595c5.851-3.112 9.019-8.599 7.074-12.256-1.945-3.657-8.265-4.1-14.116-.988C2.619 5.974-.55 11.46 1.396 15.118c.63 1.186 1.72 2.033 3.105 2.532"/><ellipse cx="8" cy="18.5" rx="3.5" ry="2.833" transform="rotate(-15 8 18.5)"/><path stroke-linecap="round" d="M5 18c3.347 1.048 5.514 1.881 6.5 2.5.859.54 1.517.994 1.5 2.364"/></g>',shapeIconToolSelectionRectangle:'<g stroke-width=".125em" stroke="currentColor"><path d="M9 1 h6 m4 0 h4v4 m0 4 v6 m0 4 v4h-4 m-4 0 h-6 m-4 0 h-4v-4 m0 -4 v-6 m0 -4 v-4h4" fill="none" /></g>',shapeIconToolSelectionEllipse:'<path stroke-width=".125em" stroke="currentColor" d="M1.21 9.853a11.054 11.054 0 0 0 0 4.294m1.643 3.965a11.054 11.054 0 0 0 3.035 3.035m3.965 1.644a11.054 11.054 0 0 0 4.294 0m3.965-1.644a11.054 11.054 0 0 0 3.035-3.035m1.644-3.965a11.054 11.054 0 0 0 0-4.294m-1.644-3.965a11.054 11.054 0 0 0-3.035-3.035m-3.965-1.644a11.054 11.054 0 0 0-4.294 0M5.888 2.853a11.054 11.054 0 0 0-3.035 3.035"/>'};var h8={cropLabel:"Crop",cropIcon:'<g stroke-width=".125em" stroke="currentColor" fill="none"><path d="M23 17H9a2 2 0 0 1-2-2v-5m0-3V1 M1 7h14a2 2 0 0 1 2 2v7m0 4v3"/></g>',cropIconButtonRecenter:'<path stroke="currentColor" fill="none" stroke-width="2" stroke-linejoin="bevel" d="M1.5 7.5v-6h6M1.5 16.5v6h6M22.5 16.5v6h-6M22.5 7.5v-6h-6"/><circle cx="12" cy="12" r="3.5" fill="currentColor" stroke="none"/>',cropIconButtonRotateLeft:'<g stroke="none" fill="currentColor"><path fill="none" d="M-1-1h582v402H-1z"/><rect x="3" rx="1" height="12" width="12" y="9"/><path d="M15 5h-1a5 5 0 015 5 1 1 0 002 0 7 7 0 00-7-7h-1.374l.747-.747A1 1 0 0011.958.84L9.603 3.194a1 1 0 000 1.415l2.355 2.355a1 1 0 001.415-1.414l-.55-.55H15z"/></g>',cropIconButtonRotateRight:'<g stroke="none" fill="currentColor"><path fill="none" d="M-1-1h582v402H-1z"/><path d="M11.177 5H10a5 5 0 00-5 5 1 1 0 01-2 0 7 7 0 017-7h1.374l-.747-.747A1 1 0 0112.042.84l2.355 2.355a1 1 0 010 1.415l-2.355 2.354a1 1 0 01-1.415-1.414l.55-.55z"/><rect rx="1" height="12" width="12" y="9" x="9"/></g>',cropIconButtonFlipVertical:'<g stroke="none" fill="currentColor"><path d="M19.993 12.143H7a1 1 0 0 1-1-1V5.994a1 1 0 0 1 1.368-.93l12.993 5.15a1 1 0 0 1-.368 1.93z"/><path d="M19.993 14a1 1 0 0 1 .368 1.93L7.368 21.078A1 1 0 0 1 6 20.148V15a1 1 0 0 1 1-1h12.993z" opacity=".6"/></g>',cropIconButtonFlipHorizontal:'<g stroke="none" fill="currentColor"><path d="M11.93 7.007V20a1 1 0 0 1-1 1H5.78a1 1 0 0 1-.93-1.368l5.15-12.993a1 1 0 0 1 1.929.368z"/><path d="M14 7.007V20a1 1 0 0 0 1 1h5.149a1 1 0 0 0 .93-1.368l-5.15-12.993A1 1 0 0 0 14 7.007z" opacity=".6"/></g>',cropIconSelectPreset:(t,e)=>{const[i,n,r]=e?[e<1?1:.3,e===1?.85:.5,e>1?1:.3]:[.2,.3,.4];return`<g fill="currentColor">
            <rect opacity="${i}" x="2" y="4" width="10" height="18" rx="1"/>
            <rect opacity="${n}" x="4" y="8" width="14" height="14" rx="1"/>
            <rect opacity="${r}" x="6" y="12" width="17" height="10" rx="1"/>
        </g>`},cropIconCropBoundary:(t,e)=>{const[i,n,r,o]=e?[.3,1,0,0]:[0,0,.3,1];return`<g fill="currentColor">
            <rect opacity="${i}" x="2" y="3" width="20" height="20" rx="1"/>
            <rect opacity="${n}" x="7" y="8" width="10" height="10" rx="1"/>
            <rect opacity="${r}" x="4" y="8" width="14" height="14" rx="1"/>
            <rect opacity="${o}" x="12" y="4" width="10" height="10" rx="1"/>
        </g>`},cropLabelButtonRecenter:"Recenter",cropLabelButtonRotateLeft:"Rotate left",cropLabelButtonRotateRight:"Rotate right",cropLabelButtonFlipHorizontal:"Flip horizontal",cropLabelButtonFlipVertical:"Flip vertical",cropLabelSelectPreset:"Crop shape",cropLabelCropBoundary:"Crop boundary",cropLabelCropBoundaryEdge:"Edge of image",cropLabelCropBoundaryNone:"None",cropLabelTabRotation:"Rotation",cropLabelTabZoom:"Scale"},m8={fillLabel:"Fill",fillIcon:`
    <g fill="none" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" stroke-width=".125em">
        <g transform="rotate(60, 12, 12)">
            <rect x="4" y="4" width="14" height="16" rx="3"/>
        </g>
        <path d="M21 13 L21 21"></path>
        <path d="M4.5 12.5 L19 12.5"></path>
    </g>
    `},$8={frameLabel:"Frame",frameIcon:`<g fill="none" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" stroke-width=".125em">
            <rect x="2" y="2" width="20" height="20" rx="4"/>
            <rect x="6" y="6" width="12" height="12" rx="1"/>
        </g>`,frameLabelMatSharp:"Mat",frameLabelMatRound:"Bevel",frameLabelLineSingle:"Line",frameLabelLineMultiple:"Zebra",frameLabelEdgeSeparate:"Inset",frameLabelEdgeOverlap:"Plus",frameLabelEdgeCross:"Lumber",frameLabelCornerHooks:"Hook",frameLabelPolaroid:"Polaroid"},g8={redactLabel:"Redact",redactIcon:'<g fill="none" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" stroke-width=".125em"><path d="M 4 5 l 1 -1"/><path d="M 4 10 l 6 -6"/><path d="M 4 15 l 11 -11"/><path d="M 4 20 l 16 -16"/><path d="M 9 20 l 11 -11"/><path d="M 14 20 l 6 -6"/><path d="M 19 20 l 1 -1"/></g>'},mh=(t,e)=>{const i=Object.getOwnPropertyDescriptors(t);Object.keys(i).forEach(n=>{i[n].get?Object.defineProperty(e,n,{get:()=>t[n],set:r=>t[n]=r}):e[n]=t[n]})},ix=t=>{const e={},{sub:i,pub:n}=ns();Mr()&&document.doctype!==null||console.warn("Browser is in quirks mode, add <!DOCTYPE html> to page to fix render issues");const r=r2();mh(r,e);const o=((c,d)=>{const u={},p=new Ng({target:c,props:{stores:d,pluginComponents:Array.from(dh)}});let h=!1;const g=()=>{h||(Mr()&&window.removeEventListener("pagehide",g),p&&(h=!0,p.$destroy()))};Op||(Op=new Set(Xh(Ng).filter(f=>!S3.includes(f)))),Op.forEach(f=>{Object.defineProperty(u,f,{get:()=>p[f],set:k3.includes(f)?b=>{p[f]={...p[f],...b}}:b=>p[f]=b})}),Object.defineProperty(u,"previewImageData",{get:()=>p.imagePreviewCurrent}),O2.forEach(f=>{const b=pu[f],w=b[0];Object.defineProperty(u,f,{get:()=>p.pluginInterface[w][f],set:S=>{const C=b.reduce((R,M)=>(R[M]={...p.pluginOptions[M],[f]:S},R),{});p.pluginOptions={...p.pluginOptions,...C}}})}),Object.defineProperty(u,"element",{get:()=>p.root,set:()=>{}});const m=p.history;return Cu(u,{on:(f,b)=>{if(h)return()=>{};if(/undo|redo|revert|writehistory/.test(f))return m.on(f,b);const w=[p.sub(f,b),p.$on(f,S=>b(S instanceof CustomEvent&&!S.detail?void 0:S))].filter(Boolean);return()=>w.forEach(S=>S())},updateImagePreview:f=>{p.imagePreviewSrc=f},close:()=>!h&&p.pub("close"),destroy:g}),Object.defineProperty(u,"history",{get:()=>({undo:()=>m.undo(),redo:()=>m.redo(),revert:()=>m.revert(),get:()=>m.get(),getCollapsed:()=>m.get().splice(0,m.index+1),set:f=>m.set(f),write:f=>m.write(f),get length(){return m.length()},get index(){return m.index},set index(f){m.index=f}})}),Mr()&&window.addEventListener("pagehide",g),u})(t,r.stores);mh(o,e);const a=["loadImage","processImage","abortProcessImage","abortLoadImage"].map(c=>o.on(c,d=>{const u=r[c](d&&d.detail);u instanceof Promise&&u.catch($e)})),s=(c,d)=>{const u=i(c,d),p=r.on(c,d),h=o.on(c,d);return()=>{u(),p(),h()}};e.handleEvent=$e;const l=W2.map(c=>s(c,d=>e.handleEvent(c,d)));return Cu(e,{on:s,updateImage:c=>new Promise((d,u)=>{const p=e.history.get(),h=e.history.index,g=e.imageState;r.loadImage(c).then(m=>{e.history.set(p),e.history.index=h,e.imageState=g,d(m)}).catch(u)}),close:()=>{n("close")},destroy:()=>{[...a,...l].forEach(c=>c()),o.destroy(),r.destroy(),n("destroy")}}),setTimeout(()=>n("init",e),0),e};Mr();var f8=(t,e={})=>{const i=Ve(t)?document.querySelector(t):t;if(!Bl(i))return;e.class=e.class?"pintura-editor "+e.class:"pintura-editor";const n=ix(i);return Object.assign(n,e)};const jf=(t,e,i,n)=>{const r=ot(e.x-t.x,e.y-t.y),o=no(r),a=5*i;let s;s=n?.5*a:Math.ceil(.5*(a-1));const l=Tr(Oe(o),s);return{anchor:Oe(t),offset:l,normal:o,solid:n,size:a,sizeHalf:s}},y8=(t,e,i)=>{const{strokeWidth:n,strokeColor:r,strokeJoin:o,strokeCap:a,...s}=t,{anchor:l,offset:c,normal:d,solid:u,size:p,sizeHalf:h}=e,g=l.x,m=l.y,f=Tr(Oe(d),p),b=ot(g+f.x,m+f.y);if(Tr(f,.55),u){Fn(i,c);const w=Tr(Oe(d),.5*h);return[{...s,points:[ot(g-w.x,m-w.y),ot(b.x-f.y,b.y+f.x),ot(b.x+f.y,b.y-f.x)],pathClose:!0,backgroundColor:r}]}{const w=Tr((R=>{const M=R.x;return R.x=-R.y,R.y=M,R})(Oe(d)),.5),S=ot(g-w.x,m-w.y),C=ot(g+w.x,m+w.y);return[{...s,points:[ot(b.x+f.y,b.y-f.x),S,ot(g,m),C,ot(b.x-f.y,b.y+f.x)],pathClose:!1,strokeWidth:n,strokeColor:r,strokeJoin:o,strokeCap:a}]}},x8=(t,e,i)=>{const{strokeWidth:n,strokeColor:r,...o}=t,{anchor:a,solid:s,offset:l,normal:c,sizeHalf:d}=e;return Fn(i,l),s&&Fn(i,El(Oe(c))),[{...o,x:a.x,y:a.y,rx:d,ry:d,backgroundColor:s?r:void 0,strokeWidth:s?void 0:n,strokeColor:s?void 0:r}]},b8=(t,e)=>{const{strokeWidth:i,strokeColor:n,strokeJoin:r,strokeCap:o,...a}=t,{anchor:s,offset:l}=e;return[{...a,points:[ot(s.x-l.y,s.y+l.x),ot(s.x+l.y,s.y-l.x)],strokeWidth:i,strokeColor:n,strokeJoin:r,strokeCap:o}]},v8=(t,e,i)=>{const{strokeWidth:n,strokeColor:r,...o}=t,{anchor:a,solid:s,offset:l,normal:c,sizeHalf:d}=e;return Fn(i,l),[{...o,x:a.x-d,y:a.y-d,width:2*d,height:2*d,rotation:(u=c,Math.atan2(u.y,u.x)),backgroundColor:s?r:void 0,strokeWidth:s?void 0:n,strokeColor:s?void 0:r}];var u},w8=(t={})=>e=>{if(!e.lineStart&&!e.lineEnd)return;const i=[],{x1:n,y1:r,x2:o,y2:a,lineStart:s,lineEnd:l,strokeWidth:c,strokeColor:d,strokeJoin:u,strokeCap:p,strokeDash:h,bitmap:g,aboveFrame:m,opacity:f}=e,b=ot(n,r),w=ot(o,a),S=[b,w],C={bitmap:g,aboveFrame:m,opacity:f,strokeColor:d,strokeWidth:c,strokeJoin:u,strokeCap:p};if(s){const[R,M]=s.split("-"),D=t[R];if(D){const T=jf(b,w,c,!!M);i.push(...D(C,T,b))}}if(l){const[R,M]=l.split("-"),D=t[R];if(D){const T=jf(w,b,c,!!M);i.push(...D(C,T,w))}}return[{...C,strokeDash:h,points:S},...i]},S8=()=>({arrow:y8,circle:x8,square:v8,bar:b8}),$h=(t,e)=>{const i=parseFloat(t)*e;return Ve(t)?i+"%":i},ia=(t,e)=>Ve(t)?vu(t,e):t,k8=t=>[{...t,frameStyle:"line",frameInset:0,frameOffset:0,frameSize:t.frameSize?$h(t.frameSize,2):"2.5%",frameRadius:t.frameRound?$h(t.frameSize,2):0}],C8=({width:t,height:e,frameImage:i,frameSize:n="15%",frameOutset:r=0,frameSlices:o={x1:.15,y1:.15,x2:.85,y2:.85}},{isPreview:a})=>{if(!i)return[];const s=Math.sqrt(t*e),l=ia(n,s),c=a?l:Math.round(l),d=c,u=ia(r,s),p=2*u,{x1:h,x2:g,y1:m,y2:f}=o,b={x0:0,y0:0,x1:c,y1:d,x2:t-c,y2:e-d,x3:t,y3:e,cw:c,ch:d,ew:t-c-c,eh:e-d-d},w=a?1:0,S=2*w,C=u>0,R={expandsCanvas:C,width:b.cw,height:b.ch,backgroundImage:i};return[{expandsCanvas:C,x:b.x1-w-u,y:b.y0-u,width:b.ew+S+p,height:b.ch,backgroundCorners:[{x:h,y:0},{x:g,y:0},{x:g,y:m},{x:h,y:m}],backgroundImage:i},{expandsCanvas:C,x:b.x1-w-u,y:b.y2+u,width:b.ew+S+p,height:b.ch,backgroundCorners:[{x:h,y:f},{x:g,y:f},{x:g,y:1},{x:h,y:1}],backgroundImage:i},{expandsCanvas:C,x:b.x0-u,y:b.y1-w-u,width:b.cw,height:b.eh+S+p,backgroundCorners:[{x:0,y:m},{x:h,y:m},{x:h,y:f},{x:0,y:f}],backgroundImage:i},{expandsCanvas:C,x:b.x2+u,y:b.y1-w-u,width:b.cw,height:b.eh+S+p,backgroundCorners:[{x:g,y:m},{x:1,y:m},{x:1,y:f},{x:g,y:f}],backgroundImage:i},{...R,x:b.x0-u,y:b.y0-u,backgroundCorners:[{x:0,y:0},{x:h,y:0},{x:h,y:m},{x:0,y:m}]},{...R,x:b.x2+u,y:b.y0-u,backgroundCorners:[{x:g,y:0},{x:1,y:0},{x:1,y:m},{x:g,y:m}]},{...R,x:b.x2+u,y:b.y2+u,backgroundCorners:[{x:g,y:f},{x:1,y:f},{x:1,y:1},{x:g,y:1}]},{...R,x:b.x0-u,y:b.y2+u,backgroundCorners:[{x:0,y:f},{x:h,y:f},{x:h,y:1},{x:0,y:1}]}]},T8=({x:t,y:e,width:i,height:n,frameInset:r="3.5%",frameSize:o=".25%",frameColor:a=[1,1,1],frameOffset:s="5%",frameAmount:l=1,frameRadius:c=0,expandsCanvas:d=!1},{isPreview:u})=>{const p=Math.sqrt(i*n);let h=ia(o,p);const g=ia(r,p),m=ia(s,p);let f=0;u||(h=Math.max(1,Math.round(h)),f=h%2==0?0:.5);const b=ia($h(c,l),p);return new Array(l).fill(void 0).map((w,S)=>{const C=m*S;let R=t+g+C,M=e+g+C,D=t+i-g-C,T=e+n-g-C;return u||(R=Math.round(R),M=Math.round(M),D=Math.round(D),T=Math.round(T)),{x:R+f,y:M+f,width:D-R,height:T-M,cornerRadius:b>0?b-C:0,strokeWidth:h,strokeColor:a,expandsCanvas:d}})},M8=({x:t,y:e,width:i,height:n,frameSize:r=".25%",frameOffset:o=0,frameInset:a="2.5%",frameColor:s=[1,1,1]},{isPreview:l})=>{const c=Math.sqrt(i*n);let d=ia(r,c),u=ia(a,c),p=ia(o,c),h=0;l||(d=Math.max(1,Math.round(d)),u=Math.round(u),p=Math.round(p),h=d%2==0?0:.5);const g=p-u,m=t+u+h,f=e+u+h,b=t+i-u-h,w=e+n-u-h;return[{points:[ot(m+g,f),ot(b-g,f)]},{points:[ot(b,f+g),ot(b,w-g)]},{points:[ot(b-g,w),ot(m+g,w)]},{points:[ot(m,w-g),ot(m,f+g)]}].map(S=>(S.strokeWidth=d,S.strokeColor=s,S))},P8=({x:t,y:e,width:i,height:n,frameSize:r=".25%",frameInset:o="2.5%",frameLength:a="2.5%",frameColor:s=[1,1,1]},{isPreview:l})=>{const c=Math.sqrt(i*n);let d=ia(r,c),u=ia(o,c),p=ia(a,c),h=0;l||(d=Math.max(1,Math.round(d)),u=Math.round(u),p=Math.round(p),h=d%2==0?0:.5);const g=t+u+h,m=e+u+h,f=t+i-u-h,b=e+n-u-h;return[{points:[ot(g,m+p),ot(g,m),ot(g+p,m)]},{points:[ot(f-p,m),ot(f,m),ot(f,m+p)]},{points:[ot(f,b-p),ot(f,b),ot(f-p,b)]},{points:[ot(g+p,b),ot(g,b),ot(g,b-p)]}].map(w=>(w.strokeWidth=d,w.strokeColor=s,w))},R8=({x:t,y:e,width:i,height:n,frameColor:r=[1,1,1]},{isPreview:o})=>{const a=Math.sqrt(i*n),s=.1*a;let l=.2*a,c=0;const d=.5*s;return o?c=1:l=Math.ceil(l),r.length=3,[{id:"border",x:t-d+c,y:e-d+c,width:i+s-2*c,height:n+l-2*c,frameStyle:"line",frameInset:0,frameOffset:0,frameSize:s,frameColor:r,expandsCanvas:!0},{id:"chin",x:t-d,y:n-c,width:i+s,height:l,backgroundColor:r,expandsCanvas:!0}].filter(Boolean)},I8=(t={})=>(e,i)=>{if(!Ie(e,"frameStyle"))return;const n=e.frameStyle,r=t[n];if(!r)return;const{frameStyle:o,...a}=e;return r(a,i)},E8=()=>({solid:k8,hook:P8,line:T8,edge:M8,polaroid:R8,nine:C8}),A8=t=>{const e=(i,n={isPreview:!0})=>{const r=t.map(o=>{const a=o(i,n);if(a)return a.map(s=>e(s,n))}).filter(Boolean).flat();return r.length?r.flat().map((o,a)=>(o.id=i.id+"_"+a,o)):i};return e};typeof window<"u"&&(t=>{if(!t)return;const[e,i,n,r]=[[108,111,99,97,116,105,111,110],[82,101,103,69,120,112],[116,101,115,116],[112,113,105,110,97,92,46,110,108]].map(o=>o.map(a=>String.fromCharCode(a)).join(""));t._4ijgope=new t[i](r)[n](t[e])})(window);const L8=g2,Uf=f2,z8=()=>({read:ib,apply:Yf}),F8=(t={})=>{const{blurAmount:e,dataSizeScalar:i,scrambleAmount:n,backgroundColor:r}=t;return(o,a)=>(async(s,l={})=>{if(!s)return;const{width:c,height:d}=s,{dataSize:u=96,dataSizeScalar:p=1,scrambleAmount:h=4,blurAmount:g=6,outputFormat:m="canvas",backgroundColor:f=[0,0,0]}=l,b=Math.round(u*p),w=Math.min(b/c,b/d),S=Math.floor(c*w),C=Math.floor(d*w),R=fn("canvas",{width:S,height:C}),M=R.getContext("2d",{willReadFrequently:!0});if(f.length=3,M.fillStyle=gr(f),M.fillRect(0,0,S,C),Fl(s)){const W=fn("canvas",{width:c,height:d});W.getContext("2d",{willReadFrequently:!0}).putImageData(s,0,0),M.drawImage(W,0,0,S,C),Kn(W)}else M.drawImage(s,0,0,S,C);const D=M.getImageData(0,0,S,C),T=[];if(h>0&&T.push([Uv,{amount:h}]),g>0)for(let W=0;W<g;W++)T.push([xy,{matrix:Gv}]);let F;if(T.length){const W=(V,tt)=>`(err, imageData) => {
(${V[tt][0].toString()})(Object.assign({ imageData: imageData }, filterInstructions[${tt}]), 
${V[tt+1]?W(V,tt+1):"done"})
}`,B=`function (options, done) {
const filterInstructions = options.filterInstructions;
const imageData = options.imageData;
(${W(T,0)})(null, imageData)
}`,y=await Nc(B,[{imageData:D,filterInstructions:T.map(V=>V[1])}],[D.data.buffer]);F=Ph(y)}else F=D;return m==="canvas"?(M.putImageData(F,0,0),R):F})(o,{blurAmount:e,scrambleAmount:n,backgroundColor:r,...a,dataSizeScalar:i||a.dataSizeScalar})},D8=q2,B8={markupEditorToolbar:hw(),markupEditorToolStyles:pw(),markupEditorShapeStyleControls:q2()},O8=vS,W8=MS,_8=zS,V8=A6,N8=F6,H8=O6,j8=j6,U8=r8,G8=e8,Z8=d8,X8=J3,Y8=H3,q8=lw,K8=u8,J8=p8,Q8=h8,tk=m8,ek={filterLabel:"Filter",filterIcon:'<g stroke-width=".125em" stroke="currentColor" fill="none"><path d="M18.347 9.907a6.5 6.5 0 1 0-1.872 3.306M3.26 11.574a6.5 6.5 0 1 0 2.815-1.417 M10.15 17.897A6.503 6.503 0 0 0 16.5 23a6.5 6.5 0 1 0-6.183-8.51"/></g>',filterLabelChrome:"Chrome",filterLabelFade:"Fade",filterLabelCold:"Cold",filterLabelWarm:"Warm",filterLabelPastel:"Pastel",filterLabelMonoDefault:"Mono",filterLabelMonoNoir:"Noir",filterLabelMonoWash:"Wash",filterLabelMonoStark:"Stark",filterLabelSepiaDefault:"Sepia",filterLabelSepiaBlues:"Blues",filterLabelSepiaRust:"Rust",filterLabelSepiaColor:"Color"},ik={finetuneLabel:"Finetune",finetuneIcon:'<g stroke-width=".125em" stroke="currentColor" fill="none"><path d="M4 1v5.5m0 3.503V23M12 1v10.5m0 3.5v8M20 1v15.5m0 3.5v3M2 7h4M10 12h4M18 17h4"/></g>',finetuneLabelBrightness:"Brightness",finetuneLabelContrast:"Contrast",finetuneLabelSaturation:"Saturation",finetuneLabelExposure:"Exposure",finetuneLabelTemperature:"Temperature",finetuneLabelGamma:"Gamma",finetuneLabelClarity:"Clarity",finetuneLabelVignette:"Vignette"},nk={resizeLabel:"Resize",resizeIcon:'<g stroke-width=".125em" stroke="currentColor" fill="none"><rect x="2" y="12" width="10" height="10" rx="2"/><path d="M4 11.5V4a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-5.5"/><path d="M14 10l3.365-3.365M14 6h4v4"/></g>',resizeLabelFormCaption:"Image output size",resizeLabelInputWidth:"w",resizeTitleInputWidth:"Width",resizeLabelInputHeight:"h",resizeTitleInputHeight:"Height",resizeTitleButtonMaintainAspectRatio:"Maintain aspectratio",resizeIconButtonMaintainAspectRatio:(t,e)=>`<defs><mask id="mask1" x="0" y="0" width="24" height="24" ><rect x="0" y="0" width="24" height="10" fill="#fff" stroke="none"/></mask></defs><g fill="none" fill-rule="evenodd"><g  mask="url(#mask1)"><path transform="translate(0 ${3*(e-1)})" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" d="M9.401 10.205v-.804a2.599 2.599 0 0 1 5.198 0V17"/></g><rect fill="currentColor" x="7" y="10" width="10" height="7" rx="1.5"/></g>`},rk={decorateLabel:"Decorate",decorateIcon:'<g fill="none" fill-rule="evenodd"><path stroke="currentColor" stroke-width=".125em" stroke-linecap="round" stroke-linejoin="round" d="M12 18.5l-6.466 3.4 1.235-7.2-5.23-5.1 7.228-1.05L12 2l3.233 6.55 7.229 1.05-5.231 5.1 1.235 7.2z"/></g>'},ok={annotateLabel:"Annotate",annotateIcon:'<g stroke-width=".125em" stroke="currentColor" fill="none"><path d="M17.086 2.914a2.828 2.828 0 1 1 4 4l-14.5 14.5-5.5 1.5 1.5-5.5 14.5-14.5z"/></g>'},ak={stickerLabel:"Sticker",stickerIcon:'<g fill="none" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" stroke-width=".125em"><path d="M12 22c2.773 0 1.189-5.177 3-7 1.796-1.808 7-.25 7-3 0-5.523-4.477-10-10-10S2 6.477 2 12s4.477 10 10 10z"/><path d="M20 17c-3 3-5 5-8 5"/></g>'},sk=$8,lk=g8,ck=f8,dk=(t=[])=>A8([I8(E8()),w8(S8()),...t]),uk=(t={})=>{let e,i;Array.isArray(t.imageReader)||(i=t.imageReader,delete t.imageReader),Array.isArray(t.imageWriter)?e=Uf():(e=cn(t.imageWriter)?t.imageWriter:Uf(t.imageWriter),delete t.imageWriter);let n;return cn(t.imageScrambler)||(n=t.imageScrambler,delete t.imageScrambler),{imageReader:L8(i),imageWriter:e,imageOrienter:z8(),imageScrambler:F8(n)}},pk=(t={})=>{C3(O8,W8,_8,V8,N8,H8,j8,U8,G8,Z8);const e=uk(t),i={...K8,...J8,...Q8,...tk,...ek,...ik,...sk,...lk,...nk,...rk,...ok,...ak,...t.locale};delete t.locale;const n=typeof t.shapePreprocessor=="function"?t.shapePreprocessor:dk(t.shapePreprocessor);return delete t.shapePreprocessor,t.markupEditorShapeStyleControls&&Object.entries(t.markupEditorShapeStyleControls).every(([r,o])=>/Options$/.test(r)||!Array.isArray(o))&&(t.markupEditorShapeStyleControls=D8({...t.markupEditorShapeStyleControls})),Jy([{...e,shapePreprocessor:n,utils:["trim","crop","filter","finetune","retouch","annotate","decorate","sticker","fill","frame","redact","resize"],...X8,...Y8,...q8,...B8,stickerStickToImage:!0,locale:i},t])},hk={mounted(){this.editor=ck(this.$refs.elementRef,Object.assign({},this.$attrs)),this.unsubs=_2(this.editor,this.$refs.elementRef)},beforeUpdate(){Object.assign(this.editor,Object.assign({},this.$attrs))},beforeUnmount(){this.editor&&(this.editor.destroy(),this.unsubs.forEach(t=>t()),this.unsubs=[],this.editor=void 0)},render(){return jx("div",{className:"PinturaRootWrapper",ref:"elementRef"})}},mk=Ux({__name:"MediaImageEditor",props:{media:{}},async setup(t){let e,i;const n=t,r=pk({enableButtonClose:!0});n.media.fetch();const o=([e,i]=Gx(()=>Nx(n.media)),e=await e,i(),e);function a(l){n.media.setMediaImage(l.detail.dest),n.media.setEditing(!1),n.media.setUniqueId()}function s(l){l||n.media.setEditing(!1)}return(l,c)=>(Zx(),Xx(Jx,{to:"#drawer-editor"},[um(Qx,{width:500,"rail-width":500,touchless:"","model-value":!0,"disable-resize-watcher":!0,elevation:0,class:"ig-navigation-drawer-editor","onUpdate:modelValue":s},{default:Yx(()=>[um(np(hk),qx(np(r),{src:np(o),"onPintura:process":c[0]||(c[0]=d=>a(d)),"onPintura:close":c[1]||(c[1]=d=>l.media.setEditing(!1)),onContextmenu:c[2]||(c[2]=Kx(()=>{},["stop"]))}),null,16,["src"])]),_:1})]))}}),Ak=Hx(mk,[["__scopeId","data-v-96e7af5e"]]);export{Ak as default};

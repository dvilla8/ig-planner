import{T as Dx,_ as Bx}from"./DFOKk49Z.js";import{c as Ox,d as Wx,X as _x,Q as Vx,V as Nx,l as cm,Z as Hx,u as np,z as jx,ae as Ux,aj as Gx}from"./CBwktElb.js";import{V as Zx}from"./1fnm1m0Y.js";import"./WTnMkZ-p.js";import"./qCtTLnBE.js";import"./Bo9O3lU-.js";import"./132OxzPn.js";import"./CtJoe5tf.js";import"./BmNG3gvq.js";import"./DQscML6I.js";import"./BGDHAjdV.js";import"./CCnwuFCY.js";import"./DW7h683t.js";import"./BsEl-V1y.js";import"./C_xrnIQm.js";import"./C10l4TNK.js";import"./fX8ayG_0.js";/*!
 * Pintura v8.77.1 - Test version
 * (c) 2018-2024 PQINA Inc. - All Rights Reserved
 * License: https://pqina.nl/pintura/license/
 * 
 * This version of Pintura is for testing purposes only.
 * Visit https://pqina.nl/pintura/ to obtain a commercial license.
 */const Xx=[{value:65504,name:"jfif"},{value:65498,name:"sos"},{value:65505,subvalue:17784,name:"exif"},{value:65505,subvalue:26740,name:"xmp"},{value:65506,subvalue:19792,name:"mpf"}];var Uf=t=>{if(t.getUint16(0)!==65496)return;const e=t.byteLength;let i,n=2,r;for(;n<e&&t.getUint8(n)===255;){i=t.getUint16(n);const o=Xx.find(a=>a.value===i&&(!a.subvalue||a.subvalue===t.getUint16(n+2+2)));if(o){const{name:a}=o;r||(r={}),r[a]||(r[a]={offset:n,size:t.getUint16(n+2)})}if(i===65498)break;n+=2+t.getUint16(n+2)}return r},gh=(t,e,i)=>{if(!t)return;const n=new DataView(t),r=Uf(n);if(!r||!r.exif)return;const o=((a,s)=>{if(a.getUint16(s)!==65505)return;const l=a.getUint16(s+2);if(s+=4,a.getUint32(s)!==1165519206)return;s+=6;const c=a.getUint16(s);if(c!==18761&&c!==19789)return;const d=c===18761;if(s+=2,a.getUint16(s,d)!==42)return;s+=a.getUint32(s+2,d);const u=p=>{const h=[];let g=s;const m=Math.min(a.byteLength,s+l-16);for(;g<m;g+=12){const f=g;a.getUint16(f,d)===p&&h.push(f)}return h};return{read:p=>{const h=u(p);if(h.length)return a.getUint16(h[0]+8,d)},write:(p,h)=>{const g=u(p);return!!g.length&&(g.forEach(m=>a.setUint16(m+8,h,d)),!0)}}})(n,r.exif.offset);return o?i===void 0?o.read(e):o.write(e,i):void 0},fh=t=>window.__pqina_webapi__?window.__pqina_webapi__[t]:window[t],ge=(...t)=>{};const Yx={ArrayBuffer:"readAsArrayBuffer"};var Gf=async(t,e=[0,t.size],i)=>await((n,r=ge,o={})=>new Promise((a,s)=>{const{dataFormat:l=Yx.ArrayBuffer}=o,c=new(fh("FileReader"));c.onload=()=>a(c.result),c.onerror=()=>s(c.error),c.onprogress=r,c[l](n)}))(t.slice(...e),i),qx=async(t,e)=>{const i=await Gf(t,[0,262144],e);return gh(i,274)||1};let rp=null;var Mr=()=>(rp===null&&(rp=typeof window<"u"&&window.document!==void 0),rp);let Fd=null;var wu=()=>new Promise(t=>{if(Fd===null){const e="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEASABIAAD/4QA6RXhpZgAATU0AKgAAAAgAAwESAAMAAAABAAYAAAEoAAMAAAABAAIAAAITAAMAAAABAAEAAAAAAAD/2wBDAP//////////////////////////////////////////////////////////////////////////////////////wAALCAABAAIBASIA/8QAJgABAAAAAAAAAAAAAAAAAAAAAxABAAAAAAAAAAAAAAAAAAAAAP/aAAgBAQAAPwBH/9k=";let i=Mr()?new Image:{};return i.onload=()=>{Fd=i.naturalWidth===1,i=void 0,t(Fd)},void(i.src=e)}return t(Fd)}),Nc=t=>t.getContext("2d").getImageData(0,0,t.width,t.height),vn=(t,e,i=[])=>{const n=document.createElement(t),r=Object.getOwnPropertyDescriptors(n.__proto__);for(const o in e)o==="style"?n.style.cssText=e[o]:r[o]&&r[o].set||/textContent|innerHTML/.test(o)||typeof e[o]=="function"?n[o]=e[o]:n.setAttribute(o,e[o]);return i.forEach(o=>n.appendChild(o)),n};const Kx={1:()=>[1,0,0,1,0,0],2:t=>[-1,0,0,1,t,0],3:(t,e)=>[-1,0,0,-1,t,e],4:(t,e)=>[1,0,0,-1,0,e],5:()=>[0,1,1,0,0,0],6:(t,e)=>[0,1,-1,0,e,0],7:(t,e)=>[0,-1,-1,0,e,t],8:t=>[0,-1,1,0,0,t]};var qn=t=>{t.width=1,t.height=1;const e=t.getContext("2d");e&&e.clearRect(0,0,1,1)},Fl=t=>"data"in t,yh=t=>Mr()?RegExp(t).test(window.navigator.userAgent):void 0;let op=null;var Su=()=>(op===null&&(op=yh(/Android/)),op),Zf=(t,e)=>{const i=vn("canvas",{width:t.width,height:t.height});return i.getContext("2d",e).drawImage(t,0,0),i},Nl=async(t,e=1)=>{const i=await wu(),[n,r]=i||e<5?[t.width,t.height]:[t.height,t.width],o=vn("canvas",{width:n,height:r}),a=o.getContext("2d",{willReadFrequently:!0});if(Fl(t)&&!i&&e>1){const s=vn("canvas",{width:t.width,height:t.height});s.getContext("2d",{willReadFrequently:!0}).putImageData(t,0,0),t=s}if(!i&&e>1&&a.transform.apply(a,((s,l,c=-1)=>(c===-1&&(c=1),Kx[c](s,l)))(t.width,t.height,e)),Fl(t)){if(a.putImageData(t,0,0),Su())return Zf(o)}else a.drawImage(t,0,0);return t instanceof HTMLCanvasElement&&qn(t),o},Xf=async(t,e=1)=>e===1||await wu()?t:Nc(await Nl(t,e)),al=t=>typeof t=="object";const dm=t=>t instanceof HTMLElement?t:al(t)?Yf(t):t,Yf=t=>{let e;return Array.isArray(t)?(e=[],t.forEach((i,n)=>{e[n]=dm(i)})):(e={},Object.keys(t).forEach(i=>{const n=t[i];e[i]=dm(n)})),e};var We=t=>typeof t=="string",on=t=>typeof t=="function",Jx=(t,e)=>new Promise((i,n)=>{const r=()=>i(((o,{width:a,height:s,canvasMemoryLimit:l,contextOptions:c})=>{let d=a||o.naturalWidth,u=s||o.naturalHeight;d||u||(d=300,u=150);const p=d*u;if(l&&p>l){const g=Math.sqrt(l)/Math.sqrt(p);d=Math.floor(d*g),u=Math.floor(u*g)}const h=vn("canvas");return h.width=d,h.height=u,h.getContext("2d",c).drawImage(o,0,0,d,u),h})(t,e));t.complete&&t.width?r():(t.onload=r,t.onerror=()=>n(new Error("Failed to load image")))}),qf=()=>"createImageBitmap"in window,Kf=t=>/svg/.test(t.type),na=()=>Math.random().toString(36).substring(2,9);const ap=new Map;var Hc=(t,e,i)=>new Promise((n,r)=>{const o=t.toString();let a=ap.get(o);if(!a){const l=(p=>`function () {self.onmessage = function (message) {(${p.toString()}).apply(null, message.data.content.concat([function (err, response) {
    response = response || {};
    const transfer = 'data' in response ? [response.data.buffer] : 'width' in response ? [response] : [];
    return self.postMessage({ id: message.data.id, content: response, error: err }, transfer);
}]))}}`)(t),c=URL.createObjectURL((p=>new Blob(["(",typeof p=="function"?p.toString():p,")()"],{type:"application/javascript"}))(l)),d=new Map,u=new Worker(c);a={url:c,worker:u,messages:d,terminationTimeout:void 0,terminate:()=>{clearTimeout(a.terminationTimeout),a.worker.terminate(),URL.revokeObjectURL(c),ap.delete(o)}},u.onmessage=function(p){const{id:h,content:g,error:m}=p.data;if(clearTimeout(a.terminationTimeout),a.terminationTimeout=setTimeout(()=>{d.size>0||a.terminate()},500),!d.has(h))return;const f=d.get(h);d.delete(h),m!=null?f.reject(m):f.resolve(g)},ap.set(o,a)}const s=na();a.messages.set(s,{resolve:n,reject:r}),a.worker.postMessage({id:s,content:e},i)});let sp=null;var wa=()=>(sp===null&&(sp=yh(/Firefox/)),sp);const um=async(t,e)=>{const i=await(async(r,o)=>{const a=vn("img",{src:URL.createObjectURL(r)}),s=await Jx(a,o);return URL.revokeObjectURL(a.src),s})(t,{canvasMemoryLimit:e,contextOptions:{willReadFrequently:!0}}),n=Nc(i);return qn(i),n};var Jf=async(t,e)=>{if(Su()&&!wa())return await um(t,e);let i;if(qf()&&!Kf(t)&&"OffscreenCanvas"in window)try{i=await Hc((n,r,o)=>{createImageBitmap(n).then(a=>{let s=a.width,l=a.height;const c=s*l;if(r&&c>r){const h=Math.sqrt(r)/Math.sqrt(c);s=Math.floor(s*h),l=Math.floor(l*h)}const d=new OffscreenCanvas(s,l),u=d.getContext("2d",{willReadFrequently:!0});u.drawImage(a,0,0,s,l);const p=u.getImageData(0,0,d.width,d.height);o(null,p)}).catch(a=>{o(a)})},[t,e])}catch{}return i&&i.width?i:await um(t,e)},xh=(t,e,i)=>new Promise((n,r)=>{try{t.toBlob(o=>{if(!o)return r(new Error("Failed to create blob"));n(o)},e,i)}catch(o){r(o)}}),Qx=async(t,e,i)=>{const n=await Nl(t),r=await xh(n,e,i);return qn(n),r};const tb={matroska:"mkv"};var Qf=t=>{const e=(t.match(/\/([a-z0-9]+)/)||[])[1];if(/^x/.test(e)){const[,i=""]=t.split("/x-");return tb[i]}return e},ty=t=>t.substr(0,t.lastIndexOf("."))||t;const eb=/avif|bmp|gif|jpg|jpeg|jpe|jif|jfif|png|svg|tiff|webp/;var bh=t=>{return t&&(e=(i=t,i.split(".").pop()).toLowerCase(),eb.test(e)?"image/"+(/jfif|jif|jpe|jpg/.test(e)?"jpeg":e==="svg"?"svg+xml":e):"");var e,i},Ac=(t,e,i)=>{const n=new Date().getTime(),r=t.type.length&&!/null|text/.test(t.type),o=r?t.type:i,a=((s,l)=>{const c=bh(s);if(c===l)return s;const d=Qf(l)||c;return`${ty(s)}.${d}`})(e,o);try{return new(fh("File"))([t],a,{lastModified:n,type:r?t.type:o})}catch{const l=r?t.slice():t.slice(0,t.size,o);return l.lastModified=n,l.name=a,l}},Jo=(t,e)=>t/e,Yi=t=>t;const lp=Math.PI,_o=Math.PI/2,Qo=_o/2;var za=t=>{const e=Math.abs(t)%Math.PI;return e>Qo&&e<Math.PI-Qo};const jp={Top:"t",Right:"r",Bottom:"b",Left:"l",TopLeft:"tl",TopRight:"tr",BottomRight:"br",BottomLeft:"bl"},{Top:Ps,Right:Rs,Bottom:Is,Left:Es,TopLeft:ra,TopRight:oa,BottomRight:aa,BottomLeft:sa}=jp;var Lc={[Ps]:[.5,0],[Rs]:[1,.5],[Is]:[.5,1],[Es]:[0,.5],[ra]:[0,0],[oa]:[1,0],[aa]:[1,1],[sa]:[0,1]},ai=(t,e=12)=>parseFloat(t.toFixed(e));const lu=(t,e,i)=>i+(t-i)*e,pm=t=>({x:t.x+.5*t.width,y:t.y+.5*t.height,rx:.5*t.width,ry:.5*t.height}),rn=()=>rt(0,0),rt=(t,e)=>({x:t,y:e}),hm=t=>rt(t.pageX,t.pageY),Oe=t=>rt(t.x,t.y),El=t=>(t.x=-t.x,t.y=-t.y,t),Xr=(t,e,i=rn())=>{const n=Math.cos(e),r=Math.sin(e),o=t.x-i.x,a=t.y-i.y;return t.x=i.x+n*o-r*a,t.y=i.y+r*o+n*a,t},Ss=t=>Math.sqrt(t.x*t.x+t.y*t.y),ro=t=>{const e=Math.sqrt(t.x*t.x+t.y*t.y);return e===0?rn():(t.x/=e,t.y/=e,t)},Dd=(t,e)=>Math.atan2(e.y-t.y,e.x-t.x),vs=(t,e)=>t.x===e.x&&t.y===e.y,So=(t,e)=>(t.x=e(t.x),t.y=e(t.y),t),Dn=(t,e)=>(t.x+=e.x,t.y+=e.y,t),Bn=(t,e)=>(t.x-=e.x,t.y-=e.y,t),mm=(t,e)=>(t.x/=e,t.y/=e,t),Tr=(t,e)=>(t.x*=e,t.y*=e,t),Qd=(t,e)=>t.x*e.x+t.y*e.y,tu=(t,e)=>t.x*e.y-t.y*e.x,vo=(t,e=rn())=>{const i=t.x-e.x,n=t.y-e.y;return i*i+n*n},mo=(t,e=rn())=>Math.sqrt(vo(t,e)),ib=(t,e,i)=>(t.x=lu(t.x,e,i.x),t.y=lu(t.y,e,i.y),t),Bo=t=>{let e=0,i=0;return t.forEach(n=>{e+=n.x,i+=n.y}),rt(e/t.length,i/t.length)},Al=(t,e,i,n,r)=>(t.forEach(o=>{o.x=e?n-(o.x-n):o.x,o.y=i?r-(o.y-r):o.y}),t),nl=(t,e,i,n)=>{const r=Math.sin(e),o=Math.cos(e);return t.forEach(a=>{a.x-=i,a.y-=n;const s=a.x*o-a.y*r,l=a.x*r+a.y*o;a.x=i+s,a.y=n+l}),t},Hl=(t,e)=>({width:t,height:e}),no=t=>Hl(t.width,t.height),Da=t=>Hl(t.width,t.height),rl=t=>Hl(t.width,t.height),ey=t=>Hl(t[0],t[1]),Pc=t=>{return/img/i.test(t.nodeName)?Hl((e=t).naturalWidth,e.naturalHeight):Da(t);var e},jn=(t,e)=>Hl(t,e),zc=(t,e,i=Yi)=>i(t.width)===i(e.width)&&i(t.height)===i(e.height),Bd=(t,e)=>(t.width*=e,t.height*=e,t),Dl=t=>rt(.5*t.width,.5*t.height),iy=(t,e)=>{const i=Math.abs(e),n=Math.abs(Math.cos(i)),r=Math.abs(Math.sin(i)),o=n*t.width+r*t.height,a=r*t.width+n*t.height;return t.width=o,t.height=a,t},cu=(t,e)=>t.width>=e.width&&t.height>=e.height,ns=(t,e)=>(t.width=e(t.width),t.height=e(t.height),t),As=(t,e)=>({start:t,end:e}),ny=t=>As(Oe(t.start),Oe(t.end)),vh=(t,e)=>{if(e===0)return t;const i=rt(t.start.x-t.end.x,t.start.y-t.end.y),n=ro(i),r=Tr(n,e);return t.start.x+=r.x,t.start.y+=r.y,t.end.x-=r.x,t.end.y-=r.y,t},nb=[rt(-1,-1),rt(-1,1),rt(1,1),rt(1,-1)],la=(t,e,i,n)=>({x:t,y:e,width:i,height:n}),ki=t=>la(t.x,t.y,t.width,t.height),ks=()=>la(0,0,0,0),Or=t=>la(0,0,t.width,t.height),rb=t=>la(t[3],t[0],t[1]-t[3],t[2]-t[0]),xs=t=>la(t.x||0,t.y||0,t.width||0,t.height||0),er=t=>{let e=t[0].x,i=t[0].x,n=t[0].y,r=t[0].y;return t.forEach(o=>{e=Math.min(e,o.x),i=Math.max(i,o.x),n=Math.min(n,o.y),r=Math.max(r,o.y)}),la(e,n,i-e,r-n)},cp=t=>An(t.x-t.rx,t.y-t.ry,2*t.rx,2*t.ry),$m=(t,e)=>la(t.x-.5*e.width,t.y-.5*e.height,e.width,e.height),An=(t,e,i,n)=>la(t,e,i,n),Ci=t=>rt(t.x+.5*t.width,t.y+.5*t.height),ta=(t,e)=>(t.x+=e.x,t.y+=e.y,t),Cr=(t,e,i)=>(i=i||Ci(t),t.x=e*(t.x-i.x)+i.x,t.y=e*(t.y-i.y)+i.y,t.width=e*t.width,t.height=e*t.height,t),gm=(t,e,i,n)=>{const r=(n.x-t.x)/t.width,o=(n.y-t.y)/t.height;let a=Math.max(e.width,t.width),s=Math.max(e.height,t.height);return a=Math.min(i.width,a),s=Math.min(i.height,s),t.x=n.x-r*a,t.y=n.y-o*s,t.width=a,t.height=s,t},fm=(t,e)=>{const[i,n]=Lc[e],r=i*t.width,o=n*t.height;return rt(t.x+r,t.y+o)},Cs=(t,e)=>(t.x*=e,t.y*=e,t.width*=e,t.height*=e,t),ea=(t,e,i=Yi)=>i(t.x)===i(e.x)&&i(t.y)===i(e.y)&&i(t.width)===i(e.width)&&i(t.height)===i(e.height),ir=t=>Jo(t.width,t.height),ry=(t,e,i,n,r)=>(t.x=e,t.y=i,t.width=n,t.height=r,t),ku=(t,e)=>(t.x=e.x,t.y=e.y,t.width=e.width,t.height=e.height,t),$r=(t,e,i)=>(i||(i=Ci(t)),Wo(t).map(n=>Xr(n,e,i))),eu=(t,e)=>la(.5*t.width-.5*e.width,.5*t.height-.5*e.height,e.width,e.height),du=(t,e)=>!(e.x<t.x)&&!(e.y<t.y)&&!(e.x>t.x+t.width)&&!(e.y>t.y+t.height),os=(t,e,i=rn())=>{if(t.width===0||t.height===0)return ks();const n=ir(t);e||(e=n);let r=t.width,o=t.height;return e>n?r=o*e:o=r/e,la(i.x+.5*(t.width-r),i.y+.5*(t.height-o),r,o)},qr=(t,e=ir(t),i=rn())=>{if(t.width===0||t.height===0)return ks();let n=t.width,r=n/e;return r>t.height&&(r=t.height,n=r*e),la(i.x+.5*(t.width-n),i.y+.5*(t.height-r),n,r)},ol=t=>[Math.min(t.y,t.y+t.height),Math.max(t.x,t.x+t.width),Math.max(t.y,t.y+t.height),Math.min(t.x,t.x+t.width)],Wo=t=>[rt(t.x,t.y),rt(t.x+t.width,t.y),rt(t.x+t.width,t.y+t.height),rt(t.x,t.y+t.height)],Oo=(t,e)=>{if(t)return t.x=e(t.x),t.y=e(t.y),t.width=e(t.width),t.height=e(t.height),t},oy=(t,e,i=Ci(t))=>Wo(t).map((n,r)=>{const o=nb[r];return rt(lu(n.x,1+o.x*e.x,i.x),lu(n.y,1+o.y*e.y,i.y))}),Fc=t=>(t.x=0,t.y=0,t),ym=t=>{const e=t[0],i=t[t.length-1];t=vs(e,i)?t:[...t,e];const n=e.x,r=e.y;let o,a,s,l=0,c=0,d=0,u=0;const p=t.length;for(;c<p;c++)o=t[c],a=t[c+1>p-1?0:c+1],s=(o.y-r)*(a.x-n)-(a.y-r)*(o.x-n),l+=s,d+=(o.x+a.x-2*n)*s,u+=(o.y+a.y-2*r)*s;return s=3*l,rt(n+d/s,r+u/s)},wh=(t,e)=>ay(t.start,t.end,e.start,e.end),ay=(t,e,i,n)=>{const r=(n.y-i.y)*(e.x-t.x)-(n.x-i.x)*(e.y-t.y);if(r===0)return;const o=((n.x-i.x)*(t.y-i.y)-(n.y-i.y)*(t.x-i.x))/r,a=((e.x-t.x)*(t.y-i.y)-(e.y-t.y)*(t.x-i.x))/r;return o<0||o>1||a<0||a>1?void 0:rt(t.x+o*(e.x-t.x),t.y+o*(e.y-t.y))},sy=(t,e,{ignoreIdenticalLines:i=!1,breakOnIntersection:n=!1}={})=>{const r=e.length,o=[];for(let a=0;a<r-1;a++){if(i&&(vs(t.start,e[a])||vs(t.start,e[a+1])||vs(t.end,e[a])||vs(t.end,e[a+1])))continue;const s=ay(t.start,t.end,e[a],e[a+1]);if(s){if(n)return[s];o.push(s)}}return o.length?o:void 0},Up=(t,e)=>{let i=0,n=0,r=!1;const o=e.length;for(i=0,n=o-1;i<o;n=i++)e[i].y>t.y!=e[n].y>t.y&&t.x<(e[n].x-e[i].x)*(t.y-e[i].y)/(e[n].y-e[i].y)+e[i].x&&(r=!r);return r},ly=t=>{const e=[];for(let i=0;i<t.length;i++){let n=i+1;n===t.length&&(n=0),e.push(As(Oe(t[i]),Oe(t[n])))}return e},cy=(t,e=0)=>ly(t).map(i=>vh(i,e)),uu=(t,e,i,n=0,r=!1,o=!1,a=12)=>{const s=[];for(let l=0;l<a;l++)s.push(rt(t.x+e*Math.cos(l*(2*Math.PI)/a),t.y+i*Math.sin(l*(2*Math.PI)/a)));return(r||o)&&Al(s,r,o,t.x,t.y),n&&nl(s,n,t.x,t.y),s},pu=(t,e,i,n)=>{const r=rt(t.x-i.x,t.y-i.y),o=rt(n.x-i.x,n.y-i.y),a=Qd(o,o);let s=Qd(r,o)/a;s=s<0?0:s,s=s>1?1:s;const l=rt(o.x*s+i.x-t.x,o.y*s+i.y-t.y);return Qd(l,l)<=e*e},dy=(t,e,i)=>{const n=i.length;for(let r=0;r<n-1;r++)if(pu(t,e,i[r],i[r+1]))return!0;return!1},Gp=(t,e,i)=>!!Up(t,i)||!!dy(t,e,i)||pu(t,e,i[0],i[i.length-1]),dp=(t,e,i,n,r)=>Gp(t,e,$r(i,n,r||Ci(i)));var ob=(t,e)=>{const i=Or(t),n=Ci(i),r=$r(i,e,n);return Fc(er(r))},Bl=(t,e)=>t instanceof HTMLElement&&(!e||new RegExp(`^${e}$`,"i").test(t.nodeName)),jc=t=>t instanceof File,xm=async(t,e,i)=>{const n=await xh(t,e,i);return Ac(n,"canvas")},Sh=t=>t.split("/").pop().split(/\?|\#/).shift();const ab=Mr()&&Node.prototype.replaceChildren?(t,e)=>t.replaceChildren(e):(t,e)=>{for(;t.lastChild;)t.removeChild(t.lastChild);e!==void 0&&t.append(e)},Od=Mr()&&vn("div",{class:"PinturaMeasure",style:"position:absolute;left:0;top:0;width:99999px;height:0;pointer-events:none;contain:strict;margin:0;padding:0;"});let bm;var kh=t=>(ab(Od,t),Od.parentNode||document.body.append(Od),clearTimeout(bm),bm=setTimeout(()=>{Od.remove()},500),t);let up=null;var Fa=()=>(up===null&&(up=Mr()&&/^((?!chrome|android).)*(safari|iphone|ipad)/i.test(navigator.userAgent)),up),uy=t=>new Promise((e,i)=>{let n=!1;!t.parentNode&&Fa()&&(n=!0,t.style.cssText="position:absolute;visibility:hidden;pointer-events:none;left:0;top:0;width:0;height:0;",kh(t));const r=()=>{const a=t.naturalWidth,s=t.naturalHeight;a&&s&&(n&&t.remove(),clearInterval(o),e({width:a,height:s}))};t.onerror=a=>{clearInterval(o),i(a)};const o=setInterval(r,1);r()}),py=t=>new Promise((e,i)=>{const n=()=>{e({width:t.videoWidth,height:t.videoHeight})};if(t.readyState>=1)return n();t.onloadedmetadata=n,t.onerror=()=>i(t.error)}),Cu=t=>/^image/.test(t.type),Ch=t=>new Promise(e=>{const i=We(t)?t:URL.createObjectURL(t),n=()=>{const o=new Image;o.src=i,e(o)};if(t instanceof Blob&&Cu(t))return n();const r=document.createElement("video");r.preload="metadata",r.onloadedmetadata=()=>e(r),r.onerror=n,r.src=i}),hu=t=>t.nodeName==="VIDEO",hy=async t=>{let e,i;e=t.src?t:await Ch(t);try{i=hu(e)?await py(e):await uy(e)}finally{jc(t)&&URL.revokeObjectURL(e.src)}return i},sb=async t=>{const e=await hy(t),i=await(o=>new Promise((a,s)=>{if(o.complete)return a(o);o.onload=()=>a(o),o.onerror=()=>s(new Error("Failed to load image"))}))(t),n=vn("canvas",e);n.getContext("2d",{willReadFrequently:!0}).drawImage(i,0,0);const r=await xh(n);return Ac(r,Sh(i.src))},Pl=(t=0,e=!0)=>new(fh("ProgressEvent"))("progress",{loaded:100*t,total:100,lengthComputable:e}),vm=(t,e,i=n=>n)=>t.getAllResponseHeaders().indexOf(e)>=0?i(t.getResponseHeader(e)):void 0,lb=t=>{if(!t)return null;const e=t.split(/filename=|filename\*=.+''/).splice(1).map(i=>i.trim().replace(/^["']|[;"']{0,2}$/g,"")).filter(i=>i.length);return e.length?decodeURI(e[e.length-1]):null};const cb="URL_REQUEST";class Rc extends Error{constructor(e,i,n){super(e),this.name="EditorError",this.code=i,this.metadata=n}}var my=(t,e)=>{const{headers:i={},credentials:n}=e||{};Object.entries(i).forEach(([r,o])=>t.setRequestHeader(r,o)),n&&(t.withCredentials=n!=="omit")},db=(t,e,i)=>/^data:/.test(t)?(async(n,r="data-uri",o=ge)=>{o(Pl(0));const a=await fetch(n);o(Pl(.33));const s=await a.blob();let l;Cu(s)||(l="image/"+(n.includes(",/9j/")?"jpeg":"png")),o(Pl(.66));const c=Ac(s,r,l);return o(Pl(1)),c})(t,void 0,e):((n,r,o)=>new Promise((a,s)=>{const l=()=>s(new Rc("Error fetching image",cb,c)),c=new XMLHttpRequest;c.onprogress=r,c.onerror=l,c.onload=()=>{if(!c.response||c.status>=300||c.status<200)return l();const u=vm(c,"Content-Type"),p=vm(c,"Content-Disposition",lb)||Sh(n);a(Ac(c.response,p,u||bh(p)))};const{willRequest:d}=o;Promise.resolve(d&&d(n,{resourceType:"image"})).then(u=>{if(u===!1)return s("Image load rejected");c.open("GET",n),my(c,u),c.responseType="blob",c.send()}).catch(console.error)}))(t,e,i),Th=t=>t instanceof Blob&&!(t instanceof File),$y=t=>"close"in t,ub=async(t,e,i)=>{if(jc(t)||Th(t))return t;if(We(t))return await db(t,e,i);if(Bl(t,"canvas"))return await xm(t);if(Bl(t,"img"))return await sb(t);if(Fl(t)||$y(t))return await xm(await Nl(t));throw new Rc("Invalid image source","invalid-image-source")};let pp=null;var Tu=()=>(pp===null&&(pp=Mr()&&/^mac/i.test(navigator.platform)),pp);let hp=null;var va=()=>(hp===null&&(hp=Mr()&&(yh(/iPhone|iPad|iPod/)||Tu()&&navigator.maxTouchPoints>=1)),hp),pb=async(t,e=1)=>await wu()||va()||e<5?t:jn(t.height,t.width),gy=t=>/jpeg/.test(t.type),hb=t=>{return typeof(e=t)!="object"||e.constructor!=Object?t:JSON.stringify(t);var e},Mh=(t,e=0,i)=>(e===0||(t.translate(i.x,i.y),t.rotate(e),t.translate(-i.x,-i.y)),t),fy=(t,e,i)=>(t.scale(e,i),t),mb=async(t,e={})=>{const{flipX:i,flipY:n,rotation:r,crop:o}=e,a=Da(t),s=i||n,l=!!r,c=o&&(o.x||o.y||o.width||o.height),d=c&&ea(o,Or(a)),u=c&&!d;if(!s&&!l&&!u)return t;let p,h=vn("canvas",{width:t.width,height:t.height});if(h.getContext("2d",{willReadFrequently:!0}).putImageData(t,0,0),s){const g=vn("canvas",{width:h.width,height:h.height}).getContext("2d",{willReadFrequently:!0});fy(g,i?-1:1,n?-1:1),g.drawImage(h,i?-h.width:0,n?-h.height:0),g.restore(),qn(h),h=g.canvas}if(l){const g=ns(rl(er($r(xs(h),r))),Math.floor),m=vn("canvas",{width:o.width,height:o.height}).getContext("2d",{willReadFrequently:!0});((f,x,k)=>{f.translate(x,k)})(m,-o.x,-o.y),Mh(m,r,Dl(g)),m.drawImage(h,.5*(g.width-h.width),.5*(g.height-h.height)),m.restore(),qn(h),h=m.canvas}else if(u)return p=h.getContext("2d",{willReadFrequently:!0}).getImageData(o.x,o.y,o.width,o.height),qn(h),p;return p=h.getContext("2d",{willReadFrequently:!0}).getImageData(0,0,h.width,h.height),qn(h),p},$b=(t,e)=>{const{imageData:i,width:n,height:r}=t,o=i.width,a=i.height,s=Math.round(n),l=Math.round(r),c=i.data,d=new Uint8ClampedArray(s*l*4),u=o/s,p=a/l,h=Math.ceil(.5*u),g=Math.ceil(.5*p);for(let m=0;m<l;m++)for(let f=0;f<s;f++){const x=4*(f+m*s);let k=0,w=0,C=0,P=0,R=0,W=0,T=0;const F=(m+.5)*p;for(let D=Math.floor(m*p);D<(m+1)*p;D++){const B=Math.abs(F-(D+.5))/g,y=(f+.5)*u,_=B*B;for(let J=Math.floor(f*u);J<(f+1)*u;J++){let S=Math.abs(y-(J+.5))/h;const j=Math.sqrt(_+S*S);if(j<-1||j>1||(k=2*j*j*j-3*j*j+1,k<=0))continue;S=4*(J+D*o);const Q=c[S+3];T+=k*Q,C+=k,Q<255&&(k=k*Q/250),P+=k*c[S],R+=k*c[S+1],W+=k*c[S+2],w+=k}}d[x]=P/w,d[x+1]=R/w,d[x+2]=W/w,d[x+3]=T/C}e(null,{data:d,width:s,height:l})},Ph=t=>{if(t instanceof ImageData)return t;let e;try{e=new ImageData(t.width,t.height)}catch{e=vn("canvas").getContext("2d").createImageData(t.width,t.height)}return e.data.set(t.data),e},gb=async(t,e={},i)=>{const{width:n,height:r,fit:o,upscale:a}=e;if(!n&&!r)return t;let s=n,l=r;if(n?r||(l=n):s=r,o!=="force"){const c=s/t.width,d=l/t.height;let u=1;if(o==="cover"?u=Math.max(c,d):o==="contain"&&(u=Math.min(c,d)),u>1&&a===!1)return t;s=Math.round(t.width*u),l=Math.round(t.height*u)}return s=Math.max(s,1),l=Math.max(l,1),t.width===s&&t.height===l?t:i?i(t,s,l):(t=await Hc($b,[{imageData:t,width:s,height:l}],[t.data.buffer]),Ph(t))},fb=(t,e)=>{const{imageData:i,matrix:n}=t;if(!n)return e(null,i);const r=new Uint8ClampedArray(i.width*i.height*4),o=i.data,a=o.length,s=n[0],l=n[1],c=n[2],d=n[3],u=n[4],p=n[5],h=n[6],g=n[7],m=n[8],f=n[9],x=n[10],k=n[11],w=n[12],C=n[13],P=n[14],R=n[15],W=n[16],T=n[17],F=n[18],D=n[19];let B=0,y=0,_=0,J=0,S=0,j=0,Q=0,ht=0,at=0,U=0,yt=0,$t=0;for(;B<a;B+=4)y=o[B]/255,_=o[B+1]/255,J=o[B+2]/255,S=o[B+3]/255,j=y*s+_*l+J*c+S*d+u,Q=y*p+_*h+J*g+S*m+f,ht=y*x+_*k+J*w+S*C+P,at=y*R+_*W+J*T+S*F+D,U=Math.max(0,j*at)+(1-at),yt=Math.max(0,Q*at)+(1-at),$t=Math.max(0,ht*at)+(1-at),r[B]=255*Math.max(0,Math.min(1,U)),r[B+1]=255*Math.max(0,Math.min(1,yt)),r[B+2]=255*Math.max(0,Math.min(1,$t)),r[B+3]=255*S;e(null,{data:r,width:i.width,height:i.height})},yy=(t,e)=>{const{imageData:i,matrix:n}=t;if(!n)return e(null,i);let r=n.reduce((T,F)=>T+F);r=r<=0?1:r;const o=i.width,a=i.height,s=i.data;let l=0,c=0,d=0;const u=Math.round(Math.sqrt(n.length)),p=Math.floor(u/2);let h=0,g=0,m=0,f=0,x=0,k=0,w=0,C=0,P=0,R=0;const W=new Uint8ClampedArray(o*a*4);for(d=0;d<a;d++)for(c=0;c<o;c++){for(h=0,g=0,m=0,f=0,k=0;k<u;k++)for(x=0;x<u;x++)w=d+k-p,C=c+x-p,w<0&&(w=a-1),w>=a&&(w=0),C<0&&(C=o-1),C>=o&&(C=0),P=4*(w*o+C),R=n[k*u+x],h+=s[P]*R,g+=s[P+1]*R,m+=s[P+2]*R,f+=s[P+3]*R;W[l]=h/r,W[l+1]=g/r,W[l+2]=m/r,W[l+3]=f/r,l+=4}e(null,{data:W,width:o,height:a})},yb=(t,e)=>{let{imageData:i,strength:n}=t;if(!n)return e(null,i);const r=new Uint8ClampedArray(i.width*i.height*4),o=i.width,a=i.height,s=i.data,l=(_,J)=>(c=_-R,d=J-W,Math.sqrt(c*c+d*d));let c,d,u,p,h,g,m,f,x,k,w,C=0,P=0,R=.5*o,W=.5*a,T=l(0,0);for(n>0?(u=0,p=0,h=0):(n=Math.abs(n),u=1,p=1,h=1),P=0;P<a;P++)for(C=0;C<o;C++)F=4*(C+P*o),D=s,B=r,y=l(C,P)*n/T,g=D[F]/255,m=D[F+1]/255,f=D[F+2]/255,x=D[F+3]/255,k=1-y,w=k*x+y,B[F]=(k*x*g+y*u)/w*255,B[F+1]=(k*x*m+y*p)/w*255,B[F+2]=(k*x*f+y*h)/w*255,B[F+3]=255*w;var F,D,B,y;e(null,{data:r,width:i.width,height:i.height})},xb=(t,e)=>{const{imageData:i,level:n,monochrome:r=!1}=t;if(!n)return e(null,i);const o=new Uint8ClampedArray(i.width*i.height*4),a=i.data,s=a.length;let l,c,d,u=0;const p=()=>255*(2*Math.random()-1)*n,h=r?()=>{const g=p();return[g,g,g]}:()=>[p(),p(),p()];for(;u<s;u+=4)[l,c,d]=h(),o[u]=a[u]+l,o[u+1]=a[u+1]+c,o[u+2]=a[u+2]+d,o[u+3]=a[u+3];e(null,{data:o,width:i.width,height:i.height})},bb=(t,e)=>{const{imageData:i,level:n}=t;if(!n)return e(null,i);const r=new Uint8ClampedArray(i.width*i.height*4),o=i.data,a=o.length;let s,l,c,d=0;for(;d<a;d+=4)s=o[d]/255,l=o[d+1]/255,c=o[d+2]/255,r[d]=255*Math.pow(s,n),r[d+1]=255*Math.pow(l,n),r[d+2]=255*Math.pow(c,n),r[d+3]=o[d+3];e(null,{data:r,width:i.width,height:i.height})},vb=async(t,e={})=>{const{colorMatrix:i,convolutionMatrix:n,gamma:r,noise:o,vignette:a}=e,s=[];if(n&&s.push([yy,{matrix:n.clarity}]),r>0&&s.push([bb,{level:1/r}]),i&&!(d=>{const u=d.length;let p;const h=u>=20?6:u>=16?5:3;for(let g=0;g<u;g++)if(p=d[g],p===1&&g%h!=0||p!==0&&p!==1)return!1;return!0})(i)&&s.push([fb,{matrix:i}]),(o>0||o<0)&&s.push([xb,{level:o}]),(a>0||a<0)&&s.push([yb,{strength:a}]),!s.length)return t;const l=(d,u)=>`(err, imageData) => {
            (${d[u][0].toString()})(Object.assign({ imageData: imageData }, filterInstructions[${u}]), 
                ${d[u+1]?l(d,u+1):"done"})
        }`,c=`function (options, done) {
        const filterInstructions = options.filterInstructions;
        const imageData = options.imageData;
        (${l(s,0)})(null, imageData)
    }`;return t=await Hc(c,[{imageData:t,filterInstructions:s.map(d=>d[1])}],[t.data.buffer]),Ph(t)},di=t=>typeof t=="number",mu=t=>We(t)&&t.match(/(?:[\u2700-\u27bf]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff]|[\u0023-\u0039]\ufe0f?\u20e3|\u3299|\u3297|\u303d|\u3030|\u24c2|\ud83c[\udd70-\udd71]|\ud83c[\udd7e-\udd7f]|\ud83c\udd8e|\ud83c[\udd91-\udd9a]|\ud83c[\udde6-\uddff]|\ud83c[\ude01-\ude02]|\ud83c\ude1a|\ud83c\ude2f|\ud83c[\ude32-\ude3a]|\ud83c[\ude50-\ude51]|\u203c|\u2049|[\u25aa-\u25ab]|\u25b6|\u25c0|[\u25fb-\u25fe]|\u00a9|\u00ae|\u2122|\u2139|\ud83c\udc04|[\u2600-\u26FF]|\u2b05|\u2b06|\u2b07|\u2b1b|\u2b1c|\u2b50|\u2b55|\u231a|\u231b|\u2328|\u23cf|[\u23e9-\u23f3]|[\u23f8-\u23fa]|\ud83c\udccf|\u2934|\u2935|[\u2190-\u21ff])/g)!==null,Ae=(t,e)=>t.hasOwnProperty(e),Ln=t=>Array.isArray(t);let wm=64,mp=102,Sm=112,km=!1;var xy=(t,e)=>(!km&&Mr()&&(/^win/i.test(navigator.platform)&&(mp=103),(va()||Tu())&&(wm=63.5,mp=110,Sm=123),km=!0),`<svg${e?` aria-label="${e}"`:""} width="128" height="128" viewBox="0 0 128 128" preserveAspectRatio="xMinYMin meet" xmlns="http://www.w3.org/2000/svg"><text x="${wm}" y="${mp}" alignment-baseline="text-top" dominant-baseline="text-top" text-anchor="middle" font-size="${Sm}px">${t}</text></svg>`),Ol=t=>t instanceof Blob,Dr=(t,e)=>t/e*100+"%",gr=t=>`rgba(${Math.round(255*t[0])}, ${Math.round(255*t[1])}, ${Math.round(255*t[2])}, ${di(t[3])?t[3]:1})`,iu=t=>Object.values(t).join("_");const by=async(t,e=0)=>{const i=vn("canvas",{width:80,height:80}).getContext("2d");return await((n=0)=>new Promise(r=>{setTimeout(r,n)}))(e),i.drawImage(t,0,0,80,80),!((n=>!new Uint32Array(n.getImageData(0,0,n.canvas.width,n.canvas.height).data.buffer).some(r=>r!==0))(i)&&e<=256)||await by(t,e+16)},Cm=new Map;var wb=t=>new Promise((e,i)=>{const n=new FileReader;n.onerror=()=>i(n.error),n.onload=()=>e(n.result),n.readAsDataURL(t)}),rs=()=>{let t=[];return{sub:(e,i)=>(t.push({event:e,callback:i}),()=>t=t.filter(n=>n.event!==e||n.callback!==i)),pub:(e,i)=>{t.filter(n=>n.event===e).forEach(n=>n.callback(i))}}};const Yr=32,Rh=({color:t=[0,0,0],fontSize:e=16,fontFamily:i="sans-serif",fontVariant:n="normal",fontWeight:r="normal",fontStyle:o="normal",textAlign:a="left",letterSpacing:s="normal",lineHeight:l=20},c=1)=>`font-size:${e*c}px;font-style:${o};font-weight:${r};font-family:${i};font-variant:${n};line-height:${l*c}px;text-align:${a};letter-spacing:${di(s)?s+"px":"normal"};color:${gr(t)};`,Ih=(t,e,i=1)=>{const{width:n,height:r,disableNewline:o}=e,a=!n,s=o===!1?((d="")=>d.split(`
`).length)(t):void 0,l=a?"normal":"break-word",c=a&&!s?"nowrap":"pre-line";return`max-width:none;min-width:auto;width:${a?"auto":n*i+"px"};height:${r?r*i+"px":"auto"};margin-top:0;margin-bottom:0;padding-top:${(({fontSize:d=16,lineHeight:u=20}={})=>.5*Math.max(0,d-u))(e)*i}px;word-break:${l};word-wrap:normal;white-space:${c};`},Tm=new Map,vy=t=>{const e=[];for(const i of Array.from(t.childNodes))i.nodeType===Node.TEXT_NODE?e.push(Sb(i)):e.push(...vy(i));return e},wy="pointer-events:none;visibility:hidden;position:absolute;left:0;top:0;",Sb=t=>{const e=t.nodeValue;if(!e)return[];const i=e.length,n=document.createRange();n.selectNodeContents(t);const r=[];for(let a=0;a<i;a++){n.setStart(t,0),n.setEnd(t,a+1);const s=n.getClientRects().length-1,l=e.charAt(a);r[s]?r[s]+=l:r.push(l)}const o=n.getClientRects();return r.map((a,s)=>({rect:o[s],text:a}))},Mm=new Map,Ko=(t="",e)=>{const{width:i=0,height:n=0}=e;if(i&&n)return jn(i,n);let{fontSize:r=16,fontFamily:o,lineHeight:a=20,fontWeight:s,fontStyle:l,fontVariant:c,letterSpacing:d}=e;const u=iu({text:t,fontFamily:o,fontWeight:s,fontStyle:l,fontVariant:c,fontSize:r,letterSpacing:d,lineHeight:a,width:i});let p=Mm.get(u);if(p)return p;let h=1;r>1e3&&wa()&&(h=r/1e3,r=1e3,a/=h);const g=kh(vn("pre",{contenteditable:"true",spellcheck:"false",style:`${wy}${Rh({...e,fontSize:r,lineHeight:a})};${Ih(t,e)}"`,innerHTML:t})).getBoundingClientRect();return p=Da(g),p.height+=Math.max(0,r-a),p=ns(p,m=>m*h),i&&(p.width=i),Mm.set(u,p),p},Pm=new Map,kb=(t,e)=>new Promise((i,n)=>{let r=Pm.get(t);r===void 0&&(r=((o,a)=>{const{sub:s,pub:l}=rs();let c,d;return Promise.resolve(a&&a(o,{resourceType:"stylesheet"})).then(u=>{if(u===!1)return d="requestPrevented",l("error",d);const{headers:p,credentials:h}=u||{};fetch(o,{headers:p,credentials:h}).then(g=>g.text()).then(g=>{c=g,l("load",c)}).catch(g=>{d=g,l("error",d)})}),{sub:(u,p)=>u==="load"&&c?p(c):u==="error"&&d?p(d):void s(u,p)}})(t,e),Pm.set(t,r)),r.sub("load",i),r.sub("error",n)}),Rm=async(t,e)=>{let i;try{i=await kb(t,e)}catch{return[]}const n=vn("style",{innerHTML:i,id:na()});document.head.append(n);const r=Array.from(document.styleSheets).find(o=>o.ownerNode.id===n.id);return n.remove(),Array.from(r.cssRules)},kl=new Map,Cb=async(t,e)=>{if(kl.has(t.href))return kl.get(t.href);let i;try{i=Array.from(t.cssRules);for(const n of(r=>r.filter(o=>o instanceof CSSImportRule))(i)){const r=n.href;if(kl.has(r)){const a=kl.get(r);i=[...i,...a];continue}const o=await Rm(r,e);kl.set(r,o),i=[...i,...o]}}catch{const r=t.href;i=await Rm(r,e),kl.set(r,i)}return(n=>n.filter(r=>r instanceof CSSFontFaceRule))(i)},Sy=(t,e)=>t.style.getPropertyValue(e),Tb=(t,e)=>t.style?Sy(t,"font-family").replace(/^"|"$/g,"")==e:!1,Mb=async(t,e)=>{const i=((n,r)=>{const o=[];for(const a of n)Tb(a,r)&&o.push(a);return o})(await(async n=>{const r=Array.from(document.styleSheets).map(s=>Cb(s,n)),o=await Promise.all(r),a=[];return o.forEach(s=>a.push(...s)),a})(e),t);return i.length?i.map(n=>{const r=n.parentStyleSheet.href&&new URL(n.parentStyleSheet.href),o=r?r.origin+(l=>l.pathname.split("/").slice(0,-1).join("/"))(r)+"/":"",a=n.style.getPropertyValue("src").match(/url\("?(.*?)"?\)/)[1],s=Array.from(n.style).filter(l=>l!="src").reduce((l,c)=>l+=c+":"+Sy(n,c)+";","");return[/^http/.test(a)?a:o+a,s]}):[]},Im=new Map,Em=new Map;var ky=async(t="",e)=>{if(!t.length)return;let{color:i,imageWidth:n=300,imageHeight:r=150,paddingTop:o=0,paddingRight:a=Yr,paddingBottom:s=0,paddingLeft:l=Yr,fontFamily:c,fontSize:d,pixelRatio:u=1,willRequest:p,outline:h,blur:g}=e,m=1,f="";d>1e3&&wa()&&(m=d/1e3,f=`transform-origin:0 0;transform:scale(${m})`);const x=u/m,k=(n+l+a)*u,w=(r+s+o)*u,C=await(async(D,B)=>{if(Im.get(D))return;let y=Em.get(D);if(!y){const J=await Mb(D,B);if(!J.length)return void Im.set(D,!0);const S=[];for(const[j,Q]of J){const ht=await fetch(j).then(yt=>yt.blob()),at=!(_=ht.type)||/woff2/.test(_)?"woff2":/woff/.test(_)?"woff":/ttf|truetype/.test(_)?"truetype":/otf|opentype/.test(_)?"opentype":/svg/.test(_)?"svg":"woff2",U=await wb(ht);S.push(`@font-face { src:url(${U}) format('${at}');${Q};font-display:block; }`)}y=S.join(""),Em.set(D,y)}var _;return y})(c,p),P=t.replace(/%/g,"%25").replace(/#/g,"%23").replace(/&nbsp;/g," ").replace(/&(?!#\d{4};|[a-z]+;)/gi,"&amp;").replace(/<br>|\n/g,"<br/>"),R=`top:${o*x}px;right:${a*x}px;bottom:${s*x}px;left:${l*x}px`;let W=i,T="",F="";if(h||g){const D=gr(i);h&&(W=[0,0,0,0],T=`-webkit-text-stroke: ${2*h*x}px ${D}`),g&&(Fa()?F=`filter:blur(${g*x*.4}px)`:(W=[0,0,0,0],F=`text-shadow: 0 0 ${g*x}px ${D}`))}return((D,{safariCacheKey:B="*"}={})=>new Promise((y,_)=>{const J=new Image;J.onerror=()=>_(new Error("Failed to load SVG")),J.onload=()=>{if(!Fa()||!D.includes("@font-face")||Cm.has(B))return y(J);by(J).then(()=>{Cm.set(B,!0),y(J)})},J.src="data:image/svg+xml,"+D}))(`<svg xmlns="http://www.w3.org/2000/svg" width="${k}" height="${w}" viewBox="0 0 ${k} ${w}"><foreignObject x="0" y="0" width="${k}" height="${w}"><div xmlns="http://www.w3.org/1999/xhtml">${C?`<style>${C}</style>`:""}<pre contenteditable="true" spellcheck="false" style="position:absolute;${R};${Rh({...e,color:W,fontSize:d},x)};${Ih(t,e,x)};${f};${T};${F}">${P}</pre></div></foreignObject></svg>`,{safariCacheKey:c})};const Hn=t=>{const e={...t};return Yf(e)},Am=(t,e={})=>{const i=ir(t);let n,r;const o=e.width||e.rx,a=e.height||e.ry;if(o&&a)return no(e);if(o||a){n=parseFloat(o||Number.MAX_SAFE_INTEGER),r=parseFloat(a||Number.MAX_SAFE_INTEGER);const s=Math.min(n,r);We(o)||We(a)?(n=s+"%",r=s*i+"%"):(n=s,r=s)}else n="10%",r=10*i+"%";return{[(e.width?"width":e.rx?"rx":void 0)||"width"]:n,[(e.width?"height":e.rx?"ry":void 0)||"height"]:r}},Lm=(t,e={})=>{return{width:void 0,height:void 0,...e,aspectRatio:1,backgroundImage:(i=xy(t),"data:image/svg+xml,"+i.replace("<","%3C").replace(">","%3E"))};var i},zm=(t,e={})=>({backgroundColor:[0,0,0,0],...Yn(e)?{}:{width:void 0,height:void 0,aspectRatio:void 0},...e,backgroundImage:We(t)?t:Ol(t)?URL.createObjectURL(t):t}),Fm=(t,e)=>{let i;if(We(t)||Ol(t)){const n={...Am(e),backgroundSize:"contain"};i=mu(t)?Lm(t,n):zm(t,n)}else if(t.src){const n=Am(e,t.shape||t),r={...t.shape,...n};if(t.width&&t.height&&!Ae(r,"aspectRatio")){const o=Jp(n,"width",e),a=Jp(n,"height",e);r.aspectRatio=Jo(o,a)}r.backgroundSize||t.shape||t.width&&t.height||(r.backgroundSize="contain"),i=mu(t.src)?Lm(t.src,r):zm(t.src,r)}else t.shape&&(i=Hn(t.shape));return Ae(i,"backgroundImage")&&(Ae(i,"backgroundColor")||(i.backgroundColor=[0,0,0,0]),Ae(i,"disableStyle")||(i.disableStyle=["cornerRadius","backgroundColor","strokeColor","strokeWidth"])),e?Gn(i,e):i},ts=t=>rt(t.x1,t.y1),es=t=>rt(t.x2,t.y2),Xn=t=>Ae(t,"text"),$u=t=>Xn(t)&&!(Mu(t)||Ae(t,"width")),nu=t=>Xn(t)&&(Mu(t)||Ae(t,"width")),wo=t=>!Xn(t)&&Pb(t),Yn=t=>Ae(t,"rx"),tr=t=>Ae(t,"x1"),_n=t=>Ae(t,"points"),Qa=t=>Xn(t)&&t.isEditing,Wd=t=>!Ae(t,"opacity")||t.opacity>0,bs=t=>t.isSelected,$p=t=>t.isEditing,bo=t=>t._isDraft,tl=t=>Ae(t,"width")&&Ae(t,"height"),Cy=t=>{const e=Ae(t,"right"),i=Ae(t,"bottom");return e||i},Mu=t=>(Ae(t,"x")||Ae(t,"left"))&&Ae(t,"right")||(Ae(t,"y")||Ae(t,"top"))&&Ae(t,"bottom"),Pb=t=>tl(t)||Mu(t),Zp=t=>(t._isDraft=!0,t),Dm=t=>(t._isDraft=!1,t),Xp=(t,e)=>t.disableStyle!==!0&&(!Ln(t.disableStyle)||!e||!t.disableStyle.includes(e)),ga=t=>t.disableSelect!==!0,Bm=t=>t.disableRemove!==!0,Rb=t=>!t.disableFlip&&!bo(t)&&!Cy(t)&&(e=>Ae(e,"backgroundImage")||Ae(e,"text"))(t),Cl=(t,e)=>!!Xn(t)&&t.disableInput!==!0&&(on(t.disableInput)?t.disableInput(e??t.text):e||!0),Ys=(t,e)=>t.disableTextLayout!==!0&&(!Ln(t.disableTextLayout)||!e||!t.disableTextLayout.includes(e)),gp=t=>Ty(t)&&t.points.length>3,Ty=t=>!!_n(t)&&t.disableAddPoints!==void 0&&t.disableAddPoints!==!0,Yp=t=>t.disableManipulate!==!0&&!bo(t)&&!Cy(t),wc=t=>Yp(t)&&t.disableMove!==!0,qp=t=>(delete t.left,delete t.right,delete t.top,delete t.bottom,t),Om=t=>(delete t.rotation,t),Wm=t=>(t.strokeWidth=t.strokeWidth||1,t.strokeColor=t.strokeColor||[0,0,0],t),_m=t=>(t.backgroundColor=t.backgroundColor?t.backgroundColor:t.strokeWidth||t.backgroundImage?void 0:[0,0,0],t),Vm=t=>{let e=t.text;e=e.replace(/&(#[0-9]+|[a-z]+);/gi,(i,n)=>`___${n}___`),e=e.replace(/&/,"&amp;"),t.text=e.replace(/___(#[0-9]+|[a-z]+)___/gi,(i,n)=>`&${n};`)},Ib=t=>{if(t.fontSize=t.fontSize||"4%",t.fontFamily=t.fontFamily||"sans-serif",t.fontWeight=t.fontWeight||"normal",t.fontStyle=t.fontStyle||"normal",t.fontVariant=t.fontVariant||"normal",t.lineHeight=t.lineHeight||"120%",t.color=t.color||[0,0,0],t.format=t.format==="html"?"html":"text",t.textShadow){const[e,i,n,r]=t.textShadow;t.textShadowX=e,t.textShadowY=i,t.textShadowBlur=n,t.textShadowColor=r,delete t.textShadow}if(t.textOutline){const[e,i]=t.textOutline;t.textOutlineWidth=e,t.textOutlineColor=i,delete t.textOutline}return t.format==="html"?Vm(t):(e=>{Vm(e);let i=e.text;i=i.replace(/</g,"&gt;"),i=i.replace(/>/g,"&lt;"),e.text=i})(t),$u(t)?Eb(t):Ab(t)},Eb=t=>(t.disableNewline!==!1&&(delete t.textAlign,t.text=t.text.replace(/\n/g," ")),qp(t)),Ab=t=>(t.textAlign=t.textAlign||"left",t),My=t=>((e=>{We(e.id)||(e.id=na()),Ae(e,"rotation")||(e.rotation=0),Ae(e,"opacity")||(e.opacity=1),Ae(e,"disableErase")||(e.disableErase=!0)})(t),Xn(t)?Ib(t):wo(t)?(e=>{e.cornerRadius=e.cornerRadius||0,e.strokeWidth=e.strokeWidth||0,e.strokeColor=e.strokeColor||[0,0,0],_m(e)})(t):_n(t)?(e=>{Wm(e),Om(e),Ae(e,"pathClose")||(e.disableResize=!0,Ae(e,"disableMove")||(e.disableMove=!0)),qp(e)})(t):tr(t)?(e=>{Wm(e),e.lineStart=e.lineStart||void 0,e.lineEnd=e.lineEnd||void 0,Om(e),qp(e)})(t):Yn(t)&&(e=>{e.strokeWidth=e.strokeWidth||0,e.strokeColor=e.strokeColor||[0,0,0],_m(e)})(t),t),Lb=t=>Xn(t)?"text":wo(t)?"rectangle":_n(t)?"path":tr(t)?"line":Yn(t)?"ellipse":void 0,gu=(t,e)=>parseFloat(t)/100*e,zb=new RegExp(/^x|left|right|^width|rx|fontSize|eraseRadius|feather|cornerRadius|strokeWidth|strokeDash/,"i"),Fb=new RegExp(/^y|top|bottom|^height|ry/,"i"),Eh=(t,e,{width:i,height:n})=>{if(Array.isArray(e))return e.map(o=>(al(o)&&Py(o,{width:i,height:n}),We(o)&&(o=Eh(t,o,{width:i,height:n})),o));if(typeof e!="string"||!e.endsWith("%"))return e;const r=parseFloat(e)/100;return zb.test(t)?ai(i*r,6):Fb.test(t)?ai(n*r,6):e},Db=Eh,Bb=["lineHeight","textOutlineWidth","textShadowX","textShadowY","textShadowBlur"],Py=(t,e)=>{Object.entries(t).map(([i,n])=>{t[i]=Eh(i,n,e)}),t.text&&Bb.filter(i=>We(t[i])).forEach(i=>{var n,r;t[i]=(n=t[i],r=t.fontSize,Math.round(r*(parseFloat(n)/100)))})},Gn=(t,e)=>(Py(t,e),Ey(t,e),t),Kp=(t,e)=>{let i;return/^x|width|rx|fontSize|strokeWidth|cornerRadius/.test(t)?i=e.width:/^y|height|ry/.test(t)&&(i=e.height),i},Jp=(t,e,i)=>Array.isArray(t[e])?t[e].map(n=>Object.entries(n).reduce((r,[o,a])=>(r[o]=We(a)?gu(a,Kp(o,i)):a,r),{})):We(t[e])?gu(t[e],Kp(e,i)):t[e],Ll=(t,e,i)=>e.reduce((n,r)=>{const o=Jp(t,r,i);return n[r]=o,n},{}),xa=(t,e,i)=>(Object.keys(e).forEach(n=>((r,o,a,s)=>{if(!We(r[o]))return r[o]=a,r;const l=Kp(o,s);return r[o]=l===void 0?a:Dr(a,l),r})(t,n,e[n],i)),t),Ry=(t,e)=>{const i=t.filter(n=>n.x<0||n.y<0||n.x1<0||n.y1<0).reduce((n,r)=>{const[o,a,s,l]=(c=>{const d=ks(),u=c.strokeWidth||0;if(wo(c))d.x=c.x-.5*u,d.y=c.y-.5*u,d.width=c.width+u,d.height=c.height+u;else if(tr(c)){const{x1:p,y1:h,x2:g,y2:m}=c,f=Math.abs(Math.min(p,g)),x=Math.abs(Math.max(p,g)),k=Math.abs(Math.min(h,m)),w=Math.abs(Math.min(h,m));d.x=f+.5*u,d.y=x+.5*u,d.width=x-f+u,d.height=w-k+u}else Yn(c)&&(d.x=c.x-c.rx+.5*u,d.y=c.y-c.ry+.5*u,d.width=2*c.rx+u,d.height=2*c.ry+u);return d&&Ae(c,"rotation")&&$r(d,c.rotation),ol(d)})(r);return n.top=Math.min(o,n.top),n.left=Math.min(l,n.left),n.bottom=Math.max(s,n.bottom),n.right=Math.max(a,n.right),n},{top:0,right:0,bottom:0,left:0});return i.right>0&&(i.right-=e.width),i.bottom>0&&(i.bottom-=e.height),i},Iy=(t,e,i)=>{const n=Hn(t);Gn(n,e);const r=i(n);return Array.isArray(r)?r:[r]},Ey=(t,e)=>{if(Ae(t,"left")&&(t.x=t.left),Ae(t,"right")&&!We(t.right)){const i=e.width-t.right;Ae(t,"left")?(t.x=t.left,t.width=Math.max(0,i-t.left)):Ae(t,"width")&&(t.x=i-t.width)}if(Ae(t,"top")&&(t.y=t.top),Ae(t,"bottom")&&!We(t.bottom)){const i=e.height-t.bottom;Ae(t,"top")?(t.y=t.top,t.height=Math.max(0,i-t.top)):Ae(t,"height")&&(t.y=i-t.height)}return t},Ay=(t,e)=>(_n(t)&&t.points.filter(i=>di(i.x)).forEach(i=>{i.x*=e,i.y*=e}),tr(t)&&di(t.x1)&&(t.x1*=e,t.y1*=e,t.x2*=e,t.y2*=e),di(t.x)&&di(t.y)&&(t.x*=e,t.y*=e),di(t.width)&&di(t.height)&&(t.width*=e,t.height*=e),di(t.rx)&&di(t.ry)&&(t.rx*=e,t.ry*=e),(i=>di(i.strokeWidth)&&i.strokeWidth>0)(t)&&(t.strokeWidth*=e),Xn(t)&&(t._scale=e,di(t.fontSize)&&(t.fontSize*=e),di(t.lineHeight)&&(t.lineHeight*=e),di(t.width)&&!di(t.height)&&(t.width*=e)),Ae(t,"cornerRadius")&&di(t.cornerRadius)&&(t.cornerRadius*=e),t),Ly=t=>{if(wo(t))return rt(t.x+.5*t.width,t.y+.5*t.height);if(Yn(t))return rt(t.x,t.y);if(t.text){if(nu(t)){const i=t.height||Ko(t.text,t).height;return rt(t.x+.5*t.width,t.y+.5*i)}const e=Ko(t.text,t);return rt(t.x+.5*e.width,t.y+.5*e.height)}return _n(t)?Bo(t.points):tr(t)?Bo([ts(t),es(t)]):void 0};var Uc=t=>/canvas/i.test(t.nodeName),Ob=(t,e)=>new Promise((i,n)=>{let r=t,o=!1;const a=()=>{o||(o=!0,on(e)&&Promise.resolve().then(()=>e(jn(r.naturalWidth,r.naturalHeight))))};if(r.src||(r=new Image,We(t)&&new URL(t,location.href).origin!==location.origin&&(r.crossOrigin="anonymous"),r.src=We(t)?t:URL.createObjectURL(t)),r.complete)return a(),i(r);on(e)&&uy(r).then(a).catch(n),r.onload=()=>{a(),i(r)},r.onerror=()=>n(new Error("Failed to load image"))});const Nm=new Map([]),Ah=(t,e={})=>new Promise((i,n)=>{const{onMetadata:r=ge,onLoad:o=i,onError:a=n,onComplete:s=ge}=e;let l=Nm.get(t);if(l||(l={loading:!1,complete:!1,error:!1,image:void 0,size:void 0,bus:rs()},Nm.set(t,l)),l.bus.sub("meta",r),l.bus.sub("load",o),l.bus.sub("error",a),l.bus.sub("complete",s),Uc(t)){const c=t,d=c.cloneNode();l.complete=!0,l.image=d,l.size=Pc(c)}if(l.complete)return l.bus.pub("meta",{size:l.size}),l.error?l.bus.pub("error",l.error):l.bus.pub("load",l.image),l.bus.pub("complete"),void(l.bus=rs());l.loading||(l.loading=!0,Ob(t,c=>{l.size=c,l.bus.pub("meta",{size:c})}).then(c=>{l.image=c,l.bus.pub("load",c)}).catch(c=>{l.error=c,l.bus.pub("error",c)}).finally(()=>{l.complete=!0,l.loading=!1,l.bus.pub("complete"),l.bus=rs()}))}),Wb=(t,e,i,n)=>t.drawImage(e,i.x,i.x,i.width,i.height,n.x,n.y,n.width,n.height);var zy=async(t,e,i,n,r=Wb,o)=>{t.save(),t.clip(),await r(t,e,i,n,o),t.restore()};const fu=(t,e,i,n,r)=>{const o=ki(t);if(n){const s=Oo(er(n),ai);return s.x*=i.width,s.width*=i.width,s.y*=i.height,s.height*=i.height,{srcRect:s,destRect:o}}const a=An(0,0,i.width,i.height);if(e==="contain"){const s=qr(t,ir(a));o.width=s.width,o.height=s.height,r?(o.x+=r.x,o.y+=r.y):(o.x+=s.x,o.y+=s.y)}else if(e==="cover"){const s=os(o,a.width/a.height);o.width=s.width,o.height=s.height,r?(o.x+=r.x,o.y+=r.y):(o.x+=s.x,o.y+=s.y)}else e?(o.width=e.width,o.height=e.height,r&&(o.x+=r.x,o.y+=r.y)):r&&(o.width=i.width,o.height=i.height,o.x+=r.x,o.y+=r.y);return{srcRect:a,destRect:o}},fp=(t,e)=>(e.cornerRadius>0?((i,n,r,o,a,s)=>{o<2*s&&(s=o/2),a<2*s&&(s=a/2),i.beginPath(),i.moveTo(n+s,r),i.arcTo(n+o,r,n+o,r+a,s),i.arcTo(n+o,r+a,n,r+a,s),i.arcTo(n,r+a,n,r,s),i.arcTo(n,r,n+o,r,s),i.closePath()})(t,e.x,e.y,e.width,e.height,e.cornerRadius):t.rect(e.x,e.y,e.width,e.height),t),Hm=(t,e)=>(e.backgroundColor&&t.fill(),t),jm=(t,e)=>(e.strokeWidth&&t.stroke(),t);var Lh=async(t,e,i={})=>{const{drawImage:n}=i;if(t.lineWidth=e.strokeWidth?e.strokeWidth:1,t.strokeStyle=e.strokeColor?gr(e.strokeColor):"none",t.fillStyle=e.backgroundColor?gr(e.backgroundColor):"none",t.globalAlpha=e.opacity,e.backgroundImage){let r;if(r=Uc(e.backgroundImage)?e.backgroundImage:await Ah(e.backgroundImage),fp(t,e),Hm(t,e),e.backgroundRepeat==="repeat"){const o=e.backgroundPosition||{x:0,y:0},{srcRect:a,destRect:s}=fu(e,e.backgroundSize||Pc(r),Pc(r),e.backgroundCorners,{x:0,y:0}),l=document.createElement("canvas");l.width=s.width,l.height=s.height;const c=l.getContext("2d",{willReadFrequently:!1,desynchronized:!0});await n(c,r,a,{...s,x:0,y:0});const d=t.createPattern(l,"repeat");t.fillStyle=d,t.save(),t.beginPath(),t.rect(e.x+o.x,e.y+o.y,e.width-o.x,e.height-o.y),t.clip(),t.translate(s.x+o.x,s.y+o.y),t.fill(),qn(l),t.restore()}else{const{srcRect:o,destRect:a}=fu(e,e.backgroundSize,Pc(r),e.backgroundCorners,e.backgroundPosition);await zy(t,r,o,a,n,{feather:e.feather})}return t.beginPath(),fp(t,e),jm(t,e),[]}return fp(t,e),Hm(t,e),jm(t,e),[]},zh=async(t,e,i={})=>new Promise(async(n,r)=>{const{drawImage:o}=i;if(t.lineWidth=e.strokeWidth||1,t.strokeStyle=e.strokeColor?gr(e.strokeColor):"none",t.fillStyle=e.backgroundColor?gr(e.backgroundColor):"none",t.globalAlpha=e.opacity,t.ellipse(e.x,e.y,e.rx,e.ry,0,0,2*Math.PI),e.backgroundColor&&t.fill(),e.backgroundImage){let a;try{a=await Ah(e.backgroundImage)}catch(d){r(d)}const s=An(e.x-e.rx,e.y-e.ry,2*e.rx,2*e.ry),{srcRect:l,destRect:c}=fu(s,e.backgroundSize,Pc(a),e.backgroundCorners,e.backgroundPosition);await zy(t,a,l,c,o),e.strokeWidth&&t.stroke(),n([])}else e.strokeWidth&&t.stroke(),n([])}),_b=async(t,e,i)=>{const n=e.width&&e.height?Da(e):Ko(e.text,e),r={x:e.x,y:e.y,width:n.width,height:n.height};if(Lh(t,{...e,...r,options:i}),!e.text.length)return[];const{textOutlineWidth:o=0,textShadowX:a=0,textShadowY:s=0,textShadowBlur:l=0,textShadowColor:c,outline:d,blur:u,...p}=e;return e.height&&(t.rect(r.x-o+Math.min(a,0),r.y-o+Math.min(s,0),r.width+o+o+Math.abs(a)+l,r.height+o+Math.abs(s)+l),t.save(),t.clip()),(a||s||l)&&(t.save(),t.translate(a,s),await yp(t,r,e,{...i,paddingLeft:Yr+l,paddingRight:Yr+l,paddingTop:l,paddingBottom:l,shapeExtendedProps:{color:c,blur:l}}),t.restore()),o&&await yp(t,r,e,{...i,paddingLeft:Yr+o,paddingRight:Yr+o,paddingTop:o,paddingBottom:o,shapeExtendedProps:{color:e.textOutlineColor,outline:o}}),e.height&&t.restore(),await yp(t,r,p,{...i,paddingLeft:Yr,paddingRight:Yr,paddingTop:0,paddingBottom:0}),[]};const yp=async(t,e,i,n)=>{const{willRequest:r,shapeExtendedProps:o,paddingLeft:a,paddingRight:s,paddingTop:l,paddingBottom:c}=n,d=await ky(i.text,{...i,...o,...e,paddingLeft:a,paddingRight:s,paddingTop:l,paddingBottom:c,imageWidth:e.width,imageHeight:e.height,willRequest:r});t.drawImage(d,i.x-a,i.y-l,d.width,d.height)};var Vb=async(t,e)=>new Promise(async i=>{t.lineWidth=e.strokeWidth||1,t.strokeStyle=e.strokeColor?gr(e.strokeColor):"none",t.globalAlpha=e.opacity;let n=ts(e),r=es(e);t.moveTo(n.x,n.y),t.lineTo(r.x,r.y),e.strokeWidth&&t.stroke(),i([])}),Qp=async(t,e)=>new Promise((i,n)=>{if(e.bitmap&&e.points.length===1)return void zh(t,{x:e.points[0].x,y:e.points[0].y,rx:.5*e.strokeWidth,ry:.5*e.strokeWidth,backgroundColor:e.strokeColor}).then(()=>i([]));t.lineWidth=e.strokeWidth||1,t.strokeStyle=e.strokeColor?gr(e.strokeColor):"none",t.fillStyle=e.backgroundColor?gr(e.backgroundColor):"none",t.globalAlpha=e.opacity;const{points:r}=e;t.lineCap=e.strokeCap,t.lineJoin=e.strokeJoin,t.setLineDash(e.strokeDash||[]),e.pathClose&&t.beginPath(),t.moveTo(r[0].x,r[0].y);const o=r.length;for(let a=1;a<o;a++)t.lineTo(r[a].x,r[a].y);e.pathClose&&t.closePath(),e.strokeWidth&&t.stroke(),e.backgroundColor&&t.fill(),i([])}),Fy=(t,e,i,n)=>((e||i)&&(t.translate(n.x,n.y),t.scale(e?-1:1,i?-1:1),t.translate(-n.x,-n.y)),t);const Nb=async(t,e,i)=>{t.globalCompositeOperation=e.drawMode==="subtract"?"destination-out":"source-over";const n=Ly(e);let r;if(Mh(t,e.rotation,n),Fy(t,e.flipX,e.flipY,n),wo(e)?r=Lh:Yn(e)?r=zh:tr(e)?r=Vb:_n(e)?r=Qp:Xn(e)&&(r=_b),r){const o=await r(t,e,i);return o.length?[e,...await Dy(t,o,i)]:[]}return[]};var Dy=async(t,e,i)=>{let n=[];for(const r of e)t.save(),t.beginPath(),n=[...n,...await Nb(t,r,i)],t.restore();return n},Fh=async(t,e={})=>{const{shapes:i=[],contextBounds:n=t,transform:r=ge,drawImage:o,willRequest:a,canvasMemoryLimit:s,computeShape:l=Yi,preprocessShape:c=Yi}=e;if(!i.length)return t;const d=vn("canvas");d.width=n.width,d.height=n.height;const u=d.getContext("2d",{willReadFrequently:!0});u.putImageData(t,n.x||0,n.y||0);const p=i.map(Hn).map(l).map(c).flat();r(u),await Dy(u,p,{drawImage:o,canvasMemoryLimit:s,willRequest:a});const h=u.getImageData(0,0,d.width,d.height);return qn(d),h},Hb=async(t,e={})=>{const{backgroundColor:i,backgroundImage:n}=e,r=!(!i||i&&i[3]===0);if(!n&&!r)return t;const o=vn("canvas");o.width=t.width,o.height=t.height;const a=o.getContext("2d",{willReadFrequently:!0});if(a.putImageData(t,0,0),a.globalCompositeOperation="destination-over",r&&(a.fillStyle=gr(i),a.fillRect(0,0,o.width,o.height)),n){let l;l=Uc(n)?n:await Ah(n);const{srcRect:c,destRect:d}=fu({x:0,y:0,width:t.width,height:t.height},"cover",{width:l.width,height:l.height});a.drawImage(l,c.x,c.y,c.width,c.height,d.x,d.y,d.width,d.height)}const s=a.getImageData(0,0,o.width,o.height);return qn(o),s},Dh=t=>t.length?t.reduce((e,i)=>((n,r)=>{const o=new Array(20);return o[0]=n[0]*r[0]+n[1]*r[5]+n[2]*r[10]+n[3]*r[15],o[1]=n[0]*r[1]+n[1]*r[6]+n[2]*r[11]+n[3]*r[16],o[2]=n[0]*r[2]+n[1]*r[7]+n[2]*r[12]+n[3]*r[17],o[3]=n[0]*r[3]+n[1]*r[8]+n[2]*r[13]+n[3]*r[18],o[4]=n[0]*r[4]+n[1]*r[9]+n[2]*r[14]+n[3]*r[19]+n[4],o[5]=n[5]*r[0]+n[6]*r[5]+n[7]*r[10]+n[8]*r[15],o[6]=n[5]*r[1]+n[6]*r[6]+n[7]*r[11]+n[8]*r[16],o[7]=n[5]*r[2]+n[6]*r[7]+n[7]*r[12]+n[8]*r[17],o[8]=n[5]*r[3]+n[6]*r[8]+n[7]*r[13]+n[8]*r[18],o[9]=n[5]*r[4]+n[6]*r[9]+n[7]*r[14]+n[8]*r[19]+n[9],o[10]=n[10]*r[0]+n[11]*r[5]+n[12]*r[10]+n[13]*r[15],o[11]=n[10]*r[1]+n[11]*r[6]+n[12]*r[11]+n[13]*r[16],o[12]=n[10]*r[2]+n[11]*r[7]+n[12]*r[12]+n[13]*r[17],o[13]=n[10]*r[3]+n[11]*r[8]+n[12]*r[13]+n[13]*r[18],o[14]=n[10]*r[4]+n[11]*r[9]+n[12]*r[14]+n[13]*r[19]+n[14],o[15]=n[15]*r[0]+n[16]*r[5]+n[17]*r[10]+n[18]*r[15],o[16]=n[15]*r[1]+n[16]*r[6]+n[17]*r[11]+n[18]*r[16],o[17]=n[15]*r[2]+n[16]*r[7]+n[17]*r[12]+n[18]*r[17],o[18]=n[15]*r[3]+n[16]*r[8]+n[17]*r[13]+n[18]*r[18],o[19]=n[15]*r[4]+n[16]*r[9]+n[17]*r[14]+n[18]*r[19]+n[19],o})([...e],i),t.shift()):[],By=(t,e)=>{const i=t.width*t.height,n=e.reduce((o,a)=>(a.width>o.width&&a.height>o.height&&(o.width=a.width,o.height=a.height),o),{width:0,height:0}),r=n.width*n.height;return((o,a=2)=>Math.round(o*a)/a)(Math.max(.5,.5+(1-r/i)/2),5)};function Ke(){}const Bh=t=>t;function In(t,e){for(const i in e)t[i]=e[i];return t}function Oy(t){return t()}function Um(){return Object.create(null)}function Bi(t){t.forEach(Oy)}function ji(t){return typeof t=="function"}function ni(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function Br(t,...e){if(t==null)return Ke;const i=t.subscribe(...e);return i.unsubscribe?()=>i.unsubscribe():i}function ba(t){let e;return Br(t,i=>e=i)(),e}function A(t,e,i){t.$$.on_destroy.push(Br(e,i))}function rr(t,e,i,n){if(t){const r=Wy(t,e,i,n);return t[0](r)}}function Wy(t,e,i,n){return t[1]&&n?In(i.ctx.slice(),t[1](n(e))):i.ctx}function or(t,e,i,n){if(t[2]&&n){const r=t[2](n(i));if(e.dirty===void 0)return r;if(typeof r=="object"){const o=[],a=Math.max(e.dirty.length,r.length);for(let s=0;s<a;s+=1)o[s]=e.dirty[s]|r[s];return o}return e.dirty|r}return e.dirty}function ar(t,e,i,n,r,o){if(r){const a=Wy(e,i,n,o);t.p(a,r)}}function sr(t){if(t.ctx.length>32){const e=[],i=t.ctx.length/32;for(let n=0;n<i;n++)e[n]=-1;return e}return-1}function Dc(t){const e={};for(const i in t)i[0]!=="$"&&(e[i]=t[i]);return e}function Gm(t,e){const i={};e=new Set(e);for(const n in t)e.has(n)||n[0]==="$"||(i[n]=t[n]);return i}function vt(t,e,i){return t.set(i),e}function Ui(t){return t&&ji(t.destroy)?t.destroy:Ke}const _y=typeof window<"u";let Vy=_y?()=>window.performance.now():()=>Date.now(),Oh=_y?t=>requestAnimationFrame(t):Ke;const zl=new Set;function Ny(t){zl.forEach(e=>{e.c(t)||(zl.delete(e),e.f())}),zl.size!==0&&Oh(Ny)}function Wh(t){let e;return zl.size===0&&Oh(Ny),{promise:new Promise(i=>{zl.add(e={c:t,f:i})}),abort(){zl.delete(e)}}}function kt(t,e){t.appendChild(e)}function Hy(t){if(!t)return document;const e=t.getRootNode?t.getRootNode():t.ownerDocument;return e&&e.host?e:t.ownerDocument}function jb(t){const e=pt("style");return function(i,n){kt(i.head||i,n),n.sheet}(Hy(t),e),e.sheet}function et(t,e,i){t.insertBefore(e,i||null)}function tt(t){t.parentNode.removeChild(t)}function pt(t){return document.createElement(t)}function fr(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function gn(t){return document.createTextNode(t)}function he(){return gn(" ")}function Tn(){return gn("")}function Ct(t,e,i,n){return t.addEventListener(e,i,n),()=>t.removeEventListener(e,i,n)}function Ub(t){return function(e){return e.preventDefault(),t.call(this,e)}}function Gb(t){return function(e){return e.stopPropagation(),t.call(this,e)}}function v(t,e,i){i==null?t.removeAttribute(e):t.getAttribute(e)!==i&&t.setAttribute(e,i)}function Zm(t,e){const i=Object.getOwnPropertyDescriptors(t.__proto__);for(const n in e)e[n]==null?t.removeAttribute(n):n==="style"?t.style.cssText=e[n]:n==="__value"?t.value=t[n]=e[n]:i[n]&&i[n].set?t[n]=e[n]:v(t,n,e[n])}function Xm(t,e){Object.keys(e).forEach(i=>{(function(n,r,o){r in n?n[r]=typeof n[r]=="boolean"&&o===""||o:v(n,r,o)})(t,i,e[i])})}function zn(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function Ym(t,e){t.value=e??""}function jy(t,e,{bubbles:i=!1,cancelable:n=!1}={}){const r=document.createEvent("CustomEvent");return r.initCustomEvent(t,i,n,e),r}class Pu{constructor(e=!1){this.is_svg=!1,this.is_svg=e,this.e=this.n=null}c(e){this.h(e)}m(e,i,n=null){this.e||(this.is_svg?this.e=fr(i.nodeName):this.e=pt(i.nodeName),this.t=i,this.c(e)),this.i(n)}h(e){this.e.innerHTML=e,this.n=Array.from(this.e.childNodes)}i(e){for(let i=0;i<this.n.length;i+=1)et(this.t,this.n[i],e)}p(e){this.d(),this.h(e),this.i(this.a)}d(){this.n.forEach(tt)}}function yu(t,e){return new t(e)}const xu=new Map;let Bc,ru=0;function qm(t,e,i,n,r,o,a,s=0){const l=16.666/n;let c=`{
`;for(let f=0;f<=1;f+=l){const x=e+(i-e)*o(f);c+=100*f+`%{${a(x,1-x)}}
`}const d=c+`100% {${a(i,1-i)}}
}`,u=`__svelte_${function(f){let x=5381,k=f.length;for(;k--;)x=(x<<5)-x^f.charCodeAt(k);return x>>>0}(d)}_${s}`,p=Hy(t),{stylesheet:h,rules:g}=xu.get(p)||function(f,x){const k={stylesheet:jb(x),rules:{}};return xu.set(f,k),k}(p,t);g[u]||(g[u]=!0,h.insertRule(`@keyframes ${u} ${d}`,h.cssRules.length));const m=t.style.animation||"";return t.style.animation=`${m?m+", ":""}${u} ${n}ms linear ${r}ms 1 both`,ru+=1,u}function Zb(t,e){const i=(t.style.animation||"").split(", "),n=i.filter(e?o=>o.indexOf(e)<0:o=>o.indexOf("__svelte")===-1),r=i.length-n.length;r&&(t.style.animation=n.join(", "),ru-=r,ru||Oh(()=>{ru||(xu.forEach(o=>{const{ownerNode:a}=o.stylesheet;a&&tt(a)}),xu.clear())}))}function Ic(t){Bc=t}function sl(){if(!Bc)throw new Error("Function called outside component initialization");return Bc}function Ls(t){sl().$$.on_mount.push(t)}function Xb(t){sl().$$.after_update.push(t)}function Vo(t){sl().$$.on_destroy.push(t)}function ka(){const t=sl();return(e,i,{cancelable:n=!1}={})=>{const r=t.$$.callbacks[e];if(r){const o=jy(e,i,{cancelable:n});return r.slice().forEach(a=>{a.call(t,o)}),!o.defaultPrevented}return!0}}function ho(t,e){return sl().$$.context.set(t,e),e}function dn(t){return sl().$$.context.get(t)}function Wr(t,e){const i=t.$$.callbacks[e.type];i&&i.slice().forEach(n=>n.call(this,e))}const Sc=[],Ai=[],ou=[],th=[],Uy=Promise.resolve();let eh=!1;function Gy(){eh||(eh=!0,Uy.then(E))}function Zy(){return Gy(),Uy}function Wl(t){ou.push(t)}function ko(t){th.push(t)}const xp=new Set;let mc,_d=0;function E(){const t=Bc;do{for(;_d<Sc.length;){const e=Sc[_d];_d++,Ic(e),Yb(e.$$)}for(Ic(null),Sc.length=0,_d=0;Ai.length;)Ai.pop()();for(let e=0;e<ou.length;e+=1){const i=ou[e];xp.has(i)||(xp.add(i),i())}ou.length=0}while(Sc.length);for(;th.length;)th.pop()();eh=!1,xp.clear(),Ic(t)}function Yb(t){if(t.fragment!==null){t.update(),Bi(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(Wl)}}function bp(t,e,i){t.dispatchEvent(jy(`${e?"intro":"outro"}${i}`))}const au=new Set;let is;function Pe(){is={r:0,c:[],p:is}}function Re(){is.r||Bi(is.c),is=is.p}function M(t,e){t&&t.i&&(au.delete(t),t.i(e))}function z(t,e,i,n){if(t&&t.o){if(au.has(t))return;au.add(t),is.c.push(()=>{au.delete(t),n&&(i&&t.d(1),n())}),t.o(e)}else n&&n()}const qb={duration:0};function Km(t,e,i,n){let r=e(t,i),o=n?0:1,a=null,s=null,l=null;function c(){l&&Zb(t,l)}function d(p,h){const g=p.b-o;return h*=Math.abs(g),{a:o,b:p.b,d:g,duration:h,start:p.start,end:p.start+h,group:p.group}}function u(p){const{delay:h=0,duration:g=300,easing:m=Bh,tick:f=Ke,css:x}=r||qb,k={start:Vy()+h,b:p};p||(k.group=is,is.r+=1),a||s?s=k:(x&&(c(),l=qm(t,o,p,g,h,m,x)),p&&f(0,1),a=d(k,g),Wl(()=>bp(t,p,"start")),Wh(w=>{if(s&&w>s.start&&(a=d(s,g),s=null,bp(t,a.b,"start"),x&&(c(),l=qm(t,o,a.b,a.duration,0,m,r.css))),a){if(w>=a.end)f(o=a.b,1-o),bp(t,a.b,"end"),s||(a.b?c():--a.group.r||Bi(a.group.c)),a=null;else if(w>=a.start){const C=w-a.start;o=a.a+a.d*m(C/a.duration),f(o,1-o)}}return!(!a&&!s)}))}return{run(p){ji(r)?(mc||(mc=Promise.resolve(),mc.then(()=>{mc=null})),mc).then(()=>{r=r(),u(p)}):u(p)},end(){c(),a=s=null}}}const Xy=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function Yy(t,e){t.d(1),e.delete(t.key)}function zs(t,e){z(t,1,1,()=>{e.delete(t.key)})}function Ba(t,e,i,n,r,o,a,s,l,c,d,u){let p=t.length,h=o.length,g=p;const m={};for(;g--;)m[t[g].key]=g;const f=[],x=new Map,k=new Map;for(g=h;g--;){const R=u(r,o,g),W=i(R);let T=a.get(W);T?n&&T.p(R,e):(T=c(W,R),T.c()),x.set(W,f[g]=T),W in m&&k.set(W,Math.abs(g-m[W]))}const w=new Set,C=new Set;function P(R){M(R,1),R.m(s,d),a.set(R.key,R),d=R.first,h--}for(;p&&h;){const R=f[h-1],W=t[p-1],T=R.key,F=W.key;R===W?(d=R.first,p--,h--):x.has(F)?!a.has(T)||w.has(T)?P(R):C.has(F)?p--:k.get(T)>k.get(F)?(C.add(T),P(R)):(w.add(F),p--):(l(W,a),p--)}for(;p--;){const R=t[p];x.has(R.key)||l(R,a)}for(;h;)P(f[h-1]);return f}function yr(t,e){const i={},n={},r={$$scope:1};let o=t.length;for(;o--;){const a=t[o],s=e[o];if(s){for(const l in a)l in s||(n[l]=1);for(const l in s)r[l]||(i[l]=s[l],r[l]=1);t[o]=s}else for(const l in a)r[l]=1}for(const a in n)a in i||(i[a]=void 0);return i}function Pr(t){return typeof t=="object"&&t!==null?t:{}}function $o(t,e,i){const n=t.$$.props[e];n!==void 0&&(t.$$.bound[n]=i,i(t.$$.ctx[n]))}function Et(t){t&&t.c()}function Rt(t,e,i,n){const{fragment:r,after_update:o}=t.$$;r&&r.m(e,i),n||Wl(()=>{const a=t.$$.on_mount.map(Oy).filter(ji);t.$$.on_destroy?t.$$.on_destroy.push(...a):Bi(a),t.$$.on_mount=[]}),o.forEach(Wl)}function It(t,e){const i=t.$$;i.fragment!==null&&(Bi(i.on_destroy),i.fragment&&i.fragment.d(e),i.on_destroy=i.fragment=null,i.ctx=[])}function si(t,e,i,n,r,o,a,s=[-1]){const l=Bc;Ic(t);const c=t.$$={fragment:null,ctx:[],props:o,update:Ke,not_equal:r,bound:Um(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(l?l.$$.context:[])),callbacks:Um(),dirty:s,skip_bound:!1,root:e.target||l.$$.root};a&&a(c.root);let d=!1;if(c.ctx=i?i(t,e.props||{},(u,p,...h)=>{const g=h.length?h[0]:p;return c.ctx&&r(c.ctx[u],c.ctx[u]=g)&&(!c.skip_bound&&c.bound[u]&&c.bound[u](g),d&&function(m,f){m.$$.dirty[0]===-1&&(Sc.push(m),Gy(),m.$$.dirty.fill(0)),m.$$.dirty[f/31|0]|=1<<f%31}(t,u)),p}):[],c.update(),d=!0,Bi(c.before_update),c.fragment=!!n&&n(c.ctx),e.target){if(e.hydrate){const u=function(p){return Array.from(p.childNodes)}(e.target);c.fragment&&c.fragment.l(u),u.forEach(tt)}else c.fragment&&c.fragment.c();e.intro&&M(t.$$.fragment),Rt(t,e.target,e.anchor,e.customElement),E()}Ic(l)}class li{$destroy(){It(this,1),this.$destroy=Ke}$on(e,i){if(!ji(i))return Ke;const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(i),()=>{const r=n.indexOf(i);r!==-1&&n.splice(r,1)}}$set(e){var i;this.$$set&&(i=e,Object.keys(i).length!==0)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const Tl=[];function Rl(t,e){return{subscribe:pe(t,e).subscribe}}function pe(t,e=Ke){let i;const n=new Set;function r(o){if(ni(t,o)&&(t=o,i)){const a=!Tl.length;for(const s of n)s[1](),Tl.push(s,t);if(a){for(let s=0;s<Tl.length;s+=2)Tl[s][0](Tl[s+1]);Tl.length=0}}}return{set:r,update:function(o){r(o(t))},subscribe:function(o,a=Ke){const s=[o,a];return n.add(s),n.size===1&&(i=e(r)||Ke),o(t),()=>{n.delete(s),n.size===0&&(i(),i=null)}}}}function Ii(t,e,i){const n=!Array.isArray(t),r=n?[t]:t,o=e.length<2;return Rl(i,a=>{let s=!1;const l=[];let c=0,d=Ke;const u=()=>{if(c)return;d();const h=e(n?l[0]:l,a);o?a(h):d=ji(h)?h:Ke},p=r.map((h,g)=>Br(h,m=>{l[g]=m,c&=~(1<<g),s&&u()},()=>{c|=1<<g}));return s=!0,u(),function(){Bi(p),d()}})}var qy=t=>t.reduce((e,i)=>Object.assign(e,i),{});const Ml=t=>({updateValue:t}),Do=t=>({defaultValue:t}),Ky=t=>({store:t}),Vd=t=>({store:(e,i)=>Ii(...t(i))}),Nd=t=>({store:(e,i)=>{const[n,r,o=()=>!1]=t(i);let a,s=!0;return Ii(n,(l,c)=>{r(l,d=>{!s&&o(a,d)||(a=d,s=!1,c(d))})})}}),$c=t=>({store:(e,i)=>{const[n,r={},o]=t(i);let a=[];const s={},l=h=>n(h,s),c=h=>{(a.length||h.length)&&(a=h,d())},d=()=>{const h=a.map(l);o&&h.sort(o),a=[...h],p(h)};Object.entries(r).map(([h,g])=>g.subscribe(m=>{s[h]=m,m&&d()}));const{subscribe:u,set:p}=pe(e||[]);return{set:c,update:h=>c(h(a)),subscribe:u}}});var Jm=t=>{const e={},i={};return t.forEach(([n,...r])=>{const o=qy(r),a=e[n]=((l,c,d)=>{const{store:u=C=>pe(C),defaultValue:p=ge,updateValue:h}=d,g=u(p(),c,l),{subscribe:m,update:f=ge}=g;let x;const k=C=>{let P=!0;x&&x(),x=m(R=>{if(P)return P=!1;C(R),x(),x=void 0})},w=h?h(l):Yi;return g.set=C=>f(P=>w(C,P,k)),g.defaultValue=p,g})(i,e,o),s={get:()=>ba(a),set:a.set};Object.defineProperty(i,n,s)}),{stores:e,accessors:i}},Kb=[["src",Ky(()=>{let t;const{subscribe:e,set:i}=pe(),n=r=>{t!==r&&(t=r,i(t))};return{set:n,subscribe:e,update:r=>n(r(t))}})],["imageReader"],["imageWriter"],["imageScrambler"],["imageRedactionRendering",Do(()=>"pixelated")],["images",Do(()=>[])],["shapePreprocessor"],["willRequestResource"],["willRequest"]],Jy=t=>t.charAt(0).toUpperCase()+t.slice(1),bu=(t,e)=>{Object.keys(e).forEach(i=>{const n=on(e[i])?{value:e[i],writable:!1}:e[i];Object.defineProperty(t,i,n)})};const Qm=(t,e)=>{let i,n,r,o,a,s,l,c,d,u;const p=e.length;for(i=0;i<p;i++)if(n=e[i],r=e[i+1>p-1?0:i+1],o=n.x-t.x,a=n.y-t.y,s=r.x-t.x,l=r.y-t.y,c=o-s,d=a-l,u=c*a-d*o,u<-1e-5)return!1;return!0};var t$=(t,e)=>{const i=ly(e),n=rn();Wo(t).forEach(o=>{Dn(o,n),Qm(o,e)||i.forEach(a=>{const s=Math.atan2(a.start.y-a.end.y,a.start.x-a.end.x),l=1e4*Math.sin(Math.PI-s),c=1e4*Math.cos(Math.PI-s),d=rt(o.x+l,o.y+c),u=vh(ny(a),1e4),p=wh(As(o,d),u);p&&Dn(n,Bn(Oe(p),o))})});const r=ki(t);return Dn(r,n),!!Wo(r).every(o=>Qm(o,e))&&(ku(t,r),!0)},Qy=(t,e)=>{const i=Wo(t),n=cy(e,5),r=Ci(t),o=[];i.forEach(l=>{const c=((u,p)=>{if(p===0)return u;const h=rt(u.start.x-u.end.x,u.start.y-u.end.y),g=ro(h),m=Tr(g,p);return u.end.x+=m.x,u.end.y+=m.y,u})(As(Oe(r),Oe(l)),1e6);let d=!1;n.map(ny).forEach(u=>{const p=wh(c,u);p&&!d&&(o.push(p),d=!0)})});const a=mo(o[0],o[2])<mo(o[1],o[3])?[o[0],o[2]]:[o[1],o[3]],s=er(a);return s.width<t.width&&(ku(t,s),!0)},t2=(t,e,i={x:0,y:0})=>{const n=Or(t),r=Ci(n),o=oy(n,i,r).map(s=>Xr(s,e,r)),a=er(o);return o.map(s=>Bn(s,a))},Il=(t,e=0,i=ir(t))=>{let n,r;if(e!==0){const o=Math.atan2(1,i),a=Math.sign(e)*e,s=a%Math.PI,l=a%_o;let c;c=s>Qo&&s<_o+Qo?l>Qo?a:_o-l:l>Qo?_o-l:a;const d=Math.min(Math.abs(t.height/Math.sin(o+c)),Math.abs(t.width/Math.cos(o-c)));n=Math.cos(o)*d,r=n/i}else n=t.width,r=n/i,r>t.height&&(r=t.height,n=r*i);return jn(n,r)},Jb=(t,e,i,n,r,o,a,s)=>{const l=no(a),c=no(s),d=ai(Math.max(e.width/c.width,e.height/c.height)),u=ai(Math.min(e.width/l.width,e.height/l.height)),p=ki(e);if(u<1||d>1){const h=Ci(t),g=Ci(e),m=u<1?u:d,f=(g.x+h.x)/2,x=(g.y+h.y)/2,k=p.width/m,w=p.height/m;ry(p,f-.5*k,x-.5*w,k,w)}return o?(((h,g,m=0,f=rn(),x)=>{if(di(m)&&m!==0||f.x||f.y){const k=ir(h),w=t2(g,m,f),C=Il(g,m,k);if(!(h.width<C.width&&h.height<C.height)){const P=.5*h.width-.5*C.width,R=.5*h.height-.5*C.height;h.width>C.width&&(h.width=C.width,h.x+=P),h.height>C.height&&(h.height=C.height,h.y+=R)}t$(h,w),Qy(h,w)&&t$(h,w)}else{const k=ir(h);h.width=Math.min(h.width,g.width),h.height=Math.min(h.height,g.height),h.x=Math.max(h.x,0),h.x+h.width>g.width&&(h.x-=h.x+h.width-g.width),h.y=Math.max(h.y,0),h.y+h.height>g.height&&(h.y-=h.y+h.height-g.height);const w=Ci(h),C=qr(h,k);C.width=Math.max(x.width,C.width),C.height=Math.max(x.height,C.height),C.x=w.x-.5*C.width,C.y=w.y-.5*C.height,ku(h,C)}})(p,i,n,r,l),{crop:p}):{crop:p}},_h=(t,e,i)=>{const n=Or(t),r=Ci(n),o=$r(n,i,r),a=Ci(Fc(er(o))),s=Ci(e),l=Xr(s,-i,a),c=Bn(l,a),d=So(Dn(r,c),ai);return An(d.x-.5*e.width,d.y-.5*e.height,e.width,e.height)},Ji=(t,e,i)=>Math.max(e,Math.min(t,i));const vp=["cropLimitToImage","cropMinSize","cropMaxSize","cropAspectRatio","flipX","flipY","rotation","crop","colorMatrix","convolutionMatrix","gamma","vignette","manipulation","redaction","annotation","decoration","selection","frame","backgroundColor","backgroundImage","targetSize","metadata","trim","volume","minDuration","maxDuration","currentTime"],ih=t=>Ln(t)?t.map(ih):Th(t)||jc(t)?t:al(t)?{...t}:t,gc=t=>t.map(e=>Object.entries(e).reduce((i,[n,r])=>(n.startsWith("_")||(i[n]=r),i),{})),Qb=(t,e)=>t===e;var as=(t,e,i=Qb)=>{if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!i(t[n],e[n]))return!1;return!0};const e$=(t,e,i)=>{const n=So(Ci(t),d=>ai(d,8)),r=Or(e),o=Ci(r),a=$r(r,i,o),s=So(Dl(er(a)),d=>ai(d,8)),l=Math.abs(s.x-n.x),c=Math.abs(s.y-n.y);return l<1&&c<1},tv=(t,e,i,n,r)=>{if(!r)return[-1/0,1/0];const o=Math.max(i.width/n.width,i.height/n.height),a=jn(n.width*o,n.height*o),s=(l=a,Math.sqrt(l.width*l.width+l.height*l.height));var l;if(s<Math.min(t.width,t.height))return[-1/0,1/0];const c=e?t.height:t.width,d=e?t.width:t.height,u=Math.acos(a.height/s),p=u-Math.acos(d/s),h=Math.asin(c/s)-u;if(Number.isNaN(p)&&Number.isNaN(h))return[-1/0,1/0];const g=Number.isNaN(p)?h:Number.isNaN(h)?p:Math.min(p,h);return[-g,g]},kc=(t,e)=>{const{context:i,props:n}=e;return t._isFormatted||((t=My(t))._isFormatted=!0,Object.assign(t,n)),t._isDraft||!Mu(t)||t._context&&ea(i,t._context)||(Ey(t,i),t._context={...i}),t},ev=(t,e)=>(t._isFormatted||(t.disableMove=!0,t.disableSelect=!0,t.disableResize=!0,t.disableRotate=!0),kc(t,e));var Vh=[["file"],["size"],["loadState"],["processState"],["aspectRatio",Vd(({size:t})=>[t,e=>e?ir(e):void 0])],["perspectiveX",Do(()=>0)],["perspectiveY",Do(()=>0)],["perspective",Vd(({perspectiveX:t,perspectiveY:e})=>[[t,e],([i,n])=>({x:i,y:n})])],["rotation",Do(()=>0),Ml(t=>(e,i,n)=>{if(e===i)return e;const{loadState:r,size:o,rotationRange:a,cropMinSize:s,cropMaxSize:l,crop:c,perspective:d,cropLimitToImage:u,cropOrigin:p}=t;if(!c||!r||!r.beforeComplete)return e;const h=u&&((f,x,k)=>{const w=Il(x,k,ir(f));return zc(ns(w,Math.round),ns(no(f),Math.round))})(c,o,i),g=u&&e$(c,o,i),m=((f,x,k,w,C,P,R,W,T,F)=>{const D=no(T),B=no(F);R&&(B.width=Math.min(F.width,C.width),B.height=Math.min(F.height,C.height));let y=!1;const _=(j,Q)=>{const ht=_h(C,w,j),at=Or(C),U=Ci(at),yt=oy(at,P,U),$t=Bn(Oe(U),ym(yt)),Mt=Xr(Ci(ht),Q,U),dt=Bn(Oe(U),Mt);yt.forEach(mt=>Xr(mt,Q,U));const Tt=er(yt),K=ym(yt),q=Dn(Bn(Bn(K,dt),Tt),$t),Z=An(q.x-.5*ht.width,q.y-.5*ht.height,ht.width,ht.height);if(W&&Cr(Z,W.width/Z.width),R){const mt=t2(C,Q,P);Qy(Z,mt)}const xt=ai(Math.min(Z.width/D.width,Z.height/D.height),8),it=ai(Math.max(Z.width/B.width,Z.height/B.height),8);return(xt<1||it>1)&&ai(Math.abs(Q-j))===ai(Math.PI/2)&&!y?(y=!0,_(f,f+Math.sign(Q-j)*Math.PI)):{rotation:Q,crop:Oo(Z,mt=>ai(mt,8))}},J=Math.sign(x)*Math.round(Math.abs(x)/_o)*_o,S=Ji(x,J+k[0],J+k[1]);return _(f,S)})(i,e,a,c,o,d,u,p,s,l);if(h&&g){const f=Il(o,e,ir(m.crop));m.crop.x+=.5*m.crop.width,m.crop.y+=.5*m.crop.height,m.crop.x-=.5*f.width,m.crop.y-=.5*f.height,m.crop.width=f.width,m.crop.height=f.height}return n(()=>{t.crop=Oo(m.crop,f=>ai(f,8))}),m.rotation})],["flipX",Do(()=>!1)],["flipY",Do(()=>!1)],["flip",Vd(({flipX:t,flipY:e})=>[[t,e],([i,n])=>({x:i,y:n})])],["isRotatedSideways",Nd(({rotation:t})=>[[t],([e],i)=>i(za(e)),(e,i)=>e!==i])],["crop",Ml(t=>(e,i=e)=>{const{loadState:n,size:r,cropMinSize:o,cropMaxSize:a,cropLimitToImage:s,cropAspectRatio:l,rotation:c,perspective:d}=t;if(!e&&!i||!n||!n.beforeComplete)return e;e||(e=Or(Il(r,c,l||ir(r))));const u=Jb(i,e,r,c,d,s,o,a),p=Oo(u.crop,h=>ai(h,8));return ea(i,p)?i:p})],["cropAspectRatio",Ml(t=>(e,i)=>{const{loadState:n,crop:r,size:o,rotation:a,cropLimitToImage:s}=t,l=(d=>{if(d){if(/:/.test(d)){const[u,p]=d.split(":");return u/p}return parseFloat(d)}})(e);if(!l)return;if(!r||!n||!n.beforeComplete)return l;const c=i?Math.abs(e-i):1;if(e$(r,o,a)&&s&&c>=.1){const d=((u,p)=>{const h=u.width,g=u.height;return za(p)&&(u.width=g,u.height=h),u})(no(o),a);t.crop=Oo(qr(Or(d),e),ai)}else{const d={width:r.height*l,height:r.height},u=.5*(r.width-d.width),p=.5*(r.height-d.height);t.crop=Oo(An(r.x+u,r.y+p,d.width,d.height),ai)}return l})],["cropOrigin"],["cropMinSize",Do(()=>({width:1,height:1}))],["cropMaxSize",Do(()=>({width:32768,height:32768}))],["cropLimitToImage",Do(()=>!0),Ml(t=>(e,i,n)=>{const{crop:r}=t;return r&&!i&&e&&n(()=>t.crop=ki(t.crop)),e})],["cropSize",Nd(({crop:t})=>[[t],([e],i)=>{e&&i(jn(e.width,e.height))},(e,i)=>zc(e,i)])],["cropRectAspectRatio",Vd(({cropSize:t})=>[[t],([e],i)=>{e&&i(ai(ir(e),5))}])],["cropRange",Nd(({size:t,rotation:e,cropRectAspectRatio:i,cropMinSize:n,cropMaxSize:r,cropLimitToImage:o})=>[[t,e,i,n,r,o],([a,s,l,c,d,u],p)=>{a&&p(((h,g,m,f,x,k)=>{const w=no(f),C=no(x);return k?[w,ns(Il(h,g,m),Math.round)]:[w,C]})(a,s,l,c,d,u))},(a,s)=>as(a,s)])],["rotationRange",Nd(({size:t,isRotatedSideways:e,cropMinSize:i,cropSize:n,cropLimitToImage:r})=>[[t,e,i,n,r],([o,a,s,l,c],d)=>{!o||!l||d(tv(o,a,s,l,c))},(o,a)=>as(o,a)])],["backgroundColor",Ml(()=>t=>((e=[0,0,0,0],i=1)=>e.length===4?e:[...e,i])(t))],["backgroundImage"],["targetSize"],["colorMatrix"],["convolutionMatrix"],["gamma"],["noise"],["vignette"],["duration"],["currentTime"],["minDuration",Do(()=>1/24)],["maxDuration",Do(()=>1/0)],["volume",Do(()=>1)],["trim"],["redaction",$c(({size:t})=>[kc,{context:t}])],["manipulation",$c(({size:t})=>[kc,{context:t}])],["annotation",$c(({size:t})=>[kc,{context:t}])],["decoration",$c(({crop:t})=>[kc,{context:t}])],["selection",$c(({size:t})=>[ev,{context:t}])],["frame",Ml(()=>t=>{if(!t)return;const e={frameStyle:void 0,x:0,y:0,width:"100%",height:"100%",disableStyle:["backgroundColor","strokeColor","strokeWidth"]};return We(t)?e.frameStyle=t:Object.assign(e,t),e})],["metadata"],["state",Ky((t,e,i)=>{const n=vp.map(l=>e[l]);let r=!1;const o=pe({}),{subscribe:a}=Ii([...n,o],(l,c)=>{if(r)return;const d=vp.reduce((u,p,h)=>(u[p]=ih(l[h]),u),{});d.crop&&Oo(d.crop,Math.round),d.manipulation=d.manipulation&&gc(d.manipulation),d.redaction=d.redaction&&gc(d.redaction),d.annotation=d.annotation&&gc(d.annotation),d.decoration=d.decoration&&gc(d.decoration),d.selection=d.selection&&gc(d.selection),c(d)}),s=l=>{l&&(r=!0,i.cropOrigin=void 0,vp.filter(c=>Ae(l,c)).forEach(c=>{const d=l[c];i[c]=d===null?void 0:ih(d)}),r=!1,o.set({}))};return{set:s,update:l=>s(l(null)),subscribe:a}})]],i$=async(t,e,i={},n)=>{const{ontaskstart:r,ontaskprogress:o,ontaskend:a,token:s}=n;let l=!1;const c={cancel:ge};s.cancel=()=>{l=!0,c.cancel()};for(const[d,u]of e.entries()){if(l)return;const[p,h]=u;r(d,h);try{t=await p(t,{...i,taskCancelToken:c},g=>o(d,h,g))}catch(g){throw l=!0,g}a(d,h)}return t};const e2=["loadstart","loadabort","loaderror","loadprogress","load","processstart","processabort","processerror","processprogress","process"],iv=["flip","cropOrigin","isRotatedSideways","perspective","perspectiveX","perspectiveY","cropRange"],nv=Vh.map(([t])=>t).filter(t=>!iv.includes(t)),wp=t=>"image"+Jy(t),n$=t=>Ae(t,"crop");var i2=()=>{const{stores:t,accessors:e}=Jm(Kb),{sub:i,pub:n}=rs(),r=()=>e.images?e.images[0]:{};let o={};const a={};nv.forEach(m=>{Object.defineProperty(e,wp(m),{get:()=>{const f=r();if(f)return f.accessors[m]},set:f=>{o[wp(m)]=f,a[wp(m)]=f;const x=r();x&&(x.accessors[m]=f)}})});const s=()=>e.images&&e.images[0],l=t.src.subscribe(m=>{if(!m)return e.images=[];e.imageReader&&(e.images.length&&(o={}),d(m))}),c=t.imageReader.subscribe(m=>{m&&(e.images.length||e.src&&d(e.src))}),d=m=>{Promise.resolve().then(()=>p(m,o)).catch(()=>{})};let u;const p=(m,f={})=>new Promise((x,k)=>{let w=s();const C=!(f.cropLimitToImage===!1||f.imageCropLimitToImage===!1||a.imageCropLmitedToImage===!1),P=f.cropMinSize||f.imageCropMinSize||a.imageCropMinSize,R=C?P:w&&w.accessors.cropMinSize,W=f.minDuration||f.imageMinDuration;w&&g(),w=(({minSize:D={width:1,height:1},minDuration:B=0}={})=>{const{stores:y,accessors:_}=Jm(Vh),{pub:J,sub:S}=rs(),j=(Q,ht)=>{const at=()=>_[Q]||{},U=Mt=>{_[Q]={...at(),...Mt,timeStamp:Date.now()}},yt=()=>at().error,$t=Mt=>{yt()||(U({error:Mt}),J(ht+"error",{...at()}))};return{start(){J(ht+"start")},onabort(){U({abort:!0}),J(ht+"abort",{...at()})},ontaskstart(Mt,dt){yt()||(U({index:Mt,task:dt,taskProgress:void 0,taskLengthComputable:void 0}),J(ht+"taskstart",{...at()}))},ontaskprogress(Mt,dt,Tt){yt()||(U({index:Mt,task:dt,taskProgress:Tt.loaded/Tt.total,taskLengthComputable:Tt.lengthComputable}),J(ht+"taskprogress",{...at()}),J(ht+"progress",{...at()}))},ontaskend(Mt,dt){yt()||(U({index:Mt,task:dt}),J(ht+"taskend",{...at()}))},ontaskerror(Mt){$t(Mt)},error(Mt){$t(Mt)},beforeComplete(Mt){yt()||(U({beforeComplete:!0}),J("before"+ht,Mt))},complete(Mt){yt()||(U({complete:!0}),J(ht,Mt))}}};return bu(_,{read:(Q,{reader:ht},at={})=>{if(!ht)return;Object.assign(_,{file:void 0,size:void 0,loadState:void 0});let U={cancel:ge},yt=!1;const $t=j("loadState","load"),Mt={token:U,...$t},dt={src:Q,size:void 0,dest:void 0,duration:void 0};return Promise.resolve().then(async()=>{try{if($t.start(),yt)return $t.onabort();const Tt=await i$(dt,ht,at,Mt);if(yt)return $t.onabort();const{size:K,duration:q,dest:Z}=Tt||{};if(!K||!K.width||!K.height)throw new Rc("Image size missing","IMAGE_SIZE_MISSING",Tt);if(q>0&&q<B)throw new Rc("Video too short","VIDEO_TOO_SHORT",{...Tt,minDuration:B});if(K.width<D.width||K.height<D.height)throw new Rc("Image too small","IMAGE_TOO_SMALL",{...Tt,minWidth:D.width,minHeight:D.height});Object.assign(_,{file:Z,size:K,duration:q}),$t.beforeComplete(Tt),$t.complete(Tt)}catch(Tt){$t.error(Tt)}finally{U=void 0}}),()=>{yt=!0,U&&U.cancel(),$t.onabort()}},write:(Q,ht)=>{if(!_.loadState.complete)return;_.processState=void 0;const at=j("processState","process"),U={src:_.file,imageState:_.state,dest:void 0};if(on(Q)&&(Q=Q(_.file,_.state)),!Q)return at.start(),void at.complete(U);let yt={cancel:ge},$t=!1;const Mt=ht,dt={token:yt,...at};return Promise.resolve().then(async()=>{try{if(at.start(),$t)return at.onabort();const Tt=await i$(U,Q,Mt,dt);if($t)return at.onabort();at.complete(Tt)}catch(Tt){at.error(Tt)}finally{yt=void 0}}),()=>{$t=!0,yt&&yt.cancel()}},on:S}),{accessors:_,stores:y}})({minSize:R,minDuration:W}),e2.map(D=>{return w.accessors.on(D,(B=D,y=>n(B,y)));var B});const T=()=>{o={},F.forEach(D=>D())},F=[];F.push(w.accessors.on("loaderror",D=>{T(),k(D)})),F.push(w.accessors.on("loadabort",()=>{T(),k({name:"AbortError"})})),F.push(w.accessors.on("load",D=>{u=void 0,T(),x(D)})),F.push(w.accessors.on("beforeload",()=>((D,B)=>{if(n$(B))return void(e.imageState=B);if(!B.imageCrop){const J=D.accessors.size,S=B.imageRotation||0,j=iy(no(J),S),Q=Or(j);Q.width=ai(Math.abs(Q.width),6),Q.height=ai(Math.abs(Q.height),6);const ht=B.imageCropAspectRatio||(B.imageCropLimitToImage?ir(J):ir(Q));let at;B.imageCropLimitToImage?at=qr(Q,ht):(at=os(Q,ht),at.x=(J.width-at.width)/2,at.y=(J.height-at.height)/2),B.imageCrop=at}if(D.accessors.duration&&!B.imageTrim&&B.imageMaxDuration){const{duration:J}=D.accessors;B.imageTrim=[[0,Math.min(B.imageMaxDuration/J,1)]]}const y=["imageCropLimitToImage","imageCrop","imageCropAspectRatio","imageRotation"];y.filter(J=>Ae(B,J)).forEach(J=>{e[J]=B[J],delete B[J]});const _=Object.keys(B).filter(J=>!y.includes(J)).reduce((J,S)=>(J[S]=B[S],J),{});Object.assign(e,_)})(w,f))),e.images=[w],f.imageReader&&(e.imageReader=f.imageReader),f.imageWriter&&(e.imageWriter=f.imageWriter),u=w.accessors.read(m,{reader:e.imageReader},{willRequest:e.willRequest})});let h;const g=()=>{const m=s();m&&(u&&u(),m.accessors.loadState=void 0,e.images=[])};return Object.defineProperty(e,"stores",{get:()=>t}),bu(e,{on:i,loadImage:p,abortLoadImage:()=>{u&&u(),e.images=[]},editImage:(m,f)=>new Promise((x,k)=>{p(m,f).then(()=>{const{images:w}=e,C=w[0],P=()=>{R(),W()},R=C.accessors.on("processerror",T=>{P(),k(T)}),W=C.accessors.on("process",T=>{P(),x(T)})}).catch(k)}),removeImage:g,processImage:(m,f)=>new Promise((x,k)=>{try{const w=[],C=()=>{h=void 0,w.forEach(P=>P())};(async()=>{if((R=>We(R)||Ol(R)||Bl(R))(m))try{await p(m,f)}catch(R){k(R)}else m&&(n$(m)?e.imageState=m:Object.assign(e,m));const P=s();if(!P)return k("no image");w.push(P.accessors.on("processerror",R=>{C(),k(R)})),w.push(P.accessors.on("processabort",()=>{C(),k({name:"AbortError"})})),w.push(P.accessors.on("process",R=>{C(),x(R)})),h=P.accessors.write(e.imageWriter,{redactionRenderStyle:e.imageRedactionRendering,shapePreprocessor:e.shapePreprocessor||Yi,imageScrambler:e.imageScrambler,willRequest:e.willRequest,willRequestResource:e.willRequestResource})})()}catch(w){k(w)}}),abortProcessImage:()=>{const m=s();m&&(h&&h(),m.accessors.processState=void 0)},destroy:()=>{l&&l(),c&&c()}}),e};const rv=(t,e)=>{const{processImage:i}=i2();return i(t,e)};var n2=()=>Fa()?va()?/15_|16_/.test(navigator.userAgent)?14745600:16777216:/15_/.test(navigator.userAgent)?16777216:1/0:1/0,r2=(t,e)=>Object.keys(t).filter(i=>!e.includes(i)).reduce((i,n)=>(i[n]=t[n],i),{}),o2=t=>new Promise(e=>{if(t.duration===1/0)return t.ontimeupdate=()=>{t.ontimeupdate=void 0,e(t)},void(t.currentTime=Number.MAX_SAFE_INTEGER);e(t)});const ov=t=>new Promise(e=>{const i=new FileReader;i.onload=()=>e(i.result),i.readAsArrayBuffer(t)}),Sp=(t,e=0,i=t.byteLength)=>{const n=[],r=e+i;for(;e<r;){const o=t.getUint32(e);if(o<0)break;const a=t.getUint32(e+4);if(n.push({type:a,size:o,offset:e,bodyOffset:e+8,bodySize:o-8}),o<8)break;e+=o}return n},av=(t,{limit:e=1024}={})=>{let i=0;if(i+=4,t.getUint32(i)!==1718909296)return 0;i+=4;const n=t.getUint32(i);return n===1836069938?((r,o,a)=>{let s=!1,l=-1;for(let h=o;h<a;h++)if(s||r.getUint32(h)!==1953653099||(s=!0,h+=4),s&&r.getUint8(h)==64){l=h;break}if(l<0)return 0;const c=r.getUint32(l-28),d=r.getUint32(l-20),u=r.getUint32(l-32),p=r.getUint32(l-16);return c===65536&&d===4294901760?90:u===4294901760&&p===4294901760?180:c===4294901760&&d===65536?270:0})(t,i,e):n===1903435808?(r=>{const o=Sp(r).find(c=>c.type===1836019574);if(!o)return 0;const a=Sp(r,o.bodyOffset,o.bodySize);a.filter(c=>c.type===1953653099).forEach(c=>{a.push(...Sp(r,c.bodyOffset,c.bodySize))});const s=[1836476516,1953196132],l=a.filter(c=>s.includes(c.type));for(const{type:c,bodyOffset:d}of l){const u=r.getUint8(d);let p=d+4;p+=c===1836476516?32:36,p+=u===1?12:0;const h=r.getInt32(p),g=r.getInt32(p+4);if(h===0&&g>0)return 90;if(h<0&&g===0)return 180;if(h===0&&g<0)return 270}return 0})(t):0};var a2=t=>new Promise((e,i)=>{(wa()?(async n=>{const r=await ov(n),o=new DataView(r);return av(o)})(t):Promise.resolve(0)).then(n=>{const r=document.createElement("video");r.onerror=()=>i(r.error),r.playsInline=!0,r.preload="auto",r.onseeked=()=>{r.onseeked=void 0,e(r)},r.onloadeddata=()=>{r.onloadeddata=void 0,r.dataset.rotation=n?""+n:"0",o2(r).then(e),r.currentTime=0},r.src=URL.createObjectURL(t),r.load()})}),s2=(t,e)=>new Promise(i=>{if(t.currentTime===e)return i(t);let n=t.onseeked;t.onseeked=()=>{t.onseeked=n,i(t)},t.currentTime=Ji(e,0,t.duration)}),l2=(t,e=0)=>new Promise((i,n)=>{a2(t).then(r=>{s2(r,e).then(o=>{const a=vn("canvas");py(o).then(({width:s,height:l})=>{a.width=s,a.height=l;const c=a.getContext("2d",{willReadFrequently:!0}),d=()=>{c.drawImage(o,0,0,a.width,a.height);const u=c.getImageData(0,0,a.width,a.height);qn(a),URL.revokeObjectURL(o.src),i(u)};Fa()?setTimeout(d,16):d()})})})}),ll=t=>/video/.test(t.type);const Nh=({imageDataResizer:t,canvasMemoryLimit:e}={})=>async(i,n,r,o,a)=>{r.width=Math.max(r.width,1),r.height=Math.max(r.height,1),o.width=Math.max(o.width,1),o.height=Math.max(o.height,1);const{dest:s}=await rv(n,{imageReader:m2(),imageWriter:$2({format:"canvas",targetSize:{...o,upscale:!0},imageDataResizer:t,canvasMemoryLimit:e}),imageCrop:r}),{feather:l=0}=a||{};if(l>0){const c=vn("canvas");c.width=s.width,c.height=s.height;const d=c.getContext("2d",{willReadFrequently:!0}),u=1/l;let p=0;for(p=0;p<l;p++){const g=p*u;d.strokeStyle=`rgba(0,0,0,${g*g})`,d.strokeRect(p+.5,p+.5,s.width-2*p-1,s.height-2*p-1)}d.fillStyle="#000",d.fillRect(p,p,s.width+.5-2*p,s.height+.5-2*p);const h=s.getContext("2d");h.globalCompositeOperation="destination-in",h.drawImage(c,0,0),qn(c)}i.drawImage(s,o.x,o.y,o.width,o.height),qn(s)},Cn=(t,e=(...n)=>n,i)=>async(n,r,o)=>{o(Pl(0,!1));let a=!1;const s=await t(...e(n,r,l=>{a=!0,o(l)}));return i&&i(n,s),a||o(Pl(1,!1)),n},sv=({willRequest:t,srcProp:e="src",destProp:i="dest"}={})=>[Cn(ub,(n,r,o)=>[n[e],o,{...r,willRequest:t}],(n,r)=>n[i]=r),"any-to-file"],lv=({srcProp:t="dest",destProp:e="dest"}={})=>[Cn(async i=>{if(/octet-stream/.test(i.type)){console.warn(`Pintura: File has unknown mime type "${i.type}", make sure your server sets the correct Content-Type header.`);let n="image";const r=await Ch(i);/video/i.test(r.nodeName)&&(n="video");const o={type:n+"/unknown"};return jc(i)?new File([i],i.name,{...o,lastModified:i.lastModified}):new Blob([i],o)}return i},i=>[i[t]],(i,n)=>i[e]=n),"any-to-file"],c2=({srcProp:t="src",destProp:e="size"}={})=>[Cn(hy,i=>[i[t]],(i,n)=>i[e]=n),"read-image-size"],cv=async t=>{const e=await Ch(t);if(hu(e))return await(i=>new Promise((n,r)=>{const o=()=>{o2(i).then(()=>{n(i.duration)})};if(i.readyState>=1)return o();i.onloadedmetadata=o,i.onerror=()=>r(i.error)}))(e)},dv=({srcProp:t="src",destProp:e="duration"}={})=>[Cn(cv,i=>[i[t]],(i,n)=>i[e]=n),"read-media-duration"],d2=({srcSize:t="size",srcOrientation:e="orientation",destSize:i="size"}={})=>[Cn(pb,n=>[n[t],n[e]],(n,r)=>n[i]=r),"image-size-match-orientation"],u2=({srcProp:t="src",destProp:e="head"}={})=>[Cn((i,n)=>gy(i)?Gf(i,n):void 0,i=>[i[t],[0,262144],onprogress],(i,n)=>i[e]=n),"read-image-head"],p2=({srcProp:t="head",destProp:e="orientation"}={})=>[Cn(gh,i=>[i[t],274],(i,n=1)=>i[e]=n),"read-exif-orientation-tag"],uv=({srcProp:t="head"}={})=>[Cn(gh,e=>[e[t],274,1]),"clear-exif-orientation-tag"],pv=({srcImageSize:t="size",srcCanvasSize:e="imageData",srcImageState:i="imageState",destImageSize:n="size",destScalar:r="scalar"}={})=>[Cn((o,a)=>[Math.min(a.width/o.width,a.height/o.height),Da(a)],o=>[o[t],o[e],o[i]],(o,[a,s])=>{o[r]=a,o[n]=s}),"calculate-canvas-scalar"],hv=({srcProp:t="src",destProp:e="imageData",canvasMemoryLimit:i,srcImageState:n="imageState"}={})=>[Cn((r,o,a)=>ll(r)?l2(r,a.currentTime):Jf(r,o),r=>[r[t],i,r[n]],(r,o)=>r[e]=o),"blob-to-image-data"],mv=({srcImageData:t="imageData",srcOrientation:e="orientation"}={})=>[Cn(Xf,i=>[i[t],i[e]],(i,n)=>i.imageData=n),"image-data-match-orientation"],$v=({srcImageData:t="imageData",srcImageState:e="imageState"}={})=>[Cn(Hb,i=>[i[t],{backgroundColor:i[e].backgroundColor,backgroundImage:i[e].backgroundImage}],(i,n)=>i.imageData=n),"image-data-fill"],gv=({srcImageData:t="imageData",srcImageState:e="imageState",destScalar:i="scalar"}={})=>[Cn(mb,n=>{const r=n[i];let{crop:o}=n[e];return o&&r!==1&&(o=Cr(ki(o),r,rn())),[n[t],{crop:o,rotation:n[e].rotation,flipX:n[e].flipX,flipY:n[e].flipY}]},(n,r)=>n.imageData=r),"image-data-crop"],fv=({targetSize:t={width:void 0,height:void 0,fit:void 0,upscale:void 0},imageDataResizer:e,srcProp:i="imageData",srcImageState:n="imageState",destImageScaledSize:r="imageScaledSize"})=>[Cn(gb,o=>{const a=Math.min(t.width||Number.MAX_SAFE_INTEGER,o[n].targetSize&&o[n].targetSize.width||Number.MAX_SAFE_INTEGER),s=Math.min(t.height||Number.MAX_SAFE_INTEGER,o[n].targetSize&&o[n].targetSize.height||Number.MAX_SAFE_INTEGER);return[o[i],{width:a,height:s,fit:t.fit||"contain",upscale:(l=o[n],!!(l.targetSize&&l.targetSize.width||l.targetSize&&l.targetSize.height)||t.upscale||!1)},e];var l},(o,a)=>{zc(o.imageData,a)||(o[r]=Da(a)),o.imageData=a}),"image-data-resize"],yv=({srcImageData:t="imageData",srcImageState:e="imageState",destImageData:i="imageData"}={})=>[Cn(vb,n=>{const{colorMatrix:r}=n[e],o=r&&Object.keys(r).map(a=>r[a]).filter(Boolean);return[n[t],{colorMatrix:o&&Dh(o),convolutionMatrix:n[e].convolutionMatrix,gamma:n[e].gamma,noise:n[e].noise,vignette:n[e].vignette}]},(n,r)=>n[i]=r),"image-data-filter"],xv=({srcImageData:t="imageData",srcImageState:e="imageState",destImageData:i="imageData",destScalar:n="scalar"}={})=>[Cn(async(r,o,a,s,l,c)=>{if(!o||!s.length)return r;let d;try{const m={dataSizeScalar:By(r,s)};a&&a[3]>0&&(m.backgroundColor=[...a]),d=await o(r,m)}catch{}const u=vn("canvas");u.width=r.width,u.height=r.height;const p=u.getContext("2d",{willReadFrequently:!0});if(p.putImageData(r,0,0),c==="auto"){const m=Math.sqrt(r.width*r.height);p.filter=`blur(${Math.round(m/100)}px)`}const h=new Path2D;s.forEach(m=>{const f=An(m.x,m.y,m.width,m.height);Cs(f,l);const x=$r(ki(f),m.rotation),k=new Path2D;x.forEach((w,C)=>{if(C===0)return k.moveTo(w.x,w.y);k.lineTo(w.x,w.y)}),h.addPath(k)}),p.clip(h,"nonzero"),p.imageSmoothingEnabled=!1,p.drawImage(d,0,0,u.width,u.height),qn(d);const g=p.getImageData(0,0,u.width,u.height);return qn(u),g},(r,{imageScrambler:o,redactionRenderStyle:a})=>[r[t],o,r[e].backgroundColor,r[e].redaction,r[n],a],(r,o)=>r[i]=o),"image-data-redact"],kp=({srcImageData:t="imageData",srcSize:e="size",srcImageState:i="imageState",srcShapes:n="annotation",destImageData:r="imageData",destImageScaledSize:o="imageScaledSize",destScalar:a="scalar",imageDataResizer:s,canvasMemoryLimit:l,shapeFilter:c=Yi,shapeClip:d=!0,destImageContext:u="imageContext"}={})=>[Cn(Fh,(p,{shapePreprocessor:h,willRequestResource:g,willRequest:m})=>{const f=p[i][n].filter(c);if(!f.length)return[p[t]];const x=p[a],{crop:k}=p[i],w=p[e];let C=x;const P=p[o];P&&(C=Math.min(P.width/k.width,P.height/k.height));const R={width:w.width/x,height:w.height/x};return[p[t],{shapes:f,computeShape:W=>(W=Gn(W,R),W=r2(W,["left","right","top","bottom"]),W=Ay(W,C)),transform:W=>{const T=p[e],{rotation:F=0,flipX:D,flipY:B,cropLimitToImage:y}=p[i],_=p[a],{crop:J=Or(T)}=p[i],S=p[o],j=S?Math.min(S.width/J.width,S.height/J.height):1,Q={width:T.width/_*j,height:T.height/_*j},ht=ob(Q,F),at=ht.width,U=ht.height,yt=.5*Q.width-.5*at,$t=.5*Q.height-.5*U,Mt=Dl(Q);W.translate(-yt,-$t),W.translate(-J.x*j,-J.y*j),W.translate(Mt.x,Mt.y),W.rotate(F),W.translate(-Mt.x,-Mt.y);const dt=p[u]||{x:0,y:0};W.translate(dt.x,dt.y),W.scale(D?-1:1,B?-1:1),W.translate(D?-Q.width*_:0,B?-Q.height*_:0),y&&d&&(W.rect(0,0,Q.width,Q.height),W.clip())},drawImage:Nh({imageDataResizer:s,canvasMemoryLimit:l}),preprocessShape:W=>h(W,{isPreview:!1,...p[i]}),canvasMemoryLimit:l,willRequest:m||g}]},(p,h)=>p[r]=h),"image-data-annotate"],r$=({srcImageData:t="imageData",srcImageState:e="imageState",destImageData:i="imageData",destImageScaledSize:n="imageScaledSize",imageDataResizer:r,canvasMemoryLimit:o,destScalar:a="scalar",shapeFilter:s=Yi,destImageContext:l="imageContext"}={})=>[Cn(Fh,(c,{shapePreprocessor:d,willRequestResource:u,willRequest:p})=>{let h=c[e].decoration.filter(s);if(typeof window<"u"&&(x=>{if(x&&x._qnr6q7e)return;const[k]=[[85,110,108,105,99,101,110,115,101,100,32,80,105,110,116,117,114,97,32,105,110,115,116,97,110,99,101,32]].map(R=>R.map(W=>String.fromCharCode(W)).join("")),{width:w,height:C}=c[e].crop,P=C/15;h=[...h,{x:.5*-P,y:.5*-P,width:1.5*w,height:1.25*C,text:Array(50).fill(k).join(""),fontWeight:900,lineHeight:P,fontSize:P,color:[1,1,1,.05]}]})(window),!h.length)return[c[t]];let g=c[a];const{crop:m}=c[e],f=c[n];return f&&(g=Math.min(f.width/m.width,f.height/m.height)),[c[t],{shapes:h,drawImage:Nh({imageDataResizer:r,canvasMemoryLimit:o}),computeShape:x=>(x=Gn(x,m),x=r2(x,["left","right","top","bottom"]),x=Ay(x,g)),preprocessShape:x=>d(x,{isPreview:!1,...c[e]}),canvasMemoryLimit:o,willRequest:p||u,transform:x=>{const k=c[l]||{x:0,y:0};x.translate(k.x,k.y)}}]},(c,d)=>c[i]=d),"image-data-decorate"],bv=({srcImageData:t="imageData",srcImageState:e="imageState",destImageData:i="imageData",destImageScaledSize:n="imageScaledSize",imageDataResizer:r,canvasMemoryLimit:o,destScalar:a="scalar",destImageContext:s="imageContext"}={})=>[Cn((l,c)=>new Promise(d=>{if(!c)return d([l]);Fh(l,c).then(u=>{d([u,c.contextBounds])})}),(l,{shapePreprocessor:c,willRequestResource:d,willRequest:u})=>{const p=l[e].frame;if(!p)return[l[t]];const h=l[a];let{crop:g}=l[e];g&&h!==1&&(g=Cr(ki(g),h,rn()));const m={...g},f=Ry(Iy(p,m,c),m);m.x=Math.abs(f.left),m.y=Math.abs(f.top),m.width+=Math.abs(f.left)+Math.abs(f.right),m.height+=Math.abs(f.top)+Math.abs(f.bottom);const x=l[n],k=x?Math.min(x.width/g.width,x.height/g.height):1;return Cs(m,k),m.x=Math.floor(m.x),m.y=Math.floor(m.y),m.width=Math.floor(m.width),m.height=Math.floor(m.height),[l[t],{shapes:[p],contextBounds:m,computeShape:w=>Gn(w,l[t]),transform:w=>{w.translate(m.x,m.y)},drawImage:Nh({imageDataResizer:r,canvasMemoryLimit:o}),preprocessShape:w=>c(w,{isPreview:!1,...l[e]}),canvasMemoryLimit:o,willRequest:u||d}]},(l,[c,d])=>{l[s]=d,l[i]=c}),"image-data-frame"],vv=({mimeType:t,quality:e,srcImageData:i="imageData",srcFile:n="src",destBlob:r="blob"}={})=>[Cn(Qx,o=>[o[i],t||bh(o[n].name)||o[n].type,e],(o,a)=>o[r]=a),"image-data-to-blob"],wv=({srcImageData:t="imageData",srcOrientation:e="orientation",destCanvas:i="dest"}={})=>[Cn(Nl,n=>[n[t],n[e]],(n,r)=>n[i]=r),"image-data-to-canvas"],Sv=async(t,e)=>{if(!gy(t)||!e)return t;const i=new DataView(e),n=Uf(i);if(!n||!n.exif)return t;const r=["exif","mpf","xmp"].reduce((o,a)=>n[a]?Math.max(o,n[a].offset+n[a].size):o,0);return((o,a,s=[0,o.size])=>a?new Blob([a,o.slice(...s)],{type:o.type}):o)(t,e.slice(0,r+2),[20])},kv=(t="blob",e="head",i="blob")=>[Cn(Sv,n=>[n[t],n[e]],(n,r)=>n[i]=r),"blob-write-image-head"],Cv=({renameFile:t,srcBlob:e="blob",srcFile:i="src",destFile:n="dest",defaultFilename:r}={})=>[Cn(Ac,o=>[o[e],t?t(o[i]):o[i].name||`${r}.${Qf(o[e].type)}`],(o,a)=>o[n]=a),"blob-to-file"],o$=({url:t="./",dataset:e=o=>[["dest",o.dest,o.dest.name],["imageState",o.imageState]],destStore:i="store",credentials:n,headers:r={}})=>[Cn(async(o,a)=>await((s,l,c)=>new Promise((d,u)=>{const{token:p={},beforeSend:h=ge,onprogress:g=ge}=c;p.cancel=()=>m.abort();const m=new XMLHttpRequest;m.upload.onprogress=g,m.onload=()=>m.status>=200&&m.status<300?d(m):u(m),m.onerror=()=>u(m),m.ontimeout=()=>u(m),m.open("POST",encodeURI(s)),h(m),m.send(l instanceof FormData?l:l.reduce((f,x)=>(f.append(...x.map(hb)),f),new FormData))}))(t,o,{onprogress:a,beforeSend:s=>my(s,{headers:r,credentials:n})}),(o,a,s)=>[e(o),s],(o,a)=>o[i]=a),"store"],h2=t=>[Cn(e=>(t&&t.length&&Object.keys(e).forEach(i=>{t.includes(i)||delete e[i]}),e)),"prop-filter"],m2=(t={})=>{const{orientImage:e=!0,outputProps:i=["src","dest","size","duration"],preprocessImageFile:n,request:r={}}=t;return[sv({willRequest:()=>r}),lv(),n&&[Cn(n,(o,a,s)=>[o.dest,a,s],(o,a)=>o.dest=a),"preprocess-image-file"],c2({srcProp:"dest"}),dv({srcProp:"dest"}),e&&u2({srcProp:"dest"}),e&&p2(),e&&d2(),h2(i)].filter(Boolean)},Tv=t=>t&&(We(t)?o$({url:t}):on(t)?[t,"store"]:o$(t)),$2=(t={})=>(e,i,n={})=>{let{canvasMemoryLimit:r=n2(),orientImage:o=!0,copyImageHead:a=!0,mimeType:s,quality:l,renameFile:c,targetSize:d,imageDataResizer:u,store:p,format:h="file",outputProps:g=["src","dest","imageState","store"],preprocessImageSource:m,preprocessImageState:f,postprocessImageData:x,postprocessImageBlob:k,testSrcSupport:w=!1}={...t,...n};if(!w||Cu(e))return h==="blob"&&(h="file"),[m&&[Cn(m,(C,P,R)=>[C.src,P,R,C.imageState],(C,P)=>C.src=P),"preprocess-image-source"],(o||a)&&u2(),o&&p2(),c2(),f&&[Cn(f,(C,P,R,W)=>[C.imageState,P,R,{size:C.size,orientation:C.orientation}],(C,P)=>C.imageState=P),"preprocess-image-state"],hv({canvasMemoryLimit:r}),o&&d2(),o&&mv(),pv(),xv(),gv(),fv({imageDataResizer:u,targetSize:d}),kp({imageDataResizer:u,canvasMemoryLimit:r,srcShapes:"manipulation"}),yv(),$v(),kp({imageDataResizer:u,canvasMemoryLimit:r,srcShapes:"annotation",shapeFilter:C=>!C.aboveFrame}),r$({imageDataResizer:u,canvasMemoryLimit:r,shapeFilter:C=>!C.aboveFrame}),bv({imageDataResizer:u,canvasMemoryLimit:r}),kp({imageDataResizer:u,canvasMemoryLimit:r,srcShapes:"annotation",shapeFilter:C=>C.aboveFrame,shapeClip:!1}),r$({imageDataResizer:u,canvasMemoryLimit:r,shapeFilter:C=>C.aboveFrame}),x&&[Cn(x,(C,P,R)=>[C.imageData,P,R],(C,P)=>C.imageData=P),"postprocess-image-data"],h==="file"?vv({mimeType:s,quality:l}):h==="canvas"?wv():[C=>(C.dest=C.imageData,C)],h==="file"&&o&&uv(),h==="file"&&a&&kv(),k&&[Cn(k,({blob:C,imageData:P,src:R},W,T)=>[{blob:C,imageData:P,src:R},W,T],(C,P)=>C.blob=P),"postprocess-image-file"],h==="file"&&Cv({defaultFilename:"image",renameFile:c}),h==="file"?Tv(p):on(p)&&[p,"store"],h2(g)].filter(Boolean)};var Mv=(t,e,i,n,r,o,a,s,l,c,d)=>{if(!(t&&e&&i&&n&&s))return;s*=o;const u=Fc(ki(e)),p=Ci(u),h=Ci(t),g=Or(i),m=Ci(g),f=_h(i,n,l),x=Ci(f),k=Bn(Oe(m),x),w=Bn(Oe(h),p);k.x+=w.x,k.y+=w.y;const C=El(Oe(k));C.x+=w.x,C.y+=w.y;const P=Ci(ta(ta(ki(r),a),t)),R=Bn(P,h);return Dn(k,R),{origin:C,translation:k,rotation:{x:d?Math.PI:0,y:c?Math.PI:0,z:l},scale:s}};let fc=null;var Hh=()=>{if(fc===null)if("WebGL2RenderingContext"in window){let t;try{t=vn("canvas"),fc=!!t.getContext("webgl2")}catch{fc=!1}t&&qn(t),t=void 0}else fc=!1;return fc},a$=t=>(t&t-1)==0,jh=(t,e={},i="",n="")=>Object.keys(e).filter(r=>!al(e[r])).reduce((r,o)=>r.replace(new RegExp(i+o+n),e[o]),t);const Pv={head:`#version 300 es

in vec4 aPosition;uniform mat4 uMatrix;`,text:`
in vec2 aTexCoord;out vec2 vTexCoord;`,matrix:`
gl_Position=uMatrix*vec4(aPosition.x,aPosition.y,0,1);`},Rv={head:`#version 300 es
precision highp float;

out vec4 fragColor;`,mask:`
uniform float uMaskFeather[8];uniform float uMaskBounds[4];uniform float uMaskOpacity;float mask(float x,float y,float bounds[4],float opacity){return 1.0-(1.0-(smoothstep(bounds[3],bounds[3]+1.0,x)*(1.0-smoothstep(bounds[1]-1.0,bounds[1],x))*(1.0-step(bounds[0],y))*step(bounds[2],y)))*(1.0-opacity);}`,init:`
float a=1.0;vec4 fillColor=uColor;vec4 textureColor=texture(uTexture,vTexCoord);textureColor*=(1.0-step(uRepeat.y,vTexCoord.y))*step(0.0,vTexCoord.y)*(1.0-step(uRepeat.x,vTexCoord.x))*step(0.0,vTexCoord.x);`,colorize:`
if(uTextureColor.a!=0.0&&textureColor.a>0.0){vec3 colorFlattened=textureColor.rgb/textureColor.a;if(colorFlattened.r>=.9999&&colorFlattened.g==0.0&&colorFlattened.b>=.9999){textureColor.rgb=uTextureColor.rgb*textureColor.a;}textureColor*=uTextureColor.a;}`,maskapply:`
float m=mask(gl_FragCoord.x,gl_FragCoord.y,uMaskBounds,uMaskOpacity);`,maskfeatherapply:`
float leftFeatherOpacity=step(uMaskFeather[1],gl_FragCoord.x)*uMaskFeather[0]+((1.0-uMaskFeather[0])*smoothstep(uMaskFeather[1],uMaskFeather[3],gl_FragCoord.x));float rightFeatherOpacity=(1.0-step(uMaskFeather[7],gl_FragCoord.x))*uMaskFeather[4]+((1.0-uMaskFeather[4])*smoothstep(uMaskFeather[7],uMaskFeather[5],gl_FragCoord.x));a*=leftFeatherOpacity*rightFeatherOpacity;`,rectaa:`
vec2 scaledPoint=vec2(vRectCoord.x*uSize.x,vRectCoord.y*uSize.y);a*=smoothstep(0.0,uEdgeFeather,uSize.x-scaledPoint.x);a*=smoothstep(0.0,uEdgeFeather,uSize.y-scaledPoint.y);a*=smoothstep(0.0,uEdgeFeather,scaledPoint.x);a*=smoothstep(0.0,uEdgeFeather,scaledPoint.y);`,cornerradius:`
vec2 s=(uSize-2.0)*.5;vec2 r=(vRectCoord*uSize)-1.0;vec2 p=r-s;float cornerRadius=uCornerRadius[0];bool left=r.x<s.x;bool top=r.y<s.y;if(!left&&top){cornerRadius=uCornerRadius[1];}if(!left&&!top){cornerRadius=uCornerRadius[3];}if(left&&!top){cornerRadius=uCornerRadius[2];}a*=1.0-clamp(length(max(abs(p)-(s-cornerRadius),0.0))-cornerRadius,0.0,1.0);`,fragcolor:`
if(m<=0.0)discard;fillColor.a*=a;fillColor.rgb*=fillColor.a;fillColor.rgb*=m;fillColor.rgb+=(1.0-m)*(uCanvasColor.rgb*fillColor.a);textureColor*=uTextureOpacity;textureColor.a*=a;textureColor.rgb*=m*a;textureColor.rgb+=(1.0-m)*(uCanvasColor.rgb*textureColor.a);fragColor=textureColor+(fillColor*(1.0-textureColor.a));`},s$=(t,e,i)=>{const n=t.createShader(i),r=((o,a,s)=>(a=jh(a,s===o.VERTEX_SHADER?Pv:Rv,"##").trim(),Hh()?a:(a=(a=a.replace(/#version.+/gm,"").trim()).replace(/^\/\/\#/gm,"#"),s===o.VERTEX_SHADER&&(a=a.replace(/in /gm,"attribute ").replace(/out /g,"varying ")),s===o.FRAGMENT_SHADER&&(a=a.replace(/in /gm,"varying ").replace(/out.*?;/gm,"").replace(/texture\(/g,"texture2D(").replace(/fragColor/g,"gl_FragColor")),""+a)))(t,e,i);return t.shaderSource(n,r),t.compileShader(n),t.getShaderParameter(n,t.COMPILE_STATUS)||console.error(t.getShaderInfoLog(n)),n},yc=(t,e,i,n,r)=>{const o=s$(t,e,t.VERTEX_SHADER),a=s$(t,i,t.FRAGMENT_SHADER),s=t.createProgram();t.attachShader(s,o),t.attachShader(s,a),t.linkProgram(s);const l={};return n.forEach(c=>{l[c]=t.getAttribLocation(s,c)}),r.forEach(c=>{l[c]=t.getUniformLocation(s,c)}),{program:s,locations:l,destroy(){t.detachShader(s,o),t.detachShader(s,a),t.deleteShader(o),t.deleteShader(a),t.deleteProgram(s)}}},l$=t=>t.nodeName!=="VIDEO"&&(!!Hh()||a$(t.width)&&a$(t.height)),Iv=(t,e,i,n)=>(t.bindTexture(t.TEXTURE_2D,e),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,i),((r,o,a)=>{r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,l$(o)?r.LINEAR_MIPMAP_LINEAR:r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,a.filterParam),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,a.wrapParam),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,a.wrapParam),l$(o)&&r.generateMipmap(r.TEXTURE_2D)})(t,i,n),t.bindTexture(t.TEXTURE_2D,null),e),qs=(t,e=1)=>t?[t[0],t[1],t[2],di(t[3])?e*t[3]:e]:[0,0,0,0],Cp=()=>{const t=new Float32Array(16);return t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},Tp=(t,e,i,n,r,o,a)=>{const s=1/(e-i),l=1/(n-r),c=1/(o-a);t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+i)*s,t[13]=(r+n)*l,t[14]=(a+o)*c,t[15]=1},Ks=(t,e,i,n)=>{t[12]=t[0]*e+t[4]*i+t[8]*n+t[12],t[13]=t[1]*e+t[5]*i+t[9]*n+t[13],t[14]=t[2]*e+t[6]*i+t[10]*n+t[14],t[15]=t[3]*e+t[7]*i+t[11]*n+t[15]},c$=(t,e)=>{t[0]*=e,t[1]*=e,t[2]*=e,t[3]*=e,t[4]*=e,t[5]*=e,t[6]*=e,t[7]*=e,t[8]*=e,t[9]*=e,t[10]*=e,t[11]*=e},d$=(t,e)=>{const i=Math.sin(e),n=Math.cos(e),r=t[4],o=t[5],a=t[6],s=t[7],l=t[8],c=t[9],d=t[10],u=t[11];t[4]=r*n+l*i,t[5]=o*n+c*i,t[6]=a*n+d*i,t[7]=s*n+u*i,t[8]=l*n-r*i,t[9]=c*n-o*i,t[10]=d*n-a*i,t[11]=u*n-s*i},u$=(t,e)=>{const i=Math.sin(e),n=Math.cos(e),r=t[0],o=t[1],a=t[2],s=t[3],l=t[8],c=t[9],d=t[10],u=t[11];t[0]=r*n-l*i,t[1]=o*n-c*i,t[2]=a*n-d*i,t[3]=s*n-u*i,t[8]=r*i+l*n,t[9]=o*i+c*n,t[10]=a*i+d*n,t[11]=s*i+u*n},p$=(t,e)=>{const i=Math.sin(e),n=Math.cos(e),r=t[0],o=t[1],a=t[2],s=t[3],l=t[4],c=t[5],d=t[6],u=t[7];t[0]=r*n+l*i,t[1]=o*n+c*i,t[2]=a*n+d*i,t[3]=s*n+u*i,t[4]=l*n-r*i,t[5]=c*n-o*i,t[6]=d*n-a*i,t[7]=u*n-s*i};var Ev=t=>t*Math.PI/180,Ru=(t,e)=>Hh()?t.getContext("webgl2",e):t.getContext("webgl",e)||t.getContext("experimental-webgl",e);const Mp=(t,e)=>{const i=t.length;return e>=i?t[e%i]:e<0?t[e%i+i]:t[e]},Av=(t,e,i,n)=>{const r=rt(i.x-e.x,i.y-e.y),o=rt(n.x-i.x,n.y-i.y),a=rt(e.x-n.x,e.y-n.y),s=rt(t.x-e.x,t.y-e.y),l=rt(t.x-i.x,t.y-i.y),c=rt(t.x-n.x,t.y-n.y),d=tu(r,s),u=tu(o,l),p=tu(a,c);return d<=0&&u<=0&&p<=0},Lv=t=>{if(t.length<3)return[];if((x=>{const k=x.length;for(let w=0;w<k;w++){const C=As(x[w],Mp(x,w+1));if(sy(C,x,{ignoreIdenticalLines:!0,breakOnIntersection:!0}))return!0}return!1})(t))return[];(x=>{let k,w,C,P,R,W=0;const T=x.length;for(k=0;k<T;k++)w=x[k],C=x[(k+1)%T],P=C.x-w.x,R=(C.y+w.y)/2,W+=P*R;return W})(t)<0&&t.reverse();const e=t.length,i=[...Array(e).keys()],n=[];let r,o,a,s,l,c,d,u,p,h,g,m,f=128;for(;i.length>3;){if(f<=0)return[];for(f--,r=0;r<i.length;r++)if(a=i[r],s=Mp(i,r-1),l=Mp(i,r+1),c=t[a],d=t[s],u=t[l],p=rt(d.x-c.x,d.y-c.y),h=rt(u.x-c.x,u.y-c.y),!(tu(p,h)<0)){for(g=!0,o=0;o<e;o++)if(o!==a&&o!==s&&o!==l&&(m=t[o],Av(m,d,c,u))){g=!1;break}if(g){n.push([d,c,u]),i.splice(r,1);break}}}return n.push([t[i[0]],t[i[1]],t[i[2]]]),n},h$=(t,e,i,n,r)=>{const o=ro(rt(n.x-i.x,n.y-i.y)),a=ro(rt(r.x-n.x,r.y-n.y)),s=ro(rt(o.x+a.x,o.y+a.y)),l=rt(-s.y,s.x),c=rt(-o.y,o.x),d=Math.min(1/Qd(l,c),5);t[e]=n.x,t[e+1]=n.y,t[e+2]=l.x*d,t[e+3]=l.y*d,t[e+4]=-1,t[e+5]=n.x,t[e+6]=n.y,t[e+7]=l.x*d,t[e+8]=l.y*d,t[e+9]=1},m$=t=>{const e=new Float32Array(8);return e[0]=t[3].x,e[1]=t[3].y,e[2]=t[0].x,e[3]=t[0].y,e[4]=t[2].x,e[5]=t[2].y,e[6]=t[1].x,e[7]=t[1].y,e},$$=(t,e=0,i,n)=>{const r=Wo(t),o=t.x+.5*t.width,a=t.y+.5*t.height;return(i||n)&&Al(r,i,n,o,a),e!==0&&nl(r,e,o,a),r},Hd=(t,e,i,n,r)=>{const o=Math.min(20,Math.max(4,Math.round(n/2)));let a=0,s=0,l=0,c=0,d=0;for(;d<o;d++)a=d/o,s=r*_o+a*_o,l=n*Math.cos(s),c=n*Math.sin(s),t.push(rt(e+l,i+c))};let jd=null;var Uh=()=>{if(jd!==null)return jd;let t=vn("canvas");const e=Ru(t);return jd=e?e.getParameter(e.MAX_TEXTURE_SIZE):void 0,qn(t),t=void 0,jd},Gh=()=>Mr()&&!!window.chrome;const Cc=new Float32Array([0,1,0,0,1,1,1,0]),zv=new Float32Array([1,0,0,0,1,1,0,1]),Fv=Mr()&&wa(),g$=[0,0,0,0,1,0,0,0,0],Dv=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],Pp=[0,0,0,0],Bv=[0,0,0,0],f$=(t,e,i,n,r)=>{if(!i||!n)return Cc;let o=n.x/i.width,a=n.y/i.height,s=t/i.width/r,l=e/i.height/r;return s-=o,l-=a,new Float32Array([-o,l,-o,-a,s,l,s,-a])};var Ov=(t,e={})=>{const{alpha:i=!1}=e,n={width:0,height:0},r={width:0,height:0},o=Uh()||1024;let a,s,l;const c=Cp(),d=Cp();let u,p,h,g,m,f,x,k,w,C=0,P=0,R=0,W=1;const T=new Map([]),F=()=>{y.stencilOp(y.KEEP,y.KEEP,y.KEEP),y.stencilFunc(y.ALWAYS,1,255),y.stencilMask(255)},D=Ev(30),B=Math.tan(D/2),y=Ru(t,{alpha:i,antialias:!1,premultipliedAlpha:!0,stencil:!0});if(!y)return;y.getExtension("OES_standard_derivatives"),y.disable(y.DEPTH_TEST),y.enable(y.STENCIL_TEST),y.enable(y.BLEND),y.blendFunc(y.ONE,y.ONE_MINUS_SRC_ALPHA),y.pixelStorei(y.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!(!i&&wa())),F();const _=y.createTexture();y.bindTexture(y.TEXTURE_2D,_),y.texImage2D(y.TEXTURE_2D,0,y.RGBA,1,1,0,y.RGBA,y.UNSIGNED_BYTE,new Uint8Array(Pp)),T.set(0,_);const J=y.createTexture();T.set(2,J);const S=y.createFramebuffer(),j=y.createTexture();T.set(1,j);const Q=y.createFramebuffer(),ht=yc(y,`
##head
##text
void main(){vTexCoord=aTexCoord;gl_Position=uMatrix*aPosition;}`,`
##head
in vec2 vTexCoord;uniform sampler2D uTexture;uniform sampler2D uTextureOverlay;uniform sampler2D uTextureBlend;uniform vec2 uTextureSize;uniform float uOpacity;uniform int uAntialias;uniform vec4 uOverlayColor;uniform mat4 uColorMatrix;uniform vec4 uColorOffset;uniform float uClarityKernel[9];uniform float uClarityKernelWeight;uniform float uColorGamma;uniform float uColorVignette;uniform float uMaskClip;uniform float uMaskOpacity;uniform float uMaskBounds[4];uniform float uMaskCornerRadius[4];uniform float uMaskFeather[8];vec4 applyGamma(vec4 c,float g){c.r=pow(c.r,g);c.g=pow(c.g,g);c.b=pow(c.b,g);return c;}vec4 applyColorMatrix(vec4 c,mat4 m,vec4 o){return(c*m)+(o*c.a);}vec4 applyConvolutionMatrix(vec4 c,float k0,float k1,float k2,float k3,float k4,float k5,float k6,float k7,float k8,float w){vec2 pixel=vec2(1)/uTextureSize;vec4 colorSum=texture(uTexture,vTexCoord-pixel)*k0+texture(uTexture,vTexCoord+pixel*vec2(0.0,-1.0))*k1+texture(uTexture,vTexCoord+pixel*vec2(1.0,-1.0))*k2+texture(uTexture,vTexCoord+pixel*vec2(-1.0,0.0))*k3+texture(uTexture,vTexCoord)*k4+texture(uTexture,vTexCoord+pixel*vec2(1.0,0.0))*k5+texture(uTexture,vTexCoord+pixel*vec2(-1.0,1.0))*k6+texture(uTexture,vTexCoord+pixel*vec2(0.0,1.0))*k7+texture(uTexture,vTexCoord+pixel)*k8;vec4 color=vec4(clamp((colorSum/w),0.0,1.0).rgb,c.a);return color;}vec4 applyVignette(vec4 c,vec2 pos,vec2 center,float v){float d=distance(pos,center)/length(center);float f=1.0-(d*abs(v));if(v>0.0){c.rgb*=f;}else if(v<0.0){c.rgb+=(1.0-f)*(1.0-c.rgb);}return c;}vec4 blendPremultipliedAlpha(vec4 back,vec4 front){return front+(back*(1.0-front.a));}void main(){float x=gl_FragCoord.x;float y=gl_FragCoord.y;float a=1.0;float maskTop=uMaskBounds[0];float maskRight=uMaskBounds[1];float maskBottom=uMaskBounds[2];float maskLeft=uMaskBounds[3];float leftFeatherOpacity=step(uMaskFeather[1],x)*uMaskFeather[0]+((1.0-uMaskFeather[0])*smoothstep(uMaskFeather[1],uMaskFeather[3],x));float rightFeatherOpacity=(1.0-step(uMaskFeather[7],x))*uMaskFeather[4]+((1.0-uMaskFeather[4])*smoothstep(uMaskFeather[7],uMaskFeather[5],x));a*=leftFeatherOpacity*rightFeatherOpacity;float overlayColorAlpha=(smoothstep(maskLeft,maskLeft+1.0,x)*(1.0-smoothstep(maskRight-1.0,maskRight,x))*(1.0-step(maskTop,y))*step(maskBottom,y));if(uOverlayColor.a==0.0){a*=overlayColorAlpha;}vec2 offset=vec2(maskLeft,maskBottom);vec2 size=vec2(maskRight-maskLeft,maskTop-maskBottom)*.5;vec2 center=offset.xy+size.xy;int pixelX=int(step(center.x,x));int pixelY=int(step(y,center.y));float cornerRadius=0.0;if(pixelX==0&&pixelY==0)cornerRadius=uMaskCornerRadius[0];if(pixelX==1&&pixelY==0)cornerRadius=uMaskCornerRadius[1];if(pixelX==0&&pixelY==1)cornerRadius=uMaskCornerRadius[2];if(pixelX==1&&pixelY==1)cornerRadius=uMaskCornerRadius[3];float cornerOffset=sign(cornerRadius)*length(max(abs(gl_FragCoord.xy-size-offset)-size+cornerRadius,0.0))-cornerRadius;float cornerOpacity=1.0-smoothstep(0.0,1.0,cornerOffset);a*=cornerOpacity;if(uAntialias==1){vec2 scaledPoint=vec2(vTexCoord.x*uTextureSize.x,vTexCoord.y*uTextureSize.y);a*=smoothstep(0.0,1.0,uTextureSize.x-scaledPoint.x);a*=smoothstep(0.0,1.0,uTextureSize.y-scaledPoint.y);a*=smoothstep(0.0,1.0,scaledPoint.x);a*=smoothstep(0.0,1.0,scaledPoint.y);}vec4 color=texture(uTexture,vTexCoord);if(uClarityKernelWeight!=-1.0){color=applyConvolutionMatrix(color,uClarityKernel[0],uClarityKernel[1],uClarityKernel[2],uClarityKernel[3],uClarityKernel[4],uClarityKernel[5],uClarityKernel[6],uClarityKernel[7],uClarityKernel[8],uClarityKernelWeight);}color=blendPremultipliedAlpha(color,texture(uTextureBlend,vTexCoord));color=applyGamma(color,uColorGamma);color=applyColorMatrix(color,uColorMatrix,uColorOffset);color*=a;if(uColorVignette!=0.0){vec2 pos=gl_FragCoord.xy-offset;color=applyVignette(color,pos,center-offset,uColorVignette);}color=blendPremultipliedAlpha(color,texture(uTextureOverlay,vTexCoord));if(overlayColorAlpha<=0.0){color*=1.0-uOverlayColor.a;}color*=uOpacity;fragColor=color;}`,["aPosition","aTexCoord"],["uMatrix","uTexture","uTextureBlend","uTextureOverlay","uTextureSize","uColorGamma","uColorVignette","uColorOffset","uColorMatrix","uClarityKernel","uClarityKernelWeight","uOpacity","uMaskOpacity","uMaskBounds","uMaskCornerRadius","uMaskFeather","uOverlayColor","uAntialias"]),at=y.createBuffer(),U=y.createBuffer();y.bindBuffer(y.ARRAY_BUFFER,U),y.bufferData(y.ARRAY_BUFFER,Cc,y.STATIC_DRAW);const yt=y.createBuffer();y.bindBuffer(y.ARRAY_BUFFER,yt),y.bufferData(y.ARRAY_BUFFER,zv,y.STATIC_DRAW);const $t=yc(y,`#version 300 es

in vec4 aPosition;in vec2 aNormal;in float aMiter;out vec2 vNormal;out float vMiter;out float vWidth;uniform float uWidth;uniform float uSharpness;uniform mat4 uMatrix;void main(){vMiter=aMiter;vNormal=aNormal;vWidth=(uWidth*.5)+uSharpness;gl_Position=uMatrix*vec4(aPosition.x+(aNormal.x*vWidth*aMiter),aPosition.y+(aNormal.y*vWidth*aMiter),0,1);}`,`
##head
##mask
in vec2 vNormal;in float vMiter;in float vWidth;uniform float uWidth;uniform vec4 uColor;uniform vec4 uCanvasColor;void main(){vec4 fillColor=uColor;float m=mask(gl_FragCoord.x,gl_FragCoord.y,uMaskBounds,uMaskOpacity);if(m<=0.0)discard;fillColor.a*=clamp(smoothstep(vWidth-.5,vWidth-1.0,abs(vMiter)*vWidth),0.0,1.0);fillColor.rgb*=fillColor.a;fillColor.rgb*=m;fillColor.rgb+=(1.0-m)*(uCanvasColor.rgb*fillColor.a);fragColor=fillColor;}`,["aPosition","aNormal","aMiter"],["uColor","uCanvasColor","uMatrix","uWidth","uSharpness","uMaskBounds","uMaskOpacity"]),Mt=y.createBuffer();Gh()&&(y.bindBuffer(y.ARRAY_BUFFER,Mt),y.bufferData(y.ARRAY_BUFFER,1,y.DYNAMIC_DRAW));const dt=(ut,Xt,ce,te=!1)=>{const{program:ve,locations:me}=$t;y.useProgram(ve),y.enableVertexAttribArray(me.aPosition),y.enableVertexAttribArray(me.aNormal),y.enableVertexAttribArray(me.aMiter);const V=((_t,ze)=>{let Ie,Fe,hi,bt=0;const ne=_t.length,Ue=new Float32Array(10*(ze?ne+1:ne)),Ee=_t[0],jt=_t[ne-1];for(bt=0;bt<ne;bt++)Ie=_t[bt-1],Fe=_t[bt],hi=_t[bt+1],Ie||(Ie=ze?jt:rt(Fe.x+(Fe.x-hi.x),Fe.y+(Fe.y-hi.y))),hi||(hi=ze?Ee:rt(Fe.x+(Fe.x-Ie.x),Fe.y+(Fe.y-Ie.y))),h$(Ue,10*bt,Ie,Fe,hi);return ze&&h$(Ue,10*ne,jt,Ee,_t[1]),Ue})(ut,te),Ce=5*Float32Array.BYTES_PER_ELEMENT,yi=2*Float32Array.BYTES_PER_ELEMENT,xe=4*Float32Array.BYTES_PER_ELEMENT;y.uniform1f(me.uWidth,Xt),y.uniform1f(me.uSharpness,l),y.uniform4fv(me.uColor,ce),y.uniformMatrix4fv(me.uMatrix,!1,u),y.uniform4f(me.uCanvasColor,C,P,R,W),y.uniform1fv(me.uMaskBounds,x),y.uniform1f(me.uMaskOpacity,f),y.bindBuffer(y.ARRAY_BUFFER,Mt),y.bufferData(y.ARRAY_BUFFER,V,y.STATIC_DRAW),y.vertexAttribPointer(me.aPosition,2,y.FLOAT,!1,Ce,0),y.vertexAttribPointer(me.aNormal,2,y.FLOAT,!1,Ce,yi),y.vertexAttribPointer(me.aMiter,1,y.FLOAT,!1,Ce,xe),y.drawArrays(y.TRIANGLE_STRIP,0,V.length/5),y.disableVertexAttribArray(me.aPosition),y.disableVertexAttribArray(me.aNormal),y.disableVertexAttribArray(me.aMiter)},Tt=yc(y,`
##head
void main(){
##matrix
}`,`
##head
##mask
uniform vec4 uColor;uniform vec4 uCanvasColor;void main(){vec4 fillColor=uColor;
##maskapply
fillColor.rgb*=fillColor.a;fillColor.rgb*=m;fillColor.rgb+=(1.0-m)*(uCanvasColor.rgb*fillColor.a);fragColor=fillColor;}`,["aPosition"],["uColor","uCanvasColor","uMatrix","uMaskBounds","uMaskOpacity"]),K=y.createBuffer(),q=yc(y,`
##head
##text
in vec2 aRectCoord;out vec2 vRectCoord;void main(){vTexCoord=aTexCoord;vRectCoord=aRectCoord;
##matrix
}`,`
##head
##mask
in vec2 vTexCoord;in vec2 vRectCoord;uniform sampler2D uTexture;uniform vec4 uTextureColor;uniform float uTextureOpacity;uniform vec2 uRepeat;uniform vec4 uColor;uniform float uCornerRadius[4];uniform vec2 uSize;uniform vec2 uPosition;uniform vec4 uCanvasColor;uniform int uInverted;uniform float uEdgeFeather;void main(){
##init
##colorize
##rectaa
##cornerradius
##maskfeatherapply
if(uInverted==1)a=1.0-a;
##maskapply
##fragcolor
}`,["aPosition","aTexCoord","aRectCoord"],["uTexture","uColor","uMatrix","uCanvasColor","uTextureColor","uTextureOpacity","uRepeat","uPosition","uSize","uMaskBounds","uMaskOpacity","uMaskFeather","uCornerRadius","uInverted","uEdgeFeather"]),Z=y.createBuffer(),xt=y.createBuffer(),it=y.createBuffer(),mt=yc(y,`
##head
##text
out vec2 vTexCoordDouble;void main(){vTexCoordDouble=vec2(aTexCoord.x*2.0-1.0,aTexCoord.y*2.0-1.0);vTexCoord=aTexCoord;
##matrix
}`,`
##head
##mask
in vec2 vTexCoord;in vec2 vTexCoordDouble;uniform sampler2D uTexture;uniform float uTextureOpacity;uniform vec2 uRepeat;uniform vec2 uRadius;uniform vec4 uColor;uniform int uInverted;uniform vec4 uCanvasColor;void main(){
##init
float ar=uRadius.x/uRadius.y;vec2 rAA=vec2(uRadius.x-1.0,uRadius.y-(1.0/ar));vec2 scaledPointSq=vec2((vTexCoordDouble.x*uRadius.x)*(vTexCoordDouble.x*uRadius.x),(vTexCoordDouble.y*uRadius.y)*(vTexCoordDouble.y*uRadius.y));float p=(scaledPointSq.x/(uRadius.x*uRadius.x))+(scaledPointSq.y/(uRadius.y*uRadius.y));float pAA=(scaledPointSq.x/(rAA.x*rAA.x))+(scaledPointSq.y/(rAA.y*rAA.y));a=smoothstep(1.0,p/pAA,p);if(uInverted==1)a=1.0-a;
##maskapply
##fragcolor
}`,["aPosition","aTexCoord"],["uTexture","uTextureOpacity","uRepeat","uColor","uCanvasColor","uMatrix","uRadius","uInverted","uMaskBounds","uMaskOpacity"]),Ft=y.createBuffer(),ie=y.createBuffer(),Dt=new Map,Ot={2:{width:0,height:0},1:{width:0,height:0}},ae=(ut,Xt,ce,te=1)=>{const ve=Math.min(Math.min(4096,o)/ce.width,Math.min(4096,o)/ce.height,te),me=Math.floor(ve*ce.width),V=Math.floor(ve*ce.height);zc(ce,Ot[ut])?y.bindFramebuffer(y.FRAMEBUFFER,Xt):(y.bindTexture(y.TEXTURE_2D,T.get(ut)),y.texImage2D(y.TEXTURE_2D,0,y.RGBA,me,V,0,y.RGBA,y.UNSIGNED_BYTE,null),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MIN_FILTER,y.LINEAR),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_S,y.CLAMP_TO_EDGE),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_T,y.CLAMP_TO_EDGE),y.bindFramebuffer(y.FRAMEBUFFER,Xt),y.framebufferTexture2D(y.FRAMEBUFFER,y.COLOR_ATTACHMENT0,y.TEXTURE_2D,T.get(ut),0),Ot[ut]=ce);const Ce=ce.width*s,yi=ce.height*s;var xe,_t;Tp(d,0,Ce,yi,0,-1,1),Ks(d,0,yi,0),_t=1,(xe=d)[0]*=_t,xe[1]*=_t,xe[2]*=_t,xe[3]*=_t,((ze,Ie)=>{ze[4]*=Ie,ze[5]*=Ie,ze[6]*=Ie,ze[7]*=Ie})(d,-1),u=d,y.viewport(0,0,me,V),y.colorMask(!0,!0,!0,!0),y.clearColor(0,0,0,0),y.clear(y.COLOR_BUFFER_BIT),w=[1,0,1,0,1,Math.max(n.width,ce.width),1,Math.max(n.width,ce.width)]},G=(ut,Xt)=>{const{forceRelease:ce=!1}=Xt||{},{src:te}=Dt.get(ut);te instanceof HTMLCanvasElement&&(ce||te.dataset.retain||qn(te)),Dt.delete(ut),y.deleteTexture(ut)},wt=ut=>Dt.get(ut).isRotatedVideo;return{drawPath:(ut,Xt=0,ce=!1,te=!1,ve,me,V,Ce,yi)=>{if(ut.length<2)return;const xe=ut.map(Fe=>({x:Fe.x*s,y:Fe.y*s})),_t=ve*s;if(_t>0&&dt(xe,_t,qs(me,yi),V),xe.length<3||!Ce||Ce[3]===0||!V)return;const ze=Lv(xe),Ie=new Float32Array(6*ze.length);ze.forEach(([Fe,hi,bt],ne)=>{const Ue=6*ne;Ie[Ue+0]=Fe.x,Ie[Ue+1]=Fe.y,Ie[Ue+2]=hi.x,Ie[Ue+3]=hi.y,Ie[Ue+4]=bt.x,Ie[Ue+5]=bt.y}),((Fe,hi)=>{const{program:bt,locations:ne}=Tt;y.useProgram(bt),y.enableVertexAttribArray(ne.aPosition),y.uniform4fv(ne.uColor,hi),y.uniformMatrix4fv(ne.uMatrix,!1,u),y.uniform1fv(ne.uMaskBounds,x),y.uniform1f(ne.uMaskOpacity,f),y.uniform4f(ne.uCanvasColor,C,P,R,W),y.bindBuffer(y.ARRAY_BUFFER,K),y.bufferData(y.ARRAY_BUFFER,Fe,y.STATIC_DRAW),y.vertexAttribPointer(ne.aPosition,2,y.FLOAT,!1,0,0),y.drawArrays(y.TRIANGLES,0,Fe.length/2),y.disableVertexAttribArray(ne.aPosition)})(Ie,qs(Ce,yi))},drawRect:(ut,Xt=0,ce=!1,te=!1,ve,me,V,Ce,yi,xe=!1,_t,ze,Ie,Fe,hi,bt=1/s,ne,Ue)=>{const Ee=Cs(ki(ut),s),jt=ve.map(Ge=>((Qe,mi)=>Math.floor(Ji(Qe,0,Math.min(.5*(mi.width-1),.5*(mi.height-1)))))(Ge||0,ut)).map(Ge=>Ge*s);if(me||V){const Ge=ki(Ee);Ge.x-=.5,Ge.y-=.5,Ge.width+=1,Ge.height+=1;const Qe=$$(Ge,Xt,ce,te),mi=m$(Qe);let $i;ne&&($i=qs(ne),$i[3]===0&&($i[3]=.001));const Li=Ce&&xe?[Ge.width/Ce.width,Ge.height/Ce.height]:[1,1];((X,Ut,H,Bt,be,se=_,At,re=1,Me=Pp,De=Cc,_e=w,Ze=1,nt)=>{const{program:Qt,locations:Zt}=q;y.useProgram(Qt),y.enableVertexAttribArray(Zt.aPosition),y.enableVertexAttribArray(Zt.aTexCoord),y.enableVertexAttribArray(Zt.aRectCoord),y.uniform4fv(Zt.uColor,be),y.uniform2fv(Zt.uSize,[Ut,H]),y.uniform2fv(Zt.uPosition,[X[2],X[3]]),y.uniform2fv(Zt.uRepeat,At),y.uniform1i(Zt.uInverted,nt?1:0),y.uniform1fv(Zt.uCornerRadius,Bt),y.uniform4f(Zt.uCanvasColor,C,P,R,W),y.uniform1fv(Zt.uMaskFeather,_e.map((Kt,Yt)=>Yt%2==0?Kt:Kt*s)),y.uniform1fv(Zt.uMaskBounds,x),y.uniform1f(Zt.uMaskOpacity,f),y.uniform1f(Zt.uEdgeFeather,Math.max(0,Ze)),y.uniformMatrix4fv(Zt.uMatrix,!1,u),y.uniform1i(Zt.uTexture,4),y.uniform4fv(Zt.uTextureColor,Me),y.uniform1f(Zt.uTextureOpacity,re),y.activeTexture(y.TEXTURE0+4),y.bindTexture(y.TEXTURE_2D,se),y.bindBuffer(y.ARRAY_BUFFER,xt),y.bufferData(y.ARRAY_BUFFER,De,y.STATIC_DRAW),y.vertexAttribPointer(Zt.aTexCoord,2,y.FLOAT,!1,0,0),y.bindBuffer(y.ARRAY_BUFFER,it),y.bufferData(y.ARRAY_BUFFER,Cc,y.STATIC_DRAW),y.vertexAttribPointer(Zt.aRectCoord,2,y.FLOAT,!1,0,0),y.bindBuffer(y.ARRAY_BUFFER,Z),y.bufferData(y.ARRAY_BUFFER,X,y.STATIC_DRAW),y.vertexAttribPointer(Zt.aPosition,2,y.FLOAT,!1,0,0),y.drawArrays(y.TRIANGLE_STRIP,0,X.length/2),y.disableVertexAttribArray(Zt.aPosition),y.disableVertexAttribArray(Zt.aTexCoord),y.disableVertexAttribArray(Zt.aRectCoord)})(mi,Ge.width,Ge.height,jt,qs(me,Fe),V,Li,Fe,$i,_t?new Float32Array(_t):f$(Ge.width,Ge.height,Ce,yi,s),hi,bt*s,Ue)}ze&&(ze=Math.min(ze,Ee.width,Ee.height),dt(((Ge,Qe,mi,$i,Li,X,Ut,H)=>{const Bt=[];if(X.every(be=>be===0))Bt.push(rt(Ge,Qe),rt(Ge+mi,Qe),rt(Ge+mi,Qe+$i),rt(Ge,Qe+$i));else{const[be,se,At,re]=X,Me=Ge,De=Ge+mi,_e=Qe,Ze=Qe+$i;Bt.push(rt(Me+be,_e)),Hd(Bt,De-se,_e+se,se,-1),Bt.push(rt(De,_e+se)),Hd(Bt,De-re,Ze-re,re,0),Bt.push(rt(De-re,Ze)),Hd(Bt,Me+At,Ze-At,At,1),Bt.push(rt(Me,Ze-At)),Hd(Bt,Me+be,_e+be,be,2)}return(Ut||H)&&Al(Bt,Ut,H,Ge+.5*mi,Qe+.5*$i),Li&&nl(Bt,Li,Ge+.5*mi,Qe+.5*$i),Bt})(Ee.x,Ee.y,Ee.width,Ee.height,Xt,jt,ce,te),ze*s,qs(Ie,Fe),!0))},drawEllipse:(ut,Xt,ce,te,ve,me,V,Ce,yi,xe,_t,ze,Ie,Fe,hi)=>{const bt=Cs(An(ut.x-Xt,ut.y-ce,2*Xt,2*ce),s);if(V||Ce){const ne=ki(bt);ne.x-=.5,ne.y-=.5,ne.width+=1,ne.height+=1;const Ue=$$(ne,te,ve,me);((Ee,jt,Ge,Qe,mi=_,$i=Cc,Li=1,X=!1)=>{const{program:Ut,locations:H}=mt;y.useProgram(Ut),y.enableVertexAttribArray(H.aPosition),y.enableVertexAttribArray(H.aTexCoord),y.uniformMatrix4fv(H.uMatrix,!1,u),y.uniform2fv(H.uRadius,[.5*jt,.5*Ge]),y.uniform1i(H.uInverted,X?1:0),y.uniform4fv(H.uColor,Qe),y.uniform4f(H.uCanvasColor,C,P,R,W),y.uniform2fv(H.uRepeat,[1,1]),y.uniform1fv(H.uMaskBounds,x),y.uniform1f(H.uMaskOpacity,f),y.uniform1i(H.uTexture,4),y.uniform1f(H.uTextureOpacity,Li),y.activeTexture(y.TEXTURE0+4),y.bindTexture(y.TEXTURE_2D,mi),y.bindBuffer(y.ARRAY_BUFFER,ie),y.bufferData(y.ARRAY_BUFFER,$i,y.STATIC_DRAW),y.vertexAttribPointer(H.aTexCoord,2,y.FLOAT,!1,0,0),y.bindBuffer(y.ARRAY_BUFFER,Ft),y.bufferData(y.ARRAY_BUFFER,Ee,y.STATIC_DRAW),y.vertexAttribPointer(H.aPosition,2,y.FLOAT,!1,0,0),y.drawArrays(y.TRIANGLE_STRIP,0,Ee.length/2),y.disableVertexAttribArray(H.aPosition),y.disableVertexAttribArray(H.aTexCoord)})(m$(Ue),ne.width,ne.height,qs(V,Fe),Ce,_t?new Float32Array(_t):f$(ne.width,ne.height,yi,xe,s),Fe,hi)}ze&&dt(((ne,Ue,Ee,jt,Ge,Qe,mi)=>{const $i=.5*Math.abs(Ee),Li=.5*Math.abs(jt),X=Math.abs(Ee)+Math.abs(jt),Ut=Math.max(20,Math.round(X/6));return uu(rt(ne+$i,Ue+Li),$i,Li,Ge,Qe,mi,Ut)})(bt.x,bt.y,bt.width,bt.height,te,ve,me),ze*s,qs(Ie,Fe),!0)},drawImage:(ut,Xt,ce,te,ve,me,V,Ce,yi,xe,_t=Dv,ze=1,Ie,Fe=1,hi=0,bt=k,ne=Bv,Ue=Pp,Ee=!1,jt=!1,Ge=!0)=>{const Qe=Xt.width*s,mi=Xt.height*s,$i=-.5*Qe,Li=.5*mi,X=.5*Qe,Ut=-.5*mi,H=new Float32Array([$i,Ut,0,$i,Li,0,X,Ut,0,X,Li,0]);y.bindBuffer(y.ARRAY_BUFFER,at),y.bufferData(y.ARRAY_BUFFER,H,y.STATIC_DRAW);const Bt=Xt.height/2/B*(n.height/Xt.height)*-1;ve*=s,me*=s,ce*=s,te*=s;const{program:be,locations:se}=ht,At=Cp();((Qt,Zt,Kt,Yt,st)=>{const le=1/Math.tan(Zt/2),ee=1/(Yt-st);Qt[0]=le/Kt,Qt[1]=0,Qt[2]=0,Qt[3]=0,Qt[4]=0,Qt[5]=le,Qt[6]=0,Qt[7]=0,Qt[8]=0,Qt[9]=0,Qt[10]=(st+Yt)*ee,Qt[11]=-1,Qt[12]=0,Qt[13]=0,Qt[14]=2*st*Yt*ee,Qt[15]=0})(At,D,a,1,2*-Bt),Ks(At,ve,-me,Bt),Ks(At,ce,-te,0),p$(At,-yi),c$(At,xe),Ks(At,-ce,te,0),u$(At,Ce),d$(At,V),y.useProgram(be),y.enableVertexAttribArray(se.aPosition),y.enableVertexAttribArray(se.aTexCoord),y.uniform1i(se.uTexture,3),y.uniform2f(se.uTextureSize,Xt.width,Xt.height),y.activeTexture(y.TEXTURE0+3),y.bindTexture(y.TEXTURE_2D,ut);const re=jt?1:0,Me=T.get(re);y.uniform1i(se.uTextureBlend,re),y.activeTexture(y.TEXTURE0+re),y.bindTexture(y.TEXTURE_2D,Me);const De=Ee?2:0,_e=T.get(De);y.uniform1i(se.uTextureOverlay,De),y.activeTexture(y.TEXTURE0+De),y.bindTexture(y.TEXTURE_2D,_e),y.bindBuffer(y.ARRAY_BUFFER,at),y.vertexAttribPointer(se.aPosition,3,y.FLOAT,!1,0,0);const Ze=Fv&&wt(ut);let nt;y.bindBuffer(y.ARRAY_BUFFER,Ze?yt:U),y.vertexAttribPointer(se.aTexCoord,2,y.FLOAT,!1,0,0),y.uniformMatrix4fv(se.uMatrix,!1,At),y.uniform4fv(se.uOverlayColor,Ue),!Ie||as(Ie,g$)?(Ie=g$,nt=-1):(nt=Ie.reduce((Qt,Zt)=>Qt+Zt,0),nt=nt<=0?1:nt),y.uniform1fv(se.uClarityKernel,Ie),y.uniform1f(se.uClarityKernelWeight,nt),y.uniform1f(se.uColorGamma,1/Fe),y.uniform1f(se.uColorVignette,hi),y.uniform1i(se.uAntialias,Ge?1:0),y.uniform4f(se.uColorOffset,_t[4],_t[9],_t[14],_t[19]),y.uniformMatrix4fv(se.uColorMatrix,!1,[_t[0],_t[1],_t[2],_t[3],_t[5],_t[6],_t[7],_t[8],_t[10],_t[11],_t[12],_t[13],_t[15],_t[16],_t[17],_t[18]]),y.uniform1f(se.uOpacity,ze),y.uniform1f(se.uMaskOpacity,f),y.uniform1fv(se.uMaskBounds,x),y.uniform1fv(se.uMaskCornerRadius,ne.map(Qt=>Qt*s)),y.uniform1fv(se.uMaskFeather,bt.map((Qt,Zt)=>Zt%2==0?Qt:Qt*s)),y.drawArrays(y.TRIANGLE_STRIP,0,4),y.disableVertexAttribArray(se.aPosition),y.disableVertexAttribArray(se.aTexCoord)},textureFilterNearest:y.NEAREST,textureFilterLinear:y.LINEAR,textureClamp:y.CLAMP_TO_EDGE,textureRepeat:y.REPEAT,textureCreate:()=>y.createTexture(),textureUpdate:(ut,Xt,ce)=>(Dt.set(ut,{src:Xt,options:ce,isRotatedVideo:Xt.nodeName==="VIDEO"&&(Xt.dataset&&Xt.dataset.rotation==90||Xt.dataset.rotation==270)}),Iv(y,ut,Xt,ce)),textureGetSize:ut=>{const{src:Xt,options:ce}=Dt.get(ut),te=Da(Xt);return ce.scalar?ns(te,ve=>ve/ce.scalar):te},textureDelete:G,enablePreviewStencil:()=>{y.stencilOp(y.KEEP,y.KEEP,y.REPLACE),y.stencilFunc(y.ALWAYS,1,255),y.stencilMask(255)},applyPreviewStencil:()=>{y.stencilFunc(y.EQUAL,1,255),y.stencilMask(0)},disablePreviewStencil:F,setCanvasColor(ut){C=ut[0],P=ut[1],R=ut[2],W=i?ut[3]:1,y.clear(y.COLOR_BUFFER_BIT)},resetCanvasMatrix:()=>{Tp(c,0,n.width,n.height,0,-1,1)},updateCanvasMatrix(ut,Xt,ce,te,ve){const me=ut.width,V=ut.height,Ce=n.width*(.5/s),yi=n.height*(.5/s),xe={x:Ce+(ce.x+Xt.x),y:yi+(ce.y+Xt.y)},_t={x:xe.x-Xt.x,y:xe.y-Xt.y},ze=.5*me,Ie=.5*V;Xr(_t,ve.z,xe),ib(_t,te,xe),Ks(c,(_t.x-ze)*s,(_t.y-Ie)*s,0),Ks(c,ze*s,Ie*s,0),p$(c,ve.z);const Fe=ve.x>Math.PI/2;d$(c,Fe?Math.PI:0);const hi=ve.y>Math.PI/2;u$(c,hi?Math.PI:0),c$(c,te),Ks(c,-ze*s,-Ie*s,0)},drawToCanvas(){y.bindFramebuffer(y.FRAMEBUFFER,null),u=c,y.viewport(0,0,y.drawingBufferWidth,y.drawingBufferHeight),y.colorMask(!0,!0,!0,!0),y.clearColor(C,P,R,W),y.clear(y.COLOR_BUFFER_BIT),w=[1,0,1,0,1,n.width,1,n.width]},drawToImageBlendBuffer(ut,Xt){ae(1,Q,ut,Xt)},drawToImageOverlayBuffer(ut,Xt){ae(2,S,ut,Xt)},enableMask(ut,Xt){const ce=ut.x*s,te=ut.y*s,ve=ut.width*s,me=ut.height*s;m=ce,h=m+ve,p=n.height-te,g=n.height-(te+me),f=1-Xt,x=[p,h,g,m]},disableMask(){m=0,h=n.width,p=n.height,g=0,f=1,x=[p,h,g,m]},resize:(ut,Xt,ce)=>{s=Math.max(1,ce),l=s===1?.75:1,r.width=ut,r.height=Xt,n.width=ut*s,n.height=Xt*s,a=Jo(n.width,n.height),t.width=n.width,t.height=n.height,Tp(c,0,n.width,n.height,0,-1,1),k=[1,0,1,0,1,r.width,1,r.width]},release(){Array.from(Dt.keys()).forEach(ut=>G(ut,{forceRelease:!0})),Dt.clear(),T.forEach(ut=>{y.deleteTexture(ut)}),T.clear(),ht.destroy(),$t.destroy(),Tt.destroy(),q.destroy(),mt.destroy(),t.width=1,t.height=1,t=void 0}}},Wv=(t,e)=>{const{imageData:i,amount:n=1}=t,r=Math.round(2*Math.max(1,n)),o=Math.round(.5*r),a=i.width,s=i.height,l=new Uint8ClampedArray(a*s*4),c=i.data;let d,u,p,h,g,m=0,f=0,x=0;const k=a*s*4-4;for(p=0;p<s;p++)for(d=crypto.getRandomValues(new Uint8ClampedArray(s)),u=0;u<a;u++)h=d[p]/255,f=0,x=0,h<.5&&(f=4*(-o+Math.round(Math.random()*r))),h>.5&&(x=(-o+Math.round(Math.random()*r))*(4*a)),g=Math.min(Math.max(0,m+f+x),k),l[m]=c[g],l[m+1]=c[g+1],l[m+2]=c[g+2],l[m+3]=c[g+3],m+=4;e(null,{data:l,width:i.width,height:i.height})};const _v=[.0625,.125,.0625,.125,.25,.125,.0625,.125,.0625];function Vv(t){return Math.sqrt(1- --t*t)}function y$(t){return Object.prototype.toString.call(t)==="[object Date]"}function nh(t,e){if(t===e||t!=t)return()=>t;const i=typeof t;if(i!==typeof e||Array.isArray(t)!==Array.isArray(e))throw new Error("Cannot interpolate values of different type");if(Array.isArray(t)){const n=e.map((r,o)=>nh(t[o],r));return r=>n.map(o=>o(r))}if(i==="object"){if(!t||!e)throw new Error("Object cannot be null");if(y$(t)&&y$(e)){t=t.getTime();const o=(e=e.getTime())-t;return a=>new Date(t+a*o)}const n=Object.keys(e),r={};return n.forEach(o=>{r[o]=nh(t[o],e[o])}),o=>{const a={};return n.forEach(s=>{a[s]=r[s](o)}),a}}if(i==="number"){const n=e-t;return r=>t+r*n}throw new Error(`Cannot interpolate ${i} values`)}function Zh(t,e={}){const i=pe(t);let n,r=t;function o(a,s){if(t==null)return i.set(t=a),Promise.resolve();r=a;let l=n,c=!1,{delay:d=0,duration:u=400,easing:p=Bh,interpolate:h=nh}=In(In({},e),s);if(u===0)return l&&(l.abort(),l=null),i.set(t=r),Promise.resolve();const g=Vy()+d;let m;return n=Wh(f=>{if(f<g)return!0;c||(m=h(t,a),typeof u=="function"&&(u=u(t,a)),c=!0),l&&(l.abort(),l=null);const x=f-g;return x>u?(i.set(t=a),!1):(i.set(t=m(p(x/u))),!0)}),n.promise}return{set:o,update:(a,s)=>o(a(r,t),s),subscribe:i.subscribe}}function rh(t,e,i,n){if(typeof i=="number"){const r=n-i,o=(i-e)/(t.dt||1/60),a=(o+(t.opts.stiffness*r-t.opts.damping*o)*t.inv_mass)*t.dt;return Math.abs(a)<t.opts.precision&&Math.abs(r)<t.opts.precision?n:(t.settled=!1,i+a)}if(Ln(i))return i.map((r,o)=>rh(t,e[o],i[o],n[o]));if(typeof i=="object"){const r={};for(const o in i)r[o]=rh(t,e[o],i[o],n[o]);return r}throw new Error(`Cannot spring ${typeof i} values`)}function ci(t,e={}){const i=pe(t),{stiffness:n=.15,damping:r=.8,precision:o=.01}=e;let a,s,l,c=t,d=t,u=1,p=0,h=!1;function g(f,x={}){d=f;const k=l={};if(t==null||x.hard||m.stiffness>=1&&m.damping>=1)return h=!0,a=null,c=f,i.set(t=d),Promise.resolve();if(x.soft&&(p=1/(60*(x.soft===!0?.5:+x.soft)),u=0),!s){a=null,h=!1;const w={inv_mass:void 0,opts:m,settled:!0,dt:void 0};s=Wh(C=>{if(a===null&&(a=C),h)return h=!1,s=null,!1;u=Math.min(u+p,1),w.inv_mass=u,w.opts=m,w.settled=!0,w.dt=60*(C-a)/1e3;const P=rh(w,c,t,d);return a=C,c=t,i.set(t=P),w.settled&&(s=null),!w.settled})}return new Promise(w=>{s.promise.then(()=>{k===l&&w()})})}const m={set:g,update:(f,x)=>g(f(d,t),x),subscribe:i.subscribe,stiffness:n,damping:r,precision:o};return m}var Nv=Rl(!1,t=>{const e=window.matchMedia("(prefers-reduced-motion:reduce)"),i=()=>t(e.matches);return i(),e.addListener(i),()=>e.removeListener(i)}),x$=()=>"ResizeObserver"in window;const Rp=ks(),g2=(t,e,i,n,r)=>{t.rect||(t.rect=ks());const o=t.rect;ry(Rp,e,i,n,r),ea(o,Rp)||(ku(o,Rp),t.dispatchEvent(new CustomEvent("measure",{detail:o})))},Ud=Math.round,Hv=t=>{const e=t.getBoundingClientRect();ya&&g2(t,Ud(e.x),Ud(e.y),Ud(e.width),Ud(e.height))},Ip=t=>{ya&&g2(t,t.offsetLeft,t.offsetTop,t.offsetWidth,t.offsetHeight)},Ec=[];let Js,fa,ya;function oh(){Ec.length?(Ec.forEach(t=>t.measure(t)),ya=requestAnimationFrame(oh)):ya=void 0}let Gd=new Map([]),xc=0,Ep=0;var dr=(t,e={})=>{const{observePosition:i=!1,observeViewRect:n=!1,once:r=!1,disabled:o=!1,isMeasureRoot:a=!1}=e;if(x$()&&a&&(fa||(fa=new ResizeObserver(s=>{s.forEach(c=>{Gd.set(c.target,c.contentRect)});const l=Array.from(Gd.values()).some(({width:c,height:d})=>c>0&&d>0);l?l&&ya===!1&&oh():(ya&&cancelAnimationFrame(ya),ya=!1)})),fa.observe(t),xc++),!o)return!x$()||i||n?(t.measure=n?Hv:Ip,Ec.push(t),ya===void 0&&(ya=requestAnimationFrame(oh)),t.measure(t),{destroy(){a&&fa&&(Gd.delete(t),fa.unobserve(t),xc--,xc===0&&(fa.disconnect(),fa=void 0));const s=Ec.indexOf(t);Ec.splice(s,1),delete t.measure}}):(Js||(Js=new ResizeObserver(s=>{s.forEach(l=>{ya&&Ip(l.target)})})),Js.observe(t),Ip(t),r?Js.unobserve(t):Ep++,{destroy(){a&&fa&&(Gd.delete(t),fa.unobserve(t),xc--,xc===0&&(fa.disconnect(),fa=void 0)),r||(Js.unobserve(t),Ep--,Ep===0&&(Js.disconnect(),Js=void 0))}})},jv=t=>{let e=!1;const i={pointerdown:()=>{e=!1},keydown:()=>{e=!0},keyup:()=>{e=!1},focus:n=>{e&&(n.target.dataset.focusVisible="")},blur:n=>{delete n.target.dataset.focusVisible}};return Object.keys(i).forEach(n=>t.addEventListener(n,i[n],!0)),{destroy(){Object.keys(i).forEach(n=>t.removeEventListener(n,i[n],!0))}}};const Uv=async t=>new Promise(e=>{if(t.kind==="file")return e(t.getAsFile());t.getAsString(e)});var f2=(t,e={})=>{const i=r=>{r.preventDefault()},n=async r=>{r.preventDefault(),r.stopPropagation();try{const o=await(a=>new Promise((s,l)=>{const{items:c}=a.dataTransfer;if(!c)return s([]);Promise.all(Array.from(c).map(Uv)).then(d=>{s(d.filter(u=>Ol(u)&&Cu(u)||/^http/.test(u)))}).catch(l)}))(r);t.dispatchEvent(new CustomEvent("dropfiles",{detail:{event:r,resources:o},...e}))}catch{}};return t.addEventListener("drop",n),t.addEventListener("dragover",i),{destroy(){t.removeEventListener("drop",n),t.removeEventListener("dragover",i)}}};let Zd=null;var Xh=()=>{if(Zd===null)if(Mr()){const t=vn("canvas");Zd=!Ru(t,{failIfMajorPerformanceCaveat:!0}),qn(t)}else Zd=!1;return Zd},Ap=t=>t instanceof WebGLTexture,b$=([t,e,i,n])=>[n.x,n.y,t.x,t.y,i.x,i.y,e.x,e.y];function Gv(t){let e,i,n,r;return{c(){e=pt("div"),i=pt("canvas"),v(e,"class","PinturaCanvas")},m(o,a){et(o,e,a),kt(e,i),t[36](i),n||(r=[Ct(i,"measure",t[37]),Ui(dr.call(null,i))],n=!0)},p:Ke,i:Ke,o:Ke,d(o){o&&tt(e),t[36](null),n=!1,Bi(r)}}}function Zv(t,e,i){let n,r,o,a,s,l,c;const d=[0,0,0,0],u=rn(),p=Mr()&&(X=>{const Ut=.5*X,H=vn("canvas",{"data-retain":!0,width:X,height:X}),Bt=H.getContext("2d");return Bt.fillStyle="#f0f",Bt.fillRect(0,0,Ut,Ut),Bt.fillRect(Ut,Ut,Ut,Ut),H})(128),h=ka();let g,{isAnimated:m}=e,{isTransparent:f}=e,{maskRect:x}=e,{maskOpacity:k=1}=e,{maskFrameOpacity:w=.95}=e,{maskMarkupOpacity:C=1}=e,{clipAnnotationsToImage:P=!0}=e,{pixelRatio:R=1}=e,{textPixelRatio:W=R}=e,{backgroundColor:T}=e,{willRender:F=Yi}=e,{didRender:D=Yi}=e,{willRequest:B}=e,{loadImageData:y=Yi}=e,{enableGrid:_=!1}=e,{gridColors:J}=e,{gridSize:S}=e,{gridOpacity:j=0}=e,{images:Q=[]}=e,{interfaceImages:ht=[]}=e,{selectionColor:at}=e,U=null,yt=null,$t=null;const Mt=(X,Ut)=>X.set(Ut,{hard:!m}),dt={precision:1e-4*.01};let Tt=0;const K=Zh(void 0,{duration:0});A(t,K,X=>i(35,c=X));const q=ci(1,dt);A(t,q,X=>i(34,s=X));const Z=ci(1,dt);A(t,Z,X=>i(50,o=X));const xt=pe();A(t,xt,X=>i(52,l=X));const it=pe();A(t,it,X=>i(51,a=X));const mt={},Ft=(X,Ut)=>{let H=mt[X.id];const Bt=Math.min(1,2048/Ut.width);let be=H?H.element:vn("canvas",{width:Ut.width*Bt,height:Ut.height*Bt,"data-retain":!0});if(!H||((se,At)=>{if(se.total!==At.length)return!0;const re=se.last,Me=At[At.length-1];return re.drawMode!==Me.drawMode||!(!wo(re)||wo(Me)&&ea(re,Me))||!(!Yn(re)||Yn(Me)&&re.x===Me.x&&re.y===Me.y&&re.rx===Me.rx&&re.ry===Me.ry)||!(!_n(re)||_n(Me)&&Me.points.length===re.points.length)})(H,X.actions)){be=be.cloneNode(),((At,re,Me)=>{const{selectionColor:De=[1,1,1],scalar:_e=1}=Me||{};let Ze=!1;for(const nt of re){const Qt=nt.drawMode==="subtract";if(Qt&&!Ze)continue;At.globalCompositeOperation=Qt?"destination-out":"source-over",At.save(),At.beginPath();const Zt=Ly(nt);fy(At,_e,_e),Mh(At,nt.rotation,Zt),Fy(At,nt.flipX,nt.flipY,Zt),nt.width?Lh(At,{...nt,backgroundColor:De}):nt.points?Qp(At,Object.assign({},nt,nt.pathClose?{backgroundColor:De,strokeColor:[0,0,0,0]}:{strokeColor:De,strokeJoin:"round",strokeCap:"round"})):nt.rx&&zh(At,{...nt,backgroundColor:De,strokeColor:[0,0,0,0],strokeJoin:"round",strokeCap:"round"}),At.restore(),Ze=!0}})(be.getContext("2d"),X.actions,{selectionColor:[1,0,1],scalar:Bt});const se=X.actions.length;mt[X.id]={total:se,last:{...X.actions[se-1]},element:be}}return{x:0,y:0,...Ut,fillColor:X.color||[1,1,1],backgroundImage:be}};let ie;const Dt=()=>{cancelAnimationFrame(ie),ie=requestAnimationFrame(()=>{Fe=!0,$i=0,r()})},Ot=new Map([]),ae=new Map([]),G=(X,Ut)=>({filterParam:X==="pixelated"?U.textureFilterNearest:U.textureFilterLinear,wrapParam:Ut==="repeat"?U.textureRepeat:U.textureClamp}),wt=(X,Ut,H)=>{if(!Ot.has(X)){Ot.set(X,X);const se=G(Ut,H);if(!We(Bt=X)&&($y(Bt)||Fl(Bt)||Uc(Bt)||hu(Bt))){const At=U.textureCreate();U.textureUpdate(At,X,se),Ot.set(X,At)}else y(X).then(At=>{if(!U||!At)return;const re=U.textureCreate();U.textureUpdate(re,At,se),Ot.set(X,re),Dt()}).catch(At=>{Ot.set(X,At)})}var Bt,be;if(hu(X)&&((be=X).currentTime>0&&!be.paused&&!be.ended&&be.readyState>2||X.dataset.redraw==="true")){const se=Ot.get(X),At=G(Ut,H);return U.textureUpdate(se,X,At),X.dataset.redraw=!1,se}return Ot.get(X)},ut=(X,Ut={})=>{const H=Ut.id||X.id;if(!X.text.length)return void ae.delete(H);let{text:Bt,textAlign:be,fontFamily:se,fontSize:At=16,fontWeight:re,fontVariant:Me,fontStyle:De,letterSpacing:_e,lineHeight:Ze=At,width:nt,height:Qt}=X,{outline:Zt=0,blur:Kt=0,paddingTop:Yt=0,paddingRight:st=Yr,paddingBottom:le=0,paddingLeft:ee=Yr}=Ut;nt=di(nt)?Math.floor(nt):nt,Qt=di(Qt)?Math.floor(Qt):Qt;const{textSize:ye,signature:Xe}=((Le="",Gt)=>{let{width:gi=0,height:Ti="auto",fontSize:Ve,fontFamily:ri,lineHeight:Be,fontWeight:Se,fontStyle:Zi,fontVariant:un,letterSpacing:wn}=Gt;const sn=iu({text:Le,fontFamily:ri,fontWeight:Se,fontStyle:Zi,fontVariant:un,fontSize:Ve,lineHeight:Be,letterSpacing:wn,width:gi,height:Ti});let an=Tm.get(sn);if(an)return an;let Mn=1;Ve>1e3&&wa()&&(Mn=Ve/1e3,Ve=1e3,Be*=Mn);const ur=kh(vn("pre",{contenteditable:"true",spellcheck:"false",style:`${wy}${Rh({fontFamily:ri,fontWeight:Se,fontStyle:Zi,fontVariant:un,fontSize:Ve,letterSpacing:wn,lineHeight:Be})};${Ih(Le,Gt)}"`,innerHTML:Le})),ao=ur.getBoundingClientRect();return an={signature:vy(ur).flat().map(fn=>fn.text).join("_;_"),textSize:ns(Da(ao),fn=>Math.ceil(fn*Mn))},Tm.set(sn,an),ur.remove(),an})(Bt,{...X,width:nt,height:void 0}),$e=iu({text:Bt,textAlign:be,fontFamily:se,fontSize:At,fontWeight:re,fontVariant:Me,fontStyle:De,lineHeight:Ze,letterSpacing:_e,outline:Zt,blur:Kt,signature:Xe});if(!Ot.has($e)){Ot.set($e,Bt);const Le=Math.ceil(ye.width),Gt=Math.ceil(ye.height/Ze)*Ze;if(Le===0||Gt===0)return;const gi=Uh(),Ti=Math.min(1,(gi-(ee+st)*W)/(Le*W),(gi-(Yt+le)*W)/(Gt*W));ky(Bt,{fontSize:At,fontFamily:se,fontWeight:re,fontVariant:Me,fontStyle:De,letterSpacing:_e,textAlign:be,lineHeight:Ze,width:nt,height:Qt,imageWidth:Le,imageHeight:Gt,paddingLeft:ee,paddingTop:Yt,paddingRight:st,paddingBottom:le,pixelRatio:W*Ti,willRequest:B,outline:Zt,blur:Kt,color:[1,0,1]}).then(Ve=>{if(!U)return;const ri=U.textureCreate();U.textureUpdate(ri,Ve,{filterParam:U.textureFilterLinear,wrapParam:U.textureClamp,scalar:Ti}),Ot.set($e,ri),ae.set(H,ri),Dt()}).catch(console.error)}const vi=Ot.get($e);return Ap(vi)?vi:ae.get(H)},Xt=new Map,ce=(X,Ut)=>{let H;if(X.backgroundImage)H=wt(X.backgroundImage,X.backgroundImageRendering,X.backgroundRepeat==="repeat"?"repeat":void 0);else if(We(X.text)){if(X.width&&X.width<1||X.height&&X.height<1)return;H=ut(X,Ut)}else X.bitmap&&X.points&&(H=(Bt=>{const{id:be,points:se,strokeWidth:At,strokeCap:re,strokeJoin:Me,strokeColor:De}=Bt;let _e=Ot.get(be),Ze=Xt.get(be);const nt=iu({points:se.map(Xe=>`${Xe.x},${Xe.y}`).join(","),strokeWidth:At,strokeCap:re,strokeJoin:Me,strokeColor:De});if(Ze){const{hash:Xe}=Ze;if(Ot.has(be)){if(nt===Xe)return Ot.get(be)}else Ze=void 0}if(!Ze){const Xe=vn("canvas",{width:1,height:1});Ze={canvas:Xe,hash:void 0},Xt.set(Bt.id,Ze),_e=U.textureCreate(),U.textureUpdate(_e,Xe,{filterParam:U.textureFilterLinear,wrapParam:U.textureClamp}),Ot.set(be,_e)}const{canvas:Qt}=Ze,Zt=Math.ceil(Bt.strokeWidth),Kt=er(se),Yt=Math.floor(Kt.x)-.5*Zt,st=Math.floor(Kt.y)-.5*Zt,le=Math.ceil(Kt.width+Zt),ee=Math.ceil(Kt.height+Zt);Qt.width=Math.max(le,1),Qt.height=Math.max(ee,1);const ye=Qt.getContext("2d");return ye.clearRect(0,0,Qt.width,Qt.height),le>=1&&ee>=1&&(ye.translate(-Yt,-st),Qp(ye,Bt),ye.resetTransform()),U.textureUpdate(_e,Qt,{filterParam:U.textureFilterLinear,wrapParam:U.textureClamp}),Xt.set(be,{canvas:Qt,hash:nt}),Ot.get(be)})(X));return H},te=({texture:X,size:Ut,origin:H,translation:Bt,rotation:be,scale:se,colorMatrix:At,opacity:re,convolutionMatrix:Me,gamma:De,vignette:_e,maskFeather:Ze,maskCornerRadius:nt,overlayColor:Qt,enableOverlay:Zt,enableManipulation:Kt,enableAntialiasing:Yt})=>{let st=0,le=0;if(R===1){const ee=Math.abs(1-se)<Number.EPSILON;st=ee&&yt%2!=0?.5:0,le=ee&&$t%2!=0?.5:0}return U.drawImage(X,Ut,H.x,H.y,Bt.x+st,Bt.y+le,be.x,be.y,be.z,se,At,Ji(re,0,1),Me,De,_e,Ze,nt,Qt,Zt,Kt,Yt),X},ve=(X,Ut,H,Bt,be,se,At,re,Me)=>{const De={...Ut},_e={width:be.width/W*H,height:be.height/W*H},Ze=rt(0,0),nt={width:_e.width,height:_e.height};return De.x-=Me*H,De.y-=se*H,X.width?(De.height=De.height?De.height+se*H/Bt:_e.height,De.width+=(Me+At)*H/Bt,X.textAlign==="center"?Ze.x=.5*(De.width-nt.width/Bt):X.textAlign==="right"&&(Ze.x=De.width-nt.width/Bt)):(De.width=_e.width,De.height=_e.height),{rect:De,backgroundPosition:Ze,backgroundSize:nt}},me=(X=[],Ut)=>{X.forEach(H=>{let Bt=ce(H);const be=H.status!=="complete"&&(H.status==="loading"||H.backgroundImage&&Bt===H.backgroundImage);be&&Dt();const se=H.status==="error"||H.backgroundImage&&Bt instanceof Error;let At=Ap(Bt)?Bt:void 0;const re=H._scale||1,Me=H._translate||u,De=H.strokeWidth&&H.strokeWidth*re,_e=!!H.width,Ze=!_e&&We(H.text)&&At,nt=Ln(H.points),Qt=Yn(H);if(nt){const Zt=H.points.map(Kt=>rt(Kt.x*re+Me.x,Kt.y*re+Me.y));if(H.bitmap){Bt&&Ut.push(Bt);const Kt=er(Zt),Yt=Math.ceil(H.strokeWidth*re);U.drawRect({x:Math.floor(Kt.x)-.5*Yt,y:Math.floor(Kt.y)-.5*Yt,width:Math.ceil(Kt.width+Yt),height:Math.ceil(Kt.height+Yt)},H.rotation,H.flipX,H.flipY,[0,0,0,0],void 0,At,void 0,void 0,void 0,void 0,void 0,void 0,H.opacity,void 0,void 0,!1,!1)}else U.drawPath(Zt,H.rotation,H.flipX,H.flipY,De,H.strokeColor,H.pathClose,H.backgroundColor,H.opacity)}else if(Qt){let Zt=H.x,Kt=H.y;Zt*=re,Kt*=re,Zt+=Me.x,Kt+=Me.y;const Yt=rt(Zt,Kt);U.drawEllipse(Yt,H.rx*re,H.ry*re,H.rotation,H.flipX,H.flipY,H.backgroundColor,At,void 0,void 0,H.backgroundCorners&&b$(H.backgroundCorners),De,H.strokeColor,H.opacity,H.inverted),Bt&&Ut.push(Bt),(be||se)&&(H.backgroundColor||H.strokeColor&&H.strokeWidth||U.drawEllipse(Yt,H.rx*re,H.ry*re,H.rotation,H.flipX,H.flipY,se?[1,0,0,.25*H.opacity]:[0,0,0,.25*H.opacity]),se&&ze(Yt),be&&_t(Yt))}else if(Ze||_e){const Zt=At&&U.textureGetSize(At);let Kt,Yt,st,le=H.fillColor,ee=H.backgroundColor,ye=H.strokeColor,Xe=[H.cornerRadius,H.cornerRadius,H.cornerRadius,H.cornerRadius].map(vi=>vi*re);Kt=H.width?xs(H):{x:H.x,y:H.y,...Zt},re&&Me&&(Kt.x*=re,Kt.y*=re,Kt.x+=Me.x,Kt.y+=Me.y,Kt.width*=re,Kt.height*=re),Bt&&Ut.push(Bt);const{backgroundRepeat:$e="no-repeat"}=H;if(Zt){if(H.backgroundImage&&(H.backgroundSize||H.backgroundPosition||H.backgroundRepeat)){const vi=Jo(Zt.width,Zt.height);if(H.backgroundRepeat==="repeat"&&(Yt={...Zt},st={x:0,y:0}),H.backgroundSize==="contain"){const Le=qr(Kt,vi,Kt);Yt=rl(Le),st=H.backgroundPosition?H.backgroundPosition:rt(.5*(Kt.width-Yt.width),.5*(Kt.height-Yt.height))}else if(H.backgroundSize==="cover"){const Le=os(Kt,vi,Kt);Yt=rl(Le),H.backgroundPosition?st=H.backgroundPosition:(st=rt(Le.x,Le.y),st=rt(.5*(Kt.width-Yt.width),.5*(Kt.height-Yt.height)))}else H.backgroundSize?(Yt=H.backgroundSize,st=H.backgroundPosition||{x:0,y:0}):H.backgroundPosition&&(Yt={...Zt},st=H.backgroundPosition)}else if(H.text){const vi={...Kt};if(H.backgroundColor||H.strokeColor){ee=void 0,ye=void 0;const ri={width:Zt.width/W,height:Zt.height/W},Be=(H.width||ri.width-2*Yr)*re,Se=(H.height||ri.height)*re;U.drawRect({...Kt,width:Be,height:Se},H.rotation,H.flipX,H.flipY,Xe,H.backgroundColor,void 0,void 0,void 0,!1,void 0,De,H.strokeColor,H.opacity,void 0,void 0,void 0,H.inverted)}let Le=1;H.fontSize>1e3&&wa()&&(Le=H.fontSize/1e3),le=H.color||[0,0,0],H._prerender&&(le[3]=0);const Gt=ve(H,vi,re,Le,Zt,0,Yr,0,Yr);Kt=Gt.rect,st=Gt.backgroundPosition,Yt=Gt.backgroundSize;const{textShadowX:gi,textShadowY:Ti,textShadowBlur:Ve}=H;if(gi||Ti||Ve){const ri=Math.ceil(.5*Ve),Be=ri,Se=Math.max(Yr,ri),Zi=ri,un=Math.max(Yr,ri),wn=ce(H,{id:H.id+"shadow",blur:Ve,paddingTop:Be,paddingRight:Se,paddingBottom:Zi,paddingLeft:un});if(wn&&!H._prerender){Ut.push(wn);const sn=U.textureGetSize(wn),{rect:an,backgroundPosition:Mn,backgroundSize:ur}=ve(H,vi,re,Le,sn,Be,Se,0,un),ao=Ci(Kt),fn=Ci(an);fn.x+=gi,fn.y+=Ti;const Rr=Xr(fn,H.rotation,ao),Sn={x:Rr.x-.5*an.width,y:Rr.y-.5*an.height,width:an.width,height:an.height};H.height&&(Sn.height-=Ti),U.drawRect(Sn,H.rotation,H.flipX,H.flipY,[0,0,0,0],void 0,wn,ur,Mn,!1,void 0,void 0,void 0,H.opacity,void 0,0,H.textShadowColor)}}if(H.textOutlineWidth){const ri=Math.ceil(.5*H.textOutlineWidth),Be=ri,Se=Yr+ri,Zi=ri,un=Yr+ri,wn=ce(H,{id:H.id+"outline",outline:H.textOutlineWidth,paddingTop:Be,paddingRight:Se,paddingBottom:Zi,paddingLeft:un});if(wn&&!H._prerender){const sn=U.textureGetSize(wn);Ut.push(wn);const{rect:an,backgroundPosition:Mn,backgroundSize:ur}=ve(H,vi,re,Le,sn,Be,Se,0,un);U.drawRect(an,H.rotation,H.flipX,H.flipY,[0,0,0,0],void 0,wn,ur,Mn,!1,void 0,void 0,void 0,H.opacity,void 0,0,H.textOutlineColor)}}}}if(U.drawRect(Kt,H.rotation,H.flipX,H.flipY,Xe,ee,At,Yt,st,$e==="repeat",H.backgroundCorners&&b$(H.backgroundCorners),De,ye,H.opacity,void 0,H.feather,le,H.inverted),be||se){H.backgroundColor&&H.backgroundColor[3]!==0||H.strokeColor&&H.strokeWidth||U.drawRect(Kt,H.rotation,H.flipX,H.flipY,Xe,se?[1,.2549,.2118,.25*H.opacity]:[0,0,0,.25*H.opacity]);const vi=Ci(Kt);se&&ze(vi),be&&_t(vi)}}else Bt&&Ut.push(Bt)})};let V=0;const Ce=[{x:-5,y:-5},{x:5,y:5}],yi=[{x:5,y:-5},{x:-5,y:5}],xe=uu({x:0,y:0},10,10,0,!1,!1,16);xe.length=9;const _t=X=>{V=Date.now()/50,U.drawEllipse(X,15,15,0,!1,!1,[0,0,0,.5]);const Ut=nl(xe.map(H=>({x:H.x+X.x,y:H.y+X.y})),V,X.x,X.y);U.drawPath(Ut,0,!1,!1,2,[1,1,1])},ze=X=>{U.drawEllipse(X,13,13,0,!1,!1,[1,.2549,.2118,.75]);const Ut=Ce.map(Bt=>({x:Bt.x+X.x,y:Bt.y+X.y})),H=yi.map(Bt=>({x:Bt.x+X.x,y:Bt.y+X.y}));U.drawPath(Ut,0,!1,!1,3,[1,1,1]),U.drawPath(H,0,!1,!1,3,[1,1,1])},Ie=(X,Ut,H,Bt,be,se)=>U.drawRect(Ut,0,!1,!1,d,d,X,Bt,H,!0,void 0,0,void 0,se,void 0,void 0,be);let Fe=!1,hi=!0,bt=!1;const ne=[],Ue=[],Ee=[],jt=X=>!X.aboveFrame,Ge=X=>X.aboveFrame,Qe=()=>{Ee.length=0;const X=Q[0],{manipulationShapes:Ut,manipulationShapesDirty:H,annotationShapes:Bt,annotationShapesDirty:be,interfaceShapes:se,decorationShapes:At,frameShapes:re,selectionShapes:Me}=F({opacity:X.opacity,rotation:X.rotation,scale:X.scale,images:Q,size:jn(yt,$t),backgroundColor:[...c],selectionRect:l}),De=[...c],_e=l,Ze=Ji(s,0,1),nt=a,Qt=Math.abs(X.rotation.x/Math.PI*2-1),Zt=Math.abs(X.rotation.y/Math.PI*2-1),Kt=Qt<.99||Zt<.99,Yt={...X.size},st=X.backgroundColor,le=X.backgroundImage,ee=Ut.length>0,ye=Bt.length>0,Xe=Bt.filter(Ge).length>0,$e=At.filter(Ge).length>0,vi=st[3]>0,Le=!!P&&C>=1;if(Ze<1&&vi){const Gt=De[0],gi=De[1],Ti=De[2],Ve=1-Ze,ri=st[0]*Ve,Be=st[1]*Ve,Se=st[2]*Ve,Zi=1-Ve;De[0]=ri+Gt*Zi,De[1]=Be+gi*Zi,De[2]=Se+Ti*Zi,De[3]=1}if(U.setCanvasColor(f?d:De),ee&&(H||Fe)?(U.disableMask(),U.drawToImageBlendBuffer(Yt),ne.length=0,me(Ut,ne)):ee||(ne.length=0),Ee.push(...ne),hi&&(U.drawToImageOverlayBuffer(Yt,W),hi=!1),Kt){if(ye&&(be||Fe)||!bt){U.disableMask(),U.drawToImageOverlayBuffer(Yt,W),Ue.length=0;const Gt=Xe?Bt.filter(jt):Bt;me(Gt,Ue)}else ye||(Ue.length=0);bt=!0}else bt=!1;if(U.drawToCanvas(),U.enableMask(_e,Ze),_&&S>=1&&J.length===2&&j&&((Gt,gi,Ti,Ve,ri)=>{const Be=jn(gi,gi),Se=wt(p,"pixelated","repeat"),Zi=rt(-Gt.x%gi,-Gt.y%gi),un=rt(Zi.x+.5*Be.width,Zi.y);Ie(Se,Gt,Zi,Be,Ti,ri),Ie(Se,Gt,un,Be,Ve,ri)})(_e,S,J[0],J[1],j),vi&&U.drawRect(_e,0,!1,!1,d,st),le){U.enableMask(_e,1);const Gt=Math.max(x.width/le.width,x.height/le.height),gi=le.width*Gt,Ti=le.height*Gt,Ve={x:x.x+.5*x.width-.5*gi,y:x.y+.5*x.height-.5*Ti,width:gi,height:Ti};U.drawRect(Ve,0,!1,!1,d,d,wt(le,"linear")),U.enableMask(_e,Ze)}if(Le&&U.enablePreviewStencil(),Ee.push(...[...Q].reverse().map(Gt=>te({...Gt,texture:wt(Gt.data),enableOverlay:Kt&&ye,enableManipulation:ee,enableAntialiasing:!0,mask:_e,maskOpacity:Ze,overlayColor:nt}))),U.enableMask(_e,C),!Kt){Le&&U.applyPreviewStencil(),U.resetCanvasMatrix(),U.updateCanvasMatrix(Yt,X.origin,X.translation,X.scale,X.rotation),Ue.length=0;const Gt=Xe?Bt.filter(jt):Bt;me(Gt,Ue),Le&&U.disablePreviewStencil()}if(Ee.push(...Ue),U.resetCanvasMatrix(),U.enableMask(_e,C),me(At,$e?At.filter(jt):At),re.length){U.enableMask(_e,1);const Gt=re.filter(Ti=>!Ti.expandsCanvas),gi=re.filter(Ti=>Ti.expandsCanvas);Gt.length&&me(Gt,Ee),gi.length&&(U.enableMask({x:_e.x+.5,y:_e.y+.5,width:_e.width-1,height:_e.height-1},o),me(gi,Ee))}if(Xe&&(U.resetCanvasMatrix(),U.updateCanvasMatrix(Yt,X.origin,X.translation,X.scale,X.rotation),me(Bt.filter(Ge),Ee),U.resetCanvasMatrix()),$e&&(U.resetCanvasMatrix(),me(At.filter(Ge),Ee),U.resetCanvasMatrix()),at&&Me.length&&!Kt){U.resetCanvasMatrix(),U.updateCanvasMatrix(Yt,X.origin,X.translation,X.scale,X.rotation);const Gt=[...at];Gt[3]=.5;const gi=[{id:"selection",color:Gt,actions:[...Me]}].map(Ti=>Ft(Ti,Yt));me(gi,Ee),U.resetCanvasMatrix()}U.disableMask(),me(se,Ee),ht.forEach(Gt=>{if(U.enableMask(Gt.mask,Gt.maskOpacity),Gt.backgroundColor){const Ti=le&&os({...Gt.mask},le.width/le.height),Ve=le&&wt(le,"linear");U.drawRect(Gt.mask,0,!1,!1,Gt.maskCornerRadius,Gt.backgroundColor,Ve,Ti,Ti,void 0,void 0,void 0,void 0,Gt.opacity,Gt.maskFeather),Ve&&Ee.push(Ve)}const gi=te({...Gt,texture:wt(Gt.data),enableAntialiasing:!1,translation:{x:Gt.translation.x+Gt.offset.x-.5*yt,y:Gt.translation.y+Gt.offset.y-.5*$t}});Ee.push(gi)}),U.disableMask(),(Gt=>{Ot.forEach((gi,Ti)=>{!Gt.find(Ve=>Ve===gi)&&Ap(gi)&&(Array.from(ae.values()).includes(gi)||(Ot.delete(Ti),U.textureDelete(gi)))})})(Ee),D(),Fe=!1};let mi,$i=0;const Li=()=>{clearTimeout(mi);const X=Date.now();X-$i<48?mi=setTimeout(Li,48):($i=X,Qe())};return Xb(()=>r()),Ls(()=>i(30,U=Ov(g,{alpha:f}))),Vo(()=>{U&&(Xt.forEach(({canvas:X})=>qn(X)),Xt.clear(),U.release(),i(30,U=void 0),i(0,g=void 0))}),t.$$set=X=>{"isAnimated"in X&&i(9,m=X.isAnimated),"isTransparent"in X&&i(10,f=X.isTransparent),"maskRect"in X&&i(11,x=X.maskRect),"maskOpacity"in X&&i(12,k=X.maskOpacity),"maskFrameOpacity"in X&&i(13,w=X.maskFrameOpacity),"maskMarkupOpacity"in X&&i(14,C=X.maskMarkupOpacity),"clipAnnotationsToImage"in X&&i(15,P=X.clipAnnotationsToImage),"pixelRatio"in X&&i(16,R=X.pixelRatio),"textPixelRatio"in X&&i(17,W=X.textPixelRatio),"backgroundColor"in X&&i(18,T=X.backgroundColor),"willRender"in X&&i(19,F=X.willRender),"didRender"in X&&i(20,D=X.didRender),"willRequest"in X&&i(21,B=X.willRequest),"loadImageData"in X&&i(22,y=X.loadImageData),"enableGrid"in X&&i(23,_=X.enableGrid),"gridColors"in X&&i(24,J=X.gridColors),"gridSize"in X&&i(25,S=X.gridSize),"gridOpacity"in X&&i(26,j=X.gridOpacity),"images"in X&&i(27,Q=X.images),"interfaceImages"in X&&i(28,ht=X.interfaceImages),"selectionColor"in X&&i(29,at=X.selectionColor)},t.$$.update=()=>{if(1&t.$$.dirty[0]&&g){const X=getComputedStyle(g).getPropertyValue("--color-transition-duration");i(31,Tt=(Ut=>{let H=parseFloat(Ut);return/^[0-9]+s$/.test(Ut)?1e3*H:H})(X))}262656&t.$$.dirty[0]|1&t.$$.dirty[1]&&T&&K.set(T,{duration:m?Tt:0}),4096&t.$$.dirty[0]&&Mt(q,di(k)?k:1),8192&t.$$.dirty[0]&&Mt(Z,di(w)?w:1),2048&t.$$.dirty[0]&&x&&xt.set(x),24&t.$$.dirty[1]&&c&&it.set([c[0],c[1],c[2],Ji(s,0,1)]),1207959558&t.$$.dirty[0]&&i(33,n=!!(U&&yt&&$t&&Q.length)),1073807366&t.$$.dirty[0]&&yt&&$t&&U&&($i=0,U.resize(yt,$t,R)),4&t.$$.dirty[1]&&i(32,r=n?Xh()?Li:Qe:ge),6&t.$$.dirty[1]&&n&&r&&r()},[g,yt,$t,h,K,q,Z,xt,it,m,f,x,k,w,C,P,R,W,T,F,D,B,y,_,J,S,j,Q,ht,at,U,Tt,r,n,s,c,function(X){Ai[X?"unshift":"push"](()=>{g=X,i(0,g)})},X=>{i(1,yt=X.detail.width),i(2,$t=X.detail.height),h("measure",{width:yt,height:$t})}]}class Xv extends li{constructor(e){super(),si(this,e,Zv,Gv,ni,{isAnimated:9,isTransparent:10,maskRect:11,maskOpacity:12,maskFrameOpacity:13,maskMarkupOpacity:14,clipAnnotationsToImage:15,pixelRatio:16,textPixelRatio:17,backgroundColor:18,willRender:19,didRender:20,willRequest:21,loadImageData:22,enableGrid:23,gridColors:24,gridSize:25,gridOpacity:26,images:27,interfaceImages:28,selectionColor:29},null,[-1,-1,-1])}}var pi=(t,e=Boolean,i=" ")=>t.filter(e).join(i);function v$(t,e,i){const n=t.slice();return n[17]=e[i],n}const Yv=t=>({tab:4&t}),w$=t=>({tab:t[17]});function S$(t){let e,i,n,r=[],o=new Map,a=t[2];const s=l=>l[17].id;for(let l=0;l<a.length;l+=1){let c=v$(t,a,l),d=s(c);o.set(d,r[l]=k$(d,c))}return{c(){e=pt("ul");for(let l=0;l<r.length;l+=1)r[l].c();v(e,"class",i=pi(["PinturaTabList",t[0]])),v(e,"role","tablist"),v(e,"data-layout",t[1])},m(l,c){et(l,e,c);for(let d=0;d<r.length;d+=1)r[d].m(e,null);t[14](e),n=!0},p(l,c){1124&c&&(a=l[2],Pe(),r=Ba(r,c,s,1,l,a,o,e,zs,k$,null,v$),Re()),(!n||1&c&&i!==(i=pi(["PinturaTabList",l[0]])))&&v(e,"class",i),(!n||2&c)&&v(e,"data-layout",l[1])},i(l){if(!n){for(let c=0;c<a.length;c+=1)M(r[c]);n=!0}},o(l){for(let c=0;c<r.length;c+=1)z(r[c]);n=!1},d(l){l&&tt(e);for(let c=0;c<r.length;c+=1)r[c].d();t[14](null)}}}function k$(t,e){let i,n,r,o,a,s,l,c,d,u;const p=e[11].default,h=rr(p,e,e[10],w$);function g(...f){return e[12](e[17],...f)}function m(...f){return e[13](e[17],...f)}return{key:t,first:null,c(){i=pt("li"),n=pt("button"),h&&h.c(),o=he(),v(n,"type","button"),n.disabled=r=e[17].disabled,v(i,"role","tab"),v(i,"aria-controls",a=e[17].href.substr(1)),v(i,"id",s=e[17].tabId),v(i,"aria-selected",l=e[17].selected),this.first=i},m(f,x){et(f,i,x),kt(i,n),h&&h.m(n,null),kt(i,o),c=!0,d||(u=[Ct(n,"keydown",g),Ct(n,"click",m)],d=!0)},p(f,x){e=f,h&&h.p&&(!c||1028&x)&&ar(h,p,e,e[10],c?or(p,e[10],x,Yv):sr(e[10]),w$),(!c||4&x&&r!==(r=e[17].disabled))&&(n.disabled=r),(!c||4&x&&a!==(a=e[17].href.substr(1)))&&v(i,"aria-controls",a),(!c||4&x&&s!==(s=e[17].tabId))&&v(i,"id",s),(!c||4&x&&l!==(l=e[17].selected))&&v(i,"aria-selected",l)},i(f){c||(M(h,f),c=!0)},o(f){z(h,f),c=!1},d(f){f&&tt(i),h&&h.d(f),d=!1,Bi(u)}}}function qv(t){let e,i,n=t[4]&&S$(t);return{c(){n&&n.c(),e=Tn()},m(r,o){n&&n.m(r,o),et(r,e,o),i=!0},p(r,[o]){r[4]?n?(n.p(r,o),16&o&&M(n,1)):(n=S$(r),n.c(),M(n,1),n.m(e.parentNode,e)):n&&(Pe(),z(n,1,1,()=>{n=null}),Re())},i(r){i||(M(n),i=!0)},o(r){z(n),i=!1},d(r){n&&n.d(r),r&&tt(e)}}}function Kv(t,e,i){let n,r,o,{$$slots:a={},$$scope:s}=e,{class:l}=e,{name:c}=e,{selected:d}=e,{tabs:u=[]}=e,{layout:p}=e;const h=ka(),g=x=>{const k=o.querySelectorAll('[role="tab"] button')[x];k&&k.focus()},m=(x,k)=>{x.preventDefault(),x.stopPropagation(),h("select",k)},f=({key:x},k)=>{if(!/arrow/i.test(x))return;const w=u.findIndex(C=>C.id===k);return/right|down/i.test(x)?g(w<u.length-1?w+1:0):/left|up/i.test(x)?g(w>0?w-1:u.length-1):void 0};return t.$$set=x=>{"class"in x&&i(0,l=x.class),"name"in x&&i(7,c=x.name),"selected"in x&&i(8,d=x.selected),"tabs"in x&&i(9,u=x.tabs),"layout"in x&&i(1,p=x.layout),"$$scope"in x&&i(10,s=x.$$scope)},t.$$.update=()=>{896&t.$$.dirty&&i(2,n=u.map(x=>{const k=x.id===d;return{...x,tabId:`tab-${c}-${x.id}`,href:`#panel-${c}-${x.id}`,selected:k}})),4&t.$$.dirty&&i(4,r=n.length>1)},[l,p,n,o,r,m,f,c,d,u,s,a,(x,k)=>f(k,x.id),(x,k)=>m(k,x.id),function(x){Ai[x?"unshift":"push"](()=>{o=x,i(3,o)})}]}class Iu extends li{constructor(e){super(),si(this,e,Kv,qv,ni,{class:0,name:7,selected:8,tabs:9,layout:1})}}const Jv=t=>({panel:16&t}),C$=t=>({panel:t[4][0].id,panelIsActive:!0});function T$(t,e,i){const n=t.slice();return n[14]=e[i].id,n[15]=e[i].shouldDraw,n[16]=e[i].panelId,n[17]=e[i].tabindex,n[18]=e[i].labelledBy,n[19]=e[i].isActive,n[20]=e[i].hidden,n[3]=e[i].visible,n}const Qv=t=>({panel:16&t,panelIsActive:16&t}),M$=t=>({panel:t[14],panelIsActive:t[19]});function t4(t){let e,i,n,r,o,a;const s=t[11].default,l=rr(s,t,t[10],C$);return{c(){e=pt("div"),i=pt("div"),l&&l.c(),v(i,"class",n=pi([t[1]])),v(e,"class",t[0]),v(e,"style",t[2])},m(c,d){et(c,e,d),kt(e,i),l&&l.m(i,null),r=!0,o||(a=[Ct(e,"measure",t[13]),Ui(dr.call(null,e))],o=!0)},p(c,d){l&&l.p&&(!r||1040&d)&&ar(l,s,c,c[10],r?or(s,c[10],d,Jv):sr(c[10]),C$),(!r||2&d&&n!==(n=pi([c[1]])))&&v(i,"class",n),(!r||1&d)&&v(e,"class",c[0]),(!r||4&d)&&v(e,"style",c[2])},i(c){r||(M(l,c),r=!0)},o(c){z(l,c),r=!1},d(c){c&&tt(e),l&&l.d(c),o=!1,Bi(a)}}}function e4(t){let e,i,n,r,o,a=[],s=new Map,l=t[4];const c=d=>d[14];for(let d=0;d<l.length;d+=1){let u=T$(t,l,d),p=c(u);s.set(p,a[d]=R$(p,u))}return{c(){e=pt("div");for(let d=0;d<a.length;d+=1)a[d].c();v(e,"class",i=pi(["PinturaTabPanels",t[0]])),v(e,"style",t[2])},m(d,u){et(d,e,u);for(let p=0;p<a.length;p+=1)a[p].m(e,null);n=!0,r||(o=[Ct(e,"measure",t[12]),Ui(dr.call(null,e,{observePosition:!0}))],r=!0)},p(d,u){1042&u&&(l=d[4],Pe(),a=Ba(a,u,c,1,d,l,s,e,zs,R$,null,T$),Re()),(!n||1&u&&i!==(i=pi(["PinturaTabPanels",d[0]])))&&v(e,"class",i),(!n||4&u)&&v(e,"style",d[2])},i(d){if(!n){for(let u=0;u<l.length;u+=1)M(a[u]);n=!0}},o(d){for(let u=0;u<a.length;u+=1)z(a[u]);n=!1},d(d){d&&tt(e);for(let u=0;u<a.length;u+=1)a[u].d();r=!1,Bi(o)}}}function P$(t){let e;const i=t[11].default,n=rr(i,t,t[10],M$);return{c(){n&&n.c()},m(r,o){n&&n.m(r,o),e=!0},p(r,o){n&&n.p&&(!e||1040&o)&&ar(n,i,r,r[10],e?or(i,r[10],o,Qv):sr(r[10]),M$)},i(r){e||(M(n,r),e=!0)},o(r){z(n,r),e=!1},d(r){n&&n.d(r)}}}function R$(t,e){let i,n,r,o,a,s,l,c,d,u=e[15]&&P$(e);return{key:t,first:null,c(){i=pt("div"),u&&u.c(),n=he(),v(i,"class",r=pi(["PinturaTabPanel",e[1]])),i.hidden=o=e[20],v(i,"id",a=e[16]),v(i,"tabindex",s=e[17]),v(i,"aria-labelledby",l=e[18]),v(i,"data-inert",c=!e[3]),this.first=i},m(p,h){et(p,i,h),u&&u.m(i,null),kt(i,n),d=!0},p(p,h){(e=p)[15]?u?(u.p(e,h),16&h&&M(u,1)):(u=P$(e),u.c(),M(u,1),u.m(i,n)):u&&(Pe(),z(u,1,1,()=>{u=null}),Re()),(!d||2&h&&r!==(r=pi(["PinturaTabPanel",e[1]])))&&v(i,"class",r),(!d||16&h&&o!==(o=e[20]))&&(i.hidden=o),(!d||16&h&&a!==(a=e[16]))&&v(i,"id",a),(!d||16&h&&s!==(s=e[17]))&&v(i,"tabindex",s),(!d||16&h&&l!==(l=e[18]))&&v(i,"aria-labelledby",l),(!d||16&h&&c!==(c=!e[3]))&&v(i,"data-inert",c)},i(p){d||(M(u),d=!0)},o(p){z(u),d=!1},d(p){p&&tt(i),u&&u.d()}}}function i4(t){let e,i,n,r;const o=[e4,t4],a=[];function s(l,c){return l[5]?0:1}return e=s(t),i=a[e]=o[e](t),{c(){i.c(),n=Tn()},m(l,c){a[e].m(l,c),et(l,n,c),r=!0},p(l,[c]){let d=e;e=s(l),e===d?a[e].p(l,c):(Pe(),z(a[d],1,1,()=>{a[d]=null}),Re(),i=a[e],i?i.p(l,c):(i=a[e]=o[e](l),i.c()),M(i,1),i.m(n.parentNode,n))},i(l){r||(M(i),r=!0)},o(l){z(i),r=!1},d(l){a[e].d(l),l&&tt(n)}}}function n4(t,e,i){let n,r,{$$slots:o={},$$scope:a}=e,{class:s}=e,{name:l}=e,{selected:c}=e,{panelClass:d}=e,{panels:u=[]}=e,{visible:p}=e,{style:h}=e;const g={};return t.$$set=m=>{"class"in m&&i(0,s=m.class),"name"in m&&i(6,l=m.name),"selected"in m&&i(7,c=m.selected),"panelClass"in m&&i(1,d=m.panelClass),"panels"in m&&i(8,u=m.panels),"visible"in m&&i(3,p=m.visible),"style"in m&&i(2,h=m.style),"$$scope"in m&&i(10,a=m.$$scope)},t.$$.update=()=>{968&t.$$.dirty&&i(4,n=u.map(m=>{const f=m===c;f&&i(9,g[m]=!0,g);const x=p?p.indexOf(m)!==-1:f;return{id:m,panelId:`panel-${l}-${m}`,labelledBy:`tab-${l}-${m}`,isActive:f,hidden:!f,visible:x,tabindex:f?0:-1,shouldDraw:f||g[m]}})),16&t.$$.dirty&&i(5,r=n.length>1)},[s,d,h,p,n,r,l,c,u,g,a,o,function(m){Wr.call(this,t,m)},function(m){Wr.call(this,t,m)}]}class Eu extends li{constructor(e){super(),si(this,e,n4,i4,ni,{class:0,name:6,selected:7,panelClass:1,panels:8,visible:3,style:2})}}var Yh=t=>{const e=Object.getOwnPropertyDescriptors(t.prototype);return Object.keys(e).filter(i=>!!e[i].get)};function I$(t){let e,i,n,r;const o=[t[5],{locale:t[1]}];function a(c){t[22](c)}var s=t[10];function l(c){let d={};for(let u=0;u<o.length;u+=1)d=In(d,o[u]);return c[3]!==void 0&&(d.name=c[3]),{props:d}}return s&&(e=yu(s,l(t)),Ai.push(()=>$o(e,"name",a)),t[23](e),e.$on("measure",t[11])),{c(){e&&Et(e.$$.fragment),n=Tn()},m(c,d){e&&Rt(e,c,d),et(c,n,d),r=!0},p(c,d){const u=34&d[0]?yr(o,[32&d[0]&&Pr(c[5]),2&d[0]&&{locale:c[1]}]):{};if(!i&&8&d[0]&&(i=!0,u.name=c[3],ko(()=>i=!1)),s!==(s=c[10])){if(e){Pe();const p=e;z(p.$$.fragment,1,0,()=>{It(p,1)}),Re()}s?(e=yu(s,l(c)),Ai.push(()=>$o(e,"name",a)),c[23](e),e.$on("measure",c[11]),Et(e.$$.fragment),M(e.$$.fragment,1),Rt(e,n.parentNode,n)):e=null}else s&&e.$set(u)},i(c){r||(e&&M(e.$$.fragment,c),r=!0)},o(c){e&&z(e.$$.fragment,c),r=!1},d(c){t[23](null),c&&tt(n),e&&It(e,c)}}}function r4(t){let e,i,n,r=t[6]&&I$(t);return{c(){e=pt("div"),r&&r.c(),v(e,"data-util",t[3]),v(e,"class",i=pi(["PinturaUtilPanel",t[2]])),v(e,"style",t[7])},m(o,a){et(o,e,a),r&&r.m(e,null),t[24](e),n=!0},p(o,a){o[6]?r?(r.p(o,a),64&a[0]&&M(r,1)):(r=I$(o),r.c(),M(r,1),r.m(e,null)):r&&(Pe(),z(r,1,1,()=>{r=null}),Re()),(!n||8&a[0])&&v(e,"data-util",o[3]),(!n||4&a[0]&&i!==(i=pi(["PinturaUtilPanel",o[2]])))&&v(e,"class",i),(!n||128&a[0])&&v(e,"style",o[7])},i(o){n||(M(r),n=!0)},o(o){z(r),n=!1},d(o){o&&tt(e),r&&r.d(),t[24](null)}}}function o4(t,e,i){let n,r,o,a,s;const l=ka();let{isActive:c=!0}=e,{stores:d}=e,{view:u}=e,{props:p}=e,{component:h}=e,{locale:g}=e,{class:m}=e;const f=dn("isAnimated");let x;A(t,f,j=>i(21,s=j));const k=ci(0),w=Ii(k,j=>Ji(j,0,1));A(t,w,j=>i(20,a=j));let C=!c;const P=pe(c),R={isActive:Ii(P,async(j,Q)=>{if(!j)return Q(j);await Zy(),Q(j)},!1),isActiveFraction:Ii(w,j=>j),isVisible:Ii(w,j=>j>0)},W=u,T=Yh(W),F=Object.keys(p||{}).reduce((j,Q)=>(T.includes(Q)&&(j[Q]=p[Q]),j),{}),D=Object.keys(R).reduce((j,Q)=>(T.includes(Q)&&(j[Q]=R[Q]),j),{});let B,y;const _=j=>{i(17,x={...j.detail}),S&&c&&l("measure",{...x})};ho("measurable",dr);const J=sl().$$.context;let S=!1;return Ls(()=>{if(i(19,S=!0),o)return;i(0,h=new W({target:y,props:{...r,locale:g},context:J})),i(3,B=h.name);const j=h.$on("measure",_);return()=>{j(),h.$destroy()}}),t.$$set=j=>{"isActive"in j&&i(12,c=j.isActive),"stores"in j&&i(13,d=j.stores),"view"in j&&i(14,u=j.view),"props"in j&&i(15,p=j.props),"component"in j&&i(0,h=j.component),"locale"in j&&i(1,g=j.locale),"class"in j&&i(2,m=j.class)},t.$$.update=()=>{135169&t.$$.dirty[0]&&x&&c&&h&&l("measure",x),2101248&t.$$.dirty[0]&&k.set(c?1:0,{hard:s===!1}),1310720&t.$$.dirty[0]&&(a<=0&&!C?i(18,C=!0):a>0&&C&&i(18,C=!1)),786432&t.$$.dirty[0]&&S&&l(C?"hide":"show"),1048576&t.$$.dirty[0]&&l("fade",a),1048576&t.$$.dirty[0]&&i(7,n=a<1?"opacity: "+a:void 0),4096&t.$$.dirty[0]&&P.set(c),8192&t.$$.dirty[0]&&i(5,r={...F,...D,stores:d})},i(6,o=!T.includes("external")),[h,g,m,B,y,r,o,n,f,w,W,_,c,d,u,p,k,x,C,S,a,s,function(j){B=j,i(3,B)},function(j){Ai[j?"unshift":"push"](()=>{h=j,i(0,h)})},function(j){Ai[j?"unshift":"push"](()=>{y=j,i(4,y)})}]}class y2 extends li{constructor(e){super(),si(this,e,o4,r4,ni,{isActive:12,stores:13,view:14,props:15,component:0,locale:1,class:2,opacity:16},null,[-1,-1])}get opacity(){return this.$$.ctx[16]}}function a4(t){let e,i,n;const r=t[5].default,o=rr(r,t,t[4],null);return{c(){e=fr("svg"),o&&o.c(),v(e,"class",t[3]),v(e,"style",t[2]),v(e,"width",t[0]),v(e,"height",t[1]),v(e,"viewBox",i="0 0 "+t[0]+`
    `+t[1]),v(e,"xmlns","http://www.w3.org/2000/svg"),v(e,"aria-hidden","true"),v(e,"focusable","false"),v(e,"stroke-linecap","round"),v(e,"stroke-linejoin","round")},m(a,s){et(a,e,s),o&&o.m(e,null),n=!0},p(a,[s]){o&&o.p&&(!n||16&s)&&ar(o,r,a,a[4],n?or(r,a[4],s,null):sr(a[4]),null),(!n||8&s)&&v(e,"class",a[3]),(!n||4&s)&&v(e,"style",a[2]),(!n||1&s)&&v(e,"width",a[0]),(!n||2&s)&&v(e,"height",a[1]),(!n||3&s&&i!==(i="0 0 "+a[0]+`
    `+a[1]))&&v(e,"viewBox",i)},i(a){n||(M(o,a),n=!0)},o(a){z(o,a),n=!1},d(a){a&&tt(e),o&&o.d(a)}}}function s4(t,e,i){let{$$slots:n={},$$scope:r}=e,{width:o=24}=e,{height:a=24}=e,{style:s}=e,{class:l}=e;return t.$$set=c=>{"width"in c&&i(0,o=c.width),"height"in c&&i(1,a=c.height),"style"in c&&i(2,s=c.style),"class"in c&&i(3,l=c.class),"$$scope"in c&&i(4,r=c.$$scope)},[o,a,s,l,r,n]}class Co extends li{constructor(e){super(),si(this,e,s4,a4,ni,{width:0,height:1,style:2,class:3})}}var x2=(t,e)=>e===t.target||e.contains(t.target),E$=(t,e,i)=>{const n=We(e)?e:t;return i?`${n} (${r=i,r.map(o=>o==="CMD"?Tu()?"⌘":"Ctrl":o).join("+")})`:n;var r};function A$(t){let e,i;return e=new Co({props:{class:"PinturaButtonIcon",$$slots:{default:[l4]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};536870920&r&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function l4(t){let e;return{c(){e=fr("g")},m(i,n){et(i,e,n),e.innerHTML=t[3]},p(i,n){8&n&&(e.innerHTML=i[3])},d(i){i&&tt(e)}}}function L$(t){let e;return{c(){e=pt("span"),v(e,"class",t[11])},m(i,n){et(i,e,n),e.innerHTML=t[0]},p(i,n){1&n&&(e.innerHTML=i[0]),2048&n&&v(e,"class",i[11])},d(i){i&&tt(e)}}}function c4(t){let e,i,n,r,o;const a=t[27].default,s=rr(a,t,t[29],null),l=s||function(c){let d,u,p,h=c[3]&&A$(c),g=c[0]&&L$(c);return{c(){d=pt("span"),h&&h.c(),u=he(),g&&g.c(),v(d,"class",c[13])},m(m,f){et(m,d,f),h&&h.m(d,null),kt(d,u),g&&g.m(d,null),p=!0},p(m,f){m[3]?h?(h.p(m,f),8&f&&M(h,1)):(h=A$(m),h.c(),M(h,1),h.m(d,u)):h&&(Pe(),z(h,1,1,()=>{h=null}),Re()),m[0]?g?g.p(m,f):(g=L$(m),g.c(),g.m(d,null)):g&&(g.d(1),g=null),(!p||8192&f)&&v(d,"class",m[13])},i(m){p||(M(h),p=!0)},o(m){z(h),p=!1},d(m){m&&tt(d),h&&h.d(),g&&g.d()}}}(t);return{c(){e=pt("button"),l&&l.c(),v(e,"type",t[6]),v(e,"style",t[4]),e.disabled=t[5],v(e,"class",t[12]),v(e,"title",i=E$(t[0],t[1],t[2]))},m(c,d){et(c,e,d),l&&l.m(e,null),t[28](e),n=!0,r||(o=[Ct(e,"keydown",function(){ji(t[8])&&t[8].apply(this,arguments)}),Ct(e,"click",function(){ji(t[7])&&t[7].apply(this,arguments)}),Ct(e,"pointerdown",function(){ji(t[14])&&t[14].apply(this,arguments)}),Ui(t[9].call(null,e))],r=!0)},p(c,[d]){t=c,s?s.p&&(!n||536870912&d)&&ar(s,a,t,t[29],n?or(a,t[29],d,null):sr(t[29]),null):l&&l.p&&(!n||10249&d)&&l.p(t,n?d:-1),(!n||64&d)&&v(e,"type",t[6]),(!n||16&d)&&v(e,"style",t[4]),(!n||32&d)&&(e.disabled=t[5]),(!n||4096&d)&&v(e,"class",t[12]),(!n||7&d&&i!==(i=E$(t[0],t[1],t[2])))&&v(e,"title",i)},i(c){n||(M(l,c),n=!0)},o(c){z(l,c),n=!1},d(c){c&&tt(e),l&&l.d(c),t[28](null),r=!1,Bi(o)}}}function d4(t,e,i){let n,r,o,a,s,l,{$$slots:c={},$$scope:d}=e,{class:u}=e,{label:p}=e,{title:h}=e,{shortcut:g}=e,{labelClass:m}=e,{innerClass:f}=e,{hideLabel:x=!1}=e,{icon:k}=e,{style:w}=e,{disabled:C}=e,{type:P="button"}=e,{onclick:R}=e,{onkeydown:W}=e,{onhold:T}=e,{action:F=()=>{}}=e,{holdThreshold:D=500}=e,{holdSpeedUpFactor:B=.5}=e,{holdSpeedMin:y=20}=e;const _=S=>{i(25,l=setTimeout(()=>{T(),_(Math.max(S*B,y))},S))};let J;return t.$$set=S=>{"class"in S&&i(15,u=S.class),"label"in S&&i(0,p=S.label),"title"in S&&i(1,h=S.title),"shortcut"in S&&i(2,g=S.shortcut),"labelClass"in S&&i(16,m=S.labelClass),"innerClass"in S&&i(17,f=S.innerClass),"hideLabel"in S&&i(18,x=S.hideLabel),"icon"in S&&i(3,k=S.icon),"style"in S&&i(4,w=S.style),"disabled"in S&&i(5,C=S.disabled),"type"in S&&i(6,P=S.type),"onclick"in S&&i(7,R=S.onclick),"onkeydown"in S&&i(8,W=S.onkeydown),"onhold"in S&&i(19,T=S.onhold),"action"in S&&i(9,F=S.action),"holdThreshold"in S&&i(20,D=S.holdThreshold),"holdSpeedUpFactor"in S&&i(21,B=S.holdSpeedUpFactor),"holdSpeedMin"in S&&i(22,y=S.holdSpeedMin),"$$scope"in S&&i(29,d=S.$$scope)},t.$$.update=()=>{101187584&t.$$.dirty&&i(26,r=T?()=>{l&&(clearTimeout(l),i(25,l=void 0),document.documentElement.removeEventListener("pointerup",r))}:ge),68681728&t.$$.dirty&&i(14,n=T?()=>{document.documentElement.addEventListener("pointerup",r),_(D)}:ge),131072&t.$$.dirty&&i(13,o=pi(["PinturaButtonInner",f])),294912&t.$$.dirty&&i(12,a=pi(["PinturaButton",x&&"PinturaButtonIconOnly",u])),327680&t.$$.dirty&&i(11,s=pi([x?"implicit":"PinturaButtonLabel",m]))},[p,h,g,k,w,C,P,R,W,F,J,s,a,o,n,u,m,f,x,T,D,B,y,S=>x2(S,J),()=>J,l,r,c,function(S){Ai[S?"unshift":"push"](()=>{J=S,i(10,J)})},d]}class Fs extends li{constructor(e){super(),si(this,e,d4,c4,ni,{class:15,label:0,title:1,shortcut:2,labelClass:16,innerClass:17,hideLabel:18,icon:3,style:4,disabled:5,type:6,onclick:7,onkeydown:8,onhold:19,action:9,holdThreshold:20,holdSpeedUpFactor:21,holdSpeedMin:22,isEventTarget:23,getElement:24})}get isEventTarget(){return this.$$.ctx[23]}get getElement(){return this.$$.ctx[24]}}var b2=(t,e)=>{const i=t.findIndex(e);if(i>=0)return t.splice(i,1)};const u4=80;var Ds=(t,e={})=>{const{inertia:i=!1,inertiaDurationMultiplier:n=u4,shouldStartInteraction:r=()=>!0,pinch:o=!1,multiTouch:a,getEventPosition:s=dt=>rt(dt.clientX,dt.clientY),observeKeys:l=!1}=e;function c(dt,Tt){t.dispatchEvent(new CustomEvent(dt,{detail:Tt}))}function d(){R&&R(),R=void 0}const u=[],p=dt=>dt.timeStamp===0?Date.now():dt.timeStamp,h=()=>{const dt=Oe(u[0].position);if(u[1]){const Tt=.5*(u[1].position.x-dt.x),K=.5*(u[1].position.y-dt.y);dt.x+=Tt,dt.y+=K}return dt},g=dt=>{dt.origin.x=dt.position.x,dt.origin.y=dt.position.y,dt.translation.x=0,dt.translation.y=0},m=dt=>{const Tt=(K=>u.findIndex(q=>q.event.pointerId===K.pointerId))(dt);if(!(Tt<0))return u[Tt]},f=()=>u.length===1,x=()=>u.length===2,k=dt=>{const Tt=Bo(dt.map(K=>K.position));return{center:Tt,distance:((K,q)=>K.reduce((Z,xt)=>Z+mo(q,xt.position),0)/K.length)(dt,Tt),velocity:Bo(dt.map(K=>K.velocity)),translation:Bo(dt.map(K=>K.translation))}};let w,C,P,R,W,T,F,D,B=0,y;t.addEventListener("pointerdown",Q);const _=["Meta","Control","Alt","Shift"];function J(dt){if(!_.includes(dt.key))return;const{metaKey:Tt,ctrlKey:K,altKey:q,shiftKey:Z}=dt;j({metaKey:Tt,ctrlKey:K,altKey:q,shiftKey:Z})}let S=Date.now();const j=dt=>{const Tt=Oe(u[0].translation);let K=F;o&&x()&&(K*=mo(u[0].position,u[1].position)/W,Dn(Tt,u[1].translation)),Dn(Tt,T);const q=Date.now();q-S<16||(S=q,c("interactionupdate",{position:h(),translation:Tt,scalar:o?K:void 0,isMultiTouching:x(),...dt}))};function Q(dt){if(!x()&&!(Tt=>di(Tt.button)&&Tt.button!==0)(dt)&&r(dt,t)){if(d(),(Tt=>{const K=p(Tt),q={timeStamp:K,timeStampInitial:K,position:s(Tt),origin:s(Tt),velocity:rn(),velocityHistory:[],velocityAverage:rn(),translation:rn(),interactionState:void 0,event:Tt};u.push(q),q.interactionState=k(u)})(dt),l&&(window.addEventListener("keydown",J),window.addEventListener("keyup",J)),f())document.documentElement.addEventListener("pointermove",ht),document.documentElement.addEventListener("pointerup",at),document.documentElement.addEventListener("pointercancel",at),document.addEventListener("visibilitychange",yt),D=!1,F=1,T=rn(),W=void 0,c("interactionstart",{origin:Oe(m(dt).origin)});else if(o)D=!0,W=mo(u[0].position,u[1].position),T.x+=u[0].translation.x,T.y+=u[0].translation.y,g(u[0]);else if(a===!1)return u.length=0,Mt(),c("interactioncancel")}}function ht(dt){dt.preventDefault(),(xt=>{const it=m(xt);if(!it)return;const mt=p(xt),Ft=s(xt),ie=Math.max(1,mt-it.timeStamp);it.velocity.x=(Ft.x-it.position.x)/ie,it.velocity.y=(Ft.y-it.position.y)/ie,it.velocityHistory.push(Oe(it.velocity)),it.velocityHistory=it.velocityHistory.slice(-3),it.velocityAverage=it.velocityHistory.reduce((Dt,Ot,ae,G)=>(Dt.x+=Ot.x/G.length,Dt.y+=Ot.y/G.length,Dt),rn()),it.translation.x=Ft.x-it.origin.x,it.translation.y=Ft.y-it.origin.y,it.timeStamp=mt,it.position.x=Ft.x,it.position.y=Ft.y,it.event=xt})(dt);const{metaKey:Tt=!1,ctrlKey:K=!1,altKey:q=!1,shiftKey:Z=!1}=l?dt:{};j({metaKey:Tt,ctrlKey:K,altKey:q,shiftKey:Z})}function at(dt){if(!m(dt))return;const Tt=h(),K=(ie=>{const Dt=b2(u,Ot=>Ot.event.pointerId===ie.pointerId);if(Dt)return Dt[0]})(dt);if(o&&f()){const ie=mo(u[0].position,K.position);F*=ie/W,T.x+=u[0].translation.x+K.translation.x,T.y+=u[0].translation.y+K.translation.y,g(u[0])}let q=!1,Z=!1;if(!D&&K){const ie=performance.now(),Dt=ie-K.timeStampInitial;q=vo(K.translation)<64&&Dt<300,Z=!!(y&&q&&ie-B<700&&vo(y,K.position)<128),q&&(y=Oe(K.position),B=ie)}if(u.length>0)return;Mt();const xt=Oe(K.translation),it=Oe(K.velocityAverage);let mt=!1;c("interactionrelease",{isTap:q,isDoubleTap:Z,position:Tt,translation:xt,scalar:F,preventInertia:()=>mt=!0});const Ft=mo(it);if(mt||!i||Ft<.25)return $t(xt,{isTap:q,isDoubleTap:Z});C=Oe(Tt),P=Oe(xt),w=Zh(Oe(xt),{easing:Vv,duration:Ft*n}),w.set({x:xt.x+50*it.x,y:xt.y+50*it.y}).then(()=>{R&&$t(ba(w),{isTap:q,isDoubleTap:Z})}),R=w.subscribe(U)}function U(dt){dt&&c("interactionupdate",{position:rt(C.x+(dt.x-P.x),C.y+(dt.y-P.y)),translation:dt,scalar:o?F:void 0})}function yt(dt){if(document.visibilityState==="visible"||!u.length)return;const Tt=k(u);d(),c("interactionend",{...Tt}),u.length=0,Mt()}function $t(dt,Tt){d(),c("interactionend",{...Tt,translation:dt,scalar:o?F:void 0})}function Mt(){l&&window.removeEventListener("keydown",J),l&&window.removeEventListener("keyup",J),document.documentElement.removeEventListener("pointermove",ht),document.documentElement.removeEventListener("pointerup",at),document.documentElement.removeEventListener("pointercancel",at),document.addEventListener("visibilitychange",yt)}return{destroy(){d(),t.removeEventListener("pointerdown",Q)}}},Bs=(t,e={})=>{const{direction:i,shiftMultiplier:n=10,bubbles:r=!1,preventDefault:o=!1,stopKeydownPropagation:a=!0}=e,s=i==="horizontal",l=i==="vertical",c=d=>{const{key:u}=d,p=d.shiftKey,h=/up|down/i.test(u),g=/left|right/i.test(u);if(!g&&!h||s&&h||l&&g)return;const m=p?n:1;a&&d.stopPropagation(),o&&d.preventDefault(),t.dispatchEvent(new CustomEvent("nudge",{bubbles:r,detail:rt((/left/i.test(u)?-1:/right/i.test(u)?1:0)*m,(/up/i.test(u)?-1:/down/i.test(u)?1:0)*m)}))};return t.addEventListener("keydown",c),{destroy(){t.removeEventListener("keydown",c)}}};function ws(t,e){return e?e*Math.sign(t)*Math.log10(1+Math.abs(t)/e):t}const z$=(t,e,i)=>{if(!e||!i)return{...t};const n=t.x+ws(e.x-t.x,i),r=t.x+t.width+ws(e.x+e.width-(t.x+t.width),i),o=t.y+ws(e.y-t.y,i);return{x:n,y:o,width:r-n,height:t.y+t.height+ws(e.y+e.height-(t.y+t.height),i)-o}},p4=(t,e,i)=>e&&i?rt(t.x+ws(e.x-t.x,i),t.y+ws(e.y-t.y,i)):{...t};var v2=(t,e)=>{if(t)return/em/.test(t)?16*parseInt(t,10):/px/.test(t)?parseInt(t,10):void 0},Au=(t,e)=>{let i=t.detail||0;const{deltaX:n,deltaY:r,wheelDelta:o,wheelDeltaX:a,wheelDeltaY:s}=t,{fixScrollDirection:l=!1}=e||{};return di(a)&&Math.abs(a)>Math.abs(s)?i=a/-120:di(n)&&Math.abs(n)>Math.abs(r)?i=n/20:(o||s)&&(i=(o||s)/-120),i||(i=r/20),(wa()||Fa())&&(i*=2),l&&Tu()&&(i*=-1),i};function h4(t){let e,i,n,r,o,a,s;const l=t[37].default,c=rr(l,t,t[36],null);return{c(){e=pt("div"),i=pt("div"),c&&c.c(),v(i,"style",t[5]),v(e,"class",n=pi(["PinturaScrollable",t[0]])),v(e,"style",t[4]),v(e,"data-direction",t[1]),v(e,"data-state",t[6])},m(d,u){et(d,e,u),kt(e,i),c&&c.m(i,null),t[39](e),o=!0,a||(s=[Ct(i,"interactionstart",t[9]),Ct(i,"interactionupdate",t[11]),Ct(i,"interactionend",t[12]),Ct(i,"interactionrelease",t[10]),Ui(Ds.call(null,i,{inertia:!0})),Ct(i,"measure",t[38]),Ui(dr.call(null,i)),Ct(e,"wheel",t[14],{passive:!1}),Ct(e,"scroll",t[16]),Ct(e,"focusin",t[15]),Ct(e,"nudge",t[17]),Ct(e,"measure",t[13]),Ui(dr.call(null,e,{observePosition:!0})),Ui(r=Bs.call(null,e,{direction:t[1]==="x"?"horizontal":"vertical",stopKeydownPropagation:!1}))],a=!0)},p(d,u){c&&c.p&&(!o||32&u[1])&&ar(c,l,d,d[36],o?or(l,d[36],u,null):sr(d[36]),null),(!o||32&u[0])&&v(i,"style",d[5]),(!o||1&u[0]&&n!==(n=pi(["PinturaScrollable",d[0]])))&&v(e,"class",n),(!o||16&u[0])&&v(e,"style",d[4]),(!o||2&u[0])&&v(e,"data-direction",d[1]),(!o||64&u[0])&&v(e,"data-state",d[6]),r&&ji(r.update)&&2&u[0]&&r.update.call(null,{direction:d[1]==="x"?"horizontal":"vertical",stopKeydownPropagation:!1})},i(d){o||(M(c,d),o=!0)},o(d){z(c,d),o=!1},d(d){d&&tt(e),c&&c.d(d),t[39](null),a=!1,Bi(s)}}}function m4(t,e,i){let n,r,o,a,s,l,c,d,u,{$$slots:p={},$$scope:h}=e;const g=ka();let m,f,x,k,w="idle",C=ci(0);A(t,C,q=>i(35,d=q));let{class:P}=e,{scrollBlockInteractionDist:R=5}=e,{scrollStep:W=10}=e,{scrollFocusMargin:T=64}=e,{scrollDirection:F="x"}=e,{scrollAutoCancel:D=!1}=e,{elasticity:B=0}=e,{onscroll:y=ge}=e,{maskFeatherSize:_}=e,{maskFeatherStartOpacity:J}=e,{maskFeatherEndOpacity:S}=e,{scroll:j}=e;const Q=dn("fixScrollDirection");let ht;A(t,Q,q=>i(46,u=q));let at="",U=!0;const yt=C.subscribe(q=>{const Z=rn();Z[F]=q,y(Z)}),$t=q=>Math.max(Math.min(0,q),x[n]-f[n]);let Mt,dt,Tt;const K=(q,Z={})=>{const{elastic:xt=!1,animate:it=!1,preventScrollState:mt=!1}=Z;Math.abs(q-m)>R&&w==="idle"&&!k&&!mt&&i(28,w="scrolling");const Ft=$t(q),ie=xt&&B&&!k?Ft+ws(q-Ft,B):Ft;let Dt=!0;it?Dt=!1:U||(Dt=!k),U=!1,C.set(ie,{hard:Dt}).then(Ot=>{k&&(U=!0)})};return Vo(()=>{yt()}),t.$$set=q=>{"class"in q&&i(0,P=q.class),"scrollBlockInteractionDist"in q&&i(21,R=q.scrollBlockInteractionDist),"scrollStep"in q&&i(22,W=q.scrollStep),"scrollFocusMargin"in q&&i(23,T=q.scrollFocusMargin),"scrollDirection"in q&&i(1,F=q.scrollDirection),"scrollAutoCancel"in q&&i(24,D=q.scrollAutoCancel),"elasticity"in q&&i(25,B=q.elasticity),"onscroll"in q&&i(26,y=q.onscroll),"maskFeatherSize"in q&&i(20,_=q.maskFeatherSize),"maskFeatherStartOpacity"in q&&i(18,J=q.maskFeatherStartOpacity),"maskFeatherEndOpacity"in q&&i(19,S=q.maskFeatherEndOpacity),"scroll"in q&&i(27,j=q.scroll),"$$scope"in q&&i(36,h=q.$$scope)},t.$$.update=()=>{if(2&t.$$.dirty[0]&&i(32,n=F==="x"?"width":"height"),2&t.$$.dirty[0]&&i(30,r=F.toUpperCase()),8&t.$$.dirty[0]&&i(34,o=ht&&getComputedStyle(ht)),8&t.$$.dirty[0]|8&t.$$.dirty[1]&&i(33,a=o&&v2(o.getPropertyValue("--scrollable-feather-size"))),537657348&t.$$.dirty[0]|22&t.$$.dirty[1]&&d!=null&&x&&a!=null&&f){const q=-1*d/a,Z=-(x[n]-f[n]-d)/a;i(18,J=Ji(1-q,0,1)),i(19,S=Ji(1-Z,0,1)),i(20,_=a),i(4,at=`--scrollable-feather-start-opacity: ${J};--scrollable-feather-end-opacity: ${S}`)}134217736&t.$$.dirty[0]&&ht&&j!==void 0&&(di(j)?K(j):K(j.scrollOffset,j)),536870916&t.$$.dirty[0]|2&t.$$.dirty[1]&&i(31,s=x&&f?f[n]>x[n]:void 0),268435456&t.$$.dirty[0]|1&t.$$.dirty[1]&&i(6,l=pi([w,s?"overflows":void 0])),1073741824&t.$$.dirty[0]|17&t.$$.dirty[1]&&i(5,c=s?`transform: translate${r}(${d}px)`:void 0)},[P,F,f,ht,at,c,l,C,Q,()=>{s&&(dt=!1,Mt=!0,Tt=rt(0,0),k=!1,i(28,w="idle"),m=ba(C))},({detail:q})=>{s&&(k=!0,i(28,w="idle"))},({detail:q})=>{s&&(dt||Mt&&(Mt=!1,vo(q.translation)<.1)||(!D||F!=="x"||(Z=>{const xt=So(rt(Z.x-Tt.x,Z.y-Tt.y),Math.abs);Tt=Oe(Z);const it=vo(xt),mt=xt.x-xt.y;return!(it>1&&mt<-.5)})(q.translation)?K(m+q.translation[F],{elastic:!0}):dt=!0))},({detail:q})=>{if(!s||dt)return;const Z=m+q.translation[F],xt=$t(Z);U=!1,C.set(xt).then(it=>{k&&(U=!0)})},({detail:q})=>{i(29,x=q),g("measure",{x:q.x,y:q.y,width:q.width,height:q.height})},q=>{if(!s)return;q.preventDefault(),q.stopPropagation();const Z=q.shiftKey,xt=Au(q,{fixScrollDirection:u})*(Z?-1:1),it=ba(C);K(it+xt*W,{animate:!0})},q=>{if(!s||!k)return;let Z=q.target;q.target.classList.contains("implicit")&&(Z=Z.parentNode);const xt=Z[F==="x"?"offsetLeft":"offsetTop"],it=xt+Z[F==="x"?"offsetWidth":"offsetHeight"],mt=ba(C),Ft=T+_;mt+xt<Ft?K(-xt+Ft):mt+it>x[n]-Ft&&K(x[n]-it-Ft,{animate:!0})},()=>{i(3,ht[F==="x"?"scrollLeft":"scrollTop"]=0,ht)},({detail:q})=>{if(ht.querySelector("[data-focus-visible]"))return;const Z=-2*q[F],xt=ba(C);K(xt+Z*W,{animate:!0,preventScrollState:!0})},J,S,_,R,W,T,D,B,y,j,w,x,r,s,n,a,o,d,h,p,q=>i(2,f=q.detail),function(q){Ai[q?"unshift":"push"](()=>{ht=q,i(3,ht)})}]}class Ca extends li{constructor(e){super(),si(this,e,m4,h4,ni,{class:0,scrollBlockInteractionDist:21,scrollStep:22,scrollFocusMargin:23,scrollDirection:1,scrollAutoCancel:24,elasticity:25,onscroll:26,maskFeatherSize:20,maskFeatherStartOpacity:18,maskFeatherEndOpacity:19,scroll:27},null,[-1,-1])}}function F$(t,{delay:e=0,duration:i=400,easing:n=Bh}={}){const r=+getComputedStyle(t).opacity;return{delay:e,duration:i,easing:n,css:o=>"opacity: "+o*r}}function $4(t){let e,i,n;return{c(){e=pt("span"),v(e,"class","PinturaStatusMessage")},m(r,o){et(r,e,o),e.innerHTML=t[0],i||(n=[Ct(e,"measure",function(){ji(t[1])&&t[1].apply(this,arguments)}),Ui(dr.call(null,e))],i=!0)},p(r,o){t=r,1&o&&(e.innerHTML=t[0])},i:Ke,o:Ke,d(r){r&&tt(e),i=!1,Bi(n)}}}function g4(t){let e,i,n,r,o;return{c(){e=pt("span"),v(e,"class","PinturaStatusMessage")},m(a,s){et(a,e,s),e.innerHTML=t[0],n=!0,r||(o=[Ct(e,"measure",function(){ji(t[1])&&t[1].apply(this,arguments)}),Ui(dr.call(null,e))],r=!0)},p(a,s){t=a,(!n||1&s)&&(e.innerHTML=t[0])},i(a){n||(Wl(()=>{i||(i=Km(e,F$,{duration:500},!0)),i.run(1)}),n=!0)},o(a){i||(i=Km(e,F$,{duration:500},!1)),i.run(0),n=!1},d(a){a&&tt(e),a&&i&&i.end(),r=!1,Bi(o)}}}function f4(t){let e,i,n,r;const o=[g4,$4],a=[];function s(l,c){return l[2]?0:1}return e=s(t),i=a[e]=o[e](t),{c(){i.c(),n=Tn()},m(l,c){a[e].m(l,c),et(l,n,c),r=!0},p(l,[c]){let d=e;e=s(l),e===d?a[e].p(l,c):(Pe(),z(a[d],1,1,()=>{a[d]=null}),Re(),i=a[e],i?i.p(l,c):(i=a[e]=o[e](l),i.c()),M(i,1),i.m(n.parentNode,n))},i(l){r||(M(i),r=!0)},o(l){z(i),r=!1},d(l){a[e].d(l),l&&tt(n)}}}function y4(t,e,i){let n,{text:r}=e,{onmeasure:o=ge}=e;const a=dn("isAnimated");return A(t,a,s=>i(2,n=s)),t.$$set=s=>{"text"in s&&i(0,r=s.text),"onmeasure"in s&&i(1,o=s.onmeasure)},[r,o,n,a]}class w2 extends li{constructor(e){super(),si(this,e,y4,f4,ni,{text:0,onmeasure:1})}}function x4(t){let e,i,n,r,o,a,s,l,c;return{c(){e=pt("span"),i=fr("svg"),n=fr("g"),r=fr("circle"),o=fr("circle"),a=he(),s=pt("span"),l=gn(t[3]),v(r,"class","PinturaProgressIndicatorBar"),v(r,"r","8.5"),v(r,"cx","10"),v(r,"cy","10"),v(r,"stroke-linecap","round"),v(r,"opacity",".25"),v(o,"class","PinturaProgressIndicatorFill"),v(o,"r","8.5"),v(o,"stroke-dasharray",t[2]),v(o,"cx","10"),v(o,"cy","10"),v(o,"transform","rotate(-90) translate(-20)"),v(n,"fill","none"),v(n,"stroke","currentColor"),v(n,"stroke-width","2.5"),v(n,"stroke-linecap","round"),v(n,"opacity",t[1]),v(i,"width","20"),v(i,"height","20"),v(i,"viewBox","0 0 20 20"),v(i,"xmlns","http://www.w3.org/2000/svg"),v(i,"aria-hidden","true"),v(i,"focusable","false"),v(s,"class","implicit"),v(e,"class","PinturaProgressIndicator"),v(e,"data-status",t[0]),v(e,"style",c="opacity:"+t[4])},m(d,u){et(d,e,u),kt(e,i),kt(i,n),kt(n,r),kt(n,o),kt(e,a),kt(e,s),kt(s,l)},p(d,[u]){4&u&&v(o,"stroke-dasharray",d[2]),2&u&&v(n,"opacity",d[1]),8&u&&zn(l,d[3]),1&u&&v(e,"data-status",d[0]),16&u&&c!==(c="opacity:"+d[4])&&v(e,"style",c)},i:Ke,o:Ke,d(d){d&&tt(e)}}}function b4(t,e,i){let n,r,o,a,s,l,c;const d=ka();let{progress:u}=e,{min:p=0}=e,{max:h=100}=e,{labelBusy:g="Busy"}=e,{opacity:m}=e;const f=ci(m,{precision:.01});A(t,f,P=>i(4,c=P));const x=ci(0,{precision:.01}),k=ci(0,{precision:.01});A(t,k,P=>i(13,s=P));const w=Ii([x],P=>Ji(P,p,h));A(t,w,P=>i(14,l=P));const C=w.subscribe(P=>{u===1&&Math.round(P)>=100&&d("complete")});return Ls(()=>{k.set(1)}),Vo(()=>{C()}),t.$$set=P=>{"progress"in P&&i(8,u=P.progress),"min"in P&&i(9,p=P.min),"max"in P&&i(10,h=P.max),"labelBusy"in P&&i(11,g=P.labelBusy),"opacity"in P&&i(12,m=P.opacity)},t.$$.update=()=>{4096&t.$$.dirty&&di(m)&&f.set(m),256&t.$$.dirty&&u&&u!==1/0&&x.set(100*u),18688&t.$$.dirty&&i(3,n=u===1/0?g:Math.round(l)+"%"),16640&t.$$.dirty&&i(2,r=u===1/0?"26.5 53":l/100*53+" 53"),8192&t.$$.dirty&&i(1,o=s),256&t.$$.dirty&&i(0,a=u===1/0?"busy":"loading")},[a,o,r,n,c,f,k,w,u,p,h,g,m,s,l]}class S2 extends li{constructor(e){super(),si(this,e,b4,x4,ni,{progress:8,min:9,max:10,labelBusy:11,opacity:12})}}function v4(t){let e,i,n;const r=t[5].default,o=rr(r,t,t[4],null);return{c(){e=pt("span"),o&&o.c(),v(e,"class",i="PinturaStatusAside "+t[0]),v(e,"style",t[1])},m(a,s){et(a,e,s),o&&o.m(e,null),n=!0},p(a,[s]){o&&o.p&&(!n||16&s)&&ar(o,r,a,a[4],n?or(r,a[4],s,null):sr(a[4]),null),(!n||1&s&&i!==(i="PinturaStatusAside "+a[0]))&&v(e,"class",i),(!n||2&s)&&v(e,"style",a[1])},i(a){n||(M(o,a),n=!0)},o(a){z(o,a),n=!1},d(a){a&&tt(e),o&&o.d(a)}}}function w4(t,e,i){let n,{$$slots:r={},$$scope:o}=e,{offset:a=0}=e,{opacity:s=0}=e,{class:l}=e;return t.$$set=c=>{"offset"in c&&i(2,a=c.offset),"opacity"in c&&i(3,s=c.opacity),"class"in c&&i(0,l=c.class),"$$scope"in c&&i(4,o=c.$$scope)},t.$$.update=()=>{12&t.$$.dirty&&i(1,n=`transform:translateX(${a}px);opacity:${s}`)},[l,n,a,s,o,r]}class k2 extends li{constructor(e){super(),si(this,e,w4,v4,ni,{offset:2,opacity:3,class:0})}}const{document:D$}=Xy;function S4(t){let e,i,n,r;return{c(){e=he(),i=pt("button"),v(i,"class","PinturaImageButton"),v(i,"type","button"),v(i,"title",t[1]),i.disabled=t[2]},m(o,a){et(o,e,a),et(o,i,a),i.innerHTML=t[0],t[11](i),n||(r=[Ct(D$.body,"load",t[5],!0),Ct(D$.body,"error",t[6],!0),Ct(i,"pointerdown",t[4])],n=!0)},p(o,[a]){1&a&&(i.innerHTML=o[0]),2&a&&v(i,"title",o[1]),4&a&&(i.disabled=o[2])},i:Ke,o:Ke,d(o){o&&tt(e),o&&tt(i),t[11](null),n=!1,Bi(r)}}}function k4(t,e,i){let n,{html:r}=e,{title:o}=e,{onclick:a}=e,{disabled:s=!1}=e,{ongrab:l=ge}=e,{ondrag:c=ge}=e,{ondrop:d=ge}=e;const u=f=>vo(p,rt(f.pageX,f.pageY))<256;let p;const h=f=>{document.documentElement.removeEventListener("pointermove",g),document.documentElement.removeEventListener("pointerup",h);const x=rt(f.pageX,f.pageY);if(vo(p,x)<32)return a(f);u(f)||d(f)},g=f=>{u(f)||c(f)},m=f=>n&&n.contains(f)&&f.nodeName==="IMG";return t.$$set=f=>{"html"in f&&i(0,r=f.html),"title"in f&&i(1,o=f.title),"onclick"in f&&i(7,a=f.onclick),"disabled"in f&&i(2,s=f.disabled),"ongrab"in f&&i(8,l=f.ongrab),"ondrag"in f&&i(9,c=f.ondrag),"ondrop"in f&&i(10,d=f.ondrop)},t.$$.update=()=>{8&t.$$.dirty&&n&&n.querySelector("img")&&i(3,n.dataset.loader=!0,n)},[r,o,s,n,f=>{p=rt(f.pageX,f.pageY),l(f),document.documentElement.addEventListener("pointermove",g),document.documentElement.addEventListener("pointerup",h)},({target:f})=>{m(f)&&i(3,n.dataset.load=!0,n)},({target:f})=>{m(f)&&i(3,n.dataset.error=!0,n)},a,l,c,d,function(f){Ai[f?"unshift":"push"](()=>{n=f,i(3,n)})}]}class C2 extends li{constructor(e){super(),si(this,e,k4,S4,ni,{html:0,title:1,onclick:7,disabled:2,ongrab:8,ondrag:9,ondrop:10})}}function B$(t,e,i){const n=t.slice();return n[14]=e[i],n}function O$(t,e){let i,n,r,o,a,s,l;function c(){return e[10](e[14])}function d(...h){return e[11](e[14],...h)}function u(...h){return e[12](e[14],...h)}function p(...h){return e[13](e[14],...h)}return n=new C2({props:{onclick:c,ongrab:d,ondrag:u,ondrop:p,disabled:e[1]||e[14].disabled,title:e[14].title,html:e[14].thumb}}),{key:t,first:null,c(){i=pt("li"),Et(n.$$.fragment),r=he(),v(i,"style",e[6]),this.first=i},m(h,g){et(h,i,g),Rt(n,i,null),kt(i,r),a=!0,s||(l=Ui(o=e[8].call(null,i,e[14])),s=!0)},p(h,g){e=h;const m={};5&g&&(m.onclick=c),9&g&&(m.ongrab=d),17&g&&(m.ondrag=u),33&g&&(m.ondrop=p),3&g&&(m.disabled=e[1]||e[14].disabled),1&g&&(m.title=e[14].title),1&g&&(m.html=e[14].thumb),n.$set(m),(!a||64&g)&&v(i,"style",e[6]),o&&ji(o.update)&&1&g&&o.update.call(null,e[14])},i(h){a||(M(n.$$.fragment,h),a=!0)},o(h){z(n.$$.fragment,h),a=!1},d(h){h&&tt(i),It(n),s=!1,l()}}}function C4(t){let e,i,n=[],r=new Map,o=t[0];const a=s=>s[14].id;for(let s=0;s<o.length;s+=1){let l=B$(t,o,s),c=a(l);r.set(c,n[s]=O$(c,l))}return{c(){e=pt("ul");for(let s=0;s<n.length;s+=1)n[s].c();v(e,"class","PinturaImageButtonList")},m(s,l){et(s,e,l);for(let c=0;c<n.length;c+=1)n[c].m(e,null);i=!0},p(s,[l]){127&l&&(o=s[0],Pe(),n=Ba(n,l,a,1,s,o,r,e,zs,O$,null,B$),Re())},i(s){if(!i){for(let l=0;l<o.length;l+=1)M(n[l]);i=!0}},o(s){for(let l=0;l<n.length;l+=1)z(n[l]);i=!1},d(s){s&&tt(e);for(let l=0;l<n.length;l+=1)n[l].d()}}}function T4(t,e,i){let n,r,{items:o}=e,{disabled:a}=e,{onclickitem:s}=e,{ongrabitem:l}=e,{ondragitem:c}=e,{ondropitem:d}=e;const u=ci(0,{stiffness:.25,damping:.9});return A(t,u,p=>i(9,r=p)),Ls(()=>u.set(1)),t.$$set=p=>{"items"in p&&i(0,o=p.items),"disabled"in p&&i(1,a=p.disabled),"onclickitem"in p&&i(2,s=p.onclickitem),"ongrabitem"in p&&i(3,l=p.ongrabitem),"ondragitem"in p&&i(4,c=p.ondragitem),"ondropitem"in p&&i(5,d=p.ondropitem)},t.$$.update=()=>{512&t.$$.dirty&&i(6,n="opacity:"+r)},[o,a,s,l,c,d,n,u,(p,h)=>h.mount&&h.mount(p.firstChild,h),r,p=>s(p.id),(p,h)=>l&&l(p.id,h),(p,h)=>c&&c(p.id,h),(p,h)=>d&&d(p.id,h)]}class qh extends li{constructor(e){super(),si(this,e,T4,C4,ni,{items:0,disabled:1,onclickitem:2,ongrabitem:3,ondragitem:4,ondropitem:5})}}var Tc=()=>Mr()&&window.devicePixelRatio||1;let Lp=null;var Oc=t=>(Lp===null&&(Lp=Tc()===1?Math.round:e=>e),Lp(t)),ah=(t,e={})=>{if(t){if(e.preventScroll&&Fa()){const i=document.body.scrollTop;return t.focus(),void(document.body.scrollTop=i)}t.focus(e)}},T2=t=>/date|email|number|search|text|url/.test(t.type),Wc=t=>(e=>/textarea/i.test(e.nodeName))(t)||T2(t)||t.isContentEditable;const M4=t=>({}),W$=t=>({}),P4=t=>({}),_$=t=>({});function R4(t){let e,i;const n=[t[7]];let r={$$slots:{default:[E4]},$$scope:{ctx:t}};for(let o=0;o<n.length;o+=1)r=In(r,n[o]);return e=new Fs({props:r}),t[46](e),{c(){Et(e.$$.fragment)},m(o,a){Rt(e,o,a),i=!0},p(o,a){const s=128&a[0]?yr(n,[Pr(o[7])]):{};524288&a[1]&&(s.$$scope={dirty:a,ctx:o}),e.$set(s)},i(o){i||(M(e.$$.fragment,o),i=!0)},o(o){z(e.$$.fragment,o),i=!1},d(o){t[46](null),It(e,o)}}}function I4(t){let e,i;const n=[t[7]];let r={};for(let o=0;o<n.length;o+=1)r=In(r,n[o]);return e=new Fs({props:r}),t[45](e),{c(){Et(e.$$.fragment)},m(o,a){Rt(e,o,a),i=!0},p(o,a){const s=128&a[0]?yr(n,[Pr(o[7])]):{};e.$set(s)},i(o){i||(M(e.$$.fragment,o),i=!0)},o(o){z(e.$$.fragment,o),i=!1},d(o){t[45](null),It(e,o)}}}function E4(t){let e;const i=t[44].label,n=rr(i,t,t[50],_$);return{c(){n&&n.c()},m(r,o){n&&n.m(r,o),e=!0},p(r,o){n&&n.p&&(!e||524288&o[1])&&ar(n,i,r,r[50],e?or(i,r[50],o,P4):sr(r[50]),_$)},i(r){e||(M(n,r),e=!0)},o(r){z(n,r),e=!1},d(r){n&&n.d(r)}}}function V$(t){let e,i,n,r,o,a,s;const l=t[44].details,c=rr(l,t,t[50],W$);return{c(){e=pt("div"),c&&c.c(),i=he(),n=pt("span"),v(n,"class","PinturaPanelTip"),v(n,"style",t[10]),v(e,"class",r=pi(["PinturaPanel","pintura-editor-panel",t[2]])),v(e,"tabindex","-1"),v(e,"style",t[11])},m(d,u){et(d,e,u),c&&c.m(e,null),kt(e,i),kt(e,n),t[47](e),o=!0,a||(s=[Ct(e,"close",t[48]),Ct(e,"keydown",t[18]),Ct(e,"measure",t[49]),Ui(dr.call(null,e))],a=!0)},p(d,u){c&&c.p&&(!o||524288&u[1])&&ar(c,l,d,d[50],o?or(l,d[50],u,M4):sr(d[50]),W$),(!o||1024&u[0])&&v(n,"style",d[10]),(!o||4&u[0]&&r!==(r=pi(["PinturaPanel","pintura-editor-panel",d[2]])))&&v(e,"class",r),(!o||2048&u[0])&&v(e,"style",d[11])},i(d){o||(M(c,d),o=!0)},o(d){z(c,d),o=!1},d(d){d&&tt(e),c&&c.d(d),t[47](null),a=!1,Bi(s)}}}function A4(t){let e,i,n,r,o,a,s,l,c;const d=[I4,R4],u=[];function p(g,m){return g[1]?0:1}i=p(t),n=u[i]=d[i](t);let h=t[6]&&V$(t);return{c(){e=he(),n.c(),r=he(),h&&h.c(),o=he(),a=Tn()},m(g,m){et(g,e,m),u[i].m(g,m),et(g,r,m),h&&h.m(g,m),et(g,o,m),et(g,a,m),s=!0,l||(c=[Ct(document.body,"pointerdown",function(){ji(t[9])&&t[9].apply(this,arguments)}),Ct(document.body,"pointerup",function(){ji(t[8])&&t[8].apply(this,arguments)})],l=!0)},p(g,m){let f=i;i=p(t=g),i===f?u[i].p(t,m):(Pe(),z(u[f],1,1,()=>{u[f]=null}),Re(),n=u[i],n?n.p(t,m):(n=u[i]=d[i](t),n.c()),M(n,1),n.m(r.parentNode,r)),t[6]?h?(h.p(t,m),64&m[0]&&M(h,1)):(h=V$(t),h.c(),M(h,1),h.m(o.parentNode,o)):h&&(Pe(),z(h,1,1,()=>{h=null}),Re())},i(g){s||(M(n),M(h),M(!1),s=!0)},o(g){z(n),z(h),z(!1),s=!1},d(g){g&&tt(e),u[i].d(g),g&&tt(r),h&&h.d(g),g&&tt(o),g&&tt(a),l=!1,Bi(c)}}}function L4(t,e,i){let n,r,o,a,s,l,c,d,u,p,h,g,m,f,x,k,w,C,P,{$$slots:R={},$$scope:W}=e,{buttonClass:T}=e,{buttonLabel:F}=e,{buttonLabelClass:D}=e,{buttonHideLabel:B}=e,{buttonIcon:y}=e,{buttonTitle:_}=e,{panelClass:J}=e,{isActive:S=!1}=e,{onshow:j=({panel:G})=>ah(G,{preventScroll:!0})}=e,{onhide:Q=ge}=e;const ht=dn("isAnimated");A(t,ht,G=>i(43,P=G));const at=dn("rootPortal");A(t,at,G=>i(38,f=G));const U=dn("rootRect");let yt,$t,Mt;A(t,U,G=>i(41,w=G));const dt=()=>i(26,Mt=n&&n.getBoundingClientRect());let Tt=rn(),K=ci(0);A(t,K,G=>i(40,k=G));let q=rn();const Z=pe({x:0,y:0});A(t,Z,G=>i(39,x=G));const xt=ci(-5,{stiffness:.1,damping:.35,precision:.001});A(t,xt,G=>i(42,C=G));let it=!0;const mt=G=>x2(G,f)||$t.isEventTarget(G);let Ft,ie,Dt=!1;const Ot=G=>{Wc(G.target)||(S||dt(),i(31,ie=G),i(0,S=!S))},ae=G=>{/down/i.test(G.key)&&(i(0,S=!0),i(31,ie=G))};return Vo(()=>{if(!f||!Ft)return;const G=Ft;Zy().then(()=>{G.parentNode&&G.remove()})}),t.$$set=G=>{"buttonClass"in G&&i(19,T=G.buttonClass),"buttonLabel"in G&&i(1,F=G.buttonLabel),"buttonLabelClass"in G&&i(20,D=G.buttonLabelClass),"buttonHideLabel"in G&&i(21,B=G.buttonHideLabel),"buttonIcon"in G&&i(22,y=G.buttonIcon),"buttonTitle"in G&&i(23,_=G.buttonTitle),"panelClass"in G&&i(2,J=G.panelClass),"isActive"in G&&i(0,S=G.isActive),"onshow"in G&&i(24,j=G.onshow),"onhide"in G&&i(25,Q=G.onhide),"$$scope"in G&&i(50,W=G.$$scope)},t.$$.update=()=>{if(16&t.$$.dirty[0]&&(n=$t&&$t.getElement()),1073741825&t.$$.dirty[0]&&i(8,g=S?G=>{Dt&&(i(30,Dt=!1),mt(G)||i(0,S=!1))}:void 0),1&t.$$.dirty[0]|4096&t.$$.dirty[1]&&K.set(S?1:0,{hard:P===!1}),1&t.$$.dirty[0]|4096&t.$$.dirty[1]&&xt.set(S?0:-5,{hard:P===!1}),2048&t.$$.dirty[1]&&i(34,r=1-C/-5),1&t.$$.dirty[0]|1024&t.$$.dirty[1]&&w&&S&&dt(),67108873&t.$$.dirty[0]|1024&t.$$.dirty[1]&&w&&yt&&Mt&&S){i(29,it=!0);let G=Mt.x-w.x+.5*Mt.width-.5*yt.width,wt=Mt.y-w.y+Mt.height;const ut=12,Xt=12,ce=w.width-12,te=w.height-12,ve=G,me=wt,V=ve+yt.width,Ce=me+yt.height;ve<ut&&(i(28,q.x=ve-ut,q),G=ut),V>ce&&(i(28,q.x=V-ce,q),G=ce-yt.width),Ce>te?(i(27,Tt.y=-1,Tt),Xt<wt-yt.height-Mt.height?(i(28,q.y=0,q),wt-=yt.height+Mt.height):(i(28,q.y=wt-(Ce-te),q),wt-=Ce-te-12,i(29,it=!1))):i(27,Tt.y=1,Tt),vt(Z,x=So(rt(G,wt),Oc),x)}512&t.$$.dirty[1]&&i(6,o=k>0),512&t.$$.dirty[1]&&i(37,a=k<1),134217728&t.$$.dirty[0]|2304&t.$$.dirty[1]&&i(36,s=`translateX(${Math.round(x.x)+12*Tt.x}px) translateY(${Math.round(x.y)+12*Tt.y+Tt.y*C}px)`),1024&t.$$.dirty[1]&&i(35,l=`--panel-max-height:${w.height-24}px`),624&t.$$.dirty[1]&&i(11,c=a?`opacity: ${k}; pointer-events: ${k<1?"none":"all"}; transform: ${s};${l}`:`transform: ${s};${l}`),8&t.$$.dirty[1]&&i(32,d=.5+.5*r),8&t.$$.dirty[1]&&i(33,u=r),939524104&t.$$.dirty[0]|262&t.$$.dirty[1]&&i(10,p=x&&yt&&`opacity:${it?u:0};transform:scaleX(${d})rotate(45deg);top:${Tt.y<0?q.y+yt.height:0}px;left:${q.x+.5*yt.width}px`),1&t.$$.dirty[0]&&i(9,h=S?G=>{mt(G)||i(30,Dt=!0)}:void 0),96&t.$$.dirty[0]|128&t.$$.dirty[1]&&o&&f&&Ft&&Ft.parentNode!==f&&f.append(Ft),1&t.$$.dirty[0]&&(S||i(31,ie=void 0)),16777313&t.$$.dirty[0]|1&t.$$.dirty[1]&&S&&o&&Ft&&j({e:ie,panel:Ft}),33554497&t.$$.dirty[0]&&o&&!S&&Q(),16252930&t.$$.dirty[0]&&i(7,m={label:F,icon:y,class:pi(["PinturaPanelButton",T]),onkeydown:ae,onclick:Ot,hideLabel:B,labelClass:D,title:_})},[S,F,J,yt,$t,Ft,o,m,g,h,p,c,ht,at,U,K,Z,xt,G=>{/esc/i.test(G.key)&&(i(0,S=!1),n.focus())},T,D,B,y,_,j,Q,Mt,Tt,q,it,Dt,ie,d,u,r,l,s,a,f,x,k,w,C,P,R,function(G){Ai[G?"unshift":"push"](()=>{$t=G,i(4,$t)})},function(G){Ai[G?"unshift":"push"](()=>{$t=G,i(4,$t)})},function(G){Ai[G?"unshift":"push"](()=>{Ft=G,i(5,Ft)})},G=>{G.stopPropagation(),i(0,S=!1)},G=>i(3,yt=Da(G.detail)),W]}class Lu extends li{constructor(e){super(),si(this,e,L4,A4,ni,{buttonClass:19,buttonLabel:1,buttonLabelClass:20,buttonHideLabel:21,buttonIcon:22,buttonTitle:23,panelClass:2,isActive:0,onshow:24,onhide:25},null,[-1,-1])}}var z4={Up:38,Down:40,Left:37,Right:39};function F4(t){let e,i,n,r,o,a,s,l;const c=t[15].default,d=rr(c,t,t[14],null);return{c(){e=pt("li"),i=pt("input"),n=he(),r=pt("label"),d&&d.c(),v(i,"type","radio"),v(i,"class","implicit"),v(i,"id",t[7]),v(i,"name",t[0]),i.value=t[3],i.disabled=t[6],i.hidden=t[5],i.checked=t[4],v(r,"for",t[7]),v(r,"title",t[2]),v(e,"class",o=pi(["PinturaRadioGroupOption",t[1]])),v(e,"data-hidden",t[5]),v(e,"data-disabled",t[6]),v(e,"data-selected",t[4])},m(u,p){et(u,e,p),kt(e,i),kt(e,n),kt(e,r),d&&d.m(r,null),a=!0,s||(l=[Ct(i,"change",Gb(t[16])),Ct(i,"keydown",t[9]),Ct(i,"click",t[10])],s=!0)},p(u,[p]){(!a||128&p)&&v(i,"id",u[7]),(!a||1&p)&&v(i,"name",u[0]),(!a||8&p)&&(i.value=u[3]),(!a||64&p)&&(i.disabled=u[6]),(!a||32&p)&&(i.hidden=u[5]),(!a||16&p)&&(i.checked=u[4]),d&&d.p&&(!a||16384&p)&&ar(d,c,u,u[14],a?or(c,u[14],p,null):sr(u[14]),null),(!a||128&p)&&v(r,"for",u[7]),(!a||4&p)&&v(r,"title",u[2]),(!a||2&p&&o!==(o=pi(["PinturaRadioGroupOption",u[1]])))&&v(e,"class",o),(!a||32&p)&&v(e,"data-hidden",u[5]),(!a||64&p)&&v(e,"data-disabled",u[6]),(!a||16&p)&&v(e,"data-selected",u[4])},i(u){a||(M(d,u),a=!0)},o(u){z(d,u),a=!1},d(u){u&&tt(e),d&&d.d(u),s=!1,Bi(l)}}}function D4(t,e,i){let n,r,{$$slots:o={},$$scope:a}=e,{name:s}=e,{class:l}=e,{label:c}=e,{id:d}=e,{value:u}=e,{checked:p}=e,{onkeydown:h}=e,{onclick:g}=e,{hidden:m=!1}=e,{disabled:f=!1}=e;const x=Object.values(z4),k=dn("keysPressed");return A(t,k,w=>i(17,r=w)),t.$$set=w=>{"name"in w&&i(0,s=w.name),"class"in w&&i(1,l=w.class),"label"in w&&i(2,c=w.label),"id"in w&&i(11,d=w.id),"value"in w&&i(3,u=w.value),"checked"in w&&i(4,p=w.checked),"onkeydown"in w&&i(12,h=w.onkeydown),"onclick"in w&&i(13,g=w.onclick),"hidden"in w&&i(5,m=w.hidden),"disabled"in w&&i(6,f=w.disabled),"$$scope"in w&&i(14,a=w.$$scope)},t.$$.update=()=>{2049&t.$$.dirty&&i(7,n=`${s}-${d}`)},[s,l,c,u,p,m,f,n,k,w=>{h(w)},w=>{r.some(C=>x.includes(C))||g(w)},d,h,g,a,o,function(w){Wr.call(this,t,w)}]}class M2 extends li{constructor(e){super(),si(this,e,D4,F4,ni,{name:0,class:1,label:2,id:11,value:3,checked:4,onkeydown:12,onclick:13,hidden:5,disabled:6})}}var Ts=(t=[])=>t.reduce((e,i)=>(Ln(i)?Ln(i[1]):i.options)?e.concat(Ln(i)?i[1]:i.options):(e.push(i),e),[]);const Xd=(t,e,i)=>{let n;return Ln(t)?n={id:e,value:t[0],label:t[1],...t[2]||{}}:(n=t,n.id=n.id!=null?n.id:e),i?i(n):n};var nr=(t,e,i)=>on(t)?t(e,i):t;const P2=(t,e)=>t.map(([i,n,r])=>{if(Ln(n))return[nr(i,e),P2(n,e)];{const o=[i,nr(n,e)];if(r){let a={...r};r.icon&&(a.icon=nr(r.icon,e)),o.push(a)}return o}});var R2=(t,e)=>P2(t,e),I2=(t,e)=>Array.isArray(t)&&Array.isArray(e)?as(t,e):t===e;function N$(t,e,i){const n=t.slice();return n[27]=e[i],n}const B4=t=>({option:1024&t[0]}),H$=t=>({option:t[27]});function j$(t,e,i){const n=t.slice();return n[27]=e[i],n}const O4=t=>({option:1024&t[0]}),U$=t=>({option:t[27]}),W4=t=>({option:1024&t[0]}),G$=t=>({option:t[27]});function Z$(t){let e,i,n,r,o,a=[],s=new Map,l=t[1]&&X$(t),c=t[10];const d=u=>u[27].id;for(let u=0;u<c.length;u+=1){let p=N$(t,c,u),h=d(p);s.set(h,a[u]=tg(h,p))}return{c(){e=pt("fieldset"),l&&l.c(),i=he(),n=pt("ul");for(let u=0;u<a.length;u+=1)a[u].c();v(n,"class","PinturaRadioGroupOptions"),v(e,"class",r=pi(["PinturaRadioGroup",t[3]])),v(e,"data-layout",t[5]),v(e,"title",t[7])},m(u,p){et(u,e,p),l&&l.m(e,null),kt(e,i),kt(e,n);for(let h=0;h<a.length;h+=1)a[h].m(n,null);o=!0},p(u,p){u[1]?l?l.p(u,p):(l=X$(u),l.c(),l.m(e,i)):l&&(l.d(1),l=null),8419153&p[0]&&(c=u[10],Pe(),a=Ba(a,p,d,1,u,c,s,n,zs,tg,null,N$),Re()),(!o||8&p[0]&&r!==(r=pi(["PinturaRadioGroup",u[3]])))&&v(e,"class",r),(!o||32&p[0])&&v(e,"data-layout",u[5]),(!o||128&p[0])&&v(e,"title",u[7])},i(u){if(!o){for(let p=0;p<c.length;p+=1)M(a[p]);o=!0}},o(u){for(let p=0;p<a.length;p+=1)z(a[p]);o=!1},d(u){u&&tt(e),l&&l.d();for(let p=0;p<a.length;p+=1)a[p].d()}}}function X$(t){let e,i,n;return{c(){e=pt("legend"),i=gn(t[1]),v(e,"class",n=t[2]&&"implicit")},m(r,o){et(r,e,o),kt(e,i)},p(r,o){2&o[0]&&zn(i,r[1]),4&o[0]&&n!==(n=r[2]&&"implicit")&&v(e,"class",n)},d(r){r&&tt(e)}}}function _4(t){let e,i;return e=new M2({props:{name:t[4],label:t[27].label,id:t[27].id,value:t[27].value,disabled:t[27].disabled,hidden:t[27].hidden,class:t[8],checked:t[12](t[27])===t[0],onkeydown:t[13](t[27]),onclick:t[14](t[27]),$$slots:{default:[H4]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};16&r[0]&&(o.name=n[4]),1024&r[0]&&(o.label=n[27].label),1024&r[0]&&(o.id=n[27].id),1024&r[0]&&(o.value=n[27].value),1024&r[0]&&(o.disabled=n[27].disabled),1024&r[0]&&(o.hidden=n[27].hidden),256&r[0]&&(o.class=n[8]),1025&r[0]&&(o.checked=n[12](n[27])===n[0]),1024&r[0]&&(o.onkeydown=n[13](n[27])),1024&r[0]&&(o.onclick=n[14](n[27])),8389696&r[0]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function V4(t){let e,i,n,r,o,a,s=[],l=new Map;const c=t[22].group,d=rr(c,t,t[23],G$),u=d||function(g){let m,f,x=g[27].label+"";return{c(){m=pt("span"),f=gn(x),v(m,"class","PinturaRadioGroupOptionGroupLabel")},m(k,w){et(k,m,w),kt(m,f)},p(k,w){1024&w[0]&&x!==(x=k[27].label+"")&&zn(f,x)},d(k){k&&tt(m)}}}(t);let p=t[27].options;const h=g=>g[27].id;for(let g=0;g<p.length;g+=1){let m=j$(t,p,g),f=h(m);l.set(f,s[g]=Q$(f,m))}return{c(){e=pt("li"),u&&u.c(),i=he(),n=pt("ul");for(let g=0;g<s.length;g+=1)s[g].c();r=he(),v(n,"class","PinturaRadioGroupOptions"),v(e,"class",o=pi(["PinturaRadioGroupOptionGroup",t[9]]))},m(g,m){et(g,e,m),u&&u.m(e,null),kt(e,i),kt(e,n);for(let f=0;f<s.length;f+=1)s[f].m(n,null);kt(e,r),a=!0},p(g,m){d?d.p&&(!a||8389632&m[0])&&ar(d,c,g,g[23],a?or(c,g[23],m,W4):sr(g[23]),G$):u&&u.p&&(!a||1024&m[0])&&u.p(g,a?m:[-1,-1]),8418641&m[0]&&(p=g[27].options,Pe(),s=Ba(s,m,h,1,g,p,l,n,zs,Q$,null,j$),Re()),(!a||512&m[0]&&o!==(o=pi(["PinturaRadioGroupOptionGroup",g[9]])))&&v(e,"class",o)},i(g){if(!a){M(u,g);for(let m=0;m<p.length;m+=1)M(s[m]);a=!0}},o(g){z(u,g);for(let m=0;m<s.length;m+=1)z(s[m]);a=!1},d(g){g&&tt(e),u&&u.d(g);for(let m=0;m<s.length;m+=1)s[m].d()}}}function Y$(t){let e,i;return e=new Co({props:{$$slots:{default:[N4]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};8389632&r[0]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function N4(t){let e,i=t[27].icon+"";return{c(){e=fr("g")},m(n,r){et(n,e,r),e.innerHTML=i},p(n,r){1024&r[0]&&i!==(i=n[27].icon+"")&&(e.innerHTML=i)},d(n){n&&tt(e)}}}function q$(t){let e,i,n=t[27].label+"";return{c(){e=pt("span"),i=gn(n),v(e,"class",t[6])},m(r,o){et(r,e,o),kt(e,i)},p(r,o){1024&o[0]&&n!==(n=r[27].label+"")&&zn(i,n),64&o[0]&&v(e,"class",r[6])},d(r){r&&tt(e)}}}function H4(t){let e;const i=t[22].option,n=rr(i,t,t[23],H$),r=n||function(o){let a,s,l,c=o[27].icon&&Y$(o),d=!o[27].hideLabel&&q$(o);return{c(){c&&c.c(),a=he(),d&&d.c(),s=he()},m(u,p){c&&c.m(u,p),et(u,a,p),d&&d.m(u,p),et(u,s,p),l=!0},p(u,p){u[27].icon?c?(c.p(u,p),1024&p[0]&&M(c,1)):(c=Y$(u),c.c(),M(c,1),c.m(a.parentNode,a)):c&&(Pe(),z(c,1,1,()=>{c=null}),Re()),u[27].hideLabel?d&&(d.d(1),d=null):d?d.p(u,p):(d=q$(u),d.c(),d.m(s.parentNode,s))},i(u){l||(M(c),l=!0)},o(u){z(c),l=!1},d(u){c&&c.d(u),u&&tt(a),d&&d.d(u),u&&tt(s)}}}(t);return{c(){r&&r.c()},m(o,a){r&&r.m(o,a),e=!0},p(o,a){n?n.p&&(!e||8389632&a[0])&&ar(n,i,o,o[23],e?or(i,o[23],a,B4):sr(o[23]),H$):r&&r.p&&(!e||1088&a[0])&&r.p(o,e?a:[-1,-1])},i(o){e||(M(r,o),e=!0)},o(o){z(r,o),e=!1},d(o){r&&r.d(o)}}}function K$(t){let e,i;return e=new Co({props:{$$slots:{default:[j4]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};8389632&r[0]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function j4(t){let e,i=t[27].icon+"";return{c(){e=fr("g")},m(n,r){et(n,e,r),e.innerHTML=i},p(n,r){1024&r[0]&&i!==(i=n[27].icon+"")&&(e.innerHTML=i)},d(n){n&&tt(e)}}}function J$(t){let e,i,n=t[27].label+"";return{c(){e=pt("span"),i=gn(n),v(e,"class",t[6])},m(r,o){et(r,e,o),kt(e,i)},p(r,o){1024&o[0]&&n!==(n=r[27].label+"")&&zn(i,n),64&o[0]&&v(e,"class",r[6])},d(r){r&&tt(e)}}}function U4(t){let e;const i=t[22].option,n=rr(i,t,t[23],U$),r=n||function(o){let a,s,l,c=o[27].icon&&K$(o),d=!o[27].hideLabel&&J$(o);return{c(){c&&c.c(),a=he(),d&&d.c(),s=he()},m(u,p){c&&c.m(u,p),et(u,a,p),d&&d.m(u,p),et(u,s,p),l=!0},p(u,p){u[27].icon?c?(c.p(u,p),1024&p[0]&&M(c,1)):(c=K$(u),c.c(),M(c,1),c.m(a.parentNode,a)):c&&(Pe(),z(c,1,1,()=>{c=null}),Re()),u[27].hideLabel?d&&(d.d(1),d=null):d?d.p(u,p):(d=J$(u),d.c(),d.m(s.parentNode,s))},i(u){l||(M(c),l=!0)},o(u){z(c),l=!1},d(u){c&&c.d(u),u&&tt(a),d&&d.d(u),u&&tt(s)}}}(t);return{c(){r&&r.c()},m(o,a){r&&r.m(o,a),e=!0},p(o,a){n?n.p&&(!e||8389632&a[0])&&ar(n,i,o,o[23],e?or(i,o[23],a,O4):sr(o[23]),U$):r&&r.p&&(!e||1088&a[0])&&r.p(o,e?a:[-1,-1])},i(o){e||(M(r,o),e=!0)},o(o){z(r,o),e=!1},d(o){r&&r.d(o)}}}function Q$(t,e){let i,n,r;return n=new M2({props:{name:e[4],label:e[27].label,id:e[27].id,value:e[27].value,disabled:e[27].disabled,hidden:e[27].hidden,class:e[8],checked:e[12](e[27])===e[0],onkeydown:e[13](e[27]),onclick:e[14](e[27]),$$slots:{default:[U4]},$$scope:{ctx:e}}}),{key:t,first:null,c(){i=Tn(),Et(n.$$.fragment),this.first=i},m(o,a){et(o,i,a),Rt(n,o,a),r=!0},p(o,a){e=o;const s={};16&a[0]&&(s.name=e[4]),1024&a[0]&&(s.label=e[27].label),1024&a[0]&&(s.id=e[27].id),1024&a[0]&&(s.value=e[27].value),1024&a[0]&&(s.disabled=e[27].disabled),1024&a[0]&&(s.hidden=e[27].hidden),256&a[0]&&(s.class=e[8]),1025&a[0]&&(s.checked=e[12](e[27])===e[0]),1024&a[0]&&(s.onkeydown=e[13](e[27])),1024&a[0]&&(s.onclick=e[14](e[27])),8389696&a[0]&&(s.$$scope={dirty:a,ctx:e}),n.$set(s)},i(o){r||(M(n.$$.fragment,o),r=!0)},o(o){z(n.$$.fragment,o),r=!1},d(o){o&&tt(i),It(n,o)}}}function tg(t,e){let i,n,r,o,a;const s=[V4,_4],l=[];function c(d,u){return d[27].options?0:1}return n=c(e),r=l[n]=s[n](e),{key:t,first:null,c(){i=Tn(),r.c(),o=Tn(),this.first=i},m(d,u){et(d,i,u),l[n].m(d,u),et(d,o,u),a=!0},p(d,u){let p=n;n=c(e=d),n===p?l[n].p(e,u):(Pe(),z(l[p],1,1,()=>{l[p]=null}),Re(),r=l[n],r?r.p(e,u):(r=l[n]=s[n](e),r.c()),M(r,1),r.m(o.parentNode,o))},i(d){a||(M(r),a=!0)},o(d){z(r),a=!1},d(d){d&&tt(i),l[n].d(d),d&&tt(o)}}}function G4(t){let e,i,n,r=t[11].length&&Z$(t);return{c(){r&&r.c(),e=he(),i=Tn()},m(o,a){r&&r.m(o,a),et(o,e,a),et(o,i,a),n=!0},p(o,a){o[11].length?r?(r.p(o,a),2048&a[0]&&M(r,1)):(r=Z$(o),r.c(),M(r,1),r.m(e.parentNode,e)):r&&(Pe(),z(r,1,1,()=>{r=null}),Re())},i(o){n||(M(r),M(!1),n=!0)},o(o){z(r),z(!1),n=!1},d(o){r&&r.d(o),o&&tt(e),o&&tt(i)}}}function Z4(t,e,i){let n,r,o,{$$slots:a={},$$scope:s}=e;const l=ka();let{label:c}=e,{hideLabel:d=!0}=e,{class:u}=e,{name:p="radio-group-"+na()}=e,{selectedIndex:h=-1}=e,{options:g=[]}=e,{onchange:m}=e,{layout:f}=e,{optionMapper:x}=e,{optionFilter:k}=e,{value:w}=e,{optionLabelClass:C}=e,{title:P}=e,{locale:R}=e,{optionClass:W}=e,{optionGroupClass:T}=e;const F=B=>o.findIndex(y=>y.id===B.id),D=(B,y)=>{i(0,h=F(B));const _={index:h,...B};((J,...S)=>{J&&J(...S)})(m,_,y),l("change",_)};return t.$$set=B=>{"label"in B&&i(1,c=B.label),"hideLabel"in B&&i(2,d=B.hideLabel),"class"in B&&i(3,u=B.class),"name"in B&&i(4,p=B.name),"selectedIndex"in B&&i(0,h=B.selectedIndex),"options"in B&&i(15,g=B.options),"onchange"in B&&i(16,m=B.onchange),"layout"in B&&i(5,f=B.layout),"optionMapper"in B&&i(17,x=B.optionMapper),"optionFilter"in B&&i(18,k=B.optionFilter),"value"in B&&i(19,w=B.value),"optionLabelClass"in B&&i(6,C=B.optionLabelClass),"title"in B&&i(7,P=B.title),"locale"in B&&i(20,R=B.locale),"optionClass"in B&&i(8,W=B.optionClass),"optionGroupClass"in B&&i(9,T=B.optionGroupClass),"$$scope"in B&&i(23,s=B.$$scope)},t.$$.update=()=>{1343488&t.$$.dirty[0]&&i(11,n=R2(k?g.filter(k):g,R)),133120&t.$$.dirty[0]&&i(10,r=((B=[],y)=>{let _=0;return B.map(J=>(_++,Ln(J)?Ln(J[1])?{id:_,label:J[0],options:J[1].map(S=>Xd(S,++_,y))}:Xd(J,_,y):J.options?{id:J.id||_,label:J.label,options:J.options.map(S=>Xd(S,++_,y))}:Xd(J,_,y)))})(n,x)),1024&t.$$.dirty[0]&&i(21,o=Ts(r)),2654209&t.$$.dirty[0]&&h<0&&(i(0,h=o.findIndex(B=>I2(B.value,w))),h<0&&i(0,h=(B=>B.findIndex(y=>y[0]===void 0))(g)))},[h,c,d,u,p,f,C,P,W,T,r,n,F,B=>y=>{var _;_=y.key,/enter| /i.test(_)&&D(B,y)},B=>y=>{D(B,y)},g,m,x,k,w,R,o,a,s]}class ss extends li{constructor(e){super(),si(this,e,Z4,G4,ni,{label:1,hideLabel:2,class:3,name:4,selectedIndex:0,options:15,onchange:16,layout:5,optionMapper:17,optionFilter:18,value:19,optionLabelClass:6,title:7,locale:20,optionClass:8,optionGroupClass:9},null,[-1,-1])}}function eg(t){let e,i,n,r,o,a,s,l,c,d;return{c(){e=pt("div"),i=pt("button"),n=gn("▲"),o=he(),a=pt("button"),s=gn("▼"),v(i,"type","button"),v(i,"tabindex","-1"),v(i,"aria-label",r="increase "+t[7]),v(a,"type","button"),v(a,"tabindex","-1"),v(a,"aria-label",l="decrease "+t[7]),v(e,"class","PinturaInputSpinners")},m(u,p){et(u,e,p),kt(e,i),kt(i,n),kt(e,o),kt(e,a),kt(a,s),c||(d=[Ct(i,"click",t[17]),Ct(a,"click",t[18])],c=!0)},p(u,p){128&p&&r!==(r="increase "+u[7])&&v(i,"aria-label",r),128&p&&l!==(l="decrease "+u[7])&&v(a,"aria-label",l)},d(u){u&&tt(e),c=!1,Bi(d)}}}function X4(t){let e,i,n,r,o,a,s=t[1]==="number"&&t[9]&&eg(t);return{c(){e=pt("div"),i=pt("input"),r=he(),s&&s.c(),v(i,"class","PinturaInputField"),v(i,"title",t[7]),v(i,"type",t[1]),v(i,"min",t[4]),v(i,"max",t[5]),v(i,"step",t[6]),v(i,"inputmode",t[3]),i.value=n=t[14]?t[13]:t[0],v(i,"style",t[11]),v(i,"placeholder",t[8]),v(i,"maxlength",t[12]),i.disabled=t[2],v(i,"spellcheck","false"),v(i,"autocorrect","off"),v(i,"autocapitalize","off"),v(e,"class","PinturaInput")},m(l,c){et(l,e,c),kt(e,i),t[27](i),kt(e,r),s&&s.m(e,null),o||(a=[Ct(i,"input",t[16]),Ct(i,"blur",function(){ji(t[14]&&t[15])&&(t[14]&&t[15]).apply(this,arguments)}),Ct(i,"keydown",t[19]),Ct(i,"keyup",t[20])],o=!0)},p(l,[c]){t=l,128&c&&v(i,"title",t[7]),2&c&&v(i,"type",t[1]),16&c&&v(i,"min",t[4]),32&c&&v(i,"max",t[5]),64&c&&v(i,"step",t[6]),8&c&&v(i,"inputmode",t[3]),24577&c&&n!==(n=t[14]?t[13]:t[0])&&i.value!==n&&(i.value=n),2048&c&&v(i,"style",t[11]),256&c&&v(i,"placeholder",t[8]),4096&c&&v(i,"maxlength",t[12]),4&c&&(i.disabled=t[2]),t[1]==="number"&&t[9]?s?s.p(t,c):(s=eg(t),s.c(),s.m(e,null)):s&&(s.d(1),s=null)},i:Ke,o:Ke,d(l){l&&tt(e),t[27](null),s&&s.d(),o=!1,Bi(a)}}}function Y4(t,e,i){let n,r,o,a,s,l,c,{value:d}=e,{type:u="text"}=e,{disabled:p=!1}=e,{inputmode:h}=e,{min:g}=e,{max:m}=e,{step:f}=e,{onchange:x=ge}=e,{onkeydown:k=ge}=e,{title:w}=e,{stepMultiplier:C=10}=e,{placeholder:P}=e,{enableSpinButtons:R=!0}=e,{enableStopPropagation:W=!1}=e;const T=()=>{let y=l.value;return u==="number"&&(y=h==="numeric"?parseInt(y,10):parseFloat(y),!di(y)||Number.isNaN(y)?y=g||0:n&&(y=Ji(y,g,m))),y};let F=d;const D=()=>{const y=Ji(T()+(c?f*C:f),g,m);y!==d&&(i(25,F=y),i(0,d=y),x(d))},B=()=>{const y=Ji(T()-(c?f*C:f),g,m);y!==d&&(i(25,F=y),i(0,d=y),x(d))};return t.$$set=y=>{"value"in y&&i(0,d=y.value),"type"in y&&i(1,u=y.type),"disabled"in y&&i(2,p=y.disabled),"inputmode"in y&&i(3,h=y.inputmode),"min"in y&&i(4,g=y.min),"max"in y&&i(5,m=y.max),"step"in y&&i(6,f=y.step),"onchange"in y&&i(21,x=y.onchange),"onkeydown"in y&&i(22,k=y.onkeydown),"title"in y&&i(7,w=y.title),"stepMultiplier"in y&&i(23,C=y.stepMultiplier),"placeholder"in y&&i(8,P=y.placeholder),"enableSpinButtons"in y&&i(9,R=y.enableSpinButtons),"enableStopPropagation"in y&&i(24,W=y.enableStopPropagation)},t.$$.update=()=>{48&t.$$.dirty&&i(14,n=di(g)&&di(m)),33555457&t.$$.dirty&&i(13,r=l===document.activeElement?F:d),32&t.$$.dirty&&i(26,o=m?(m+"").length:void 0),67108872&t.$$.dirty&&i(12,a=h==="numeric"&&o?o:void 0),67108864&t.$$.dirty&&i(11,s=o?`min-width:${o}em`:void 0)},[d,u,p,h,g,m,f,w,P,R,l,s,a,r,n,()=>{i(25,F=T()),x(d)},()=>{i(25,F=l.value),x(T())},D,B,y=>{c=y.shiftKey,k(y);const{key:_}=y;W&&y.stopPropagation(),/up|down/i.test(_)&&(/up/i.test(_)&&D(),/down/i.test(_)&&B(),y.preventDefault(),y.stopPropagation())},y=>{const{key:_}=y;/up|down/i.test(_)&&(y.preventDefault(),y.stopPropagation())},x,k,C,W,F,o,function(y){Ai[y?"unshift":"push"](()=>{l=y,i(10,l)})}]}class E2 extends li{constructor(e){super(),si(this,e,Y4,X4,ni,{value:0,type:1,disabled:2,inputmode:3,min:4,max:5,step:6,onchange:21,onkeydown:22,title:7,stepMultiplier:23,placeholder:8,enableSpinButtons:9,enableStopPropagation:24})}}const q4=t=>({}),ig=t=>({});function K4(t){let e,i,n,r,o=(t[2]||t[21])+"",a=t[6]&&ng(t);return{c(){a&&a.c(),e=he(),i=pt("span"),v(i,"class",n=pi(["PinturaButtonLabel",t[3],t[5]&&"implicit"]))},m(s,l){a&&a.m(s,l),et(s,e,l),et(s,i,l),i.innerHTML=o,r=!0},p(s,l){s[6]?a?(a.p(s,l),64&l[0]&&M(a,1)):(a=ng(s),a.c(),M(a,1),a.m(e.parentNode,e)):a&&(Pe(),z(a,1,1,()=>{a=null}),Re()),(!r||2097156&l[0])&&o!==(o=(s[2]||s[21])+"")&&(i.innerHTML=o),(!r||40&l[0]&&n!==(n=pi(["PinturaButtonLabel",s[3],s[5]&&"implicit"])))&&v(i,"class",n)},i(s){r||(M(a),r=!0)},o(s){z(a),r=!1},d(s){a&&a.d(s),s&&tt(e),s&&tt(i)}}}function J4(t){let e,i;return e=new E2({props:{value:t[10],onchange:t[17],enableStopPropagation:!0,type:"number",inputmode:"numeric",min:t[8].reduce(sg,1/0),max:t[8].reduce(lg,-1/0),enableSpinButtons:!1}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};1024&r[0]&&(o.value=n[10]),131072&r[0]&&(o.onchange=n[17]),256&r[0]&&(o.min=n[8].reduce(sg,1/0)),256&r[0]&&(o.max=n[8].reduce(lg,-1/0)),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function ng(t){let e,i;return e=new Co({props:{class:"PinturaButtonIcon",$$slots:{default:[Q4]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};536870976&r[0]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function Q4(t){let e;return{c(){e=fr("g")},m(i,n){et(i,e,n),e.innerHTML=t[6]},p(i,n){64&n[0]&&(e.innerHTML=i[6])},d(i){i&&tt(e)}}}function t5(t){let e,i,n,r,o,a;const s=[J4,K4],l=[];function c(d,u){return d[18]?0:1}return i=c(t),n=l[i]=s[i](t),{c(){e=pt("span"),n.c(),v(e,"slot","label"),v(e,"title",r=nr(t[1],t[16])),v(e,"class",o=pi(["PinturaButtonInner",t[18]&&"PinturaComboBox",t[4]]))},m(d,u){et(d,e,u),l[i].m(e,null),a=!0},p(d,u){let p=i;i=c(d),i===p?l[i].p(d,u):(Pe(),z(l[p],1,1,()=>{l[p]=null}),Re(),n=l[i],n?n.p(d,u):(n=l[i]=s[i](d),n.c()),M(n,1),n.m(e,null)),(!a||65538&u[0]&&r!==(r=nr(d[1],d[16])))&&v(e,"title",r),(!a||262160&u[0]&&o!==(o=pi(["PinturaButtonInner",d[18]&&"PinturaComboBox",d[4]])))&&v(e,"class",o)},i(d){a||(M(n),a=!0)},o(d){z(n),a=!1},d(d){d&&tt(e),l[i].d()}}}function e5(t){let e,i,n=t[31].label+"";return{c(){e=pt("span"),i=gn(n),v(e,"slot","group")},m(r,o){et(r,e,o),kt(e,i)},p(r,o){1&o[1]&&n!==(n=r[31].label+"")&&zn(i,n)},d(r){r&&tt(e)}}}function rg(t){let e,i;return e=new Co({props:{style:on(t[14])?t[14](t[31].value):t[14],$$slots:{default:[i5]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};16384&r[0]|1&r[1]&&(o.style=on(n[14])?n[14](n[31].value):n[14]),536870912&r[0]|1&r[1]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function i5(t){let e,i=t[31].icon+"";return{c(){e=fr("g")},m(n,r){et(n,e,r),e.innerHTML=i},p(n,r){1&r[1]&&i!==(i=n[31].icon+"")&&(e.innerHTML=i)},d(n){n&&tt(e)}}}function og(t){let e,i,n,r,o,a=t[31].label+"",s=t[31].sublabel&&ag(t);return{c(){e=pt("span"),i=new Pu(!1),n=he(),s&&s.c(),i.a=n,v(e,"style",r=on(t[15])?t[15](t[31].value):t[15]),v(e,"class",o=pi(["PinturaDropdownOptionLabel",t[11]]))},m(l,c){et(l,e,c),i.m(a,e),kt(e,n),s&&s.m(e,null)},p(l,c){1&c[1]&&a!==(a=l[31].label+"")&&i.p(a),l[31].sublabel?s?s.p(l,c):(s=ag(l),s.c(),s.m(e,null)):s&&(s.d(1),s=null),32768&c[0]|1&c[1]&&r!==(r=on(l[15])?l[15](l[31].value):l[15])&&v(e,"style",r),2048&c[0]&&o!==(o=pi(["PinturaDropdownOptionLabel",l[11]]))&&v(e,"class",o)},d(l){l&&tt(e),s&&s.d()}}}function ag(t){let e,i=t[31].sublabel+"";return{c(){e=pt("span"),v(e,"class","PinturaDropdownOptionSublabel")},m(n,r){et(n,e,r),e.innerHTML=i},p(n,r){1&r[1]&&i!==(i=n[31].sublabel+"")&&(e.innerHTML=i)},d(n){n&&tt(e)}}}function n5(t){let e,i,n,r=t[31].icon&&rg(t),o=!t[31].hideLabel&&og(t);return{c(){e=pt("span"),r&&r.c(),i=he(),o&&o.c(),v(e,"slot","option")},m(a,s){et(a,e,s),r&&r.m(e,null),kt(e,i),o&&o.m(e,null),n=!0},p(a,s){a[31].icon?r?(r.p(a,s),1&s[1]&&M(r,1)):(r=rg(a),r.c(),M(r,1),r.m(e,i)):r&&(Pe(),z(r,1,1,()=>{r=null}),Re()),a[31].hideLabel?o&&(o.d(1),o=null):o?o.p(a,s):(o=og(a),o.c(),o.m(e,null))},i(a){n||(M(r),n=!0)},o(a){z(r),n=!1},d(a){a&&tt(e),r&&r.d(),o&&o.d()}}}function r5(t){let e,i,n,r,o,a;const s=t[27].controls,l=rr(s,t,t[29],ig);return n=new ss({props:{class:"PinturaOptionsList PinturaScrollableContent",name:t[7],value:t[10],selectedIndex:t[9],optionFilter:t[12],optionMapper:t[13],optionLabelClass:pi(["PinturaDropdownOptionLabel",t[11]]),optionGroupClass:"PinturaListOptionGroup",optionClass:"PinturaListOption",options:t[19],onchange:t[22],$$slots:{option:[n5,({option:c})=>({31:c}),({option:c})=>[0,c?1:0]],group:[e5,({option:c})=>({31:c}),({option:c})=>[0,c?1:0]]},$$scope:{ctx:t}}}),{c(){e=pt("div"),l&&l.c(),i=he(),Et(n.$$.fragment),v(e,"slot","details"),v(e,"class","PinturaOptionsListWrapper")},m(c,d){et(c,e,d),l&&l.m(e,null),kt(e,i),Rt(n,e,null),r=!0,o||(a=Ct(e,"keydown",t[24]),o=!0)},p(c,d){l&&l.p&&(!r||536870912&d[0])&&ar(l,s,c,c[29],r?or(s,c[29],d,q4):sr(c[29]),ig);const u={};128&d[0]&&(u.name=c[7]),1024&d[0]&&(u.value=c[10]),512&d[0]&&(u.selectedIndex=c[9]),4096&d[0]&&(u.optionFilter=c[12]),8192&d[0]&&(u.optionMapper=c[13]),2048&d[0]&&(u.optionLabelClass=pi(["PinturaDropdownOptionLabel",c[11]])),524288&d[0]&&(u.options=c[19]),536922112&d[0]|1&d[1]&&(u.$$scope={dirty:d,ctx:c}),n.$set(u)},i(c){r||(M(l,c),M(n.$$.fragment,c),r=!0)},o(c){z(l,c),z(n.$$.fragment,c),r=!1},d(c){c&&tt(e),l&&l.d(c),It(n),o=!1,a()}}}function o5(t){let e,i,n;function r(a){t[28](a)}let o={onshow:t[23],buttonClass:pi(["PinturaDropdownButton",t[0],t[5]&&"PinturaDropdownIconOnly"]),$$slots:{details:[r5],label:[t5]},$$scope:{ctx:t}};return t[20]!==void 0&&(o.isActive=t[20]),e=new Lu({props:o}),Ai.push(()=>$o(e,"isActive",r)),{c(){Et(e.$$.fragment)},m(a,s){Rt(e,a,s),n=!0},p(a,s){const l={};33&s[0]&&(l.buttonClass=pi(["PinturaDropdownButton",a[0],a[5]&&"PinturaDropdownIconOnly"])),540016638&s[0]&&(l.$$scope={dirty:s,ctx:a}),!i&&1048576&s[0]&&(i=!0,l.isActive=a[20],ko(()=>i=!1)),e.$set(l)},i(a){n||(M(e.$$.fragment,a),n=!0)},o(a){z(e.$$.fragment,a),n=!1},d(a){It(e,a)}}}const sg=(t,[e])=>e<t?e:t,lg=(t,[e])=>e>t?e:t;function a5(t,e,i){let n,r,{$$slots:o={},$$scope:a}=e,{class:s}=e,{title:l}=e,{label:c}=e,{labelClass:d}=e,{innerClass:u}=e,{hideLabel:p=!1}=e,{icon:h}=e,{name:g}=e,{options:m=[]}=e,{selectedIndex:f=-1}=e,{value:x}=e,{optionLabelClass:k}=e,{optionFilter:w}=e,{optionMapper:C}=e,{optionIconStyle:P}=e,{optionLabelStyle:R}=e,{locale:W}=e,{onchange:T=ge}=e,{onload:F=ge}=e,{ondestroy:D=ge}=e,{enableInput:B=!1}=e,y;return Ls(()=>F({options:m})),Vo(()=>D({options:m})),t.$$set=_=>{"class"in _&&i(0,s=_.class),"title"in _&&i(1,l=_.title),"label"in _&&i(2,c=_.label),"labelClass"in _&&i(3,d=_.labelClass),"innerClass"in _&&i(4,u=_.innerClass),"hideLabel"in _&&i(5,p=_.hideLabel),"icon"in _&&i(6,h=_.icon),"name"in _&&i(7,g=_.name),"options"in _&&i(8,m=_.options),"selectedIndex"in _&&i(9,f=_.selectedIndex),"value"in _&&i(10,x=_.value),"optionLabelClass"in _&&i(11,k=_.optionLabelClass),"optionFilter"in _&&i(12,w=_.optionFilter),"optionMapper"in _&&i(13,C=_.optionMapper),"optionIconStyle"in _&&i(14,P=_.optionIconStyle),"optionLabelStyle"in _&&i(15,R=_.optionLabelStyle),"locale"in _&&i(16,W=_.locale),"onchange"in _&&i(17,T=_.onchange),"onload"in _&&i(25,F=_.onload),"ondestroy"in _&&i(26,D=_.ondestroy),"enableInput"in _&&i(18,B=_.enableInput),"$$scope"in _&&i(29,a=_.$$scope)},t.$$.update=()=>{65792&t.$$.dirty[0]&&i(19,n=W?R2(m,W):m),525312&t.$$.dirty[0]&&i(21,r=n.reduce((_,J)=>{if(_)return _;const S=Array.isArray(J)?J:[J,J],[j,Q]=S;return I2(j,x)?Q:void 0},void 0)||(_=>{const J=_.find(S=>S[0]===void 0);if(J)return J[1]})(n)||x)},[s,l,c,d,u,p,h,g,m,f,x,k,w,C,P,R,W,T,B,n,y,r,_=>{i(21,r=_.value),T(_),i(20,y=!1)},({e:_,panel:J})=>{if(_&&_.key&&/up|down/i.test(_.key))return ah(J.querySelector("input:not([disabled])"));ah(J.querySelector("fieldset"))},_=>{/tab/i.test(_.key)&&_.preventDefault()},F,D,o,function(_){y=_,i(20,y)},a]}class Kh extends li{constructor(e){super(),si(this,e,a5,o5,ni,{class:0,title:1,label:2,labelClass:3,innerClass:4,hideLabel:5,icon:6,name:7,options:8,selectedIndex:9,value:10,optionLabelClass:11,optionFilter:12,optionMapper:13,optionIconStyle:14,optionLabelStyle:15,locale:16,onchange:17,onload:25,ondestroy:26,enableInput:18},null,[-1,-1])}}function s5(t){let e;return{c(){e=pt("div"),v(e,"slot","details")},m(i,n){et(i,e,n),t[14](e)},p:Ke,d(i){i&&tt(e),t[14](null)}}}function l5(t){let e,i,n;function r(a){t[15](a)}let o={buttonLabel:t[0],buttonClass:t[1],buttonIcon:t[2],buttonHideLabel:t[3],buttonTitle:t[4],buttonLabelClass:t[5],onshow:t[6],onhide:t[7],$$slots:{details:[s5]},$$scope:{ctx:t}};return t[9]!==void 0&&(o.isActive=t[9]),e=new Lu({props:o}),Ai.push(()=>$o(e,"isActive",r)),{c(){Et(e.$$.fragment)},m(a,s){Rt(e,a,s),n=!0},p(a,[s]){const l={};1&s&&(l.buttonLabel=a[0]),2&s&&(l.buttonClass=a[1]),4&s&&(l.buttonIcon=a[2]),8&s&&(l.buttonHideLabel=a[3]),16&s&&(l.buttonTitle=a[4]),32&s&&(l.buttonLabelClass=a[5]),64&s&&(l.onshow=a[6]),128&s&&(l.onhide=a[7]),65792&s&&(l.$$scope={dirty:s,ctx:a}),!i&&512&s&&(i=!0,l.isActive=a[9],ko(()=>i=!1)),e.$set(l)},i(a){n||(M(e.$$.fragment,a),n=!0)},o(a){z(e.$$.fragment,a),n=!1},d(a){It(e,a)}}}function c5(t,e,i){let{buttonLabel:n}=e,{buttonClass:r}=e,{buttonIcon:o}=e,{buttonHideLabel:a}=e,{buttonTitle:s}=e,{buttonLabelClass:l}=e,{root:c}=e,{ondestroy:d=ge}=e,{onshow:u=ge}=e,{onhide:p=ge}=e,h,g=!1;return Vo(d),t.$$set=m=>{"buttonLabel"in m&&i(0,n=m.buttonLabel),"buttonClass"in m&&i(1,r=m.buttonClass),"buttonIcon"in m&&i(2,o=m.buttonIcon),"buttonHideLabel"in m&&i(3,a=m.buttonHideLabel),"buttonTitle"in m&&i(4,s=m.buttonTitle),"buttonLabelClass"in m&&i(5,l=m.buttonLabelClass),"root"in m&&i(10,c=m.root),"ondestroy"in m&&i(11,d=m.ondestroy),"onshow"in m&&i(6,u=m.onshow),"onhide"in m&&i(7,p=m.onhide)},t.$$.update=()=>{1280&t.$$.dirty&&h&&c&&h.firstChild!==c&&(h.hasChildNodes()?h.replaceChild(c,h.firstChild):h.append(c))},[n,r,o,a,s,l,u,p,h,g,c,d,()=>i(9,g=!1),()=>i(9,g=!0),function(m){Ai[m?"unshift":"push"](()=>{h=m,i(8,h)})},function(m){g=m,i(9,g)}]}class d5 extends li{constructor(e){super(),si(this,e,c5,l5,ni,{buttonLabel:0,buttonClass:1,buttonIcon:2,buttonHideLabel:3,buttonTitle:4,buttonLabelClass:5,root:10,ondestroy:11,onshow:6,onhide:7,hide:12,show:13})}get hide(){return this.$$.ctx[12]}get show(){return this.$$.ctx[13]}}var Mc=(t,e,i)=>(t-e)/(i-e);const u5=t=>({}),cg=t=>({});function dg(t){let e,i,n,r,o,a,s,l;return i=new Co({props:{$$slots:{default:[p5]},$$scope:{ctx:t}}}),o=new Co({props:{$$slots:{default:[h5]},$$scope:{ctx:t}}}),{c(){e=pt("button"),Et(i.$$.fragment),n=he(),r=pt("button"),Et(o.$$.fragment),v(e,"type","button"),v(e,"aria-label","Increase"),v(r,"type","button"),v(r,"aria-label","Decrease")},m(c,d){et(c,e,d),Rt(i,e,null),et(c,n,d),et(c,r,d),Rt(o,r,null),a=!0,s||(l=[Ct(e,"pointerdown",t[20](1)),Ct(r,"pointerdown",t[20](-1))],s=!0)},p(c,d){const u={};128&d[1]&&(u.$$scope={dirty:d,ctx:c}),i.$set(u);const p={};128&d[1]&&(p.$$scope={dirty:d,ctx:c}),o.$set(p)},i(c){a||(M(i.$$.fragment,c),M(o.$$.fragment,c),a=!0)},o(c){z(i.$$.fragment,c),z(o.$$.fragment,c),a=!1},d(c){c&&tt(e),It(i),c&&tt(n),c&&tt(r),It(o),s=!1,Bi(l)}}}function p5(t){let e;return{c(){e=fr("path"),v(e,"d","M8 12 h8 M12 8 v8")},m(i,n){et(i,e,n)},p:Ke,d(i){i&&tt(e)}}}function h5(t){let e;return{c(){e=fr("path"),v(e,"d","M9 12 h6")},m(i,n){et(i,e,n)},p:Ke,d(i){i&&tt(e)}}}function m5(t){let e,i,n,r,o,a,s,l,c,d,u,p,h,g,m,f,x;const k=t[36].default,w=rr(k,t,t[38],null),C=t[36].knob,P=rr(C,t,t[38],cg);let R=t[9]&&dg(t);return{c(){e=pt("div"),i=pt("div"),n=pt("input"),o=he(),a=pt("div"),w&&w.c(),l=he(),c=pt("div"),d=pt("div"),P&&P.c(),h=he(),R&&R.c(),v(n,"type","range"),v(n,"id",t[3]),v(n,"min",t[0]),v(n,"max",t[1]),v(n,"step",t[2]),n.value=t[14],v(n,"style",r=t[10]?"pointer-events:none":""),v(a,"class",s=pi(["PinturaSliderTrack",t[5]])),v(a,"style",t[4]),v(d,"class",u=pi(["PinturaSliderKnob",t[7]])),v(d,"style",t[6]),v(c,"class","PinturaSliderKnobController"),v(c,"style",t[17]),v(i,"class","PinturaSliderControl"),v(i,"style",p="--slider-position:"+Math.round(t[15])),v(e,"class",g=pi(["PinturaSlider",t[12]])),v(e,"data-direction",t[8])},m(W,T){et(W,e,T),kt(e,i),kt(i,n),t[37](n),kt(i,o),kt(i,a),w&&w.m(a,null),kt(i,l),kt(i,c),kt(c,d),P&&P.m(d,null),kt(e,h),R&&R.m(e,null),m=!0,f||(x=[Ct(n,"input",t[18]),Ct(n,"nudge",t[19]),Ui(Bs.call(null,n)),Ct(i,"pointerdown",function(){ji(t[11]&&t[13])&&(t[11]&&t[13]).apply(this,arguments)})],f=!0)},p(W,T){t=W,(!m||8&T[0])&&v(n,"id",t[3]),(!m||1&T[0])&&v(n,"min",t[0]),(!m||2&T[0])&&v(n,"max",t[1]),(!m||4&T[0])&&v(n,"step",t[2]),(!m||16384&T[0])&&(n.value=t[14]),(!m||1024&T[0]&&r!==(r=t[10]?"pointer-events:none":""))&&v(n,"style",r),w&&w.p&&(!m||128&T[1])&&ar(w,k,t,t[38],m?or(k,t[38],T,null):sr(t[38]),null),(!m||32&T[0]&&s!==(s=pi(["PinturaSliderTrack",t[5]])))&&v(a,"class",s),(!m||16&T[0])&&v(a,"style",t[4]),P&&P.p&&(!m||128&T[1])&&ar(P,C,t,t[38],m?or(C,t[38],T,u5):sr(t[38]),cg),(!m||128&T[0]&&u!==(u=pi(["PinturaSliderKnob",t[7]])))&&v(d,"class",u),(!m||64&T[0])&&v(d,"style",t[6]),(!m||131072&T[0])&&v(c,"style",t[17]),(!m||32768&T[0]&&p!==(p="--slider-position:"+Math.round(t[15])))&&v(i,"style",p),t[9]?R?(R.p(t,T),512&T[0]&&M(R,1)):(R=dg(t),R.c(),M(R,1),R.m(e,null)):R&&(Pe(),z(R,1,1,()=>{R=null}),Re()),(!m||4096&T[0]&&g!==(g=pi(["PinturaSlider",t[12]])))&&v(e,"class",g),(!m||256&T[0])&&v(e,"data-direction",t[8])},i(W){m||(M(w,W),M(P,W),M(R),m=!0)},o(W){z(w,W),z(P,W),z(R),m=!1},d(W){W&&tt(e),t[37](null),w&&w.d(W),P&&P.d(W),R&&R.d(),f=!1,Bi(x)}}}function $5(t,e,i){let n,r,o,a,s,l,c,d,u,p,h,g,m,f,x,{$$slots:k={},$$scope:w}=e,{min:C=0}=e,{max:P=100}=e,{step:R=1}=e,{id:W}=e,{value:T=0}=e,{valueMin:F}=e,{valueMax:D}=e,{trackStyle:B}=e,{trackClass:y}=e,{knobStyle:_}=e,{knobClass:J}=e,{ongrab:S=ge}=e,{onchange:j=ge}=e,{onrelease:Q=ge}=e,{onexceed:ht=ge}=e,{direction:at="x"}=e,{getValue:U=Yi}=e,{setValue:yt=Yi}=e,{enableSpinButtons:$t=!0}=e,{enableForceUseKnob:Mt=!1}=e,{enableStopPropagation:dt=!0}=e,{enablePointerdownListener:Tt=!0}=e,{maxInteractionDistance:K=6}=e,{class:q}=e;const Z=wt=>yt(((ut,Xt)=>(Xt=1/Xt,Math.round(ut*Xt)/Xt))(Ji(wt,C,P),R),T),xt=(wt,ut,Xt={})=>{const{grabbed:ce=!1,released:te=!1}=Xt,ve=Z(C+wt/ut*r),me=F||C,V=D||P;i(21,T=We(ve)?ve:Ji(ve,me,V)),x!==ve&&(x=ve,!We(ve)&&(ve<me||ve>V)&&ht(T,ve),T!==f&&(f=T,ce&&S(T),j(T),te&&Q(T)))};let it;const mt=wt=>{const ut=wt[d]-m;xt(g+ut,h)},Ft=wt=>{h=void 0,document.documentElement.removeEventListener("pointermove",mt),document.documentElement.removeEventListener("pointerup",Ft),j(T),Q(T)},ie=()=>{i(21,T=Z(n+Ot*R)),j(T)};let Dt,Ot=1,ae=!1;const G=wt=>{clearTimeout(Dt),ae||ie(),Q(T),document.removeEventListener("pointerup",G)};return t.$$set=wt=>{"min"in wt&&i(0,C=wt.min),"max"in wt&&i(1,P=wt.max),"step"in wt&&i(2,R=wt.step),"id"in wt&&i(3,W=wt.id),"value"in wt&&i(21,T=wt.value),"valueMin"in wt&&i(22,F=wt.valueMin),"valueMax"in wt&&i(23,D=wt.valueMax),"trackStyle"in wt&&i(4,B=wt.trackStyle),"trackClass"in wt&&i(5,y=wt.trackClass),"knobStyle"in wt&&i(6,_=wt.knobStyle),"knobClass"in wt&&i(7,J=wt.knobClass),"ongrab"in wt&&i(24,S=wt.ongrab),"onchange"in wt&&i(25,j=wt.onchange),"onrelease"in wt&&i(26,Q=wt.onrelease),"onexceed"in wt&&i(27,ht=wt.onexceed),"direction"in wt&&i(8,at=wt.direction),"getValue"in wt&&i(28,U=wt.getValue),"setValue"in wt&&i(29,yt=wt.setValue),"enableSpinButtons"in wt&&i(9,$t=wt.enableSpinButtons),"enableForceUseKnob"in wt&&i(10,Mt=wt.enableForceUseKnob),"enableStopPropagation"in wt&&i(30,dt=wt.enableStopPropagation),"enablePointerdownListener"in wt&&i(11,Tt=wt.enablePointerdownListener),"maxInteractionDistance"in wt&&i(31,K=wt.maxInteractionDistance),"class"in wt&&i(12,q=wt.class),"$$scope"in wt&&i(38,w=wt.$$scope)},t.$$.update=()=>{270532608&t.$$.dirty[0]&&i(14,n=T!==void 0?U(T):0),3&t.$$.dirty[0]&&(r=P-C),16387&t.$$.dirty[0]&&i(33,o=Mc(n,C,P)),4&t.$$.dirty[1]&&i(15,a=100*o),256&t.$$.dirty[0]&&i(34,s=at.toUpperCase()),256&t.$$.dirty[0]&&i(35,l=at==="x"?"Width":"Height"),16&t.$$.dirty[1]&&(c="offset"+l),t.$$.dirty[1],8&t.$$.dirty[1]&&(d="page"+s),32768&t.$$.dirty[0]|8&t.$$.dirty[1]&&i(17,u=`transform: translate${s}(${a}%)`)},[C,P,R,W,B,y,_,J,at,$t,Mt,Tt,q,wt=>{let ut=!1;dt&&wt.stopPropagation(),clearTimeout(it);const Xt=p.getBoundingClientRect();if(h=p[c],m=wt[d],g=m-Xt[at],Mt){if(Math.abs(g-o*h)>K)return;ut=!0,wt.stopPropagation()}return document.activeElement!==p&&p.focus(),xt(g,h,{grabbed:!0}),document.documentElement.addEventListener("pointermove",mt),document.documentElement.addEventListener("pointerup",Ft),ut},n,a,p,u,wt=>{h||(i(21,T=yt(parseFloat(wt.target.value))),T!==f&&(f=T,j(T)))},wt=>{const ut=p[c];xt(n/r*ut+wt.detail[at],ut),clearTimeout(it),it=setTimeout(()=>{Q(T)},250)},wt=>ut=>{clearTimeout(it),Ot=wt,ae=!1,Dt=setInterval(()=>{ae=!0,ie()},100),document.addEventListener("pointercancel",G),document.addEventListener("pointerup",G)},T,F,D,S,j,Q,ht,U,yt,dt,K,wt=>{const ut=p.getBoundingClientRect(),Xt=wt[d]-ut[at],ce=p[c];return Math.abs(Xt-o*ce)},o,s,l,k,function(wt){Ai[wt?"unshift":"push"](()=>{p=wt,i(16,p)})},w]}class Jh extends li{constructor(e){super(),si(this,e,$5,m5,ni,{min:0,max:1,step:2,id:3,value:21,valueMin:22,valueMax:23,trackStyle:4,trackClass:5,knobStyle:6,knobClass:7,ongrab:24,onchange:25,onrelease:26,onexceed:27,direction:8,getValue:28,setValue:29,enableSpinButtons:9,enableForceUseKnob:10,enableStopPropagation:30,enablePointerdownListener:11,maxInteractionDistance:31,class:12,eventDistanceToKnob:32,handlePointerDown:13},null,[-1,-1])}get eventDistanceToKnob(){return this.$$.ctx[32]}get handlePointerDown(){return this.$$.ctx[13]}}function ug(t){let e,i;return e=new Co({props:{class:"PinturaButtonIcon",$$slots:{default:[g5]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};1048580&r&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function g5(t){let e;return{c(){e=fr("g")},m(i,n){et(i,e,n),e.innerHTML=t[2]},p(i,n){4&n&&(e.innerHTML=i[2])},d(i){i&&tt(e)}}}function pg(t){let e,i,n=nr(t[8],t[6])+"";return{c(){e=pt("span"),i=gn(n),v(e,"class","PinturaButtonLabelPrefix")},m(r,o){et(r,e,o),kt(e,i)},p(r,o){320&o&&n!==(n=nr(r[8],r[6])+"")&&zn(i,n)},d(r){r&&tt(e)}}}function f5(t){let e,i,n,r,o,a,s,l,c,d=t[2]&&ug(t),u=t[8]&&pg(t);return{c(){e=pt("span"),d&&d.c(),i=he(),u&&u.c(),n=he(),r=pt("span"),o=gn(t[9]),v(r,"class",a=pi(["PinturaButtonLabel",t[3],t[5]&&"implicit"])),v(e,"slot","label"),v(e,"title",s=nr(t[1],t[6])),v(e,"class",l=pi(["PinturaButtonInner",t[4]]))},m(p,h){et(p,e,h),d&&d.m(e,null),kt(e,i),u&&u.m(e,null),kt(e,n),kt(e,r),kt(r,o),c=!0},p(p,h){p[2]?d?(d.p(p,h),4&h&&M(d,1)):(d=ug(p),d.c(),M(d,1),d.m(e,i)):d&&(Pe(),z(d,1,1,()=>{d=null}),Re()),p[8]?u?u.p(p,h):(u=pg(p),u.c(),u.m(e,n)):u&&(u.d(1),u=null),(!c||512&h)&&zn(o,p[9]),(!c||40&h&&a!==(a=pi(["PinturaButtonLabel",p[3],p[5]&&"implicit"])))&&v(r,"class",a),(!c||66&h&&s!==(s=nr(p[1],p[6])))&&v(e,"title",s),(!c||16&h&&l!==(l=pi(["PinturaButtonInner",p[4]])))&&v(e,"class",l)},i(p){c||(M(d),c=!0)},o(p){z(d),c=!1},d(p){p&&tt(e),d&&d.d(),u&&u.d()}}}function y5(t){let e,i,n,r,o;const a=[t[12],{value:t[7]},{onchange:t[11]}];let s={};for(let l=0;l<a.length;l+=1)s=In(s,a[l]);return i=new Jh({props:s}),{c(){e=pt("div"),Et(i.$$.fragment),v(e,"slot","details")},m(l,c){et(l,e,c),Rt(i,e,null),n=!0,r||(o=Ct(e,"keydown",t[10]),r=!0)},p(l,c){const d=6272&c?yr(a,[4096&c&&Pr(l[12]),128&c&&{value:l[7]},2048&c&&{onchange:l[11]}]):{};i.$set(d)},i(l){n||(M(i.$$.fragment,l),n=!0)},o(l){z(i.$$.fragment,l),n=!1},d(l){l&&tt(e),It(i),r=!1,o()}}}function x5(t){let e,i;return e=new Lu({props:{panelClass:"PinturaSliderPanel",buttonClass:pi(["PinturaSliderButton",t[0],t[5]&&"PinturaSliderIconOnly"]),$$slots:{details:[y5],label:[f5]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,[r]){const o={};33&r&&(o.buttonClass=pi(["PinturaSliderButton",n[0],n[5]&&"PinturaSliderIconOnly"])),1053694&r&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function b5(t,e,i){const n=["class","title","label","icon","labelClass","innerClass","hideLabel","locale","value","onchange","labelPrefix"];let r=Gm(e,n),{class:o}=e,{title:a}=e,{label:s=Math.round}=e,{icon:l}=e,{labelClass:c}=e,{innerClass:d}=e,{hideLabel:u=!1}=e,{locale:p}=e,{value:h}=e,{onchange:g=ge}=e,{labelPrefix:m}=e;const{min:f,max:x,getValue:k=Yi}=r;let w;const C=P=>i(9,w=(R=>on(s)?s(k(R),f,x,R):s)(P));return t.$$set=P=>{e=In(In({},e),Dc(P)),i(12,r=Gm(e,n)),"class"in P&&i(0,o=P.class),"title"in P&&i(1,a=P.title),"label"in P&&i(13,s=P.label),"icon"in P&&i(2,l=P.icon),"labelClass"in P&&i(3,c=P.labelClass),"innerClass"in P&&i(4,d=P.innerClass),"hideLabel"in P&&i(5,u=P.hideLabel),"locale"in P&&i(6,p=P.locale),"value"in P&&i(7,h=P.value),"onchange"in P&&i(14,g=P.onchange),"labelPrefix"in P&&i(8,m=P.labelPrefix)},t.$$.update=()=>{8320&t.$$.dirty&&C(h)},[o,a,l,c,d,u,p,h,m,w,P=>{/tab/i.test(P.key)&&P.preventDefault()},P=>{C(P),g(P)},r,s,g]}class v5 extends li{constructor(e){super(),si(this,e,b5,x5,ni,{class:0,title:1,label:13,icon:2,labelClass:3,innerClass:4,hideLabel:5,locale:6,value:7,onchange:14,labelPrefix:8})}}function hg(t){let e,i,n=nr(t[0],t[1])+"";return{c(){e=pt("span"),i=gn(n),v(e,"class",t[3])},m(r,o){et(r,e,o),kt(e,i)},p(r,o){3&o&&n!==(n=nr(r[0],r[1])+"")&&zn(i,n),8&o&&v(e,"class",r[3])},d(r){r&&tt(e)}}}function w5(t){let e,i,n,r,o=t[0]&&hg(t);return n=new oo({props:{items:t[2]}}),{c(){e=pt("li"),o&&o.c(),i=he(),Et(n.$$.fragment),v(e,"class","PinturaShapeStyle")},m(a,s){et(a,e,s),o&&o.m(e,null),kt(e,i),Rt(n,e,null),r=!0},p(a,[s]){a[0]?o?o.p(a,s):(o=hg(a),o.c(),o.m(e,i)):o&&(o.d(1),o=null);const l={};4&s&&(l.items=a[2]),n.$set(l)},i(a){r||(M(n.$$.fragment,a),r=!0)},o(a){z(n.$$.fragment,a),r=!1},d(a){a&&tt(e),o&&o.d(),It(n)}}}function S5(t,e,i){let n,{title:r}=e,{locale:o}=e,{items:a}=e,{hideTitle:s=!1}=e;return t.$$set=l=>{"title"in l&&i(0,r=l.title),"locale"in l&&i(1,o=l.locale),"items"in l&&i(2,a=l.items),"hideTitle"in l&&i(4,s=l.hideTitle)},t.$$.update=()=>{16&t.$$.dirty&&i(3,n="PinturaShapeStyleLabel"+(s?" implicit":""))},[r,o,a,n,s]}class k5 extends li{constructor(e){super(),si(this,e,S5,w5,ni,{title:0,locale:1,items:2,hideTitle:4})}}var mg=(t,e,i)=>{let n,r,o;const a=Math.floor(6*t),s=6*t-a,l=i*(1-e),c=i*(1-s*e),d=i*(1-(1-s)*e);switch(a%6){case 0:n=i,r=d,o=l;break;case 1:n=c,r=i,o=l;break;case 2:n=l,r=i,o=d;break;case 3:n=l,r=c,o=i;break;case 4:n=d,r=l,o=i;break;case 5:n=i,r=l,o=c}return[n,r,o]};function C5(t){let e,i,n;return{c(){e=pt("div"),i=pt("span"),v(e,"class","PinturaColorPreview"),v(e,"title",t[0]),v(e,"style",n="--color:"+t[1])},m(r,o){et(r,e,o),kt(e,i)},p(r,[o]){1&o&&v(e,"title",r[0]),2&o&&n!==(n="--color:"+r[1])&&v(e,"style",n)},i:Ke,o:Ke,d(r){r&&tt(e)}}}function T5(t,e,i){let n,{color:r}=e,{title:o}=e;return t.$$set=a=>{"color"in a&&i(2,r=a.color),"title"in a&&i(0,o=a.title)},t.$$.update=()=>{4&t.$$.dirty&&i(1,n=r?gr(r):"transparent")},[o,n,r]}class Qh extends li{constructor(e){super(),si(this,e,T5,C5,ni,{color:2,title:0})}}var A2=t=>(t=t.trim(),/^rgba/.test(t)?t.substr(5).split(",").map(parseFloat).map((e,i)=>e/(i===3?1:255)):/^rgb/.test(t)?t.substr(4).split(",").map(parseFloat).map(e=>e/255):/^#/.test(t)?(e=>{const[,i,n,r,o]=e.split("");e=e.length>=4&&e.length<=5?`#${i}${i}${n}${n}${r}${r}${o?`${o}${o}`:""}`:e;const[a,s,l,c,d]=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})?$/i.exec(e)||[];if(a)return[s,l,c,d].filter(u=>u!==void 0).map(u=>parseInt(u,16)/255)})(t):/[0-9]{1,3}\s?,\s?[0-9]{1,3}\s?,\s?[0-9]{1,3}/.test(t)?t.split(",").map(e=>parseInt(e,10)).map(e=>e/255):void 0);function $g(t){let e,i;return{c(){e=pt("span"),i=gn(t[0])},m(n,r){et(n,e,r),kt(e,i)},p(n,r){1&r[0]&&zn(i,n[0])},d(n){n&&tt(e)}}}function M5(t){let e,i,n,r;i=new Qh({props:{color:t[4],title:nr(t[8],t[10])}});let o=!t[9]&&$g(t);return{c(){e=pt("span"),Et(i.$$.fragment),n=he(),o&&o.c(),v(e,"slot","label"),v(e,"class","PinturaButtonLabel")},m(a,s){et(a,e,s),Rt(i,e,null),kt(e,n),o&&o.m(e,null),r=!0},p(a,s){const l={};16&s[0]&&(l.color=a[4]),1280&s[0]&&(l.title=nr(a[8],a[10])),i.$set(l),a[9]?o&&(o.d(1),o=null):o?o.p(a,s):(o=$g(a),o.c(),o.m(e,null))},i(a){r||(M(i.$$.fragment,a),r=!0)},o(a){z(i.$$.fragment,a),r=!1},d(a){a&&tt(e),It(i),o&&o.d()}}}function gg(t){let e,i,n,r,o,a,s,l,c,d,u,p,h,g;c=new Jh({props:{class:"PinturaHuePicker",knobStyle:"background-color:"+t[20],onchange:t[26],value:t[15],min:0,max:1,step:.01}});let m=t[11]&&fg(t),f=t[14]&&yg(t);return{c(){e=pt("div"),i=pt("div"),n=pt("div"),r=pt("div"),l=he(),Et(c.$$.fragment),d=he(),m&&m.c(),u=he(),f&&f.c(),v(r,"role","button"),v(r,"aria-label","Saturation slider"),v(r,"class","PinturaPickerKnob"),v(r,"tabindex","0"),v(r,"style",o=`background-color:${t[19]};`),v(n,"class","PinturaPickerKnobController"),v(n,"style",a=`transform:translate(${t[24]}%,${t[23]}%)`),v(i,"class","PinturaSaturationPicker"),v(i,"style",s="background-color: "+t[20]),v(e,"class","PinturaPicker")},m(x,k){et(x,e,k),kt(e,i),kt(i,n),kt(n,r),t[38](i),kt(e,l),Rt(c,e,null),kt(e,d),m&&m.m(e,null),kt(e,u),f&&f.m(e,null),p=!0,h||(g=[Ct(r,"nudge",t[29]),Ui(Bs.call(null,r,{preventDefault:!0})),Ct(i,"pointerdown",t[28])],h=!0)},p(x,k){(!p||524288&k[0]&&o!==(o=`background-color:${x[19]};`))&&v(r,"style",o),(!p||25165824&k[0]&&a!==(a=`transform:translate(${x[24]}%,${x[23]}%)`))&&v(n,"style",a),(!p||1048576&k[0]&&s!==(s="background-color: "+x[20]))&&v(i,"style",s);const w={};1048576&k[0]&&(w.knobStyle="background-color:"+x[20]),32768&k[0]&&(w.value=x[15]),c.$set(w),x[11]?m?(m.p(x,k),2048&k[0]&&M(m,1)):(m=fg(x),m.c(),M(m,1),m.m(e,u)):m&&(Pe(),z(m,1,1,()=>{m=null}),Re()),x[14]?f?f.p(x,k):(f=yg(x),f.c(),f.m(e,null)):f&&(f.d(1),f=null)},i(x){p||(M(c.$$.fragment,x),M(m),p=!0)},o(x){z(c.$$.fragment,x),z(m),p=!1},d(x){x&&tt(e),t[38](null),It(c),m&&m.d(),f&&f.d(),h=!1,Bi(g)}}}function fg(t){let e,i;return e=new Jh({props:{class:"PinturaOpacityPicker",knobStyle:"background-color:"+t[17],trackStyle:`background-image:linear-gradient(to right,${t[18]},${t[19]})`,onchange:t[27],value:t[16],min:0,max:1,step:.01}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};131072&r[0]&&(o.knobStyle="background-color:"+n[17]),786432&r[0]&&(o.trackStyle=`background-image:linear-gradient(to right,${n[18]},${n[19]})`),65536&r[0]&&(o.value=n[16]),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function yg(t){let e,i,n;return{c(){e=pt("input"),v(e,"class","PinturaColorPickerInput"),v(e,"type","text"),e.value=t[22]},m(r,o){et(r,e,o),i||(n=[Ct(e,"keydown",t[31]),Ct(e,"input",t[30])],i=!0)},p(r,o){4194304&o[0]&&e.value!==r[22]&&(e.value=r[22])},d(r){r&&tt(e),i=!1,Bi(n)}}}function xg(t){let e,i;return e=new ss({props:{label:nr(t[10].labelColorPalette,t[10]),class:pi(["PinturaColorPresets",t[9]?"PinturaColorPresetsGrid":"PinturaColorPresetsList"]),hideLabel:!1,name:t[1],value:t[4],optionGroupClass:"PinturaListOptionGroup",optionClass:"PinturaListOption",options:t[2].map(t[39]),selectedIndex:t[3],optionMapper:t[7],optionLabelClass:t[6],onchange:t[40],$$slots:{option:[R5,({option:n})=>({52:n}),({option:n})=>[0,n?2097152:0]],group:[P5,({option:n})=>({52:n}),({option:n})=>[0,n?2097152:0]]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};1024&r[0]&&(o.label=nr(n[10].labelColorPalette,n[10])),512&r[0]&&(o.class=pi(["PinturaColorPresets",n[9]?"PinturaColorPresetsGrid":"PinturaColorPresetsList"])),2&r[0]&&(o.name=n[1]),16&r[0]&&(o.value=n[4]),1028&r[0]&&(o.options=n[2].map(n[39])),8&r[0]&&(o.selectedIndex=n[3]),128&r[0]&&(o.optionMapper=n[7]),64&r[0]&&(o.optionLabelClass=n[6]),512&r[0]|6291456&r[1]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function P5(t){let e,i,n=t[52].label+"";return{c(){e=pt("span"),i=gn(n),v(e,"slot","group")},m(r,o){et(r,e,o),kt(e,i)},p(r,o){2097152&o[1]&&n!==(n=r[52].label+"")&&zn(i,n)},d(r){r&&tt(e)}}}function bg(t){let e,i,n=t[52].label+"";return{c(){e=pt("span"),i=gn(n),v(e,"class","PinturaButtonLabel")},m(r,o){et(r,e,o),kt(e,i)},p(r,o){2097152&o[1]&&n!==(n=r[52].label+"")&&zn(i,n)},d(r){r&&tt(e)}}}function R5(t){let e,i,n,r;i=new Qh({props:{title:t[52].label,color:t[52].value}});let o=!t[9]&&bg(t);return{c(){e=pt("span"),Et(i.$$.fragment),n=he(),o&&o.c(),v(e,"slot","option")},m(a,s){et(a,e,s),Rt(i,e,null),kt(e,n),o&&o.m(e,null),r=!0},p(a,s){const l={};2097152&s[1]&&(l.title=a[52].label),2097152&s[1]&&(l.color=a[52].value),i.$set(l),a[9]?o&&(o.d(1),o=null):o?o.p(a,s):(o=bg(a),o.c(),o.m(e,null))},i(a){r||(M(i.$$.fragment,a),r=!0)},o(a){z(i.$$.fragment,a),r=!1},d(a){a&&tt(e),It(i),o&&o.d()}}}function I5(t){let e,i,n,r=t[13]&&gg(t),o=t[12]&&xg(t);return{c(){e=pt("div"),r&&r.c(),i=he(),o&&o.c(),v(e,"slot","details"),v(e,"class","PinturaColorPickerPanel")},m(a,s){et(a,e,s),r&&r.m(e,null),kt(e,i),o&&o.m(e,null),n=!0},p(a,s){a[13]?r?(r.p(a,s),8192&s[0]&&M(r,1)):(r=gg(a),r.c(),M(r,1),r.m(e,i)):r&&(Pe(),z(r,1,1,()=>{r=null}),Re()),a[12]?o?(o.p(a,s),4096&s[0]&&M(o,1)):(o=xg(a),o.c(),M(o,1),o.m(e,null)):o&&(Pe(),z(o,1,1,()=>{o=null}),Re())},i(a){n||(M(r),M(o),n=!0)},o(a){z(r),z(o),n=!1},d(a){a&&tt(e),r&&r.d(),o&&o.d()}}}function E5(t){let e,i;return e=new Lu({props:{buttonClass:pi(["PinturaColorPickerButton",t[5]]),$$slots:{details:[I5],label:[M5]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};32&r[0]&&(o.buttonClass=pi(["PinturaColorPickerButton",n[5]])),33554399&r[0]|4194304&r[1]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function A5(t,e,i){let n,r,o,a,s,l,c,d,u,p,h,g,m,f,{label:x}=e,{name:k}=e,{options:w=[]}=e,{selectedIndex:C=-1}=e,{value:P}=e,{buttonClass:R}=e,{optionLabelClass:W}=e,{optionMapper:T}=e,{onchange:F}=e,{title:D}=e,{hidePresetLabel:B=!0}=e,{locale:y}=e,{enableOpacity:_=!0}=e,{enablePresets:J=!0}=e,{enablePicker:S=!0}=e,{enableInput:j=!1}=e;const Q=(Z,xt)=>{if(u=[Z[0],Z[1],Z[2]],xt){let it=((mt,Ft,ie)=>{let Dt=Math.max(mt,Ft,ie),Ot=Dt-Math.min(mt,Ft,ie),ae=Ot&&(Dt==mt?(Ft-ie)/Ot:Dt==Ft?2+(ie-mt)/Ot:4+(mt-Ft)/Ot);return[60*(ae<0?ae+6:ae)/360,Dt&&Ot/Dt,Dt]})(...u);i(15,s=it[0]),i(33,l=it[1]),i(34,c=it[2]),i(16,d=di(Z[3])?Z[3]:1)}i(17,p=gr(Z)),i(18,h=gr([...u,0])),i(19,g=gr([...u,1])),i(20,m=gr(mg(s,1,1)))},ht=()=>{const Z=[...mg(s,l,c),d];Q(Z),F(Z)},at=Z=>{const xt=Z.length===3?[...Z,1]:Z;Q(xt,!0),F(xt)},U=(Z,xt)=>{const it=Ji(Z.x/xt.width,0,1),mt=Ji(Z.y/xt.height,0,1);var Ft;Ft=1-mt,i(33,l=it),i(34,c=Ft),d===0&&i(16,d=1),ht()};let yt,$t,Mt,dt;const Tt=Z=>{const xt=Bn(hm(Z),dt);U(Dn(Oe(Mt),xt),$t)},K=Z=>{$t=void 0,document.documentElement.removeEventListener("pointermove",Tt),document.documentElement.removeEventListener("pointerup",K)};let q;return t.$$set=Z=>{"label"in Z&&i(0,x=Z.label),"name"in Z&&i(1,k=Z.name),"options"in Z&&i(2,w=Z.options),"selectedIndex"in Z&&i(3,C=Z.selectedIndex),"value"in Z&&i(4,P=Z.value),"buttonClass"in Z&&i(5,R=Z.buttonClass),"optionLabelClass"in Z&&i(6,W=Z.optionLabelClass),"optionMapper"in Z&&i(7,T=Z.optionMapper),"onchange"in Z&&i(32,F=Z.onchange),"title"in Z&&i(8,D=Z.title),"hidePresetLabel"in Z&&i(9,B=Z.hidePresetLabel),"locale"in Z&&i(10,y=Z.locale),"enableOpacity"in Z&&i(11,_=Z.enableOpacity),"enablePresets"in Z&&i(12,J=Z.enablePresets),"enablePicker"in Z&&i(13,S=Z.enablePicker),"enableInput"in Z&&i(14,j=Z.enableInput)},t.$$.update=()=>{16&t.$$.dirty[0]|16&t.$$.dirty[1]&&(!P||f&&as(P,f)||(i(35,f=[...P]),Q(P,!0))),4&t.$$.dirty[1]&&i(24,n=100*l),8&t.$$.dirty[1]&&i(23,r=100-100*c),32&t.$$.dirty[1]&&i(37,o=!!q&&q.length>=4&&q.length<=5),18448&t.$$.dirty[0]|64&t.$$.dirty[1]&&i(22,a=j&&P?((Z,xt,it)=>{let mt=Z.map(Ft=>Math.round(255*Ft).toString(16).toLowerCase().padStart(2,"0"));return(!xt&&mt.length>3||mt[3]==="ff")&&mt.pop(),it&&(mt=mt.map(Ft=>Ft.substring(0,1))),"#"+mt.join("")})(P,_,o):void 0)},[x,k,w,C,P,R,W,T,D,B,y,_,J,S,j,s,d,p,h,g,m,yt,a,r,n,at,Z=>{i(15,s=Z),d===0&&i(16,d=1),ht()},Z=>{i(16,d=Z),ht()},Z=>{Z.stopPropagation(),$t=jn(yt.offsetWidth,yt.offsetHeight),Mt=(xt=>rt(xt.offsetX,xt.offsetY))(Z),dt=hm(Z),U(Mt,$t),document.documentElement.addEventListener("pointermove",Tt),document.documentElement.addEventListener("pointerup",K)},Z=>{$t=jn(yt.offsetWidth,yt.offsetHeight);const xt=n/100*$t.width,it=r/100*$t.height;U({x:xt+Z.detail.x,y:it+Z.detail.y},$t)},Z=>{const{value:xt}=Z.target,it=xt.length;if(!xt.startsWith("#")||it<4||it===6||it===8||it>9||!_&&it>7)return;const mt=A2(xt);mt&&(i(36,q=xt),Q(mt),F(mt))},Z=>{Z.stopPropagation()},F,l,c,f,q,o,function(Z){Ai[Z?"unshift":"push"](()=>{yt=Z,i(21,yt)})},([Z,xt])=>[Z,on(xt)?xt(y):xt],Z=>at(Z.value)]}class L5 extends li{constructor(e){super(),si(this,e,A5,E5,ni,{label:0,name:1,options:2,selectedIndex:3,value:4,buttonClass:5,optionLabelClass:6,optionMapper:7,onchange:32,title:8,hidePresetLabel:9,locale:10,enableOpacity:11,enablePresets:12,enablePicker:13,enableInput:14},null,[-1,-1])}}function z5(t){let e,i,n;return i=new oo({props:{items:t[0]}}),{c(){e=pt("div"),Et(i.$$.fragment),v(e,"class","PinturaShorthandControl PinturaShapeStyle")},m(r,o){et(r,e,o),Rt(i,e,null),n=!0},p(r,[o]){const a={};1&o&&(a.items=r[0]),i.$set(a)},i(r){n||(M(i.$$.fragment,r),n=!0)},o(r){z(i.$$.fragment,r),n=!1},d(r){r&&tt(e),It(i)}}}function F5(t,e,i){let n,r,{value:o}=e,{onchange:a}=e,{controls:s=[]}=e;return t.$$set=l=>{i(6,e=In(In({},e),Dc(l))),"value"in l&&i(1,o=l.value),"onchange"in l&&i(2,a=l.onchange),"controls"in l&&i(3,s=l.controls)},t.$$.update=()=>{i(4,n=(l=>{const{controls:c,...d}=l;return d})(e)),30&t.$$.dirty&&i(0,r=s.map((l,c)=>{const[d,u,p]=l;return[d,u,{...n,...p,value:o[c],onchange:h=>{const g=[...o];g[c]=h,a(g)}}]}))},e=Dc(e),[r,o,a,s,n]}class D5 extends li{constructor(e){super(),si(this,e,F5,z5,ni,{value:1,onchange:2,controls:3})}}function B5(t){let e,i;return e=new Kh({props:{label:t[4],options:t[1],title:t[2],selectedIndex:t[5],onchange:t[10]}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,[r]){const o={};16&r&&(o.label=n[4]),2&r&&(o.options=n[1]),4&r&&(o.title=n[2]),32&r&&(o.selectedIndex=n[5]),9&r&&(o.onchange=n[10]),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function O5(t,e,i){let n,r,o,a,{options:s}=e,{title:l}=e,{onchange:c}=e,{selectedIndex:d=-1}=e,{value:u}=e,{label:p}=e;return t.$$set=h=>{"options"in h&&i(1,s=h.options),"title"in h&&i(2,l=h.title),"onchange"in h&&i(3,c=h.onchange),"selectedIndex"in h&&i(0,d=h.selectedIndex),"value"in h&&i(6,u=h.value),"label"in h&&i(7,p=h.label)},t.$$.update=()=>{67&t.$$.dirty&&i(9,n=((h,g,m)=>{if(h)return g>-1?h[g]:m!==void 0?h.find(f=>f[0]===m):h[0]})(s,d,u)),514&t.$$.dirty&&i(5,r=s&&s.findIndex(h=>h===n)),512&t.$$.dirty&&i(8,o=n&&n[1]),384&t.$$.dirty&&i(4,a=p||o)},[d,s,l,c,a,r,u,p,o,n,h=>{i(0,d=h.index),c&&c(h)}]}class W5 extends li{constructor(e){super(),si(this,e,O5,B5,ni,{options:1,title:2,onchange:3,selectedIndex:0,value:6,label:7})}}function vg(t,e,i){const n=t.slice();return n[9]=e[i][0],n[0]=e[i][1],n[10]=e[i][2],n[2]=e[i][3],n}function _5(t){let e,i,n;const r=[t[10]];var o=t[3][t[9]]||t[9];function a(s){let l={};for(let c=0;c<r.length;c+=1)l=In(l,r[c]);return{props:l}}return o&&(e=yu(o,a())),{c(){e&&Et(e.$$.fragment),i=Tn()},m(s,l){e&&Rt(e,s,l),et(s,i,l),n=!0},p(s,l){const c=4&l?yr(r,[Pr(s[10])]):{};if(o!==(o=s[3][s[9]]||s[9])){if(e){Pe();const d=e;z(d.$$.fragment,1,0,()=>{It(d,1)}),Re()}o?(e=yu(o,a()),Et(e.$$.fragment),M(e.$$.fragment,1),Rt(e,i.parentNode,i)):e=null}else o&&e.$set(c)},i(s){n||(e&&M(e.$$.fragment,s),n=!0)},o(s){e&&z(e.$$.fragment,s),n=!1},d(s){s&&tt(i),e&&It(e,s)}}}function V5(t){let e,i=t[9],n=t[9]&&zp(t);return{c(){n&&n.c(),e=Tn()},m(r,o){n&&n.m(r,o),et(r,e,o)},p(r,o){r[9]?i?ni(i,r[9])?(n.d(1),n=zp(r),n.c(),n.m(e.parentNode,e)):n.p(r,o):(n=zp(r),n.c(),n.m(e.parentNode,e)):i&&(n.d(1),n=null),i=r[9]},i:Ke,o(r){z(n)},d(r){r&&tt(e),n&&n.d(r)}}}function N5(t){let e,i,n=t[10].innerHTML+"";return{c(){e=new Pu(!1),i=Tn(),e.a=i},m(r,o){e.m(n,r,o),et(r,i,o)},p(r,o){4&o&&n!==(n=r[10].innerHTML+"")&&e.p(n)},i:Ke,o:Ke,d(r){r&&tt(i),r&&e.d()}}}function H5(t){let e,i=t[10].textContent+"";return{c(){e=gn(i)},m(n,r){et(n,e,r)},p(n,r){4&r&&i!==(i=n[10].textContent+"")&&zn(e,i)},i:Ke,o:Ke,d(n){n&&tt(e)}}}function j5(t){let e,i;return e=new oo({props:{items:t[2],discardEmptyItems:!0}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};4&r&&(o.items=n[2]),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function zp(t){let e,i,n,r,o;const a=[j5,H5,N5],s=[];function l(u,p){return u[2]&&u[2].length?0:u[10].textContent?1:u[10].innerHTML?2:-1}~(i=l(t))&&(n=s[i]=a[i](t));let c=[t[4](t[10])],d={};for(let u=0;u<c.length;u+=1)d=In(d,c[u]);return{c(){e=pt(t[9]),n&&n.c(),r=he(),/-/.test(t[9])?Xm(e,d):Zm(e,d)},m(u,p){et(u,e,p),~i&&s[i].m(e,null),kt(e,r),o=!0},p(u,p){let h=i;i=l(u),i===h?~i&&s[i].p(u,p):(n&&(Pe(),z(s[h],1,1,()=>{s[h]=null}),Re()),~i?(n=s[i],n?n.p(u,p):(n=s[i]=a[i](u),n.c()),M(n,1),n.m(e,r)):n=null),d=yr(c,[4&p&&u[4](u[10])]),/-/.test(u[9])?Xm(e,d):Zm(e,d)},i(u){o||(M(n),o=!0)},o(u){z(n),o=!1},d(u){u&&tt(e),~i&&s[i].d()}}}function wg(t,e){let i,n,r,o,a,s;const l=[V5,_5],c=[];function d(u,p){return 4&p&&(n=null),n==null&&(n=!u[5](u[9])),n?0:1}return r=d(e,-1),o=c[r]=l[r](e),{key:t,first:null,c(){i=Tn(),o.c(),a=Tn(),this.first=i},m(u,p){et(u,i,p),c[r].m(u,p),et(u,a,p),s=!0},p(u,p){let h=r;r=d(e=u,p),r===h?c[r].p(e,p):(Pe(),z(c[h],1,1,()=>{c[h]=null}),Re(),o=c[r],o?o.p(e,p):(o=c[r]=l[r](e),o.c()),M(o,1),o.m(a.parentNode,a))},i(u){s||(M(o),s=!0)},o(u){z(o),s=!1},d(u){u&&tt(i),c[r].d(u),u&&tt(a)}}}function U5(t){let e,i,n=[],r=new Map,o=t[2];const a=s=>s[0]+s[1];for(let s=0;s<o.length;s+=1){let l=vg(t,o,s),c=a(l);r.set(c,n[s]=wg(c,l))}return{c(){for(let s=0;s<n.length;s+=1)n[s].c();e=Tn()},m(s,l){for(let c=0;c<n.length;c+=1)n[c].m(s,l);et(s,e,l),i=!0},p(s,[l]){62&l&&(o=s[2],Pe(),n=Ba(n,l,a,1,s,o,r,e.parentNode,zs,wg,e,vg),Re())},i(s){if(!i){for(let l=0;l<o.length;l+=1)M(n[l]);i=!0}},o(s){for(let l=0;l<n.length;l+=1)z(n[l]);i=!1},d(s){for(let l=0;l<n.length;l+=1)n[l].d(s);s&&tt(e)}}}function G5(t,e,i){let n,r,{items:o}=e,{discardEmptyItems:a=!0}=e,{key:s=""}=e;const l={Button:Fs,ImageButton:C2,ImageButtonList:qh,Dropdown:Kh,Select:W5,RadioGroup:ss,Input:E2,Panel:d5,ProgressIndicator:S2,ShapeStyle:k5,ToggleSlider:v5,ColorPicker:L5,ShorthandControl:D5},c=u=>!We(u)||!!l[u],d=u=>{if(!u)return!1;const[p,,h,g=[]]=u;return!!c(p)||g.some(d)||h.textContent||h.innerHTML};return t.$$set=u=>{"items"in u&&i(6,o=u.items),"discardEmptyItems"in u&&i(7,a=u.discardEmptyItems),"key"in u&&i(0,s=u.key)},t.$$.update=()=>{1&t.$$.dirty&&i(1,n=s),192&t.$$.dirty&&i(2,r=(o&&a?o.filter(d):o)||[])},[s,n,r,l,(u={})=>{const{textContent:p,innerHTML:h,...g}=u;return g},c,o,a]}class oo extends li{constructor(e){super(),si(this,e,G5,U5,ni,{items:6,discardEmptyItems:7,key:0})}get items(){return this.$$.ctx[6]}set items(e){this.$$set({items:e}),E()}get discardEmptyItems(){return this.$$.ctx[7]}set discardEmptyItems(e){this.$$set({discardEmptyItems:e}),E()}get key(){return this.$$.ctx[0]}set key(e){this.$$set({key:e}),E()}}let Fp=null;var Z5=t=>{if(Fp===null&&(Fp=Mr()&&"visualViewport"in window),!Fp)return!1;const e=visualViewport.height,i=()=>{t(visualViewport.height<e?"visible":"hidden")};return visualViewport.addEventListener("resize",i),()=>visualViewport.removeEventListener("resize",i)};function Sg(t){let e,i;const n=[{onclick:t[1]},t[3]];let r={};for(let o=0;o<n.length;o+=1)r=In(r,n[o]);return e=new Fs({props:r}),{c(){Et(e.$$.fragment)},m(o,a){Rt(e,o,a),i=!0},p(o,a){const s=10&a[0]?yr(n,[2&a[0]&&{onclick:o[1]},8&a[0]&&Pr(o[3])]):{};e.$set(s)},i(o){i||(M(e.$$.fragment,o),i=!0)},o(o){z(e.$$.fragment,o),i=!1},d(o){It(e,o)}}}function kg(t){let e,i;const n=[{onclick:t[0]},{class:"PinturaInputFormButtonConfirm"},t[2]];let r={};for(let o=0;o<n.length;o+=1)r=In(r,n[o]);return e=new Fs({props:r}),{c(){Et(e.$$.fragment)},m(o,a){Rt(e,o,a),i=!0},p(o,a){const s=5&a[0]?yr(n,[1&a[0]&&{onclick:o[0]},n[1],4&a[0]&&Pr(o[2])]):{};e.$set(s)},i(o){i||(M(e.$$.fragment,o),i=!0)},o(o){z(e.$$.fragment,o),i=!1},d(o){It(e,o)}}}function X5(t){let e,i,n,r,o,a,s,l,c=t[3]&&Sg(t);const d=t[24].default,u=rr(d,t,t[23],null);let p=t[2]&&kg(t);return{c(){e=pt("div"),i=pt("div"),c&&c.c(),n=he(),r=pt("div"),u&&u.c(),o=he(),p&&p.c(),v(r,"class","PinturaInputFormFields"),v(i,"class","PinturaInputFormInner"),v(e,"class","PinturaInputForm"),v(e,"data-layout",t[4]),v(e,"style",t[6])},m(h,g){et(h,e,g),kt(e,i),c&&c.m(i,null),kt(i,n),kt(i,r),u&&u.m(r,null),kt(i,o),p&&p.m(i,null),t[25](e),a=!0,s||(l=[Ct(r,"keydown",t[10]),Ct(e,"focusin",t[7]),Ct(e,"focusout",t[8]),Ct(e,"measure",t[9]),Ui(dr.call(null,e))],s=!0)},p(h,g){h[3]?c?(c.p(h,g),8&g[0]&&M(c,1)):(c=Sg(h),c.c(),M(c,1),c.m(i,n)):c&&(Pe(),z(c,1,1,()=>{c=null}),Re()),u&&u.p&&(!a||8388608&g[0])&&ar(u,d,h,h[23],a?or(d,h[23],g,null):sr(h[23]),null),h[2]?p?(p.p(h,g),4&g[0]&&M(p,1)):(p=kg(h),p.c(),M(p,1),p.m(i,null)):p&&(Pe(),z(p,1,1,()=>{p=null}),Re()),(!a||16&g[0])&&v(e,"data-layout",h[4]),(!a||64&g[0])&&v(e,"style",h[6])},i(h){a||(M(c),M(u,h),M(p),a=!0)},o(h){z(c),z(u,h),z(p),a=!1},d(h){h&&tt(e),c&&c.d(),u&&u.d(h),p&&p.d(),t[25](null),s=!1,Bi(l)}}}function Y5(t,e,i){let n,r,o,a,s,{$$slots:l={},$$scope:c}=e,{onconfirm:d}=e,{oncancel:u}=e,{autoFocus:p=!0}=e,{autoPositionCursor:h=!0}=e,{buttonConfirm:g}=e,{buttonCancel:m}=e,{layout:f="stack"}=e,{parentRect:x}=e,{align:k}=e,{justify:w}=e,{parentMargin:C=16}=e,{panelOffset:P=rn()}=e,R=!1,W,T,F="",D=0;const B=()=>{const S=s.querySelector("input, textarea");S.focus(),D>=1||S.select()},y=()=>{R=!0,J||!va()&&!Su()||i(19,F="top:1em;bottom:auto;"),va()&&(S=>{let j;const Q=at=>j=at.touches[0].screenY,ht=at=>{const U=at.touches[0].screenY,yt=at.target;/textarea/i.test(yt.nodeName)?(U>j?yt.scrollTop==0&&at.preventDefault():U<j?yt.scrollTop+yt.offsetHeight==yt.scrollHeight&&at.preventDefault():at.preventDefault(),j=U):at.preventDefault()};S.addEventListener("touchstart",Q),S.addEventListener("touchmove",ht)})(s),i(20,D=1)};let _;const J=Z5(S=>{o?S!=="hidden"||R?(clearTimeout(T),T=void 0,i(19,F=`top:${visualViewport.height-W.height-P.y}px`),S==="visible"?(i(5,s.dataset.stick=!0,s),B(),y()):(R=!1,i(20,D=0))):B():i(19,F="top: 4.5em; bottom: auto")});return Ls(()=>{p&&B()}),Vo(()=>{J&&J()}),t.$$set=S=>{"onconfirm"in S&&i(0,d=S.onconfirm),"oncancel"in S&&i(1,u=S.oncancel),"autoFocus"in S&&i(11,p=S.autoFocus),"autoPositionCursor"in S&&i(12,h=S.autoPositionCursor),"buttonConfirm"in S&&i(2,g=S.buttonConfirm),"buttonCancel"in S&&i(3,m=S.buttonCancel),"layout"in S&&i(4,f=S.layout),"parentRect"in S&&i(13,x=S.parentRect),"align"in S&&i(14,k=S.align),"justify"in S&&i(15,w=S.justify),"parentMargin"in S&&i(16,C=S.parentMargin),"panelOffset"in S&&i(17,P=S.panelOffset),"$$scope"in S&&i(23,c=S.$$scope)},t.$$.update=()=>{385024&t.$$.dirty[0]&&i(21,n=x&&W?((S,j,Q,ht,at)=>{let U,yt;return U=ht==="center"?S.x+.5*S.width-.5*j.width:ht==="right"?S.x+S.width-j.width-at:S.x+at,yt=Q==="center"?S.y+.5*S.height-.5*j.height:Q==="bottom"?S.y+S.height-j.height-at:S.y+at,`left:${U}px;top:${yt}px;right:auto;bottom:auto;`})(x,W,k,w,C):void 0),32&t.$$.dirty[0]&&i(22,r=s&&getComputedStyle(s)),4194304&t.$$.dirty[0]&&(o=r&&r.getPropertyValue("--editor-modal")==="1"),3670016&t.$$.dirty[0]&&i(6,a=`opacity:${D};${n||F}`)},[d,u,g,m,f,s,a,S=>{var j;((Q=>/textarea/i.test(Q))(S.target)||T2(S.target))&&(_=Date.now(),h&&((j=S.target).selectionStart=j.selectionEnd=j.value.length),clearTimeout(T),T=setTimeout(y,200))},S=>{Date.now()-_>50||(S.stopPropagation(),B())},({detail:S})=>{i(18,W={width:S.width,height:S.height})},S=>S.key==="Enter"?d():S.key==="Escape"?u():void 0,p,h,x,k,w,C,P,W,F,D,n,r,c,l,function(S){Ai[S?"unshift":"push"](()=>{s=S,i(5,s)})}]}class L2 extends li{constructor(e){super(),si(this,e,Y5,X5,ni,{onconfirm:0,oncancel:1,autoFocus:11,autoPositionCursor:12,buttonConfirm:2,buttonCancel:3,layout:4,parentRect:13,align:14,justify:15,parentMargin:16,panelOffset:17},null,[-1,-1])}}var Cg=(t,e)=>{t.fastSeek&&t.fastSeek(e),t.currentTime=e};const q5=["aspectRatio","isRotatedSideways","flip","cropSize"],Tg=Vh.map(([t])=>t).filter(t=>!q5.includes(t));var ys=(t,e)=>new CustomEvent("ping",{detail:{type:t,data:e},cancelable:!0,bubbles:!0}),z2=(t,e)=>(e?jh(t,e):t).replace(/([a-z])([A-Z])/g,"$1-$2").replace(/\s+/g,"-").toLowerCase(),Mg=(t,e=Yi)=>{const{subscribe:i,set:n}=pe(void 0);return{subscribe:i,destroy:((r,o)=>{const a=matchMedia(r);return a.addListener(o),o(a),{get matches(){return a.matches},destroy:()=>a.removeListener(o)}})(t,({matches:r})=>n(e(r))).destroy}},Pg=(t,e,i)=>new Promise((n,r)=>{(async()=>{ll(t)&&n(await l2(t));const o=await e.read(t),a=l=>Jf(l,i).then(c=>e.apply(c,o)).then(n).catch(r);if(Kf(t)||!qf()||Fa()||va())return a(t);let s;try{s=await Hc((l,c)=>createImageBitmap(l).then(d=>c(null,d)).catch(c),[t])}catch{}s&&s.width?await wu()?Gh()&&o>1?n(await(async l=>Nc(await Nl(l)))(s)):n(s):n(e.apply(s,o)):a(t)})()}),Rg=(t,e)=>new Promise(async i=>{if(t.width<e.width&&t.height<e.height)return i(t);const n=Math.min(e.width/t.width,e.height/t.height),r=n*t.width,o=n*t.height,a=vn("canvas",{width:r,height:o}),s=a.getContext("2d",{willReadFrequently:!0}),l=Fl(t)?await Nl(t):t;s.drawImage(l,0,0,r,o),i(Nc(a))});let Dp=null;var K5=()=>{if(Dp===null){let t=vn("canvas");Dp=!!Ru(t),qn(t),t=void 0}return Dp};const Ig=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],el={precision:1e-4},Yd={precision:.01*el.precision};var J5=()=>{const t=[],e=[],i=[],n=()=>{e.forEach(o=>o(i))},r=o=>{o.unsub=o.subscribe(a=>((s,l)=>{const c=t.indexOf(s);c<0||(i[c]=l,n())})(o,a)),n()};return{get length(){return t.length},clear:()=>{t.forEach(o=>o.unsub()),t.length=0,i.length=0},unshift:o=>{t.unshift(o),r(o)},get:o=>t[o],push:o=>{t.push(o),r(o)},remove:o=>{o.unsub();const a=t.indexOf(o);t.splice(a,1),i.splice(a,1)},forEach:o=>t.forEach(o),filter:o=>t.filter(o),subscribe:o=>(e.push(o),o(i),()=>{e.splice(e.indexOf(o),1)})}},Bp=t=>t[0]<.25&&t[1]<.25&&t[2]<.25,F2=(t={})=>new Promise(e=>{const{accept:i="image/*"}=t,n=vn("input",{style:"position:absolute;visibility:hidden;width:0;height:0;",type:"file",accept:i}),r=()=>{const[o]=n.files;n.parentNode&&n.remove(),n.removeEventListener("change",r),e(o)};n.addEventListener("change",r),va()&&document.body.append(n),n.click()}),_c=t=>{try{return t()}catch(e){console.error(e)}},Q5=([t,e])=>t+.5*(e-t),Ms=t=>Math.round(100*t),t0=t=>rt(t.clientX,t.clientY),sh=(t,e,i)=>{const n=t0(t);return Bn(Bn(n,e),i)};function t3(t,e,i){let n,r,o,a,s,l,c,d,u,p,h,g,m,f,x,k,w,C,P,R,W,{root:T}=e,{locale:F}=e,{stores:D}=e,{allowPan:B=!0}=e,{allowZoom:y=!0}=e,{enablePan:_=!0}=e,{enableZoom:J=!0}=e,{enableZoomControls:S=J}=e,{enableZoomInput:j=!0}=e,{enablePanInput:Q=!0}=e,{enablePanLimit:ht=!0}=e,{panLimitGutterScalar:at=0}=e,{zoomOptions:U=[.25,.5,1,1.25,1.5,2,3,4,6,8,16]}=e,{zoomAdjustStep:yt=.25}=e,{zoomAdjustFactor:$t=.1}=e,{zoomAdjustWheelFactor:Mt=1}=e,{elasticity:dt=5}=e,{imageSelectionRectCentered:Tt}=e,{imageSelectionRectScalar:K}=e,{zoomLevel:q=null}=e,{zoomControls:Z}=e,{zoomMultiTouching:xt=!1}=e;const{isAnimated:it,isInteracting:mt,rootRect:Ft,stageRect:ie,stageScalar:Dt,imageSelectionPan:Ot,imageSelectionZoom:ae,imageSelectionStageFitScalar:G,imageSelectionRect:wt,imageSelectionStoredState:ut,imagePreviewUpscale:Xt}=D;A(t,it,st=>i(70,R=st)),A(t,mt,st=>i(69,C=st)),A(t,Ft,st=>i(66,x=st)),A(t,ie,st=>i(65,f=st)),A(t,Dt,st=>i(46,P=st)),A(t,Ot,st=>i(64,h=st)),A(t,ae,st=>i(43,p=st)),A(t,G,st=>i(44,g=st)),A(t,wt,st=>i(67,k=st)),A(t,ut,st=>i(71,W=st)),A(t,Xt,st=>i(45,m=st));const ce=dn("fixScrollDirection");A(t,ce,st=>i(68,w=st));let te=!1,ve,me,V,Ce;const yi=st=>{const le=T.querySelector(".PinturaMain > .PinturaUtilMain")||T.querySelector('div[tabindex="0"] .PinturaUtilMain');return!!le&&!!le.contains(st.target)&&!Wc(st.target)},xe=(st={})=>{const{pan:le=h,zoom:ee=p}=st;vt(ut,W={translation:le,zoom:ee},W)},_t=()=>h&&h.x===0&&h.y===0,ze=()=>{vt(ae,p=void 0,p),_t()||vt(Ot,h=rn(),h),Fe.set(void 0,{hard:!0})},Ie=()=>{ze(),xe()},Fe=ci(void 0,{precision:.01});Fe.subscribe(st=>{if(st===void 0)return vt(ae,p=void 0,p),void(_t()||vt(Ot,h=rn(),h));const le=p;st<=1?_t()||vt(Ot,h=rn(),h):st<=le&&vt(Ot,h=Tr(h,.8),h),vt(ae,p=st,p)});const hi=st=>{Fe.update(le=>{const ee=st(le||g);return xe({zoom:ee}),ee})},bt=st=>{st?Fe.set(st,{hard:R===!1}):(st=void 0,Fe.set(void 0,{hard:!0})),vt(ae,p=st,p),xe({zoom:st})},ne=(st,le)=>{const ee=K*le,ye={...Tt},Xe=1-Ji(at,0,1);Cr(ye,ee<Xe?ee:Xe);const $e={...Tt};Cr($e,ee),ta($e,st);const vi={...$e};return $e.x>ye.x&&(vi.x=ye.x),$e.y>ye.y&&(vi.y=ye.y),$e.x+$e.width<ye.x+ye.width&&(vi.x=ye.x+ye.width-$e.width),$e.y+$e.height<ye.y+ye.height&&(vi.y=ye.y+ye.height-$e.height),Bn(Ci(vi),Ci(ye))},Ue=({translation:st,zoom:le=1,elastify:ee=!0})=>{if(!ve)return;let ye=st;const Xe=rt(ve.x+ye.x,ve.y+ye.y);if(!ht)return Xe;const $e=ne(Xe,le);return ee?p4($e,Xe,dt):$e};let Ee,jt;const Ge=()=>{jt=void 0,vt(mt,C=!0,C),i(34,te=Q),Ee=!1,V=!1,ve={...h},me=m?p||g:o?p||1:p||g},Qe=st=>{const{scalar:le,translation:ee,isMultiTouching:ye}=st.detail;if(!ve||!ye&&!Q)return;ye&&Tr(ee,.5),(Q||ye)&&(Ee=!0),xt||i(13,xt=ye);const Xe=n?Ji(me*le,s,l):1,$e=Ue({translation:ee,zoom:Xe,elastify:!0}),vi=Ss($e);Ce=Ss(h),V=vi<Ce,n&&ae.set(Xe),Ot.set($e),jt=xt&&{translation:st.detail.translation,scalar:le}},mi=st=>{vt(mt,C=!1,C),i(34,te=!1),i(13,xt=!1),V&&Ce<50&&(ve=void 0,me=void 0,Ot.set(rn()))},$i=st=>{vt(mt,C=!1,C),i(34,te=!1),i(13,xt=!1),Promise.resolve().then(()=>{if(Ee&&ve){const le=jt||st.detail,ee=n?Ji(me*le.scalar,s,l):1,ye=Ue({elastify:!1,translation:le.translation,zoom:ee});Ot.set(ye)}ve=void 0,me=void 0,Q&&st.detail.isDoubleTap&&Ie(),xe()})};let Li,X=Date.now(),Ut=0,H=!1,Bt=!1;const be=st=>{if(!yi(st)||(st.preventDefault(),st.stopPropagation(),Bt))return;clearTimeout(Li);const le=Au(st,{fixScrollDirection:w}),ee=Date.now(),ye=ee-X;X=ee;const Xe=Math.abs(le/ye)>.2;Ut=Xe?Ut+1:0;const $e=1+-1*le*Mt/(Xe?50:100),vi=sh(st,x,f);se(vi,$e,{isZoomingFast:Xe})},se=(st,le,{isZoomingFast:ee})=>{const ye=m?p||g:o?p||1:p||g,Xe=ye*le,$e=rn(),vi=h,Le=m?g:o?1:g,Gt=Math.abs(Xe-Le),gi=Xe<ye,Ti=ye>Le&&gi||ye<Le&&Xe>ye,Ve=Ut>=5;if(ee||(H=!1),Ut>0&&!H&&(H=Ti),Ve&&H)return Ie(),Bt=!0,void setTimeout(()=>{Bt=!1},100);if(Ve)return;!ee&&Ti&&Gt<=.05&&(Li=setTimeout(()=>{Ie()},250)),vt(ae,p=Ji(Xe,s,l),p);const ri=ki(k);Cr(ri,ye),ta(ri,vi);const Be=Ci(ri),Se=ki(ri);Cr(Se,p-ye+1,st);const Zi=Ci(Se),un=mm(Bn(Zi,Be),ye);((wn,sn,an)=>{wn.x=sn,wn.y=an})($e,vi.x+un.x,vi.y+un.y),vt(Ot,h=gi&&ee?Tr(Oe(h),.85):ne($e,ye),h),xe()},At=st=>(st?"add":"remove")+"EventListener";let re,Me,De,_e;const Ze=st=>{st.preventDefault(),Me={...h},_e=ki(k),De=sh(st,x,f),re=m?p||g:o?p||1:p||g},nt=st=>{st.preventDefault(),vt(ae,p=Ji(st.scale*re,s,l),p);const le=ki(_e);Cr(le,re),ta(le,Me);const ee=Ci(le),ye=ki(le);Cr(ye,p-re+1,De);const Xe=Ci(ye),$e=mm(Bn(Xe,ee),re),vi={x:Me.x+$e.x,y:Me.y+$e.y};vt(Ot,h=ne(vi,p),h)},Qt=st=>{st.preventDefault()},Zt=st=>{T[At(st)]("wheel",be),va()||(T[At(st)]("gesturestart",Ze),T[At(st)]("gesturechange",nt),T[At(st)]("gestureend",Qt))},Kt=st=>{const le=At(st);T[le]("interactionstart",Ge),T[le]("interactionupdate",Qe),T[le]("interactionrelease",mi),T[le]("interactionend",$i)};let Yt;return Ls(()=>{Yt=Ds(T,{drag:!0,pinch:!0,inertia:!0,inertiaDurationMultiplier:10,shouldStartInteraction:yi})}),Vo(()=>{Zt(!1),Kt(!1),Yt.destroy(),Yt=void 0}),t.$$set=st=>{"root"in st&&i(14,T=st.root),"locale"in st&&i(15,F=st.locale),"stores"in st&&i(16,D=st.stores),"allowPan"in st&&i(17,B=st.allowPan),"allowZoom"in st&&i(18,y=st.allowZoom),"enablePan"in st&&i(19,_=st.enablePan),"enableZoom"in st&&i(20,J=st.enableZoom),"enableZoomControls"in st&&i(21,S=st.enableZoomControls),"enableZoomInput"in st&&i(22,j=st.enableZoomInput),"enablePanInput"in st&&i(23,Q=st.enablePanInput),"enablePanLimit"in st&&i(24,ht=st.enablePanLimit),"panLimitGutterScalar"in st&&i(25,at=st.panLimitGutterScalar),"zoomOptions"in st&&i(26,U=st.zoomOptions),"zoomAdjustStep"in st&&i(27,yt=st.zoomAdjustStep),"zoomAdjustFactor"in st&&i(28,$t=st.zoomAdjustFactor),"zoomAdjustWheelFactor"in st&&i(29,Mt=st.zoomAdjustWheelFactor),"elasticity"in st&&i(30,dt=st.elasticity),"imageSelectionRectCentered"in st&&i(31,Tt=st.imageSelectionRectCentered),"imageSelectionRectScalar"in st&&i(32,K=st.imageSelectionRectScalar),"zoomLevel"in st&&i(33,q=st.zoomLevel),"zoomControls"in st&&i(12,Z=st.zoomControls),"zoomMultiTouching"in st&&i(13,xt=st.zoomMultiTouching)},t.$$.update=()=>{var st,le;5505024&t.$$.dirty[0]&&i(36,n=y&&J&&j),655360&t.$$.dirty[0]&&i(35,r=B&&_),393216&t.$$.dirty[0]&&(B||y?(vt(ae,p=J?W.zoom:void 0,p),vt(Ot,h=_?Oe(W.translation):_t()?h:rn(),h),Fe.set(p)):ze()),32768&t.$$.dirty[1]&&(o=P>=1),67141632&t.$$.dirty[0]|57344&t.$$.dirty[1]&&i(40,a=[(m||P<1)&&[g,Ms(g)+"%",{sublabel:F.labelZoomFit}],...U.map(ee=>[ee,Ms(ee)+"%"])].filter(Boolean).map(ee=>(ee[0]===1&&(ee[2]={sublabel:F.labelZoomActual}),ee)).sort((ee,ye)=>{const Xe=ee[0]||g,$e=ye[0]||g;return Xe<$e?-1:$e<Xe?1:0})),8704&t.$$.dirty[1]&&i(38,s=Math.min(a.reduce((ee,[ye])=>ye<ee?ye:ee,Number.MAX_SAFE_INTEGER),g)),512&t.$$.dirty[1]&&i(37,l=a.reduce((ee,[ye])=>ye>ee?ye:ee,Number.MIN_SAFE_INTEGER)),4&t.$$.dirty[1]&&q!==null&&bt(q),61440&t.$$.dirty[1]&&i(42,d=p||(m||P<1?g:1)),2560&t.$$.dirty[1]&&i(39,(st=a.map(([ee])=>ee),le=d,c=st.findIndex(ee=>ee===le))),2048&t.$$.dirty[1]&&i(41,u=Ms(d)+"%"),405045248&t.$$.dirty[0]|6080&t.$$.dirty[1]&&i(12,Z=(y||y)&&S?[["Button","zoom-out",{hideLabel:!0,label:F.labelZoomOut,icon:F.iconZoomOut,disabled:p===s,onclick:()=>hi(ee=>Math.max(s,ee-yt)),onhold:()=>hi(ee=>Math.max(s,ee*(1-$t)))}],["Dropdown","zoom-level",{label:u,labelClass:"PinturaFixedWidthCharacters",options:a,selectedIndex:c,onchange:ee=>bt(ee.value)}],["Button","zoom-in",{hideLabel:!0,label:F.labelZoomIn,icon:F.iconZoomIn,disabled:p===l,onclick:()=>hi(ee=>Math.min(l,ee+yt)),onhold:()=>hi(ee=>Math.min(l,ee*(1+$t)))}]]:[]),16384&t.$$.dirty[0]|32&t.$$.dirty[1]&&T&&Zt(n),16384&t.$$.dirty[0]|16&t.$$.dirty[1]&&T&&Kt(r),8404992&t.$$.dirty[0]|24&t.$$.dirty[1]&&T&&T.style.setProperty("--cursor",r&&Q?te?"grabbing":"grab":"")},[it,mt,Ft,ie,Dt,Ot,ae,G,wt,ut,Xt,ce,Z,xt,T,F,D,B,y,_,J,S,j,Q,ht,at,U,yt,$t,Mt,dt,Tt,K,q,te,r,n,l,s,c,a,u,d,p,g,m,P]}class e3 extends li{constructor(e){super(),si(this,e,t3,null,ni,{root:14,locale:15,stores:16,allowPan:17,allowZoom:18,enablePan:19,enableZoom:20,enableZoomControls:21,enableZoomInput:22,enablePanInput:23,enablePanLimit:24,panLimitGutterScalar:25,zoomOptions:26,zoomAdjustStep:27,zoomAdjustFactor:28,zoomAdjustWheelFactor:29,elasticity:30,imageSelectionRectCentered:31,imageSelectionRectScalar:32,zoomLevel:33,zoomControls:12,zoomMultiTouching:13},null,[-1,-1,-1,-1])}}const{window:il}=Xy;function Eg(t){let e,i,n,r=t[41]&&Ag(t),o=t[38]&&Dg(t);return{c(){r&&r.c(),e=he(),o&&o.c(),i=Tn()},m(a,s){r&&r.m(a,s),et(a,e,s),o&&o.m(a,s),et(a,i,s),n=!0},p(a,s){a[41]?r?(r.p(a,s),1024&s[1]&&M(r,1)):(r=Ag(a),r.c(),M(r,1),r.m(e.parentNode,e)):r&&(Pe(),z(r,1,1,()=>{r=null}),Re()),a[38]?o?(o.p(a,s),128&s[1]&&M(o,1)):(o=Dg(a),o.c(),M(o,1),o.m(i.parentNode,i)):o&&(Pe(),z(o,1,1,()=>{o=null}),Re())},i(a){n||(M(r),M(o),n=!0)},o(a){z(r),z(o),n=!1},d(a){r&&r.d(a),a&&tt(e),o&&o.d(a),a&&tt(i)}}}function Ag(t){let e,i,n,r,o,a;const s=[n3,i3],l=[];function c(d,u){return d[39]?0:d[35]?1:-1}return~(n=c(t))&&(r=l[n]=s[n](t)),{c(){e=pt("div"),i=pt("p"),r&&r.c(),v(i,"style",t[72]),v(e,"class","PinturaStatus"),v(e,"style",o="opacity: "+t[54])},m(d,u){et(d,e,u),kt(e,i),~n&&l[n].m(i,null),a=!0},p(d,u){let p=n;n=c(d),n===p?~n&&l[n].p(d,u):(r&&(Pe(),z(l[p],1,1,()=>{l[p]=null}),Re()),~n?(r=l[n],r?r.p(d,u):(r=l[n]=s[n](d),r.c()),M(r,1),r.m(i,null)):r=null),(!a||1024&u[2])&&v(i,"style",d[72]),(!a||8388608&u[1]&&o!==(o="opacity: "+d[54]))&&v(e,"style",o)},i(d){a||(M(r),a=!0)},o(d){z(r),a=!1},d(d){d&&tt(e),~n&&l[n].d()}}}function i3(t){let e,i,n,r;e=new w2({props:{text:t[35].text||"",onmeasure:t[219]}});let o=t[35].aside&&Lg(t);return{c(){Et(e.$$.fragment),i=he(),o&&o.c(),n=Tn()},m(a,s){Rt(e,a,s),et(a,i,s),o&&o.m(a,s),et(a,n,s),r=!0},p(a,s){const l={};16&s[1]&&(l.text=a[35].text||""),e.$set(l),a[35].aside?o?(o.p(a,s),16&s[1]&&M(o,1)):(o=Lg(a),o.c(),M(o,1),o.m(n.parentNode,n)):o&&(Pe(),z(o,1,1,()=>{o=null}),Re())},i(a){r||(M(e.$$.fragment,a),M(o),r=!0)},o(a){z(e.$$.fragment,a),z(o),r=!1},d(a){It(e,a),a&&tt(i),o&&o.d(a),a&&tt(n)}}}function n3(t){let e,i,n,r;return e=new w2({props:{text:t[39],onmeasure:t[219]}}),n=new k2({props:{class:"PinturaStatusIcon",offset:t[82],opacity:t[83],$$slots:{default:[a3]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment),i=he(),Et(n.$$.fragment)},m(o,a){Rt(e,o,a),et(o,i,a),Rt(n,o,a),r=!0},p(o,a){const s={};256&a[1]&&(s.text=o[39]),e.$set(s);const l={};1048576&a[2]&&(l.offset=o[82]),2097152&a[2]&&(l.opacity=o[83]),8&a[0]|256&a[19]&&(l.$$scope={dirty:a,ctx:o}),n.$set(l)},i(o){r||(M(e.$$.fragment,o),M(n.$$.fragment,o),r=!0)},o(o){z(e.$$.fragment,o),z(n.$$.fragment,o),r=!1},d(o){It(e,o),o&&tt(i),It(n,o)}}}function Lg(t){let e,i;return e=new k2({props:{class:"PinturaStatusButton",offset:t[82],opacity:t[83],$$slots:{default:[r3]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};1048576&r[2]&&(o.offset=n[82]),2097152&r[2]&&(o.opacity=n[83]),16&r[1]|256&r[19]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function zg(t){let e,i;return e=new S2({props:{progress:t[35].progressIndicator.progress}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};16&r[1]&&(o.progress=n[35].progressIndicator.progress),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function Fg(t){let e,i;const n=[t[35].closeButton,{hideLabel:!0}];let r={};for(let o=0;o<n.length;o+=1)r=In(r,n[o]);return e=new Fs({props:r}),{c(){Et(e.$$.fragment)},m(o,a){Rt(e,o,a),i=!0},p(o,a){const s=16&a[1]?yr(n,[Pr(o[35].closeButton),n[1]]):{};e.$set(s)},i(o){i||(M(e.$$.fragment,o),i=!0)},o(o){z(e.$$.fragment,o),i=!1},d(o){It(e,o)}}}function r3(t){let e,i,n,r=t[35].progressIndicator.visible&&zg(t),o=t[35].closeButton&&t[35].text&&Fg(t);return{c(){r&&r.c(),e=he(),o&&o.c(),i=Tn()},m(a,s){r&&r.m(a,s),et(a,e,s),o&&o.m(a,s),et(a,i,s),n=!0},p(a,s){a[35].progressIndicator.visible?r?(r.p(a,s),16&s[1]&&M(r,1)):(r=zg(a),r.c(),M(r,1),r.m(e.parentNode,e)):r&&(Pe(),z(r,1,1,()=>{r=null}),Re()),a[35].closeButton&&a[35].text?o?(o.p(a,s),16&s[1]&&M(o,1)):(o=Fg(a),o.c(),M(o,1),o.m(i.parentNode,i)):o&&(Pe(),z(o,1,1,()=>{o=null}),Re())},i(a){n||(M(r),M(o),n=!0)},o(a){z(r),z(o),n=!1},d(a){r&&r.d(a),a&&tt(e),o&&o.d(a),a&&tt(i)}}}function o3(t){let e,i=t[3].iconSupportError+"";return{c(){e=fr("g")},m(n,r){et(n,e,r),e.innerHTML=i},p(n,r){8&r[0]&&i!==(i=n[3].iconSupportError+"")&&(e.innerHTML=i)},d(n){n&&tt(e)}}}function a3(t){let e,i;return e=new Co({props:{$$slots:{default:[o3]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};8&r[0]|256&r[19]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function Dg(t){let e,i,n,r,o,a,s,l,c,d,u,p,h,g,m=t[10]&&Bg(t),f=t[46]&&t[45]&&Og(t);const x=[h3,p3],k=[];function w(T,F){return T[46]?0:1}function C(T){t[436](T)}function P(T){t[437](T)}function R(T){t[438](T)}n=w(t),r=k[n]=x[n](t),a=new Xv({props:{isAnimated:t[53],isTransparent:t[20],pixelRatio:t[57],textPixelRatio:t[6],backgroundColor:t[56],maskRect:t[58],maskOpacity:t[73]?t[73].maskOpacity:1,maskMarkupOpacity:t[7],maskFrameOpacity:t[5],clipAnnotationsToImage:t[85],images:t[55],interfaceImages:t[86],loadImageData:t[28],enableGrid:t[11],gridSize:t[87],gridColors:[t[88],t[89]],gridOpacity:t[90],selectionColor:t[91],willRequest:t[81]||t[92],willRender:t[433],didRender:t[434]}});let W={root:t[2],locale:t[3],stores:t[200],allowPan:t[94],enablePan:t[17],enablePanLimit:t[21],panLimitGutterScalar:t[22],enablePanInput:t[95],allowZoom:t[96],enableZoom:t[18],enableZoomInput:t[19]!==void 0?t[19]:t[97],enableZoomControls:t[98],zoomOptions:t[13]||t[23],zoomAdjustStep:t[14]||t[24],zoomAdjustFactor:t[15]||t[25],zoomAdjustWheelFactor:t[16]||t[26],imageSelectionRectCentered:t[99],imageSelectionRectScalar:t[100],elasticity:lh*t[8]};return t[0]!==void 0&&(W.zoomLevel=t[0]),t[33]!==void 0&&(W.zoomControls=t[33]),t[34]!==void 0&&(W.zoomMultiTouching=t[34]),d=new e3({props:W}),Ai.push(()=>$o(d,"zoomLevel",C)),Ai.push(()=>$o(d,"zoomControls",P)),Ai.push(()=>$o(d,"zoomMultiTouching",R)),{c(){m&&m.c(),e=he(),f&&f.c(),i=he(),r.c(),o=he(),Et(a.$$.fragment),s=he(),l=pt("div"),c=he(),Et(d.$$.fragment),v(l,"class","PinturaRootPortal")},m(T,F){m&&m.m(T,F),et(T,e,F),f&&f.m(T,F),et(T,i,F),k[n].m(T,F),et(T,o,F),Rt(a,T,F),et(T,s,F),et(T,l,F),t[435](l),et(T,c,F),Rt(d,T,F),g=!0},p(T,F){T[10]?m?(m.p(T,F),1024&F[0]&&M(m,1)):(m=Bg(T),m.c(),M(m,1),m.m(e.parentNode,e)):m&&(Pe(),z(m,1,1,()=>{m=null}),Re()),T[46]&&T[45]?f?(f.p(T,F),49152&F[1]&&M(f,1)):(f=Og(T),f.c(),M(f,1),f.m(i.parentNode,i)):f&&(Pe(),z(f,1,1,()=>{f=null}),Re());let D=n;n=w(T),n===D?k[n].p(T,F):(Pe(),z(k[D],1,1,()=>{k[D]=null}),Re(),r=k[n],r?r.p(T,F):(r=k[n]=x[n](T),r.c()),M(r,1),r.m(o.parentNode,o));const B={};4194304&F[1]&&(B.isAnimated=T[53]),1048576&F[0]&&(B.isTransparent=T[20]),67108864&F[1]&&(B.pixelRatio=T[57]),64&F[0]&&(B.textPixelRatio=T[6]),33554432&F[1]&&(B.backgroundColor=T[56]),134217728&F[1]&&(B.maskRect=T[58]),2048&F[2]&&(B.maskOpacity=T[73]?T[73].maskOpacity:1),128&F[0]&&(B.maskMarkupOpacity=T[7]),32&F[0]&&(B.maskFrameOpacity=T[5]),8388608&F[2]&&(B.clipAnnotationsToImage=T[85]),16777216&F[1]&&(B.images=T[55]),16777216&F[2]&&(B.interfaceImages=T[86]),268435456&F[0]&&(B.loadImageData=T[28]),2048&F[0]&&(B.enableGrid=T[11]),33554432&F[2]&&(B.gridSize=T[87]),201326592&F[2]&&(B.gridColors=[T[88],T[89]]),268435456&F[2]&&(B.gridOpacity=T[90]),536870912&F[2]&&(B.selectionColor=T[91]),1074266112&F[2]&&(B.willRequest=T[81]||T[92]),512&F[0]|270991424&F[1]|1&F[3]&&(B.willRender=T[433]),62&F[2]&&(B.didRender=T[434]),a.$set(B);const y={};4&F[0]&&(y.root=T[2]),8&F[0]&&(y.locale=T[3]),2&F[3]&&(y.allowPan=T[94]),131072&F[0]&&(y.enablePan=T[17]),2097152&F[0]&&(y.enablePanLimit=T[21]),4194304&F[0]&&(y.panLimitGutterScalar=T[22]),4&F[3]&&(y.enablePanInput=T[95]),8&F[3]&&(y.allowZoom=T[96]),262144&F[0]&&(y.enableZoom=T[18]),524288&F[0]|16&F[3]&&(y.enableZoomInput=T[19]!==void 0?T[19]:T[97]),32&F[3]&&(y.enableZoomControls=T[98]),8396800&F[0]&&(y.zoomOptions=T[13]||T[23]),16793600&F[0]&&(y.zoomAdjustStep=T[14]||T[24]),33587200&F[0]&&(y.zoomAdjustFactor=T[15]||T[25]),67174400&F[0]&&(y.zoomAdjustWheelFactor=T[16]||T[26]),64&F[3]&&(y.imageSelectionRectCentered=T[99]),128&F[3]&&(y.imageSelectionRectScalar=T[100]),256&F[0]&&(y.elasticity=lh*T[8]),!u&&1&F[0]&&(u=!0,y.zoomLevel=T[0],ko(()=>u=!1)),!p&&4&F[1]&&(p=!0,y.zoomControls=T[33],ko(()=>p=!1)),!h&&8&F[1]&&(h=!0,y.zoomMultiTouching=T[34],ko(()=>h=!1)),d.$set(y)},i(T){g||(M(m),M(f),M(r),M(a.$$.fragment,T),M(d.$$.fragment,T),g=!0)},o(T){z(m),z(f),z(r),z(a.$$.fragment,T),z(d.$$.fragment,T),g=!1},d(T){m&&m.d(T),T&&tt(e),f&&f.d(T),T&&tt(i),k[n].d(T),T&&tt(o),It(a,T),T&&tt(s),T&&tt(l),t[435](null),T&&tt(c),It(d,T)}}}function Bg(t){let e,i,n,r,o;return i=new oo({props:{items:t[69]}}),{c(){e=pt("div"),Et(i.$$.fragment),v(e,"class","PinturaNav PinturaNavTools")},m(a,s){et(a,e,s),Rt(i,e,null),n=!0,r||(o=[Ct(e,"measure",t[422]),Ui(dr.call(null,e))],r=!0)},p(a,s){const l={};128&s[2]&&(l.items=a[69]),i.$set(l)},i(a){n||(M(i.$$.fragment,a),n=!0)},o(a){z(i.$$.fragment,a),n=!1},d(a){a&&tt(e),It(i),r=!1,Bi(o)}}}function Og(t){let e,i,n;return i=new Ca({props:{elasticity:t[8]*ch,scrollDirection:t[76]?"y":"x",$$slots:{default:[u3]},$$scope:{ctx:t}}}),{c(){e=pt("div"),Et(i.$$.fragment),v(e,"class","PinturaNav PinturaNavMain")},m(r,o){et(r,e,o),Rt(i,e,null),n=!0},p(r,o){const a={};256&o[0]&&(a.elasticity=r[8]*ch),16384&o[2]&&(a.scrollDirection=r[76]?"y":"x"),12288&o[1]|135168&o[2]|256&o[19]&&(a.$$scope={dirty:o,ctx:r}),i.$set(a)},i(r){n||(M(i.$$.fragment,r),n=!0)},o(r){z(i.$$.fragment,r),n=!1},d(r){r&&tt(e),It(i)}}}function s3(t){let e,i;const n=[t[79],{tabs:t[44]}];let r={$$slots:{default:[d3,({tab:o})=>({596:o}),({tab:o})=>[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,o?128:0]]},$$scope:{ctx:t}};for(let o=0;o<n.length;o+=1)r=In(r,n[o]);return e=new Iu({props:r}),e.$on("select",t[423]),{c(){Et(e.$$.fragment)},m(o,a){Rt(e,o,a),i=!0},p(o,a){const s=8192&a[1]|131072&a[2]?yr(n,[131072&a[2]&&Pr(o[79]),8192&a[1]&&{tabs:o[44]}]):{};384&a[19]&&(s.$$scope={dirty:a,ctx:o}),e.$set(s)},i(o){i||(M(e.$$.fragment,o),i=!0)},o(o){z(e.$$.fragment,o),i=!1},d(o){It(e,o)}}}function l3(t){let e,i;return e=new oo({props:{items:t[44]}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};8192&r[1]&&(o.items=n[44]),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function c3(t){let e,i=t[596].icon+"";return{c(){e=fr("g")},m(n,r){et(n,e,r),e.innerHTML=i},p(n,r){128&r[19]&&i!==(i=n[596].icon+"")&&(e.innerHTML=i)},d(n){n&&tt(e)}}}function d3(t){let e,i,n,r,o,a=t[596].label+"";return e=new Co({props:{$$slots:{default:[c3]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment),i=he(),n=pt("span"),r=gn(a)},m(s,l){Rt(e,s,l),et(s,i,l),et(s,n,l),kt(n,r),o=!0},p(s,l){const c={};384&l[19]&&(c.$$scope={dirty:l,ctx:s}),e.$set(c),(!o||128&l[19])&&a!==(a=s[596].label+"")&&zn(r,a)},i(s){o||(M(e.$$.fragment,s),o=!0)},o(s){z(e.$$.fragment,s),o=!1},d(s){It(e,s),s&&tt(i),s&&tt(n)}}}function u3(t){let e,i,n,r;const o=[l3,s3],a=[];function s(l,c){return l[74]?0:1}return e=s(t),i=a[e]=o[e](t),{c(){i.c(),n=Tn()},m(l,c){a[e].m(l,c),et(l,n,c),r=!0},p(l,c){let d=e;e=s(l),e===d?a[e].p(l,c):(Pe(),z(a[d],1,1,()=>{a[d]=null}),Re(),i=a[e],i?i.p(l,c):(i=a[e]=o[e](l),i.c()),M(i,1),i.m(n.parentNode,n))},i(l){r||(M(i),r=!0)},o(l){z(i),r=!1},d(l){a[e].d(l),l&&tt(n)}}}function p3(t){let e,i,n;function r(a){t[429](a)}let o={locale:t[3],class:"PinturaMain",view:t[205](t[43]),props:t[204](t[43],t[27]),stores:t[200]};return t[1][t[43]]!==void 0&&(o.component=t[1][t[43]]),e=new y2({props:o}),Ai.push(()=>$o(e,"component",r)),e.$on("measure",t[231]),e.$on("show",t[430]),e.$on("hide",t[431]),e.$on("fade",t[432]),{c(){Et(e.$$.fragment)},m(a,s){Rt(e,a,s),n=!0},p(a,s){const l={};8&s[0]&&(l.locale=a[3]),4096&s[1]&&(l.view=a[205](a[43])),134217728&s[0]|4096&s[1]&&(l.props=a[204](a[43],a[27])),!i&&2&s[0]|4096&s[1]&&(i=!0,l.component=a[1][a[43]],ko(()=>i=!1)),e.$set(l)},i(a){n||(M(e.$$.fragment,a),n=!0)},o(a){z(e.$$.fragment,a),n=!1},d(a){It(e,a)}}}function h3(t){let e,i;const n=[{class:"PinturaMain"},{visible:t[62]},t[79],{panels:t[78]}];let r={$$slots:{default:[m3,({panel:o,panelIsActive:a})=>({594:o,595:a}),({panel:o,panelIsActive:a})=>[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,(o?32:0)|(a?64:0)]]},$$scope:{ctx:t}};for(let o=0;o<n.length;o+=1)r=In(r,n[o]);return e=new Eu({props:r}),e.$on("measure",t[428]),{c(){Et(e.$$.fragment)},m(o,a){Rt(e,o,a),i=!0},p(o,a){const s=196609&a[2]?yr(n,[n[0],1&a[2]&&{visible:o[62]},131072&a[2]&&Pr(o[79]),65536&a[2]&&{panels:o[78]}]):{};134217738&a[0]|352&a[19]&&(s.$$scope={dirty:a,ctx:o}),e.$set(s)},i(o){i||(M(e.$$.fragment,o),i=!0)},o(o){z(e.$$.fragment,o),i=!1},d(o){It(e,o)}}}function m3(t){let e,i,n;function r(a){t[424](a,t[594])}let o={locale:t[3],view:t[205](t[594]),props:t[204](t[594],t[27]),isActive:t[595],stores:t[200]};return t[1][t[594]]!==void 0&&(o.component=t[1][t[594]]),e=new y2({props:o}),Ai.push(()=>$o(e,"component",r)),e.$on("measure",t[231]),e.$on("show",function(){return t[425](t[594])}),e.$on("hide",function(){return t[426](t[594])}),e.$on("fade",function(...a){return t[427](t[594],...a)}),{c(){Et(e.$$.fragment)},m(a,s){Rt(e,a,s),n=!0},p(a,s){t=a;const l={};8&s[0]&&(l.locale=t[3]),32&s[19]&&(l.view=t[205](t[594])),134217728&s[0]|32&s[19]&&(l.props=t[204](t[594],t[27])),64&s[19]&&(l.isActive=t[595]),!i&&2&s[0]|32&s[19]&&(i=!0,l.component=t[1][t[594]],ko(()=>i=!1)),e.$set(l)},i(a){n||(M(e.$$.fragment,a),n=!0)},o(a){z(e.$$.fragment,a),n=!1},d(a){It(e,a)}}}function Wg(t){let e,i;return{c(){e=pt("span"),v(e,"class","PinturaEditorOverlay"),v(e,"style",i="opacity:"+t[101])},m(n,r){et(n,e,r)},p(n,r){256&r[3]&&i!==(i="opacity:"+n[101])&&v(e,"style",i)},d(n){n&&tt(e)}}}function _g(t){let e,i;const n=[{layout:"row"},{parentRect:t[50]},t[60]];let r={$$slots:{default:[$3]},$$scope:{ctx:t}};for(let o=0;o<n.length;o+=1)r=In(r,n[o]);return e=new L2({props:r}),{c(){Et(e.$$.fragment)},m(o,a){Rt(e,o,a),i=!0},p(o,a){const s=537395200&a[1]?yr(n,[n[0],524288&a[1]&&{parentRect:o[50]},536870912&a[1]&&Pr(o[60])]):{};1610612736&a[1]|256&a[19]&&(s.$$scope={dirty:a,ctx:o}),e.$set(s)},i(o){i||(M(e.$$.fragment,o),i=!0)},o(o){z(e.$$.fragment,o),i=!1},d(o){It(e,o)}}}function $3(t){let e,i,n;return{c(){e=pt("input"),e.value=i=t[60].text,v(e,"placeholder",n=t[60].placeholder),v(e,"type","text"),v(e,"spellcheck","false"),v(e,"autocorrect","off"),v(e,"autocapitalize","off")},m(r,o){et(r,e,o),t[439](e)},p(r,o){536870912&o[1]&&i!==(i=r[60].text)&&e.value!==i&&(e.value=i),536870912&o[1]&&n!==(n=r[60].placeholder)&&v(e,"placeholder",n)},d(r){r&&tt(e),t[439](null)}}}function g3(t){let e,i,n,r,o,a;Wl(t[421]);let s=t[40]&&Eg(t),l=t[101]>0&&Wg(t),c=t[60]&&_g(t);return{c(){e=pt("div"),s&&s.c(),i=he(),l&&l.c(),n=he(),c&&c.c(),v(e,"id",t[4]),v(e,"class",t[77]),v(e,"data-env",t[75]),v(e,"dir",t[12])},m(d,u){et(d,e,u),s&&s.m(e,null),kt(e,i),l&&l.m(e,null),kt(e,n),c&&c.m(e,null),t[440](e),r=!0,o||(a=[Ct(il,"keydown",t[222]),Ct(il,"keyup",t[223]),Ct(il,"blur",t[224]),Ct(il,"paste",t[228]),Ct(il,"resize",t[421]),Ct(e,"ping",function(){ji(t[68])&&t[68].apply(this,arguments)}),Ct(e,"contextmenu",t[225]),Ct(e,"touchstart",t[220],{passive:!1}),Ct(e,"touchmove",function(){ji(t[71])&&t[71].apply(this,arguments)}),Ct(e,"pointermove",function(){ji(t[70])&&t[70].apply(this,arguments)}),Ct(e,"transitionend",t[210]),Ct(e,"dropfiles",t[226]),Ct(e,"measure",t[441]),Ct(e,"click",function(){ji(t[42]?t[227]:ge)&&(t[42]?t[227]:ge).apply(this,arguments)}),Ui(dr.call(null,e,{observeViewRect:!0,isMeasureRoot:!0})),Ui(jv.call(null,e)),Ui(f2.call(null,e))],o=!0)},p(d,u){(t=d)[40]?s?(s.p(t,u),512&u[1]&&M(s,1)):(s=Eg(t),s.c(),M(s,1),s.m(e,i)):s&&(Pe(),z(s,1,1,()=>{s=null}),Re()),t[101]>0?l?l.p(t,u):(l=Wg(t),l.c(),l.m(e,n)):l&&(l.d(1),l=null),t[60]?c?(c.p(t,u),536870912&u[1]&&M(c,1)):(c=_g(t),c.c(),M(c,1),c.m(e,null)):c&&(Pe(),z(c,1,1,()=>{c=null}),Re()),(!r||16&u[0])&&v(e,"id",t[4]),(!r||32768&u[2])&&v(e,"class",t[77]),(!r||8192&u[2])&&v(e,"data-env",t[75]),(!r||4096&u[0])&&v(e,"dir",t[12])},i(d){r||(M(s),M(c),r=!0)},o(d){z(s),z(c),r=!1},d(d){d&&tt(e),s&&s.d(),l&&l.d(),c&&c.d(),t[440](null),o=!1,Bi(a)}}}const lh=1,ch=10;function f3(t,e,i){let n,r,o,a,s,l,c,d,u,p,h,g,m,f,x,k,w,C,P,R,W,T,F,D,B,y,_,J,S,j,Q,ht,at,U,yt,$t,Mt,dt,Tt,K,q,Z,xt,it,mt,Ft,ie,Dt,Ot,ae,G,wt,ut,Xt,ce,te,ve,me,V,Ce,yi,xe,_t,ze,Ie,Fe,hi,bt,ne,Ue,Ee,jt,Ge,Qe,mi,$i,Li,X,Ut,H,Bt,be,se,At,re,Me,De,_e,Ze,nt,Qt,Zt,Kt,Yt,st,le,ee,ye,Xe,$e,vi,Le,Gt,gi,Ti,Ve,ri,Be,Se,Zi,un,wn,sn,an,Mn,ur,ao,fn,Rr,Sn,Vn,yn,To,Oi,xn,On,No,Kr,go,Mo,pr,pn,Qi,so,Ho,xr,br,lo,ca,Po,Ro,_r,Jr,Ir,hr,vr,Wn,Wi,_i,lr,qi,Vr,co,Qr,mr,Fn,wr,uo,cr,Kn,Nn,Er,to,eo,En,Ar,O,de,wi,je,Pt,fe,xi,Gi,hn,Si,Vi,Lr,da,ua,Ta,jo,Nr,Io,Eo,Oa,Hr,I,Te,Ne,fi,Di,Ni,ti,oi,Ei,zi,mn,Pn,bn,Fi,Pi,zr,Ao,Wa,_a,Va,Na,Uo,ls,dl,Ha,Ma=Ke,jr=Ke;A(t,Nv,$=>i(409,Gi=$)),t.$$.on_destroy.push(()=>Ma()),t.$$.on_destroy.push(()=>jr());const Fr=rs(),Sr=ka();let{class:Ur}=e,{layout:ln}=e,{stores:Lo}=e,{locale:tn}=e,{id:po}=e,{util:pa}=e,{utils:jl}=e,{animations:cs="auto"}=e,{disabled:ja=!1}=e,{status:fo}=e,{previewUpscale:Pa=!1}=e,{previewPad:ul=!1}=e,{previewMaskOpacity:ds=.95}=e,{previewImageDataMaxSize:b}=e,{previewImageTextPixelRatio:N}=e,{markupMaskOpacity:L=1}=e,{zoomMaskOpacity:ot=.85}=e,{elasticityMultiplier:lt=10}=e,{willRevert:Lt=()=>Promise.resolve(!0)}=e,{willProcessImage:Ht=()=>Promise.resolve(!0)}=e,{willRenderCanvas:Nt=Yi}=e,{willRenderToolbar:Wt=Yi}=e,{willRenderUtilTabs:zt=Yi}=e,{willSetHistoryInitialState:Vt=Yi}=e,{enableButtonExport:qt=!0}=e,{enableButtonRevert:ii=!0}=e,{enableNavigateHistory:oe=!0}=e,{enableToolbar:ue=!0}=e,{enableUtils:ke=!0}=e,{enableButtonClose:we=!1}=e,{enableDropImage:Ye=!1}=e,{enablePasteImage:ei=!1}=e,{enableBrowseImage:bi=!1}=e,{enableTransparencyGrid:ui=!1}=e,{layoutDirectionPreference:Mi="auto"}=e,{layoutHorizontalUtilsPreference:cn="left"}=e,{layoutVerticalUtilsPreference:Hi="bottom"}=e,{layoutVerticalToolbarPreference:Ri="top"}=e,{layoutVerticalControlGroupsPreference:kn="bottom"}=e,{layoutVerticalControlTabsPreference:Ki="bottom"}=e,{textDirection:Zn}=e,{markupEditorZoomLevel:en=null}=e,{markupEditorZoomLevels:Gr}=e,{markupEditorZoomAdjustStep:Zr}=e,{markupEditorZoomAdjustFactor:io}=e,{markupEditorZoomAdjustWheelFactor:Ua}=e,{markupEditorInteractionMode:Ra=!1}=e,{muteAudio:Ga=!0}=e,{willSetMediaInitialTimeOffset:us=($,Y)=>$*Q5(Y[0])}=e,{enablePan:Ia=!0}=e,{enableZoom:Go=!0}=e,{enableZoomControls:yo=!0}=e,{enableZoomInput:ps}=e,{enablePanInput:ha}=e,{enableCanvasAlpha:Za=!1}=e,{enablePanLimit:Zo}=e,{panLimitGutterScalar:Xa}=e,{zoomPresetOptions:hs=[.25,.5,1,1.25,1.5,2,3,4,6,8,16]}=e,{zoomAdjustStep:Os=.25}=e,{zoomAdjustFactor:Ul=.1}=e,{zoomAdjustWheelFactor:Ea=1}=e,{zoomLevel:xo=null}=e,{fixScrollDirection:Un=!1}=e;const ma=pe(Un);let Gl,Gc;ho("fixScrollDirection",ma);let{imagePreviewSrc:Ou}=e,{imageOrienter:Zc={read:()=>1,apply:$=>$}}=e,{pluginComponents:pl}=e,{pluginOptions:Ws={}}=e;const tx=Fr.sub,zo={};let{root:Jn}=e;const Wu=()=>{$e.setAttribute("data-redraw","true"),Vs.set({})},_u=pe(!0);A(t,_u,$=>i(473,Sn=$));const Zl=pe(void 0);A(t,Zl,$=>i(419,fi=$));const Ya=pe(0);A(t,Ya,$=>i(416,I=$));const a0=pe(!1),Xc=$=>{a0.set($.type==="play"),Fr.pub($.type)};let s0,Vu,l0,Nu,Hu=!1;const ju=()=>{if(!o||!hl())return;Nu=u,vt(Zl,fi=void 0,fi);const $=$e;Hu=!1;const Y=1/24,gt=qa();(Math.abs(c*gt-I*gt)<=Y||gt-gt*I<=Y)&&vt(Ya,I=l,I),Yc(I*qa()),$.play().catch(()=>{});let St=Yl();const ct=()=>{if(hl())return;l0=requestAnimationFrame(ct);let ft=Yl();ft-St<=0&&(ft=St+.01),St=ft,vt(Ya,I=ft/qa(),I),Nu>=0&&I>=c&&(vt(Ya,I=c,I),_s()),u>-1&&(Hu=!0),Hu&&u===-1&&p>0&&(vt(Ya,I=s[p][0],I),Yc(I*qa())),vt(Kc,Io=I*qa(),Io),Wu()};ct()},_s=()=>{o&&!hl()&&(vt(Zl,fi=void 0,fi),Nu=void 0,$e.pause(),cancelAnimationFrame(l0),Wu())},hl=()=>$e&&$e.paused,Uu=()=>{if(o)return hl()?ju():_s()},Gu=()=>{o&&($e.muted=!0)},Zu=()=>{o&&($e.muted=!1)},c0=()=>{o&&vt(Xl,Ne=!Ne,Ne)},Xl=pe(Ga);A(t,Xl,$=>i(418,Ne=$));const qa=()=>{if(o)return $e.duration},Yl=()=>{if(o)return $e.currentTime},Yc=$=>{o&&(Cg($e,$),vt(Ya,I=$/Te,I))},Vs=pe({});A(t,Vs,$=>i(52,To=$)),ho("redrawTrigger",Vs);const qc=pe(lt);A(t,qc,$=>i(490,Oa=$)),ho("elasticityMultiplier",qc);let ql=[];const Xu=ci();A(t,Xu,$=>i(101,Ha=$));const d0=Uh()||1024,u0=jn(d0,d0),p0=n2(),ex=$=>Promise.resolve(Eo&&Eo($,{resourceType:"image"})).then(Y=>{if(Y===!1)return;const{headers:gt,credentials:St}=Y||{};return fetch($,{headers:gt,credentials:St}).then(ct=>{if(ct.status!==200)throw`${ct.status} (${ct.statusText})`;return ct.blob()}).then(ct=>Pg(ct,Zc,p0)).then(ct=>Rg(ct,m))});let{imageSourceToImageData:Yu=$=>We($)?ex($):Bl($)?new Promise(Y=>Y(Nc($))):Th($)||jc($)?Pg($,Zc,p0).then(Y=>Rg(Y,m)):void 0}=e;const qu=(()=>{let $,Y;const gt=Tg.reduce((St,ct)=>(St[ct]=function(ft,Jt,qe){let Je=[];return{set:Jt,update:qe,publish:He=>{Je.forEach($n=>$n(He))},subscribe:He=>(Je.push(He),ft(He),()=>{Je=Je.filter($n=>$n!==He)})}}(ft=>{if(!Y)return ft();Y.stores[ct].subscribe(ft)()},ft=>{Y&&Y.stores[ct].set(ft)},ft=>{Y&&Y.stores[ct].update(ft)}),St),{});return{update:St=>{if(Y=St,$&&($.forEach(ct=>ct()),$=void 0),!St)return gt.file.publish(void 0),void gt.loadState.publish(void 0);$=Tg.map(ct=>St.stores[ct].subscribe(ft=>{gt[ct].publish(ft)}))},stores:gt,destroy:()=>{$&&$.forEach(St=>St())}}})(),{file:Ku,size:Ns,duration:Ju,currentTime:Kc,trim:Qu,volume:h0,minDuration:ix,maxDuration:t1,loadState:Jc,processState:e1,cropAspectRatio:Qc,cropLimitToImage:i1,crop:$a,cropMinSize:nx,cropMaxSize:rx,cropRange:ox,cropOrigin:ax,cropRectAspectRatio:sx,rotation:ml,rotationRange:lx,targetSize:cx,flipX:td,flipY:ed,backgroundColor:id,backgroundImage:m0,colorMatrix:$0,convolutionMatrix:g0,gamma:f0,vignette:y0,noise:x0,decoration:n1,annotation:r1,manipulation:o1,redaction:a1,frame:Hs,selection:s1,state:nd}=qu.stores;A(t,Ku,$=>i(393,Jr=$)),A(t,Ns,$=>i(366,Gt=$)),A(t,Ju,$=>i(417,Te=$)),A(t,Kc,$=>i(489,Io=$)),A(t,Qu,$=>i(414,Nr=$)),A(t,h0,$=>i(415,Hr=$)),A(t,t1,$=>i(420,Di=$)),A(t,Jc,$=>i(385,Qi=$)),A(t,e1,$=>i(384,pn=$)),A(t,Qc,$=>i(486,Si=$)),A(t,i1,$=>i(85,Ei=$)),A(t,$a,$=>i(404,Nn=$)),A(t,ml,$=>i(369,Ve=$)),A(t,td,$=>i(368,Ti=$)),A(t,ed,$=>i(367,gi=$)),A(t,id,$=>i(375,ao=$)),A(t,n1,$=>i(48,Le=$)),A(t,r1,$=>i(49,ri=$)),A(t,o1,$=>i(372,an=$)),A(t,a1,$=>i(373,Mn=$)),A(t,Hs,$=>i(47,vi=$)),A(t,s1,$=>i(59,ua=$)),A(t,nd,$=>i(475,vr=$)),ho("components",{DynamicComponentTree:oo}),ho("previewcontrols",{play:ju,pause:_s,togglePlayPause:Uu,mute:Gu,unmute:Zu,toggleMute:c0,setCurrentTime:Yc,getCurrentTime:Yl,getDuration:qa,frameOffset:Ya,framePeekOffset:Zl,isPlaying:a0,isMuted:Xl});const b0=($,Y,gt=0)=>new Promise((St,ct)=>{if(ll($))return void a2($).then(Je=>{const He=di(Io)?Io:us(Je.duration,Nr||[[0,1]]);s2(Je,He).then(St)});let ft,Jt=!1;Y.cancel=()=>Jt=!0;const qe=Date.now();Yu($).then(Je=>{const He=Date.now()-qe;clearTimeout(ft),ft=setTimeout(()=>{Jt||St(Je)},Math.max(0,gt-He))}).catch(ct)}),{images:v0,shapePreprocessor:w0,imageScrambler:S0,imageRedactionRendering:k0,willRequest:C0,willRequestResource:T0}=Lo;let Kl;A(t,v0,$=>i(413,jo=$)),A(t,w0,$=>i(412,Ta=$)),A(t,S0,$=>i(376,fn=$)),A(t,k0,$=>i(374,ur=$)),A(t,C0,$=>i(81,Eo=$)),A(t,T0,$=>i(92,zr=$));const dx=Ii(m0,($,Y)=>{if(!$)return Y(void 0);Kl&&(Kl.cancel(),Kl=void 0),Kl={cancel:ge},b0($,Kl).then(Y).catch(gt=>{})}),ux=nd.subscribe($=>Fr.pub("update",$)),px=pe();ho("ui",pe({})),ho("selection",s1);const l1=pe(!0);A(t,l1,$=>i(94,Wa=$));const c1=pe(!0);A(t,c1,$=>i(96,Va=$));const d1=pe(!0);A(t,d1,$=>i(411,da=$));const rd=pe(!0);A(t,rd,$=>i(487,Vi=$));const u1=pe(!0);A(t,u1,$=>i(97,Na=$));const p1=pe();A(t,p1,$=>i(98,Uo=$));const od=pe();A(t,od,$=>i(488,Lr=$));const h1=Ii([od,rd],()=>Lr!==void 0?Lr:Vi);A(t,h1,$=>i(95,_a=$));const Jl=pe([0,0,0]);A(t,Jl,$=>i(56,qi=$));const ad=pe([1,1,1]);A(t,ad,$=>i(471,sn=$));const Ql=ci([1,1,1]);A(t,Ql,$=>i(470,wn=$));const m1=pe();A(t,m1,$=>i(91,Pi=$));const M0=pe(),$1=pe();A(t,$1,$=>i(51,Vn=$));const $l=pe();A(t,$l,$=>i(370,Se=$));const gl=pe(ks());A(t,gl,$=>i(80,Wn=$));const g1=pe(0);A(t,g1,$=>i(410,hn=$));const tc=pe(ks());A(t,tc,$=>i(84,oi=$));const js=pe();A(t,js,$=>i(468,Xe=$));const sd=Mg("(pointer: fine)",$=>$?"pointer-fine":"pointer-coarse");A(t,sd,$=>i(391,Ro=$));const ld=Mg("(hover: hover)",$=>$?"pointer-hover":"pointer-no-hover");A(t,ld,$=>i(390,Po=$));const P0=pe(!1),ec=pe(!1);A(t,ec,$=>i(371,un=$));const f1=Rl(void 0,$=>{const Y=ci(0),gt=[ec.subscribe(St=>{Y.set(St?1:0,{hard:!xn})}),Y.subscribe($)];return()=>gt.forEach(St=>St())});A(t,f1,$=>i(469,Zi=$));const cd=pe();A(t,cd,$=>i(474,br=$));const dd=pe();let y1;A(t,dd,$=>i(53,xn=$)),ho("isAnimated",dd);const ud=pe(Pa);A(t,ud,$=>i(394,Ir=$));const Us=pe(!1);A(t,Us,$=>i(480,eo=$)),ho("imageIsStatic",Us);const ic=pe();A(t,ic,$=>i(481,En=$));const x1=pe();A(t,x1,$=>i(478,Er=$));const R0=Rl(void 0,$=>{const Y=pe(void 0),gt=[$a.subscribe(()=>{if(!Nn)return;if(eo)return Y.set(ki(Nn));const St=z$(Nn,Er,5*lt);Y.set(St)}),Y.subscribe($)];return()=>gt.forEach(St=>St())}),Xo=pe();A(t,Xo,$=>i(477,Kn=$));const pd=pe();A(t,pd,$=>i(479,to=$));const b1=pe(void 0);A(t,b1,$=>i(484,Pt=$));const I0=pe(rn());A(t,I0,$=>i(485,fe=$));const E0=($,Y)=>{if(!Y||!$)return{top:0,right:0,bottom:0,left:0};const gt=Iy(Y,$,f),St=Ry(gt,$);return{top:Math.abs(St.top),right:Math.abs(St.right),bottom:Math.abs(St.bottom),left:Math.abs(St.left)}},A0=pe({}),v1=Ii([js,gl,tc,A0],([$,Y,gt,St],ct)=>{if(!$)return ct(void 0);let ft=0;S.length!==1||h||Ri==="bottom"||(ft=gt.y+gt.height),ct(An($.x+Y.x,$.y+Y.y+ft,$.width,$.height))});let nc={left:0,right:0,top:0,bottom:0};const hd=pe(!1),fl=Ii([hd,Hs,v1,ec],([$,Y,gt,St],ct)=>{if(!gt)return ct({left:0,right:0,top:0,bottom:0});if(!$)return;const ft=Math.min(gt.width,gt.height),Jt=E0({width:ft,height:ft},Y);ai(nc.top,4)===ai(Jt.top,4)&&ai(nc.bottom,4)===ai(Jt.bottom,4)&&ai(nc.right,4)===ai(Jt.right,4)&&ai(nc.left,4)===ai(Jt.left,4)||(nc=Jt,ct(Jt))});A(t,fl,$=>i(402,wr=$));const yl=Ii([hd,fl],([$,Y],gt)=>{if(!$)return gt(!1);gt(Object.values(Y).some(St=>St>0))});A(t,yl,$=>i(403,uo=$));const hx=Ii([hd,js,yl,fl],([$,Y,gt,St],ct)=>{if(Y)return $&&gt?void ct(An(Y.x+St.left,Y.y+St.top,Y.width-St.left-St.right,Y.height-St.top-St.bottom)):ct({...Y})}),Aa=Ii([v1,yl,fl],([$,Y,gt],St)=>$?Y?void St(An($.x+gt.left,$.y+gt.top,$.width-gt.left-gt.right,$.height-gt.top-gt.bottom)):St($):St(void 0));A(t,Aa,$=>i(50,Be=$));const mx=Ii([Us,Ns,ml],([$,Y,gt],St)=>{if(!$||!Y)return St(void 0);const ct=Or(Y);St($r(ct,gt))}),w1=Ii([mx],([$],Y)=>{if(!$)return Y(void 0);const gt=er($);Y(Fc(gt))});A(t,w1,$=>i(406,de=$));const Ka=Ii([Aa,$a,w1,ud],([$,Y,gt,St],ct)=>{if(!$||!Y||!(!En&&!Er))return;const{width:ft,height:Jt}=gt||Y,qe=Math.min($.width/ft,$.height/Jt);ct(St?qe:Math.min(1,qe))});A(t,Ka,$=>i(405,O=$)),ho("imageStaticVisualCorners",Ii([Us,Ns,ml,Aa,js,Ka],([$,Y,gt,St,ct,ft],Jt)=>{if(!($&&St&&ct&&Y))return Jt(void 0);const qe=Or(Y),Je=Fc(Cr(qe,ft)),He=eu(St,Je);Je.x=He.x,Je.y=He.y,Jt($r(Je,gt))}));const xl=pe(void 0);A(t,xl,$=>i(408,xi=$));const L0=Ii([$a,Aa],([$,Y])=>{if(Y&&$)return Math.min(Y.width/$.width,Y.height/$.height)}),S1=Ii([$a,Xo],([$,Y])=>$&&Y?Math.min($.width/Y.width,$.height/Y.height):1);A(t,S1,$=>i(100,dl=$));const rc=Ii([xl,S1],([$,Y])=>$&&Y?Y*$:1);A(t,rc,$=>i(483,wi=$));const bl=pe(rn());A(t,bl,$=>i(407,je=$));const z0=pe({scalar:wi,translation:je}),F0=()=>{z0.set({scalar:void 0,translation:rn()})},md=Rl(void 0,$=>{const Y=ci(void 0,{precision:1e-4}),gt=Tc()===1?ft=>Oo(ft,Math.round):Yi,St=()=>{if(!Kn)return;const ft=un||!br;if(eo){const qe=ki(Kn);return ta(qe,fe),ta(qe,Be),Y.set(qe,{hard:ft})}const Jt=z$(Kn,Pt,lh*lt);Jt.width<0&&(Jt.width=0,Jt.x=Kn.x),Jt.height<0&&(Jt.height=0,Jt.y=Kn.y),ta(Jt,Be),ta(Jt,je),Cr(Jt,wi),!ft&&gt(Jt),Y.set(Jt,{hard:ft})},ct=[Aa.subscribe(St),Xo.subscribe(St),rc.subscribe(St),bl.subscribe(St),Hs.subscribe(St),Y.subscribe($)];return()=>ct.forEach(ft=>ft())});A(t,md,$=>i(58,Fn=$));const k1=pe(1);A(t,k1,$=>i(476,cr=$));const C1=()=>{if(!Nn||!Be)return;let $=Cs(ki(Nn),O||1);const Y=eu(Be,Cs(ki(de),O));ta($,Y);const gt=Xe.width/$.width,St=Xe.height/$.height,ct=Math.min(1,gt,St);k1.set(ct),Cr($,ct),((ft,Jt)=>{const[qe,Je,He,$n]=ol(ft);qe<Jt.y&&(ft.y=Math.max(Jt.y,ft.y)),Je>Jt.width&&(ft.x=Jt.width-ft.width),He>Jt.height&&(ft.y=Jt.height-ft.height),$n<Jt.x&&(ft.x=Math.max(Jt.x,ft.x))})($,{...Xe,x:0,y:0}),Xo.set($)},D0=Ii([Aa,Ka,$a,Ns],([$,Y,gt,St],ct)=>{$&&(gt||St)&&ct(B0($,Y||1,gt||St))});A(t,D0,$=>i(99,ls=$));const B0=($,Y,gt)=>gt.width<=$.width&&gt.height<=$.height?eu($,Cs(ki(gt),Y)):qr($,ir(gt));let T1,O0;const M1=$=>{if(h&&T1&&ea(T1,$)&&O0===O)return;if(eo)return C1();T1=$,O0=O;const Y=B0($,O,Nn||Gt);Xo.set(Y)};let W0=!1;const $x=Ka.subscribe($=>{!W0&&$!==void 0&&Nn&&(M1(Be),W0=!0)}),gx=Aa.subscribe($=>{$&&O!==void 0&&Nn&&M1($)}),fx=Us.subscribe($=>{!$&&Be&&M1(Be)});let P1;const yx=pd.subscribe($=>{if(!$)return P1=void 0,void vt(ic,En=void 0,En);P1=Ar;const Y=ki(Nn);ic.set(Y)}),xx=Xo.subscribe($=>{if(!$||!to)return;const Y=(gt=ki($),St=to,gt.x-=St.x,gt.y-=St.y,gt.width-=St.width,gt.height-=St.height,gt);var gt,St;((ft,Jt)=>{ft.x/=Jt,ft.y/=Jt,ft.width/=Jt,ft.height/=Jt})(Y,P1);const ct=((ft,Jt)=>(ft.x+=Jt.x,ft.y+=Jt.y,ft.width+=Jt.width,ft.height+=Jt.height,ft))(ki(En),Y);$a.set(ct)}),bx=$a.subscribe($=>{if(!$||!Kn)return;if(eo)return void(to||C1());if(un||to||Er)return;const Y=ir(Kn),gt=ir($);if(ai(Y,6)===ai(gt,6))return;const{width:St,height:ct}=Nn,ft=Math.min(Be.width/St,Be.height/ct),Jt=jn($.width*ft,$.height*ft),qe=.5*(Kn.width-Jt.width),Je=.5*(Kn.height-Jt.height),He=An(Math.max(0,Math.min(Be.width-Jt.width,Kn.x+qe)),Math.max(0,Math.min(Be.height-Jt.height,Kn.y+Je)),Jt.width,Jt.height);Xo.set(He)}),_0=Ii([Ka,$a,Xo,Us],([$,Y,gt,St],ct)=>{if(!$||!Y||!gt)return;if(St)return ct(cr);const ft=gt.width/Y.width,Jt=gt.height/Y.height;ct(Math.max(ft,Jt)/$)}),$d=Ii([Ka,_0],([$,Y],gt)=>{Y&&gt($*Y)});A(t,$d,$=>i(482,Ar=$));let vl={left:0,right:0,top:0,bottom:0};const V0=Ii([Hs,Xo],([$,Y],gt)=>{if(!Y)return gt(vl);const St=E0(Y,$);ai(vl.top,4)===ai(St.top,4)&&ai(vl.bottom,4)===ai(St.bottom,4)&&ai(vl.right,4)===ai(St.right,4)&&ai(vl.left,4)===ai(St.left,4)||(vl=St,gt(St))}),vx=Ii([V0],([$],Y)=>{Y(Object.values($).some(gt=>gt>0))}),R1=ci(.075,{stiffness:.03,damping:.4,precision:.001}),wx=Ii([Ql,Jl,R1,md,rc,Hs,vx,V0,yl],([$,Y,gt,St,ct,ft,Jt,qe,Je],He)=>{if(!St||h)return He([]);let{x:$n,y:Rn,width:kr,height:nn}=St;$n+=.5,Rn+=.5,kr-=.5,nn-=.5;const Qn=[];if(ft){if(Jt){let{left:Xi,right:qo,top:Xs,bottom:Sl}=qe;Xi*=ct,qo*=ct,Xs*=ct,Sl*=ct;const ip=Bp(Y)?[1,1,1,.125]:[0,0,0,.075];Qn.push({x:$n-Xi-.5,y:Rn-Xs-.5,width:kr+Xi+qo+1,height:nn+Xs+Sl+1,strokeWidth:1,strokeColor:ip,opacity:Je?1:.5})}const Fo=Bp($);ft&&ft.frameColor&&Bp(ft.frameColor)||Fo||(Qn.push({x:$n-1,y:Rn-1,width:kr+2,height:nn+2,strokeWidth:2,strokeColor:[0,0,0,.1],opacity:gt}),Qn.push({x:$n+1,y:Rn+1,width:kr-2,height:nn-2,strokeWidth:2,strokeColor:[0,0,0,.1],opacity:gt}))}He([...Qn,{x:$n,y:Rn,width:kr,height:nn,strokeWidth:1,strokeColor:$,opacity:gt}])}),oc=pe([]);A(t,oc,$=>i(396,Wi=$));const N0=Ii([wx,oc],([$,Y],gt)=>{gt([...$,...Y])});A(t,N0,$=>i(93,Ao=$));const I1=ci(0,{precision:.001});A(t,I1,$=>i(398,lr=$));const E1=ci();A(t,E1,$=>i(401,Qr=$));const A1=ci();A(t,A1,$=>i(400,co=$));const L1=ci();A(t,L1,$=>i(399,Vr=$));const z1=ci();A(t,z1,$=>i(397,_i=$));const ac=pe(!1);A(t,ac,$=>i(383,pr=$));const sc=pe();let ms;A(t,sc,$=>i(386,so=$));const F1=Ii([ac,sc],([$,Y],gt)=>{if(!$||!Y)return void gt(void 0);if(ms&&(ms.cancel(),i(289,ms=void 0)),Uc(Y))return gt(Zf(Y));const St=Yo.length?0:xn?250:0;i(289,ms={cancel:ge}),b0(Y,ms,St).then(gt).catch(ct=>{vt(Jc,Qi.error=ct,Qi)}).finally(()=>{i(289,ms=void 0)})});Ma(),Ma=Br(F1,$=>i(365,$e=$));let{imagePreviewCurrent:lc}=e;const D1=pe({});A(t,D1,$=>i(388,lo=$));const gd=pe([]);A(t,gd,$=>i(86,zi=$));const fd=Ii([Aa,$l,Ns,R0,Xo,$d,ml,td,ed,rc,bl,P0],([$,Y,gt,St,ct,ft,Jt,qe,Je,He,$n,Rn],kr)=>{if(!$||!ct)return;const nn=Mv($,Y,gt,St,ct,He,$n,ft,Jt,qe,Je);!Rn&&y(nn),kr(nn)});A(t,fd,$=>i(389,ca=$));const H0=Ii([$0,g0,f0,y0,x0],([$,Y,gt,St,ct],ft)=>{const Jt=$&&Object.keys($).map(qe=>$[qe]).filter(Boolean);ft({gamma:gt||void 0,vignette:St||void 0,noise:ct||void 0,convolutionMatrix:Y||void 0,colorMatrix:Jt&&Jt.length&&Dh(Jt)})});let yd,B1;const j0=(()=>{if(!va())return!1;const $=navigator.userAgent.match(/OS (\d+)_(\d+)_?(\d+)?/i)||[],[,Y,gt]=$.map(St=>parseInt(St,10)||0);return Y>13||Y===13&&gt>=4})(),cc=pe({});A(t,cc,$=>i(377,yn=$)),ho("env",cc);const U0=Tc(),O1=Rl(U0,$=>{const Y=()=>$(Tc()),gt=matchMedia(`(resolution: ${U0}dppx)`);return gt.addListener(Y),()=>gt.removeListener(Y)});A(t,O1,$=>i(57,mr=$));const La=(($,Y)=>{const{sub:gt,pub:St}=rs(),ct=[],ft=pe(0),Jt=[],qe=()=>Jt.forEach(He=>He({index:ba(ft),length:ct.length})),Je={get index(){return ba(ft)},set index(He){He=Number.isInteger(He)?He:0,He=Ji(He,0,ct.length-1),ft.set(He),Y(ct[Je.index]),qe()},get state(){return ct[ct.length-1]},length:()=>ct.length,undo(){const He=Je.index--;return St("undo",He),He},redo(){const He=Je.index++;return St("redo",Je.index),He},revert(){ct.length=1,Je.index=0,St("revert")},write(He){He&&Y({...$(),...He});const $n=$(),Rn=ct[ct.length-1];JSON.stringify($n)!==JSON.stringify(Rn)&&(ct.length=Je.index+1,ct.push($n),ft.set(ct.length-1),qe(),St("writehistory"))},set(He={}){ct.length=0,Je.index=0;const $n=Array.isArray(He)?He:[He];ct.push(...$n),Je.index=ct.length-1},get:()=>[...ct],subscribe:He=>(Jt.push(He),He({index:Je.index,length:ct.length}),()=>Jt.splice(Jt.indexOf(He),1)),on:gt};return Je})(()=>vr,$=>{vt(nd,vr=$,vr),gl.set(Wn)});jr(),jr=Br(La,$=>i(395,hr=$));const G0=()=>{const $={x:0,y:0,...Gt},Y=Oo(qr($,vr.cropAspectRatio),Math.round),gt=Vt({...vr,rotation:0,crop:Y},vr),St=[gt];JSON.stringify(gt)!==JSON.stringify(vr)&&St.push({...vr}),La.set(St)},Sx=Jc.subscribe($=>{$&&$.complete&&G0()}),kx=()=>Lt().then($=>$&&La.revert()),$s=pe(!1);A(t,$s,$=>i(378,Oi=$));const Cx=()=>{vt($s,Oi=!0,Oi),Ht().then($=>{if(!$)return void vt($s,Oi=!1,Oi);let Y;Y=uc.subscribe(gt=>{gt===1&&(Y&&Y(),Sr("processImage"))})})},Tx=e1.subscribe($=>{if(!$)return void vt($s,Oi=!1,Oi);vt($s,Oi=!0,Oi);const{complete:Y,abort:gt}=$;(Y||gt)&&vt($s,Oi=!1,Oi)}),Yo=J5();A(t,Yo,$=>i(55,Ho=$));const Mx=Ii([Yo],([$],Y)=>{if(!$.length)return Y();const{origin:gt,translation:St,rotation:ct,scale:ft}=$[0];Y({origin:gt,translation:St,rotation:ct,scale:ft})}),xd=pe();A(t,xd,$=>i(392,_r=$));let bd,vd=[];const Z0=pe(),W1=pe(),Px=Ii([xl,W1,Ka,L0],([$,Y,gt,St])=>$||(Y||gt<1?St:1)),X0={...Lo,imageFile:Ku,imageSize:Ns,mediaDuration:Ju,mediaMinDuration:ix,mediaMaxDuration:t1,mediaTrim:Qu,imageBackgroundColor:id,imageBackgroundImage:m0,imageCropAspectRatio:Qc,imageCropMinSize:nx,imageCropMaxSize:rx,imageCropLimitToImage:i1,imageCropRect:$a,imageCropRectOrigin:ax,imageCropRectSnapshot:ic,imageCropRectAspectRatio:sx,imageCropRange:ox,imageRotation:ml,imageRotationRange:lx,imageFlipX:td,imageFlipY:ed,imageOutputSize:cx,imageColorMatrix:$0,imageConvolutionMatrix:g0,imageGamma:f0,imageVignette:y0,imageNoise:x0,imageManipulation:o1,imageDecoration:n1,imageAnnotation:r1,imageRedaction:a1,imageFrame:Hs,imagePreview:F1,imagePreviewSource:sc,imageTransforms:fd,imagePreviewModifiers:D1,history:La,animation:cd,pixelRatio:O1,elasticityMultiplier:lt,scrollElasticity:ch,rangeInputElasticity:5,redrawTrigger:Vs,pointerAccuracy:sd,pointerHoverable:ld,env:cc,rootRect:$l,stageRect:Aa,stageRectBase:v1,stageRecenter:A0,stageScalar:Ka,stagePadding:fl,stagePadded:yl,presentationScalar:$d,imagePreviewUpscale:W1,utilRect:js,utilRectPadded:hx,allowPlayPause:_u,allowPan:l1,allowZoom:c1,allowZoomControls:d1,enableZoomInput:u1,enablePanInput:rd,enablePanInputStatus:h1,imageSelectionMultiTouching:Z0,rootBackgroundColor:Jl,rootForegroundColor:ad,rootLineColor:Ql,rootColorSecondary:M0,imageOutlineOpacity:R1,utilTools:xd,imageSelectionPan:bl,imageSelectionZoom:xl,imageSelectionZoomCurrent:Px,imageSelectionStageFitScalar:L0,imageSelectionStoredState:z0,imageOverlayMarkup:oc,interfaceImages:gd,isInteracting:ec,isTransformingImage:P0,isInteractingFraction:f1,imageCropRectIntent:x1,imageCropRectPresentation:R0,imageSelectionRect:Xo,imageSelectionRectIntent:b1,imageSelectionRectPresentation:md,imageSelectionRectSnapshot:pd,imageScalar:_0,imageTransformsInterpolated:Mx,imageEffects:H0};delete X0.image;const Rx="util-"+na();let _1=[];const Y0=$=>j.find(([Y])=>$===Y);let dc=[];const V1=$=>{i(62,dc=dc.concat($))},N1=$=>{i(62,dc=dc.filter(Y=>Y!==$))},H1=($,Y)=>{i(295,U[$]=Y,U)};let q0=va();const K0=($,Y,gt)=>{let St=Ce.getPropertyValue($);St=gt?gt(St):/^[0-9]+$/.test(St)?parseFloat(St):void 0,Y.set(St,{hard:!xn})},Gs=($,Y,gt=!1)=>{const St=(ct=>{const ft=Ce.getPropertyValue(ct);return A2(ft)})($);St&&St[3]!==0&&(gt||(St.length=3),Y.set(St,{hard:!xn}))},j1=pe();A(t,j1,$=>i(87,mn=$));const U1=pe();A(t,U1,$=>i(88,Pn=$));const G1=pe();A(t,G1,$=>i(89,bn=$));const wd=ci(0,{damping:.9});A(t,wd,$=>i(90,Fi=$));const J0=()=>{Gs("color",ad),Gs(Za?"--color-background":"background-color",Jl),Gs("outline-color",Ql),Gs("--color-primary",m1),Gs("--color-secondary",M0),Gs("--grid-color-even",U1,!0),Gs("--grid-color-odd",G1,!0),K0("--grid-size",j1),K0("--editor-inset-top",g1,$=>parseInt($,10))},Q0=Ii([fd,H0,id,dx],([$,Y,gt,St])=>$&&{...$,...Y,backgroundColor:gt,backgroundImage:St});A(t,Q0,$=>i(387,xr=$));const Ix=()=>{const $=Yo.length?void 0:{resize:1.05},Y=((gt,St,ct={})=>{const{resize:ft=1,opacity:Jt=0}=ct,qe={opacity:[ci(Jt,{...el,stiffness:.1}),Yi],resize:[ci(ft,{...el,stiffness:.1}),Yi],translation:[ci(void 0,el),Yi],rotation:[ci(void 0,Yd),Yi],origin:[ci(void 0,el),Yi],scale:[ci(void 0,Yd),Yi],gamma:[ci(void 0,Yd),nn=>nn||1],vignette:[ci(void 0,Yd),nn=>nn||0],colorMatrix:[ci([...Ig],el),nn=>nn||[...Ig]],convolutionMatrix:[pe(void 0),nn=>nn&&nn.clarity||void 0],backgroundColor:[ci(void 0,el),(nn,Qn,Fo)=>{if(Array.isArray(nn)){if(Array.isArray(Qn)){const Xi=[...nn];Qn[3]===0?(Xi[3]=0,Fo(Xi)):Xi[3]===0&&((nn=[...Qn])[3]=0)}return nn}}],backgroundImage:[pe(void 0),Yi]},Je=Object.entries(qe).map(([nn,Qn])=>[nn,Qn[0]]),He=Je.map(([,nn])=>nn),$n=Object.entries(qe).reduce((nn,[Qn,Fo])=>{const[Xi,qo]=Fo;return nn[Qn]=(Xs,Sl)=>Xi.set(qo(Xs,Rn[Qn],ip=>{Xi.set(ip,{hard:!0})}),Sl),nn},{});let Rn;const kr=Ii(He,nn=>(Rn=nn.reduce((Qn,Fo,Xi)=>(Qn[Je[Xi][0]]=Fo,Qn),{}),Rn.data=gt,Rn.size=St,Rn.scale*=nn[1],Rn));return kr.get=()=>Rn,kr.set=(nn,Qn)=>{const Fo={hard:!Qn};Object.entries(nn).forEach(([Xi,qo])=>{$n[Xi]&&$n[Xi](qo,Fo)})},kr})($e,Gt,$);Yo.unshift(Y),tm(xr)},tm=$=>{Yo.forEach((Y,gt)=>{const St=gt===0?1:0;Y.set({...$,opacity:St,resize:1},br)})};let Sd;const uc=Zh(void 0,{duration:500});let Z1;A(t,uc,$=>i(54,go=$));const kd=pe(!1);let Ja;A(t,kd,$=>i(382,Mo=$));const Cd=ci(void 0,{stiffness:.1,damping:.7,precision:.25});A(t,Cd,$=>i(82,Ni=$));const Td=ci(0,{stiffness:.1,precision:.05});A(t,Td,$=>i(83,ti=$));const pc=ci(0,{stiffness:.02,damping:.5,precision:.25});A(t,pc,$=>i(380,No=$));const X1=ci(void 0,{stiffness:.02,damping:.5,precision:.25});A(t,X1,$=>i(381,Kr=$));const Md=ci(void 0,{stiffness:.02,damping:.5,precision:.25});let Pd;A(t,Md,$=>i(379,On=$));const Ex=()=>{Sr("abortLoadImage")},Ax=()=>{Sr("abortProcessImage"),vt($s,Oi=!1,Oi)},em=$=>{$.target&&$.target.dataset.touchScroll==="true"||$.preventDefault()},Lx=j0?$=>{const Y=$.touches?$.touches[0]:$;Y.pageX>20&&Y.pageX<window.innerWidth-20||em($)}:ge,Zs=pe([]);A(t,Zs,$=>i(472,Rr=$)),ho("keysPressed",Zs);const Y1=$=>{!$||Ol($)&&!(Y=>/^image/.test(Y.type)&&!/svg/.test(Y.type))($)||!Ol($)&&!/^http/.test($)||Sr("loadImage",$)},zx=$=>{$&&Y1($)};let wl,hc,q1=[];const im=pe();ho("rootPortal",im),ho("rootRect",$l);const nm=()=>({foregroundColor:[...sn],lineColor:[...wn],utilVisibility:{...U},isInteracting:un,isInteractingFraction:Zi,rootRect:ki(Se),stageRect:ki(Be),manipulationShapesDirty:zd,annotationShapesDirty:Id,decorationShapesDirty:Ad,frameShapesDirty:Ld}),rm=($,Y,gt)=>Gn($,jn(Math.round(Y.width/gt),Math.round(Y.height/gt))),om=($,Y,gt)=>{var St;return $._translate=rt((St=Y).x,St.y),$._scale=gt,$},Rd=$=>{const Y=[];return $.forEach(gt=>Y.push(Fx(gt))),Y.filter(Boolean)},Fx=$=>tr($)?($.points=[rt($.x1,$.y1),rt($.x2,$.y2)],$):(!(Y=>Xn(Y)&&!Y.text.length)($)||$.backgroundColor&&$.backgroundColor[3]!==0||($u($)&&($.width=5,$.height=$.lineHeight),$.strokeWidth=1,$.strokeColor=[1,1,1,.5],$.backgroundColor=[0,0,0,.1]),$);let am,K1=[],J1=[],Q1=[],tp=[],ep=[],sm={};const lm=($,Y,gt,St,ct,ft,Jt)=>{const{manipulationShapesDirty:qe,annotationShapesDirty:Je,decorationShapesDirty:He,frameShapesDirty:$n,selectionRect:Rn,scale:kr}=$,nn=am!==kr,Qn=nn||!ea(sm,Rn);Qn&&(am=kr,sm=Rn),qe&&(Q1=Y.filter(Wd).map(Hn).map(Xi=>Gn(Xi,Gt))),(Je||gt!==ri)&&(K1=gt.filter(Wd).map(Hn).sort((Xi,qo)=>Xi.alwaysOnTop?1:qo.alwaysOnTop?-1:0).map(Xi=>Gn(Xi,Gt))),(nn||Ed||Je||gt!==ri)&&(J1=Rd(K1.map(Xi=>f(Xi,{flipX:Ti,flipY:gi,rotation:Ve,scale:kr,context:Or(Gt)})).flat())),(He||St!==Le||Qn)&&(tp=Rd(St.filter(Wd).map(Hn).sort((Xi,qo)=>Xi.alwaysOnTop?1:qo.alwaysOnTop?-1:0).map(Xi=>rm(Xi,Rn,kr)).map(Xi=>f(Xi,{context:Rn})).flat().map(Xi=>om(Xi,Rn,kr)))),($n||ft!==vi||Qn)&&(ep=ft?Rd([ft].map(Hn).map(Xi=>rm(Xi,Rn,kr)).map(f).flat().map(Xi=>om(Xi,Rn,kr))):[]);let Fo=Rd(ct.filter(Wd));return typeof window<"u"&&(Xi=>{if(Xi&&Xi._qnr6q7e)return;const[qo]=[[85,110,108,105,99,101,110,115,101,100,32,80,105,110,116,117,114,97,32,105,110,115,116,97,110,99,101]].map(Xs=>Xs.map(Sl=>String.fromCharCode(Sl)).join(""));Fo=[...Fo,{x:Rn.x+.5*Rn.width-82,y:Rn.y+Rn.height-16-12,width:164,height:16,text:qo,fontWeight:900,fontSize:12,color:[1,1,1,.25]}]})(window),{manipulationShapesDirty:qe,manipulationShapes:Q1,annotationShapesDirty:Je,annotationShapes:J1,decorationShapesDirty:He,decorationShapes:tp,frameShapesDirty:$n,frameShapes:ep,interfaceShapes:Fo,selectionShapes:Jt.map(Hn).map(Xi=>Gn(Xi,Gt))}};let Id=!0,Ed=!0,Ad=!0,Ld=!0,zd=!0;return Vo(()=>{_s(),$e&&We($e.src)&&/^blob:/.test($e.src)&&URL.revokeObjectURL($e.src),ux(),gx(),$x(),fx(),yx(),xx(),bx(),Sx(),Tx(),sd.destroy(),ld.destroy(),qu.destroy(),Yo.clear(),K1.length=0,J1.length=0,Q1.length=0,tp.length=0,ep.length=0;try{i(233,lc=void 0),i(290,Sd=void 0)}catch{}}),t.$$set=$=>{"class"in $&&i(234,Ur=$.class),"layout"in $&&i(235,ln=$.layout),"stores"in $&&i(236,Lo=$.stores),"locale"in $&&i(3,tn=$.locale),"id"in $&&i(4,po=$.id),"util"in $&&i(237,pa=$.util),"utils"in $&&i(238,jl=$.utils),"animations"in $&&i(239,cs=$.animations),"disabled"in $&&i(240,ja=$.disabled),"status"in $&&i(232,fo=$.status),"previewUpscale"in $&&i(241,Pa=$.previewUpscale),"previewPad"in $&&i(242,ul=$.previewPad),"previewMaskOpacity"in $&&i(5,ds=$.previewMaskOpacity),"previewImageDataMaxSize"in $&&i(243,b=$.previewImageDataMaxSize),"previewImageTextPixelRatio"in $&&i(6,N=$.previewImageTextPixelRatio),"markupMaskOpacity"in $&&i(7,L=$.markupMaskOpacity),"zoomMaskOpacity"in $&&i(244,ot=$.zoomMaskOpacity),"elasticityMultiplier"in $&&i(8,lt=$.elasticityMultiplier),"willRevert"in $&&i(245,Lt=$.willRevert),"willProcessImage"in $&&i(246,Ht=$.willProcessImage),"willRenderCanvas"in $&&i(9,Nt=$.willRenderCanvas),"willRenderToolbar"in $&&i(247,Wt=$.willRenderToolbar),"willRenderUtilTabs"in $&&i(248,zt=$.willRenderUtilTabs),"willSetHistoryInitialState"in $&&i(249,Vt=$.willSetHistoryInitialState),"enableButtonExport"in $&&i(250,qt=$.enableButtonExport),"enableButtonRevert"in $&&i(251,ii=$.enableButtonRevert),"enableNavigateHistory"in $&&i(252,oe=$.enableNavigateHistory),"enableToolbar"in $&&i(10,ue=$.enableToolbar),"enableUtils"in $&&i(253,ke=$.enableUtils),"enableButtonClose"in $&&i(254,we=$.enableButtonClose),"enableDropImage"in $&&i(255,Ye=$.enableDropImage),"enablePasteImage"in $&&i(256,ei=$.enablePasteImage),"enableBrowseImage"in $&&i(257,bi=$.enableBrowseImage),"enableTransparencyGrid"in $&&i(11,ui=$.enableTransparencyGrid),"layoutDirectionPreference"in $&&i(258,Mi=$.layoutDirectionPreference),"layoutHorizontalUtilsPreference"in $&&i(259,cn=$.layoutHorizontalUtilsPreference),"layoutVerticalUtilsPreference"in $&&i(260,Hi=$.layoutVerticalUtilsPreference),"layoutVerticalToolbarPreference"in $&&i(261,Ri=$.layoutVerticalToolbarPreference),"layoutVerticalControlGroupsPreference"in $&&i(262,kn=$.layoutVerticalControlGroupsPreference),"layoutVerticalControlTabsPreference"in $&&i(263,Ki=$.layoutVerticalControlTabsPreference),"textDirection"in $&&i(12,Zn=$.textDirection),"markupEditorZoomLevel"in $&&i(264,en=$.markupEditorZoomLevel),"markupEditorZoomLevels"in $&&i(13,Gr=$.markupEditorZoomLevels),"markupEditorZoomAdjustStep"in $&&i(14,Zr=$.markupEditorZoomAdjustStep),"markupEditorZoomAdjustFactor"in $&&i(15,io=$.markupEditorZoomAdjustFactor),"markupEditorZoomAdjustWheelFactor"in $&&i(16,Ua=$.markupEditorZoomAdjustWheelFactor),"markupEditorInteractionMode"in $&&i(265,Ra=$.markupEditorInteractionMode),"muteAudio"in $&&i(266,Ga=$.muteAudio),"willSetMediaInitialTimeOffset"in $&&i(267,us=$.willSetMediaInitialTimeOffset),"enablePan"in $&&i(17,Ia=$.enablePan),"enableZoom"in $&&i(18,Go=$.enableZoom),"enableZoomControls"in $&&i(268,yo=$.enableZoomControls),"enableZoomInput"in $&&i(19,ps=$.enableZoomInput),"enablePanInput"in $&&i(269,ha=$.enablePanInput),"enableCanvasAlpha"in $&&i(20,Za=$.enableCanvasAlpha),"enablePanLimit"in $&&i(21,Zo=$.enablePanLimit),"panLimitGutterScalar"in $&&i(22,Xa=$.panLimitGutterScalar),"zoomPresetOptions"in $&&i(23,hs=$.zoomPresetOptions),"zoomAdjustStep"in $&&i(24,Os=$.zoomAdjustStep),"zoomAdjustFactor"in $&&i(25,Ul=$.zoomAdjustFactor),"zoomAdjustWheelFactor"in $&&i(26,Ea=$.zoomAdjustWheelFactor),"zoomLevel"in $&&i(0,xo=$.zoomLevel),"fixScrollDirection"in $&&i(270,Un=$.fixScrollDirection),"imagePreviewSrc"in $&&i(273,Ou=$.imagePreviewSrc),"imageOrienter"in $&&i(274,Zc=$.imageOrienter),"pluginComponents"in $&&i(275,pl=$.pluginComponents),"pluginOptions"in $&&i(27,Ws=$.pluginOptions),"root"in $&&i(2,Jn=$.root),"imageSourceToImageData"in $&&i(28,Yu=$.imageSourceToImageData),"imagePreviewCurrent"in $&&i(233,lc=$.imagePreviewCurrent)},t.$$.update=()=>{if(4194304&t.$$.dirty[8]&&ma.set(Un),8&t.$$.dirty[0]&&i(347,n=!!tn),1&t.$$.dirty[0]|65536&t.$$.dirty[8]&&i(0,xo=xo===null?en:xo),2&t.$$.dirty[0]|134217728&t.$$.dirty[8]){let ct=!1;pl.forEach(([ft])=>{zo[ft]||(i(1,zo[ft]={},zo),ct=!0)}),ct&&i(287,ql=[...pl])}var $,Y,gt,St;if(2097152&t.$$.dirty[7]|256&t.$$.dirty[9]|64&t.$$.dirty[11]&&i(345,S=n&&ql.length?jl||ql.map(([ct])=>ct):[]),134217728&t.$$.dirty[0]|256&t.$$.dirty[9]|16&t.$$.dirty[11]|2097152&t.$$.dirty[12]&&i(346,j=((ct,ft,Jt,qe)=>{const Je=ft.filter(([He])=>ct.includes(He)).filter(([He,{isSupported:$n}])=>$n({...qe,...Jt[He]})).map(([He,$n])=>[He,$n.Component]);return as(Je,_1,(He,$n)=>He[0]===$n[0]&&He[1]===$n[1])?_1:(_1=Je,Je)})(S,ql,Ws,{src:Jr})),32&t.$$.dirty[11]&&i(299,Q=j.length),8&t.$$.dirty[0]|1048576&t.$$.dirty[9]|16&t.$$.dirty[11]&&i(344,ht=Q&&S.map(ct=>{const ft=Y0(ct);if(ft)return{id:ct,view:ft[1],tabIcon:tn[ct+"Icon"],tabLabel:tn[ct+"Label"]}}).filter(Boolean)||[]),8&t.$$.dirty[11]&&i(364,r=!!ht.find(ct=>ct.id==="trim")),25165824&t.$$.dirty[11]|16384&t.$$.dirty[13]&&i(298,o=!!(Te&&$e&&r)),1048576&t.$$.dirty[7]|1048576&t.$$.dirty[9]&&i(43,at=Q&&pa&&typeof pa=="string"&&Y0(pa)?pa:Q>0?j[0][0]:void 0),4096&t.$$.dirty[1]|524288&t.$$.dirty[9]&&o&&at&&_s(),524288&t.$$.dirty[9]|16777216&t.$$.dirty[11]&&(o?($e.addEventListener("play",Xc),$e.addEventListener("pause",Xc)):$e&&$e.nodeName==="video"&&($e.removeEventListener("play",Xc),$e.removeEventListener("pause",Xc))),524288&t.$$.dirty[9]&&o&&Ya.set(Yl()/qa()),73728&t.$$.dirty[13]&&(ct=>{if(!hl())return;const ft=Date.now();if(Vu&&ft-Vu<16)return;Vu=ft;const Jt=Te*ct;if(Jt.toFixed(1)===s0)return;s0=Jt.toFixed(1);const qe=$e,Je=()=>{qe.removeEventListener("seeked",Je),Wu()};qe.addEventListener("seeked",Je),Cg(qe,Jt)})(fi||I),8192&t.$$.dirty[13]&&i(362,a=I&&ai(I,6)),149504&t.$$.dirty[13]&&i(360,s=Nr||[[0,Math.min(Te,Di)/Te]]),524288&t.$$.dirty[11]&&(l=s[0][0]),524288&t.$$.dirty[11]&&(c=s[s.length-1][1]),524288&t.$$.dirty[11]&&i(363,d=s.map(([ct,ft])=>[ai(ct,6),ai(ft,6)])),6291456&t.$$.dirty[11]&&i(361,u=d.findIndex(([ct,ft])=>a>=ct&&a<=ft)),7340032&t.$$.dirty[11]&&(p=u===-1&&d.findIndex((ct,ft,Jt)=>{const qe=Jt[ft-1];return qe?a<=ct[0]&&a>=qe[1]:a<=ct[0]})),262144&t.$$.dirty[8]&&Xl.set(Ga),16777216&t.$$.dirty[11]|32768&t.$$.dirty[13]&&($e&&Ne?Gu():Zu()),524288&t.$$.dirty[9]|8192&t.$$.dirty[13]&&o&&Kc.set(qa()*I),16777216&t.$$.dirty[11]|4096&t.$$.dirty[13]&&$e&&(ct=>{o&&($e.volume=Math.min(1,ct))})(Hr),256&t.$$.dirty[0]&&vt(qc,Oa=lt,Oa),262144&t.$$.dirty[7]&&i(356,h=ln==="overlay"),32&t.$$.dirty[8]|32768&t.$$.dirty[11]&&i(45,g=ke&&!h),134217730&t.$$.dirty[0]&&Ws&&Object.entries(Ws).forEach(([ct,ft])=>{Object.entries(ft).forEach(([Jt,qe])=>{zo[ct]&&i(1,zo[ct][Jt]=qe,zo)})}),64&t.$$.dirty[13]&&i(357,w=!Gi),4194304&t.$$.dirty[7]|196608&t.$$.dirty[11]&&vt(dd,xn=cs==="always"?x:cs!=="never"&&x&&w,xn),4194304&t.$$.dirty[1]|8388608&t.$$.dirty[7]&&Xu.set(ja?1:0,{hard:!xn}),67108864&t.$$.dirty[7]&&(m=b?($=b,Y=u0,jn(Math.min($.width,Y.width),Math.min($.height,Y.height))):u0),1024&t.$$.dirty[13]&&qu.update(jo[0]),512&t.$$.dirty[13]&&(f=Ta?(ct,ft)=>Ta(ct,{flipX:void 0,flipY:void 0,rotation:void 0,...ft,isPreview:!0}):Yi),268435456&t.$$.dirty[1]&&Array.isArray(ua)&&Sr("selectionchange",[...ua]),1048576&t.$$.dirty[8]|256&t.$$.dirty[13]&&p1.set(da&&yo),2228224&t.$$.dirty[8]&&od.set(Ra==="pan"||ha),1048576&t.$$.dirty[1]&&Vn&&$l.set(An(Vn.x,Vn.y,Vn.width,Vn.height)),536903680&t.$$.dirty[11]|8192&t.$$.dirty[12]&&Se&&h&&Qi&&Qi.complete&&(()=>{const ct=Si,ft=ir(Se);ct&&ct===ft||(Qc.set(ir(Se)),G0())})(),16&t.$$.dirty[11]&&i(46,dt=S.length>1),32768&t.$$.dirty[1]&&(dt||gl.set(ks())),1024&t.$$.dirty[0]|128&t.$$.dirty[13]&&(ue||tc.set(An(0,hn,0,0))),1073872896&t.$$.dirty[11]&&i(359,k=!un&&x),1048576&t.$$.dirty[1]&&i(300,Zt=Vn&&Vn.width>0&&Vn.height>0),8&t.$$.dirty[0]|3145728&t.$$.dirty[9]&&i(40,Kt=Zt&&tn&&!!Q),512&t.$$.dirty[1]&&setTimeout(()=>i(288,y1=Kt),1),4194304&t.$$.dirty[7]|512&t.$$.dirty[9]|327680&t.$$.dirty[11]&&vt(cd,br=cs==="always"?k:cs!=="never"&&k&&y1&&w,br),16777216&t.$$.dirty[7]|32768&t.$$.dirty[11]&&ud.set(Pa||h),33554432&t.$$.dirty[7]&&hd.set(ul),4&t.$$.dirty[0]|36&t.$$.dirty[13]&&Jn&&(Jn.dispatchEvent(ys("markupzoom",xi)),Jn.dispatchEvent(ys("zoom",di(xi)?xi:O))),4&t.$$.dirty[0]|16&t.$$.dirty[13]&&Jn&&(Jn.dispatchEvent(ys("markuppan",je)),Jn.dispatchEvent(ys("pan",je))),2&t.$$.dirty[13]&&Nn&&F0(),8&t.$$.dirty[13]&&de&&C1(),4198400&t.$$.dirty[1]&&at&&R1.set(.075,{hard:!xn}),134217728&t.$$.dirty[7]&&i(354,C=ot),1073741824&t.$$.dirty[12]|1&t.$$.dirty[13]&&i(355,P=uo?-Math.max(...Object.values(wr)):0),138936320&t.$$.dirty[1]|24576&t.$$.dirty[11]&&Fn){let ct=Fn.x-Be.x,ft=Be.x+Be.width-(Fn.x+Fn.width),Jt=Fn.y-Be.y,qe=Be.y+Be.height-(Fn.y+Fn.height),Je=Math.min(ct,Jt,ft,qe);I1.set(Je>P?0:Math.min(C,Math.abs(Je/64)),{hard:!xn})}if(67108864&t.$$.dirty[1]&&i(353,R=.55/mr),4718592&t.$$.dirty[1]|4096&t.$$.dirty[11]&&Be&&E1.set({x:0,y:Be.y,width:Be.x<64?0:Be.x,height:Be.height+R},{hard:!xn}),4718592&t.$$.dirty[1]|536875008&t.$$.dirty[11]&&Be&&A1.set({x:0,y:0,width:Se.width,height:Be.y+R},{hard:!xn}),4718592&t.$$.dirty[1]|536875008&t.$$.dirty[11]&&Be){let ct=Be.x+Be.width,ft=Se.width-(Be.x+Be.width);ft<64&&(ct+=ft,ft=0),L1.set({x:ct,y:Be.y,width:ft,height:Be.height+R},{hard:!xn})}if(4718592&t.$$.dirty[1]|536870912&t.$$.dirty[11]&&Be&&z1.set({x:0,y:Be.y+Be.height,width:Se.width,height:Se.height-(Be.y+Be.height)},{hard:!xn}),33554432&t.$$.dirty[1]|603979776&t.$$.dirty[12]&&i(349,W=Qr&&{id:"stage-overlay",backgroundColor:qi,opacity:lr,...Qr}),33554432&t.$$.dirty[1]|335544320&t.$$.dirty[12]&&i(352,T=co&&{id:"stage-overlay",backgroundColor:qi,opacity:lr,...co}),33554432&t.$$.dirty[1]|201326592&t.$$.dirty[12]&&i(351,F=Vr&&{id:"stage-overlay",backgroundColor:qi,opacity:lr,...Vr}),33554432&t.$$.dirty[1]|100663296&t.$$.dirty[12]&&i(350,D=_i&&{id:"stage-overlay",backgroundColor:qi,opacity:lr,..._i}),3840&t.$$.dirty[11]&&i(348,B=[T,F,D,W].filter(Boolean)),128&t.$$.dirty[11]|16777216&t.$$.dirty[12]&&B&&Wi&&oc.update(ct=>[...ct.filter(ft=>ft.id!=="stage-overlay"),...B]),33554432&t.$$.dirty[8]|2097152&t.$$.dirty[12]&&sc.set(Ou||Jr||void 0),4&t.$$.dirty[0]|65536&t.$$.dirty[7]|16777216&t.$$.dirty[11]&&(i(233,lc=$e),$e&&Jn.dispatchEvent(ys("loadpreview",lc))),16384&t.$$.dirty[12]&&so&&(bl.set(rn()),xl.set(void 0),F0(),gd.set([])),8388608&t.$$.dirty[12]&&i(304,_=hr.index>0),8388608&t.$$.dirty[12]&&i(303,J=hr.index<hr.length-1),8&t.$$.dirty[1]&&Z0.set(bd),4194304&t.$$.dirty[12]&&W1.set(Ir),4096&t.$$.dirty[1]&&px.set(at),65536&t.$$.dirty[9]|8&t.$$.dirty[11]&&i(295,U=ht.reduce((ct,ft)=>(ct[ft.id]=U&&U[ft.id]||0,ct),{})),4096&t.$$.dirty[1]&&i(79,yt={name:Rx,selected:at}),8&t.$$.dirty[11]&&i(326,$t=ht.map(ct=>({id:ct.id,icon:ct.tabIcon,label:ct.tabLabel}))),8&t.$$.dirty[11]&&i(78,Mt=ht.map(ct=>ct.id)),131072&t.$$.dirty[7]&&i(77,Tt=pi(["PinturaRoot","PinturaRootComponent",Ur])),536870912&t.$$.dirty[11]&&i(340,K=Se&&(Se.width>1e3?"wide":Se.width<600?"narrow":void 0)),536870912&t.$$.dirty[11]&&i(327,q=Se&&(Se.width<=320||Se.height<=460)),536870912&t.$$.dirty[11]&&i(339,Z=Se&&(Se.height>1e3?"tall":Se.height<600?"short":void 0)),4&t.$$.dirty[0]&&i(306,xt=Jn&&Jn.parentNode&&Jn.parentNode.classList.contains("PinturaModal")),1&t.$$.dirty[1]|134217728&t.$$.dirty[9]|536870912&t.$$.dirty[11]&&i(332,it=xt&&Se&&yd>Se.width),2&t.$$.dirty[1]|134217728&t.$$.dirty[9]|536870912&t.$$.dirty[11]&&i(331,mt=xt&&Se&&B1>Se.height),6291456&t.$$.dirty[10]&&i(333,Ft=it&&mt),1048576&t.$$.dirty[0]&&i(330,ie=Za),1073741824&t.$$.dirty[10]&&i(301,Dt=K==="narrow"),1024&t.$$.dirty[8]|536870912&t.$$.dirty[11]&&i(341,(gt=Se,St=Mi,Ot=Se?St==="auto"?gt.width>gt.height?"landscape":"portrait":St==="horizontal"?gt.width<500?"portrait":"landscape":St==="vertical"?gt.height<400?"landscape":"portrait":void 0:"landscape")),1&t.$$.dirty[11]&&i(76,ae=Ot==="landscape"),4194304&t.$$.dirty[9]|536870912&t.$$.dirty[10]&&i(329,G=Dt||Z==="short"),1&t.$$.dirty[1]|536870912&t.$$.dirty[11]&&i(328,wt=q0&&Se&&yd===Se.width&&!j0),4&t.$$.dirty[1]|1048576&t.$$.dirty[12]&&i(302,ut=[..._r||[],...vd].filter(Boolean)),2048&t.$$.dirty[8]&&i(338,Xt="has-navigation-preference-"+cn),4096&t.$$.dirty[8]&&i(337,ce="has-navigation-preference-"+Hi),8192&t.$$.dirty[8]&&i(334,te="has-toolbar-preference-"+Ri),16384&t.$$.dirty[8]&&i(336,ve="has-controlgroups-preference-"+kn),32768&t.$$.dirty[8]&&i(335,me="has-controltabs-preference-"+Ki),536870912&t.$$.dirty[11]&&i(343,V=Se!==void 0&&Se.width>0&&Se.height>0),4&t.$$.dirty[0]|4&t.$$.dirty[11]&&i(342,Ce=V&&Jn&&getComputedStyle(Jn)),2&t.$$.dirty[11]&&Ce&&J0(),1024&t.$$.dirty[0]|4243456&t.$$.dirty[1]|8650752&t.$$.dirty[7]|134217728&t.$$.dirty[9]|2147352576&t.$$.dirty[10]|1&t.$$.dirty[11]|786464&t.$$.dirty[12]&&cc.set({...yn,layoutMode:ln,orientation:Ot,horizontalSpace:K,verticalSpace:Z,navigationHorizontalPreference:Xt,navigationVerticalPreference:ce,controlGroupsVerticalPreference:ve,controlTabsVerticalpreference:me,toolbarVerticalPreference:te,isModal:xt,isDisabled:ja,isCentered:Ft,isCenteredHorizontally:it,isCenteredVertically:mt,isAnimated:xn,isTransparent:ie,pointerAccuracy:Ro,pointerHoverable:Po,isCompact:G,hasSwipeNavigation:wt,hasLimitedSpace:q,hasToolbar:ue,hasNavigation:dt&&g,isIOS:q0,browserVersion:Gh()?"chrome-"+(navigator.userAgent.match(/Chrome\/([0-9]+)/)||[])[1]:void 0}),32&t.$$.dirty[12]&&i(75,yi=Object.entries(yn).map(([ct,ft])=>/^is|has/.test(ct)?ft?z2(ct):void 0:ft).filter(Boolean).join(" ")),4096&t.$$.dirty[1]&&at&&xd.set([]),4096&t.$$.dirty[1]|1&t.$$.dirty[8]|65536&t.$$.dirty[10]|32&t.$$.dirty[12]&&i(44,xe=zt($t.map(ct=>({...ct,selected:at===ct.id})),{...yn},()=>Vs.set({}))),8192&t.$$.dirty[1]&&i(74,_t=!!xe.find(ct=>Array.isArray(ct))),196608&t.$$.dirty[12]&&i(73,ze=ca&&Object.entries(lo).filter(([,ct])=>ct!=null).reduce((ct,[,ft])=>ct={...ct,...ft},{})),8192&t.$$.dirty[12]&&i(323,bt=Qi&&Qi.task==="any-to-file"),8192&t.$$.dirty[10]&&bt&&Yo&&Yo.clear(),32768&t.$$.dirty[12]&&i(325,Ie=!!xr&&!!xr.translation),2048&t.$$.dirty[9]|32768&t.$$.dirty[10]|16777216&t.$$.dirty[11]&&Ie&&$e&&$e!==Sd&&(i(290,Sd=$e),Ix()),32768&t.$$.dirty[10]|32768&t.$$.dirty[12]&&Ie&&tm(xr),16777216&t.$$.dirty[1]&&Ho&&Ho.length>1){let ct=[];Yo.forEach((ft,Jt)=>{Jt!==0&&ft.get().opacity<=0&&ct.push(ft)}),ct.forEach(ft=>Yo.remove(ft))}if(8&t.$$.dirty[0]|16384&t.$$.dirty[10]&&i(39,hi=tn&&Fe.length&&tn.labelSupportError(Fe)),8192&t.$$.dirty[12]&&i(315,ne=Qi&&!!Qi.error),8192&t.$$.dirty[12]&&i(42,Ue=!Qi||!Qi.complete&&Qi.task===void 0),8192&t.$$.dirty[12]&&i(316,Ee=Qi&&(Qi.taskLengthComputable?Qi.taskProgress:1/0)),8192&t.$$.dirty[10]&&bt&&vt(ac,pr=!1,pr),4194304&t.$$.dirty[1]|4096&t.$$.dirty[9]|8192&t.$$.dirty[12]&&Qi&&Qi.complete){const ct=xn?250:0;clearTimeout(Z1),i(291,Z1=setTimeout(()=>{vt(ac,pr=!0,pr)},ct))}if(2048&t.$$.dirty[1]|32&t.$$.dirty[10]|10240&t.$$.dirty[12]&&i(320,jt=Qi&&!ne&&!Ue&&!pr),1024&t.$$.dirty[9]|16777216&t.$$.dirty[11]|16384&t.$$.dirty[12]&&i(319,Ge=!(!so||$e&&!ms)),4194304&t.$$.dirty[1]|2048&t.$$.dirty[12]&&(pr?setTimeout(()=>wd.set(1,{hard:!xn}),xn?500:0):wd.set(0,{hard:!xn})),4160&t.$$.dirty[12]&&i(314,Qe=!!(Oi||pn&&pn.progress!==void 0&&!pn.complete)),16&t.$$.dirty[10]&&Qe&&_s(),2048&t.$$.dirty[1]|8192&t.$$.dirty[12]&&i(317,mi=Qi&&!(Qi.error||Ue)),8&t.$$.dirty[0]|8192&t.$$.dirty[12]&&i(318,$i=tn&&(Qi?!Qi.complete||Qi.error?jh(tn.statusLabelLoadImage(Qi),Qi.error&&Qi.error.metadata,"{","}"):tn.statusLabelLoadImage({progress:1/0,task:"blob-to-bitmap"}):tn.statusLabelLoadImage(Qi))),8&t.$$.dirty[0]|4096&t.$$.dirty[12]&&i(313,Li=pn&&tn&&tn.statusLabelProcessImage(pn)),4096&t.$$.dirty[12]&&i(311,X=pn&&(pn.taskLengthComputable?pn.taskProgress:1/0)),4096&t.$$.dirty[12]&&i(312,Ut=pn&&!pn.error),4096&t.$$.dirty[12]&&i(310,H=!(!pn||!pn.error)),8&t.$$.dirty[0]|2048&t.$$.dirty[1]|32768&t.$$.dirty[7]|2047&t.$$.dirty[10])if(fo){let ct,ft,Jt,qe,Je;We(fo)&&(ct=fo),di(fo)?ft=fo:Array.isArray(fo)&&([ct,ft,Je]=fo,ft===!1&&(qe=!0),di(ft)&&(Jt=!0)),i(35,Ja=(ct||ft)&&{text:ct,aside:qe||Jt,progressIndicator:{visible:Jt,progress:ft},closeButton:qe&&{label:tn.statusLabelButtonClose,icon:tn.statusIconButtonClose,onclick:Je||(()=>i(232,fo=void 0))}})}else i(35,Ja=tn&&Ue||ne||jt||Ge?{text:$i,aside:ne||mi,progressIndicator:{visible:mi,progress:Ee},closeButton:ne&&{label:tn.statusLabelButtonClose,icon:tn.statusIconButtonClose,onclick:Ex}}:tn&&Qe&&Li?{text:Li,aside:H||Ut,progressIndicator:{visible:Ut,progress:X},closeButton:H&&{label:tn.statusLabelButtonClose,icon:tn.statusIconButtonClose,onclick:Ax}}:void 0);if(32768&t.$$.dirty[7]&&i(322,Bt=fo!==void 0),4194304&t.$$.dirty[1]|134217728&t.$$.dirty[9]|4096&t.$$.dirty[12]&&xt&&pn&&pn.complete&&(kd.set(!0),setTimeout(()=>kd.set(!1),xn?100:0)),4&t.$$.dirty[0]|4096&t.$$.dirty[1]|2048&t.$$.dirty[12]&&pr&&Jn&&Jn.dispatchEvent(ys("selectutil",at)),2304&t.$$.dirty[1]|5680&t.$$.dirty[10]|1024&t.$$.dirty[12]&&i(321,be=Mo||hi||Ue||ne||jt||Ge||Qe||Bt),2048&t.$$.dirty[10]&&vt(uc,go=be?1:0,go),4194304&t.$$.dirty[1]|2048&t.$$.dirty[10]&&uc.set(be?1:0,{duration:xn?500:1}),8388608&t.$$.dirty[1]&&i(41,se=go>0),16&t.$$.dirty[1]&&i(309,At=!(!Ja||!Ja.aside)),4195344&t.$$.dirty[1]|1073750016&t.$$.dirty[9]|512&t.$$.dirty[12]&&se&&Ja){clearTimeout(Pd);const ct={hard:xn===!1};if(At){const ft=!!Ja.error||!xn;Td.set(1,ct),Cd.set(Kr,{hard:ft}),i(292,Pd=setTimeout(()=>{pc.set(16,ct)},1))}else Td.set(0,ct),i(292,Pd=setTimeout(()=>{pc.set(0,ct)},1))}if(1024&t.$$.dirty[1]&&(se||(Md.set(void 0,{hard:!0}),Cd.set(void 0,{hard:!0}),pc.set(0,{hard:!0}))),256&t.$$.dirty[12]&&i(308,re=.5*No),536870912&t.$$.dirty[9]|128&t.$$.dirty[12]&&i(72,Me=`transform: translateX(${On-re}px)`),256&t.$$.dirty[1]|50331648&t.$$.dirty[11]&&i(38,ye=$e&&Gt&&!hi),128&t.$$.dirty[1]|402653184&t.$$.dirty[9]&&i(305,_e=De&&(ye||xt)?em:ge),67108864&t.$$.dirty[9]&&i(71,Ze=_e),67108864&t.$$.dirty[9]&&i(70,nt=_e),8&t.$$.dirty[0]|2097152&t.$$.dirty[1]|1073741824&t.$$.dirty[7]|92&t.$$.dirty[8]|62914560&t.$$.dirty[9]|32&t.$$.dirty[12]&&i(69,Qt=tn&&To&&_c(()=>Wt([["div","alpha",{class:"PinturaNavGroup"},[["div","alpha-set",{class:"PinturaNavSet"},[we&&["Button","close",{label:tn.labelClose,icon:tn.iconButtonClose,onclick:()=>Sr("close"),hideLabel:!0}],ii&&["Button","revert",{label:tn.labelButtonRevert,icon:tn.iconButtonRevert,disabled:!_,onclick:kx,hideLabel:!0}]]]]],["div","beta",{class:"PinturaNavGroup PinturaNavGroupFloat"},[oe&&["div","history",{class:"PinturaNavSet"},[["Button","undo",{label:tn.labelButtonUndo,icon:tn.iconButtonUndo,disabled:!_,onclick:La.undo,hideLabel:!0}],["Button","redo",{label:tn.labelButtonRedo,icon:tn.iconButtonRedo,disabled:!J,onclick:La.redo,hideLabel:!0}]]],ut.length&&["div","plugin-tools",{class:"PinturaNavSet"},ut.filter(Boolean).map(([ct,ft,Jt])=>[ct,ft,{...Jt}])]]],["div","gamma",{class:"PinturaNavGroup"},[qt&&["Button","export",{label:tn.labelButtonExport,icon:Dt&&tn.iconButtonExport,class:"PinturaButtonExport",onclick:Cx,hideLabel:Dt}]]]],{...yn},()=>Vs.set({})))),2&t.$$.dirty[12]&&i(297,Yt=Mn&&!!Mn.length),262144&t.$$.dirty[9]|33554432&t.$$.dirty[11]|2&t.$$.dirty[12]&&i(296,st=Yt&&By(Gt,Mn)),393216&t.$$.dirty[9]|16777216&t.$$.dirty[11]|24&t.$$.dirty[12]&&Yt&&((ct,ft,Jt,qe)=>{if(!ft)return;const Je={dataSizeScalar:Jt};qe&&qe[3]>0&&(Je.backgroundColor=[...qe]),ft(ct,Je).then(He=>{wl&&qn(wl),i(293,wl=He)})})($e,fn,st,ao),16384&t.$$.dirty[9]|33554432&t.$$.dirty[11]|6&t.$$.dirty[12]&&Mn&&wl&&Gt){const{width:ct,height:ft}=Gt,Jt=Fa()?"pixelated":ur==="auto"?"auto":"pixelated";i(294,q1=Mn.map(qe=>{const Je=An(qe.x,qe.y,qe.width,qe.height),He=$r(ki(Je),qe.rotation).map($n=>rt($n.x/ct,$n.y/ft));return{...qe,id:"redaction",flipX:!1,flipY:!1,cornerRadius:0,strokeWidth:0,strokeColor:void 0,backgroundColor:[0,0,0,0],backgroundImage:wl,backgroundImageRendering:Jt,backgroundCorners:He}}))}32768&t.$$.dirty[9]|1&t.$$.dirty[12]&&i(37,le=[...q1,...an||[]]),32&t.$$.dirty[1]&&hc&&im.set(hc),4&t.$$.dirty[0]|128&t.$$.dirty[1]&&ye&&Jn&&Jn.dispatchEvent(ys("ready")),262144&t.$$.dirty[1]&&i(63,Id=!0),503316480&t.$$.dirty[11]&&i(64,Ed=!0),131072&t.$$.dirty[1]&&i(65,Ad=!0),65536&t.$$.dirty[1]&&i(66,Ld=!0),64&t.$$.dirty[1]&&i(67,zd=!0)},i(358,x=!Xh()),y=Tc()===1?$=>{$&&(So($.origin,Math.round),So($.translation,Math.round))}:Yi,i(324,Fe=[!K5()&&"WebGL"].filter(Boolean)),i(307,De=va()||Su()&&wa()),i(68,ee=(($,Y=!0)=>gt=>{gt.type==="ping"&&(Y&&gt.stopPropagation(),$(gt.detail.type,gt.detail.data))})(Fr.pub)),[xo,zo,Jn,tn,po,ds,N,L,lt,Nt,ue,ui,Zn,Gr,Zr,io,Ua,Ia,Go,ps,Za,Zo,Xa,hs,Os,Ul,Ea,Ws,Yu,F1,La,yd,B1,vd,bd,Ja,hc,le,ye,hi,Kt,se,Ue,at,xe,g,dt,vi,Le,ri,Be,Vn,To,xn,go,Ho,qi,mr,Fn,ua,Gl,Gc,dc,Id,Ed,Ad,Ld,zd,ee,Qt,nt,Ze,Me,ze,_t,yi,ae,Tt,Mt,yt,Wn,Eo,Ni,ti,oi,Ei,zi,mn,Pn,bn,Fi,Pi,zr,Ao,Wa,_a,Va,Na,Uo,ls,dl,Ha,_u,Zl,Ya,Xl,Vs,qc,Xu,Ku,Ns,Ju,Kc,Qu,h0,t1,Jc,e1,Qc,i1,$a,ml,td,ed,id,n1,r1,o1,a1,Hs,s1,nd,v0,w0,S0,k0,C0,T0,l1,c1,d1,rd,u1,p1,od,h1,Jl,ad,Ql,m1,$1,$l,gl,g1,tc,js,sd,ld,ec,f1,cd,dd,ud,Us,ic,x1,Xo,pd,b1,I0,fl,yl,Aa,w1,Ka,xl,S1,rc,bl,md,k1,D0,$d,oc,N0,I1,E1,A1,L1,z1,ac,sc,D1,gd,fd,cc,O1,$s,Yo,xd,X0,V1,N1,H1,($,Y)=>Y[$],$=>ht.find(Y=>Y.id===$).view,j1,U1,G1,wd,({target:$,propertyName:Y})=>{$===Jn&&/background|outline/.test(Y)&&Ce&&J0()},Q0,uc,kd,Cd,Td,pc,X1,Md,$=>{const Y=!(!Ja||!Ja.closeButton)||!xn;X1.set($.detail.width,{hard:Y}),Md.set(Math.round(.5*-$.detail.width),{hard:Y})},Lx,Zs,$=>{const{keyCode:Y,metaKey:gt,ctrlKey:St,shiftKey:ct}=$;if(Y===9&&ja)return void $.preventDefault();if($.target&&Y===32&&Jn.contains($.target)&&!Wc($.target)&&(Sn&&o&&Uu(),$.preventDefault()),Y===90&&(gt||St))return void(ct&&gt?La.redo():La.undo());if(Y===89&&St)return void La.redo();if(Y===229)return;const ft=new Set([...Rr,Y]);Zs.set(Array.from(ft))},({key:$,keyCode:Y})=>{if($==="Meta")return Zs.set([]);Zs.set(Rr.filter(gt=>gt!==Y))},()=>{Zs.set([])},$=>{Wc($.target)||$.preventDefault()},$=>{Ye&&Y1($.detail.resources[0])},()=>{bi&&F2().then(zx)},$=>{if(!ei)return;const Y=Ji((window.innerWidth-Math.abs(Se.x))/Se.width,0,1),gt=Ji((window.innerHeight-Math.abs(Se.y))/Se.height,0,1);Y<.75&&gt<.75||Y1(($.clipboardData||window.clipboardData).files[0])},nm,lm,$=>{Xe&&ea($.detail,Xe)||vt(js,Xe=$.detail,Xe)},fo,lc,Ur,ln,Lo,pa,jl,cs,ja,Pa,ul,b,ot,Lt,Ht,Wt,zt,Vt,qt,ii,oe,ke,we,Ye,ei,bi,Mi,cn,Hi,Ri,kn,Ki,en,Ra,Ga,us,yo,ha,Un,()=>i(60,Gl=void 0),($,Y,gt)=>{const{text:St="",placeholder:ct="",autoClose:ft=!0,align:Jt="top",justify:qe="center",buttonConfirm:Je,buttonCancel:He}=gt;i(60,Gl={align:Jt,justify:qe,text:St,placeholder:ct,buttonConfirm:Je,buttonCancel:He,onconfirm:()=>{$(Gc.value),ft&&i(60,Gl=void 0)},oncancel:()=>{Y(void 0),i(60,Gl=void 0)}})},Ou,Zc,pl,tx,ju,_s,hl,Uu,Gu,Zu,c0,qa,Yl,Yc,ql,y1,ms,Sd,Z1,Pd,wl,q1,U,st,Yt,o,Q,Zt,Dt,ut,J,_,_e,xt,De,re,At,H,X,Ut,Li,Qe,ne,Ee,mi,$i,Ge,jt,be,Bt,bt,Fe,Ie,$t,q,wt,G,ie,mt,it,Ft,te,me,ve,ce,Xt,Z,K,Ot,Ce,V,ht,S,j,n,B,W,D,F,T,R,C,P,h,w,x,k,s,u,a,d,r,$e,Gt,gi,Ti,Ve,Se,un,an,Mn,ur,ao,fn,yn,Oi,On,No,Kr,Mo,pr,pn,Qi,so,xr,lo,ca,Po,Ro,_r,Jr,Ir,hr,Wi,_i,lr,Vr,co,Qr,wr,uo,Nn,O,de,je,xi,Gi,hn,da,Ta,jo,Nr,Hr,I,Te,Ne,fi,Di,function(){i(31,yd=il.innerWidth),i(32,B1=il.innerHeight)},$=>vt(tc,oi=$.detail,oi),({detail:$})=>i(43,at=$),function($,Y){t.$$.not_equal(zo[Y],$)&&(zo[Y]=$,i(1,zo),i(275,pl),i(27,Ws))},$=>V1($),$=>N1($),($,{detail:Y})=>H1($,Y),$=>vt(gl,Wn=$.detail,Wn),function($){t.$$.not_equal(zo[at],$)&&(zo[at]=$,i(1,zo),i(275,pl),i(27,Ws))},()=>V1(at),()=>N1(at),({detail:$})=>H1(at,$),$=>{const Y={...$,...nm()},{annotationShapes:gt,decorationShapes:St,interfaceShapes:ct,frameShapes:ft,selectionShapes:Jt}=Nt({annotationShapes:ri,decorationShapes:Le,interfaceShapes:Ao,frameShapes:vi,selectionShapes:ua},Y);return lm(Y,le,gt,St,ct,ft,Jt)},()=>{i(63,Id=!1),i(64,Ed=!1),i(65,Ad=!1),i(66,Ld=!1),i(67,zd=!1)},function($){Ai[$?"unshift":"push"](()=>{hc=$,i(36,hc)})},function($){xo=$,i(0,xo),i(264,en)},function($){vd=$,i(33,vd)},function($){bd=$,i(34,bd)},function($){Ai[$?"unshift":"push"](()=>{Gc=$,i(61,Gc)})},function($){Ai[$?"unshift":"push"](()=>{Jn=$,i(2,Jn)})},$=>vt($1,Vn=$.detail,Vn)]}class Vg extends li{constructor(e){super(),si(this,e,f3,g3,ni,{class:234,layout:235,stores:236,locale:3,id:4,util:237,utils:238,animations:239,disabled:240,status:232,previewUpscale:241,previewPad:242,previewMaskOpacity:5,previewImageDataMaxSize:243,previewImageTextPixelRatio:6,markupMaskOpacity:7,zoomMaskOpacity:244,elasticityMultiplier:8,willRevert:245,willProcessImage:246,willRenderCanvas:9,willRenderToolbar:247,willRenderUtilTabs:248,willSetHistoryInitialState:249,enableButtonExport:250,enableButtonRevert:251,enableNavigateHistory:252,enableToolbar:10,enableUtils:253,enableButtonClose:254,enableDropImage:255,enablePasteImage:256,enableBrowseImage:257,enableTransparencyGrid:11,layoutDirectionPreference:258,layoutHorizontalUtilsPreference:259,layoutVerticalUtilsPreference:260,layoutVerticalToolbarPreference:261,layoutVerticalControlGroupsPreference:262,layoutVerticalControlTabsPreference:263,textDirection:12,markupEditorZoomLevel:264,markupEditorZoomLevels:13,markupEditorZoomAdjustStep:14,markupEditorZoomAdjustFactor:15,markupEditorZoomAdjustWheelFactor:16,markupEditorInteractionMode:265,muteAudio:266,willSetMediaInitialTimeOffset:267,enablePan:17,enableZoom:18,enableZoomControls:268,enableZoomInput:19,enablePanInput:269,enableCanvasAlpha:20,enablePanLimit:21,panLimitGutterScalar:22,zoomPresetOptions:23,zoomAdjustStep:24,zoomAdjustFactor:25,zoomAdjustWheelFactor:26,zoomLevel:0,fixScrollDirection:270,hideTextInput:271,showTextInput:272,imagePreviewSrc:273,imageOrienter:274,pluginComponents:275,pluginOptions:27,sub:276,pluginInterface:1,root:2,play:277,pause:278,isPaused:279,togglePlayPause:280,mute:281,unmute:282,toggleMute:283,getDuration:284,getCurrentTime:285,setCurrentTime:286,imageSourceToImageData:28,imagePreview:29,imagePreviewCurrent:233,history:30},null,[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1])}get class(){return this.$$.ctx[234]}set class(e){this.$$set({class:e}),E()}get layout(){return this.$$.ctx[235]}set layout(e){this.$$set({layout:e}),E()}get stores(){return this.$$.ctx[236]}set stores(e){this.$$set({stores:e}),E()}get locale(){return this.$$.ctx[3]}set locale(e){this.$$set({locale:e}),E()}get id(){return this.$$.ctx[4]}set id(e){this.$$set({id:e}),E()}get util(){return this.$$.ctx[237]}set util(e){this.$$set({util:e}),E()}get utils(){return this.$$.ctx[238]}set utils(e){this.$$set({utils:e}),E()}get animations(){return this.$$.ctx[239]}set animations(e){this.$$set({animations:e}),E()}get disabled(){return this.$$.ctx[240]}set disabled(e){this.$$set({disabled:e}),E()}get status(){return this.$$.ctx[232]}set status(e){this.$$set({status:e}),E()}get previewUpscale(){return this.$$.ctx[241]}set previewUpscale(e){this.$$set({previewUpscale:e}),E()}get previewPad(){return this.$$.ctx[242]}set previewPad(e){this.$$set({previewPad:e}),E()}get previewMaskOpacity(){return this.$$.ctx[5]}set previewMaskOpacity(e){this.$$set({previewMaskOpacity:e}),E()}get previewImageDataMaxSize(){return this.$$.ctx[243]}set previewImageDataMaxSize(e){this.$$set({previewImageDataMaxSize:e}),E()}get previewImageTextPixelRatio(){return this.$$.ctx[6]}set previewImageTextPixelRatio(e){this.$$set({previewImageTextPixelRatio:e}),E()}get markupMaskOpacity(){return this.$$.ctx[7]}set markupMaskOpacity(e){this.$$set({markupMaskOpacity:e}),E()}get zoomMaskOpacity(){return this.$$.ctx[244]}set zoomMaskOpacity(e){this.$$set({zoomMaskOpacity:e}),E()}get elasticityMultiplier(){return this.$$.ctx[8]}set elasticityMultiplier(e){this.$$set({elasticityMultiplier:e}),E()}get willRevert(){return this.$$.ctx[245]}set willRevert(e){this.$$set({willRevert:e}),E()}get willProcessImage(){return this.$$.ctx[246]}set willProcessImage(e){this.$$set({willProcessImage:e}),E()}get willRenderCanvas(){return this.$$.ctx[9]}set willRenderCanvas(e){this.$$set({willRenderCanvas:e}),E()}get willRenderToolbar(){return this.$$.ctx[247]}set willRenderToolbar(e){this.$$set({willRenderToolbar:e}),E()}get willRenderUtilTabs(){return this.$$.ctx[248]}set willRenderUtilTabs(e){this.$$set({willRenderUtilTabs:e}),E()}get willSetHistoryInitialState(){return this.$$.ctx[249]}set willSetHistoryInitialState(e){this.$$set({willSetHistoryInitialState:e}),E()}get enableButtonExport(){return this.$$.ctx[250]}set enableButtonExport(e){this.$$set({enableButtonExport:e}),E()}get enableButtonRevert(){return this.$$.ctx[251]}set enableButtonRevert(e){this.$$set({enableButtonRevert:e}),E()}get enableNavigateHistory(){return this.$$.ctx[252]}set enableNavigateHistory(e){this.$$set({enableNavigateHistory:e}),E()}get enableToolbar(){return this.$$.ctx[10]}set enableToolbar(e){this.$$set({enableToolbar:e}),E()}get enableUtils(){return this.$$.ctx[253]}set enableUtils(e){this.$$set({enableUtils:e}),E()}get enableButtonClose(){return this.$$.ctx[254]}set enableButtonClose(e){this.$$set({enableButtonClose:e}),E()}get enableDropImage(){return this.$$.ctx[255]}set enableDropImage(e){this.$$set({enableDropImage:e}),E()}get enablePasteImage(){return this.$$.ctx[256]}set enablePasteImage(e){this.$$set({enablePasteImage:e}),E()}get enableBrowseImage(){return this.$$.ctx[257]}set enableBrowseImage(e){this.$$set({enableBrowseImage:e}),E()}get enableTransparencyGrid(){return this.$$.ctx[11]}set enableTransparencyGrid(e){this.$$set({enableTransparencyGrid:e}),E()}get layoutDirectionPreference(){return this.$$.ctx[258]}set layoutDirectionPreference(e){this.$$set({layoutDirectionPreference:e}),E()}get layoutHorizontalUtilsPreference(){return this.$$.ctx[259]}set layoutHorizontalUtilsPreference(e){this.$$set({layoutHorizontalUtilsPreference:e}),E()}get layoutVerticalUtilsPreference(){return this.$$.ctx[260]}set layoutVerticalUtilsPreference(e){this.$$set({layoutVerticalUtilsPreference:e}),E()}get layoutVerticalToolbarPreference(){return this.$$.ctx[261]}set layoutVerticalToolbarPreference(e){this.$$set({layoutVerticalToolbarPreference:e}),E()}get layoutVerticalControlGroupsPreference(){return this.$$.ctx[262]}set layoutVerticalControlGroupsPreference(e){this.$$set({layoutVerticalControlGroupsPreference:e}),E()}get layoutVerticalControlTabsPreference(){return this.$$.ctx[263]}set layoutVerticalControlTabsPreference(e){this.$$set({layoutVerticalControlTabsPreference:e}),E()}get textDirection(){return this.$$.ctx[12]}set textDirection(e){this.$$set({textDirection:e}),E()}get markupEditorZoomLevel(){return this.$$.ctx[264]}set markupEditorZoomLevel(e){this.$$set({markupEditorZoomLevel:e}),E()}get markupEditorZoomLevels(){return this.$$.ctx[13]}set markupEditorZoomLevels(e){this.$$set({markupEditorZoomLevels:e}),E()}get markupEditorZoomAdjustStep(){return this.$$.ctx[14]}set markupEditorZoomAdjustStep(e){this.$$set({markupEditorZoomAdjustStep:e}),E()}get markupEditorZoomAdjustFactor(){return this.$$.ctx[15]}set markupEditorZoomAdjustFactor(e){this.$$set({markupEditorZoomAdjustFactor:e}),E()}get markupEditorZoomAdjustWheelFactor(){return this.$$.ctx[16]}set markupEditorZoomAdjustWheelFactor(e){this.$$set({markupEditorZoomAdjustWheelFactor:e}),E()}get markupEditorInteractionMode(){return this.$$.ctx[265]}set markupEditorInteractionMode(e){this.$$set({markupEditorInteractionMode:e}),E()}get muteAudio(){return this.$$.ctx[266]}set muteAudio(e){this.$$set({muteAudio:e}),E()}get willSetMediaInitialTimeOffset(){return this.$$.ctx[267]}set willSetMediaInitialTimeOffset(e){this.$$set({willSetMediaInitialTimeOffset:e}),E()}get enablePan(){return this.$$.ctx[17]}set enablePan(e){this.$$set({enablePan:e}),E()}get enableZoom(){return this.$$.ctx[18]}set enableZoom(e){this.$$set({enableZoom:e}),E()}get enableZoomControls(){return this.$$.ctx[268]}set enableZoomControls(e){this.$$set({enableZoomControls:e}),E()}get enableZoomInput(){return this.$$.ctx[19]}set enableZoomInput(e){this.$$set({enableZoomInput:e}),E()}get enablePanInput(){return this.$$.ctx[269]}set enablePanInput(e){this.$$set({enablePanInput:e}),E()}get enableCanvasAlpha(){return this.$$.ctx[20]}set enableCanvasAlpha(e){this.$$set({enableCanvasAlpha:e}),E()}get enablePanLimit(){return this.$$.ctx[21]}set enablePanLimit(e){this.$$set({enablePanLimit:e}),E()}get panLimitGutterScalar(){return this.$$.ctx[22]}set panLimitGutterScalar(e){this.$$set({panLimitGutterScalar:e}),E()}get zoomPresetOptions(){return this.$$.ctx[23]}set zoomPresetOptions(e){this.$$set({zoomPresetOptions:e}),E()}get zoomAdjustStep(){return this.$$.ctx[24]}set zoomAdjustStep(e){this.$$set({zoomAdjustStep:e}),E()}get zoomAdjustFactor(){return this.$$.ctx[25]}set zoomAdjustFactor(e){this.$$set({zoomAdjustFactor:e}),E()}get zoomAdjustWheelFactor(){return this.$$.ctx[26]}set zoomAdjustWheelFactor(e){this.$$set({zoomAdjustWheelFactor:e}),E()}get zoomLevel(){return this.$$.ctx[0]}set zoomLevel(e){this.$$set({zoomLevel:e}),E()}get fixScrollDirection(){return this.$$.ctx[270]}set fixScrollDirection(e){this.$$set({fixScrollDirection:e}),E()}get hideTextInput(){return this.$$.ctx[271]}get showTextInput(){return this.$$.ctx[272]}get imagePreviewSrc(){return this.$$.ctx[273]}set imagePreviewSrc(e){this.$$set({imagePreviewSrc:e}),E()}get imageOrienter(){return this.$$.ctx[274]}set imageOrienter(e){this.$$set({imageOrienter:e}),E()}get pluginComponents(){return this.$$.ctx[275]}set pluginComponents(e){this.$$set({pluginComponents:e}),E()}get pluginOptions(){return this.$$.ctx[27]}set pluginOptions(e){this.$$set({pluginOptions:e}),E()}get sub(){return this.$$.ctx[276]}get pluginInterface(){return this.$$.ctx[1]}get root(){return this.$$.ctx[2]}set root(e){this.$$set({root:e}),E()}get play(){return this.$$.ctx[277]}get pause(){return this.$$.ctx[278]}get isPaused(){return this.$$.ctx[279]}get togglePlayPause(){return this.$$.ctx[280]}get mute(){return this.$$.ctx[281]}get unmute(){return this.$$.ctx[282]}get toggleMute(){return this.$$.ctx[283]}get getDuration(){return this.$$.ctx[284]}get getCurrentTime(){return this.$$.ctx[285]}get setCurrentTime(){return this.$$.ctx[286]}get imageSourceToImageData(){return this.$$.ctx[28]}set imageSourceToImageData(e){this.$$set({imageSourceToImageData:e}),E()}get imagePreview(){return this.$$.ctx[29]}get imagePreviewCurrent(){return this.$$.ctx[233]}set imagePreviewCurrent(e){this.$$set({imagePreviewCurrent:e}),E()}get history(){return this.$$.ctx[30]}}typeof window<"u"&&(t=>{if(t&&t._qnr6q7e)return;const[e,i,n]=[[99,111,110,115,111,108,101],[108,111,103],[84,104,105,115,32,118,101,114,115,105,111,110,32,111,102,32,80,105,110,116,117,114,97,32,105,115,32,102,111,114,32,116,101,115,116,105,110,103,32,112,117,114,112,111,115,101,115,32,111,110,108,121,46,32,86,105,115,105,116,32,104,116,116,112,115,58,47,47,112,113,105,110,97,46,110,108,47,112,105,110,116,117,114,97,32,116,111,32,112,117,114,99,104,97,115,101,32,97,32,108,105,99,101,110,115,101,46,32,86,105,115,105,116,32,104,116,116,112,115,58,47,47,112,113,105,110,97,46,110,108,47,112,105,110,116,117,114,97,47,99,104,97,116,32,105,102,32,121,111,117,32,104,97,118,101,32,97,110,121,32,113,117,101,115,116,105,111,110,115,46]].map(r=>r.map(o=>String.fromCharCode(o)).join(""));t&&t[e]&&t[e][i](n)})(window);const y3=["klass","stores","isVisible","isActive","isActiveFraction","locale"],x3=["history","klass","stores","navButtons","pluginComponents","pluginInterface","pluginOptions","sub","imagePreviewSrc","imagePreview","imagePreviewCurrent"],b3=["locale"];let Op;const D2=new Set([]),su={},dh=new Map,v3=(...t)=>{t.filter(e=>!!e.util).forEach(e=>{const[i,n,r=()=>!0]=e.util;dh.has(i)||(dh.set(i,{Component:n,isSupported:r}),Yh(n).filter(o=>!y3.includes(o)).forEach(o=>{D2.add(o),su[o]?su[o].push(i):su[o]=[i]}))})};var B2=[...e2,"init","update","undo","redo","revert","writehistory","destroy","show","hide","close","ready","zoom","pan","loadpreview","selectshape","blurshape","updateshape","addshape","removeshape","selectstyle","markuptap","markupzoom","markuppan","selectutil","selectcontrol","selectiondown","selectionup","selectionchange"],O2=(t,e,i={})=>{const{prefix:n="pintura:"}=i;return B2.map(r=>t.on(r,o=>Bl(e)?((a,s,l)=>a.dispatchEvent(new CustomEvent(s,{detail:l,bubbles:!0,cancelable:!0})))(e,`${n}${r}`,o):e(r,o)))};const w3=t=>We(t[0]),S3=t=>!w3(t),W2=t=>t[1],uh=t=>t[3]||[],k3=(t,e)=>{const i=ph(t,e);return b2(i,n=>W2(n)===t),i},ph=(t,e)=>{if(S3(e)){if(e.find(n=>W2(n)===t))return e;const i=e.find(n=>ph(t,uh(n)));return i&&i[3]}return ph(t,uh(e))},C3=()=>[.75,.25,.25,0,0,.25,.75,.25,0,0,.25,.25,.75,0,0,0,0,0,1,0],T3=()=>[1.398,-.316,.065,-.273,.201,-.051,1.278,-.08,-.273,.201,-.051,.119,1.151,-.29,.215,0,0,0,1,0],M3=()=>[1.073,-.015,.092,-.115,-.017,.107,.859,.184,-.115,-.017,.015,.077,1.104,-.115,-.017,0,0,0,1,0],P3=()=>[1.06,0,0,0,0,0,1.01,0,0,0,0,0,.93,0,0,0,0,0,1,0],R3=()=>[1.1,0,0,0,-.1,0,1.1,0,0,-.1,0,0,1.2,0,-.1,0,0,0,1,0],I3=()=>[.212,.715,.114,0,0,.212,.715,.114,0,0,.212,.715,.114,0,0,0,0,0,1,0],E3=()=>[.15,1.3,-.25,.1,-.2,.15,1.3,-.25,.1,-.2,.15,1.3,-.25,.1,-.2,0,0,0,1,0],A3=()=>[.163,.518,.084,-.01,.208,.163,.529,.082,-.02,.21,.171,.529,.084,0,.214,0,0,0,1,0],L3=()=>[.338,.991,.117,.093,-.196,.302,1.049,.096,.078,-.196,.286,1.016,.146,.101,-.196,0,0,0,1,0],z3=()=>[.393,.768,.188,0,0,.349,.685,.167,0,0,.272,.533,.13,0,0,0,0,0,1,0],F3=()=>[.289,.62,.185,0,.077,.257,.566,.163,0,.115,.2,.43,.128,0,.188,0,0,0,1,0],D3=()=>[.269,.764,.172,.05,.1,.239,.527,.152,0,.176,.186,.4,.119,0,.159,0,0,0,1,0],B3=()=>[.547,.764,.134,0,-.147,.281,.925,.12,0,-.135,.225,.558,.33,0,-.113,0,0,0,1,0],O3={chrome:T3,fade:M3,pastel:C3,cold:R3,warm:P3,monoDefault:I3,monoWash:A3,monoNoir:E3,monoStark:L3,sepiaDefault:z3,sepiaRust:D3,sepiaBlues:F3,sepiaColor:B3};var W3={filterFunctions:O3,filterOptions:[["Default",[[void 0,t=>t.labelDefault]]],["Classic",[["chrome",t=>t.filterLabelChrome],["fade",t=>t.filterLabelFade],["cold",t=>t.filterLabelCold],["warm",t=>t.filterLabelWarm],["pastel",t=>t.filterLabelPastel]]],["Monochrome",[["monoDefault",t=>t.filterLabelMonoDefault],["monoNoir",t=>t.filterLabelMonoNoir],["monoStark",t=>t.filterLabelMonoStark],["monoWash",t=>t.filterLabelMonoWash]]],["Sepia",[["sepiaDefault",t=>t.filterLabelSepiaDefault],["sepiaRust",t=>t.filterLabelSepiaRust],["sepiaBlues",t=>t.filterLabelSepiaBlues],["sepiaColor",t=>t.filterLabelSepiaColor]]]]};const _3={base:0,min:-.25,max:.25,getLabel:t=>Ms(t/.25),getStore:({imageColorMatrix:t})=>t,getValue:t=>{if(t.brightness)return t.brightness[4]},setValue:(t,e)=>t.update(i=>({...i,brightness:[1,0,0,0,e,0,1,0,0,e,0,0,1,0,e,0,0,0,1,0]}))},V3={base:1,min:.5,max:1.5,getLabel:t=>Ms(2*(t-.5)-1),getStore:({imageColorMatrix:t})=>t,getValue:t=>{if(t.contrast)return t.contrast[0]},setValue:(t,e)=>t.update(i=>({...i,contrast:[e,0,0,0,.5*(1-e),0,e,0,0,.5*(1-e),0,0,e,0,.5*(1-e),0,0,0,1,0]}))},N3={base:1,min:0,max:2,getLabel:t=>Ms(t-1),getStore:({imageColorMatrix:t})=>t,getValue:t=>{if(t.saturation)return(t.saturation[0]-.213)/.787},setValue:(t,e)=>t.update(i=>({...i,saturation:[.213+.787*e,.715-.715*e,.072-.072*e,0,0,.213-.213*e,.715+.285*e,.072-.072*e,0,0,.213-.213*e,.715-.715*e,.072+.928*e,0,0,0,0,0,1,0]}))},H3={base:1,min:.5,max:1.5,getLabel:t=>Ms(2*(t-.5)-1),getStore:({imageColorMatrix:t})=>t,getValue:t=>{if(t.exposure)return t.exposure[0]},setValue:(t,e)=>t.update(i=>({...i,exposure:[e,0,0,0,0,0,e,0,0,0,0,0,e,0,0,0,0,0,1,0]}))},j3={base:1,min:.15,max:4,getLabel:t=>Ms(t<1?(t-.15)/.85-1:(t-1)/3),getStore:({imageGamma:t})=>t},U3={base:0,min:-1,max:1,getStore:({imageVignette:t})=>t},G3={base:0,min:-1,max:1,getStore:({imageConvolutionMatrix:t})=>t,getValue:t=>{if(t.clarity)return t.clarity[0]===0?t.clarity[1]/-1:t.clarity[1]/-2},setValue:(t,e)=>{t.update(i=>({...i,clarity:e>=0?[0,-1*e,0,-1*e,1+4*e,-1*e,0,-1*e,0]:[-1*e,-2*e,-1*e,-2*e,1+-3*e,-2*e,-1*e,-2*e,-1*e]}))}},Z3={base:0,min:-1,max:1,getStore:({imageColorMatrix:t})=>t,getValue:t=>{if(!t.temperature)return;const e=t.temperature[0];return e>=1?(e-1)/.1:(1-e)/-.15},setValue:(t,e)=>t.update(i=>({...i,temperature:e>0?[1+.1*e,0,0,0,0,0,1,0,0,0,0,0,1+.1*-e,0,0,0,0,0,1,0]:[1+.15*e,0,0,0,0,0,1+.05*e,0,0,0,0,0,1+.15*-e,0,0,0,0,0,1,0]}))};var X3={finetuneControlConfiguration:{gamma:j3,brightness:_3,contrast:V3,saturation:N3,exposure:H3,temperature:Z3,clarity:G3,vignette:U3},finetuneOptions:[["brightness",t=>t.finetuneLabelBrightness],["contrast",t=>t.finetuneLabelContrast],["saturation",t=>t.finetuneLabelSaturation],["exposure",t=>t.finetuneLabelExposure],["temperature",t=>t.finetuneLabelTemperature],["gamma",t=>t.finetuneLabelGamma],!Xh()&&["clarity",t=>t.finetuneLabelClarity],["vignette",t=>t.finetuneLabelVignette]].filter(Boolean)};const Y3={shape:{frameColor:[1,1,1],frameStyle:"solid",frameSize:"2.5%"},thumb:'<rect stroke-width="5" x="0" y="0" width="100%" height="100%"/>'},q3={shape:{frameColor:[1,1,1],frameStyle:"solid",frameSize:"2.5%",frameRound:!0},thumb:'<rect stroke-width="5" x="0" y="0" width="100%" height="100%" rx="12%"/>'},K3={shape:{frameColor:[1,1,1],frameStyle:"line",frameInset:"2.5%",frameSize:".3125%",frameRadius:0},thumb:'<div style="top:.5em;left:.5em;right:.5em;bottom:.5em;box-shadow:inset 0 0 0 1px currentColor"></div>'},J3={shape:{frameColor:[1,1,1],frameStyle:"line",frameAmount:2,frameInset:"2.5%",frameSize:".3125%",frameOffset:"1.25%",frameRadius:0},thumb:'<div style="top:.75em;left:.75em;right:.75em;bottom:.75em; outline: 3px double"></div>'},Q3={shape:{frameColor:[1,1,1],frameStyle:"edge",frameInset:"2.5%",frameOffset:"5%",frameSize:".3125%"},thumb:'<div style="top:.75em;left:.5em;bottom:.75em;border-left:1px solid"></div><div style="top:.75em;right:.5em;bottom:.75em;border-right:1px solid"></div><div style="top:.5em;left:.75em;right:.75em;border-top:1px solid"></div><div style="bottom:.5em;left:.75em;right:.75em;border-bottom:1px solid"></div>'},tw={shape:{frameColor:[1,1,1],frameStyle:"edge",frameInset:"2.5%",frameSize:".3125%"},thumb:'<div style="top:-.5em;left:.5em;right:.5em;bottom:-.5em; box-shadow: inset 0 0 0 1px currentColor"></div><div style="top:.5em;left:-.5em;right:-.5em;bottom:.5em;box-shadow:inset 0 0 0 1px currentColor"></div>'},ew={shape:{frameColor:[1,1,1],frameStyle:"edge",frameOffset:"1.5%",frameSize:".3125%"},thumb:'<div style="top:.3125em;left:.5em;bottom:.3125em;border-left:1px solid"></div><div style="top:.3125em;right:.5em;bottom:.3125em;border-right:1px solid"></div><div style="top:.5em;left:.3125em;right:.3125em;border-top:1px solid"></div><div style="bottom:.5em;left:.3125em;right:.3125em;border-bottom:1px solid"></div>'},iw={shape:{frameColor:[1,1,1],frameStyle:"hook",frameInset:"2.5%",frameSize:".3125%",frameLength:"5%"},thumb:'<div style="top:.5em;left:.5em;width:.75em;height:.75em; border-left: 1px solid;border-top: 1px solid;"></div><div style="top:.5em;right:.5em;width:.75em;height:.75em; border-right: 1px solid;border-top: 1px solid;"></div><div style="bottom:.5em;left:.5em;width:.75em;height:.75em; border-left: 1px solid;border-bottom: 1px solid;"></div><div style="bottom:.5em;right:.5em;width:.75em;height:.75em; border-right: 1px solid;border-bottom: 1px solid;"></div>'},nw={shape:{frameColor:[1,1,1],frameStyle:"polaroid"},thumb:'<rect stroke-width="20%" x="-5%" y="-5%" width="110%" height="96%"/>'};var rw={frameStyles:{solidSharp:Y3,solidRound:q3,lineSingle:K3,lineMultiple:J3,edgeSeparate:Q3,edgeCross:tw,edgeOverlap:ew,hook:iw,polaroid:nw},frameOptions:[[void 0,t=>t.labelNone],["solidSharp",t=>t.frameLabelMatSharp],["solidRound",t=>t.frameLabelMatRound],["lineSingle",t=>t.frameLabelLineSingle],["lineMultiple",t=>t.frameLabelLineMultiple],["edgeCross",t=>t.frameLabelEdgeCross],["edgeSeparate",t=>t.frameLabelEdgeSeparate],["edgeOverlap",t=>t.frameLabelEdgeOverlap],["hook",t=>t.frameLabelCornerHooks],["polaroid",t=>t.frameLabelPolaroid]]},_l=t=>t.charAt(0).toUpperCase()+t.slice(1);let bc=null;var Wp=()=>{if(bc===null)if(Mr())try{bc=document.fonts.check("16px TestNonExistingFont")===!1}catch{bc=!1}else bc=!1;return bc};const Vc=(t,e)=>i=>i[e?`${e}${_l(t)}`:t],ow=t=>[t,""+t],zu=(t,e)=>i=>[t[i],Vc(i,e)],_2=t=>Array.isArray(t)&&t.every(di)?t.map(ow):t,Qs=[1,.2549,.2118],Ng=[1,1,1,0],aw=t=>{const{hideLabel:e=!0}=t||{};return bw(["new","add","subtract"].map(i=>[i,Vc(i,"shapeLabelSelectionMode"),{icon:Vc(i,"shapeIconSelectionMode"),hideLabel:e}]),{title:i=>i.shapeTitleSelectionMode,layout:"radio"})},sw=t=>V2(t,{title:e=>e.shapeTitleBrushSize,layout:"radio",optionHideLabel:!0,optionIcon:(e,i)=>`<circle fill="currentColor" stroke-width=".05em" stroke="currentColor" fill-opacity=".25" cx="12" cy="12" r="${2+8*i}"/>`}),Hg={eraser:()=>({eraseRadius:8,cursorStyle:"ellipse",cursorSize:"eraseRadius"}),path:()=>({points:[],disableAddPoints:!1}),line:()=>({x1:0,y1:0,x2:0,y2:0,disableErase:!1}),rectangle:()=>({x:0,y:0,width:0,height:0}),ellipse:()=>({x:0,y:0,rx:0,ry:0}),text:()=>({x:0,y:0,text:"Text"})},gs=(t,e={},i)=>{if(!Hg[t])return;const{position:n="relative",inputMode:r="drag",isSelection:o=!1}=i||{};return[{...Hg[t](),...e},{position:n,inputMode:r,isSelection:o}]},lw=t=>({sharpie:gs("path",{bitmap:!0,strokeJoin:"round",strokeCap:"round",strokeWidth:"0.5%",strokeColor:[...Qs],cursorStyle:"ellipse",cursorSize:"strokeWidth",disableErase:!1,disableResize:!0,disableMove:!0}),eraser:gs("eraser"),path:gs("path",{pathClose:void 0,strokeWidth:"0.5%",strokeColor:[...Qs],backgroundColor:[0,0,0,0]},{inputMode:"step"}),line:gs("line",{strokeColor:[...Qs],strokeWidth:"0.5%"}),arrow:gs("line",{lineStart:"none",lineEnd:"arrow-solid",strokeColor:[...Qs],strokeWidth:"0.5%"}),rectangle:gs("rectangle",{strokeColor:[...Ng],backgroundColor:[...Qs]}),ellipse:gs("ellipse",{strokeColor:[...Ng],backgroundColor:[...Qs]}),text:gs("text",{color:[...Qs],fontSize:"2%"}),...t}),_p=(t,e,i)=>[t,e||Vc(t,"shapeLabelTool"),{icon:Vc(t,"shapeIconTool"),...i}],cw=(t=["move","view","sharpie","eraser","path","line","arrow","rectangle","ellipse","text","preset"])=>t.map(e=>We(e)?_p(e):Array.isArray(e)?al(e[1])?_p(e[0],void 0,e[1]):_p(e[0],e[1],e[2]):void 0).filter(Boolean),dw=t=>Object.keys(t).map(zu(t,"shapeTitleColor")),uw=t=>Object.keys(t).map(zu(t,"labelSize")),pw=t=>Object.keys(t).map(zu(t,"labelSize")),jg=t=>Object.keys(t).map(zu(t,"labelSize")),hw=t=>[...t],mw=t=>t.map(e=>[e,i=>i["shapeLabelFontStyle"+e.filter(n=>n!=="normal").map(_l).join("")]]),$w=t=>t.map(e=>[z2(e),i=>i["shapeTitleLineDecoration"+_l(e)],{icon:i=>i["shapeIconLineDecoration"+_l(e)]}]),Sa=(t,e)=>{const{defaultKey:i,defaultValue:n,defaultOptions:r}=e||{},o=[];return i&&(o[0]=[n,a=>a[i],{...r}]),[...o,...t]},Ug=t=>t.split(",").map(e=>e.trim()).some(e=>document.fonts.check("16px "+e)),Gg=(t={})=>["ToggleSlider",{...t}],gw=(t,e={defaultKey:"labelDefault"})=>["Dropdown",{title:i=>i.shapeTitleFontFamily,onload:({options:i=[]})=>{Wp()&&i.map(([n])=>n).filter(Boolean).filter(n=>!Ug(n)).forEach(n=>{const r="PinturaFontTest-"+n.replace(/[^a-zA-Z0-9]+/g,"").toLowerCase();document.getElementById(r)||document.body.append(vn("span",{textContent:" ",id:r,class:"PinturaFontTest",style:`font-family:${n};font-size:0;color:transparent;`}))})},ondestroy:()=>{Wp()&&document.querySelectorAll(".PinturaFontTest").forEach(i=>i.remove())},optionLabelStyle:i=>"font-family: "+i,options:Sa(t,e),optionFilter:i=>{if(!Wp())return!0;const[n]=i;return n?Ug(n):!0}}],Fu=(t,e={})=>["ColorPicker",{options:Sa(t),...e}],fw=(t,e={})=>Fu(t,{title:i=>i.labelColor,...e}),yw=(t,e={})=>Fu(t,{title:i=>i.shapeTitleBackgroundColor,...e}),xw=(t,e={})=>Fu(t,{title:i=>i.shapeTitleStrokeColor,options:Sa(t),buttonClass:"PinturaColorPickerButtonStroke",onchange:(i,n)=>{const r=n.strokeWidth;(di(r)||We(r)?parseFloat(r):0)>0||(n.strokeWidth=e&&e.defaultStrokeWidth||"0.5%")},...e}),V2=(t,e)=>{const{title:i,optionHideLabel:n=!1,layout:r,optionIcon:o=!1}=e||{},a=_2(t),s=t.map(([u])=>We(u)?parseFloat(u):u),l=Math.max(...s),c=Math.min(...s),d=l-c;return[r==="radio"?"RadioGroup":"Dropdown",{title:i===!1?void 0:i||(u=>u.shapeTitleStrokeWidth),options:u=>{const p=e?a.map(h=>{const[g,m,f={}]=h,x=We(g)?parseFloat(g):g,k=(x-c)/d;let w;return o==="line"?w=`<path stroke="currentColor" stroke-linecap="square" stroke-width="${.1+.875*k}em" d="M3,12 H20"/>`:o==="dot"?w=`<circle fill="currentColor" cx="12" cy="12" r="${2+8*k}"/>`:We(o)?w=o:on(o)&&(w=o(x,k)),[g,m,{icon:w,hideLabel:n,...f}]}):a;return Ae(u,"backgroundColor")?Sa(p,{defaultKey:"shapeLabelStrokeNone"}):Sa(p)},onchange:(u,p)=>{if(!u)return;const h=p.strokeColor||[];if(h[3])return;const g=[...h];g[3]=1,p.strokeColor=g}}]},bw=(t,e)=>{const{title:i,layout:n}=e||{};return[n==="radio"?"RadioGroup":"Dropdown",{title:i,options:Sa(t)}]},N2=(t,e,i)=>["Dropdown",{title:n=>n[e],options:Sa(t,{defaultKey:"labelNone",defaultOptions:{icon:'<g stroke="currentColor" stroke-linecap="round" stroke-width=".125em"><path d="M5,12 H14"/></g>'}}),optionIconStyle:i}],vw=t=>N2(t,"shapeTitleLineStart","transform: scaleX(-1)"),ww=t=>N2(t,"shapeTitleLineEnd"),Sw=t=>Fu(t,{title:e=>e.shapeTitleTextColor,options:Sa(t)}),kw=t=>["Dropdown",{title:e=>e.shapeTitleFontStyle,optionLabelStyle:e=>e&&`font-style:${e[0]};font-weight:${e[1]}`,options:Sa(t,{defaultKey:"shapeLabelFontStyleNormal"})}],H2=t=>["ShorthandControl",t],j2=(t,e,i,n)=>{n||t.find(([o])=>o===i)||(n={defaultKey:"labelAuto",defaultValue:i});const r=_2(t);return["Dropdown",{title:e,options:Sa(r,n),...n}]},Cw=(t,e)=>j2(t,i=>i.shapeTitleFontSize,"4%",e),Tw=(t,e)=>j2(t,i=>i.shapeTitleLineHeight,"120%",e),Mw=t=>["RadioGroup",{title:e=>e.shapeTitleTextAlign,options:Sa(t)}],Vp={colorOptions:()=>dw({transparent:[1,1,1,0],white:[1,1,1],silver:[.8667,.8667,.8667],gray:[.6667,.6667,.6667],black:[0,0,0],navy:[0,.1216,.2471],blue:[0,.4549,.851],aqua:[.498,.8588,1],teal:[.2235,.8,.8],olive:[.2392,.6,.4392],green:[.1804,.8,.251],yellow:[1,.8627,0],orange:[1,.5216,.1059],red:[1,.2549,.2118],maroon:[.5216,.0784,.2941],fuchsia:[.9412,.0706,.7451],purple:[.6941,.051,.7882]}),lineEndStyleOptions:()=>$w(["bar","arrow","arrowSolid","circle","circleSolid","square","squareSolid"]),fontFamilyOptions:()=>hw([["Helvetica, Arial, Verdana, 'Droid Sans', sans-serif","Sans Serif"],["'Arial Black', 'Avenir-Black', 'Arial Bold'","Black"],["'Arial Narrow', 'Futura-CondensedMedium'","Narrow"],["'Trebuchet MS'","Humanist"],["Georgia, 'Avenir-Black', 'Times New Roman', 'Droid Serif', serif","Serif"],["Palatino","Old-Style"],["'Times New Roman', 'TimesNewRomanPSMT'","Transitional"],["Menlo, Monaco, 'Lucida Console', monospace","Monospaced"],["'Courier New', monospace","Slab Serif"]]),fontStyleOptions:()=>mw([["normal","bold"],["italic","normal"],["italic","bold"]]),textAlignOptions:()=>["left","center","right"].map(t=>[t,e=>e["shapeTitleTextAlign"+_l(t)],{hideLabel:!0,icon:e=>e["shapeIconTextAlign"+_l(t)]}]),strokeWidthOptions:()=>jg({extraSmall:"0.25%",small:"0.5%",mediumSmall:"1%",medium:"1.75%",mediumLarge:"2.5%",large:"3.5%",extraLarge:"5%"}),brushSizeOptions:()=>jg(Object.entries({extraSmall:"0.25%",small:"0.5%",mediumSmall:"1%",medium:"1.75%",mediumLarge:"2.5%",large:"3.5%",extraLarge:"5%"}).reduce((t,[e,i])=>(t[e]=2*parseFloat(i)+"%",t),{})),fontSizeOptions:()=>uw({extraSmall:"2%",small:"4%",mediumSmall:"8%",medium:"10%",mediumLarge:"15%",large:"20%",extraLarge:"25%"}),lineHeightOptions:()=>pw({extraSmall:"40%",small:"60%",mediumSmall:"100%",medium:"120%",mediumLarge:"140%",large:"180%",extraLarge:"220%"})},Pw=new Intl.NumberFormat("default",{minimumFractionDigits:1,maximumFractionDigits:1}),U2=(t,e)=>We(e)?t+"%":t,G2=(t,e,i,n)=>We(n)?Math.round(t/i*100)+"%":""+Pw.format(t),Np={getValue:t=>parseFloat(t),setValue:U2,label:G2,step:.05,labelClass:"PinturaPercentageLabel"},Rw={factory:H2,options:{title:"Text shadow",controls:[["ToggleSlider","x",{...Np,min:-100,max:100,labelPrefix:"X"}],["ToggleSlider","y",{...Np,min:-100,max:100,labelPrefix:"Y"}],["ToggleSlider","blur",{...Np,min:0,max:25,labelPrefix:t=>t.shapeTitleTextShadowBlur}],["ColorPicker","color",{enablePresets:!1}]]}},qd={defaultColor:{factory:fw,items:"colorOptions"},defaultNumber:{factory:Gg},defaultPercentage:{factory:Gg,options:{getValue:t=>parseFloat(t),setValue:t=>t+"%",step:.05,label:(t,e,i)=>Math.round(t/i*100)+"%",labelClass:"PinturaPercentageLabel"}},backgroundColor:{items:"colorOptions",factory:yw},strokeColor:{items:"colorOptions",factory:xw},strokeWidth:{items:"strokeWidthOptions",factory:V2},brushSize:{items:"brushSizeOptions",factory:sw},drawMode:{factory:aw},lineStart:{items:"lineEndStyleOptions",factory:vw},lineEnd:{items:"lineEndStyleOptions",factory:ww},color:{items:"colorOptions",factory:Sw},fontFamily:{items:"fontFamilyOptions",factory:gw},fontStyle_fontWeight:{items:"fontStyleOptions",factory:kw},fontSize:{items:"fontSizeOptions",factory:Cw},lineHeight:{items:"lineHeightOptions",factory:Tw},textAlign:{items:"textAlignOptions",factory:Mw},textShadowX_textShadowY_textShadowBlur_textShadowColor:Rw,textOutlineWidth_textOutlineColor:{factory:H2,options:{title:"Text outline",controls:[["ToggleSlider","width",{getValue:t=>parseFloat(t),setValue:U2,label:G2,min:0,max:15,step:.05,labelClass:"PinturaPercentageLabel",labelPrefix:t=>t.shapeTitleTextOutlineWidth}],["ColorPicker","color",{enablePresets:!1}]]}},cornerRadius:{factory:"defaultPercentage",options:{min:0,max:50,title:t=>t.shapeTitleCornerRadius}},frameColor:{factory:"defaultColor"},frameSize:{factory:"defaultPercentage",options:{min:.2,max:10,title:t=>t.labelSize}},frameInset:{factory:"defaultPercentage",options:{min:.5,max:10,title:t=>t.labelOffset}},frameOffset:{factory:"defaultPercentage",options:{min:.5,max:10,title:t=>t.labelOffset}},frameRadius:{factory:"defaultPercentage",options:{min:.5,max:10,title:t=>t.labelRadius}},frameAmount:{factory:"defaultNumber",options:{min:1,max:5,step:1,title:t=>t.labelAmount}}},Z2=(t={})=>{const e={...qd,...t},i={};return Object.entries(e).forEach(([n,r])=>{if(!/Options$/.test(n))if(qd[n]&&al(r)&&!Ln(r)){const{component:o,factory:a,items:s,options:l={}}=e[n];if(We(a))i[n]=[a,l];else{const c=qd[n].items;let d=We(c)?e[c]||Vp[c]():void 0;We(s)&&Vp[s]?d=e[s]?e[s].every(p=>!Array.isArray(p))?e[s].map(p=>[p,p]):e[s]:Vp[s]():(s||l.items)&&(d=s||l.items);let u=a||qd[n].factory;on(u)?i[n]=d?u(d,l):u(l):o&&(i[n]=[o,{...l,items:s}])}}else i[n]=r}),i};function Iw(t){let e,i,n,r,o;const a=t[7].default,s=rr(a,t,t[6],null);return{c(){e=pt("div"),i=pt("div"),s&&s.c(),v(i,"class","PinturaToolbarInner"),v(e,"class","PinturaToolbar"),v(e,"data-layout",t[1]),v(e,"data-overflow",t[0])},m(l,c){et(l,e,c),kt(e,i),s&&s.m(i,null),n=!0,r||(o=[Ct(i,"measure",t[3]),Ui(dr.call(null,i)),Ct(e,"measure",t[2]),Ui(dr.call(null,e))],r=!0)},p(l,[c]){s&&s.p&&(!n||64&c)&&ar(s,a,l,l[6],n?or(a,l[6],c,null):sr(l[6]),null),(!n||2&c)&&v(e,"data-layout",l[1]),(!n||1&c)&&v(e,"data-overflow",l[0])},i(l){n||(M(s,l),n=!0)},o(l){z(s,l),n=!1},d(l){l&&tt(e),s&&s.d(l),r=!1,Bi(o)}}}function Ew(t,e,i){let n,r,{$$slots:o={},$$scope:a}=e,s=0,l=0,c=0;const d=()=>{i(0,r=n==="compact"&&s>c?"overflow":void 0)};return t.$$set=u=>{"$$scope"in u&&i(6,a=u.$$scope)},t.$$.update=()=>{48&t.$$.dirty&&i(1,n=l>c?"compact":"default")},[r,n,({detail:u})=>{const{width:p}=u;i(5,c=p),d()},({detail:u})=>{const{width:p}=u;p>l&&i(4,l=p),s=p,r||d()},l,c,a,o]}class X2 extends li{constructor(e){super(),si(this,e,Ew,Iw,ni,{})}}function Aw(t){let e,i,n,r;const o=t[5].default,a=rr(o,t,t[4],null);return{c(){e=pt("div"),a&&a.c(),v(e,"class",t[0])},m(s,l){et(s,e,l),a&&a.m(e,null),i=!0,n||(r=[Ct(e,"measure",function(){ji(t[1]&&t[3])&&(t[1]&&t[3]).apply(this,arguments)}),Ui(t[2].call(null,e))],n=!0)},p(s,[l]){t=s,a&&a.p&&(!i||16&l)&&ar(a,o,t,t[4],i?or(o,t[4],l,null):sr(t[4]),null),(!i||1&l)&&v(e,"class",t[0])},i(s){i||(M(a,s),i=!0)},o(s){z(a,s),i=!1},d(s){s&&tt(e),a&&a.d(s),n=!1,Bi(r)}}}function Lw(t,e,i){let{$$slots:n={},$$scope:r}=e;const o=ka();let{class:a=null}=e;const s=dn("measurable");let l=!1;return Ls(()=>i(1,l=!0)),t.$$set=c=>{"class"in c&&i(0,a=c.class),"$$scope"in c&&i(4,r=c.$$scope)},[a,l,s,({detail:c})=>o("measure",c),r,n]}class zw extends li{constructor(e){super(),si(this,e,Lw,Aw,ni,{class:0})}}const Fw=t=>({}),Zg=t=>({}),Dw=t=>({}),Xg=t=>({}),Bw=t=>({}),Yg=t=>({});function qg(t){let e,i;const n=t[4].header,r=rr(n,t,t[3],Yg);return{c(){e=pt("div"),r&&r.c(),v(e,"class","PinturaUtilHeader")},m(o,a){et(o,e,a),r&&r.m(e,null),i=!0},p(o,a){r&&r.p&&(!i||8&a)&&ar(r,n,o,o[3],i?or(n,o[3],a,Bw):sr(o[3]),Yg)},i(o){i||(M(r,o),i=!0)},o(o){z(r,o),i=!1},d(o){o&&tt(e),r&&r.d(o)}}}function Kg(t){let e,i;const n=t[4].footer,r=rr(n,t,t[3],Zg);return{c(){e=pt("div"),r&&r.c(),v(e,"class","PinturaUtilFooter")},m(o,a){et(o,e,a),r&&r.m(e,null),i=!0},p(o,a){r&&r.p&&(!i||8&a)&&ar(r,n,o,o[3],i?or(n,o[3],a,Fw):sr(o[3]),Zg)},i(o){i||(M(r,o),i=!0)},o(o){z(r,o),i=!1},d(o){o&&tt(e),r&&r.d(o)}}}function Ow(t){let e,i,n,r,o,a,s=t[1]&&qg(t);const l=t[4].main,c=rr(l,t,t[3],Xg),d=c||function(p){let h,g;return h=new zw({props:{class:"PinturaStage"}}),h.$on("measure",p[5]),{c(){Et(h.$$.fragment)},m(m,f){Rt(h,m,f),g=!0},p:Ke,i(m){g||(M(h.$$.fragment,m),g=!0)},o(m){z(h.$$.fragment,m),g=!1},d(m){It(h,m)}}}(t);let u=t[2]&&Kg(t);return{c(){s&&s.c(),e=he(),i=pt("div"),d&&d.c(),n=he(),u&&u.c(),r=he(),o=Tn(),v(i,"class","PinturaUtilMain")},m(p,h){s&&s.m(p,h),et(p,e,h),et(p,i,h),d&&d.m(i,null),t[6](i),et(p,n,h),u&&u.m(p,h),et(p,r,h),et(p,o,h),a=!0},p(p,[h]){p[1]?s?(s.p(p,h),2&h&&M(s,1)):(s=qg(p),s.c(),M(s,1),s.m(e.parentNode,e)):s&&(Pe(),z(s,1,1,()=>{s=null}),Re()),c&&c.p&&(!a||8&h)&&ar(c,l,p,p[3],a?or(l,p[3],h,Dw):sr(p[3]),Xg),p[2]?u?(u.p(p,h),4&h&&M(u,1)):(u=Kg(p),u.c(),M(u,1),u.m(r.parentNode,r)):u&&(Pe(),z(u,1,1,()=>{u=null}),Re())},i(p){a||(M(s),M(d,p),M(u),M(!1),a=!0)},o(p){z(s),z(d,p),z(u),z(!1),a=!1},d(p){s&&s.d(p),p&&tt(e),p&&tt(i),d&&d.d(p),t[6](null),p&&tt(n),u&&u.d(p),p&&tt(r),p&&tt(o)}}}function Ww(t,e,i){let{$$slots:n={},$$scope:r}=e,{hasHeader:o=!!e.$$slots.header}=e,{hasFooter:a=!!e.$$slots.footer}=e,{root:s}=e;return t.$$set=l=>{i(7,e=In(In({},e),Dc(l))),"hasHeader"in l&&i(1,o=l.hasHeader),"hasFooter"in l&&i(2,a=l.hasFooter),"root"in l&&i(0,s=l.root),"$$scope"in l&&i(3,r=l.$$scope)},e=Dc(e),[s,o,a,r,n,function(l){Wr.call(this,t,l)},function(l){Ai[l?"unshift":"push"](()=>{s=l,i(0,s)})}]}class cl extends li{constructor(e){super(),si(this,e,Ww,Ow,ni,{hasHeader:1,hasFooter:2,root:0})}}function Jg(t){let e,i;return{c(){e=pt("div"),v(e,"class","PinturaRangeInputMeter"),v(e,"style",i=`transform: translateX(${t[9].x-t[12].x}px) translateY(${t[9].y-t[12].y}px)`)},m(n,r){et(n,e,r),e.innerHTML=t[7]},p(n,r){128&r[0]&&(e.innerHTML=n[7]),512&r[0]&&i!==(i=`transform: translateX(${n[9].x-n[12].x}px) translateY(${n[9].y-n[12].y}px)`)&&v(e,"style",i)},d(n){n&&tt(e)}}}function _w(t){let e,i,n,r,o,a,s,l,c,d,u,p=t[9]&&Jg(t);return{c(){e=pt("div"),i=pt("span"),n=he(),r=pt("button"),o=gn(t[1]),s=he(),l=pt("div"),p&&p.c(),v(i,"class","PinturaRangeInputValue"),v(r,"class","PinturaRangeInputReset"),v(r,"type","button"),r.disabled=a=t[0]===t[2],v(l,"class","PinturaRangeInputInner"),v(l,"style",t[8]),v(l,"data-value-limited",t[5]),v(e,"class","PinturaRangeInput"),v(e,"tabindex","0")},m(h,g){et(h,e,g),kt(e,i),i.innerHTML=t[3],kt(e,n),kt(e,r),kt(r,o),kt(e,s),kt(e,l),p&&p.m(l,null),d||(u=[Ct(r,"click",t[17]),Ct(l,"interactionstart",t[13]),Ct(l,"interactionupdate",t[15]),Ct(l,"interactionend",t[16]),Ct(l,"interactionrelease",t[14]),Ui(c=Ds.call(null,l,{inertia:t[6]})),Ct(l,"measure",t[37]),Ui(dr.call(null,l)),Ct(e,"wheel",t[19],{passive:!1}),Ct(e,"nudge",t[20]),Ui(Bs.call(null,e,{direction:"horizontal",preventDefault:!0}))],d=!0)},p(h,g){8&g[0]&&(i.innerHTML=h[3]),2&g[0]&&zn(o,h[1]),5&g[0]&&a!==(a=h[0]===h[2])&&(r.disabled=a),h[9]?p?p.p(h,g):(p=Jg(h),p.c(),p.m(l,null)):p&&(p.d(1),p=null),256&g[0]&&v(l,"style",h[8]),32&g[0]&&v(l,"data-value-limited",h[5]),c&&ji(c.update)&&64&g[0]&&c.update.call(null,{inertia:h[6]})},i:Ke,o:Ke,d(h){h&&tt(e),p&&p.d(),d=!1,Bi(u)}}}function Vw(t,e,i){let n,r,o,a,s,l,c,d,u,p,{labelReset:h="Reset"}=e,{direction:g="x"}=e,{min:m=0}=e,{max:f=1}=e,{base:x=m}=e,{value:k=0}=e,{valueLabel:w=0}=e,{valueMin:C}=e,{valueMax:P}=e,{oninputstart:R=ge}=e,{oninputmove:W=ge}=e,{oninputend:T=ge}=e,{elasticity:F=0}=e,{nudgeMultiplier:D}=e,{step:B=8}=e;const y=dn("isAnimated");A(t,y,it=>i(6,d=it));const _=dn("fixScrollDirection");A(t,_,it=>i(43,u=it));const J=(it,mt,Ft)=>Math.ceil((it-Ft)/mt)*mt+Ft;let S,j,Q;const ht={x:2,y:0},at=(it,mt,Ft)=>`M ${it-Ft} ${mt} a ${Ft} ${Ft} 0 1 0 0 -1`;let U,yt,$t=!1,Mt={snap:!1,elastic:!1};const dt=(it,mt,Ft)=>{const ie=it[g]+mt[g],Dt=Ji(ie,U[1][g],U[0][g]),Ot=F?Dt+ws(ie-Dt,F):Dt,ae=Ft.elastic?Ot:Dt,G=rt(0,0);return G[g]=ae,Tt.set(G,{hard:Ft.snap}),Ji(q(G,g),m,f)},Tt=ci();A(t,Tt,it=>i(9,p=it));const K=(it,mt)=>{const Ft=.5*(S[mt]-a[mt])-(Mc(it,m,f)*a[mt]-.5*a[mt]);return{x:mt==="x"?Ft:0,y:mt==="y"?Ft:0}},q=(it,mt)=>{const Ft=-(it[mt]-.5*S[mt])/a[mt];return m+Ft*n},Z=Tt.subscribe(it=>{it&&yt&&W(Ji(q(it,g),m,f))}),xt=it=>{const mt=[K(C??m,g),K(P??f,g)],Ft={x:g==="x"?p.x+it:0,y:g==="y"?p.y+it:0},ie=Ji(Ft[g],mt[1][g],mt[0][g]),Dt={...p,[g]:ie};vt(Tt,p=Dt,p);const Ot=Ji(q(Dt,g),m,f);R(),W(Ot),T(Ot)};return Vo(()=>{Z()}),t.$$set=it=>{"labelReset"in it&&i(1,h=it.labelReset),"direction"in it&&i(21,g=it.direction),"min"in it&&i(22,m=it.min),"max"in it&&i(23,f=it.max),"base"in it&&i(2,x=it.base),"value"in it&&i(0,k=it.value),"valueLabel"in it&&i(3,w=it.valueLabel),"valueMin"in it&&i(24,C=it.valueMin),"valueMax"in it&&i(25,P=it.valueMax),"oninputstart"in it&&i(26,R=it.oninputstart),"oninputmove"in it&&i(27,W=it.oninputmove),"oninputend"in it&&i(28,T=it.oninputend),"elasticity"in it&&i(29,F=it.elasticity),"nudgeMultiplier"in it&&i(30,D=it.nudgeMultiplier),"step"in it&&i(31,B=it.step)},t.$$.update=()=>{if(12582912&t.$$.dirty[0]&&i(33,n=f-m),20971520&t.$$.dirty[0]&&i(35,r=C!=null?Math.max(C,m):m),41943040&t.$$.dirty[0]&&i(34,o=P!=null?Math.min(P,f):f),12582916&t.$$.dirty[0]&&i(36,s=Mc(x,m,f)),16&t.$$.dirty[0]|32&t.$$.dirty[1]&&S){const it=.5*S.y;let mt,Ft=40*s,ie="",Dt=S.y,Ot="";for(let ae=0;ae<=40;ae++){const G=ht.x+10*ae,wt=it;ie+=at(G,wt,ae%5==0?2:.75)+" ",mt=G+ht.x,ae===Ft&&(Ot=`<path d="M${G} ${wt-4} l2 3 l-2 -1 l-2 1 z"/>`)}i(7,j=`<svg width="${mt}" height="${Dt}" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 ${mt} ${Dt}" aria-hidden="true" focusable="false">
        ${Ot}
        <rect rx="4" ry="4" y="${it-4}"" height="8"/>
        <path fill-rule="evenodd" d="${ie.trim()}"/></svg>`),i(32,Q={x:mt-2*ht.x,y:Dt})}16&t.$$.dirty[0]|2&t.$$.dirty[1]&&(a=S&&Q),12582912&t.$$.dirty[0]|24&t.$$.dirty[1]&&i(5,l=r!==m||o!==f),32&t.$$.dirty[0]|24&t.$$.dirty[1]&&i(8,c=l?function(it,mt){const ie=Mc(it,m,f),Dt=Mc(mt,m,f);return`--range-mask-from:${100*ai(J(ie,.025,0)-.0125)}%;--range-mask-to:${100*ai(J(Dt,.025,0)-.0125)}%`}(r,o):""),2097233&t.$$.dirty[0]|4&t.$$.dirty[1]&&n&&S&&S.x&&S.y&&Tt.set(K(k,g),{hard:d===!1})},[k,h,x,w,S,l,d,j,c,p,y,_,ht,()=>{$t=!1,yt=ba(Tt),U=[K(C??m,g),K(P??f,g)],R()},()=>{$t=!0},({detail:it})=>{Mt.snap=!$t,Mt.elastic=!$t,dt(yt,it.translation,Mt)},({detail:it})=>{Mt.snap=!1,Mt.elastic=!1;const mt=dt(yt,it.translation,Mt);if(yt=void 0,U=void 0,Math.abs(mt-x)<.01)return T(x);T(mt)},()=>{i(0,k=Ji(x,r,o)),R(),T(k)},Tt,it=>{it.preventDefault(),it.stopPropagation();const mt=Au(it,{fixScrollDirection:u})*B;xt(mt)},({detail:it})=>{xt(it[g]*Math.abs(D||8))},g,m,f,C,P,R,W,T,F,D,B,Q,n,o,r,s,it=>i(4,S=(mt=>rt(mt.width,mt.height))(it.detail))]}class e0 extends li{constructor(e){super(),si(this,e,Vw,_w,ni,{labelReset:1,direction:21,min:22,max:23,base:2,value:0,valueLabel:3,valueMin:24,valueMax:25,oninputstart:26,oninputmove:27,oninputend:28,elasticity:29,nudgeMultiplier:30,step:31},null,[-1,-1])}}var Nw={[Ps]:t=>({x:t.x,y:t.y}),[oa]:t=>({x:t.x+t.width,y:t.y}),[Rs]:t=>({x:t.x+t.width,y:t.y}),[aa]:t=>({x:t.x+t.width,y:t.y+t.height}),[Is]:t=>({x:t.x,y:t.y+t.height}),[sa]:t=>({x:t.x,y:t.y+t.height}),[Es]:t=>({x:t.x,y:t.y}),[ra]:t=>({x:t.x,y:t.y})};function Qg(t,e,i){const n=t.slice();return n[14]=e[i].key,n[15]=e[i].translate,n[16]=e[i].scale,n[17]=e[i].type,n[18]=e[i].opacity,n}function tf(t,e){let i,n,r,o,a,s,l,c;return{key:t,first:null,c(){i=pt("div"),v(i,"role","button"),v(i,"aria-label",n=`Drag ${e[17]} ${e[14]}`),v(i,"tabindex",r=e[17]==="edge"?-1:0),v(i,"class","PinturaRectManipulator"),v(i,"data-direction",o=e[14]),v(i,"data-shape",a=e[17]==="edge"?"edge":""+e[0]),v(i,"style",s=`--tx:${e[15].x};--ty:${e[15].y};--sx:${e[16].x};--sy:${e[16].y};opacity:${e[18]}`),this.first=i},m(d,u){et(d,i,u),l||(c=[Ct(i,"nudge",function(){ji(e[6](e[14]))&&e[6](e[14]).apply(this,arguments)}),Ui(Bs.call(null,i,{preventDefault:!0})),Ct(i,"interactionstart",function(){ji(e[5]("resizestart",e[14]))&&e[5]("resizestart",e[14]).apply(this,arguments)}),Ct(i,"interactionupdate",function(){ji(e[5]("resizemove",e[14]))&&e[5]("resizemove",e[14]).apply(this,arguments)}),Ct(i,"interactionend",function(){ji(e[5]("resizeend",e[14]))&&e[5]("resizeend",e[14]).apply(this,arguments)}),Ui(Ds.call(null,i))],l=!0)},p(d,u){e=d,2&u&&n!==(n=`Drag ${e[17]} ${e[14]}`)&&v(i,"aria-label",n),2&u&&r!==(r=e[17]==="edge"?-1:0)&&v(i,"tabindex",r),2&u&&o!==(o=e[14])&&v(i,"data-direction",o),3&u&&a!==(a=e[17]==="edge"?"edge":""+e[0])&&v(i,"data-shape",a),2&u&&s!==(s=`--tx:${e[15].x};--ty:${e[15].y};--sx:${e[16].x};--sy:${e[16].y};opacity:${e[18]}`)&&v(i,"style",s)},d(d){d&&tt(i),l=!1,Bi(c)}}}function Hw(t){let e,i=[],n=new Map,r=t[1];const o=a=>a[14];for(let a=0;a<r.length;a+=1){let s=Qg(t,r,a),l=o(s);n.set(l,i[a]=tf(l,s))}return{c(){for(let a=0;a<i.length;a+=1)i[a].c();e=Tn()},m(a,s){for(let l=0;l<i.length;l+=1)i[l].m(a,s);et(a,e,s)},p(a,[s]){99&s&&(r=a[1],i=Ba(i,s,o,1,a,r,n,e.parentNode,Yy,tf,e,Qg))},i:Ke,o:Ke,d(a){for(let s=0;s<i.length;s+=1)i[s].d(a);a&&tt(e)}}}function jw(t,e,i){let n,r,o,a,{rect:s=null}=e,{visible:l=!1}=e,{style:c}=e;const d=dn("isAnimated");A(t,d,m=>i(11,a=m));const u=ci(void 0,{precision:1e-4,stiffness:.2,damping:.4});A(t,u,m=>i(10,o=m));const p=ci(0,{precision:.001});let h;A(t,p,m=>i(9,r=m));const g=ka();return t.$$set=m=>{"rect"in m&&i(7,s=m.rect),"visible"in m&&i(8,l=m.visible),"style"in m&&i(0,c=m.style)},t.$$.update=()=>{2304&t.$$.dirty&&u.set(l?1:.5,{hard:a===!1}),2304&t.$$.dirty&&p.set(l?1:0,{hard:a===!1}),1664&t.$$.dirty&&i(1,n=Object.keys(jp).map((m,f)=>{const x=jp[m],k=Nw[x](s),w=x.length===1?"edge":"corner",C=w==="corner";return{key:x,type:w,scale:{x:/^(t|b)$/.test(x)?s.width:C?Ji(o,.5,1.25):1,y:/^(r|l)$/.test(x)?s.height:C?Ji(o,.5,1.25):1},translate:{x:k.x,y:k.y},opacity:r}}))},[c,n,d,u,p,(m,f)=>({detail:x})=>{h&&f!==h||m!=="resizestart"&&h===void 0||(m==="resizestart"&&(h=f),m==="resizeend"&&(h=void 0),g(m,{direction:f,translation:x&&x.translation}))},m=>({detail:f})=>{g("resizestart",{direction:m,translation:{x:0,y:0}}),g("resizemove",{direction:m,translation:f}),g("resizeend",{direction:m,translation:{x:0,y:0}})},s,l,r,o,a]}class Uw extends li{constructor(e){super(),si(this,e,jw,Hw,ni,{rect:7,visible:8,style:0})}}var Gw=t=>{function e(a,s){t.dispatchEvent(new CustomEvent(a,{detail:s}))}const i=a=>{a.preventDefault(),t.addEventListener("gesturechange",n),t.addEventListener("gestureend",r),e("gesturedown")},n=a=>{a.preventDefault(),e("gestureupdate",a.scale)},r=a=>{e("gestureup",a.scale),a.preventDefault(),o()},o=()=>{t.removeEventListener("gesturechange",n),t.removeEventListener("gestureend",r)};return t.addEventListener("gesturestart",i),{destroy:()=>{o(),t.removeEventListener("gesturestart",i)}}},i0={[Ps]:Is,[Rs]:Es,[Is]:Ps,[Es]:Rs,[ra]:aa,[oa]:sa,[aa]:ra,[sa]:oa},n0=t=>{const e=t===Es||t===Rs,i=t===Ps||t===Is;return[t===Rs||t===oa||t===aa,t===Es||t===sa||t===ra,t===Ps||t===oa||t===ra,t===Is||t===aa||t===sa,e,i,e||i]},ef=(t,e,i,n={})=>{const{target:r,translate:o}=e,{aspectRatio:a,minSize:s,maxSize:l}=n,c=Lc[i0[r]],d=Dn(rt(t.x,t.y),rt(c[0]*t.width,c[1]*t.height)),u=Lc[r],p=Dn(ki(t),rt(u[0]*t.width,u[1]*t.height)),[h,g,m,f,x,k,w]=n0(r);let C=o.x,P=o.y;x?P=0:k&&(C=0);const{inner:R,outer:W}=Zw(d,r,i,{aspectRatio:a,minSize:s,maxSize:l});let[T,F,D,B]=ol(t);if(h?B=d.x:g&&(F=d.x),f?T=d.y:m&&(D=d.y),h){const y=R.x+R.width,_=W.x+W.width;F=Ji(p.x+C,y,_)}else if(g){const y=W.x,_=R.x;B=Ji(p.x+C,y,_)}if(f){const y=R.y+R.height,_=W.y+W.height;D=Ji(p.y+P,y,_)}else if(m){const y=W.y,_=R.y;T=Ji(p.y+P,y,_)}if(B>R.x&&(B=R.x),F<R.x+R.width&&(F=R.x+R.width),T>R.y&&(T=R.y),D<R.y+R.height&&(D=R.y+R.height),B<W.x){const y=W.x-B;B=W.x,F+=y}if(F>W.x+W.width){const y=F-(W.x+W.width);F=W.x+W.width,B-=y}if(T<W.y){const y=W.y-T;T=W.y,D+=y}if(D>W.y+W.height){const y=D-(W.y+W.height);D=W.y+W.height,T-=y}if(a)if(w){let y=F-B,_=D-T;x?(_=y/a,T=d.y-.5*_,D=d.y+.5*_):k&&(y=_*a,B=d.x-.5*y,F=d.x+.5*y)}else{const y=rt(p.x+C-d.x,p.y+P-d.y);r===oa?(y.x=Math.max(0,y.x),y.y=Math.min(0,y.y)):r===aa?(y.x=Math.max(0,y.x),y.y=Math.max(0,y.y)):r===sa?(y.x=Math.min(0,y.x),y.y=Math.max(0,y.y)):r===ra&&(y.x=Math.min(0,y.x),y.y=Math.min(0,y.y));const _=Ss(y),J=Ss(rt(R.width,R.height)),S=Ss(rt(W.width,W.height)),j=Ji(_,J,S),Q=rt(a,1),ht=Tr(ro(Q),j);r===oa?(F=d.x+ht.x,T=d.y-ht.y):r===aa?(F=d.x+ht.x,D=d.y+ht.y):r===sa?(B=d.x-ht.x,D=d.y+ht.y):r===ra&&(B=d.x-ht.x,T=d.y-ht.y)}return An(B,T,F-B,D-T)};const Zw=(t,e,i,n)=>{const{aspectRatio:r,minSize:o,maxSize:a}=n,s=e===Rs||e===oa||e===aa,l=e===Es||e===sa||e===ra,c=e===Ps||e===oa||e===ra,d=e===Is||e===aa||e===sa,u=e===Es||e===Rs,p=e===Ps||e===Is,h=ki(i);s?(h.x=t.x,h.width-=t.x):l&&(h.width=t.x),d?(h.y=t.y,h.height-=t.y):c&&(h.height=t.y);const g=((R,W)=>la(0,0,R,W))(Math.min(h.width,a.width),Math.min(h.height,a.height));if(r){if(u){const R=Math.min(t.y,i.height-t.y);g.height=Math.min(2*R,g.height)}else if(p){const R=Math.min(t.x,i.width-t.x);g.width=Math.min(2*R,g.width)}}const m=r?rl(os(Or(o),r)):o,f=r?rl(qr(g,r)):g;let x,k,w,C;s?x=t.x:l&&(k=t.x),d?w=t.y:c&&(C=t.y),s?k=x+m.width:l&&(x=k-m.width),d?C=w+m.height:c&&(w=C-m.height),u?(w=t.y-.5*m.height,C=t.y+.5*m.height):p&&(x=t.x-.5*m.width,k=t.x+.5*m.width);const P=er([rt(x,w),rt(k,C)]);return s?k=x+f.width:l&&(x=k-f.width),d?C=w+f.height:c&&(w=C-f.height),u?(w=t.y-.5*f.height,C=t.y+.5*f.height):p&&(x=t.x-.5*f.width,k=t.x+.5*f.width),x=Math.max(i.x,x),k=Math.min(i.x+i.width,k),w=Math.max(i.y,w),C=Math.min(i.y+i.height,C),{inner:P,outer:er([rt(x,w),rt(k,C)])}};var nf=t=>180*t/Math.PI;function Xw(t){let e,i,n;return i=new e0({props:{elasticity:t[5],min:t[9],max:t[10],value:t[11],valueMin:Math.max(t[9],t[0]),valueMax:Math.min(t[10],t[1]),labelReset:t[6],base:t[12],valueLabel:Math.round(nf(t[11]))+"&deg;",oninputstart:t[2],oninputmove:t[17],oninputend:t[18]}}),{c(){e=pt("div"),Et(i.$$.fragment),v(e,"class","PinturaImageRotator")},m(r,o){et(r,e,o),Rt(i,e,null),n=!0},p(r,[o]){const a={};32&o&&(a.elasticity=r[5]),512&o&&(a.min=r[9]),1024&o&&(a.max=r[10]),2048&o&&(a.value=r[11]),513&o&&(a.valueMin=Math.max(r[9],r[0])),1026&o&&(a.valueMax=Math.min(r[10],r[1])),64&o&&(a.labelReset=r[6]),4096&o&&(a.base=r[12]),2048&o&&(a.valueLabel=Math.round(nf(r[11]))+"&deg;"),4&o&&(a.oninputstart=r[2]),392&o&&(a.oninputmove=r[17]),400&o&&(a.oninputend=r[18]),i.$set(a)},i(r){n||(M(i.$$.fragment,r),n=!0)},o(r){z(i.$$.fragment,r),n=!1},d(r){r&&tt(e),It(i)}}}function Yw(t,e,i){let n,r,o,a,s,l,c,{rotation:d}=e,{valueMin:u}=e,{valueMax:p}=e,{oninputstart:h=ge}=e,{oninputmove:g=ge}=e,{oninputend:m=ge}=e,{elasticity:f=0}=e,{labelReset:x}=e,{rotationMin:k}=e,{rotationMax:w}=e;return t.$$set=C=>{"rotation"in C&&i(13,d=C.rotation),"valueMin"in C&&i(0,u=C.valueMin),"valueMax"in C&&i(1,p=C.valueMax),"oninputstart"in C&&i(2,h=C.oninputstart),"oninputmove"in C&&i(3,g=C.oninputmove),"oninputend"in C&&i(4,m=C.oninputend),"elasticity"in C&&i(5,f=C.elasticity),"labelReset"in C&&i(6,x=C.labelReset),"rotationMin"in C&&i(14,k=C.rotationMin),"rotationMax"in C&&i(15,w=C.rotationMax)},t.$$.update=()=>{16384&t.$$.dirty&&i(9,n=k+1e-9),32768&t.$$.dirty&&i(10,r=w-1e-9),1536&t.$$.dirty&&i(12,o=n+.5*(r-n)),32768&t.$$.dirty&&i(16,a=2*w),8192&t.$$.dirty&&i(8,s=Math.sign(d)),73728&t.$$.dirty&&i(7,l=Math.round(Math.abs(d)/a)*a),8576&t.$$.dirty&&i(11,c=d-s*l)},[u,p,h,g,m,f,x,l,s,n,r,c,o,d,k,w,a,C=>g(s*l+C),C=>m(s*l+C)]}class qw extends li{constructor(e){super(),si(this,e,Yw,Xw,ni,{rotation:13,valueMin:0,valueMax:1,oninputstart:2,oninputmove:3,oninputend:4,elasticity:5,labelReset:6,rotationMin:14,rotationMax:15})}}function Kw(t){let e,i,n,r,o;return{c(){e=pt("div"),i=pt("p"),n=gn(t[0]),r=gn(" × "),o=gn(t[1]),v(e,"class","PinturaImageInfo")},m(a,s){et(a,e,s),kt(e,i),kt(i,n),kt(i,r),kt(i,o)},p(a,[s]){1&s&&zn(n,a[0]),2&s&&zn(o,a[1])},i:Ke,o:Ke,d(a){a&&tt(e)}}}function Jw(t,e,i){let{width:n}=e,{height:r}=e;return t.$$set=o=>{"width"in o&&i(0,n=o.width),"height"in o&&i(1,r=o.height)},[n,r]}class Qw extends li{constructor(e){super(),si(this,e,Jw,Kw,ni,{width:0,height:1})}}function tS(t){let e,i;return e=new ss({props:{class:"PinturaPresetListFilter",layout:"row",options:t[8],selectedIndex:t[7],onchange:t[10]}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};256&r&&(o.options=n[8]),128&r&&(o.selectedIndex=n[7]),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function eS(t){let e,i;return e=new Kh({props:{icon:t[0],label:t[1],labelClass:t[2],hideLabel:t[3],options:t[9],selectedIndex:t[4],onchange:t[5],optionMapper:t[6],$$slots:{controls:[tS]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,[r]){const o={};1&r&&(o.icon=n[0]),2&r&&(o.label=n[1]),4&r&&(o.labelClass=n[2]),8&r&&(o.hideLabel=n[3]),512&r&&(o.options=n[9]),16&r&&(o.selectedIndex=n[4]),32&r&&(o.onchange=n[5]),64&r&&(o.optionMapper=n[6]),262528&r&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}const rf='fill="none" stroke="currentColor"';function iS(t,e,i){let n,r,o,{icon:a}=e,{label:s}=e,{labelClass:l}=e,{hideLabel:c}=e,{options:d}=e,{selectedIndex:u}=e,{onchange:p}=e,{optionMapper:h}=e,{filter:g="landscape"}=e,{onfilterchange:m=ge}=e;const f=(k,w,C,P,R)=>`
    <rect ${rf} x="${k}" y="${w}" width="${C}" height="${P}" rx="${R}"/>`,x=(k,w)=>`<path ${rf} d="M${k} ${w} l2 2 l3 -4"/>`;return t.$$set=k=>{"icon"in k&&i(0,a=k.icon),"label"in k&&i(1,s=k.label),"labelClass"in k&&i(2,l=k.labelClass),"hideLabel"in k&&i(3,c=k.hideLabel),"options"in k&&i(12,d=k.options),"selectedIndex"in k&&i(4,u=k.selectedIndex),"onchange"in k&&i(5,p=k.onchange),"optionMapper"in k&&i(6,h=k.optionMapper),"filter"in k&&i(11,g=k.filter),"onfilterchange"in k&&i(13,m=k.onfilterchange)},t.$$.update=()=>{6144&t.$$.dirty&&i(9,n=((k,w)=>(k||[]).map(C=>We(C[0])?(C[1]=C[1].map(w),C):w(C)))(d,(k=>w=>{const[C,P,R={}]=w;return di(C)&&(R.hidden=k==="landscape"?C<1:C>1),[C,P,R]})(g))),2048&t.$$.dirty&&i(7,r=g==="landscape"?0:1),128&t.$$.dirty&&i(8,o=[["landscape","Landscape",{hideLabel:!0,icon:f(2,6,19,12,2)+(r===0?x(9,12):"")}],["portrait","Portrait",{hideLabel:!0,icon:f(5,3,13,18,2)+(r===1?x(9,12):"")}]])},[a,s,l,c,u,p,h,r,o,n,k=>{i(11,g=k.value),m(k.value)},g,d,m]}class nS extends li{constructor(e){super(),si(this,e,iS,eS,ni,{icon:0,label:1,labelClass:2,hideLabel:3,options:12,selectedIndex:4,onchange:5,optionMapper:6,filter:11,onfilterchange:13})}}const of=t=>So(t,e=>ai(e,6)),af=t=>Oo(t,e=>ai(e,6)),fs=(t,e,i=1e-4)=>Math.abs(t-e)<i;var rS=(t,e,i,n,r={})=>{const{aspectRatio:o}=r;t=af(t),n=n.map(of);const a=fm(t,i0[i.target]),s=So(a,x=>ai(x,6)),l=o?os(r.minSize,o):r.minSize,c=o?qr(r.maxSize,o):r.maxSize,d=fm(e,i.target);if(mo(d,a)<1){e=ki(t);const x=Math.min(l.width/t.width,l.height/t.height);Cr(e,x,a)}e=gm(ki(e),l,c,a);let u=ki(e);e=af(e);const p=cy(n,1),h=Wo(t),g=Wo(e),m=h.findIndex(x=>vs(So(x,k=>ai(k,6)),s)),f=x=>p.map(k=>wh(k,x)).filter(Boolean).pop();if(o){const x=g.map((k,w)=>{if(w===m)return;const C=rt(a.x-k.x,a.y-k.y);ro(C),Tr(C,.5);const P=rt(a.x-C.x,a.y-C.y),R=As(P,of(k)),W=f(R);if(!W)return;const T=h[w];return{intersection:W,cornerDist:mo(a,T),intersectionDist:mo(a,W)}}).filter(Boolean);if(x.length){const k=x.reduce((w,C)=>{const P=C.intersectionDist/C.cornerDist;return P<w?P:w},Number.MAX_SAFE_INTEGER);u=ki(t),Cr(u,k,a)}}else{const x=i.target.length===1,k=!(n[0].y===n[1].y||n[0].x===n[1].x),w=h.map((C,P)=>{if(P===m)return;const R=g[P],W=!fs(R.x,s.x)&&!fs(R.y,s.y);if(!x&&!k&&W||x&&(fs(R.x,s.x)||fs(R.y,s.y)))return;const T=Oe(x?C:a),F=Bn(Oe(T),R);ro(F),Tr(F,.5),x?Dn(T,F):Bn(T,F);const D=As(T,R);return f(D)||void 0}).filter(Boolean);if(w.length){const[C,P,R,W]=n0(i.target);let[T,F,D,B]=ol(e);w.forEach(({x:y,y:_})=>{const J=ai(y,6),S=ai(_,6);R&&!fs(S,s.y)&&(T=Math.max(T,_)),C&&!fs(J,s.x)&&(F=Math.min(F,y)),W&&!fs(S,s.y)&&(D=Math.min(D,_)),P&&!fs(J,s.x)&&(B=Math.max(B,y))}),u=rb([T,F,D,B]),Cr(u,.9999,a)}}return gm(u,l,c,a),u};function oS(t){let e,i;return e=new oo({props:{items:t[11]}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};2048&r[0]&&(o.items=n[11]),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function aS(t){let e,i,n;return i=new X2({props:{$$slots:{default:[oS]},$$scope:{ctx:t}}}),{c(){e=pt("div"),Et(i.$$.fragment),v(e,"slot","header")},m(r,o){et(r,e,o),Rt(i,e,null),n=!0},p(r,o){const a={};2048&o[0]|4&o[7]&&(a.$$scope={dirty:o,ctx:r}),i.$set(a)},i(r){n||(M(i.$$.fragment,r),n=!0)},o(r){z(i.$$.fragment,r),n=!1},d(r){r&&tt(e),It(i)}}}function sf(t){let e,i;return e=new Fs({props:{onclick:t[88],label:t[4].cropLabelButtonRecenter,icon:t[4].cropIconButtonRecenter,class:"PinturaButtonCenter",disabled:!t[9],hideLabel:!0,style:`opacity: ${t[29]}; transform: translate3d(${t[30].x}px, ${t[30].y}px, 0)`}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};16&r[0]&&(o.label=n[4].cropLabelButtonRecenter),16&r[0]&&(o.icon=n[4].cropIconButtonRecenter),512&r[0]&&(o.disabled=!n[9]),1610612736&r[0]&&(o.style=`opacity: ${n[29]}; transform: translate3d(${n[30].x}px, ${n[30].y}px, 0)`),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function lf(t){let e,i;return e=new Uw({props:{rect:t[8],visible:t[12],style:t[1]}}),e.$on("resizestart",t[68]),e.$on("resizemove",t[69]),e.$on("resizeend",t[70]),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};256&r[0]&&(o.rect=n[8]),4096&r[0]&&(o.visible=n[12]),2&r[0]&&(o.style=n[1]),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function cf(t){let e,i;return e=new Qw({props:{width:Math.round(t[13].width),height:Math.round(t[13].height)}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};8192&r[0]&&(o.width=Math.round(n[13].width)),8192&r[0]&&(o.height=Math.round(n[13].height)),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function sS(t){let e,i,n,r,o,a,s,l,c=t[21]&&t[10]&&sf(t),d=t[21]&&lf(t),u=t[22]&&cf(t);return{c(){e=pt("div"),i=pt("div"),c&&c.c(),n=he(),d&&d.c(),o=he(),u&&u.c(),v(i,"class","PinturaStage"),v(e,"slot","main")},m(p,h){et(p,e,h),kt(e,i),c&&c.m(i,null),kt(i,n),d&&d.m(i,null),t[162](i),kt(e,o),u&&u.m(e,null),a=!0,s||(l=[Ui(dr.call(null,i)),Ct(i,"measure",t[160]),Ct(i,"wheel",function(){ji(t[2]&&t[87])&&(t[2]&&t[87]).apply(this,arguments)},{passive:!1}),Ct(i,"interactionstart",t[74]),Ct(i,"interactionupdate",t[75]),Ct(i,"interactionrelease",t[77]),Ct(i,"interactionend",t[76]),Ui(r=Ds.call(null,i,{drag:!0,inertia:!0,pinch:t[2],shouldStartInteraction:uf,getEventPosition:t[163]})),Ct(i,"gesturedown",t[84]),Ct(i,"gestureupdate",t[85]),Ct(i,"gestureup",t[86]),Ui(Gw.call(null,i))],s=!0)},p(p,h){(t=p)[21]&&t[10]?c?(c.p(t,h),2098176&h[0]&&M(c,1)):(c=sf(t),c.c(),M(c,1),c.m(i,n)):c&&(Pe(),z(c,1,1,()=>{c=null}),Re()),t[21]?d?(d.p(t,h),2097152&h[0]&&M(d,1)):(d=lf(t),d.c(),M(d,1),d.m(i,null)):d&&(Pe(),z(d,1,1,()=>{d=null}),Re()),r&&ji(r.update)&&16777220&h[0]&&r.update.call(null,{drag:!0,inertia:!0,pinch:t[2],shouldStartInteraction:uf,getEventPosition:t[163]}),t[22]?u?(u.p(t,h),4194304&h[0]&&M(u,1)):(u=cf(t),u.c(),M(u,1),u.m(e,null)):u&&(Pe(),z(u,1,1,()=>{u=null}),Re())},i(p){a||(M(c),M(d),M(u),a=!0)},o(p){z(c),z(d),z(u),a=!1},d(p){p&&tt(e),c&&c.d(),d&&d.d(),t[162](null),u&&u.d(),s=!1,Bi(l)}}}function df(t){let e,i,n,r;const o=[{class:"PinturaControlList"},{tabs:t[7]},t[18]];let a={$$slots:{default:[lS,({tab:c})=>({218:c}),({tab:c})=>[0,0,0,0,0,0,0,c?2:0]]},$$scope:{ctx:t}};for(let c=0;c<o.length;c+=1)a=In(a,o[c]);e=new Iu({props:a}),e.$on("select",t[161]);const s=[{class:"PinturaControlPanels"},{panelClass:"PinturaControlPanel"},{panels:t[17]},t[18]];let l={$$slots:{default:[uS,({panel:c})=>({217:c}),({panel:c})=>[0,0,0,0,0,0,0,c?1:0]]},$$scope:{ctx:t}};for(let c=0;c<s.length;c+=1)l=In(l,s[c]);return n=new Eu({props:l}),{c(){Et(e.$$.fragment),i=he(),Et(n.$$.fragment)},m(c,d){Rt(e,c,d),et(c,i,d),Rt(n,c,d),r=!0},p(c,d){const u=262272&d[0]?yr(o,[o[0],128&d[0]&&{tabs:c[7]},262144&d[0]&&Pr(c[18])]):{};6&d[7]&&(u.$$scope={dirty:d,ctx:c}),e.$set(u);const p=393216&d[0]?yr(s,[s[0],s[1],131072&d[0]&&{panels:c[17]},262144&d[0]&&Pr(c[18])]):{};511721496&d[0]|5&d[7]&&(p.$$scope={dirty:d,ctx:c}),n.$set(p)},i(c){r||(M(e.$$.fragment,c),M(n.$$.fragment,c),r=!0)},o(c){z(e.$$.fragment,c),z(n.$$.fragment,c),r=!1},d(c){It(e,c),c&&tt(i),It(n,c)}}}function lS(t){let e,i,n=t[218].label+"";return{c(){e=pt("span"),i=gn(n)},m(r,o){et(r,e,o),kt(e,i)},p(r,o){2&o[7]&&n!==(n=r[218].label+"")&&zn(i,n)},d(r){r&&tt(e)}}}function cS(t){let e,i;return e=new e0({props:{elasticity:t[25]*t[44],base:$S,min:t[23],max:mS,valueMin:t[27][0],valueMax:t[27][1],value:t[28],labelReset:t[4].labelReset,valueLabel:Math.round(100*t[28])+"%",oninputstart:t[81],oninputmove:t[82],oninputend:t[83]}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};33554432&r[0]&&(o.elasticity=n[25]*n[44]),8388608&r[0]&&(o.min=n[23]),134217728&r[0]&&(o.valueMin=n[27][0]),134217728&r[0]&&(o.valueMax=n[27][1]),268435456&r[0]&&(o.value=n[28]),16&r[0]&&(o.labelReset=n[4].labelReset),268435456&r[0]&&(o.valueLabel=Math.round(100*n[28])+"%"),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function dS(t){let e,i;return e=new qw({props:{elasticity:t[25]*t[44],rotation:t[14],labelReset:t[4].labelReset,valueMin:t[26][0],valueMax:t[26][1],rotationMin:-t[3],rotationMax:t[3],oninputstart:t[71],oninputmove:t[72],oninputend:t[73]}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};33554432&r[0]&&(o.elasticity=n[25]*n[44]),16384&r[0]&&(o.rotation=n[14]),16&r[0]&&(o.labelReset=n[4].labelReset),67108864&r[0]&&(o.valueMin=n[26][0]),67108864&r[0]&&(o.valueMax=n[26][1]),8&r[0]&&(o.rotationMin=-n[3]),8&r[0]&&(o.rotationMax=n[3]),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function uS(t){let e,i,n,r;const o=[dS,cS],a=[];function s(l,c){return l[217]===l[93]+"-rotation"?0:l[217]===l[93]+"-zoom"?1:-1}return~(e=s(t))&&(i=a[e]=o[e](t)),{c(){i&&i.c(),n=Tn()},m(l,c){~e&&a[e].m(l,c),et(l,n,c),r=!0},p(l,c){let d=e;e=s(l),e===d?~e&&a[e].p(l,c):(i&&(Pe(),z(a[d],1,1,()=>{a[d]=null}),Re()),~e?(i=a[e],i?i.p(l,c):(i=a[e]=o[e](l),i.c()),M(i,1),i.m(n.parentNode,n)):i=null)},i(l){r||(M(i),r=!0)},o(l){z(i),r=!1},d(l){~e&&a[e].d(l),l&&tt(n)}}}function pS(t){let e,i,n=t[19]&&df(t);return{c(){e=pt("div"),n&&n.c(),v(e,"slot","footer"),v(e,"style",t[16])},m(r,o){et(r,e,o),n&&n.m(e,null),i=!0},p(r,o){r[19]?n?(n.p(r,o),524288&o[0]&&M(n,1)):(n=df(r),n.c(),M(n,1),n.m(e,null)):n&&(Pe(),z(n,1,1,()=>{n=null}),Re()),(!i||65536&o[0])&&v(e,"style",r[16])},i(r){i||(M(n),i=!0)},o(r){z(n),i=!1},d(r){r&&tt(e),n&&n.d()}}}function hS(t){let e,i,n;function r(a){t[164](a)}let o={hasHeader:t[20],$$slots:{footer:[pS],main:[sS],header:[aS]},$$scope:{ctx:t}};return t[15]!==void 0&&(o.root=t[15]),e=new cl({props:o}),Ai.push(()=>$o(e,"root",r)),e.$on("measure",t[165]),{c(){Et(e.$$.fragment)},m(a,s){Rt(e,a,s),n=!0},p(a,s){const l={};1048576&s[0]&&(l.hasHeader=a[20]),2146402302&s[0]|4&s[7]&&(l.$$scope={dirty:s,ctx:a}),!i&&32768&s[0]&&(i=!0,l.root=a[15],ko(()=>i=!1)),e.$set(l)},i(a){n||(M(e.$$.fragment,a),n=!0)},o(a){z(e.$$.fragment,a),n=!1},d(a){It(e,a)}}}const mS=1,$S=0,uf=(t,e)=>t.target===e;function gS(t,e,i){let n,r,o,a,s,l,c,d,u,p,h,g,m,f,x,k,w,C,P,R,W,T,F,D,B,y,_,J,S,j,Q,ht,at,U,yt,$t,Mt,dt,Tt,K,q,Z,xt,it,mt,Ft,ie,Dt,Ot,ae,G,wt,ut,Xt,ce,te,ve,me,V,Ce,yi,xe,_t,ze,Ie,Fe,hi,bt,ne,Ue,Ee,jt,Ge=Ke,Qe=()=>(Ge(),Ge=Br(mi,I=>i(12,S=I)),mi);t.$$.on_destroy.push(()=>Ge());let{isActive:mi}=e;Qe();let{stores:$i}=e,{cropImageSelectionCornerStyle:Li="circle"}=e,{cropWillRenderImageSelectionGuides:X=(I,Te)=>{const Ne=I=="rotate";return{rows:Ne?5:3,cols:Ne?5:3,opacity:.25*Te}}}=e,{cropAutoCenterImageSelectionTimeout:Ut}=e,{cropEnableZoomMatchImageAspectRatio:H=!0}=e,{cropEnableRotateMatchImageAspectRatio:Bt="never"}=e,{cropEnableRotationInput:be=!0}=e,{cropEnableZoom:se=!0}=e,{cropEnableZoomInput:At=!0}=e,{cropEnableZoomAutoHide:re=!0}=e,{cropEnableImageSelection:Me=!0}=e,{cropEnableInfoIndicator:De=!1}=e,{cropEnableZoomTowardsWheelPosition:_e=!0}=e,{cropEnableLimitWheelInputToCropSelection:Ze=!0}=e,{cropEnableCenterImageSelection:nt=!0}=e,{cropEnableButtonRotateLeft:Qt=!0}=e,{cropEnableButtonRotateRight:Zt=!1}=e,{cropEnableButtonFlipHorizontal:Kt=!0}=e,{cropEnableButtonFlipVertical:Yt=!1}=e,{cropSelectPresetOptions:st}=e,{cropEnableSelectPreset:le=!0}=e,{cropEnableFilterMatchAspectRatio:ee=!0}=e,{cropSelectPresetFilter:ye=!1}=e,{cropEnableButtonToggleCropLimit:Xe=!1}=e,{cropWillRenderTools:$e=Yi}=e,{cropActiveTransformTool:vi="rotation"}=e,{cropMinimizeToolbar:Le="auto"}=e,{cropInteractionFocus:Gt="image"}=e,{cropRotationRange:gi=Qo}=e,{cropMaskOpacity:Ti=.85}=e,{locale:Ve={}}=e;const ri=dn("isAnimated");A(t,ri,I=>i(139,j=I));const Be=dn("elasticityMultiplier");A(t,Be,I=>i(25,hi=I));const Se=dn("redrawTrigger");A(t,Se,I=>i(159,Fe=I));const Zi=dn("imageIsStatic");A(t,Zi,I=>i(145,Mt=I));const un=dn("imageStaticVisualCorners");A(t,un,I=>i(181,me=I));const wn=dn("fixScrollDirection");A(t,wn,I=>i(175,G=I));let sn="idle";const an=pe();A(t,an,I=>i(156,_t=I));const Mn=()=>te===void 0,ur=I=>1/I,ao=I=>{ee&&ye!==I&&(i(95,ye=I),te&&te!==1&&fn()&&vt(mr,te=ur(te),te))},fn=()=>{if(te===1||!n)return!1;const I=ur(te);return!!Ts(_t).find(([Te])=>Te===I)},Rr=(I,Te,Ne)=>za(Ne)?Te.width===Math.round(I.height)||Te.height===Math.round(I.width):Te.width===Math.round(I.width)||Te.height===Math.round(I.height),Sn=()=>(Mn()||Bt==="always"&&fn())&&((I,Te,Ne)=>{const fi=ns(iy(no(Te),Ne),ti=>Math.abs(Math.round(ti))),Di=Dl(fi),Ni=Ci(I);return vs(Di,Ni)})(dt,ie,Dt)&&Rr(dt,ie,Dt),Vn=I=>{if(Bt!=="never"&&Sn()){vt(_r,Dt+=I,Dt);const Te=za(Dt),Ne=Te?ie.height:ie.width,fi=Te?ie.width:ie.height;vt(qi,dt=An(0,0,Ne,fi),dt),Mn()||vt(mr,te=Jo(Ne,fi),te)}else vt(_r,Dt+=I,Dt)},{history:yn,env:To,isInteracting:Oi,isInteractingFraction:xn,isTransformingImage:On,rootRect:No,stageRect:Kr,utilRect:go,utilRectPadded:Mo,rootLineColor:pr,allowPan:pn,allowZoom:Qi,allowPlayPause:so,rangeInputElasticity:Ho,presentationScalar:xr,utilTools:br,imagePreviewModifiers:lo,imageOutlineOpacity:ca,imageFlipX:Po,imageFlipY:Ro,imageRotation:_r,imageRotationRange:Jr,imageOutputSize:Ir,imageSelectionRect:hr,imageSelectionRectSnapshot:vr,imageSelectionRectIntent:Wn,imageSelectionRectPresentation:Wi,imageCropRectIntent:_i,imageCropRectOrigin:lr,imageCropRect:qi,imageCropMinSize:Vr,imageCropMaxSize:co,imageCropRange:Qr,imageCropAspectRatio:mr,imageCropLimitToImage:Fn,imageSize:wr,imageScalar:uo,imageOverlayMarkup:cr,stagePadded:Kn,stageRecenter:Nn}=$i;let Er;A(t,To,I=>i(140,Q=I)),A(t,Oi,I=>i(144,$t=I)),A(t,On,I=>i(173,mt=I)),A(t,No,I=>i(24,wt=I)),A(t,Kr,I=>i(151,it=I)),A(t,Mo,I=>i(148,q=I)),A(t,xr,I=>i(147,K=I)),A(t,br,I=>i(183,Ce=I)),A(t,lo,I=>i(172,U=I)),A(t,Po,I=>i(158,Ie=I)),A(t,Ro,I=>i(157,ze=I)),A(t,_r,I=>i(14,Dt=I)),A(t,Jr,I=>i(26,bt=I)),A(t,Ir,I=>i(184,yi=I)),A(t,hr,I=>i(150,xt=I)),A(t,vr,I=>i(149,Z=I)),A(t,Wn,I=>i(182,V=I)),A(t,Wi,I=>i(143,yt=I)),A(t,_i,I=>i(176,ut=I)),A(t,lr,I=>i(178,ce=I)),A(t,qi,I=>i(13,dt=I)),A(t,Vr,I=>i(154,ae=I)),A(t,co,I=>i(180,ve=I)),A(t,Qr,I=>i(177,Xt=I)),A(t,mr,I=>i(179,te=I)),A(t,Fn,I=>i(153,Ot=I)),A(t,wr,I=>i(152,ie=I)),A(t,uo,I=>i(146,Tt=I)),A(t,Kn,I=>i(142,at=I));const to=(I,Te)=>{const Ne={target:I,translate:Te},fi=Bd(no(ae),K),Di=Bd(no(ve),K);let Ni=ef(Z,Ne,{...q,x:0,y:0},{aspectRatio:te,minSize:fi,maxSize:Di});if(Ni=((oi,Ei,zi)=>{const[mn,Pn,bn,Fi]=ol(oi),Pi={...oi};if(mn<Ei.y&&(oi.height=oi.height-(Ei.y-mn),oi.y=Ei.y),Pn>Ei.x+Ei.width&&(oi.width=Ei.x+Ei.width-oi.x),bn>Ei.y+Ei.height&&(oi.height=Ei.y+Ei.height-oi.y),Fi<Ei.x&&(oi.width=oi.width-(Ei.x-Fi),oi.x=Ei.x),zi){const zr=Math.min(1,Pi.width/oi.width,Pi.height/oi.height);return Cs(Pi,zr)}return oi})(Ni,{...q,x:0,y:0},te),!Ot)return{boundsLimited:Ni,boundsIntent:Ni};let ti=rS(Z,Ni,Ne,me,{aspectRatio:te,minSize:fi,maxSize:Di});return{boundsLimited:ti,boundsIntent:ti}},eo=(I,Te)=>{const Ne={target:I,translate:Te},fi=Bd(no(ae),K),Di=Bd(no(ve),K),Ni=((ti,oi,Ei={})=>{const{target:zi,translate:mn}=oi,{aspectRatio:Pn,minSize:bn}=Ei,Fi=Lc[i0[zi]],Pi=Dn(ki(ti),rt(Fi[0]*ti.width,Fi[1]*ti.height)),zr=Lc[zi],Ao=Dn(ki(ti),rt(zr[0]*ti.width,zr[1]*ti.height)),[Wa,_a,Va,Na,Uo,ls,dl]=n0(zi);let Ha=mn.x,Ma=mn.y;Uo?Ma=0:ls&&(Ha=0);let[jr,Fr,Sr,Ur]=ol(ti);if(Wa?Ur=Pi.x:_a&&(Fr=Pi.x),Na?jr=Pi.y:Va&&(Sr=Pi.y),Wa?Fr=Ao.x+Ha:_a&&(Ur=Ao.x+Ha),Na?Sr=Ao.y+Ma:Va&&(jr=Ao.y+Ma),bn&&Uo&&Sr-jr<bn.height){const ln=bn.height-(Sr-jr);jr-=.5*ln,Sr+=.5*ln}if(bn&&ls&&Fr-Ur<bn.width){const ln=bn.width-(Fr-Ur);Ur-=.5*ln,Fr+=.5*ln}if(Pn)if(dl){let ln=Fr-Ur,Lo=Sr-jr;Uo?(Lo=ln/Pn,jr=Pi.y-.5*Lo,Sr=Pi.y+.5*Lo):ls&&(ln=Lo*Pn,Ur=Pi.x-.5*ln,Fr=Pi.x+.5*ln)}else{const ln=rt(Ao.x+Ha-Pi.x,Ao.y+Ma-Pi.y);zi===oa?(ln.x=Math.max(0,ln.x),ln.y=Math.min(0,ln.y)):zi===aa?(ln.x=Math.max(0,ln.x),ln.y=Math.max(0,ln.y)):zi===sa?(ln.x=Math.min(0,ln.x),ln.y=Math.max(0,ln.y)):zi===ra&&(ln.x=Math.min(0,ln.x),ln.y=Math.min(0,ln.y));const Lo=Ss(ln),tn=rt(Pn,1),po=Tr(ro(tn),Lo);zi===oa?(Fr=Pi.x+po.x,jr=Pi.y-po.y):zi===aa?(Fr=Pi.x+po.x,Sr=Pi.y+po.y):zi===sa?(Ur=Pi.x-po.x,Sr=Pi.y+po.y):zi===ra&&(Ur=Pi.x-po.x,jr=Pi.y-po.y)}return An(Ur,jr,Fr-Ur,Sr-jr)})(Z,Ne,{aspectRatio:te,minSize:fi});return{boundsLimited:ef(Z,Ne,{...q,x:0,y:0},{aspectRatio:te,minSize:fi,maxSize:Di}),boundsIntent:Ni}};let En,Ar;const O=({translation:I,scalar:Te})=>{Mt&&(Te=1,I=El(Oe(I)));const Ne=Math.min(xt.width/dt.width,xt.height/dt.height),fi=Tr(Oe(I),1/Ne);let Di;if(Ar){const Ni=Bn(Oe(Ar),I);Ar=I,Di=ta(ki(dt),Ni)}else Di=ta(ki(En),El(Oe(fi))),Te!==void 0&&Cr(Di,1/Te);vt(_i,ut=Di,ut),vt(qi,dt=Di,dt)},de=Ii([Qr,qi],([I,Te],Ne)=>{if(!Te)return;const[fi,Di]=I,Ni=ir(Te);Ne([rl(Oo(os(fi,Ni),ai)),rl(Oo(qr(Di,Ni),ai))])});A(t,de,I=>i(174,Ft=I));const wi=Ii([wr,Fn,Vr,co,Qr,_r],([I,Te,Ne,fi,Di,Ni],ti)=>{if(!I)return;const oi=Di[0],Ei=Di[1];let zi,mn;Te?(zi=((Pn,bn,Fi)=>za(Fi)?1-1/Math.min(Pn.height/bn.width,Pn.width/bn.height):1-1/Math.min(Pn.width/bn.width,Pn.height/bn.height))(I,Ei,Ni),mn=Math.min(oi.width/Ne.width,oi.height/Ne.height)):(zi=-1,mn=1),ti([zi,mn].map(Pn=>ai(Pn)))});A(t,wi,I=>i(27,ne=I));const je=Ii([wr,qi,Qr,_r],([I,Te,Ne,fi],Di)=>{if(!I||!Te)return Di(0);let Ni;const ti=Ne[0],oi=Ne[1],Ei=Te.width,zi=Te.height,mn=ir(Te),Pn=za(fi)?jn(I.height,I.width):I,bn=qr(Pn,mn);if(Ei<=bn.width||zi<=bn.height){const Fi=bn.width-ti.width,Pi=bn.height-ti.height;Ni=Fi===0||Pi===0?1:1-Math.min((Ei-ti.width)/Fi,(zi-ti.height)/Pi)}else{const Fi=oi.width-bn.width,Pi=oi.height-bn.height,zr=qr({width:Fi,height:Pi},mn);Ni=-Math.min((Ei-bn.width)/zr.width,(zi-bn.height)/zr.height)}Di(Ni)});A(t,je,I=>i(28,Ue=I));const Pt=I=>{const Te=ir(En);let Ne,fi,Di;const Ni=za(Dt)?jn(ie.height,ie.width):ie,ti=qr(Ni,Te);if(I>=0){const zi=ti.width-Xt[0].width,mn=ti.height-Xt[0].height;Ne=ti.width-zi*I,fi=ti.height-mn*I,Di=os({width:Ne,height:fi},Te)}else{const zi=Xt[1].width-ti.width,mn=Xt[1].height-ti.height;Ne=ti.width+zi*-I,fi=ti.height+mn*-I,Di=qr({width:Ne,height:fi},Te)}Ne=Di.width,fi=Di.height;const oi=En.x+.5*En.width-.5*Ne,Ei=En.y+.5*En.height-.5*fi;vt(qi,dt={x:oi,y:Ei,width:Ne,height:fi},dt)};let fe;const xi=I=>{const Te=Cr(ki(fe),1/I);vt(_i,ut=Te,ut),vt(qi,dt=Te,dt)};let Gi;const hn=()=>{Nn.set({})};let Si;const Vi=ci(0,{precision:1e-4});A(t,Vi,I=>i(29,Ee=I));const Lr=ci();A(t,Lr,I=>i(30,jt=I));const da=Ii([mr,Ir,an],([I,Te,Ne],fi)=>{if(!n)return;const Di=Ts(Ne),Ni=[...Di].map(ti=>ti[0]).sort((ti,oi)=>Ln(ti[0])&&!Ln(oi[0])?1:-1).find(ti=>{if(Ln(ti)&&Te){const[oi,Ei]=ti,zi=Te.width===oi&&Te.height===Ei,mn=I===Jo(oi,Ei);return zi&&mn}return ti===I});if(!Ni)return fi(void 0);fi(Di.map(ti=>ti[0]).findIndex(ti=>Ln(ti)?as(ti,Ni):ti===Ni))});A(t,da,I=>i(155,xe=I));const ua=(I,Te)=>{if(!n||I===-1||I===void 0)return;const Ne=Ts(Te)[I][0];return Ne?Ln(Ne)?Jo(Ne[0],Ne[1]):Ne:void 0},Ta=Ii([pr,Wi,xn],([I,Te,Ne],fi)=>{const{rows:Di,cols:Ni,opacity:ti}=X(sn,Ne);if(!Te||ti<=0)return fi([]);const{x:oi,y:Ei,width:zi,height:mn}=Te,Pn=zi/Ni,bn=mn/Di,Fi=[];for(let Pi=1;Pi<=Di-1;Pi++){const zr=Ei+bn*Pi;Fi.push({id:"image-selection-guide-row-"+Pi,points:[rt(oi,zr),rt(oi+zi,zr)],opacity:ti,strokeWidth:1,strokeColor:I})}for(let Pi=1;Pi<=Ni-1;Pi++){const zr=oi+Pn*Pi;Fi.push({id:"image-selection-guide-col-"+Pi,points:[rt(zr,Ei),rt(zr,Ei+mn)],opacity:ti,strokeWidth:1,strokeColor:I})}fi(Fi)});A(t,Ta,I=>i(141,ht=I));const jo="crop-"+na();let Nr,Io=jo+"-"+(be?vi:"zoom"),Eo=Io,Oa;const Hr=ci(j?20:0);return A(t,Hr,I=>i(138,J=I)),t.$$set=I=>{"isActive"in I&&Qe(i(0,mi=I.isActive)),"stores"in I&&i(97,$i=I.stores),"cropImageSelectionCornerStyle"in I&&i(1,Li=I.cropImageSelectionCornerStyle),"cropWillRenderImageSelectionGuides"in I&&i(98,X=I.cropWillRenderImageSelectionGuides),"cropAutoCenterImageSelectionTimeout"in I&&i(99,Ut=I.cropAutoCenterImageSelectionTimeout),"cropEnableZoomMatchImageAspectRatio"in I&&i(100,H=I.cropEnableZoomMatchImageAspectRatio),"cropEnableRotateMatchImageAspectRatio"in I&&i(101,Bt=I.cropEnableRotateMatchImageAspectRatio),"cropEnableRotationInput"in I&&i(102,be=I.cropEnableRotationInput),"cropEnableZoom"in I&&i(2,se=I.cropEnableZoom),"cropEnableZoomInput"in I&&i(103,At=I.cropEnableZoomInput),"cropEnableZoomAutoHide"in I&&i(104,re=I.cropEnableZoomAutoHide),"cropEnableImageSelection"in I&&i(105,Me=I.cropEnableImageSelection),"cropEnableInfoIndicator"in I&&i(106,De=I.cropEnableInfoIndicator),"cropEnableZoomTowardsWheelPosition"in I&&i(107,_e=I.cropEnableZoomTowardsWheelPosition),"cropEnableLimitWheelInputToCropSelection"in I&&i(108,Ze=I.cropEnableLimitWheelInputToCropSelection),"cropEnableCenterImageSelection"in I&&i(109,nt=I.cropEnableCenterImageSelection),"cropEnableButtonRotateLeft"in I&&i(110,Qt=I.cropEnableButtonRotateLeft),"cropEnableButtonRotateRight"in I&&i(111,Zt=I.cropEnableButtonRotateRight),"cropEnableButtonFlipHorizontal"in I&&i(112,Kt=I.cropEnableButtonFlipHorizontal),"cropEnableButtonFlipVertical"in I&&i(113,Yt=I.cropEnableButtonFlipVertical),"cropSelectPresetOptions"in I&&i(114,st=I.cropSelectPresetOptions),"cropEnableSelectPreset"in I&&i(115,le=I.cropEnableSelectPreset),"cropEnableFilterMatchAspectRatio"in I&&i(116,ee=I.cropEnableFilterMatchAspectRatio),"cropSelectPresetFilter"in I&&i(95,ye=I.cropSelectPresetFilter),"cropEnableButtonToggleCropLimit"in I&&i(117,Xe=I.cropEnableButtonToggleCropLimit),"cropWillRenderTools"in I&&i(118,$e=I.cropWillRenderTools),"cropActiveTransformTool"in I&&i(119,vi=I.cropActiveTransformTool),"cropMinimizeToolbar"in I&&i(120,Le=I.cropMinimizeToolbar),"cropInteractionFocus"in I&&i(121,Gt=I.cropInteractionFocus),"cropRotationRange"in I&&i(3,gi=I.cropRotationRange),"cropMaskOpacity"in I&&i(122,Ti=I.cropMaskOpacity),"locale"in I&&i(4,Ve=I.locale)},t.$$.update=()=>{4096&t.$$.dirty[0]|268435456&t.$$.dirty[3]&&Zi.set(Gt==="selection"&&S),2097152&t.$$.dirty[3]&&i(129,n=st&&Array.isArray(st)&&st.length),2097152&t.$$.dirty[3]|32&t.$$.dirty[4]&&an.set(n?st:[]),4096&t.$$.dirty[0]|32768&t.$$.dirty[4]&&S&&ca.set(1,{hard:!j}),4096&t.$$.dirty[0]&&pn.set(!S),4096&t.$$.dirty[0]&&Qi.set(!S),4096&t.$$.dirty[0]&&S&&so.set(!0),65536&t.$$.dirty[4]&&i(124,h=Q.layoutMode==="overlay"),4194304&t.$$.dirty[3]|1&t.$$.dirty[4]&&i(128,P=le&&!h),83886080&t.$$.dirty[4]&&i(137,l=q&&xt&&eu(q,xt)),67117056&t.$$.dirty[4]&&i(135,c=!(!xt||!l)),67119104&t.$$.dirty[4]&&i(133,d=c&&ea(xt,l,I=>ai(I,5))),16400&t.$$.dirty[0]|52297732&t.$$.dirty[3]|1879114288&t.$$.dirty[4]|31&t.$$.dirty[5]&&i(11,r=Fe&&$e([Qt&&["Button","rotate-left",{label:Ve.cropLabelButtonRotateLeft,labelClass:"PinturaToolbarContentWide",icon:Ve.cropIconButtonRotateLeft,onclick:()=>{Vn(-Math.PI/2),yn.write()}}],Zt&&["Button","rotate-right",{label:Ve.cropLabelButtonRotateRight,labelClass:"PinturaToolbarContentWide",icon:Ve.cropIconButtonRotateRight,onclick:()=>{Vn(Math.PI/2),yn.write()}}],Kt&&["Button","flip-horizontal",{label:Ve.cropLabelButtonFlipHorizontal,labelClass:"PinturaToolbarContentWide",icon:Ve.cropIconButtonFlipHorizontal,onclick:()=>{za(Dt)?vt(Ro,ze=!ze,ze):vt(Po,Ie=!Ie,Ie),yn.write()}}],Yt&&["Button","flip-vertical",{label:Ve.cropLabelButtonFlipVertical,labelClass:"PinturaToolbarContentWide",icon:Ve.cropIconButtonFlipVertical,onclick:()=>{za(Dt)?vt(Po,Ie=!Ie,Ie):vt(Ro,ze=!ze,ze),yn.write()}}],P&&n&&[ye===!1?"Dropdown":nS,"select-preset",{icon:nr(Ve.cropIconSelectPreset,Ve,ua(xe,_t)),label:nr(Ve.cropLabelSelectPreset,Ve,ua(xe,_t)),labelClass:"PinturaToolbarContentWide",options:_t,filter:ye,onfilterchange:ao,selectedIndex:xe,onchange:({value:I})=>{Ln(I)?(vt(mr,te=Jo(I[0],I[1]),te),vt(Ir,yi=ey(I),yi)):vt(mr,te=I,te),d&&hn(),yn.write()},optionMapper:I=>{let Te=!1;const Ne=Ln(I.value)?I.value[0]/I.value[1]:I.value;if(Ne){const fi=Il(ie,Dt,Ne);Te=fi.width<ae.width||fi.height<ae.height}return I.icon=((fi,Di={})=>{const{width:Ni=24,height:ti=24,bounds:oi=16,radius:Ei=3}=Di;let zi,mn,Pn,bn,Fi=Ln(fi)?Jo(fi[0],fi[1]):fi,Pi=!!Fi;return Fi=Pi?Fi:1,Pn=Fi>1?oi:Fi*oi,bn=Pn/Fi,zi=Math.round(.5*(Ni-Pn)),mn=Math.round(.5*(ti-bn)),`<rect fill="${Pi?"currentColor":"none"}" stroke="${Pi?"none":"currentColor"}" stroke-width="${Ni/16}" stroke-dasharray="${[Ni/12,Ni/6].join(" ")}" x="${zi}" y="${mn}" width="${Pn}" height="${bn}" rx="${Ei}"/>`})(I.value,{bounds:14}),{...I,disabled:Te}}}],Xe&&["Dropdown","select-crop-limit",{icon:nr(Ve.cropIconCropBoundary,Ve,Ot),label:Ve.cropLabelCropBoundary,labelClass:"PinturaToolbarContentWide",onchange:({value:I})=>{vt(Fn,Ot=I,Ot),yn.write()},options:[[!0,Ve.cropLabelCropBoundaryEdge,{icon:nr(Ve.cropIconCropBoundary,Ve,!0)}],[!1,Ve.cropLabelCropBoundaryNone,{icon:nr(Ve.cropIconCropBoundary,Ve,!1)}]]}]].filter(Boolean),Q,()=>Se.set({})).filter(Boolean)),6144&t.$$.dirty[0]|134217728&t.$$.dirty[3]|65537&t.$$.dirty[4]&&vt(br,Ce=S&&Le!=="never"&&(Le==="always"||Q.verticalSpace==="short"||h)?r.map(([I,Te,Ne])=>Array.isArray(Ne)?[I,Te,Ne]:[I,Te,{...Ne,hideLabel:!0}]):[],Ce),536870912&t.$$.dirty[4]&&i(23,o=Ot?0:-1),150994944&t.$$.dirty[4]&&i(130,a=q&&rt(-(it.x-q.x),-(it.y-q.y))),524352&t.$$.dirty[4]&&i(131,s=yt&&a&&rt(Oc(yt.x+.5*yt.width+a.x),Oc(yt.y+.5*yt.height+a.y))),33554432&t.$$.dirty[4]&&i(134,u=Z!=null),16785408&t.$$.dirty[4]&&i(136,p=q&&l&&(l.height===q.height||l.width===q.width)),12587008&t.$$.dirty[4]&&i(132,g=!p&&K<1&&Tt<1),3840&t.$$.dirty[4]&&i(9,m=c&&!u&&(!d||g)),8192&t.$$.dirty[0]|8192&t.$$.dirty[3]|1&t.$$.dirty[4]&&i(22,f=De&&!!dt&&!h),524352&t.$$.dirty[4]&&i(8,w=yt&&a&&{x:yt.x+a.x,y:yt.y+a.y,width:yt.width,height:yt.height}),256&t.$$.dirty[0]|4096&t.$$.dirty[3]|1&t.$$.dirty[4]&&i(21,x=Me&&!!w&&!h),65600&t.$$.dirty[3]|2097280&t.$$.dirty[4]&&i(10,k=nt&&!!s&&!Ut&&!Mt),512&t.$$.dirty[0]|1073741888&t.$$.dirty[3]|1048576&t.$$.dirty[4]&&m&&Ut&&!$t&&(clearTimeout(Si),i(123,Si=setTimeout(hn,Ut))),1073741824&t.$$.dirty[3]|1048576&t.$$.dirty[4]&&$t&&clearTimeout(Si),1536&t.$$.dirty[0]|32768&t.$$.dirty[4]&&Vi.set(k&&m?1:0,{hard:j===!1}),32896&t.$$.dirty[4]&&Lr.set(s,{hard:j===!1}),4096&t.$$.dirty[0]|262144&t.$$.dirty[4]&&(S&&!at?(vt(lo,U.crop={maskOpacity:Ti,maskMarkupOpacity:Ti},U),lo.set(U)):(delete U.crop,lo.set(U))),131072&t.$$.dirty[4]&&ht&&cr.update(I=>{const Te=I.filter(Ne=>!/^image\-selection\-guide/.test(Ne.id));return S?[...Te,...ht]:Te}),65536&t.$$.dirty[4]&&i(127,C=Q.verticalSpace!=="short"),134217728&t.$$.dirty[3]|9&t.$$.dirty[4]&&i(20,R=Le==="never"&&!h||C&&Le!=="always"),4&t.$$.dirty[0]|1024&t.$$.dirty[3]&&i(126,W=se&&At),2048&t.$$.dirty[3]|12&t.$$.dirty[4]&&i(125,T=re?C&&W:W),512&t.$$.dirty[3]|2&t.$$.dirty[4]&&i(19,F=be||T),2&t.$$.dirty[4]&&(T||i(5,Eo=Io)),32&t.$$.dirty[0]&&i(18,D={name:jo,selected:Eo}),16&t.$$.dirty[0]|512&t.$$.dirty[3]|2&t.$$.dirty[4]&&i(7,B=[be&&{id:jo+"-rotation",label:Ve.cropLabelTabRotation},T&&{id:jo+"-zoom",label:Ve.cropLabelTabZoom}].filter(Boolean)),128&t.$$.dirty[0]&&i(17,y=B.map(I=>I.id)),64&t.$$.dirty[0]|1&t.$$.dirty[4]&&Nr&&!Nr.children.length&&h&&Nr.dispatchEvent(new CustomEvent("measure",{detail:Nr.rect})),4096&t.$$.dirty[0]|32768&t.$$.dirty[4]&&j&&Hr.set(S?0:20),16384&t.$$.dirty[4]&&i(16,_=J?`transform: translateY(${J}px)`:void 0)},[mi,Li,se,gi,Ve,Eo,Nr,B,w,m,k,r,S,dt,Dt,Oa,_,y,D,F,R,x,f,o,wt,hi,bt,ne,Ue,Ee,jt,ri,Be,Se,Zi,un,wn,an,To,Oi,On,No,Kr,Mo,Ho,xr,br,lo,Po,Ro,_r,Jr,Ir,hr,vr,Wn,Wi,_i,lr,qi,Vr,co,Qr,mr,Fn,wr,uo,Kn,()=>{sn="select",vt(Oi,$t=!0,$t),vt(vr,Z=ki(xt),Z),Er=Mt?to:eo},({detail:I})=>{const{boundsLimited:Te,boundsIntent:Ne}=Er(I.direction,I.translation);vt(On,mt=!0,mt),vt(Wn,V=Ne,V),vt(hr,xt=Te,xt)},({detail:I})=>{const{boundsLimited:Te}=Er(I.direction,I.translation);vt(On,mt=!1,mt),vt(Oi,$t=!1,$t),vt(Wn,V=void 0,V),Ss(I.translation)&&(vt(hr,xt=Te,xt),yn.write()),vt(vr,Z=void 0,Z),sn=void 0},()=>{sn="rotate",vt(Oi,$t=!0,$t),vt(lr,ce=ki(dt),ce)},I=>{vt(On,mt=!0,mt),vt(_r,Dt=I,Dt)},I=>{vt(On,mt=!1,mt),vt(Oi,$t=!1,$t),vt(_r,Dt=I,Dt),yn.write(),vt(lr,ce=void 0,ce)},()=>{sn="pan",Ar=void 0,vt(Oi,$t=!0,$t),En=ki(dt)},({detail:I})=>{vt(On,mt=!0,mt),O(I)},({detail:I})=>{vt(On,mt=!1,mt),vt(Oi,$t=!1,$t),(Ss(I.translation)>0||I.scalar!==0)&&(O(I),yn.write()),vt(_i,ut=void 0,ut),En=void 0},({detail:{translation:I}})=>{Mt&&(I=El(Oe(I))),Ar=I,vt(Oi,$t=!1,$t)},de,wi,je,()=>{sn="zoom",vt(Oi,$t=!0,$t),En=ki(dt)},I=>{vt(On,mt=!1,mt),Pt(I)},I=>{Pt(I),yn.write(),vt(On,mt=!1,mt),vt(Oi,$t=!1,$t),En=void 0},()=>{sn="zoom",En||(fe=ki(dt),vt(Oi,$t=!0,$t))},({detail:I})=>{fe&&(vt(On,mt=!0,mt),xi(I))},({detail:I})=>{fe&&(vt(On,mt=!1,mt),vt(Oi,$t=!1,$t),xi(I),vt(_i,ut=void 0,ut),fe=void 0,yn.write())},I=>{const Te=sh(I,wt,it);if(Ze&&!du(xt,Te))return;sn="zoom",vt(Oi,$t=!0,$t),vt(On,mt=!0,mt),I.preventDefault(),I.stopPropagation();const Ne=Au(I,{fixScrollDirection:G}),fi=1+Ne/100,Di=ki(dt),Ni=Math.min(dt.width/ae.width,dt.height/ae.height)===1;if(H&&Ot){const Ei=Rr(dt,ie,Dt);if(Mn()&&Ei&&Ne>0&&d){vt(Oi,$t=!1,$t),vt(On,mt=!1,mt);const zi=za(Dt)?Or({height:ie.width,width:ie.height}):Or(ie);return ea(Di,zi)||(clearTimeout(Gi),ea(yn.state.crop,zi))?void 0:(vt(qi,dt=zi,dt),void yn.write())}}let ti=Ci(dt);if(_e&&Gt!=="selection"&&Ne<0&&!Ni){const Ei=Bn(Oe(Te),xt),zi=Math.min(xt.width/dt.width,xt.height/dt.height),mn=Cr(ki(xt),1.1);ti=du(mn,Te)?Dn(ki(dt),Tr(Ei,1/zi)):ti}let oi=Cr(ki(dt),fi,ti);if(cu(Ft[1],oi)||(oi=$m(Ci(oi),Ft[1])),cu(oi,Ft[0])||(oi=$m(Ci(oi),Ft[0])),ea(Di,oi,ai))return vt(Oi,$t=!1,$t),void vt(On,mt=!1,mt);vt(qi,dt=Oo(oi,Ei=>ai(Ei,5)),dt),vt(Oi,$t=!1,$t),vt(On,mt=!1,mt),clearTimeout(Gi),Gi=setTimeout(()=>{yn.write()},500)},hn,Vi,Lr,da,Ta,jo,Hr,ye,"crop",$i,X,Ut,H,Bt,be,At,re,Me,De,_e,Ze,nt,Qt,Zt,Kt,Yt,st,le,ee,Xe,$e,vi,Le,Gt,Ti,Si,h,T,W,C,P,n,a,s,g,d,u,c,p,l,J,j,Q,ht,at,yt,$t,Mt,Tt,K,q,Z,xt,it,ie,Ot,ae,xe,_t,ze,Ie,Fe,function(I){Wr.call(this,t,I)},({detail:I})=>i(5,Eo=I),function(I){Ai[I?"unshift":"push"](()=>{Nr=I,i(6,Nr)})},I=>t0(I),function(I){Oa=I,i(15,Oa)},function(I){Wr.call(this,t,I)}]}var fS={util:["crop",class extends li{constructor(t){super(),si(this,t,gS,hS,ni,{name:96,isActive:0,stores:97,cropImageSelectionCornerStyle:1,cropWillRenderImageSelectionGuides:98,cropAutoCenterImageSelectionTimeout:99,cropEnableZoomMatchImageAspectRatio:100,cropEnableRotateMatchImageAspectRatio:101,cropEnableRotationInput:102,cropEnableZoom:2,cropEnableZoomInput:103,cropEnableZoomAutoHide:104,cropEnableImageSelection:105,cropEnableInfoIndicator:106,cropEnableZoomTowardsWheelPosition:107,cropEnableLimitWheelInputToCropSelection:108,cropEnableCenterImageSelection:109,cropEnableButtonRotateLeft:110,cropEnableButtonRotateRight:111,cropEnableButtonFlipHorizontal:112,cropEnableButtonFlipVertical:113,cropSelectPresetOptions:114,cropEnableSelectPreset:115,cropEnableFilterMatchAspectRatio:116,cropSelectPresetFilter:95,cropEnableButtonToggleCropLimit:117,cropWillRenderTools:118,cropActiveTransformTool:119,cropMinimizeToolbar:120,cropInteractionFocus:121,cropRotationRange:3,cropMaskOpacity:122,locale:4},null,[-1,-1,-1,-1,-1,-1,-1,-1])}get name(){return this.$$.ctx[96]}get isActive(){return this.$$.ctx[0]}set isActive(t){this.$$set({isActive:t}),E()}get stores(){return this.$$.ctx[97]}set stores(t){this.$$set({stores:t}),E()}get cropImageSelectionCornerStyle(){return this.$$.ctx[1]}set cropImageSelectionCornerStyle(t){this.$$set({cropImageSelectionCornerStyle:t}),E()}get cropWillRenderImageSelectionGuides(){return this.$$.ctx[98]}set cropWillRenderImageSelectionGuides(t){this.$$set({cropWillRenderImageSelectionGuides:t}),E()}get cropAutoCenterImageSelectionTimeout(){return this.$$.ctx[99]}set cropAutoCenterImageSelectionTimeout(t){this.$$set({cropAutoCenterImageSelectionTimeout:t}),E()}get cropEnableZoomMatchImageAspectRatio(){return this.$$.ctx[100]}set cropEnableZoomMatchImageAspectRatio(t){this.$$set({cropEnableZoomMatchImageAspectRatio:t}),E()}get cropEnableRotateMatchImageAspectRatio(){return this.$$.ctx[101]}set cropEnableRotateMatchImageAspectRatio(t){this.$$set({cropEnableRotateMatchImageAspectRatio:t}),E()}get cropEnableRotationInput(){return this.$$.ctx[102]}set cropEnableRotationInput(t){this.$$set({cropEnableRotationInput:t}),E()}get cropEnableZoom(){return this.$$.ctx[2]}set cropEnableZoom(t){this.$$set({cropEnableZoom:t}),E()}get cropEnableZoomInput(){return this.$$.ctx[103]}set cropEnableZoomInput(t){this.$$set({cropEnableZoomInput:t}),E()}get cropEnableZoomAutoHide(){return this.$$.ctx[104]}set cropEnableZoomAutoHide(t){this.$$set({cropEnableZoomAutoHide:t}),E()}get cropEnableImageSelection(){return this.$$.ctx[105]}set cropEnableImageSelection(t){this.$$set({cropEnableImageSelection:t}),E()}get cropEnableInfoIndicator(){return this.$$.ctx[106]}set cropEnableInfoIndicator(t){this.$$set({cropEnableInfoIndicator:t}),E()}get cropEnableZoomTowardsWheelPosition(){return this.$$.ctx[107]}set cropEnableZoomTowardsWheelPosition(t){this.$$set({cropEnableZoomTowardsWheelPosition:t}),E()}get cropEnableLimitWheelInputToCropSelection(){return this.$$.ctx[108]}set cropEnableLimitWheelInputToCropSelection(t){this.$$set({cropEnableLimitWheelInputToCropSelection:t}),E()}get cropEnableCenterImageSelection(){return this.$$.ctx[109]}set cropEnableCenterImageSelection(t){this.$$set({cropEnableCenterImageSelection:t}),E()}get cropEnableButtonRotateLeft(){return this.$$.ctx[110]}set cropEnableButtonRotateLeft(t){this.$$set({cropEnableButtonRotateLeft:t}),E()}get cropEnableButtonRotateRight(){return this.$$.ctx[111]}set cropEnableButtonRotateRight(t){this.$$set({cropEnableButtonRotateRight:t}),E()}get cropEnableButtonFlipHorizontal(){return this.$$.ctx[112]}set cropEnableButtonFlipHorizontal(t){this.$$set({cropEnableButtonFlipHorizontal:t}),E()}get cropEnableButtonFlipVertical(){return this.$$.ctx[113]}set cropEnableButtonFlipVertical(t){this.$$set({cropEnableButtonFlipVertical:t}),E()}get cropSelectPresetOptions(){return this.$$.ctx[114]}set cropSelectPresetOptions(t){this.$$set({cropSelectPresetOptions:t}),E()}get cropEnableSelectPreset(){return this.$$.ctx[115]}set cropEnableSelectPreset(t){this.$$set({cropEnableSelectPreset:t}),E()}get cropEnableFilterMatchAspectRatio(){return this.$$.ctx[116]}set cropEnableFilterMatchAspectRatio(t){this.$$set({cropEnableFilterMatchAspectRatio:t}),E()}get cropSelectPresetFilter(){return this.$$.ctx[95]}set cropSelectPresetFilter(t){this.$$set({cropSelectPresetFilter:t}),E()}get cropEnableButtonToggleCropLimit(){return this.$$.ctx[117]}set cropEnableButtonToggleCropLimit(t){this.$$set({cropEnableButtonToggleCropLimit:t}),E()}get cropWillRenderTools(){return this.$$.ctx[118]}set cropWillRenderTools(t){this.$$set({cropWillRenderTools:t}),E()}get cropActiveTransformTool(){return this.$$.ctx[119]}set cropActiveTransformTool(t){this.$$set({cropActiveTransformTool:t}),E()}get cropMinimizeToolbar(){return this.$$.ctx[120]}set cropMinimizeToolbar(t){this.$$set({cropMinimizeToolbar:t}),E()}get cropInteractionFocus(){return this.$$.ctx[121]}set cropInteractionFocus(t){this.$$set({cropInteractionFocus:t}),E()}get cropRotationRange(){return this.$$.ctx[3]}set cropRotationRange(t){this.$$set({cropRotationRange:t}),E()}get cropMaskOpacity(){return this.$$.ctx[122]}set cropMaskOpacity(t){this.$$set({cropMaskOpacity:t}),E()}get locale(){return this.$$.ctx[4]}set locale(t){this.$$set({locale:t}),E()}}]};function yS(t){let e,i,n,r,o,a,s,l=t[77],c=(on(t[77].label)?t[77].label(t[2]):t[77].label)+"";function d(...h){return t[51](t[77],...h)}const u=()=>t[52](i,l),p=()=>t[52](null,l);return{c(){e=pt("div"),i=pt("div"),n=he(),r=pt("span"),o=gn(c),v(i,"class",Y2),v(e,"slot","option"),v(e,"class","PinturaFilterOption")},m(h,g){et(h,e,g),kt(e,i),u(),kt(e,n),kt(e,r),kt(r,o),a||(s=[Ct(i,"measure",d),Ui(dr.call(null,i))],a=!0)},p(h,g){l!==(t=h)[77]&&(p(),l=t[77],u()),4&g[0]|32768&g[2]&&c!==(c=(on(t[77].label)?t[77].label(t[2]):t[77].label)+"")&&zn(o,c)},d(h){h&&tt(e),p(),a=!1,Bi(s)}}}function xS(t){let e,i;return e=new ss({props:{locale:t[2],layout:"row",options:t[3],selectedIndex:t[12],onchange:t[32],$$slots:{option:[yS,({option:n})=>({77:n}),({option:n})=>[0,0,n?32768:0]]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};4&r[0]&&(o.locale=n[2]),8&r[0]&&(o.options=n[3]),4096&r[0]&&(o.selectedIndex=n[12]),1028&r[0]|98304&r[2]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function bS(t){let e,i,n,r,o,a,s,l;function c(h){t[54](h)}function d(h){t[55](h)}function u(h){t[56](h)}let p={elasticity:t[13]*t[19],onscroll:t[53],$$slots:{default:[xS]},$$scope:{ctx:t}};return t[4]!==void 0&&(p.maskFeatherStartOpacity=t[4]),t[5]!==void 0&&(p.maskFeatherEndOpacity=t[5]),t[6]!==void 0&&(p.maskFeatherSize=t[6]),i=new Ca({props:p}),Ai.push(()=>$o(i,"maskFeatherStartOpacity",c)),Ai.push(()=>$o(i,"maskFeatherEndOpacity",d)),Ai.push(()=>$o(i,"maskFeatherSize",u)),i.$on("measure",t[57]),{c(){e=pt("div"),Et(i.$$.fragment),v(e,"slot","footer"),v(e,"style",t[11])},m(h,g){et(h,e,g),Rt(i,e,null),a=!0,s||(l=[Ct(e,"transitionend",t[30]),Ct(e,"measure",t[58]),Ui(dr.call(null,e,{observePosition:!0}))],s=!0)},p(h,g){const m={};8192&g[0]&&(m.elasticity=h[13]*h[19]),128&g[0]&&(m.onscroll=h[53]),5132&g[0]|65536&g[2]&&(m.$$scope={dirty:g,ctx:h}),!n&&16&g[0]&&(n=!0,m.maskFeatherStartOpacity=h[4],ko(()=>n=!1)),!r&&32&g[0]&&(r=!0,m.maskFeatherEndOpacity=h[5],ko(()=>r=!1)),!o&&64&g[0]&&(o=!0,m.maskFeatherSize=h[6],ko(()=>o=!1)),i.$set(m),(!a||2048&g[0])&&v(e,"style",h[11])},i(h){a||(M(i.$$.fragment,h),a=!0)},o(h){z(i.$$.fragment,h),a=!1},d(h){h&&tt(e),It(i),s=!1,Bi(l)}}}function vS(t){let e,i;return e=new cl({props:{$$slots:{footer:[bS]},$$scope:{ctx:t}}}),e.$on("measure",t[59]),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};16380&r[0]|65536&r[2]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}let Y2="PinturaFilterPreview";function wS(t,e,i){let n,r,o,a,s,l,c,d,u,p,h,g,m,f,x,k,w,C,P,R,W=Ke,T=()=>(W(),W=Br(y,bt=>i(43,d=bt)),y),F=Ke,D=()=>(F(),F=Br(B,bt=>i(49,w=bt)),B);t.$$.on_destroy.push(()=>W()),t.$$.on_destroy.push(()=>F());let{isActive:B}=e;D();let{isActiveFraction:y}=e;T();let{stores:_}=e,{locale:J}=e,{filterFunctions:S}=e,{filterOptions:j}=e;const Q=dn("elasticityMultiplier");A(t,Q,bt=>i(13,R=bt));const{history:ht,interfaceImages:at,stageRectBase:U,utilRect:yt,animation:$t,scrollElasticity:Mt,imageSize:dt,imagePreview:Tt,imageCropRect:K,imageRotation:q,imageFlipX:Z,imageFlipY:xt,imageBackgroundColor:it,imageGamma:mt,imageColorMatrix:Ft,allowPan:ie,allowZoom:Dt,allowZoomControls:Ot,allowPlayPause:ae}=_;A(t,at,bt=>i(60,u=bt)),A(t,U,bt=>i(48,k=bt)),A(t,yt,bt=>i(47,x=bt)),A(t,$t,bt=>i(50,C=bt)),A(t,dt,bt=>i(62,h=bt)),A(t,Tt,bt=>i(42,c=bt)),A(t,it,bt=>i(61,p=bt)),A(t,mt,bt=>i(44,g=bt)),A(t,Ft,bt=>i(40,s=bt));const G=pe({});A(t,G,bt=>i(46,f=bt));const wt=(bt,ne)=>vt(G,f[bt.value]=ne,f),ut=Ii(G,bt=>{if(!bt[void 0])return;const ne=bt[void 0];return P&&zc(P,ne)?P:no(ne)});A(t,ut,bt=>i(63,P=bt));const Xt=Ii([B,ut,K,dt,q,Z,xt],([bt,ne,Ue,Ee,jt,Ge,Qe],mi)=>{if(!bt||!ne||!Ee)return m;const $i=Or(Ee),Li=Ci($i),X=_h(Ee,Ue,jt),Ut=Ci(X),H=Bn(Oe(Li),Ut),Bt=El(Oe(H)),be=Math.max(ne.width/Ue.width,ne.height/Ue.height);mi({origin:Bt,translation:H,rotation:{x:Qe?Math.PI:0,y:Ge?Math.PI:0,z:jt},scale:be})});A(t,Xt,bt=>i(45,m=bt));const ce=ci(C?20:0);let te;A(t,ce,bt=>i(39,a=bt));const ve={};let me,V,Ce,yi,xe,_t,ze={x:0,y:0};const Ie=pe([]);A(t,Ie,bt=>i(41,l=bt));const Fe=bt=>{const ne={...bt,data:c,size:h,offset:{...bt.offset},mask:{...bt.mask},backgroundColor:p};return ne.opacity=d,ne.offset.y+=a,ne.mask.y+=a,ne.id="filter",ne},hi=()=>u.filter(bt=>bt.id!=="filter");return Vo(()=>{at.set([])}),t.$$set=bt=>{"isActive"in bt&&D(i(0,B=bt.isActive)),"isActiveFraction"in bt&&T(i(1,y=bt.isActiveFraction)),"stores"in bt&&i(34,_=bt.stores),"locale"in bt&&i(2,J=bt.locale),"filterFunctions"in bt&&i(35,S=bt.filterFunctions),"filterOptions"in bt&&i(3,j=bt.filterOptions)},t.$$.update=()=>{if(262144&t.$$.dirty[1]&&ie.set(w),262144&t.$$.dirty[1]&&Dt.set(w),262144&t.$$.dirty[1]&&Ot.set(w),262144&t.$$.dirty[1]&&w&&ae.set(!1),8&t.$$.dirty[0]&&i(38,n=Ts(j)),640&t.$$.dirty[1]&&i(12,r=((bt,ne)=>{if(!bt||!bt.filter||!ne)return 0;const Ue=bt.filter;return ne.findIndex(([Ee])=>{if(!S[Ee])return!1;const jt=S[Ee]();return as(jt,Ue)})})(s,n)),786432&t.$$.dirty[1]&&C&&ce.set(w?0:20),512&t.$$.dirty[0]|458752&t.$$.dirty[1]&&w&&x&&k&&_t&&i(37,xe={x:k.x-x.x,y:k.y-x.y+_t.y}),496&t.$$.dirty[0]|58096&t.$$.dirty[1]&&m&&xe&&ze&&yi&&te){const bt=xe.x+yi.x+ze.x,ne=xe.y,Ue=yi.x+xe.x,Ee=Ue+yi.width;Ie.set(n.map(([jt],Ge)=>{const Qe=f[jt],mi=ze.x+Qe.x,$i=mi+Qe.width;if($i<0||mi>yi.width)return!1;const Li=bt+Qe.x,X=ne+Qe.y,Ut=(Bt=>({origin:Oe(Bt.origin),translation:Oe(Bt.translation),rotation:{...Bt.rotation},scale:Bt.scale}))(m);Ut.offset=rt(.5*Qe.width+Li,.5*Qe.height+X),Ut.maskOpacity=1,Ut.mask=An(Li+0,X,Qe.width+0,Qe.height),Ut.maskFeather=[1,0,1,0,1,Ee,1,Ee],mi<Ce&&me<1&&(Ut.maskFeather[0]=me,Ut.maskFeather[1]=Ue,Ut.maskFeather[2]=1,Ut.maskFeather[3]=Ue+Ce),$i>yi.width-Ce&&V<1&&(Ut.maskFeather[4]=V,Ut.maskFeather[5]=Ee-Ce,Ut.maskFeather[6]=1,Ut.maskFeather[7]=Ee),Ut.maskCornerRadius=te[jt];let H=s&&Object.keys(s).filter(Bt=>Bt!="filter").map(Bt=>s[Bt])||[];return on(S[jt])&&H.push(S[jt]()),Ut.colorMatrix=H.length?Dh(H):void 0,Ut.gamma=g,Ut}).filter(Boolean))}if(7424&t.$$.dirty[1])if(d>0&&l){const bt=[...hi(),...l.map(Fe)];at.set(bt)}else at.set(hi());256&t.$$.dirty[1]&&i(11,o=a?`transform: translateY(${a}px)`:void 0)},[B,y,J,j,me,V,Ce,ze,yi,_t,ve,o,r,R,Q,at,U,yt,$t,Mt,dt,Tt,it,mt,Ft,G,wt,ut,Xt,ce,bt=>{bt.target.className===Y2&&i(36,te=Object.keys(ve).reduce((ne,Ue)=>{const Ee=ve[Ue],jt=getComputedStyle(Ee),Ge=["top-left","top-right","bottom-left","bottom-right"].map(Qe=>jt.getPropertyValue(`border-${Qe}-radius`)).map(v2).map(Qe=>1.25*Qe);return ne[Ue]=Ge,ne},{}))},Ie,({value:bt})=>{vt(Ft,s={...s,filter:on(S[bt])?S[bt]():void 0},s),ht.write()},"filter",_,S,te,xe,n,a,s,l,c,d,g,m,f,x,k,w,C,(bt,ne)=>wt(bt,ne.detail),function(bt,ne){Ai[bt?"unshift":"push"](()=>{ve[ne.value]=bt,i(10,ve)})},bt=>i(7,ze=bt),function(bt){me=bt,i(4,me)},function(bt){V=bt,i(5,V)},function(bt){Ce=bt,i(6,Ce)},bt=>i(8,yi=bt.detail),bt=>i(9,_t=bt.detail),function(bt){Wr.call(this,t,bt)}]}var SS={util:["filter",class extends li{constructor(t){super(),si(this,t,wS,vS,ni,{name:33,isActive:0,isActiveFraction:1,stores:34,locale:2,filterFunctions:35,filterOptions:3},null,[-1,-1,-1])}get name(){return this.$$.ctx[33]}get isActive(){return this.$$.ctx[0]}set isActive(t){this.$$set({isActive:t}),E()}get isActiveFraction(){return this.$$.ctx[1]}set isActiveFraction(t){this.$$set({isActiveFraction:t}),E()}get stores(){return this.$$.ctx[34]}set stores(t){this.$$set({stores:t}),E()}get locale(){return this.$$.ctx[2]}set locale(t){this.$$set({locale:t}),E()}get filterFunctions(){return this.$$.ctx[35]}set filterFunctions(t){this.$$set({filterFunctions:t}),E()}get filterOptions(){return this.$$.ctx[3]}set filterOptions(t){this.$$set({filterOptions:t}),E()}}]};function pf(t){let e,i,n,r;e=new Ca({props:{elasticity:t[6]*t[9],class:"PinturaControlListScroller",$$slots:{default:[CS]},$$scope:{ctx:t}}});const o=[{class:"PinturaControlPanels"},{panelClass:"PinturaControlPanel"},{panels:t[4]},t[5]];let a={$$slots:{default:[TS,({panel:s})=>({42:s}),({panel:s})=>[0,s?2048:0]]},$$scope:{ctx:t}};for(let s=0;s<o.length;s+=1)a=In(a,o[s]);return n=new Eu({props:a}),{c(){Et(e.$$.fragment),i=he(),Et(n.$$.fragment)},m(s,l){Rt(e,s,l),et(s,i,l),Rt(n,s,l),r=!0},p(s,l){const c={};64&l[0]&&(c.elasticity=s[6]*s[9]),38&l[0]|8192&l[1]&&(c.$$scope={dirty:l,ctx:s}),e.$set(c);const d=48&l[0]?yr(o,[o[0],o[1],16&l[0]&&{panels:s[4]},32&l[0]&&Pr(s[5])]):{};128&l[0]|10240&l[1]&&(d.$$scope={dirty:l,ctx:s}),n.$set(d)},i(s){r||(M(e.$$.fragment,s),M(n.$$.fragment,s),r=!0)},o(s){z(e.$$.fragment,s),z(n.$$.fragment,s),r=!1},d(s){It(e,s),s&&tt(i),It(n,s)}}}function kS(t){let e,i,n=t[43].label+"";return{c(){e=pt("span"),i=gn(n)},m(r,o){et(r,e,o),kt(e,i)},p(r,o){4096&o[1]&&n!==(n=r[43].label+"")&&zn(i,n)},d(r){r&&tt(e)}}}function CS(t){let e,i;const n=[{class:"PinturaControlList"},{tabs:t[1]},t[5]];let r={$$slots:{default:[kS,({tab:o})=>({43:o}),({tab:o})=>[0,o?4096:0]]},$$scope:{ctx:t}};for(let o=0;o<n.length;o+=1)r=In(r,n[o]);return e=new Iu({props:r}),e.$on("select",t[24]),{c(){Et(e.$$.fragment)},m(o,a){Rt(e,o,a),i=!0},p(o,a){const s=34&a[0]?yr(n,[n[0],2&a[0]&&{tabs:o[1]},32&a[0]&&Pr(o[5])]):{};12288&a[1]&&(s.$$scope={dirty:a,ctx:o}),e.$set(s)},i(o){i||(M(e.$$.fragment,o),i=!0)},o(o){z(e.$$.fragment,o),i=!1},d(o){It(e,o)}}}function TS(t){let e,i;const n=[t[7][t[42]]];let r={};for(let o=0;o<n.length;o+=1)r=In(r,n[o]);return e=new e0({props:r}),{c(){Et(e.$$.fragment)},m(o,a){Rt(e,o,a),i=!0},p(o,a){const s=128&a[0]|2048&a[1]?yr(n,[Pr(o[7][o[42]])]):{};e.$set(s)},i(o){i||(M(e.$$.fragment,o),i=!0)},o(o){z(e.$$.fragment,o),i=!1},d(o){It(e,o)}}}function MS(t){let e,i,n=t[5]&&pf(t);return{c(){e=pt("div"),n&&n.c(),v(e,"slot","footer"),v(e,"style",t[3])},m(r,o){et(r,e,o),n&&n.m(e,null),i=!0},p(r,o){r[5]?n?(n.p(r,o),32&o[0]&&M(n,1)):(n=pf(r),n.c(),M(n,1),n.m(e,null)):n&&(Pe(),z(n,1,1,()=>{n=null}),Re()),(!i||8&o[0])&&v(e,"style",r[3])},i(r){i||(M(n),i=!0)},o(r){z(n),i=!1},d(r){r&&tt(e),n&&n.d()}}}function PS(t){let e,i;return e=new cl({props:{$$slots:{footer:[MS]},$$scope:{ctx:t}}}),e.$on("measure",t[25]),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};254&r[0]|8192&r[1]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function RS(t,e,i){let n,r,o,a,s,l,c,d,u,p,h,g=Ke,m=()=>(g(),g=Br(x,K=>i(21,c=K)),x);t.$$.on_destroy.push(()=>g());let{stores:f}=e,{isActive:x}=e;m();let{locale:k={}}=e,{finetuneControlConfiguration:w}=e,{finetuneOptions:C}=e,{finetuneNudgePrecision:P}=e;const{history:R,animation:W,scrollElasticity:T,rangeInputElasticity:F,imageColorMatrix:D,imageConvolutionMatrix:B,imageGamma:y,imageVignette:_,imageNoise:J,allowPan:S,allowZoom:j,allowZoomControls:Q,allowPlayPause:ht}=f;A(t,W,K=>i(22,d=K));const at={imageColorMatrix:D,imageConvolutionMatrix:B,imageGamma:y,imageVignette:_,imageNoise:J},U=dn("elasticityMultiplier");A(t,U,K=>i(6,p=K));const yt="finetune-"+na(),$t=pe({});A(t,$t,K=>i(23,u=K));const Mt=pe({});A(t,Mt,K=>i(7,h=K));let dt=[];const Tt=ci(d?20:0);return A(t,Tt,K=>i(20,l=K)),t.$$set=K=>{"stores"in K&&i(15,f=K.stores),"isActive"in K&&m(i(0,x=K.isActive)),"locale"in K&&i(16,k=K.locale),"finetuneControlConfiguration"in K&&i(17,w=K.finetuneControlConfiguration),"finetuneOptions"in K&&i(18,C=K.finetuneOptions),"finetuneNudgePrecision"in K&&i(19,P=K.finetuneNudgePrecision)},t.$$.update=()=>{var K;2097152&t.$$.dirty[0]&&S.set(c),2097152&t.$$.dirty[0]&&j.set(c),2097152&t.$$.dirty[0]&&Q.set(c),2097152&t.$$.dirty[0]&&c&&ht.set(!0),327680&t.$$.dirty[0]&&i(1,n=C?C.map(([q,Z])=>({id:q,label:on(Z)?Z(k):Z})):[]),2&t.$$.dirty[0]&&i(2,r=n.length?n[0].id:void 0),4&t.$$.dirty[0]&&i(5,o=r&&{name:yt,selected:r}),2&t.$$.dirty[0]&&i(4,a=n.map(q=>q.id)),131072&t.$$.dirty[0]&&w&&(K=w,dt&&dt.forEach(q=>q()),dt=a.map(q=>{const{getStore:Z,getValue:xt=Yi}=K[q];return Z(at).subscribe(it=>{const mt=it!=null?xt(it):it;vt($t,u={...u,[q]:mt},u)})})),8519680&t.$$.dirty[0]&&w&&u&&vt(Mt,h=Object.keys(u).reduce((q,Z)=>{const{base:xt,min:it,max:mt,getLabel:Ft,getStore:ie,setValue:Dt=(G,wt)=>G.set(wt)}=w[Z],Ot=ie(at),ae=u[Z]!=null?u[Z]:xt;return q[Z]={base:xt,min:it,max:mt,value:ae,valueLabel:Ft?Ft(ae,it,mt,mt-it):Math.round(100*ae),oninputmove:G=>{Dt(Ot,G)},oninputend:G=>{Dt(Ot,G),R.write()},elasticity:p*F,labelReset:k.labelReset,nudgeMultiplier:P},q},{}),h),6291456&t.$$.dirty[0]&&d&&Tt.set(c?0:20),1048576&t.$$.dirty[0]&&i(3,s=l?`transform: translateY(${l}px)`:void 0)},[x,n,r,s,a,o,p,h,W,T,U,$t,Mt,Tt,"finetune",f,k,w,C,P,l,c,d,u,({detail:K})=>i(2,r=K),function(K){Wr.call(this,t,K)}]}var IS={util:["finetune",class extends li{constructor(t){super(),si(this,t,RS,PS,ni,{name:14,stores:15,isActive:0,locale:16,finetuneControlConfiguration:17,finetuneOptions:18,finetuneNudgePrecision:19},null,[-1,-1])}get name(){return this.$$.ctx[14]}get stores(){return this.$$.ctx[15]}set stores(t){this.$$set({stores:t}),E()}get isActive(){return this.$$.ctx[0]}set isActive(t){this.$$set({isActive:t}),E()}get locale(){return this.$$.ctx[16]}set locale(t){this.$$set({locale:t}),E()}get finetuneControlConfiguration(){return this.$$.ctx[17]}set finetuneControlConfiguration(t){this.$$set({finetuneControlConfiguration:t}),E()}get finetuneOptions(){return this.$$.ctx[18]}set finetuneOptions(t){this.$$set({finetuneOptions:t}),E()}get finetuneNudgePrecision(){return this.$$.ctx[19]}set finetuneNudgePrecision(t){this.$$set({finetuneNudgePrecision:t}),E()}}]},vu=(t,e)=>{const i=e.length;return t<0?t%i+i:t>=i?t%i:t};function hf(t,e,i){const n=t.slice();return n[46]=e[i].key,n[47]=e[i].index,n[48]=e[i].translate,n[49]=e[i].scale,n[50]=e[i].selected,n[12]=e[i].rotate,n[51]=e[i].dir,n[52]=e[i].center,n[53]=e[i].type,n[2]=e[i].visible,n}function mf(t){let e,i;return{c(){e=pt("div"),v(e,"class","PinturaShapeManipulator"),v(e,"data-control","point"),v(e,"style",i=`pointer-events:none;transform: translate3d(${t[52].x}px, ${t[52].y}px, 0) scale(${t[5]}, ${t[5]}); opacity: ${t[4]}`)},m(n,r){et(n,e,r)},p(n,r){56&r[0]&&i!==(i=`pointer-events:none;transform: translate3d(${n[52].x}px, ${n[52].y}px, 0) scale(${n[5]}, ${n[5]}); opacity: ${n[4]}`)&&v(e,"style",i)},d(n){n&&tt(e)}}}function $f(t,e){let i,n,r,o,a,s,l,c,d,u;function p(...g){return e[18](e[47],...g)}let h=e[53]==="edge"&&e[2]&&mf(e);return{key:t,first:null,c(){i=pt("div"),l=he(),h&&h.c(),c=Tn(),v(i,"role","button"),v(i,"aria-label",n=`Drag ${e[53]} ${e[46]}`),v(i,"tabindex",r=e[53]==="edge"?-1:0),v(i,"class","PinturaShapeManipulator"),v(i,"data-control",o=e[53]),v(i,"data-selected",a=e[50]),v(i,"style",s=`cursor:${e[51]?e[51]+"-resize":"move"};opacity:${e[4]};--tx:${e[48].x};--ty:${e[48].y};--r:${e[53]==="edge"?e[12]:0}rad;--sx:${e[53]==="point"?e[5]:e[49].x};--sy:${e[53]==="point"?e[5]:e[49].y};`),this.first=i},m(g,m){et(g,i,m),et(g,l,m),h&&h.m(g,m),et(g,c,m),d||(u=[Ct(i,"nudge",p),Ui(Bs.call(null,i,{preventDefault:!0})),Ct(i,"interactionstart",function(){ji(e[9]("start",e[47]))&&e[9]("start",e[47]).apply(this,arguments)}),Ct(i,"interactionupdate",function(){ji(e[9]("move",e[47]))&&e[9]("move",e[47]).apply(this,arguments)}),Ct(i,"interactionend",function(){ji(e[9]("end",e[47]))&&e[9]("end",e[47]).apply(this,arguments)}),Ui(Ds.call(null,i,{observeKeys:!0}))],d=!0)},p(g,m){e=g,8&m[0]&&n!==(n=`Drag ${e[53]} ${e[46]}`)&&v(i,"aria-label",n),8&m[0]&&r!==(r=e[53]==="edge"?-1:0)&&v(i,"tabindex",r),8&m[0]&&o!==(o=e[53])&&v(i,"data-control",o),8&m[0]&&a!==(a=e[50])&&v(i,"data-selected",a),56&m[0]&&s!==(s=`cursor:${e[51]?e[51]+"-resize":"move"};opacity:${e[4]};--tx:${e[48].x};--ty:${e[48].y};--r:${e[53]==="edge"?e[12]:0}rad;--sx:${e[53]==="point"?e[5]:e[49].x};--sy:${e[53]==="point"?e[5]:e[49].y};`)&&v(i,"style",s),e[53]==="edge"&&e[2]?h?h.p(e,m):(h=mf(e),h.c(),h.m(c.parentNode,c)):h&&(h.d(1),h=null)},d(g){g&&tt(i),g&&tt(l),h&&h.d(g),g&&tt(c),d=!1,Bi(u)}}}function gf(t){let e,i,n,r;return{c(){e=pt("div"),v(e,"role","button"),v(e,"aria-label","Drag rotator"),v(e,"tabindex","0"),v(e,"class","PinturaShapeManipulator"),v(e,"data-control","rotate"),v(e,"style",i=`transform: translate3d(${t[0].x}px, ${t[0].y}px, 0) scale(${t[5]}, ${t[5]}); opacity: ${t[4]}`)},m(o,a){et(o,e,a),n||(r=[Ct(e,"nudge",t[11]),Ui(Bs.call(null,e,{preventDefault:!0})),Ct(e,"interactionstart",t[12]("start")),Ct(e,"interactionupdate",t[12]("move")),Ct(e,"interactionend",t[12]("end")),Ui(Ds.call(null,e,{observeKeys:!0}))],n=!0)},p(o,a){49&a[0]&&i!==(i=`transform: translate3d(${o[0].x}px, ${o[0].y}px, 0) scale(${o[5]}, ${o[5]}); opacity: ${o[4]}`)&&v(e,"style",i)},d(o){o&&tt(e),n=!1,Bi(r)}}}function ES(t){let e,i,n=[],r=new Map,o=t[3];const a=l=>l[46];for(let l=0;l<o.length;l+=1){let c=hf(t,o,l),d=a(c);r.set(d,n[l]=$f(d,c))}let s=t[1]&&gf(t);return{c(){for(let l=0;l<n.length;l+=1)n[l].c();e=he(),s&&s.c(),i=Tn()},m(l,c){for(let d=0;d<n.length;d+=1)n[d].m(l,c);et(l,e,c),s&&s.m(l,c),et(l,i,c)},p(l,c){1592&c[0]&&(o=l[3],n=Ba(n,c,a,1,l,o,r,e.parentNode,Yy,$f,e,hf)),l[1]?s?s.p(l,c):(s=gf(l),s.c(),s.m(i.parentNode,i)):s&&(s.d(1),s=null)},i:Ke,o:Ke,d(l){for(let c=0;c<n.length;c+=1)n[c].d(l);l&&tt(e),s&&s.d(l),l&&tt(i)}}}function AS(t,e,i){let n,r,o,a;const s=ka(),l=.5*Qo,c=_o-l,d=_o+l,u=-_o,p=u-l,h=u+l,g=lp-l,m=-lp+l,f=l,x=-l,k=_o-Qo,w=k-l,C=k+l,P=lp-Qo,R=P-l,W=P+l,T=u-Qo,F=T+l,D=T-l,B=u+Qo,y=B+l,_=B-l;let{visible:J=!1}=e,{points:S=[]}=e,{rotatorPoint:j}=e,{selectedPoint:Q}=e,{enableDragEdges:ht=!0}=e,{enableDragPoints:at=!0}=e,{enableRotatePoints:U=!0}=e;const yt=dn("isAnimated");A(t,yt,K=>i(17,r=K));const $t=ci(.5,{precision:1e-4,stiffness:.3,damping:.7});A(t,$t,K=>i(5,a=K));const Mt=ci(0,{precision:.001,stiffness:.3,damping:.7});A(t,Mt,K=>i(4,o=K));const dt=K=>{let q="";return(K<=d&&K>=c||K>=p&&K<=h)&&(q="ns"),(K<=m||K>=g||K>=x&&K<=f)&&(q="ew"),(K>=R&&K<=W||K<=y&&K>=_)&&(q="nesw"),(K>=w&&K<=C||K<=F&&K>=D)&&(q="nwse"),q},Tt=(K,q)=>{s("resizestart",{indexes:K,translation:rn(),isNudge:!0}),s("resizemove",{indexes:K,translation:q,isNudge:!0}),s("resizeend",{indexes:K,translation:rn(),isNudge:!0})};return t.$$set=K=>{"visible"in K&&i(2,J=K.visible),"points"in K&&i(13,S=K.points),"rotatorPoint"in K&&i(0,j=K.rotatorPoint),"selectedPoint"in K&&i(14,Q=K.selectedPoint),"enableDragEdges"in K&&i(15,ht=K.enableDragEdges),"enableDragPoints"in K&&i(16,at=K.enableDragPoints),"enableRotatePoints"in K&&i(1,U=K.enableRotatePoints)},t.$$.update=()=>{131076&t.$$.dirty[0]&&$t.set(J?1:.5,{hard:r===!1}),131076&t.$$.dirty[0]&&Mt.set(J?1:0,{hard:r===!1}),8192&t.$$.dirty[0]&&i(3,n=((K,q)=>{let Z=0;const xt=Bo(K),it=[],mt=K.length;for(;Z<mt;Z++){const Ft=vu(Z-1,K),ie=vu(Z+1,K),Dt=K[Ft],Ot=K[Z],ae=K[ie],G=Math.atan2(ae.y-Ot.y,ae.x-Ot.x);if(at){const ut=ro(rt(Dt.x-Ot.x,Dt.y-Ot.y)),Xt=ro(rt(ae.x-Ot.x,ae.y-Ot.y)),ce=rt(ut.x+Xt.x,ut.y+Xt.y),te=ht?at&&dt(Math.atan2(ce.y,ce.x)):void 0;it.push({index:[Z],key:"point-"+Z,type:"point",selected:Q===Z,scale:{x:1,y:1},translate:{x:Ot.x,y:Ot.y},angle:void 0,rotate:U,center:Ot,dir:te})}if(!ht||Array.isArray(ht)&&!ht.some(([ut,Xt])=>Z===ut&&ie===Xt))continue;const wt=rt(Ot.x+.5*(ae.x-Ot.x),Ot.y+.5*(ae.y-Ot.y));it.push({index:[Z,ie],key:"edge-"+Z,type:"edge",scale:{x:mo(Ot,ae),y:1},translate:{x:Ot.x,y:Ot.y},angle:G,rotate:G,center:wt,visible:Array.isArray(ht),dir:dt(Math.atan2(xt.y-wt.y,xt.x-wt.x))})}return it})(S))},[j,U,J,n,o,a,yt,$t,Mt,(K,q)=>({detail:Z})=>{const xt=Z&&Z.translation?Z.translation:rt(0,0);s("resize"+K,{...Z,indexes:q,translation:xt})},Tt,({detail:K})=>{s("rotatestart",{translation:rn(),isNudge:!0}),s("rotatemove",{translation:K,isNudge:!0}),s("rotateend",{translation:rn(),isNudge:!0})},K=>({detail:q})=>{const Z=q&&q.translation?q.translation:rt(0,0);s("rotate"+K,{...q,translation:Z})},S,Q,ht,at,r,(K,{detail:q})=>Tt(K,q)]}class LS extends li{constructor(e){super(),si(this,e,AS,ES,ni,{visible:2,points:13,rotatorPoint:0,selectedPoint:14,enableDragEdges:15,enableDragPoints:16,enableRotatePoints:1},null,[-1,-1])}}var hh=(t,e)=>{const i=t0(t);return Bn(i,e)},Kd=t=>document.createTextNode(t),q2=t=>(Fa()&&t.endsWith("<div><br></div>")?t.replace(/<div><br><\/div>$/,"<br><br>"):t).replace(/<div><br><\/div>/g,"<br>").replace(/<\/div>/g,"").replace(/<div>/g,"<br>");function ff(t){let e,i;return{c(){e=pt("pre"),v(e,"class","PinturaContentEditable"),v(e,"style",i=t[7]+";position:absolute;z-index:-1;pointer-events:none;")},m(n,r){et(n,e,r),e.innerHTML=t[0]},p(n,r){1&r[0]&&(e.innerHTML=n[0]),128&r[0]&&i!==(i=n[7]+";position:absolute;z-index:-1;pointer-events:none;")&&v(e,"style",i)},d(n){n&&tt(e)}}}function zS(t){let e,i,n,r,o,a,s=t[8]&&ff(t);return{c(){s&&s.c(),e=he(),i=pt("pre"),v(i,"class","PinturaContentEditable"),v(i,"data-wrap-content",n=t[4]||t[5]?"wrap":"nowrap"),v(i,"contenteditable",""),v(i,"spellcheck",t[1]),v(i,"autocorrect",t[2]),v(i,"autocapitalize",t[3]),v(i,"style",r=t[8]?t[15](t[7]):t[7])},m(l,c){s&&s.m(l,c),et(l,e,c),et(l,i,c),t[26](i),o||(a=[Ct(i,"input",t[13]),Ct(i,"compositionend",t[12]),Ct(i,"paste",t[14]),Ct(i,"keydown",t[10]),Ct(i,"keyup",t[11]),Ct(i,"blur",t[9])],o=!0)},p(l,c){l[8]?s?s.p(l,c):(s=ff(l),s.c(),s.m(e.parentNode,e)):s&&(s.d(1),s=null),48&c[0]&&n!==(n=l[4]||l[5]?"wrap":"nowrap")&&v(i,"data-wrap-content",n),2&c[0]&&v(i,"spellcheck",l[1]),4&c[0]&&v(i,"autocorrect",l[2]),8&c[0]&&v(i,"autocapitalize",l[3]),384&c[0]&&r!==(r=l[8]?l[15](l[7]):l[7])&&v(i,"style",r)},i:Ke,o:Ke,d(l){s&&s.d(l),l&&tt(e),l&&tt(i),t[26](null),o=!1,Bi(a)}}}function FS(t,e,i){let n,r,{spellcheck:o="false"}=e,{autocorrect:a="off"}=e,{autocapitalize:s="off"}=e,{wrapLines:l=!0}=e,{allowNewline:c=!0}=e,{textFormat:d="text"}=e,{formatInput:u=Yi}=e,{formatPaste:p=Yi}=e,{style:h}=e,{innerHTML:g}=e,{oninput:m=ge}=e,{enableTextStyleShortcuts:f=!1}=e;const x=()=>{if(!w)return;const S=document.createRange();S.selectNodeContents(w);const j=D();j.removeAllRanges(),j.addRange(S)},k=ka();let w;document.execCommand("defaultParagraphSeparator",!1,"br");const C=S=>S.replace(/<\/?(?:i|b|em|u|s|strike|strong|font)>/,"").replace(/style=".*?"/g,"").replace(/\n/gim,"<br>"),P=()=>{i(0,g=w.innerHTML);const S=q2(g);k("input",S),m(S),requestAnimationFrame(()=>w&&w.scrollTo(0,0))},R=()=>{B(w);const S=d==="html"?w.innerHTML:C(w.innerHTML);i(6,w.innerHTML=u(S),w),y(w),P()},W={b:"bold",i:"italic",u:"underline",s:"strikethrough"},T=S=>{const j=vn("span");return j.dataset.bookmark=S,j},F=(S,j,Q)=>{const ht=T(Q);if(S.nodeType===Node.TEXT_NODE){const at=S.textContent;if(Q==="start"){const U=Kd(at.substr(0,j)),yt=Kd(at.substr(j));S.replaceWith(U,ht,yt)}else{const U=Kd(at.substr(0,j)),yt=Kd(at.substr(j));S.replaceWith(U,ht,yt)}}else S.nodeType===Node.ELEMENT_NODE&&S.insertBefore(ht,S.childNodes[j])},D=()=>{const S=w.getRootNode();return"getSelection"in S?S.getSelection():document.getSelection()},B=S=>{const j=D();if(!j.getRangeAt||!j.rangeCount)return;const Q=j.getRangeAt(0),{startOffset:ht,endOffset:at,startContainer:U,endContainer:yt}=Q;if(S.contains(Q.startContainer)&&S.contains(Q.endContainer))if(U.nodeType===Node.TEXT_NODE&&U===yt){const $t=U.textContent,Mt=$t.substr(0,ht),dt=T("start"),Tt=at-ht>0?$t.substr(ht,at):"",K=T("end"),q=$t.substr(at);U.replaceWith(Mt,dt,Tt,K,q)}else F(U,ht,"start"),F(yt,at+(U===yt?1:0),"end")},y=S=>{const j=_(S,"start"),Q=_(S,"end");if(!j||!Q)return;const ht=document.createRange();ht.setStart(j,0),ht.setEnd(Q,0);const at=D();at.removeAllRanges(),at.addRange(ht),j.remove(),Q.remove()},_=(S,j)=>{const Q=S.children;for(let ht=0;ht<Q.length;ht++){const at=Q[ht];if(at.dataset.bookmark===j)return at;if(at.children.length){const U=_(at,j);if(U)return U}}};let J;return t.$$set=S=>{"spellcheck"in S&&i(1,o=S.spellcheck),"autocorrect"in S&&i(2,a=S.autocorrect),"autocapitalize"in S&&i(3,s=S.autocapitalize),"wrapLines"in S&&i(4,l=S.wrapLines),"allowNewline"in S&&i(5,c=S.allowNewline),"textFormat"in S&&i(16,d=S.textFormat),"formatInput"in S&&i(17,u=S.formatInput),"formatPaste"in S&&i(18,p=S.formatPaste),"style"in S&&i(19,h=S.style),"innerHTML"in S&&i(0,g=S.innerHTML),"oninput"in S&&i(20,m=S.oninput),"enableTextStyleShortcuts"in S&&i(21,f=S.enableTextStyleShortcuts)},t.$$.update=()=>{var S;if(64&t.$$.dirty[0]&&i(25,n=!!w),33554433&t.$$.dirty[0]&&n&&g&&(S=g)!==w.innerHTML&&(i(6,w.innerHTML=S,w),w===document.activeElement&&x()),524336&t.$$.dirty[0])if(!l&&c){const j=h.includes(":right")?"text-indent:-100px!important":h.includes(":center")?"":"min-width:calc(100% + 100px)!important";i(7,J=h+";overflow:visible;"+j)}else i(7,J=h);524288&t.$$.dirty[0]&&i(8,r=h.includes("text-stroke"))},[g,o,a,s,l,c,w,J,r,()=>{k("blur")},S=>{if(/escape/i.test(S.code))return S.stopPropagation(),void k("cancel");const j=S.ctrlKey||S.metaKey;if(d==="html"&&j&&/b|i|u|s/.test(S.key))return f&&(Q=>{const ht=W[Q];ht&&document.execCommand(ht)})(S.key),void S.preventDefault();/enter/i.test(S.code)&&(S.stopPropagation(),S.isComposing||(j?k("confirm"):(c||S.preventDefault(),document.execCommand("insertLineBreak"),S.preventDefault())))},()=>{},S=>{S.data!==""&&R()},S=>{const{inputType:j}=S;j!=="insertCompositionText"&&j!=="deleteCompositionText"&&R()},S=>{S.preventDefault();const j=S.clipboardData.getData("text/plain"),Q=d==="html"?j:C(j),ht=p(Q);if(!ht.length)return;const at=D().getRangeAt(0);at.deleteContents(),at.insertNode(document.createTextNode(ht)),P()},S=>S.replace("-webkit-text-stroke","--text-stroke").replace("text-shadow","--text-shadow"),d,u,p,h,m,f,()=>R(),()=>w&&w.focus(),x,n,function(S){Ai[S?"unshift":"push"](()=>{w=S,i(6,w)})}]}class DS extends li{constructor(e){super(),si(this,e,FS,zS,ni,{spellcheck:1,autocorrect:2,autocapitalize:3,wrapLines:4,allowNewline:5,textFormat:16,formatInput:17,formatPaste:18,style:19,innerHTML:0,oninput:20,enableTextStyleShortcuts:21,confirm:22,focus:23,select:24},null,[-1,-1])}get spellcheck(){return this.$$.ctx[1]}set spellcheck(e){this.$$set({spellcheck:e}),E()}get autocorrect(){return this.$$.ctx[2]}set autocorrect(e){this.$$set({autocorrect:e}),E()}get autocapitalize(){return this.$$.ctx[3]}set autocapitalize(e){this.$$set({autocapitalize:e}),E()}get wrapLines(){return this.$$.ctx[4]}set wrapLines(e){this.$$set({wrapLines:e}),E()}get allowNewline(){return this.$$.ctx[5]}set allowNewline(e){this.$$set({allowNewline:e}),E()}get textFormat(){return this.$$.ctx[16]}set textFormat(e){this.$$set({textFormat:e}),E()}get formatInput(){return this.$$.ctx[17]}set formatInput(e){this.$$set({formatInput:e}),E()}get formatPaste(){return this.$$.ctx[18]}set formatPaste(e){this.$$set({formatPaste:e}),E()}get style(){return this.$$.ctx[19]}set style(e){this.$$set({style:e}),E()}get innerHTML(){return this.$$.ctx[0]}set innerHTML(e){this.$$set({innerHTML:e}),E()}get oninput(){return this.$$.ctx[20]}set oninput(e){this.$$set({oninput:e}),E()}get enableTextStyleShortcuts(){return this.$$.ctx[21]}set enableTextStyleShortcuts(e){this.$$set({enableTextStyleShortcuts:e}),E()}get confirm(){return this.$$.ctx[22]}get focus(){return this.$$.ctx[23]}get select(){return this.$$.ctx[24]}}const yf=["i","b","u","strike"].map(t=>({tag:t,tagOpen:new RegExp(`<${t}>`,"g"),tagClose:new RegExp(`</${t}>`,"g"),placeholderOpen:new RegExp(`___${t}O___`,"g"),placeholderClose:new RegExp(`___${t}C___`,"g")}));var BS=t=>t=((e,i=yf)=>(i.forEach(({tag:n,placeholderOpen:r,placeholderClose:o})=>{e=e.replace(r,`<${n}>`).replace(o,`</${n}>`)}),e))(t=(t=((e,i=yf)=>(i.forEach(({tag:n,tagOpen:r,tagClose:o})=>{e=e.replace(r,`___${n}O___`).replace(o,`___${n}C___`)}),e))(t)).replace(/ {2,}/g," ").replace(/\u00a0/g,"&nbsp;").split(`
`).join("<br>")),Jd=(t,e)=>We(t)?parseFloat(t)/100*e:t,vc=(t,e)=>({x:Dr(t.x,e.width),y:Dr(t.y,e.height)});function xf(t,e,i){const n=t.slice();return n[284]=e[i],n[286]=i,n}function bf(t,e){let i,n,r,o,a,s,l,c,d,u,p,h=e[284].name+"";function g(){return e[183](e[286])}return r=new Qh({props:{color:e[284].color}}),{key:t,first:null,c(){i=pt("li"),n=pt("button"),Et(r.$$.fragment),o=he(),a=pt("span"),s=gn(h),c=he(),v(n,"class","PinturaShapeListItem"),v(n,"type","button"),v(n,"aria-label",l="Select shape "+e[284].name),this.first=i},m(m,f){et(m,i,f),kt(i,n),Rt(r,n,null),kt(n,o),kt(n,a),kt(a,s),kt(i,c),d=!0,u||(p=Ct(n,"click",g),u=!0)},p(m,f){e=m;const x={};2097152&f[0]&&(x.color=e[284].color),r.$set(x),(!d||2097152&f[0])&&h!==(h=e[284].name+"")&&zn(s,h),(!d||2097152&f[0]&&l!==(l="Select shape "+e[284].name))&&v(n,"aria-label",l)},i(m){d||(M(r.$$.fragment,m),d=!0)},o(m){z(r.$$.fragment,m),d=!1},d(m){m&&tt(i),It(r),u=!1,p()}}}function vf(t){let e,i;return e=new LS({props:{visible:!0,points:t[12],rotatorPoint:t[27],selectedPoint:t[16],enableDragEdges:t[17],enableDragPoints:t[29],enableRotatePoints:t[14]}}),e.$on("resizestart",t[38]),e.$on("resizemove",t[39]),e.$on("resizeend",t[40]),e.$on("rotatestart",t[41]),e.$on("rotatemove",t[42]),e.$on("rotateend",t[43]),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};4096&r[0]&&(o.points=n[12]),134217728&r[0]&&(o.rotatorPoint=n[27]),65536&r[0]&&(o.selectedPoint=n[16]),131072&r[0]&&(o.enableDragEdges=n[17]),536870912&r[0]&&(o.enableDragPoints=n[29]),16384&r[0]&&(o.enableRotatePoints=n[14]),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function wf(t){let e,i,n,r;const o=[WS,OS],a=[];function s(l,c){return l[4]==="modal"?0:l[4]==="inline"?1:-1}return~(e=s(t))&&(i=a[e]=o[e](t)),{c(){i&&i.c(),n=Tn()},m(l,c){~e&&a[e].m(l,c),et(l,n,c),r=!0},p(l,c){let d=e;e=s(l),e===d?~e&&a[e].p(l,c):(i&&(Pe(),z(a[d],1,1,()=>{a[d]=null}),Re()),~e?(i=a[e],i?i.p(l,c):(i=a[e]=o[e](l),i.c()),M(i,1),i.m(n.parentNode,n)):i=null)},i(l){r||(M(i),r=!0)},o(l){z(i),r=!1},d(l){~e&&a[e].d(l),l&&tt(n)}}}function OS(t){let e,i,n,r,o,a={formatInput:t[45],wrapLines:!!t[13].width,textFormat:t[13].format,enableTextStyleShortcuts:t[5],allowNewline:t[28],style:t[26]};return i=new DS({props:a}),t[186](i),i.$on("input",t[46]),i.$on("keyup",t[49]),i.$on("cancel",t[51]),i.$on("confirm",t[50]),{c(){e=pt("div"),Et(i.$$.fragment),v(e,"class","PinturaInlineInput"),v(e,"style",t[25])},m(s,l){et(s,e,l),Rt(i,e,null),n=!0,r||(o=Ct(e,"focusout",t[187]),r=!0)},p(s,l){const c={};8192&l[0]&&(c.wrapLines=!!s[13].width),8192&l[0]&&(c.textFormat=s[13].format),32&l[0]&&(c.enableTextStyleShortcuts=s[5]),268435456&l[0]&&(c.allowNewline=s[28]),67108864&l[0]&&(c.style=s[26]),i.$set(c),(!n||33554432&l[0])&&v(e,"style",s[25])},i(s){n||(M(i.$$.fragment,s),n=!0)},o(s){z(i.$$.fragment,s),n=!1},d(s){s&&tt(e),t[186](null),It(i),r=!1,o()}}}function WS(t){let e,i;return e=new L2({props:{panelOffset:t[2],onconfirm:t[50],oncancel:t[51],buttonCancel:{icon:t[6].shapeIconInputCancel,label:t[6].shapeLabelInputCancel},buttonConfirm:{icon:t[6].shapeIconInputConfirm,label:t[6].shapeLabelInputConfirm,hideLabel:!0},$$slots:{default:[_S]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};4&r[0]&&(o.panelOffset=n[2]),64&r[0]&&(o.buttonCancel={icon:n[6].shapeIconInputCancel,label:n[6].shapeLabelInputCancel}),64&r[0]&&(o.buttonConfirm={icon:n[6].shapeIconInputConfirm,label:n[6].shapeLabelInputConfirm,hideLabel:!0}),83886336&r[0]|256&r[9]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function _S(t){let e,i,n;return{c(){e=pt("textarea"),v(e,"spellcheck","false"),v(e,"autocorrect","off"),v(e,"autocapitalize","off"),v(e,"style",t[26])},m(r,o){et(r,e,o),t[184](e),Ym(e,t[24]),i||(n=[Ct(e,"keydown",t[48]),Ct(e,"keypress",t[47]),Ct(e,"keyup",t[49]),Ct(e,"input",t[46]),Ct(e,"input",t[185])],i=!0)},p(r,o){67108864&o[0]&&v(e,"style",r[26]),16777216&o[0]&&Ym(e,r[24])},d(r){r&&tt(e),t[184](null),i=!1,Bi(n)}}}function Sf(t){let e,i,n,r,o;return i=new oo({props:{items:t[22],key:t[10]}}),{c(){e=pt("div"),Et(i.$$.fragment),v(e,"class","PinturaShapeControls"),v(e,"style",t[23])},m(a,s){et(a,e,s),Rt(i,e,null),n=!0,r||(o=[Ct(e,"measure",t[188]),Ui(dr.call(null,e))],r=!0)},p(a,s){const l={};4194304&s[0]&&(l.items=a[22]),1024&s[0]&&(l.key=a[10]),i.$set(l),(!n||8388608&s[0])&&v(e,"style",a[23])},i(a){n||(M(i.$$.fragment,a),n=!0)},o(a){z(i.$$.fragment,a),n=!1},d(a){a&&tt(e),It(i),r=!1,Bi(o)}}}function VS(t){let e,i,n,r,o,a,s,l,c,d,u=[],p=new Map,h=t[21];const g=k=>k[284].id;for(let k=0;k<h.length;k+=1){let w=xf(t,h,k),C=g(w);p.set(C,u[k]=bf(C,w))}let m=t[15]&&vf(t),f=t[11]&&wf(t),x=t[18]>0&&Sf(t);return{c(){e=pt("div"),i=pt("nav"),n=pt("ul");for(let k=0;k<u.length;k+=1)u[k].c();r=he(),m&&m.c(),o=he(),f&&f.c(),a=he(),x&&x.c(),v(i,"class","PinturaShapeList"),v(i,"data-visible",t[19]),v(e,"class","PinturaShapeEditor"),v(e,"tabindex","0")},m(k,w){et(k,e,w),kt(e,i),kt(i,n);for(let C=0;C<u.length;C+=1)u[C].m(n,null);kt(e,r),m&&m.m(e,null),kt(e,o),f&&f.m(e,null),kt(e,a),x&&x.m(e,null),t[189](e),l=!0,c||(d=[Ct(i,"focusin",t[54]),Ct(i,"focusout",t[55]),Ct(e,"keydown",function(){ji(t[0]?ge:t[44])&&(t[0]?ge:t[44]).apply(this,arguments)}),Ct(e,"nudge",function(){ji(t[0]?ge:t[53])&&(t[0]?ge:t[53]).apply(this,arguments)}),Ct(e,"measure",t[182]),Ct(e,"pointermove",function(){ji(t[0]?ge:t[56])&&(t[0]?ge:t[56]).apply(this,arguments)}),Ct(e,"pointerleave",function(){ji(t[0]?ge:t[57])&&(t[0]?ge:t[57]).apply(this,arguments)}),Ct(e,"interactionstart",function(){ji(t[0]?ge:t[32])&&(t[0]?ge:t[32]).apply(this,arguments)}),Ct(e,"interactionupdate",function(){ji(t[0]?ge:t[34])&&(t[0]?ge:t[34]).apply(this,arguments)}),Ct(e,"interactioncancel",function(){ji(t[0]?ge:t[33])&&(t[0]?ge:t[33]).apply(this,arguments)}),Ct(e,"interactionrelease",function(){ji(t[0]?ge:t[35])&&(t[0]?ge:t[35]).apply(this,arguments)}),Ct(e,"interactionend",function(){ji(t[0]?ge:t[36])&&(t[0]?ge:t[36]).apply(this,arguments)}),Ui(dr.call(null,e)),Ui(Bs.call(null,e)),Ui(s=Ds.call(null,e,{drag:!0,inertia:!0,multiTouch:!1,observeKeys:!0,shouldStartInteraction:kf,getEventPosition:t[190]}))],c=!0)},p(k,w){t=k,2097282&w[0]&&(h=t[21],Pe(),u=Ba(u,w,g,1,t,h,p,n,zs,bf,null,xf),Re()),(!l||524288&w[0])&&v(i,"data-visible",t[19]),t[15]?m?(m.p(t,w),32768&w[0]&&M(m,1)):(m=vf(t),m.c(),M(m,1),m.m(e,o)):m&&(Pe(),z(m,1,1,()=>{m=null}),Re()),t[11]?f?(f.p(t,w),2048&w[0]&&M(f,1)):(f=wf(t),f.c(),M(f,1),f.m(e,a)):f&&(Pe(),z(f,1,1,()=>{f=null}),Re()),t[18]>0?x?(x.p(t,w),262144&w[0]&&M(x,1)):(x=Sf(t),x.c(),M(x,1),x.m(e,null)):x&&(Pe(),z(x,1,1,()=>{x=null}),Re()),s&&ji(s.update)&&8&w[0]&&s.update.call(null,{drag:!0,inertia:!0,multiTouch:!1,observeKeys:!0,shouldStartInteraction:kf,getEventPosition:t[190]})},i(k){if(!l){for(let w=0;w<h.length;w+=1)M(u[w]);M(m),M(f),M(x),l=!0}},o(k){for(let w=0;w<u.length;w+=1)z(u[w]);z(m),z(f),z(x),l=!1},d(k){k&&tt(e);for(let w=0;w<u.length;w+=1)u[w].d();m&&m.d(),f&&f.d(),x&&x.d(),t[189](null),c=!1,Bi(d)}}}const kf=(t,e)=>t.target===e;function NS(t,e,i){let n,r,o,a,s,l,c,d,u,p,h,g,m,f,x,k,w,C,P,R,W,T,F,D,B,y,_,J,S,j,Q,ht,at,U,yt,$t,Mt,dt,Tt,K,q,Z,xt,it,mt,Ft,ie,Dt,Ot,ae,G,wt,ut,Xt,ce,te,ve,me=Ke,V=()=>(me(),me=Br(_t,b=>i(178,ut=b)),_t);t.$$.on_destroy.push(()=>me());let{uid:Ce=na()}=e,{ui:yi}=e,{disabled:xe=!1}=e,{shapes:_t}=e;V();let{selection:ze}=e,{offset:Ie}=e,{contextRotation:Fe=0}=e,{contextFlipX:hi=!1}=e,{contextFlipY:bt=!1}=e,{contextZoom:ne=1}=e,{active:Ue=!1}=e,{opacity:Ee=1}=e,{parentRect:jt}=e,{rootRect:Ge}=e,{utilRect:Qe}=e,{hoverColor:mi}=e,{caretColor:$i}=e,{gridColor:Li}=e,{snapColor:X}=e,{textInputMode:Ut="inline"}=e,{oninteractionstart:H=ge}=e,{oninteractionupdate:Bt=ge}=e,{oninteractionrelease:be=ge}=e,{oninteractionend:se=ge}=e,{oninteractioncancel:At=ge}=e,{onaddshape:re=ge}=e,{onupdateshape:Me=ge}=e,{onselectshape:De=ge}=e,{onblurshape:_e=ge}=e,{onremoveshape:Ze=ge}=e,{ontapshape:nt=ge}=e,{onhovershape:Qt=ge}=e,{onhovercanvas:Zt=ge}=e,{ontapcanvas:Kt=ge}=e,{onleavecanvas:Yt=ge}=e,{beforeSelectShape:st=()=>!0}=e,{beforeDeselectShape:le=()=>!0}=e,{beforeRemoveShape:ee=()=>!0}=e,{beforeUpdateShape:ye=(b,N)=>N}=e,{willRenderShapeControls:Xe=Yi}=e,{willRenderShapeTextControls:$e=Yi}=e,{willStartInteraction:vi=(b,N)=>!0}=e,{mapEditorPointToImagePoint:Le}=e,{mapImagePointToEditorPoint:Gt}=e,{eraseRadius:gi}=e,{selectRadius:Ti}=e,{enableButtonFlipVertical:Ve=!1}=e,{enableTapToAddText:ri=!0}=e,{enableTextStyleControls:Be=!0}=e,{locale:Se}=e,{snapThreshold:Zi=0}=e,{snapPointer:un=!0}=e,{enableSnapToContext:wn=!0}=e,{gridSize:sn=0}=e;const an=b=>{if(Zi===0)return[];let N;return wn&&(N={...jt,x:0,y:0}),[...ut.filter(L=>L!==b).filter(L=>!bo(L)).map(L=>Gn({...L},jt)),N].filter(Boolean)},Mn=(b,N,L,ot)=>b===0?{snapTargets:[]}:{snapThreshold:b,gridSize:N,gridRect:L,snapTargets:an(ot)},ur=dn("isAnimated");A(t,ur,b=>i(179,ce=b));const ao=b=>b.set(ba(b)),fn=b=>ba(b).find(bo),Rr=(b,N)=>{if(!fn(N))return Zp(b),To(b,N)},Sn=b=>{fn(b)&&b.update(N=>N.filter(L=>!bo(L)))},Vn=b=>{const N=fn(b);if(N)return Dm(N),ao(b),N},yn=(b,N,L=(ot,lt)=>({...ot,...lt}))=>{fn(N)&&N.update(ot=>ot.map(lt=>bo(lt)?L(lt,b):lt))},To=(b,N=_t)=>(N.update(L=>[...L,b]),b),Oi=(b,N,L)=>{const ot=ye({...b},N,{...L});return xa(b,ot,L),b},xn=(b,N)=>{const L=mo(b,N),ot=Dd(b,N),lt=Math.PI/8,Lt=lt*Math.round(ot/lt)-Fe%lt;N.x=b.x+L*Math.cos(Lt),N.y=b.y+L*Math.sin(Lt)},On=dn("keysPressed");A(t,On,b=>i(180,te=b));const No=(b,N,L)=>b===0||N&&L?b:N||L?-b:b,Kr=b=>{if(b.x===null&&b.y===null)return go();b.x&&i(139,Mo=Le({x:b.x,y:0}).x),b.y&&i(140,pr=Le({x:0,y:b.y}).y)},go=()=>{i(139,Mo=null),i(140,pr=null)};let Mo=null,pr=null;const pn=(b,N)=>{const L=Gt(b);return Le(Dn(L,N))},Qi=(b,N,L)=>{const ot=(L-N)/b+1;return Array.from({length:ot},(lt,Lt)=>N+Lt*b)},so=b=>{let N=[],L=[],ot=b.points;if(b.x1!==void 0&&(ot=[{x:b.x1,y:b.y1},{x:b.x2,y:b.y2}]),ot){const lt=ot.map(Gt),Lt=er(lt),Ht=lt[0],Nt=lt[lt.length-1];N=[Lt.x,Lt.x+.5*Lt.width,Lt.x+Lt.width,Ht.x,Nt.x],L=[Lt.y,Lt.y+.5*Lt.height,Lt.y+Lt.height,Ht.y,Nt.y]}else if(b.text||b.width!==void 0||b.rx!==void 0){let lt;if(b.text&&b.height===void 0){const qt=Ko(b.text,b);lt=An(b.x,b.y,qt.width,qt.height)}else lt=b.width!==void 0?xs(b):xs({x:b.x-b.rx,y:b.y-b.ry,width:2*b.rx,height:2*b.ry});const Lt=Wo(lt).map(Gt),Ht=Math.abs(b.rotation)>0?$r(lt,b.rotation).map(Gt):Lt,Nt=er(Ht),Wt=Ci(Nt),zt=.5*Nt.width,Vt=.5*Nt.height;N=[Wt.x-zt,Wt.x,Wt.x+zt],L=[Wt.y-Vt,Wt.y,Wt.y+Vt]}else if(b.x!==void 0){const lt=Gt(b);N=[lt.x],L=[lt.y]}return{x:N,y:L}},Ho=(b,N,L)=>{let ot,lt,Lt,Ht=Number.Infinity,Nt=null,Wt=null;for(let zt=0;zt<b.length;zt++){lt=b[zt];for(let Vt=0;Vt<N.length;Vt++)Lt=N[Vt],ot=Math.abs(lt-Lt),ot<L&&(Wt===null||ot<Ht)&&(Ht=ot,Nt=lt,Wt=Lt)}return{origin:Nt,target:Wt}},xr=(b,N,L,ot,lt)=>{const Lt={x:null,y:null},Ht={x:null,y:null},Nt=N.map(so);if(ot>0){const Wt=Gt({x:0,y:0}),zt=Gt({x:ot,y:ot}),Vt=Gt({x:lt.width,y:lt.height}),qt=zt.x-Wt.x,ii=Qi(qt,Wt.x,Vt.x),oe=Qi(qt,Wt.y,Vt.y);Nt.push({x:ii,y:oe})}return Nt.forEach(Wt=>{const{snapTranslation:zt,snapLine:Vt}=((qt,ii,oe)=>{const ue={x:null,y:null},ke={x:null,y:null},we=Ho(qt.x,ii.x,oe);we.target!==null&&(ue.x=we.target,ke.x=we.target-we.origin);const Ye=Ho(qt.y,ii.y,oe);return Ye.target!==null&&(ue.y=Ye.target,ke.y=Ye.target-Ye.origin),{snapTranslation:ke,snapLine:ue}})(b,Wt,L);zt.x!==null&&(Ht.x===null||Math.abs(zt.x)<Math.abs(Ht.x))&&(Ht.x=zt.x||0,Lt.x=Vt.x),zt.y!==null&&(Ht.y===null||Math.abs(zt.y)<Math.abs(Ht.y))&&(Ht.y=zt.y||0,Lt.y=Vt.y)}),{snapTranslation:Ht,snapLines:Lt}},br=(b,N)=>(N.x!==null&&(b.x+=N.x),N.y!==null&&(b.y+=N.y),b),lo=(b,N,L,ot)=>{const{snapThreshold:lt=0,gridSize:Lt=0,gridRect:Ht,snapTargets:Nt=[]}=ot||{};let Wt=null;if(tr(b)){if(lt){const qt=Gn({...b},jt),ii=pn(ts(N),L),oe=pn(es(N),L),ue=so({...qt,x1:ii.x,y1:ii.y,x2:oe.x,y2:oe.y}),{snapTranslation:ke,snapLines:we}=xr(ue,Nt,lt,Lt,Ht);br(L,ke),Kr(we)}const zt=pn(ts(N),L),Vt=pn(es(N),L);Wt={x1:zt.x,y1:zt.y,x2:Vt.x,y2:Vt.y}}else if(b.points){if(gp(Pt)&&_i(Pt,{selectedPoint:void 0}),lt){const zt=Gn({...b},jt),Vt=so({...zt,points:N.points.map(oe=>pn(oe,L))}),{snapTranslation:qt,snapLines:ii}=xr(Vt,Nt,lt,Lt,Ht);br(L,qt),Kr(ii)}Wt={points:N.points.map(zt=>pn(zt,L))}}else if(wo(b)||Xn(b)||Yn(b)){if(lt){const zt=Gn({...b},jt),Vt=pn(N,L),qt=so({...zt,...Vt}),{snapTranslation:ii,snapLines:oe}=xr(qt,Nt,lt,Lt,Ht);br(L,ii),Kr(oe)}Wt=pn(N,L)}Wt&&(Oi(b,Wt,jt),Wn())},ca={0:1,1:0,2:3,3:2},Po={0:3,1:2,2:1,3:0};let Ro;const _r=(b,N)=>{const L=b.points.filter((ot,lt)=>lt!==N);_i(b,{points:L,selectedPoint:void 0})},Jr=()=>{if(ut.length)return ut.find(bo)},Ir=()=>{if(ut.length)return ut.findIndex(bo)},hr=()=>{const b=Jr();if(b)return Dm(b),Wn(),b},vr=()=>{if(!Jr())return;const b=[...ut];b.splice(Ir(),1),_t.set(b)},Wn=()=>{_t.set(ut)},Wi=(b,N=[],L=!0)=>{N.filter(Boolean).forEach(ot=>delete b[ot]),L&&Wn()},_i=(b,N,L=!0)=>{b=Object.assign(b,N),L&&Wn()},lr=(b,N,L,ot=!0)=>{b[N]=L,ot&&Wn()},qi=(b,N=!0)=>{ut.forEach(L=>_i(L,b,!1)),N&&Wn()},Vr=()=>[...ut].reverse().find(bs),co=()=>!!Vr(),Qr=b=>{if(!ee(b))return!1;_t.set(ut.filter(N=>N!==b)),Ze(b)},mr=()=>{const b=Vr();if(!b)return;const N=ut.filter(lt=>Bm(lt)&&ga(lt)),L=N.findIndex(lt=>lt===b);if(Qr(b)===!1)return;if(Fn=b,N.length-1<=0)return wr();const ot=L-1<0?N.length-1:L-1;cr(N[ot])};let Fn;const wr=(b={})=>{const{storePrevious:N=!0}=b;Object.keys(Uo).forEach(ot=>Uo[ot]={});const L=uo();N&&(Fn=L),qi({isSelected:!1,isEditing:!1,_prerender:!1}),L&&_e(L)},uo=()=>ut.find(bs),cr=(b,N=!0)=>{if(bo(b))return;const L=uo()||Fn,ot=bs(b);Fn=void 0,st(L,b)&&(wr(),(lt=>{lt.isSelected=!0})(b),!ot&&De(b),N&&Wn())},Kn=b=>{Fi&&Fi.confirm&&b.isEditing&&Fi.confirm();const N={isSelected:!1,isEditing:!1,_prerender:!1};b.selectedPoint>-1&&(N.selectedPoint=void 0),_i(b,N),_e(b)},Nn=b=>{_i(b,{isSelected:!0,isEditing:!0,_prerender:Ut==="inline"})},Er=b=>{_i(b,{isSelected:!0,isEditing:!1,_prerender:!1})},to=b=>{if(!b.length)return[];const N=b.filter(ee);return _t.set(ut.filter(L=>!N.includes(L))),N},eo=b=>{const N=Ko(b.text,b);return An(b.x,b.y,b.width?Math.min(b.width,N.width):N.width,b.height?Math.min(b.height,N.height):N.height)},En=b=>{if(tl(b))return xs(b);if(Yn(b))return cp(b);const N=eo(b);return N.width=Math.max(10,b.width||N.width),N},Ar=(b,N,L=0,ot=()=>!0)=>[...b].reverse().filter(ot).map(lt=>({shape:lt,priority:1})).filter(lt=>{const{shape:Lt}=lt,Ht=Gn(Hn(Lt),jt),Nt=L+.5*(Ht.strokeWidth||0);if(wo(Ht))return dp(N,Nt,Ht,Lt.rotation);if(Xn(Ht)){const Wt=En(Ht),zt=dp(N,Nt,Wt,Lt.rotation);let Vt=!1;if(zt&&!bs(Lt)){const qt=eo(Ht);Lt.textAlign!=="right"||Lt.flipX||(qt.x=Wt.x+Wt.width-qt.width),Lt.textAlign==="center"&&(qt.x=Wt.x+.5*Wt.width-.5*qt.width),Vt=dp(N,Nt,qt,Lt.rotation,Ci(Wt)),Vt||(lt.priority=-1)}return zt}return Yn(Ht)?((Wt,zt,Vt,qt,ii,oe)=>{const ue=uu(rt(Vt.x,Vt.y),Vt.rx,Vt.ry,qt,ii,oe,12);return Gp(Wt,zt,ue)})(N,Nt,Ht,Lt.rotation,Lt.flipX,Lt.flipY):tr(Ht)?pu(N,Math.max(16,Nt),ts(Ht),es(Ht)):_n(Ht)&&Ht.pathClose?Gp(N,Nt,Ht.points):!!_n(Ht)&&(Ht.points.length===1?vo(N,Ht.points[0])<Nt*Nt:dy(N,Math.max(16,Nt),Ht.points))}).sort((lt,Lt)=>lt.priority<Lt.priority?1:lt.priority>Lt.priority?-1:0).map(lt=>lt.shape),O=(b,N,L,ot=0)=>{const lt=Math.abs(ot),Lt=As(N,L),Ht=vh(Lt,lt),Nt=(({start:Wt,end:zt},Vt)=>{if(Vt===0)return[rt(Wt.x,Wt.y),rt(Wt.x,Wt.y),rt(zt.x,zt.y),rt(zt.x,zt.y)];const qt=Math.atan2(zt.y-Wt.y,zt.x-Wt.x),ii=Math.sin(qt)*Vt,oe=Math.cos(qt)*Vt;return[rt(ii+Wt.x,-oe+Wt.y),rt(-ii+Wt.x,oe+Wt.y),rt(-ii+zt.x,oe+zt.y),rt(ii+zt.x,-oe+zt.y)]})(Ht,lt);return b.filter(Wt=>{const zt=Gn(Hn(Wt),jt);if(tr(zt)||_n(zt)){const Vt=zt.points?[...zt.points]:[ts(zt),es(zt)];return!!sy(Ht,Vt)}return((Vt,qt)=>!!Vt.find(ii=>Up(ii,qt))||!!qt.find(ii=>Up(ii,Vt)))(Nt,((Vt,qt=12)=>{if(wo(Vt))return $r(Vt,Vt.rotation,Ci(Vt));if(Xn(Vt)){const ii=En(Vt);return $r(ii,Vt.rotation,Ci(ii))}return Yn(Vt)?uu(rt(Vt.x,Vt.y),Vt.rx,Vt.ry,Vt.rotation,Vt.flipX,Vt.flipY,qt):[]})(zt))})};let de,wi,je,Pt,fe,xi,Gi=!1,hn=!1,Si=!1;const Vi=()=>{clearTimeout(wi),wi=void 0,i(142,Si=!1),go()};let Lr=null;const da=b=>{const N=di(b.rotation)&&b.rotation!==0;if(wo(b)){if(b.width<1&&b.height<1)return;const L=Ci(b),ot=Wo(b);return(b.flipX||b.flipY)&&Al(ot,b.flipX,b.flipY,L.x,L.y),N?nl(ot,b.rotation,L.x,L.y):ot}if(Yn(b)){if(b.rx<1&&b.ry<1)return;const L=b,ot=Wo(cp(b));return(b.flipX||b.flipY)&&Al(ot,b.flipX,b.flipY,L.x,L.y),N?nl(ot,b.rotation,L.x,L.y):ot}if(tr(b))return[ts(b),es(b)];if(_n(b)){if(b.bitmap&&!b.pathClose){const L=er(b.points);return L.x-=.5*b.strokeWidth,L.y-=.5*b.strokeWidth,L.width+=b.strokeWidth,L.height+=b.strokeWidth,da({...b,...L})}return[...b.points]}if(Xn(b)){if(b.width<5&&b.height<5)return;const L=En(b);L.width=Math.max(10,L.width);const ot=Ci(L),lt=Wo(L);return(b.flipX||b.flipY)&&Al(lt,b.flipX,b.flipY,ot.x,ot.y),N?nl(lt,b.rotation,ot.x,ot.y):lt}return[]},ua=b=>{const N=da(b);let L,ot;return b.flipY?(L=Bo([N[0],N[1]]),ot=ro(rt(N[1].x-N[2].x,N[1].y-N[2].y))):(L=Bo([N[2],N[3]]),ot=ro(rt(N[2].x-N[1].x,N[2].y-N[1].y))),Tr(ot,20/ne),{origin:L,dir:ot}},Ta=b=>N=>N.id===b,jo=b=>{const N=Ta(b);return L=>L.filter((ot=>lt=>!ot(lt))(N))},Nr=b=>{const N=Ta(b),L=jo(b);return()=>yi.update(ot=>ot.some(N)?L(ot):ot)},Io=b=>{const N=jo(b);return(...L)=>{yi.update(ot=>[...N(ot),...L.filter(Boolean)])}},Eo=Nr("markup-hover"),Oa=Io("markup-hover");let Hr;const I="markup-manipulator-segment-"+Ce,Te=(b,N)=>{const L=b[N],ot=N-1<0?b[b.length-1]:b[N-1],lt=N+1<b.length?b[N+1]:b[0],Lt=Bn(Oe(ot),L);ro(Lt);const Ht=Dn(Tr(Lt,10),L),Nt=Bn(Oe(lt),L);return ro(Nt),[Ht,L,Dn(Tr(Nt,10),L)]},Ne=Nr(I),fi=Io(I),Di=()=>{i(143,Hr=void 0),Eo()},Ni=(b,N)=>{if(Zi<=0)return b;if(N)return go(),b;const L=Le(b),ot=an(),{snapTranslation:lt,snapLines:Lt}=xr(so(L),ot,Zi,sn,n);return Kr(Lt),br(b,lt),b},ti=ci(0);A(t,ti,b=>i(181,ve=b));const oi="markup-grid-line-"+Ce,Ei=Nr(oi),zi=Io(oi),mn="markup-snap-line",Pn=Nr(mn),bn=Io(mn);let Fi;const Pi=b=>{i(8,Fi.innerHTML=BS(b),Fi)},zr=b=>{const N=b.value===void 0?b.innerHTML:b.value,L=r.format==="text"?q2(N).split(/<br>|<br\/>/g).join(`
`).replace(/&nbsp;/g," ").replace(/&amp;/g,"&"):N;return $u(r)&&r.disableNewline!==!1?(ot=>{const lt=ot.split(/[\n\r]/g);return lt.length>1?lt.map(Lt=>Lt.trim()).filter(Lt=>Lt.length).join(" "):lt[0]})(L):L},Ao=()=>{const b=zr(Fi),N=Cl(r,b),L=N===!0?b:N;let ot=S.x,lt=S.y;if(!r.height){const Lt=$r({...Q},r.rotation),Ht=Ko(L,l),Nt=$r({x:ot,y:lt,...Ht},r.rotation),[Wt,,zt]=Lt,[Vt,,qt]=Nt;let ii=Wt,oe=Vt;r.flipX&&(ii=zt,oe=qt);const ue=Bn(Oe(ii),oe);ot+=ue.x,lt+=ue.y}_i(r,{x:We(J.x)?Dr(ot,jt.width):ot,y:We(J.y)?Dr(lt,jt.height):lt,text:L})},Wa=()=>{a&&hr(),Fi&&Fi.confirm&&Fi.confirm(),Ao(),Er(r),Me(r)},_a=()=>{a?vr():(_i(r,{text:J.text,x:J.x,y:J.y}),Er(r))},Va=(b,N,{flipX:L,flipY:ot,rotation:lt},Lt="top left")=>{let Ht,Nt;const[Wt,zt,Vt,qt]=$r(b,lt),[ii,oe,ue,ke]=$r(N,lt);return Lt==="top center"?(Ht=Bo(ot?[qt,Vt]:[Wt,zt]),Nt=Bo(ot?[ke,ue]:[ii,oe])):Lt==="top right"&&!L||Lt==="top left"&&L?(Ht=ot?Vt:zt,Nt=ot?ue:oe):(Ht=ot?qt:Wt,Nt=ot?ke:ii),Bn(Oe(Ht),Nt)},Na=(b,N,L)=>rt(We(b.x)?Dr(N.x+L.x,jt.width):N.x+L.x,We(b.y)?Dr(N.y+L.y,jt.height):N.y+L.y),Uo={},ls=()=>_r(r,r.selectedPoint),dl=()=>Nn(r),Ha=()=>{const b=ns(Ko(r.text,l),Wt=>Math.ceil(Wt)),N=Ae(r,"height"),L=!N&&Ae(r,"width"),ot=r.id;let lt=Uo[ot];lt||(Uo[ot]={},lt=Uo[ot]);const Lt=Wt=>{const{width:zt,...Vt}=l,qt=Ko(r.text,Vt),ii=Va(An(l.x,l.y,Wt.width,Wt.height),An(l.x,l.y,qt.width,qt.height),l,"top "+r.textAlign),oe=l.disableNewline!==!1;Wi(r,["width","height",oe&&"textAlign"]),_i(r,{...Na(r,l,ii)})},Ht=Wt=>{const zt=jn(lt.width||l.width||b.width,b.height),Vt=lt.textAlign||"left",qt=Va(An(l.x,l.y,Wt.width,Wt.height),An(l.x,l.y,zt.width,zt.height),l,"top "+Vt);Wi(r,["height"]),_i(r,{...Na(r,l,qt),width:We(r.width)?Dr(zt.width,jt.width):zt.width,textAlign:Vt})},Nt=Wt=>{const zt=jn(lt.width||b.width,lt.height||b.height),Vt=lt.textAlign||"left",qt=Va(An(l.x,l.y,Wt.width,Wt.height),An(l.x,l.y,zt.width,zt.height),l,"top "+Vt);_i(r,{...Na(r,l,qt),width:We(r.width)?Dr(zt.width,jt.width):zt.width,height:We(r.width)?Dr(zt.height,jt.height):zt.height,textAlign:Vt})};if(N){lt.textAlign=r.textAlign,lt.width=l.width,lt.height=l.height;const Wt=jn(l.width,l.height);Ys(r,"auto-height")?Ht(Wt):Ys(r,"auto-width")&&Lt(Wt)}else if(L){lt.textAlign=r.textAlign,lt.width=l.width;const Wt=jn(l.width,b.height);Ys(r,"auto-width")?Lt(Wt):Ys(r,"fixed-size")&&Nt(Wt)}else{lt.textAlign=r.textAlign;const Wt=jn(Math.ceil(b.width),Math.ceil(b.height));Ys(r,"fixed-size")?Nt(Wt):Ys(r,"auto-height")&&Ht(Wt)}},Ma=b=>{b.stopPropagation();const N=r.flipX||!1;lr(r,"flipX",!N),Me(r)},jr=b=>{b.stopPropagation();const N=r.flipY||!1;lr(r,"flipY",!N),Me(r)},Fr=b=>{lr(r,"opacity",b)},Sr=b=>{Fr(b),Me(r)},Ur=b=>{b.stopPropagation(),b.target.blur(),mr()},ln=b=>{b.stopPropagation(),ut.findIndex(N=>N===r)!==ut.length-1&&(_t.set(ut.filter(N=>N!==r).concat([r])),Me(r))},Lo=b=>{b.stopPropagation(),tn()},tn=()=>{const b=Hn(r);b.id=na();const N=rt(50,-50);if(Ae(b,"points")){const L=Ll(b,["points"],jt);L.points.forEach(ot=>{ot.x+=N.x,ot.y+=N.y}),xa(b,L,jt)}else if(tr(b)){const L=Ll(b,["x1","y1","x2","y2"],jt);L.x1+=N.x,L.y1+=N.y,L.x2+=N.x,L.y2+=N.y,xa(b,L,jt)}else{const L=Ll(b,["x","y"],jt);L.x+=50,L.y-=50,xa(b,L,jt)}_t.set([...ut,b]),re(b),cr(b)},po=ci(0,{stiffness:.2,damping:.7});A(t,po,b=>i(18,Xt=b));let pa;const jl=(b,N)=>{const{disableTextLayout:L=[]}=N;return"height"in N?L.includes("auto-height")?b.shapeIconButtonTextLayoutAutoWidth:b.shapeIconButtonTextLayoutAutoHeight:"width"in N?L.includes("auto-width")?b.shapeIconButtonTextLayoutFixedSize:b.shapeIconButtonTextLayoutAutoWidth:L.includes("fixed-size")?b.shapeIconButtonTextLayoutAutoHeight:b.shapeIconButtonTextLayoutFixedSize},cs=(b,N)=>{const{disableTextLayout:L=[]}=N;return"height"in N?L.includes("auto-height")?b.shapeTitleButtonTextLayoutAutoWidth:b.shapeTitleButtonTextLayoutAutoHeight:"width"in N?L.includes("auto-width")?b.shapeTitleButtonTextLayoutFixedSize:b.shapeTitleButtonTextLayoutAutoWidth:L.includes("fixed-size")?b.shapeTitleButtonTextLayoutAutoHeight:b.shapeTitleButtonTextLayoutFixedSize};let ja=!1,fo=rn(),Pa;const ul=b=>{Qt(b),i(143,Hr=b)};let ds;return Vo(()=>{Pn(),Ei(),Ne(),Eo()}),t.$$set=b=>{"uid"in b&&i(58,Ce=b.uid),"ui"in b&&i(59,yi=b.ui),"disabled"in b&&i(0,xe=b.disabled),"shapes"in b&&V(i(1,_t=b.shapes)),"selection"in b&&i(60,ze=b.selection),"offset"in b&&i(2,Ie=b.offset),"contextRotation"in b&&i(61,Fe=b.contextRotation),"contextFlipX"in b&&i(62,hi=b.contextFlipX),"contextFlipY"in b&&i(63,bt=b.contextFlipY),"contextZoom"in b&&i(64,ne=b.contextZoom),"active"in b&&i(65,Ue=b.active),"opacity"in b&&i(66,Ee=b.opacity),"parentRect"in b&&i(67,jt=b.parentRect),"rootRect"in b&&i(3,Ge=b.rootRect),"utilRect"in b&&i(68,Qe=b.utilRect),"hoverColor"in b&&i(69,mi=b.hoverColor),"caretColor"in b&&i(70,$i=b.caretColor),"gridColor"in b&&i(71,Li=b.gridColor),"snapColor"in b&&i(72,X=b.snapColor),"textInputMode"in b&&i(4,Ut=b.textInputMode),"oninteractionstart"in b&&i(73,H=b.oninteractionstart),"oninteractionupdate"in b&&i(74,Bt=b.oninteractionupdate),"oninteractionrelease"in b&&i(75,be=b.oninteractionrelease),"oninteractionend"in b&&i(76,se=b.oninteractionend),"oninteractioncancel"in b&&i(77,At=b.oninteractioncancel),"onaddshape"in b&&i(78,re=b.onaddshape),"onupdateshape"in b&&i(79,Me=b.onupdateshape),"onselectshape"in b&&i(80,De=b.onselectshape),"onblurshape"in b&&i(81,_e=b.onblurshape),"onremoveshape"in b&&i(82,Ze=b.onremoveshape),"ontapshape"in b&&i(83,nt=b.ontapshape),"onhovershape"in b&&i(84,Qt=b.onhovershape),"onhovercanvas"in b&&i(85,Zt=b.onhovercanvas),"ontapcanvas"in b&&i(86,Kt=b.ontapcanvas),"onleavecanvas"in b&&i(87,Yt=b.onleavecanvas),"beforeSelectShape"in b&&i(88,st=b.beforeSelectShape),"beforeDeselectShape"in b&&i(89,le=b.beforeDeselectShape),"beforeRemoveShape"in b&&i(90,ee=b.beforeRemoveShape),"beforeUpdateShape"in b&&i(91,ye=b.beforeUpdateShape),"willRenderShapeControls"in b&&i(92,Xe=b.willRenderShapeControls),"willRenderShapeTextControls"in b&&i(93,$e=b.willRenderShapeTextControls),"willStartInteraction"in b&&i(94,vi=b.willStartInteraction),"mapEditorPointToImagePoint"in b&&i(95,Le=b.mapEditorPointToImagePoint),"mapImagePointToEditorPoint"in b&&i(96,Gt=b.mapImagePointToEditorPoint),"eraseRadius"in b&&i(97,gi=b.eraseRadius),"selectRadius"in b&&i(98,Ti=b.selectRadius),"enableButtonFlipVertical"in b&&i(99,Ve=b.enableButtonFlipVertical),"enableTapToAddText"in b&&i(100,ri=b.enableTapToAddText),"enableTextStyleControls"in b&&i(5,Be=b.enableTextStyleControls),"locale"in b&&i(6,Se=b.locale),"snapThreshold"in b&&i(101,Zi=b.snapThreshold),"snapPointer"in b&&i(102,un=b.snapPointer),"enableSnapToContext"in b&&i(103,wn=b.enableSnapToContext),"gridSize"in b&&i(104,sn=b.gridSize)},t.$$.update=()=>{var b,N;32&t.$$.dirty[2]|2048&t.$$.dirty[3]&&i(169,n=sn>0?{x:0,y:0,...jt}:void 0),1&t.$$.dirty[0]|8388608&t.$$.dirty[5]&&i(147,r=!xe&&ut&&(Jr()||Vr())),8388608&t.$$.dirty[4]&&i(176,o=!!r),8388608&t.$$.dirty[4]&&i(163,a=r&&bo(r)),8388608&t.$$.dirty[4]|256&t.$$.dirty[5]&&i(10,s=r&&!a?r.id:void 0),8&t.$$.dirty[0]|32&t.$$.dirty[2]|8388608&t.$$.dirty[4]&&i(13,l=Ge&&r&&Gn(Hn(r),jt)),8388608&t.$$.dirty[4]|256&t.$$.dirty[5]&&i(145,c=!(!r||!a)),8192&t.$$.dirty[0]|16&t.$$.dirty[2]|8388608&t.$$.dirty[4]&&i(175,d=r&&Ee&&da(l)||[]),8388608&t.$$.dirty[4]&&i(177,u=r&&Yp(b=r)&&wc(b)&&b.disableResize!==!0&&(tl(b)||nu(b)||Yn(b)||tr(b)||_n(b)&&Ae(b,"pathClose"))&&!Qa(r)),8388608&t.$$.dirty[4]&&i(14,p=r&&(L=>Yp(L)&&L.disableRotate!==!0&&(tl(L)||Ae(L,"text")||Yn(L)))(r)&&!Qa(r)),8388608&t.$$.dirty[4]|4194304&t.$$.dirty[5]&&i(17,h=u&&Ae(r,"text")&&!r.height?[[1,2],[3,0]]:(!r||!tr(r)&&!_n(r))&&u),131072&t.$$.dirty[0]|8388608&t.$$.dirty[4]|4194304&t.$$.dirty[5]&&i(29,g=!!r&&!Array.isArray(h)&&u),8388608&t.$$.dirty[4]|1048576&t.$$.dirty[5]&&i(15,m=r&&d.length>1),8&t.$$.dirty[3]|1048576&t.$$.dirty[5]&&i(173,f=d.map(Gt)),4&t.$$.dirty[0]|262144&t.$$.dirty[5]&&i(12,x=f.map(L=>rt(L.x-Ie.x,L.y-Ie.y))),8388608&t.$$.dirty[4]&&i(16,k=r&&r.points&&di(r.selectedPoint)?r.selectedPoint:-1),65536&t.$$.dirty[0]&&i(155,w=k>=0),69632&t.$$.dirty[0]|1&t.$$.dirty[5]&&i(160,C=w?x[k]:void 0),8388608&t.$$.dirty[4]|2097152&t.$$.dirty[5]&&i(28,P=o&&(nu(r)?!Ae(r,"disableNewline")||!r.disableNewline:r.disableNewline===!1)),8&t.$$.dirty[3]|524288&t.$$.dirty[4]&&(Hr&&Gt&&!bs(Hr)&&ga(Hr)?(L=>{const ot=da(Gn(Hn(L),jt));if(!ot)return;const lt=ot.map(Gt),Lt=!!L.pathClose||!(!L.bitmap&&(_n(L)||tr(L))),Ht=L.selectionStyle==="hook",Nt=Ht?lt.map((zt,Vt,qt)=>({id:"markup-hover",points:Te(qt,Vt),strokeColor:[0,0,0,.1],strokeWidth:2})):[{id:"markup-hover",points:lt.map(zt=>rt(zt.x+1,zt.y+1)),strokeColor:[0,0,0,.1],strokeWidth:2,pathClose:Lt}],Wt=Ht?lt.map((zt,Vt,qt)=>({id:"markup-hover",points:Te(qt,Vt),strokeColor:mi,strokeWidth:2})):[{id:"markup-hover",points:lt,strokeColor:mi,strokeWidth:2,pathClose:Lt}];Oa(...Nt,...Wt)})(Hr):Eo()),61440&t.$$.dirty[0]|16&t.$$.dirty[2]&&i(174,R=m&&p&&Ee&&x&&(L=>{const ot=ua(L),lt=Gt({x:ot.origin.x+ot.dir.x,y:ot.origin.y+ot.dir.y});return{origin:Gt(ot.origin),position:lt}})(l)),4&t.$$.dirty[0]|524288&t.$$.dirty[5]&&i(27,W=R&&rt(R.position.x-Ie.x,R.position.y-Ie.y)),33554432&t.$$.dirty[5]&&i(168,B=!!(te||[]).find(L=>[91,93,17].includes(L))),512&t.$$.dirty[3]|8192&t.$$.dirty[5]&&i(170,T=!(B||!un)),16&t.$$.dirty[2]|9437184&t.$$.dirty[4]|295168&t.$$.dirty[5]&&r&&f&&Ee>0&&(r===Hr&&Di(),((L,ot,lt)=>{if(!ga(ot))return;const Lt=_n(ot),Ht=Lt&&Ae(ot,"pathClose"),Nt=Ht&&(en=>en.strokeWidth&&((Gr,Zr)=>{const io=Gr.strokeColor;return!!io&&(io.length===3||io[3]>0)})(en))(ot),Wt=bo(ot),zt=Qa(ot),Vt=ot.selectionStyle==="hook",qt=ot.disableShowPoints!==!0,{selectionOpacity:ii=1}=ot;if(Wt&&Lt&&!Ht)return;const oe=[],ue=[...f],ke=ue[ue.length-1],we=ue[0],Ye=(zt?.05:.1)*L*ii,ei=Ye>0,bi=(zt?.5:1)*L*ii,ui=bi>0,Mi=[0,0,0],cn=[1,1,1],Hi=zt?1:1.5;te.includes(16)&&ke&&lt&&xn(ke,lt);const Ri=(ue.length&&Ht&&Wt&&lt?vo(we,lt):1/0)<=256,kn=(ue.length&&Ht&&Wt&&lt?vo(ke,lt):1/0)<=256;!Ri&&lt&&ue.push(lt);const Ki=ue.length>1,Zn=!!ot.pathClose||!(!ot.bitmap&&(_n(ot)||tr(ot)))||ue.length>2&&Ri;Ki&&ei&&(Vt?oe.push(...ue.map((en,Gr,Zr)=>({id:I,points:Te(Zr,Gr),strokeColor:Mi,opacity:Ye}))):oe.push({id:I,points:ue.map(en=>rt(en.x+1,en.y+1)),pathClose:Zn,strokeColor:Mi,strokeWidth:2,opacity:Ye})),Ht&&ei&&qt&&oe.push(...ue.map(en=>({id:I,...en,rx:2*Hi,ry:2*Hi,backgroundColor:Mi,opacity:Ye}))),R&&ei&&oe.push({id:I,points:[rt(R.origin.x+1,R.origin.y+1),rt(R.position.x+1,R.position.y+1)],strokeColor:Mi,strokeWidth:2,opacity:Ye}),Ki&&ui&&(Vt?oe.push(...ue.map((en,Gr,Zr)=>({id:I,points:Te(Zr,Gr),strokeColor:cn,strokeWidth:Hi,opacity:bi}))):oe.push({id:I,points:ue,pathClose:Zn,strokeColor:cn,strokeWidth:Hi,backgroundColor:Wt&&Ht&&ot.backgroundColor&&ot.backgroundColor[3]>0?ot.backgroundColor:[0,0,0,0],opacity:bi})),Ht&&qt&&oe.push(...ue.map(en=>({id:I,...en,rx:3*Hi,ry:3*Hi,backgroundColor:[.5,.5,.5],strokeWidth:Hi,strokeColor:cn}))),Ht&&Wt&&qt&&f.length>=3&&oe.push({...we,id:I,rx:Hi*(Ri?5:4),ry:Hi*(Ri?5:4),backgroundColor:Ri?mi:[.5,.5,.5],strokeWidth:Hi,strokeColor:cn}),Ht&&Wt&&Nt&&qt&&!Ri&&d.length>=2&&oe.push({...ke,id:I,rx:Hi*(kn?5:4),ry:Hi*(kn?5:4),backgroundColor:kn?mi:[.5,.5,.5],strokeWidth:Hi,strokeColor:cn}),R&&ui&&!Vt&&oe.push({id:I,points:[{x:R.origin.x,y:R.origin.y},{x:R.position.x,y:R.position.y}],strokeColor:cn,strokeWidth:Hi,opacity:bi}),fi(...oe)})(Ee,r,a&&_n(r)?Ni({...Pa},!T):void 0)),8388608&t.$$.dirty[4]&&(r||(Di(),Ne())),524288&t.$$.dirty[4]&&i(171,F=!!Hr),131072&t.$$.dirty[4]&&i(172,D=!!Pt),1048576&t.$$.dirty[4]|229376&t.$$.dirty[5]&&(!Pa||D||F||Ni({...Pa},!T)),512&t.$$.dirty[2]|2056&t.$$.dirty[3]|67125248&t.$$.dirty[5]&&sn>0&&n&&Gt&&((L,ot,lt,Lt)=>{const Ht=Gt({x:0,y:0}),Nt=Gt({x:L,y:L}),Wt=Gt({x:ot.width,y:ot.height}),zt=Nt.x-Ht.x;if(ti.set(zt>6?1:0),Lt<=0)return Ei();const Vt=Qi(zt,Ht.x,Wt.x).map(ii=>({id:oi,opacity:Lt,points:[{x:ii,y:Ht.y},{x:ii,y:Wt.y}],strokeWidth:1,strokeColor:lt})),qt=Qi(zt,Ht.y,Wt.y).map(ii=>({id:oi,opacity:Lt,points:[{x:Ht.x,y:ii},{x:Wt.x,y:ii}],strokeWidth:1,strokeColor:lt}));zi(...qt,...Vt)})(sn,n,Li,ve),1024&t.$$.dirty[2]|8&t.$$.dirty[3]|98304&t.$$.dirty[4]|8192&t.$$.dirty[5]&&Gt&&(B?Pn():((L,ot,lt)=>{if(L===null&&ot===null)return Pn();let Lt,Ht;L!==null&&(Lt={id:mn,strokeColor:lt,strokeWidth:1.5,points:[Gt({x:L,y:0}),Gt({x:L,y:jt.height})]}),ot!==null&&(Ht={id:mn,strokeColor:lt,strokeWidth:1.5,points:[Gt({x:0,y:ot}),Gt({x:jt.width,y:ot})]}),bn(Lt,Ht)})(Mo,pr,X)),8&t.$$.dirty[2]&&(L=>{if(!L)return qi({_prerender:!1});const ot=ut.find(lt=>lt.isEditing);ot&&_i(ot,{_prerender:Ut==="inline"})})(Ue),33554432&t.$$.dirty[5]&&te&&te.length&&(()=>{const[L]=te;L!==8&&L!==46||co()&&(r.isEditing||(_n(r)&&di(r.selectedPoint)?setTimeout(()=>_r(r,r.selectedPoint),0):setTimeout(()=>mr(),0)))})(),272&t.$$.dirty[0]&&Fi&&Ut==="inline"&&Fi.focus(),8388608&t.$$.dirty[4]&&i(167,y=r&&Xn(r)),8388608&t.$$.dirty[4]|4096&t.$$.dirty[5]&&i(11,_=y&&Cl(r)!==!1&&Qa(r)),2048&t.$$.dirty[0]&&i(162,J=_?{...r}:void 0),32&t.$$.dirty[2]|128&t.$$.dirty[5]&&i(164,S=J&&Gn({...J},jt)),512&t.$$.dirty[5]&&i(166,j=S&&Ko(S.text,S)),2560&t.$$.dirty[5]&&(Q=S&&An(S.x,S.y,j.width,j.height)),2048&t.$$.dirty[0]|8388608&t.$$.dirty[4]&&i(24,ht=_?r.text:""),2056&t.$$.dirty[0]|32&t.$$.dirty[2]|8388608&t.$$.dirty[4]&&i(165,at=Ge&&r&&_&&Gn({...Hn(r),width:di(r.width)?Math.floor(r.width):void 0,height:di(r.height)?Math.floor(r.height):void 0},jt)),2064&t.$$.dirty[0]|1024&t.$$.dirty[5]&&i(26,U=_&&((L,ot)=>{const{textAlign:lt="left",fontFamily:Lt="sans-serif",fontWeight:Ht="normal",fontStyle:Nt="normal",letterSpacing:Wt="normal",textShadowX:zt=0,textShadowY:Vt=0,textShadowBlur:qt=0,textShadowColor:ii,textOutlineWidth:oe=0,textOutlineColor:ue}=L,ke="!important",we=`caret-color:${$t};text-align:${lt}${ke};font-family:${Lt}${ke};font-weight:${Ht}${ke};font-style:${Nt}${ke};letter-spacing:${di(Wt)?Wt+"px":"normal"}${ke}`;if(ot==="modal")return we;const Ye=oe?`;-webkit-text-stroke:${2*oe}px ${gr(ue)} ${ke}`:"",ei=qt||zt||Vt?`;text-shadow:${zt}px ${Vt}px ${qt}px ${gr(ii)} ${ke}`:"";let bi=L.fontSize,ui=1,Mi="";bi>1e3&&wa()&&(ui=bi/1e3,Mi=`transform-origin:0 0;transform:scale(${ui})`,bi=1e3);let cn=L.lineHeight/ui;const Hi=gr(L.color),Ri=.5*Math.max(0,bi-cn);return`--font-scalar:${ui};--bottom-inset:${Ri}px;padding:${Ri}px 0 0${ke};color:${Hi}${ke};font-size:${bi}px${ke};line-height:${cn}px${ke};${we};${Mi}${Ye}${ei}`})(at,Ut)),2052&t.$$.dirty[0]|1073741824&t.$$.dirty[1]|4&t.$$.dirty[2]|1024&t.$$.dirty[5]&&i(25,yt=_&&((L,ot,lt,Lt)=>{let Ht,Nt;L.width&&L.height?(Ht=Ci(L),Nt=Da(L)):(Nt=Ko(r.text,l),Nt.width=l.width||Nt.width,Ht=rt(L.x+.5*Nt.width,L.y+.5*Nt.height));const Wt=Math.max(0,L.fontSize-L.lineHeight)+L.lineHeight,zt=Gt(Ht);let Vt=zt.x-ot.x-.5*Nt.width,qt=zt.y-ot.y-.5*Nt.height,ii=L.flipX,oe=L.flipY,ue=L.rotation;hi&&bt?(ii=!ii,oe=!oe):hi?(ii=!ii,ue=-ue):bt&&(oe=!oe,ue=-ue),ue+=Lt;const ke=lt*(ii?-1:1),we=lt*(oe?-1:1);return`--line-height:${Wt}px;width:${Nt.width}px;height:${Nt.height}px;transform:translate(${Vt}px,${qt}px) rotate(${ue}rad) scale(${ke}, ${we})`})(at,Ie,ne,Fe)),256&t.$$.dirty[2]&&($t=$i?gr($i):"auto"),2320&t.$$.dirty[0]&&_&&Fi&&Ut==="inline"&&Pi(ht),144703488&t.$$.dirty[4]&&i(151,Mt=r&&!c?r:Mt),134217728&t.$$.dirty[4]&&i(153,dt=Mt&&Rb(Mt)),134217728&t.$$.dirty[4]&&i(148,Tt=Mt&&Ys(Mt)),134217728&t.$$.dirty[4]&&i(150,K=Mt&&(L=>L.disableDuplicate!==!0&&wc(L))(Mt)),134217728&t.$$.dirty[4]&&i(149,q=Mt&&Bm(Mt)),134217728&t.$$.dirty[4]&&i(152,Z=Mt&&(L=>L.disableReorder!==!0)(Mt)),134217728&t.$$.dirty[4]&&i(146,xt=Mt&&Cl(Mt)!==!1),134217728&t.$$.dirty[4]&&i(154,it=Mt&&Ae(Mt,"backgroundImage")&&Xp(Mt,"opacity")),8388608&t.$$.dirty[4]&&i(157,mt=r&&r.format==="html"),10485760&t.$$.dirty[4]|4&t.$$.dirty[5]&&i(161,Ft=r&&(!c||mt)),262144&t.$$.dirty[4]|16777280&t.$$.dirty[5]&&po.set(Ft&&!Si?1:0,{hard:ce===!1}),4096&t.$$.dirty[0]|80&t.$$.dirty[5]&&i(159,ie=Ft&&x.length?(N=er(x),So(rt(N.x+.5*N.width,N.y),Oc)):ie),512&t.$$.dirty[0]|64&t.$$.dirty[2]|48&t.$$.dirty[5]&&i(158,Dt=(C||ie)&&pa&&Qe&&((L,ot,lt,Lt)=>{const Ht=L.x,Nt=L.y,Wt=Ht+L.width;let zt=Math.max(ot.x-.5*lt.width,Ht),Vt=Math.max(ot.y-lt.height+Lt,Nt);return zt+lt.width>Wt&&(zt=Wt-lt.width),rt(zt,Vt)})(Qe,C||ie,pa,-16)),262144&t.$$.dirty[0]|8&t.$$.dirty[5]&&i(23,Ot=Dt&&`transform: translate(${Dt.x}px, ${Dt.y}px);opacity:${Xt}`),2048&t.$$.dirty[0]&&i(156,ae=_?"text":"shape"),1088&t.$$.dirty[0]|1073741824&t.$$.dirty[2]|65&t.$$.dirty[3]|2143289344&t.$$.dirty[4]|8388615&t.$$.dirty[5]&&i(22,G=ae==="text"&&$e&&mt?_c(()=>$e([["div","text-styles",{class:"PinturaShapeControlsGroup"},[...[["bold",{label:"B",style:"font-weight:900;",title:"Bold",shortcut:["CMD","B"]}],["italic",{label:"I",style:"font-family:Times New Roman;font-style:italic;",title:"Italic",shortcut:["CMD","I"]}],["underline",{label:"U",style:"text-decoration:underline;",title:"Underline",shortcut:["CMD","U"]}],["strikeThrough",{label:"S",style:"text-decoration:line-through;",title:"Strikethrough",shortcut:["CMD","S"]}]].map(([L,ot])=>["Button","style-"+L,{onclick:()=>document.execCommand(L),...ot,style:"font-size:1.25em;text-underline-offset:1px;text-decoration-thickness:1.5px;font-weight:400;"+ot.style}])]],["div","text-reset",{class:"PinturaShapeControlsGroup"},[["Button","style-reset",{onclick:()=>document.execCommand("removeFormat"),style:"font-weight:400;",label:'<span style="font-size:1.25em;font-style:italic;font-family:Times New Roman;text-decoration:underline;">T</span><span style="position:relative;top:.175rem;">&times;</span>',title:"Remove styles"}]]]],s)):ae==="shape"&&Xe&&s?_c(()=>Xe(w?[["div","epsilon",{class:"PinturaShapeControlsGroup"},[["Button","remove-point",{onclick:ls,label:Se.shapeTitleButtonRemove,icon:Se.shapeIconButtonRemove,shortcut:["Backspace"],hideLabel:!0}]]]]:[it&&["div","alpha",{class:"PinturaShapeControlsGroup"},[["ToggleSlider","adjust-opacity",{onrelease:Sr,onchange:Fr,step:.01,value:Ae(r,"opacity")?r.opacity:1,label:(L,ot,lt)=>Math.round(L/lt*100)+"%",min:0,max:1,direction:"x"}]]],["div","beta",{class:"PinturaShapeControlsGroup"},[dt&&["Button","flip-horizontal",{onclick:Ma,label:Se.shapeTitleButtonFlipHorizontal,icon:Se.shapeIconButtonFlipHorizontal,hideLabel:!0}],dt&&Ve&&["Button","flip-vertical",{onclick:jr,label:Se.shapeTitleButtonFlipVertical,icon:Se.shapeIconButtonFlipVertical,hideLabel:!0}],Z&&["Button","to-front",{onclick:ln,label:Se.shapeTitleButtonMoveToFront,icon:Se.shapeIconButtonMoveToFront,hideLabel:!0,disabled:ut[ut.length-1]===Mt}],K&&["Button","duplicate",{onclick:Lo,label:Se.shapeTitleButtonDuplicate,icon:Se.shapeIconButtonDuplicate,shortcut:["CMD","D"],hideLabel:!0}],q&&["Button","remove",{onclick:Ur,label:Se.shapeTitleButtonRemove,icon:Se.shapeIconButtonRemove,shortcut:["Backspace"],hideLabel:!0}]].filter(Boolean)],xt&&Tt&&["div","gamma",{class:"PinturaShapeControlsGroup"},[["Button","text-layout",{onclick:Ha,label:nr(cs,Se,r),icon:nr(jl,Se,r),hideLabel:!0}]]],xt&&["div","delta",{class:"PinturaShapeControlsGroup"},[["Button","edit-text",{label:Se.shapeLabelInputText,onclick:dl}]]]].filter(Boolean),s)):[]),64&t.$$.dirty[0]|8388608&t.$$.dirty[5]&&i(21,wt=ut.filter(ga).filter(L=>L.id).filter(L=>!bo(L)).map(L=>({id:L.id,color:Xn(L)?L.color:tr(L)?L.strokeColor:L.backgroundColor,name:L.name||Se["shapeLabelTool"+Jy(Lb(L))]})))},[xe,_t,Ie,Ge,Ut,Be,Se,cr,Fi,pa,s,_,x,l,p,m,k,h,Xt,ja,ds,wt,G,Ot,ht,yt,U,W,P,g,ur,On,b=>{const{origin:N}=b.detail;i(141,Pt=void 0),fe=void 0,xi=void 0,Gi=!1,je=void 0,hn=!1,go(),clearTimeout(wi),wi=setTimeout(()=>i(142,Si=!0),250);const L=Jr();if(!L||_n(L)&&Ae(L,"pathClose")||hr(),de=Le(Oe(N)),L&&_n(L)&&Ae(L,"pathClose"))return H(b);const ot=Ar(ut,de,Ti,Lt=>ga(Lt)),lt=ot.length&&ot.shift();if(r&&Qa(r)&&(Wa(),ri&&(hn=!0)),!lt&&r&&Qa(r)&&Kn(r),!!vi(N)){if(lt&&bs(lt))return Gi=!0,i(141,Pt=lt),fe=Hn(Pt),void(xi=Gn(Hn(Pt),jt));je=lt||void 0,!H(b)&&lt&&(cr(lt),i(141,Pt=lt),fe=Hn(Pt),xi=Gn(Hn(Pt),jt))}},b=>{Vi(),At(b)},b=>{const{translation:N,ctrlKey:L,metaKey:ot,shiftKey:lt,position:Lt}=b.detail;if(Pt){if(!wc(Pt)||Qa(Pt))return;if(lt){let Ht=Math.abs(N.x),Nt=Math.abs(N.y);Lr==="x"&&(Nt-=64),Lr==="y"&&(Ht-=64),Ht>Nt?(N.y=0,Lr="x"):Nt>Ht&&(N.x=0,Lr="y")}else Lr=null;return lo(Pt,xi,N,{...Mn(L||ot?0:Zi,sn,n,Pt)})}Bt(b)},b=>{if(Vi(),Pt){if(Qa(Pt)&&_a(),b.detail.isTap&&_n(Pt)&&Ty(Pt)){const{position:N}=b.detail,L=Le(Oe(N));return void((ot,lt)=>{const Lt=ot.points,Ht=[];for(let Vt=0;Vt<Lt.length-1;Vt++)Ht.push([Lt[Vt],Lt[Vt+1]]);Ht.push([Lt[Lt.length-1],Lt[0]]);const Nt=Ht.findIndex(([Vt,qt])=>pu(lt,6,Vt,qt));let Wt;const zt=[];for(let Vt=0;Vt<Ht.length;Vt++)zt.push(Ht[Vt][0]),Vt===Nt&&(Wt=Vt+1,zt.push(lt));_i(ot,{points:zt,selectedPoint:Wt})})(Pt,L)}b.detail.isTap&&Gi&&Xn(Pt)&&Cl(Pt)!==!1&&Nn(Pt)}else be(b)},b=>{const N=je&&b.detail.isTap;if(b.detail.isTap&&setTimeout(()=>{Kt({target:Pt||je,position:de},0)}),Pt)return nt(Pt),L=Pt,ot=fe,JSON.stringify(L)!==JSON.stringify(ot)&&Me(Pt),void i(141,Pt=void 0);var L,ot;const lt=uo(),Lt=!lt||le(lt,je||void 0);Lt&&wr({storePrevious:!1}),se(b),Lt&&N&&cr(je)},ti,b=>{i(142,Si=!0),i(141,Pt=r),xi=l},b=>{if(!Pt)return void i(142,Si=!1);const{translation:N,indexes:L,shiftKey:ot,ctrlKey:lt,metaKey:Lt,isNudge:Ht}=b.detail;((Nt,Wt,zt,Vt,qt)=>{const{shiftKey:ii,snapThreshold:oe=0,gridSize:ue=0,gridRect:ke,snapTargets:we=[]}=qt||{},Ye=oe?(ei,bi,ui)=>{const{snapTranslation:Mi,snapLines:cn}=xr(so(ei),we,oe,ue,ke);br(bi,Mi),Kr(cn);const Hi=pn(ui(),bi);ei.x=Hi.x,ei.y=Hi.y}:ge;if(tr(Nt)||_n(Nt)&&Ae(Nt,"pathClose")){const[ei]=zt,bi=ii?xn:(Ri,kn)=>kn;let ui,Mi,cn;if(tr(Nt))ei===0?(ui=()=>ts(Wt),Mi=Ri=>bi(es(Wt),Ri),cn=(Ri,kn)=>{Ri.x1=kn.x,Ri.y1=kn.y}):ei===1&&(ui=()=>es(Wt),Mi=Ri=>bi(ts(Wt),Ri),cn=(Ri,kn)=>{Ri.x2=kn.x,Ri.y2=kn.y});else{const Ri=Wt.points;ui=()=>({...Ri[ei]}),Mi=kn=>{const Ki=Ri[vu(ei-1,Ri)],Zn=Ri[vu(ei+1,Ri)];bi(Ki,kn),bi(Zn,kn)},cn=(kn,Ki)=>kn.points=kn.points.map((Zn,en)=>ei===en?Ki:Zn)}const Hi=pn(ui(),Vt);Ye(Hi,Vt,ui),Mi(Hi),cn(Nt,Hi)}else if(tl(Nt)||Yn(Nt)||nu(Nt)){let ei,bi,ui=!1;if(Yn(Nt))ei=cp(Wt);else if(tl(Nt))ei=xs(Wt);else{ui=!0,ei=xs(Wt);const Ki=Ko(Wt.text,Wt);ei.height=Ki.height}Nt.aspectRatio?bi=Nt.aspectRatio:qt.shiftKey&&!ui&&(bi=ei.width/ei.height);const Mi=xs(ei),cn=Ci(Mi),Hi=Nt.rotation,Ri=Wo(Mi),kn=$r(Mi,Hi);if(zt.length===1){let Ki=zt[0];Nt.flipX&&(Ki=ca[Ki]),Nt.flipY&&(Ki=Po[Ki]);const[Zn,en,Gr,Zr]=Ri,io=Gt(kn[Ki]),Ua=Dn({...io},Vt),Ra=Le(Ua);Ye(Ra,Vt,()=>Le(io));const Ga=rt(Ra.x-kn[Ki].x,Ra.y-kn[Ki].y),us=Xr(Oe(Ga),-Hi),Ia=rt(Ri[Ki].x+us.x,Ri[Ki].y+us.y);let Go;Ki===0&&(Go=Gr),Ki===1&&(Go=Zr),Ki===2&&(Go=Zn),Ki===3&&(Go=en);const yo=er([Go,Ia]);if(bi){const{width:hs,height:Os}=qr(yo,bi),[Ul,Ea,xo,Un]=ol(yo);yo.width=hs,yo.height=Os,Ia.y<Go.y&&(yo.y=xo-Os),Ia.x<Go.x&&(yo.x=Ea-hs)}const ps=$r(yo,Hi,cn),ha=Bo(ps),Za=Xr(ps[0],-Hi,ha),Zo=Xr(ps[2],-Hi,ha),Xa=er([Za,Zo]);Oi(Nt,Yn(Nt)?pm(Xa):Xa,jt)}else{zt=zt.map(Un=>(Nt.flipX&&(Un=ca[Un]),Nt.flipY&&(Un=Po[Un]),Un));const[Ki,Zn]=zt.map(Un=>kn[Un]),en={x:Ki.x+.5*(Zn.x-Ki.x),y:Ki.y+.5*(Zn.y-Ki.y)},[Gr,Zr]=zt.map(Un=>Ri[Un]),[io,Ua]=zt.map(Un=>{const ma=Un+2;return ma<4?Ri[ma]:Ri[ma-4]}),Ra={x:io.x+.5*(Ua.x-io.x),y:io.y+.5*(Ua.y-io.y)},Ga=Gt(en),us=Dn({...Ga},Vt),Ia=Le(us);Ye(Ia,Vt,()=>Le(Ga));const Go=rt(Ia.x-en.x,Ia.y-en.y),yo=Xr(Oe(Go),-Hi),ps=Bn(Oe(Gr),Zr),ha=So(ps,Un=>1-Math.abs(Math.sign(Un))),Za=rt(yo.x*ha.x,yo.y*ha.y);Dn(Gr,Za),Dn(Zr,Za);const Zo=er(Ri);if(bi){let Un=Zo.width,ma=Zo.height;ha.y===0?ma=Un/bi:Un=ma*bi,Zo.width=Un,Zo.height=ma,ha.y===0?Zo.y=Ra.y-.5*ma:Zo.x=Ra.x-.5*Un}const Xa=$r(Zo,Hi,cn),hs=Bo(Xa),Os=Xr(Xa[0],-Hi,hs),Ul=Xr(Xa[2],-Hi,hs),Ea=er([Os,Ul]);let xo;Yn(Nt)?xo=pm(Ea):tl(Nt)?xo=Ea:ui&&(xo={x:Ea.x,y:Ea.y,width:Ea.width}),Oi(Nt,xo,jt)}}Wn()})(Pt,xi,L,N,{shiftKey:!Ht&&ot,...Mn(lt||Lt?0:Zi,sn,n,Pt)}),gp(Pt)&&vo(N)>16&&_i(Pt,{selectedPoint:void 0})},b=>{if(!Pt)return void i(142,Si=!1);cr(Pt);const{isTap:N,translation:L,indexes:ot}=b.detail;N&&(gp(Pt)&&_i(Pt,{selectedPoint:Pt.selectedPoint===ot[0]?void 0:ot[0]}),nt(Pt)),i(141,Pt=void 0),i(142,Si=!1),Me(r)},b=>{Ro=ua(l).origin,i(142,Si=!0),i(141,Pt=r),xi=l},b=>{if(!Pt)return void i(142,Si=!1);const{translation:N,shiftKey:L}=b.detail;((ot,lt,Lt,Ht)=>{const Nt=En(Gn(Hn(ot),jt)),Wt=Ci(Nt),zt=pn(Ro,Lt);let Vt=Dd(zt,Wt)+Math.PI/2;if(Ht.shiftKey){const qt=Math.PI/16;Vt=qt*Math.round(Vt/qt)-Fe%qt}Oi(ot,{rotation:Vt},jt),Wn()})(Pt,0,N,{shiftKey:L})},()=>{Pt?(cr(Pt),i(141,Pt=void 0),i(142,Si=!1),Me(r)):i(142,Si=!1)},b=>{const{key:N}=b,L=/escape/i.test(N);if(co())return L?(b.preventDefault(),b.stopPropagation(),Kn(r)):void(K&&N==="d"&&(b.metaKey||b.ctrlKey)&&(b.preventDefault(),b.stopPropagation(),tn()))},b=>{const N=Cl(r,b);return N===!0?b:N},Ao,b=>{const{target:N,key:L}=b,ot=N.value||N.innerText,lt=N.selectionStart||0,Lt=N.selectionEnd||ot.length,Ht=ot.substring(0,lt)+L+ot.substring(Lt);if(Cl(r,Ht)!==Ht)return b.preventDefault()},b=>$u(r)&&/enter/i.test(b.code)&&r.disableNewline!==!1?b.preventDefault():/arrow/i.test(b.code)?b.stopPropagation():/escape/i.test(b.key)?_a():void 0,b=>{const{key:N,ctrlKey:L,altKey:ot}=b;if(/enter/i.test(N)&&(L||ot))return Wa()},Wa,_a,po,b=>{const N=Vr();N&&(Qa(N)||wc(N)&&(i(141,Pt=N),xi=Gn(Hn(Pt),jt),lo(Pt,xi,b.detail)))},b=>{i(19,ja=!0)},({relatedTarget:b})=>{b&&b.classList.contains("shape-selector__button")||i(19,ja=!1)},b=>{if(b.pointerType==="touch"||b.target.className!=="PinturaShapeEditor")return void Yt();(Si||wi)&&ul(void 0);const N=hh(b,Ge);i(144,Pa=Oe(N));const L=So(Le(N),lt=>Math.round(lt));if(vs(L,fo)||(fo=Oe(L),Zt(Si,N,L),Si||wi)||c)return;const[ot]=Ar(ut,L,0,ga);ot&&bo(ot)||ul(ot)},b=>{b.pointerType!=="touch"&&Yt()},Ce,yi,ze,Fe,hi,bt,ne,Ue,Ee,jt,Qe,mi,$i,Li,X,H,Bt,be,se,At,re,Me,De,_e,Ze,nt,Qt,Zt,Kt,Yt,st,le,ee,ye,Xe,$e,vi,Le,Gt,gi,Ti,Ve,ri,Zi,un,wn,sn,ao,fn,Rr,Sn,Vn,yn,To,(b,N={})=>{let L,ot,lt,Lt=Yn(b),Ht=Xn(b),Nt=N.position==="relative";const Wt=an(),zt=oe=>{if(!Zi)return oe;const ue=Le(oe),{snapTranslation:ke,snapLines:we}=xr(so(ue),Wt,Zi,sn,n);return br(oe,ke),Kr(we),oe},Vt=!!uo(),qt=N.isSelection?ze:_t,ii=N.inputMode==="step";if(_n(b)){if(ii){let oe=!1;const ue=(ke,we)=>{const Ye=fn(qt),ei=ke&&rt(Jd(ke.x,jt.width),Jd(ke.y,jt.height)),bi=ei&&Gt(ei);te.includes(16)&&bi&&xn(bi,we);const ui=Le(we),Mi=Ye.points.length?Ye.points[0]:ui,cn=rt(Jd(Mi.x,jt.width),Jd(Mi.y,jt.height)),Hi=Gt(cn),Ri=vo(Hi,we);if(!oe&&Ye.points.length===1&&Ri<36)return Sn(qt);if(Ye.points.length>2&&Ri<=256){Ye.pathClose=!0,ga(Ye)&&cr(Ye);const Zn=Vn(qt);return void re(Zn)}const kn=Ye.strokeWidth&&Ye.strokeColor&&(Ye.strokeColor[3]===void 0||Ye.strokeColor[3]>0),Ki=vo(bi,we);if(kn&&Ye.points.length>1&&Ki<256){Ye.pathClose=!1,Ye.backgroundColor=[0,0,0,0],ga(Ye)&&cr(Ye);const Zn=Vn(qt);re(Zn)}else if(!(Ye.points.length>0&&Ki<100))return Nt?vc(ui,jt):ui};return{start:ke=>{const we=fn(qt),{origin:Ye}=ke.detail;if(ot=4,L=zt(Oe(Ye)),lt=Oe(L),we){const ei=we.points[we.points.length-1],bi=ue(ei,L);return bi&&(we.points=[...we.points,bi]),void yn({points:we.points},qt)}oe=!0},update:ke=>{if(!oe)return;const we=fn(qt);if(!we)return;const Ye=we.points[0],ei=ue(Ye,rt(L.x+ke.detail.translation.x,L.y+ke.detail.translation.y));ei&&(we.points[1]=ei,yn({points:we.points},qt))},release:ke=>ke.detail.preventInertia(),end:ke=>{if(!oe)return;const we=Le(L),Ye=Nt?vc(we,jt):we,{isTap:ei}=ke.detail;if(ei&&Ar(ut,we,0,ga).length)return Sn(qt);Rr({...b,points:[Ye]},qt)}}}return{start:oe=>{const{origin:ue}=oe.detail;ot=4,L=Oe(ue),lt=Oe(L);const ke=Le(L),we=Nt?vc(ke,jt):ke;Rr({...b,points:[we]},qt)},update:oe=>{const ue=fn(qt),{translation:ke}=oe.detail,we=rt(L.x+ke.x,L.y+ke.y),Ye=mo(lt,we);if(ai(Ye,5)<=ot)return;const ei=Dd(we,lt),bi=ot-Ye;lt.x+=bi*Math.cos(ei),lt.y+=bi*Math.sin(ei);const ui=Le(lt),Mi=Nt?vc(ui,jt):ui;yn({points:ue.points.concat(Mi)},qt)},release:oe=>oe.detail.preventInertia(),cancel:()=>{Sn(qt)},end:oe=>{const ue=fn(qt);if(oe.detail.isTap){let we=!1;if(ue.bitmap?(je&&(we=!0),Vt&&(we=!0)):we=!0,we)return Sn(qt)}const ke=Vn(qt);re(ke)}}}return Lt||Ht||wo(b)?{start:oe=>{const{origin:ue}=oe.detail;L=zt(Oe(ue));const ke=Le(L),we=Nt?vc(ke,jt):ke,Ye=-1*No(Fe,hi,bt),ei={...b,rotation:Ye,...we};ei.flipX=hi,ei.flipY=bt,delete ei.position,ei.opacity=0,(Lt?["rx","ry"]:["width","height"]).forEach(bi=>{ei[bi]=Nt?"0%":0}),Rr(ei,qt)},update:oe=>{const ue=fn(qt);ue.opacity=1;let{aspectRatio:ke}=ue,{translation:we,shiftKey:Ye,ctrlKey:ei}=oe.detail;!ke&&Ye&&(ke=1);const bi=zt(rt(L.x+we.x,L.y+we.y)),ui=Le(L),Mi=Le(bi);if(ke){const Gr=er([ui,Mi]),Zr=qr(Gr,ke),io=Mi.x<ui.x?-1:1,Ua=Mi.y<ui.y?-1:1;Mi.x=ui.x+Zr.width*io,Mi.y=ui.y+Zr.height*Ua}const cn={x:ui.x+.5*(Mi.x-ui.x),y:ui.y+.5*(Mi.y-ui.y)},Hi=No(Fe,hi,bt);Xr(ui,Hi,cn),Xr(Mi,Hi,cn);const Ri=Math.min(ui.x,Mi.x),kn=Math.min(ui.y,Mi.y);let Ki=Math.max(ui.x,Mi.x)-Ri,Zn=Math.max(ui.y,Mi.y)-kn,en={};Lt?(ei?(en.x=ui.x,en.y=ui.y):(en.x=Ri+.5*Ki,en.y=kn+.5*Zn),en.rx=.5*Ki,en.ry=.5*Zn):(ei?(en.x=ui.x-.5*Ki,en.y=ui.y-.5*Zn):(en.x=Ri,en.y=kn),en.width=Ki,en.height=Zn),yn(en,qt,(Gr,Zr)=>Oi(Gr,Zr,jt))},release:oe=>{oe.detail.preventInertia()},cancel:oe=>{Sn(qt)},end:oe=>{const ue=fn(qt);if(oe.detail.isTap){if(Xn(ue)&&ri&&hn||!Xn(ue)||!ri||je)return Sn(qt);delete ue.width,delete ue.height,ue.disableNewline!==!1&&delete ue.textAlign;const ke=Gn({...ue},jt),we=Ko(ue.text,ke),Ye=Le({x:L.x,y:L.y-.5*we.height}),ei=Le({x:L.x+we.width,y:L.y+.5*we.height}),bi={x:Ye.x+.5*(ei.x-Ye.x),y:Ye.y+.5*(ei.y-Ye.y)},ui=No(Fe,hi,bt);Xr(Ye,ui,bi),Xr(ei,ui,bi);let Mi=Math.min(Ye.x,ei.x),cn=Math.min(Ye.y,ei.y);Mi<0&&(Mi=0),cn<0&&(cn=0),Mi+we.width>jt.width&&(Mi=jt.width-we.width),cn+we.height>jt.height&&(cn=jt.height-we.height),ue.x=We(ue.x)?Dr(Mi,jt.width):Mi,ue.y=We(ue.y)?Dr(cn,jt.height):cn}if(ue.opacity=1,Xn(ue))re(ue);else{const ke=Vn(qt);re(ke)}ga(ue)&&cr(ue),Xn(ue)&&Nn(ue)}}:tr(b)?{start:oe=>{const{origin:ue}=oe.detail,ke=Le(zt(ue)),we=So(ke,Oc);L=Oe(ue),Rr({...b,x1:Nt?Dr(we.x,jt.width):we.x,y1:Nt?Dr(we.y,jt.height):we.y,x2:Nt?Dr(we.x,jt.width):we.x,y2:Nt?Dr(we.y,jt.height):we.y,opacity:0},qt)},update:oe=>{const{translation:ue}=oe.detail,ke=zt(Dn(Oe(L),ue));if(te.includes(16)){const Ye=mo(L,ke),ei=Dd(L,ke),bi=Math.PI/4,ui=bi*Math.round(ei/bi);ke.x=L.x+Ye*Math.cos(ui),ke.y=L.y+Ye*Math.sin(ui)}const we=Le(ke);yn({x2:Nt?Dr(we.x,jt.width):we.x,y2:Nt?Dr(we.y,jt.height):we.y,opacity:1},qt)},release:oe=>oe.detail.preventInertia(),cancel:oe=>{Sn(qt)},end:oe=>{const ue=fn(qt);if(oe.detail.isTap)return Sn(qt);ue.opacity=1;const ke=Vn(qt);re(ke),ga(ue)&&cr(ke)}}:void 0},()=>{let b,N;const L=gi*gi,ot=(lt,Lt,Ht=!1)=>{const Nt=vo(lt,Lt);if(!Ht&&Nt<2)return!1;const Wt=ut.filter(Vt=>!Vt.disableErase);let zt;return zt=Nt<L?Ar(ut,Le(Lt),gi):O(Wt,Le(lt),Le(Lt),gi),to(zt).forEach(Ze),!0};return{start:lt=>{b=rt(Math.round(lt.detail.origin.x),Math.round(lt.detail.origin.y)),ot(b,b,!0),N=b},update:lt=>{const{translation:Lt}=lt.detail,Ht=rt(Math.round(b.x+Lt.x),Math.round(b.y+Lt.y));ot(N,Ht)&&(N=Oe(Ht))},release:lt=>lt.detail.preventInertia(),end:()=>{}}},Jr,Ir,b=>{if(!Jr())return Zp(b),To(b)},hr,vr,(b={})=>({id:na(),...b}),Wn,Wi,_i,lr,(b,N,L=!0)=>{ut.forEach(ot=>lr(ot,b,N,!1)),L&&Wn()},qi,Vr,co,Qr,mr,wr,Kn,Nn,Er,to,eo,En,Ar,O,Mo,pr,Pt,Si,Hr,Pa,c,xt,r,Tt,q,K,Mt,Z,dt,it,w,ae,mt,Dt,ie,C,Ft,J,a,S,at,j,y,B,n,T,F,D,f,R,d,o,u,ut,ce,te,ve,function(b){Wr.call(this,t,b)},b=>cr(_t[b]),function(b){Ai[b?"unshift":"push"](()=>{Fi=b,i(8,Fi)})},function(){ht=this.value,i(24,ht),i(11,_),i(147,r),i(167,y),i(0,xe),i(178,ut)},function(b){Ai[b?"unshift":"push"](()=>{Fi=b,i(8,Fi)})},()=>{ds&&ds.focus()},b=>i(9,pa=b.detail),function(b){Ai[b?"unshift":"push"](()=>{ds=b,i(20,ds)})},b=>hh(b,Ge)]}class HS extends li{constructor(e){super(),si(this,e,NS,VS,ni,{uid:58,ui:59,disabled:0,shapes:1,selection:60,offset:2,contextRotation:61,contextFlipX:62,contextFlipY:63,contextZoom:64,active:65,opacity:66,parentRect:67,rootRect:3,utilRect:68,hoverColor:69,caretColor:70,gridColor:71,snapColor:72,textInputMode:4,oninteractionstart:73,oninteractionupdate:74,oninteractionrelease:75,oninteractionend:76,oninteractioncancel:77,onaddshape:78,onupdateshape:79,onselectshape:80,onblurshape:81,onremoveshape:82,ontapshape:83,onhovershape:84,onhovercanvas:85,ontapcanvas:86,onleavecanvas:87,beforeSelectShape:88,beforeDeselectShape:89,beforeRemoveShape:90,beforeUpdateShape:91,willRenderShapeControls:92,willRenderShapeTextControls:93,willStartInteraction:94,mapEditorPointToImagePoint:95,mapImagePointToEditorPoint:96,eraseRadius:97,selectRadius:98,enableButtonFlipVertical:99,enableTapToAddText:100,enableTextStyleControls:5,locale:6,snapThreshold:101,snapPointer:102,enableSnapToContext:103,gridSize:104,syncShapeCollection:105,getShapeDraft:106,addShapeDraft:107,discardShapeDraft:108,confirmShapeDraft:109,updateShapeDraft:110,addShape:111,createShape:112,eraseShape:113,getMarkupItemDraft:114,getMarkupItemDraftIndex:115,addMarkupItemDraft:116,confirmMarkupItemDraft:117,discardMarkupItemDraft:118,createMarkupItem:119,syncShapes:120,removeMarkupShapeProps:121,updateMarkupShape:122,updateMarkupShapeProperty:123,updateMarkupItemsShapeProperty:124,updateMarkupShapeItems:125,getActiveMarkupItem:126,hasActiveMarkupItem:127,removeShape:128,removeActiveMarkupItem:129,blurShapes:130,selectShape:7,deselectMarkupItem:131,editMarkupItem:132,finishEditMarkupItem:133,removeMarkupItems:134,getTextShapeRect:135,getMarkupShapeRect:136,getShapesNearPosition:137,getShapesBetweenPoints:138},null,[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1])}get syncShapeCollection(){return this.$$.ctx[105]}get getShapeDraft(){return this.$$.ctx[106]}get addShapeDraft(){return this.$$.ctx[107]}get discardShapeDraft(){return this.$$.ctx[108]}get confirmShapeDraft(){return this.$$.ctx[109]}get updateShapeDraft(){return this.$$.ctx[110]}get addShape(){return this.$$.ctx[111]}get createShape(){return this.$$.ctx[112]}get eraseShape(){return this.$$.ctx[113]}get getMarkupItemDraft(){return this.$$.ctx[114]}get getMarkupItemDraftIndex(){return this.$$.ctx[115]}get addMarkupItemDraft(){return this.$$.ctx[116]}get confirmMarkupItemDraft(){return this.$$.ctx[117]}get discardMarkupItemDraft(){return this.$$.ctx[118]}get createMarkupItem(){return this.$$.ctx[119]}get syncShapes(){return this.$$.ctx[120]}get removeMarkupShapeProps(){return this.$$.ctx[121]}get updateMarkupShape(){return this.$$.ctx[122]}get updateMarkupShapeProperty(){return this.$$.ctx[123]}get updateMarkupItemsShapeProperty(){return this.$$.ctx[124]}get updateMarkupShapeItems(){return this.$$.ctx[125]}get getActiveMarkupItem(){return this.$$.ctx[126]}get hasActiveMarkupItem(){return this.$$.ctx[127]}get removeShape(){return this.$$.ctx[128]}get removeActiveMarkupItem(){return this.$$.ctx[129]}get blurShapes(){return this.$$.ctx[130]}get selectShape(){return this.$$.ctx[7]}get deselectMarkupItem(){return this.$$.ctx[131]}get editMarkupItem(){return this.$$.ctx[132]}get finishEditMarkupItem(){return this.$$.ctx[133]}get removeMarkupItems(){return this.$$.ctx[134]}get getTextShapeRect(){return this.$$.ctx[135]}get getMarkupShapeRect(){return this.$$.ctx[136]}get getShapesNearPosition(){return this.$$.ctx[137]}get getShapesBetweenPoints(){return this.$$.ctx[138]}}function jS(t){let e,i,n;return i=new oo({props:{items:t[2]}}),{c(){e=pt("ul"),Et(i.$$.fragment),v(e,"class","PinturaShapeStyleList")},m(r,o){et(r,e,o),Rt(i,e,null),n=!0},p(r,o){const a={};4&o&&(a.items=r[2]),i.$set(a)},i(r){n||(M(i.$$.fragment,r),n=!0)},o(r){z(i.$$.fragment,r),n=!1},d(r){r&&tt(e),It(i)}}}function US(t){let e,i;return e=new Ca({props:{class:"PinturaShapeStyles",elasticity:t[0],$$slots:{default:[GS]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};1&r&&(o.elasticity=n[0]),131076&r&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function GS(t){let e,i,n;return i=new oo({props:{items:t[2]}}),{c(){e=pt("ul"),Et(i.$$.fragment),v(e,"class","PinturaShapeStyleList")},m(r,o){et(r,e,o),Rt(i,e,null),n=!0},p(r,o){const a={};4&o&&(a.items=r[2]),i.$set(a)},i(r){n||(M(i.$$.fragment,r),n=!0)},o(r){z(i.$$.fragment,r),n=!1},d(r){r&&tt(e),It(i)}}}function ZS(t){let e,i,n,r;const o=[US,jS],a=[];function s(l,c){return l[1]?0:1}return i=s(t),n=a[i]=o[i](t),{c(){e=pt("div"),n.c(),v(e,"style",t[3])},m(l,c){et(l,e,c),a[i].m(e,null),r=!0},p(l,[c]){let d=i;i=s(l),i===d?a[i].p(l,c):(Pe(),z(a[d],1,1,()=>{a[d]=null}),Re(),n=a[i],n?n.p(l,c):(n=a[i]=o[i](l),n.c()),M(n,1),n.m(e,null)),(!r||8&c)&&v(e,"style",l[3])},i(l){r||(M(n),r=!0)},o(l){z(n),r=!1},d(l){l&&tt(e),a[i].d()}}}function XS(t,e,i){let n,r,o,a,s,l,{isActive:c=!1}=e,{controls:d=[]}=e,{locale:u}=e,{scrollElasticity:p}=e,{scrollEnable:h=!0}=e,{hideTitles:g=!1}=e,{willRenderControls:m=Yi}=e;const f=dn("redrawTrigger");A(t,f,C=>i(14,a=C));const x=dn("env");A(t,x,C=>i(13,o=C));const k=dn("isAnimated");A(t,k,C=>i(16,l=C));const w=ci(0,{stiffness:.25,damping:.9});return A(t,w,C=>i(15,s=C)),t.$$set=C=>{"isActive"in C&&i(8,c=C.isActive),"controls"in C&&i(9,d=C.controls),"locale"in C&&i(10,u=C.locale),"scrollElasticity"in C&&i(0,p=C.scrollElasticity),"scrollEnable"in C&&i(1,h=C.scrollEnable),"hideTitles"in C&&i(11,g=C.hideTitles),"willRenderControls"in C&&i(12,m=C.willRenderControls)},t.$$.update=()=>{65792&t.$$.dirty&&w.set(c?1:0,{hard:l===!1}),33024&t.$$.dirty&&i(3,n=`opacity:${s};${c?"":"pointer-events:none;"}${s<=0?"visibility:hidden":""}`),32256&t.$$.dirty&&i(2,r=a&&m(d.map(C=>["ShapeStyle",C.id,{title:C.componentProps.title,locale:u,hideTitle:g,items:[[C.component,C.id,C.componentProps]]}]),o,()=>f.set({})))},[p,h,r,n,f,x,k,w,c,d,u,g,m,o,a,s,l]}class YS extends li{constructor(e){super(),si(this,e,XS,ZS,ni,{isActive:8,controls:9,locale:10,scrollElasticity:0,scrollEnable:1,hideTitles:11,willRenderControls:12})}}function Cf(t,e,i){const n=t.slice();return n[15]=e[i].key,n[6]=e[i].controls,n[16]=e[i].isActive,n}function Tf(t,e){let i,n,r;return n=new YS({props:{isActive:e[16],controls:e[6],locale:e[1],scrollElasticity:e[2],scrollEnable:e[3],hideTitles:e[4],willRenderControls:e[5]}}),{key:t,first:null,c(){i=Tn(),Et(n.$$.fragment),this.first=i},m(o,a){et(o,i,a),Rt(n,o,a),r=!0},p(o,a){e=o;const s={};128&a&&(s.isActive=e[16]),128&a&&(s.controls=e[6]),2&a&&(s.locale=e[1]),4&a&&(s.scrollElasticity=e[2]),8&a&&(s.scrollEnable=e[3]),16&a&&(s.hideTitles=e[4]),32&a&&(s.willRenderControls=e[5]),n.$set(s)},i(o){r||(M(n.$$.fragment,o),r=!0)},o(o){z(n.$$.fragment,o),r=!1},d(o){o&&tt(i),It(n,o)}}}function qS(t){let e,i,n,r=[],o=new Map,a=t[7];const s=l=>l[15];for(let l=0;l<a.length;l+=1){let c=Cf(t,a,l),d=s(c);o.set(d,r[l]=Tf(d,c))}return{c(){e=pt("div");for(let l=0;l<r.length;l+=1)r[l].c();v(e,"class",i=pi(["PinturaShapeStyleEditor",!t[3]&&"PinturaShapeStyleEditorOverflow",t[0]]))},m(l,c){et(l,e,c);for(let d=0;d<r.length;d+=1)r[d].m(e,null);n=!0},p(l,[c]){190&c&&(a=l[7],Pe(),r=Ba(r,c,s,1,l,a,o,e,zs,Tf,null,Cf),Re()),(!n||9&c&&i!==(i=pi(["PinturaShapeStyleEditor",!l[3]&&"PinturaShapeStyleEditorOverflow",l[0]])))&&v(e,"class",i)},i(l){if(!n){for(let c=0;c<a.length;c+=1)M(r[c]);n=!0}},o(l){for(let c=0;c<r.length;c+=1)z(r[c]);n=!1},d(l){l&&tt(e);for(let c=0;c<r.length;c+=1)r[c].d()}}}function KS(t,e,i){let n,r,o,{class:a}=e,{controls:s={}}=e,{shape:l}=e,{onchange:c}=e,{locale:d}=e,{scrollElasticity:u}=e,{scrollEnable:p=!0}=e,{hideTitles:h=!1}=e,{willRenderControls:g}=e;const m=[];return t.$$set=f=>{"class"in f&&i(0,a=f.class),"controls"in f&&i(6,s=f.controls),"shape"in f&&i(8,l=f.shape),"onchange"in f&&i(9,c=f.onchange),"locale"in f&&i(1,d=f.locale),"scrollElasticity"in f&&i(2,u=f.scrollElasticity),"scrollEnable"in f&&i(3,p=f.scrollEnable),"hideTitles"in f&&i(4,h=f.hideTitles),"willRenderControls"in f&&i(5,g=f.willRenderControls)},t.$$.update=()=>{64&t.$$.dirty&&i(11,n=Object.keys(s).filter(f=>s[f])),2304&t.$$.dirty&&i(10,r=l&&Object.keys(l).length&&n&&Xp(l)?(f=>n.filter(x=>x.split("_").every(k=>Ae(f,k)&&Xp(f,k))).map(x=>{const k=(f.settings&&f.settings[x]||{}).control||x,w=x.split("_"),C=w.length>1?w.map(T=>f[T]):f[x];if(on(s[k])){const{title:T,component:F}=s[k](C,D=>{c({[x]:D})},{selectedShapeId:f.id});return{id:k,component:oo,componentProps:{title:T,items:F}}}let[P,R]=s[k];if(We(P)&&s[P]){const T={...R};[P,R]=s[P],R={...R,...T}}const W=on(R.options)?R.options(f):R.options;return P==="RadioGroup"&&(R.selectedIndex=-1),{id:k,component:P,componentProps:{...R,options:W,locale:d,value:C,optionLabelClass:"PinturaButtonLabel",onchange:T=>{const F=al(T)&&!Ln(T)?T.value:T;R.onchange&&R.onchange(F,f);const D=w.length>1?w.reduce((B,y,_)=>({...B,[y]:Array.isArray(F)?F[_]:F}),{}):{[x]:F};c(D)}}}}).filter(Boolean))(l):[]),1280&t.$$.dirty&&i(7,o=((f,x)=>{let k=m.find(w=>w.key===f);return k||(k={key:f,controls:x},m.push(k)),m.forEach(w=>w.isActive=!1),k.controls=x,k.isActive=!0,m})(l&&Object.keys(l).length?Object.keys(l).join("_"):"none",r||[]))},[a,d,u,p,h,g,s,o,l,c,r,n]}class Du extends li{constructor(e){super(),si(this,e,KS,qS,ni,{class:0,controls:6,shape:8,onchange:9,locale:1,scrollElasticity:2,scrollEnable:3,hideTitles:4,willRenderControls:5})}}var K2=t=>/<svg /.test(t);function JS(t){let e,i;return e=new oo({props:{items:t[10]}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};1024&r&&(o.items=n[10]),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function QS(t){let e,i,n,r;const o=[e6,t6],a=[];function s(l,c){return l[8]?0:1}return e=s(t),i=a[e]=o[e](t),{c(){i.c(),n=Tn()},m(l,c){a[e].m(l,c),et(l,n,c),r=!0},p(l,c){let d=e;e=s(l),e===d?a[e].p(l,c):(Pe(),z(a[d],1,1,()=>{a[d]=null}),Re(),i=a[e],i?i.p(l,c):(i=a[e]=o[e](l),i.c()),M(i,1),i.m(n.parentNode,n))},i(l){r||(M(i),r=!0)},o(l){z(i),r=!1},d(l){a[e].d(l),l&&tt(n)}}}function t6(t){let e,i,n,r,o=t[10]&&Mf(t);return n=new Ca({props:{scrollAutoCancel:t[9],elasticity:t[0],$$slots:{default:[i6]},$$scope:{ctx:t}}}),{c(){e=pt("div"),o&&o.c(),i=he(),Et(n.$$.fragment),v(e,"class","PinturaShapePresetsFlat")},m(a,s){et(a,e,s),o&&o.m(e,null),kt(e,i),Rt(n,e,null),r=!0},p(a,s){a[10]?o?(o.p(a,s),1024&s&&M(o,1)):(o=Mf(a),o.c(),M(o,1),o.m(e,i)):o&&(Pe(),z(o,1,1,()=>{o=null}),Re());const l={};512&s&&(l.scrollAutoCancel=a[9]),1&s&&(l.elasticity=a[0]),536871070&s&&(l.$$scope={dirty:s,ctx:a}),n.$set(l)},i(a){r||(M(o),M(n.$$.fragment,a),r=!0)},o(a){z(o),z(n.$$.fragment,a),r=!1},d(a){a&&tt(e),o&&o.d(),It(n)}}}function e6(t){let e,i,n,r,o;i=new Ca({props:{elasticity:t[0],class:"PinturaShapePresetsGroups",$$slots:{default:[o6]},$$scope:{ctx:t}}});const a=[{class:"PinturaControlPanels"},{panelClass:"PinturaControlPanel"},{panels:t[11]},t[12]];let s={$$slots:{default:[s6,({panel:l,panelIsActive:c})=>({26:l,27:c}),({panel:l,panelIsActive:c})=>(l?67108864:0)|(c?134217728:0)]},$$scope:{ctx:t}};for(let l=0;l<a.length;l+=1)s=In(s,a[l]);return r=new Eu({props:s}),{c(){e=pt("div"),Et(i.$$.fragment),n=he(),Et(r.$$.fragment),v(e,"class","PinturaShapePresetsGrouped")},m(l,c){et(l,e,c),Rt(i,e,null),kt(e,n),Rt(r,e,null),o=!0},p(l,c){const d={};1&c&&(d.elasticity=l[0]),536876128&c&&(d.$$scope={dirty:c,ctx:l}),i.$set(d);const u=6144&c?yr(a,[a[0],a[1],2048&c&&{panels:l[11]},4096&c&&Pr(l[12])]):{};738206239&c&&(u.$$scope={dirty:c,ctx:l}),r.$set(u)},i(l){o||(M(i.$$.fragment,l),M(r.$$.fragment,l),o=!0)},o(l){z(i.$$.fragment,l),z(r.$$.fragment,l),o=!1},d(l){l&&tt(e),It(i),It(r)}}}function Mf(t){let e,i;return e=new oo({props:{items:t[10]}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};1024&r&&(o.items=n[10]),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function i6(t){let e,i;return e=new qh({props:{items:t[7],onclickitem:t[1],ongrabitem:t[2],ondragitem:t[3],ondropitem:t[4]}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};128&r&&(o.items=n[7]),2&r&&(o.onclickitem=n[1]),4&r&&(o.ongrabitem=n[2]),8&r&&(o.ondragitem=n[3]),16&r&&(o.ondropitem=n[4]),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function Pf(t){let e,i;return e=new oo({props:{items:t[10]}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};1024&r&&(o.items=n[10]),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function Rf(t){let e,i;return e=new Co({props:{$$slots:{default:[n6]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};805306368&r&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function n6(t){let e,i=t[28].icon+"";return{c(){e=fr("g")},m(n,r){et(n,e,r),e.innerHTML=i},p(n,r){268435456&r&&i!==(i=n[28].icon+"")&&(e.innerHTML=i)},d(n){n&&tt(e)}}}function If(t){let e,i,n=t[28].label+"";return{c(){e=pt("span"),i=gn(n)},m(r,o){et(r,e,o),kt(e,i)},p(r,o){268435456&o&&n!==(n=r[28].label+"")&&zn(i,n)},d(r){r&&tt(e)}}}function r6(t){let e,i,n,r=t[28].icon&&Rf(t),o=!t[28].hideLabel&&If(t);return{c(){r&&r.c(),e=he(),o&&o.c(),i=Tn()},m(a,s){r&&r.m(a,s),et(a,e,s),o&&o.m(a,s),et(a,i,s),n=!0},p(a,s){a[28].icon?r?(r.p(a,s),268435456&s&&M(r,1)):(r=Rf(a),r.c(),M(r,1),r.m(e.parentNode,e)):r&&(Pe(),z(r,1,1,()=>{r=null}),Re()),a[28].hideLabel?o&&(o.d(1),o=null):o?o.p(a,s):(o=If(a),o.c(),o.m(i.parentNode,i))},i(a){n||(M(r),n=!0)},o(a){z(r),n=!1},d(a){r&&r.d(a),a&&tt(e),o&&o.d(a),a&&tt(i)}}}function o6(t){let e,i,n,r=t[10]&&Pf(t);const o=[{class:"PinturaControlList"},{tabs:t[5]},t[12],{layout:"compact"}];let a={$$slots:{default:[r6,({tab:s})=>({28:s}),({tab:s})=>s?268435456:0]},$$scope:{ctx:t}};for(let s=0;s<o.length;s+=1)a=In(a,o[s]);return i=new Iu({props:a}),i.$on("select",t[18]),{c(){r&&r.c(),e=he(),Et(i.$$.fragment)},m(s,l){r&&r.m(s,l),et(s,e,l),Rt(i,s,l),n=!0},p(s,l){s[10]?r?(r.p(s,l),1024&l&&M(r,1)):(r=Pf(s),r.c(),M(r,1),r.m(e.parentNode,e)):r&&(Pe(),z(r,1,1,()=>{r=null}),Re());const c=4128&l?yr(o,[o[0],32&l&&{tabs:s[5]},4096&l&&Pr(s[12]),o[3]]):{};805306368&l&&(c.$$scope={dirty:l,ctx:s}),i.$set(c)},i(s){n||(M(r),M(i.$$.fragment,s),n=!0)},o(s){z(r),z(i.$$.fragment,s),n=!1},d(s){r&&r.d(s),s&&tt(e),It(i,s)}}}function a6(t){let e,i;return e=new qh({props:{items:t[13][t[26]].items,disabled:t[13][t[26]].disabled,onclickitem:t[1],ongrabitem:t[2],ondragitem:t[3],ondropitem:t[4]}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};67117056&r&&(o.items=n[13][n[26]].items),67117056&r&&(o.disabled=n[13][n[26]].disabled),2&r&&(o.onclickitem=n[1]),4&r&&(o.ongrabitem=n[2]),8&r&&(o.ondragitem=n[3]),16&r&&(o.ondropitem=n[4]),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function s6(t){let e,i;return e=new Ca({props:{scroll:t[27]?{scrollOffset:0,animate:!1}:void 0,scrollAutoCancel:t[9],elasticity:t[0],$$slots:{default:[a6]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};134217728&r&&(o.scroll=n[27]?{scrollOffset:0,animate:!1}:void 0),512&r&&(o.scrollAutoCancel=n[9]),1&r&&(o.elasticity=n[0]),603987998&r&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function l6(t){let e,i,n,r;const o=[QS,JS],a=[];function s(l,c){return l[9]?0:l[10]?1:-1}return~(i=s(t))&&(n=a[i]=o[i](t)),{c(){e=pt("div"),n&&n.c(),v(e,"class","PinturaShapePresetsPalette")},m(l,c){et(l,e,c),~i&&a[i].m(e,null),r=!0},p(l,[c]){let d=i;i=s(l),i===d?~i&&a[i].p(l,c):(n&&(Pe(),z(a[d],1,1,()=>{a[d]=null}),Re()),~i?(n=a[i],n?n.p(l,c):(n=a[i]=o[i](l),n.c()),M(n,1),n.m(e,null)):n=null)},i(l){r||(M(n),r=!0)},o(l){z(n),r=!1},d(l){l&&tt(e),~i&&a[i].d()}}}function c6(t,e,i){let n,r,o,a,s,l,c,d,u,{locale:p}=e,{presets:h}=e,{scrollElasticity:g}=e,{enableSelectImage:m=!0}=e,{willRenderPresetToolbar:f=Yi}=e,{onaddpreset:x=ge}=e,{ongrabpreset:k}=e,{ondragpreset:w}=e,{ondroppreset:C}=e;const P="presets-"+na(),R=(D,B="")=>K2(D)?D:mu(D)?xy(D,B):`<img src="${D}" alt="${B}"/>`,W=D=>ty(Sh(D)),T=["src","alt","thumb","shape","id","mount","disabled"],F=D=>D.map(B=>(y=>Ln(y)&&We(y[0])&&Ln(y[1]))(B)?{...B[2],id:`${P}-${B[0].toLowerCase()}`,label:B[0],items:F(B[1])}:(y=>{let _,J,S,j,Q,ht,at,U=y;return We(y)?mu(y)?(_=y,Q=y,j=R(_,Q)):(_=y,Q=W(_),j=R(_,Q)):(_=y.src,Q=y.alt||(We(_)?W(_):We(y.thumb)?W(y.thumb):void 0),j=R(y.thumb||_,Q),J=y.shape,ht=y.mount,at=y.disabled,S=Object.keys(y).reduce((yt,$t)=>(T.includes($t)||(yt[$t]=y[$t]),yt),{})),{id:U,src:_,thumb:j,shape:J,shapeProps:S,alt:Q,title:Q,mount:ht,disabled:at}})(B));return t.$$set=D=>{"locale"in D&&i(14,p=D.locale),"presets"in D&&i(15,h=D.presets),"scrollElasticity"in D&&i(0,g=D.scrollElasticity),"enableSelectImage"in D&&i(16,m=D.enableSelectImage),"willRenderPresetToolbar"in D&&i(17,f=D.willRenderPresetToolbar),"onaddpreset"in D&&i(1,x=D.onaddpreset),"ongrabpreset"in D&&i(2,k=D.ongrabpreset),"ondragpreset"in D&&i(3,w=D.ondragpreset),"ondroppreset"in D&&i(4,C=D.ondroppreset)},t.$$.update=()=>{32768&t.$$.dirty&&i(7,n=F(h)),128&t.$$.dirty&&i(9,r=n.length),640&t.$$.dirty&&i(8,o=r&&n.some(D=>!!D.items)),384&t.$$.dirty&&i(5,a=o&&n),384&t.$$.dirty&&i(13,s=o&&n.reduce((D,B)=>(D[B.id]=B,D),{})),96&t.$$.dirty&&i(6,l=l||a&&(a.find(D=>!D.disabled)||{}).id),64&t.$$.dirty&&i(12,c={name:P,selected:l}),32&t.$$.dirty&&i(11,d=a&&a.map(D=>D.id)),212994&t.$$.dirty&&i(10,u=p&&f([m&&["Button","browse",{label:p.shapeLabelButtonSelectSticker,icon:p.shapeIconButtonSelectSticker,onclick:()=>{F2().then(D=>{D&&x(D)})}}]]))},[g,x,k,w,C,a,l,n,o,r,u,d,c,s,p,h,m,f,({detail:D})=>i(6,l=D)]}class J2 extends li{constructor(e){super(),si(this,e,c6,l6,ni,{locale:14,presets:15,scrollElasticity:0,enableSelectImage:16,willRenderPresetToolbar:17,onaddpreset:1,ongrabpreset:2,ondragpreset:3,ondroppreset:4})}}function d6(t){let e,i,n,r;return e=new oo({props:{items:t[29]}}),n=new Du({props:{locale:t[4],shape:t[48]||t[49],onchange:t[85],controls:t[9],scrollEnable:!1,hideTitles:!0,willRenderControls:t[160]}}),{c(){Et(e.$$.fragment),i=he(),Et(n.$$.fragment)},m(o,a){Rt(e,o,a),et(o,i,a),Rt(n,o,a),r=!0},p(o,a){const s={};536870912&a[0]&&(s.items=o[29]),e.$set(s);const l={};16&a[0]&&(l.locale=o[4]),393216&a[1]&&(l.shape=o[48]||o[49]),512&a[0]&&(l.controls=o[9]),n.$set(l)},i(o){r||(M(e.$$.fragment,o),M(n.$$.fragment,o),r=!0)},o(o){z(e.$$.fragment,o),z(n.$$.fragment,o),r=!1},d(o){It(e,o),o&&tt(i),It(n,o)}}}function u6(t){let e,i,n;return i=new X2({props:{$$slots:{default:[d6]},$$scope:{ctx:t}}}),{c(){e=pt("div"),Et(i.$$.fragment),v(e,"slot","header")},m(r,o){et(r,e,o),Rt(i,e,null),n=!0},p(r,o){const a={};536871440&o[0]|393216&o[1]|524288&o[6]&&(a.$$scope={dirty:o,ctx:r}),i.$set(a)},i(r){n||(M(i.$$.fragment,r),n=!0)},o(r){z(i.$$.fragment,r),n=!1},d(r){r&&tt(e),It(i)}}}function Ef(t){let e,i;const n=[{locale:t[4]},{ui:t[69]},{shapes:t[5]},{selection:t[58]},{uid:t[19]},{parentRect:t[36]},{rootRect:t[55]},{utilRect:t[38]},{offset:t[50]},{disabled:t[37]},{contextRotation:t[22]},{contextFlipX:t[23]},{contextFlipY:t[24]},{contextZoom:t[35]?t[35].scale:void 0},{active:t[34]},{opacity:t[56]},{hoverColor:t[57]},{caretColor:t[57]},{snapColor:t[57]},{gridColor:[1,1,1,.125]},{eraseRadius:t[46]},{selectRadius:t[6]},{enableButtonFlipVertical:t[10]},{mapEditorPointToImagePoint:t[20]},{mapImagePointToEditorPoint:t[21]},{enableTapToAddText:t[13]},{textInputMode:t[8]},{snapThreshold:t[15]},{snapPointer:!t[47]},{enableSnapToContext:t[16]},{gridSize:t[14]},{willStartInteraction:t[95]},{oninteractionstart:t[79]},{oninteractionupdate:t[80]},{oninteractionrelease:t[81]},{oninteractionend:t[83]},{oninteractioncancel:t[82]},{onleavecanvas:t[87]},{onhovercanvas:t[86]},{onhovershape:t[89]},{ontapcanvas:t[88]},{onaddshape:t[152]},{onselectshape:t[153]},{onblurshape:t[154]},{ontapshape:t[155]},{onupdateshape:t[156]},{onremoveshape:t[157]},t[41]];let r={};for(let o=0;o<n.length;o+=1)r=In(r,n[o]);return e=new HS({props:r}),t[158](e),{c(){Et(e.$$.fragment)},m(o,a){Rt(e,o,a),i=!0},p(o,a){const s=1106896240&a[0]|252282104&a[1]|255721600&a[2]|12&a[3]?yr(n,[16&a[0]&&{locale:o[4]},128&a[2]&&{ui:o[69]},32&a[0]&&{shapes:o[5]},134217728&a[1]&&{selection:o[58]},524288&a[0]&&{uid:o[19]},32&a[1]&&{parentRect:o[36]},16777216&a[1]&&{rootRect:o[55]},128&a[1]&&{utilRect:o[38]},524288&a[1]&&{offset:o[50]},64&a[1]&&{disabled:o[37]},4194304&a[0]&&{contextRotation:o[22]},8388608&a[0]&&{contextFlipX:o[23]},16777216&a[0]&&{contextFlipY:o[24]},16&a[1]&&{contextZoom:o[35]?o[35].scale:void 0},8&a[1]&&{active:o[34]},33554432&a[1]&&{opacity:o[56]},67108864&a[1]&&{hoverColor:o[57]},67108864&a[1]&&{caretColor:o[57]},67108864&a[1]&&{snapColor:o[57]},n[19],32768&a[1]&&{eraseRadius:o[46]},64&a[0]&&{selectRadius:o[6]},1024&a[0]&&{enableButtonFlipVertical:o[10]},1048576&a[0]&&{mapEditorPointToImagePoint:o[20]},2097152&a[0]&&{mapImagePointToEditorPoint:o[21]},8192&a[0]&&{enableTapToAddText:o[13]},256&a[0]&&{textInputMode:o[8]},32768&a[0]&&{snapThreshold:o[15]},65536&a[1]&&{snapPointer:!o[47]},65536&a[0]&&{enableSnapToContext:o[16]},16384&a[0]&&{gridSize:o[14]},4&a[3]&&{willStartInteraction:o[95]},131072&a[2]&&{oninteractionstart:o[79]},262144&a[2]&&{oninteractionupdate:o[80]},524288&a[2]&&{oninteractionrelease:o[81]},2097152&a[2]&&{oninteractionend:o[83]},1048576&a[2]&&{oninteractioncancel:o[82]},33554432&a[2]&&{onleavecanvas:o[87]},16777216&a[2]&&{onhovercanvas:o[86]},134217728&a[2]&&{onhovershape:o[89]},67108864&a[2]&&{ontapcanvas:o[88]},1073741824&a[0]|8&a[3]&&{onaddshape:o[152]},1073741824&a[0]&&{onselectshape:o[153]},1073741824&a[0]&&{onblurshape:o[154]},1073741824&a[0]&&{ontapshape:o[155]},1073741824&a[0]|8&a[3]&&{onupdateshape:o[156]},1073741824&a[0]|8&a[3]&&{onremoveshape:o[157]},1024&a[1]&&Pr(o[41])]):{};e.$set(s)},i(o){i||(M(e.$$.fragment,o),i=!0)},o(o){z(e.$$.fragment,o),i=!1},d(o){t[158](null),It(e,o)}}}function p6(t){let e,i,n,r,o,a=t[51]&&Ef(t);return{c(){e=pt("div"),a&&a.c(),v(e,"slot","main"),v(e,"style",i="cursor:"+t[45])},m(s,l){et(s,e,l),a&&a.m(e,null),t[159](e),n=!0,r||(o=[Ct(e,"keydown",t[84]),Ui(f2.call(null,e)),Ct(e,"dropfiles",function(){ji(t[12]?t[94]:ge)&&(t[12]?t[94]:ge).apply(this,arguments)}),Ui(dr.call(null,e)),Ct(e,"measure",t[148])],r=!0)},p(s,l){(t=s)[51]?a?(a.p(t,l),1048576&l[1]&&M(a,1)):(a=Ef(t),a.c(),M(a,1),a.m(e,null)):a&&(Pe(),z(a,1,1,()=>{a=null}),Re()),(!n||16384&l[1]&&i!==(i="cursor:"+t[45]))&&v(e,"style",i)},i(s){n||(M(a),n=!0)},o(s){z(a),n=!1},d(s){s&&tt(e),a&&a.d(),t[159](null),r=!1,Bi(o)}}}function h6(t){let e,i;return e=new J2({props:{locale:t[4],presets:t[18],enableSelectImage:t[11],willRenderPresetToolbar:t[42],onaddpreset:t[93],ongrabpreset:t[90],ondragpreset:t[91],ondroppreset:t[92],scrollElasticity:t[43]}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};16&r[0]&&(o.locale=n[4]),262144&r[0]&&(o.presets=n[18]),2048&r[0]&&(o.enableSelectImage=n[11]),2048&r[1]&&(o.willRenderPresetToolbar=n[42]),4096&r[1]&&(o.scrollElasticity=n[43]),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function m6(t){let e,i,n,r=t[7]==="stack"&&Af(t),o=(t[53]&&t[33]||t[7]==="row")&&Lf(t);return{c(){r&&r.c(),e=he(),o&&o.c(),i=Tn()},m(a,s){r&&r.m(a,s),et(a,e,s),o&&o.m(a,s),et(a,i,s),n=!0},p(a,s){a[7]==="stack"?r?(r.p(a,s),128&s[0]&&M(r,1)):(r=Af(a),r.c(),M(r,1),r.m(e.parentNode,e)):r&&(Pe(),z(r,1,1,()=>{r=null}),Re()),a[53]&&a[33]||a[7]==="row"?o?(o.p(a,s),128&s[0]|4194308&s[1]&&M(o,1)):(o=Lf(a),o.c(),M(o,1),o.m(i.parentNode,i)):o&&(Pe(),z(o,1,1,()=>{o=null}),Re())},i(a){n||(M(r),M(o),n=!0)},o(a){z(r),z(o),n=!1},d(a){r&&r.d(a),a&&tt(e),o&&o.d(a),a&&tt(i)}}}function Af(t){let e,i,n,r;const o=[g6,$6],a=[];function s(l,c){return l[44]?0:1}return i=s(t),n=a[i]=o[i](t),{c(){e=pt("div"),n.c(),v(e,"class","PinturaControlPanels")},m(l,c){et(l,e,c),a[i].m(e,null),r=!0},p(l,c){let d=i;i=s(l),i===d?a[i].p(l,c):(Pe(),z(a[d],1,1,()=>{a[d]=null}),Re(),n=a[i],n?n.p(l,c):(n=a[i]=o[i](l),n.c()),M(n,1),n.m(e,null))},i(l){r||(M(n),r=!0)},o(l){z(n),r=!1},d(l){l&&tt(e),a[i].d()}}}function $6(t){let e,i,n;return i=new Du({props:{locale:t[4],shape:t[48]||t[49],onchange:t[85],controls:t[9],scrollElasticity:t[43],willRenderControls:t[17]}}),{c(){e=pt("div"),Et(i.$$.fragment),v(e,"class","PinturaControlPanel")},m(r,o){et(r,e,o),Rt(i,e,null),n=!0},p(r,o){const a={};16&o[0]&&(a.locale=r[4]),393216&o[1]&&(a.shape=r[48]||r[49]),512&o[0]&&(a.controls=r[9]),4096&o[1]&&(a.scrollElasticity=r[43]),131072&o[0]&&(a.willRenderControls=r[17]),i.$set(a)},i(r){n||(M(i.$$.fragment,r),n=!0)},o(r){z(i.$$.fragment,r),n=!1},d(r){r&&tt(e),It(i)}}}function g6(t){let e,i,n;return i=new J2({props:{locale:t[4],presets:t[18],enableSelectImage:t[11],willRenderPresetToolbar:t[42],onaddpreset:t[93],ongrabpreset:t[90],ondragpreset:t[91],ondroppreset:t[92],scrollElasticity:t[43]}}),{c(){e=pt("div"),Et(i.$$.fragment),v(e,"class","PinturaControlPanel")},m(r,o){et(r,e,o),Rt(i,e,null),n=!0},p(r,o){const a={};16&o[0]&&(a.locale=r[4]),262144&o[0]&&(a.presets=r[18]),2048&o[0]&&(a.enableSelectImage=r[11]),2048&o[1]&&(a.willRenderPresetToolbar=r[42]),4096&o[1]&&(a.scrollElasticity=r[43]),i.$set(a)},i(r){n||(M(i.$$.fragment,r),n=!0)},o(r){z(i.$$.fragment,r),n=!1},d(r){r&&tt(e),It(i)}}}function Lf(t){let e,i;return e=new Ca({props:{class:"PinturaControlListScroller",elasticity:t[43],$$slots:{default:[x6]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};4096&r[1]&&(o.elasticity=n[43]),131729&r[0]|393221&r[1]|524288&r[6]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function zf(t){let e,i;return e=new ss({props:{locale:t[4],class:"PinturaControlList",optionClass:"PinturaControlListOption",layout:"row",options:t[31],selectedIndex:t[31].findIndex(t[149]),onchange:t[78],$$slots:{option:[y6,({option:n})=>({204:n}),({option:n})=>[0,0,0,0,0,0,n?262144:0]]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};16&r[0]&&(o.locale=n[4]),1&r[1]&&(o.options=n[31]),1&r[0]|1&r[1]&&(o.selectedIndex=n[31].findIndex(n[149])),16&r[0]|786432&r[6]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function Ff(t){let e,i;return e=new Co({props:{$$slots:{default:[f6]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};16&r[0]|786432&r[6]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function f6(t){let e,i=(on(t[204].icon)?t[204].icon(t[4]):t[204].icon)+"";return{c(){e=fr("g")},m(n,r){et(n,e,r),e.innerHTML=i},p(n,r){16&r[0]|262144&r[6]&&i!==(i=(on(n[204].icon)?n[204].icon(n[4]):n[204].icon)+"")&&(e.innerHTML=i)},d(n){n&&tt(e)}}}function Df(t){let e,i,n=(on(t[204].label)?t[204].label(t[4]):t[204].label)+"";return{c(){e=pt("span"),i=gn(n)},m(r,o){et(r,e,o),kt(e,i)},p(r,o){16&o[0]|262144&o[6]&&n!==(n=(on(r[204].label)?r[204].label(r[4]):r[204].label)+"")&&zn(i,n)},d(r){r&&tt(e)}}}function y6(t){let e,i,n,r=t[204].icon&&Ff(t),o=!t[204].hideLabel&&Df(t);return{c(){e=pt("div"),r&&r.c(),i=he(),o&&o.c(),v(e,"slot","option")},m(a,s){et(a,e,s),r&&r.m(e,null),kt(e,i),o&&o.m(e,null),n=!0},p(a,s){a[204].icon?r?(r.p(a,s),262144&s[6]&&M(r,1)):(r=Ff(a),r.c(),M(r,1),r.m(e,i)):r&&(Pe(),z(r,1,1,()=>{r=null}),Re()),a[204].hideLabel?o&&(o.d(1),o=null):o?o.p(a,s):(o=Df(a),o.c(),o.m(e,null))},i(a){n||(M(r),n=!0)},o(a){z(r),n=!1},d(a){a&&tt(e),r&&r.d(),o&&o.d()}}}function Bf(t){let e,i;return e=new Du({props:{locale:t[4],shape:t[48]||t[49],onchange:t[85],controls:t[9],scrollEnable:!1,hideTitles:!0,willRenderControls:t[150]}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};16&r[0]&&(o.locale=n[4]),393216&r[1]&&(o.shape=n[48]||n[49]),512&r[0]&&(o.controls=n[9]),131072&r[0]&&(o.willRenderControls=n[150]),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function x6(t){let e,i,n,r=t[33]&&zf(t),o=t[7]==="row"&&Bf(t);return{c(){r&&r.c(),e=he(),o&&o.c(),i=Tn()},m(a,s){r&&r.m(a,s),et(a,e,s),o&&o.m(a,s),et(a,i,s),n=!0},p(a,s){a[33]?r?(r.p(a,s),4&s[1]&&M(r,1)):(r=zf(a),r.c(),M(r,1),r.m(e.parentNode,e)):r&&(Pe(),z(r,1,1,()=>{r=null}),Re()),a[7]==="row"?o?(o.p(a,s),128&s[0]&&M(o,1)):(o=Bf(a),o.c(),M(o,1),o.m(i.parentNode,i)):o&&(Pe(),z(o,1,1,()=>{o=null}),Re())},i(a){n||(M(r),M(o),n=!0)},o(a){z(r),z(o),n=!1},d(a){r&&r.d(a),a&&tt(e),o&&o.d(a),a&&tt(i)}}}function Of(t){let e,i;return e=new Ca({props:{class:"PinturaControlListScroller",elasticity:t[43],$$slots:{default:[w6]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};4096&r[1]&&(o.elasticity=n[43]),67108880&r[0]|8388608&r[1]|524288&r[6]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function Wf(t){let e,i;return e=new Co({props:{$$slots:{default:[b6]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};16&r[0]|786432&r[6]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function b6(t){let e,i=(on(t[204].icon)?t[204].icon(t[4]):t[204].icon)+"";return{c(){e=fr("g")},m(n,r){et(n,e,r),e.innerHTML=i},p(n,r){16&r[0]|262144&r[6]&&i!==(i=(on(n[204].icon)?n[204].icon(n[4]):n[204].icon)+"")&&(e.innerHTML=i)},d(n){n&&tt(e)}}}function v6(t){let e,i,n,r,o,a=(on(t[204].label)?t[204].label(t[4]):t[204].label)+"",s=t[204].icon&&Wf(t);return{c(){e=pt("div"),s&&s.c(),i=he(),n=pt("span"),r=gn(a),v(e,"slot","option")},m(l,c){et(l,e,c),s&&s.m(e,null),kt(e,i),kt(e,n),kt(n,r),o=!0},p(l,c){l[204].icon?s?(s.p(l,c),262144&c[6]&&M(s,1)):(s=Wf(l),s.c(),M(s,1),s.m(e,i)):s&&(Pe(),z(s,1,1,()=>{s=null}),Re()),(!o||16&c[0]|262144&c[6])&&a!==(a=(on(l[204].label)?l[204].label(l[4]):l[204].label)+"")&&zn(r,a)},i(l){o||(M(s),o=!0)},o(l){z(s),o=!1},d(l){l&&tt(e),s&&s.d()}}}function w6(t){let e,i;return e=new ss({props:{locale:t[4],class:"PinturaControlList",optionClass:"PinturaControlListOption",layout:"row",options:t[54],selectedIndex:t[54].findIndex(t[151]),onchange:t[77],$$slots:{option:[v6,({option:n})=>({204:n}),({option:n})=>[0,0,0,0,0,0,n?262144:0]]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};16&r[0]&&(o.locale=n[4]),8388608&r[1]&&(o.options=n[54]),67108864&r[0]|8388608&r[1]&&(o.selectedIndex=n[54].findIndex(n[151])),16&r[0]|786432&r[6]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function S6(t){let e,i,n,r,o;const a=[m6,h6],s=[];function l(d,u){return d[52]?0:d[44]?1:-1}~(i=l(t))&&(n=s[i]=a[i](t));let c=t[32]&&Of(t);return{c(){e=pt("div"),n&&n.c(),r=he(),c&&c.c(),v(e,"slot","footer"),v(e,"style",t[39])},m(d,u){et(d,e,u),~i&&s[i].m(e,null),kt(e,r),c&&c.m(e,null),o=!0},p(d,u){let p=i;i=l(d),i===p?~i&&s[i].p(d,u):(n&&(Pe(),z(s[p],1,1,()=>{s[p]=null}),Re()),~i?(n=s[i],n?n.p(d,u):(n=s[i]=a[i](d),n.c()),M(n,1),n.m(e,r)):n=null),d[32]?c?(c.p(d,u),2&u[1]&&M(c,1)):(c=Of(d),c.c(),M(c,1),c.m(e,null)):c&&(Pe(),z(c,1,1,()=>{c=null}),Re()),(!o||256&u[1])&&v(e,"style",d[39])},i(d){o||(M(n),M(c),o=!0)},o(d){z(n),z(c),o=!1},d(d){d&&tt(e),~i&&s[i].d(),c&&c.d()}}}function k6(t){let e,i;return e=new cl({props:{hasHeader:t[40],$$slots:{footer:[S6],main:[p6],header:[u6]},$$scope:{ctx:t}}}),e.$on("measure",t[161]),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};512&r[1]&&(o.hasHeader=n[40]),2113929201&r[0]|134217215&r[1]|524288&r[6]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function C6(t,e,i){let n,r,o,a,s,l,c,d,u,p,h,g,m,f,x,k,w,C,P,R,W,T,F,D,B,y,_,J,S,j,Q,ht,at,U,yt,$t,Mt,dt,Tt,K,q,Z,xt,it,mt,Ft,ie,Dt,Ot,ae,G,wt,ut,Xt,ce,te,ve,me,V,Ce,yi,xe,_t,ze,Ie,Fe=Ke,hi=()=>(Fe(),Fe=Br($i,O=>i(34,Z=O)),$i),bt=Ke,ne=()=>(bt(),bt=Br(Bt,O=>i(141,Ft=O)),Bt),Ue=Ke,Ee=()=>(Ue(),Ue=Br(sn,O=>i(36,ut=O)),sn),jt=Ke,Ge=()=>(jt(),jt=Br(X,O=>i(147,yi=O)),X),Qe=Ke,mi=()=>(Qe(),Qe=Br(Li,O=>i(56,ze=O)),Li);t.$$.on_destroy.push(()=>Fe()),t.$$.on_destroy.push(()=>bt()),t.$$.on_destroy.push(()=>Ue()),t.$$.on_destroy.push(()=>jt()),t.$$.on_destroy.push(()=>Qe());let{isActive:$i}=e;hi();let{isActiveFraction:Li}=e;mi();let{isVisible:X}=e;Ge();let{stores:Ut}=e,{locale:H={}}=e,{shapes:Bt}=e;ne();let{toolbar:be=[]}=e,{toolShapes:se={}}=e,{toolActive:At}=e,{toolSelectRadius:re}=e,{toolRetainStyles:Me=!1}=e,{toolbarLayout:De="stack"}=e,{textInputMode:_e}=e,{shapeControls:Ze={}}=e,{enableButtonFlipVertical:nt=!1}=e,{enablePresetSelectImage:Qt=!0}=e,{enablePresetDropImage:Zt=!0}=e,{enableSelectToolToAddShape:Kt=!1}=e,{enableAutoSelectMoveTool:Yt=["line","arrow","path","rectangle","ellipse","text"]}=e,{enableTapToAddText:st=!1}=e,{enableMoveTool:le=!1}=e,{enableViewTool:ee=!1}=e,{enableToolShareStyles:ye=!0}=e,{gridSize:Xe=0}=e,{snapThreshold:$e=0}=e,{enableSnapToContext:vi=!0}=e,{willRenderHeaderTools:Le=Yi}=e,{willRenderPresetToolbar:Gt}=e,{willRenderShapeStyleControls:gi}=e,{willStartInteraction:Ti}=e,{shapePresets:Ve=[]}=e,{utilKey:ri}=e,{mapScreenPointToImagePoint:Be}=e,{mapImagePointToScreenPoint:Se}=e,{imageRotation:Zi=0}=e,{imageFlipX:un=!1}=e,{imageFlipY:wn=!1}=e,{parentRect:sn}=e;Ee();let{hooks:an={}}=e;const Mn=dn("selection");A(t,Mn,O=>i(146,me=O));const ur=dn("isAnimated");A(t,ur,O=>i(138,xt=O));const ao=dn("elasticityMultiplier");A(t,ao,O=>i(142,ie=O));const fn=dn("ui");A(t,fn,O=>i(171,V=O));const Rr=dn("keysPressed");let Sn;A(t,Rr,O=>i(145,ve=O));const{env:Vn,history:yn,rootRect:To,rootColorSecondary:Oi,enablePanInput:xn,enablePanInputStatus:On,enableZoomInput:No,stageRect:Kr,utilRectPadded:go,scrollElasticity:Mo,imageOverlayMarkup:pr,imagePreviewModifiers:pn,imageCropRect:Qi,shapePreprocessor:so,stageScalar:Ho,imageSelectionRect:xr,imageTransformsInterpolated:br,imageSelectionPan:lo,imageSize:ca,allowPan:Po,allowZoom:Ro,allowZoomControls:_r,allowPlayPause:Jr}=Ut;A(t,Vn,O=>i(139,it=O)),A(t,To,O=>i(55,_t=O)),A(t,Oi,O=>i(57,Ie=O)),A(t,On,O=>i(37,ce=O)),A(t,Kr,O=>i(143,Dt=O)),A(t,go,O=>i(38,Ce=O)),A(t,pn,O=>i(172,xe=O)),A(t,Qi,O=>i(170,Xt=O)),A(t,Ho,O=>i(168,G=O)),A(t,xr,O=>i(169,wt=O)),A(t,br,O=>i(35,Ot=O)),A(t,lo,O=>i(167,ae=O)),A(t,ca,O=>i(144,te=O));let Ir=0,hr={};const vr=O=>{const[de,wi]=Sn[O];let je,Pt,fe=wi.position==="relative";const xi=fe?"0%":0,Gi=fe?"0%":0;wo(de)||Xn(de)?(Pt=fe?"20%":.2*ut.width,je=Hn(de),je.x=xi,je.y=Gi,xa(je,{width:Pt,height:Pt},ut)):Yn(de)?(Pt=fe?"10%":.1*ut.width,je=Hn(de),je.x=xi,je.y=Gi,xa(je,{rx:Pt,ry:Pt},ut)):tr(de)&&(Pt=fe?"10%":.1*ut.width,je=Hn(de),je.x1=xi,je.y1=Gi,je.x2=xi,je.y2=Gi),je&&Promise.resolve().then(()=>{Kn(uo(je,void 0,Pt))})},Wn=O=>Be(hh(O,_t));let Wi,_i={},lr,qi;const Vr=O=>{if(!(_n(O)&&Ae(O,"pathClose")))return;const de=[...O.strokeColor];de[3]=1,Wi.updateMarkupShape(O,{pathClose:!1,strokeColor:de},!1),Wi.removeMarkupShapeProps(O,["backgroundColor"],!1),Wi.confirmMarkupItemDraft(),Wi.selectShape(O),U("addshape",O),yn.write()};let co;const Qr=(O,de)=>{if(di(O))return O;if(O.endsWith("%"))return parseFloat(O)/100*de.width};let mr,Fn,wr;const uo=(O,de,wi)=>{let je=!1;de||(je=!0,de=at?Be(Ci(Dt)):Ci(Xt)),de.x-=ut.x||0,de.y-=ut.y||0,(un||wn)&&(O.flipX=un,O.flipY=wn);const Pt=Wi.getShapesNearPosition(Ft,de);if(je&&Pt.length){const fe=.1*Math.min(Xt.width,Xt.height);de.x+=Math.round(-fe+Math.random()*fe*2),de.y+=Math.round(-fe+Math.random()*fe*2)}if(Zi!==0&&(O.rotation=un&&wn?-Zi:un||wn?Zi:-Zi),Ae(O,"width")&&Ae(O,"height")){const{width:fe,height:xi}=Ll(O,["width","height"],ut);xa(O,{x:de.x-.5*fe,y:de.y-.5*xi},ut)}else if(Yn(O))xa(O,{x:de.x,y:de.y},ut);else if(tr(O)){const{x1:fe,y1:xi,x2:Gi,y2:hn}=Ll(O,["x1","y1","x2","y2"],ut),Si=mo(rt(fe,xi),rt(Gi,hn)),Vi=We(wi)?gu(wi,ut.width):Si;xa(O,{x1:de.x-Vi,y1:de.y+Vi,x2:de.x+Vi,y2:de.y-Vi},ut)}else if(_n(O)){const{points:fe}=Ll(O,["points"],ut),xi=Bo(fe);xa(O,{points:fe.map(Gi=>({x:Gi.x+de.x-xi.x,y:Gi.y+de.y-xi.y}))},ut)}return O},cr=(O,de)=>{const wi=uo(Fm(O,Xt),de);return O.shape&&(Ae(O.shape,"x")&&(wi.x=O.shape.x),Ae(O.shape,"y")&&(wi.y=O.shape.y)),Kn(wi)},Kn=O=>{const{beforeAddShape:de=()=>!0}=an;if(de(O))return Wi.addShape(O),Wi.selectShape(O),U("addshape",O),yn.write(),O};let Nn=!1;const Er=()=>{yn.write()};let to;const eo=dn("redrawTrigger");A(t,eo,O=>i(140,mt=O));const En=[],Ar=ci(xt?20:0);return A(t,Ar,O=>i(137,q=O)),t.$$set=O=>{"isActive"in O&&hi(i(1,$i=O.isActive)),"isActiveFraction"in O&&mi(i(2,Li=O.isActiveFraction)),"isVisible"in O&&Ge(i(3,X=O.isVisible)),"stores"in O&&i(100,Ut=O.stores),"locale"in O&&i(4,H=O.locale),"shapes"in O&&ne(i(5,Bt=O.shapes)),"toolbar"in O&&i(101,be=O.toolbar),"toolShapes"in O&&i(102,se=O.toolShapes),"toolActive"in O&&i(0,At=O.toolActive),"toolSelectRadius"in O&&i(6,re=O.toolSelectRadius),"toolRetainStyles"in O&&i(103,Me=O.toolRetainStyles),"toolbarLayout"in O&&i(7,De=O.toolbarLayout),"textInputMode"in O&&i(8,_e=O.textInputMode),"shapeControls"in O&&i(9,Ze=O.shapeControls),"enableButtonFlipVertical"in O&&i(10,nt=O.enableButtonFlipVertical),"enablePresetSelectImage"in O&&i(11,Qt=O.enablePresetSelectImage),"enablePresetDropImage"in O&&i(12,Zt=O.enablePresetDropImage),"enableSelectToolToAddShape"in O&&i(104,Kt=O.enableSelectToolToAddShape),"enableAutoSelectMoveTool"in O&&i(105,Yt=O.enableAutoSelectMoveTool),"enableTapToAddText"in O&&i(13,st=O.enableTapToAddText),"enableMoveTool"in O&&i(106,le=O.enableMoveTool),"enableViewTool"in O&&i(107,ee=O.enableViewTool),"enableToolShareStyles"in O&&i(108,ye=O.enableToolShareStyles),"gridSize"in O&&i(14,Xe=O.gridSize),"snapThreshold"in O&&i(15,$e=O.snapThreshold),"enableSnapToContext"in O&&i(16,vi=O.enableSnapToContext),"willRenderHeaderTools"in O&&i(109,Le=O.willRenderHeaderTools),"willRenderPresetToolbar"in O&&i(110,Gt=O.willRenderPresetToolbar),"willRenderShapeStyleControls"in O&&i(17,gi=O.willRenderShapeStyleControls),"willStartInteraction"in O&&i(111,Ti=O.willStartInteraction),"shapePresets"in O&&i(18,Ve=O.shapePresets),"utilKey"in O&&i(19,ri=O.utilKey),"mapScreenPointToImagePoint"in O&&i(20,Be=O.mapScreenPointToImagePoint),"mapImagePointToScreenPoint"in O&&i(21,Se=O.mapImagePointToScreenPoint),"imageRotation"in O&&i(22,Zi=O.imageRotation),"imageFlipX"in O&&i(23,un=O.imageFlipX),"imageFlipY"in O&&i(24,wn=O.imageFlipY),"parentRect"in O&&Ee(i(25,sn=O.parentRect)),"hooks"in O&&i(112,an=O.hooks)},t.$$.update=()=>{var O,de,wi,je;if(2097152&t.$$.dirty[4]&&i(122,n=ve.includes(18)),1049088&t.$$.dirty[3]&&(Sn&&se===Sn||i(113,Sn=se)),8&t.$$.dirty[1]&&Po.set(Z),8&t.$$.dirty[1]&&Ro.set(Z),8&t.$$.dirty[1]&&_r.set(Z),256&t.$$.dirty[3]&&i(32,r=Array.isArray(be)&&be.length>1&&Array.isArray(be[0][1])),2&t.$$.dirty[1]|256&t.$$.dirty[3]&&i(54,o=r?be.map((Pt,fe)=>[fe,Pt[0]]):[]),67108864&t.$$.dirty[0]|2&t.$$.dirty[1]|256&t.$$.dirty[3]&&i(136,a=r?be[Ir][1]:be),262144&t.$$.dirty[0]|155648&t.$$.dirty[3]|4096&t.$$.dirty[4]&&i(31,s=((Pt,{willRenderPresetToolbar:fe,shapePresets:xi,enableViewTool:Gi,enableMoveTool:hn})=>{let Si=xi.length!==0||fe?Pt:Pt.filter(Vi=>Vi[0]!=="preset");return r&&(Si=[["move",Vi=>Vi.shapeLabelToolMove,{icon:Vi=>Vi.shapeIconToolMove}],["view",Vi=>Vi.shapeLabelToolView,{icon:Vi=>Vi.shapeIconToolView}],...Si]),Si=hn?Si:Si.filter(Vi=>Vi[0]!=="move"),Gi?Si:Si.filter(Vi=>Vi[0]!=="view")})(a,{willRenderPresetToolbar:Gt,shapePresets:Ve,enableMoveTool:le,enableViewTool:ee})),1&t.$$.dirty[1]&&i(134,d=!!s.length),1&t.$$.dirty[0]|1&t.$$.dirty[1]|1024&t.$$.dirty[4]&&d&&At===void 0&&i(0,At=s[0][0]),67108865&t.$$.dirty[0]|2&t.$$.dirty[1]|2097152&t.$$.dirty[3]|4096&t.$$.dirty[4]&&r&&i(114,hr={...hr,[Ir]:a.map(([Pt])=>Pt).includes(At)?At:hr[Ir]||a[0][0]}),512&t.$$.dirty[0]&&i(133,l=!!Object.keys(Ze).length),1&t.$$.dirty[1]&&i(33,c=s.length>1),6&t.$$.dirty[1]&&i(53,u=c||r),1&t.$$.dirty[0]&&i(135,p=At!==void 0),3584&t.$$.dirty[4]&&i(52,h=(!p||d)&&l),268435456&t.$$.dirty[0]&&i(30,U=to&&(O=to,(Pt,fe)=>{O.dispatchEvent(ys(Pt,fe))})),1073741825&t.$$.dirty[0]|8&t.$$.dirty[1]&&Z&&U&&U("selectcontrol",At),8&t.$$.dirty[1]&&(Z?vt(pn,xe[ri]={maskMarkupOpacity:.85},xe):delete xe[ri]),1&t.$$.dirty[0]|1048576&t.$$.dirty[3]&&i(132,g=At&&Sn[At]?Sn[At][1]:void 0),256&t.$$.dirty[4]&&i(123,m=g&&g.isSelection?"selection":"shapes"),1610612736&t.$$.dirty[3]&&(Pt=>{if(!Wi)return;const fe=Wi.getShapeDraft(Mn);fe&&(Pt&&(lr=fe.drawMode),Wi.updateShapeDraft({drawMode:Pt?"subtract":lr},Mn))})(m==="selection"&&n),134217729&t.$$.dirty[0]&&At&&Wi){const Pt=Wi.getMarkupItemDraft();Pt&&Vr(Pt)}if(1&t.$$.dirty[0]&&At&&Wi&&At!=="move"&&Wi.blurShapes(),8&t.$$.dirty[1]|8388608&t.$$.dirty[4]&&i(51,f=yi&&Z),128&t.$$.dirty[1]|524288&t.$$.dirty[4]&&i(50,x=Ce&&rt(Dt.x-Ce.x,Dt.y-Ce.y)),512&t.$$.dirty[0]&&i(131,k=Object.keys(Ze)),8&t.$$.dirty[1]|131072&t.$$.dirty[4]&&i(119,w=Z&&Ft.filter(bs)[0]),8&t.$$.dirty[1]|131072&t.$$.dirty[4]&&i(128,C=Z&&Ft.find(Pt=>$p(Pt))),8&t.$$.dirty[1]|131072&t.$$.dirty[4]&&i(49,P=Z&&Ft.find(Pt=>bo(Pt))),1&t.$$.dirty[0]|8&t.$$.dirty[1]|1048576&t.$$.dirty[3]&&i(125,R=Z&&Sn[At]?My(Hn({...Sn[At][0],...V[ri]?V[ri][At]:{}})):{}),1048576&t.$$.dirty[3]&&Sn&&i(115,_i={}),1&t.$$.dirty[0]|4227072&t.$$.dirty[3]|130&t.$$.dirty[4]&&i(124,W=R&&Object.keys(R).reduce((Pt,fe)=>{const xi=fe==="disableStyle",Gi=fe==="settings",hn=!!k.find(Lr=>Lr.split("_").includes(fe));if(!xi&&!Gi&&!hn||R[fe]===void 0||R.disableStyle===!0||R.disableStyle&&R.disableStyle.includes(fe))return Pt;if(fe==="strokeWidth"&&Object.keys(_i).includes("strokeWidth")&&_i[fe]===void 0&&Ae(R,"points"))return Pt[fe]=R[fe],Pt;const{share:Si=!0}=R.settings&&R.settings[fe]||{},Vi=ye&&Si?_i:_i[At]||{};return Pt[fe]=Ae(Vi,fe)?Vi[fe]:R[fe],Pt},{})),524289&t.$$.dirty[0]|1024&t.$$.dirty[3]|1&t.$$.dirty[4]&&(Me?((Pt,fe,xi)=>{const Gi=V[Pt],hn=Gi?Gi[fe]:{};fn.set({...V,[Pt]:{...Gi,[fe]:{...hn,...xi}}})})(ri,At,W):(de=ri,fn.set({[de]:{}}))),8&t.$$.dirty[1]|67108864&t.$$.dirty[3]|4194305&t.$$.dirty[4]&&i(48,T=me&&Z?w||W:void 0),1&t.$$.dirty[0]|2&t.$$.dirty[4]&&i(47,F=Ae(R,"eraseRadius")||Ae(R,"points")&&!Ae(R,"pathClose")||At==="move"||At==="view"),32&t.$$.dirty[1]|2&t.$$.dirty[4]&&i(46,D=R&&R.eraseRadius!==void 0?Qr(R.eraseRadius,ut):void 0),8&t.$$.dirty[1]|2097152&t.$$.dirty[4]&&i(129,B=Z&&ve.includes(32)),1&t.$$.dirty[0]|8&t.$$.dirty[1]&&i(130,y=Z&&At==="view"),96&t.$$.dirty[4]&&i(127,_=y||B),24&t.$$.dirty[4]&&i(126,J=!!_&&(!!C||Wc(document.activeElement))),8&t.$$.dirty[1]|12&t.$$.dirty[4]&&xn.set(!Z||_&&!J),8&t.$$.dirty[1]|4&t.$$.dirty[4]&&No.set(!Z||!J),32&t.$$.dirty[1]|3&t.$$.dirty[4]&&i(120,S=R.cursorStyle?(({cursorStyle:Pt,cursorSize:fe},xi,Gi)=>{let hn;const Si=xi[fe];if(Si===void 0?hn=Qr(fe,Gi):di(Si)?hn=Si:We(Si)&&(hn=Db(fe,xi[fe],Gi),fe==="strokeWidth"&&(hn*=.5)),!(hn<=0||hn===void 0))return{size:hn,style:Pt}})(R,{...R,...W},ut):void 0),33554432&t.$$.dirty[3]|1048576&t.$$.dirty[4]&&i(121,j=wr&&(je=te,(wi=wr).x>=0&&wi.y>=0&&wi.x<=je.width&&wi.y<=je.height)),524288&t.$$.dirty[0]|80&t.$$.dirty[1]|2038431744&t.$$.dirty[3])if(j&&!mr&&S&&!ce){const Pt=S.size*Ot.scale,fe={id:"cursor-"+ri,x:Fn.x,y:Fn.y,strokeWidth:.5,strokeColor:[0,0,0]};S.style==="ellipse"&&(fe.rx=Pt,fe.ry=Pt);const xi={strokeWidth:2.5,strokeColor:[1,1,1],opacity:.75},Gi=[{...fe,...xi},fe];if(m==="selection"&&n){const hn=Pt,Si=Fn.x+hn,Vi=Fn.y+hn+4,Lr={id:"cursor-"+ri,strokeWidth:.75,strokeColor:[0,0,0],points:[{x:Si,y:Vi},{x:Si+4,y:Vi}]};Gi.push({...Lr,...xi,strokeWidth:2,points:[{x:Si-.5,y:Vi},{x:Si+4.5,y:Vi}]},Lr)}(hn=>{pr.update(Si=>[...Si.filter(Vi=>Vi.id!=="cursor-"+ri),...hn])})(Gi)}else pr.update(Pt=>Pt.filter(fe=>fe.id!=="cursor-"+ri));1&t.$$.dirty[0]|64&t.$$.dirty[1]|478150656&t.$$.dirty[3]&&i(45,Q=j?((Pt,fe,xi,Gi,hn,Si)=>{if(Gi)return hn?"grabbing":"grab";if(Pt&&!fe)return"none";if(!fe)return Si==="move"?"default":"crosshair";let Vi=fe||xi;return bs(Vi)?$p(Vi)?_e==="modal"?"default":"text":wc(Vi)?"move":"default":"default"})(S,mr,w,ce,!1,At):"default"),264193&t.$$.dirty[0]|131072&t.$$.dirty[3]&&i(44,ht=At==="preset"&&(Ve.length>0||Qt||Gt)),32&t.$$.dirty[1]&&(at=!Ae(ut,"x")&&!Ae(ut,"y")),262144&t.$$.dirty[4]&&i(43,yt=ie*Mo),131072&t.$$.dirty[3]|98304&t.$$.dirty[4]&&i(42,$t=mt&&Gt?Pt=>_c(()=>Gt(Pt,cr,{...it},()=>eo.set({}))):Yi),524288&t.$$.dirty[3]&&i(41,Mt=Object.keys(an).reduce((Pt,fe)=>(fe==="beforeAddShape"||an[fe]===void 0||(Pt[fe]=an[fe]),Pt),{})),8&t.$$.dirty[1]&&(Pt=>{Ft&&Bt.update(fe=>fe.map(xi=>(xi._prerender=!!Pt&&$p(xi),xi)))})(Z),65536&t.$$.dirty[3]|98304&t.$$.dirty[4]&&i(29,dt=mt&&Le([],it,()=>eo.set({}))),536871424&t.$$.dirty[0]&&i(40,Tt=!!dt.length||!!Object.keys(Ze).some(Pt=>En.includes(Pt))),8&t.$$.dirty[1]|16384&t.$$.dirty[4]&&xt&&Ar.set(Z?0:20),8192&t.$$.dirty[4]&&i(39,K=q?`transform: translateY(${q}px)`:void 0)},Jr.set(!1),[At,$i,Li,X,H,Bt,re,De,_e,Ze,nt,Qt,Zt,st,Xe,$e,vi,gi,Ve,ri,Be,Se,Zi,un,wn,sn,Ir,Wi,to,dt,U,s,r,c,Z,Ot,ut,ce,Ce,K,Tt,Mt,$t,yt,ht,Q,D,F,T,P,x,f,h,u,o,_t,ze,Ie,Mn,ur,ao,fn,Rr,Vn,To,Oi,On,Kr,go,pr,pn,Qi,Ho,xr,br,lo,ca,({index:O},de)=>{i(26,Ir=O),i(0,At=hr[O])},({value:O},de)=>{i(0,At=O),(Kt||/enter/i.test(de.key))&&vr(O)},O=>{if(At==="eraser")qi=Wi.eraseShape();else if(At&&Sn[At]){const[de,wi={}]=Sn[At],{drawMode:je}=T;m==="selection"&&je==="new"&&Mn.set([]);let Pt={};m==="selection"&&(U("selectiondown",[...me]),n&&(lr=de.drawMode,Pt.drawMode="subtract")),qi=Wi.createShape({...de,...W,...Pt},wi)}else qi=void 0;return!!qi&&(qi.start(O),!0)},O=>!!qi&&(qi.update(O),!0),O=>!!qi&&(qi.release(O),!0),O=>!!qi&&(qi.cancel(O),qi=void 0,!0),O=>{if(!qi)return!1;if(qi.end(O),qi=void 0,m==="selection"){if(O.detail.isTap){const[je]=Sn[At];je.bitmap||Mn.set([])}U("selectionup",[...me])}const de=Wi.getMarkupItemDraft(),wi=le&&(Yt===!0||Array.isArray(Yt)&&Yt.includes(At));return de&&!de.isEditing||!wi||i(0,At="move"),!0},O=>{const{key:de}=O,wi=Wi.getMarkupItemDraft();/escape/i.test(de)&&wi&&(O.preventDefault(),O.stopPropagation(),Wi.discardMarkupItemDraft(),qi=void 0),/enter/i.test(de)&&wi&&(O.preventDefault(),O.stopPropagation(),Vr(wi),qi=void 0)},function(O){Object.keys(O).forEach(de=>{const{retain:wi=!0,share:je=!0}=R.settings&&R.settings[de]||{};wi&&(ye&&je?i(115,_i[de]=O[de],_i):(_i[At]||i(115,_i[At]={},_i),i(115,_i[At][de]=O[de],_i)))}),U("selectstyle",O),w&&(Wi.updateMarkupShape(w,O),clearTimeout(co),co=setTimeout(()=>{Er()},200))},(O,de,wi)=>{i(117,Fn=de),i(118,wr=wi)},()=>{i(118,wr=void 0),i(117,Fn=void 0)},O=>{U("markuptap",O)},O=>i(116,mr=O),()=>{Nn=!1},(O,de)=>{if(Nn)return;const{beforeAddShape:wi=()=>!0}=an,je=Wn(de),Pt=Wi.getMarkupItemDraft(),fe=du(Xt,{x:je.x+(ut.x||0),y:je.y+(ut.y||0)});if(Pt&&!fe&&Wi.discardMarkupItemDraft(),fe){if(!Pt){const xi=Fm(O,Xt),Gi=uo(xi,je);return wi(Gi)?(Zp(Gi),void Wi.addShape(Gi)):(Nn=!0,void de.preventDefault())}wo(Pt)&&(je.x-=.5*Pt.width,je.y-=.5*Pt.height),O.shape&&(Ae(O.shape,"x")&&(je.x=O.shape.x),Ae(O.shape,"y")&&(je.y=O.shape.y)),Wi.updateMarkupShape(Pt,je)}},(O,de)=>{if(Nn)return;const wi=Wn(de);if(!du(Xt,{x:wi.x+(ut.x||0),y:wi.y+(ut.y||0)}))return void Wi.discardMarkupItemDraft();const je=Wi.confirmMarkupItemDraft();Wi.selectShape(je),U("addshape",je),yn.write()},O=>cr(O),O=>{return de=O.detail.resources,wi=Wn(O.detail.event),de.forEach(je=>cr(je,wi));var de,wi},O=>{if(!Ti)return!0;const de=rectClone(wt);return rectScale(de,1/G),rectTranslate(de,ae),rectScale(de,Ot.scale),Ti(O,{...de,x:de.x+Dt.x,y:de.y+Dt.y})},Er,eo,En,Ar,Ut,be,se,Me,Kt,Yt,le,ee,ye,Le,Gt,Ti,an,Sn,hr,_i,mr,Fn,wr,w,S,j,n,m,W,R,J,_,C,B,y,k,g,l,d,p,a,q,xt,it,mt,Ft,ie,Dt,te,ve,me,yi,function(O){Wr.call(this,t,O)},O=>O[0]===At,(O,de,wi)=>{const je=O.filter(([,Pt])=>!En.includes(Pt));return gi?gi(je,de,wi):je},O=>O[0]===Ir,O=>{Promise.resolve().then(()=>{U("addshape",O),Er()})},O=>{U("selectshape",O)},O=>{Promise.resolve().then(()=>{U("blurshape",O)})},O=>{U("tapshape",O)},O=>{U("updateshape",O),Er()},O=>{U("removeshape",O),Er()},function(O){Ai[O?"unshift":"push"](()=>{Wi=O,i(27,Wi)})},function(O){Ai[O?"unshift":"push"](()=>{to=O,i(28,to)})},O=>O.filter(([,de])=>En.includes(de)),function(O){Wr.call(this,t,O)}]}class Bu extends li{constructor(e){super(),si(this,e,C6,k6,ni,{isActive:1,isActiveFraction:2,isVisible:3,stores:100,locale:4,shapes:5,toolbar:101,toolShapes:102,toolActive:0,toolSelectRadius:6,toolRetainStyles:103,toolbarLayout:7,textInputMode:8,shapeControls:9,enableButtonFlipVertical:10,enablePresetSelectImage:11,enablePresetDropImage:12,enableSelectToolToAddShape:104,enableAutoSelectMoveTool:105,enableTapToAddText:13,enableMoveTool:106,enableViewTool:107,enableToolShareStyles:108,gridSize:14,snapThreshold:15,enableSnapToContext:16,willRenderHeaderTools:109,willRenderPresetToolbar:110,willRenderShapeStyleControls:17,willStartInteraction:111,shapePresets:18,utilKey:19,mapScreenPointToImagePoint:20,mapImagePointToScreenPoint:21,imageRotation:22,imageFlipX:23,imageFlipY:24,parentRect:25,hooks:112},null,[-1,-1,-1,-1,-1,-1,-1])}get isActive(){return this.$$.ctx[1]}set isActive(e){this.$$set({isActive:e}),E()}get isActiveFraction(){return this.$$.ctx[2]}set isActiveFraction(e){this.$$set({isActiveFraction:e}),E()}get isVisible(){return this.$$.ctx[3]}set isVisible(e){this.$$set({isVisible:e}),E()}get stores(){return this.$$.ctx[100]}set stores(e){this.$$set({stores:e}),E()}get locale(){return this.$$.ctx[4]}set locale(e){this.$$set({locale:e}),E()}get shapes(){return this.$$.ctx[5]}set shapes(e){this.$$set({shapes:e}),E()}get toolbar(){return this.$$.ctx[101]}set toolbar(e){this.$$set({toolbar:e}),E()}get toolShapes(){return this.$$.ctx[102]}set toolShapes(e){this.$$set({toolShapes:e}),E()}get toolActive(){return this.$$.ctx[0]}set toolActive(e){this.$$set({toolActive:e}),E()}get toolSelectRadius(){return this.$$.ctx[6]}set toolSelectRadius(e){this.$$set({toolSelectRadius:e}),E()}get toolRetainStyles(){return this.$$.ctx[103]}set toolRetainStyles(e){this.$$set({toolRetainStyles:e}),E()}get toolbarLayout(){return this.$$.ctx[7]}set toolbarLayout(e){this.$$set({toolbarLayout:e}),E()}get textInputMode(){return this.$$.ctx[8]}set textInputMode(e){this.$$set({textInputMode:e}),E()}get shapeControls(){return this.$$.ctx[9]}set shapeControls(e){this.$$set({shapeControls:e}),E()}get enableButtonFlipVertical(){return this.$$.ctx[10]}set enableButtonFlipVertical(e){this.$$set({enableButtonFlipVertical:e}),E()}get enablePresetSelectImage(){return this.$$.ctx[11]}set enablePresetSelectImage(e){this.$$set({enablePresetSelectImage:e}),E()}get enablePresetDropImage(){return this.$$.ctx[12]}set enablePresetDropImage(e){this.$$set({enablePresetDropImage:e}),E()}get enableSelectToolToAddShape(){return this.$$.ctx[104]}set enableSelectToolToAddShape(e){this.$$set({enableSelectToolToAddShape:e}),E()}get enableAutoSelectMoveTool(){return this.$$.ctx[105]}set enableAutoSelectMoveTool(e){this.$$set({enableAutoSelectMoveTool:e}),E()}get enableTapToAddText(){return this.$$.ctx[13]}set enableTapToAddText(e){this.$$set({enableTapToAddText:e}),E()}get enableMoveTool(){return this.$$.ctx[106]}set enableMoveTool(e){this.$$set({enableMoveTool:e}),E()}get enableViewTool(){return this.$$.ctx[107]}set enableViewTool(e){this.$$set({enableViewTool:e}),E()}get enableToolShareStyles(){return this.$$.ctx[108]}set enableToolShareStyles(e){this.$$set({enableToolShareStyles:e}),E()}get gridSize(){return this.$$.ctx[14]}set gridSize(e){this.$$set({gridSize:e}),E()}get snapThreshold(){return this.$$.ctx[15]}set snapThreshold(e){this.$$set({snapThreshold:e}),E()}get enableSnapToContext(){return this.$$.ctx[16]}set enableSnapToContext(e){this.$$set({enableSnapToContext:e}),E()}get willRenderHeaderTools(){return this.$$.ctx[109]}set willRenderHeaderTools(e){this.$$set({willRenderHeaderTools:e}),E()}get willRenderPresetToolbar(){return this.$$.ctx[110]}set willRenderPresetToolbar(e){this.$$set({willRenderPresetToolbar:e}),E()}get willRenderShapeStyleControls(){return this.$$.ctx[17]}set willRenderShapeStyleControls(e){this.$$set({willRenderShapeStyleControls:e}),E()}get willStartInteraction(){return this.$$.ctx[111]}set willStartInteraction(e){this.$$set({willStartInteraction:e}),E()}get shapePresets(){return this.$$.ctx[18]}set shapePresets(e){this.$$set({shapePresets:e}),E()}get utilKey(){return this.$$.ctx[19]}set utilKey(e){this.$$set({utilKey:e}),E()}get mapScreenPointToImagePoint(){return this.$$.ctx[20]}set mapScreenPointToImagePoint(e){this.$$set({mapScreenPointToImagePoint:e}),E()}get mapImagePointToScreenPoint(){return this.$$.ctx[21]}set mapImagePointToScreenPoint(e){this.$$set({mapImagePointToScreenPoint:e}),E()}get imageRotation(){return this.$$.ctx[22]}set imageRotation(e){this.$$set({imageRotation:e}),E()}get imageFlipX(){return this.$$.ctx[23]}set imageFlipX(e){this.$$set({imageFlipX:e}),E()}get imageFlipY(){return this.$$.ctx[24]}set imageFlipY(e){this.$$set({imageFlipY:e}),E()}get parentRect(){return this.$$.ctx[25]}set parentRect(e){this.$$set({parentRect:e}),E()}get hooks(){return this.$$.ctx[112]}set hooks(e){this.$$set({hooks:e}),E()}}var r0=(t,e,i,n,r,o,a,s,l)=>{const c=Oe(t),d=.5*i.width,u=.5*i.height,p=.5*e.width,h=.5*e.height,g=r.x+n.x,m=r.y+n.y;s&&(c.x=i.width-c.x),l&&(c.y=i.height-c.y);const f=Math.cos(o),x=Math.sin(o);c.x-=d,c.y-=u;const k=c.x*f-c.y*x,w=c.x*x+c.y*f;c.x=d+k,c.y=u+w,c.x*=a,c.y*=a,c.x+=p,c.y+=h,c.x+=g,c.y+=m,c.x-=d*a,c.y-=u*a;const C=(r.x-g)*a,P=(r.y-m)*a,R=C*f-P*x,W=C*x+P*f;return c.x+=R,c.y+=W,c},o0=(t,e,i,n,r,o,a,s,l)=>{const c=Oe(t),d=Dl(i),u=Dl(e),p=rt(r.x+n.x,r.y+n.y),h=Math.cos(o),g=Math.sin(o);c.x-=u.x,c.y-=u.y;const m=(r.x-p.x)*a,f=(r.y-p.y)*a,x=m*h-f*g,k=m*g+f*h;c.x-=x,c.y-=k,c.x-=p.x,c.y-=p.y,c.x/=a,c.y/=a;const w=c.x*h+c.y*g,C=c.x*g-c.y*h;return c.x=w,c.y=-C,c.x+=d.x,c.y+=d.y,s&&(c.x=i.width-c.x),l&&(c.y=i.height-c.y),c},Vl=t=>typeof t=="boolean";function T6(t){let e,i,n;function r(a){t[59](a)}let o={utilKey:t[1],stores:t[5],locale:t[6],isActive:t[2],isActiveFraction:t[3],isVisible:t[4],mapScreenPointToImagePoint:t[45],mapImagePointToScreenPoint:t[44],imageRotation:t[46],imageFlipX:t[43],imageFlipY:t[42],shapes:t[48],toolbar:t[21]||t[7],toolShapes:t[22]||t[8],toolRetainStyles:t[9],enableSelectToolToAddShape:t[31],enableTapToAddText:t[32],enableViewTool:t[30],enableMoveTool:t[34],enableAutoSelectMoveTool:t[33],snapThreshold:t[16],gridSize:di(t[18])?t[18]:t[15],enableSnapToContext:Vl(t[19])?t[19]:t[17],enableToolShareStyles:t[13],shapeControls:t[23]||t[10],shapePresets:t[27],enableButtonFlipVertical:t[24],parentRect:t[49],enablePresetDropImage:t[26],enablePresetSelectImage:t[25],toolSelectRadius:t[11],textInputMode:t[12],willStartInteraction:t[14],willRenderPresetToolbar:t[28]||t[20],willRenderShapeStyleControls:t[29],hooks:{willRenderShapeControls:t[35],willRenderShapeTextControls:t[36],beforeAddShape:t[37],beforeRemoveShape:t[38],beforeDeselectShape:t[39],beforeSelectShape:t[40],beforeUpdateShape:t[41]}};return t[0]!==void 0&&(o.toolActive=t[0]),e=new Bu({props:o}),Ai.push(()=>$o(e,"toolActive",r)),e.$on("measure",t[60]),{c(){Et(e.$$.fragment)},m(a,s){Rt(e,a,s),n=!0},p(a,s){const l={};32&s[0]&&(l.stores=a[5]),64&s[0]&&(l.locale=a[6]),4&s[0]&&(l.isActive=a[2]),8&s[0]&&(l.isActiveFraction=a[3]),16&s[0]&&(l.isVisible=a[4]),16384&s[1]&&(l.mapScreenPointToImagePoint=a[45]),8192&s[1]&&(l.mapImagePointToScreenPoint=a[44]),32768&s[1]&&(l.imageRotation=a[46]),4096&s[1]&&(l.imageFlipX=a[43]),2048&s[1]&&(l.imageFlipY=a[42]),2097280&s[0]&&(l.toolbar=a[21]||a[7]),4194560&s[0]&&(l.toolShapes=a[22]||a[8]),512&s[0]&&(l.toolRetainStyles=a[9]),1&s[1]&&(l.enableSelectToolToAddShape=a[31]),2&s[1]&&(l.enableTapToAddText=a[32]),1073741824&s[0]&&(l.enableViewTool=a[30]),8&s[1]&&(l.enableMoveTool=a[34]),4&s[1]&&(l.enableAutoSelectMoveTool=a[33]),65536&s[0]&&(l.snapThreshold=a[16]),294912&s[0]&&(l.gridSize=di(a[18])?a[18]:a[15]),655360&s[0]&&(l.enableSnapToContext=Vl(a[19])?a[19]:a[17]),8192&s[0]&&(l.enableToolShareStyles=a[13]),8389632&s[0]&&(l.shapeControls=a[23]||a[10]),134217728&s[0]&&(l.shapePresets=a[27]),16777216&s[0]&&(l.enableButtonFlipVertical=a[24]),67108864&s[0]&&(l.enablePresetDropImage=a[26]),33554432&s[0]&&(l.enablePresetSelectImage=a[25]),2048&s[0]&&(l.toolSelectRadius=a[11]),4096&s[0]&&(l.textInputMode=a[12]),16384&s[0]&&(l.willStartInteraction=a[14]),269484032&s[0]&&(l.willRenderPresetToolbar=a[28]||a[20]),536870912&s[0]&&(l.willRenderShapeStyleControls=a[29]),2032&s[1]&&(l.hooks={willRenderShapeControls:a[35],willRenderShapeTextControls:a[36],beforeAddShape:a[37],beforeRemoveShape:a[38],beforeDeselectShape:a[39],beforeSelectShape:a[40],beforeUpdateShape:a[41]}),!i&&1&s[0]&&(i=!0,l.toolActive=a[0],ko(()=>i=!1)),e.$set(l)},i(a){n||(M(e.$$.fragment,a),n=!0)},o(a){z(e.$$.fragment,a),n=!1},d(a){It(e,a)}}}function M6(t,e,i){let n,r,o,a,s,l,c,d,u,{isActive:p}=e,{isActiveFraction:h}=e,{isVisible:g}=e,{stores:m}=e,{locale:f={}}=e,{markupEditorToolbar:x}=e,{markupEditorToolStyles:k}=e,{markupEditorToolRetainStyles:w}=e,{markupEditorShapeStyleControls:C}=e,{markupEditorToolSelectRadius:P}=e,{markupEditorTextInputMode:R}=e,{markupEditorToolShareStyles:W}=e,{markupEditorWillStartInteraction:T}=e,{markupEditorGridSize:F=0}=e,{markupEditorSnapThreshold:D=0}=e,{markupEditorSnapToContext:B=!1}=e,{annotateGridSize:y}=e,{annotateSnapToContext:_}=e,{willRenderShapePresetToolbar:J}=e,{annotateTools:S}=e,{annotateToolShapes:j}=e,{annotateShapeControls:Q}=e,{annotateActiveTool:ht}=e,{annotateEnableButtonFlipVertical:at=!1}=e,{annotateEnableSelectImagePreset:U=!1}=e,{annotateEnableDropImagePreset:yt=!0}=e,{annotatePresets:$t=[]}=e,{annotateWillRenderShapePresetToolbar:Mt}=e,{annotateWillRenderShapeStyleControls:dt}=e,{enableViewTool:Tt}=e,{enableSelectToolToAddShape:K}=e,{enableTapToAddText:q}=e,{enableAutoSelectMoveTool:Z}=e,{enableMoveTool:xt}=e,{willRenderShapeControls:it}=e,{willRenderShapeTextControls:mt}=e,{beforeAddShape:Ft}=e,{beforeRemoveShape:ie}=e,{beforeDeselectShape:Dt}=e,{beforeSelectShape:Ot}=e,{beforeUpdateShape:ae}=e;const{rootRect:G,imageAnnotation:wt,imageSize:ut,imageRotation:Xt,imageFlipX:ce,imageFlipY:te,imageTransforms:ve,imageTransformsInterpolated:me}=m;return A(t,G,V=>i(58,d=V)),A(t,ut,V=>i(57,c=V)),A(t,Xt,V=>i(46,u=V)),A(t,ce,V=>i(43,a=V)),A(t,te,V=>i(42,o=V)),A(t,ve,V=>i(56,l=V)),A(t,me,V=>i(55,s=V)),t.$$set=V=>{"isActive"in V&&i(2,p=V.isActive),"isActiveFraction"in V&&i(3,h=V.isActiveFraction),"isVisible"in V&&i(4,g=V.isVisible),"stores"in V&&i(5,m=V.stores),"locale"in V&&i(6,f=V.locale),"markupEditorToolbar"in V&&i(7,x=V.markupEditorToolbar),"markupEditorToolStyles"in V&&i(8,k=V.markupEditorToolStyles),"markupEditorToolRetainStyles"in V&&i(9,w=V.markupEditorToolRetainStyles),"markupEditorShapeStyleControls"in V&&i(10,C=V.markupEditorShapeStyleControls),"markupEditorToolSelectRadius"in V&&i(11,P=V.markupEditorToolSelectRadius),"markupEditorTextInputMode"in V&&i(12,R=V.markupEditorTextInputMode),"markupEditorToolShareStyles"in V&&i(13,W=V.markupEditorToolShareStyles),"markupEditorWillStartInteraction"in V&&i(14,T=V.markupEditorWillStartInteraction),"markupEditorGridSize"in V&&i(15,F=V.markupEditorGridSize),"markupEditorSnapThreshold"in V&&i(16,D=V.markupEditorSnapThreshold),"markupEditorSnapToContext"in V&&i(17,B=V.markupEditorSnapToContext),"annotateGridSize"in V&&i(18,y=V.annotateGridSize),"annotateSnapToContext"in V&&i(19,_=V.annotateSnapToContext),"willRenderShapePresetToolbar"in V&&i(20,J=V.willRenderShapePresetToolbar),"annotateTools"in V&&i(21,S=V.annotateTools),"annotateToolShapes"in V&&i(22,j=V.annotateToolShapes),"annotateShapeControls"in V&&i(23,Q=V.annotateShapeControls),"annotateActiveTool"in V&&i(0,ht=V.annotateActiveTool),"annotateEnableButtonFlipVertical"in V&&i(24,at=V.annotateEnableButtonFlipVertical),"annotateEnableSelectImagePreset"in V&&i(25,U=V.annotateEnableSelectImagePreset),"annotateEnableDropImagePreset"in V&&i(26,yt=V.annotateEnableDropImagePreset),"annotatePresets"in V&&i(27,$t=V.annotatePresets),"annotateWillRenderShapePresetToolbar"in V&&i(28,Mt=V.annotateWillRenderShapePresetToolbar),"annotateWillRenderShapeStyleControls"in V&&i(29,dt=V.annotateWillRenderShapeStyleControls),"enableViewTool"in V&&i(30,Tt=V.enableViewTool),"enableSelectToolToAddShape"in V&&i(31,K=V.enableSelectToolToAddShape),"enableTapToAddText"in V&&i(32,q=V.enableTapToAddText),"enableAutoSelectMoveTool"in V&&i(33,Z=V.enableAutoSelectMoveTool),"enableMoveTool"in V&&i(34,xt=V.enableMoveTool),"willRenderShapeControls"in V&&i(35,it=V.willRenderShapeControls),"willRenderShapeTextControls"in V&&i(36,mt=V.willRenderShapeTextControls),"beforeAddShape"in V&&i(37,Ft=V.beforeAddShape),"beforeRemoveShape"in V&&i(38,ie=V.beforeRemoveShape),"beforeDeselectShape"in V&&i(39,Dt=V.beforeDeselectShape),"beforeSelectShape"in V&&i(40,Ot=V.beforeSelectShape),"beforeUpdateShape"in V&&i(41,ae=V.beforeUpdateShape)},t.$$.update=()=>{251664384&t.$$.dirty[1]&&i(45,n=V=>o0(V,d,c,s.origin,s.translation,l.rotation.z,s.scale,a,o)),251664384&t.$$.dirty[1]&&i(44,r=V=>r0(V,d,c,s.origin,s.translation,l.rotation.z,s.scale,a,o))},[ht,"annotate",p,h,g,m,f,x,k,w,C,P,R,W,T,F,D,B,y,_,J,S,j,Q,at,U,yt,$t,Mt,dt,Tt,K,q,Z,xt,it,mt,Ft,ie,Dt,Ot,ae,o,a,r,n,u,G,wt,ut,Xt,ce,te,ve,me,s,l,c,d,function(V){ht=V,i(0,ht)},function(V){Wr.call(this,t,V)}]}var P6={util:["annotate",class extends li{constructor(t){super(),si(this,t,M6,T6,ni,{name:1,isActive:2,isActiveFraction:3,isVisible:4,stores:5,locale:6,markupEditorToolbar:7,markupEditorToolStyles:8,markupEditorToolRetainStyles:9,markupEditorShapeStyleControls:10,markupEditorToolSelectRadius:11,markupEditorTextInputMode:12,markupEditorToolShareStyles:13,markupEditorWillStartInteraction:14,markupEditorGridSize:15,markupEditorSnapThreshold:16,markupEditorSnapToContext:17,annotateGridSize:18,annotateSnapToContext:19,willRenderShapePresetToolbar:20,annotateTools:21,annotateToolShapes:22,annotateShapeControls:23,annotateActiveTool:0,annotateEnableButtonFlipVertical:24,annotateEnableSelectImagePreset:25,annotateEnableDropImagePreset:26,annotatePresets:27,annotateWillRenderShapePresetToolbar:28,annotateWillRenderShapeStyleControls:29,enableViewTool:30,enableSelectToolToAddShape:31,enableTapToAddText:32,enableAutoSelectMoveTool:33,enableMoveTool:34,willRenderShapeControls:35,willRenderShapeTextControls:36,beforeAddShape:37,beforeRemoveShape:38,beforeDeselectShape:39,beforeSelectShape:40,beforeUpdateShape:41},null,[-1,-1])}get name(){return this.$$.ctx[1]}get isActive(){return this.$$.ctx[2]}set isActive(t){this.$$set({isActive:t}),E()}get isActiveFraction(){return this.$$.ctx[3]}set isActiveFraction(t){this.$$set({isActiveFraction:t}),E()}get isVisible(){return this.$$.ctx[4]}set isVisible(t){this.$$set({isVisible:t}),E()}get stores(){return this.$$.ctx[5]}set stores(t){this.$$set({stores:t}),E()}get locale(){return this.$$.ctx[6]}set locale(t){this.$$set({locale:t}),E()}get markupEditorToolbar(){return this.$$.ctx[7]}set markupEditorToolbar(t){this.$$set({markupEditorToolbar:t}),E()}get markupEditorToolStyles(){return this.$$.ctx[8]}set markupEditorToolStyles(t){this.$$set({markupEditorToolStyles:t}),E()}get markupEditorToolRetainStyles(){return this.$$.ctx[9]}set markupEditorToolRetainStyles(t){this.$$set({markupEditorToolRetainStyles:t}),E()}get markupEditorShapeStyleControls(){return this.$$.ctx[10]}set markupEditorShapeStyleControls(t){this.$$set({markupEditorShapeStyleControls:t}),E()}get markupEditorToolSelectRadius(){return this.$$.ctx[11]}set markupEditorToolSelectRadius(t){this.$$set({markupEditorToolSelectRadius:t}),E()}get markupEditorTextInputMode(){return this.$$.ctx[12]}set markupEditorTextInputMode(t){this.$$set({markupEditorTextInputMode:t}),E()}get markupEditorToolShareStyles(){return this.$$.ctx[13]}set markupEditorToolShareStyles(t){this.$$set({markupEditorToolShareStyles:t}),E()}get markupEditorWillStartInteraction(){return this.$$.ctx[14]}set markupEditorWillStartInteraction(t){this.$$set({markupEditorWillStartInteraction:t}),E()}get markupEditorGridSize(){return this.$$.ctx[15]}set markupEditorGridSize(t){this.$$set({markupEditorGridSize:t}),E()}get markupEditorSnapThreshold(){return this.$$.ctx[16]}set markupEditorSnapThreshold(t){this.$$set({markupEditorSnapThreshold:t}),E()}get markupEditorSnapToContext(){return this.$$.ctx[17]}set markupEditorSnapToContext(t){this.$$set({markupEditorSnapToContext:t}),E()}get annotateGridSize(){return this.$$.ctx[18]}set annotateGridSize(t){this.$$set({annotateGridSize:t}),E()}get annotateSnapToContext(){return this.$$.ctx[19]}set annotateSnapToContext(t){this.$$set({annotateSnapToContext:t}),E()}get willRenderShapePresetToolbar(){return this.$$.ctx[20]}set willRenderShapePresetToolbar(t){this.$$set({willRenderShapePresetToolbar:t}),E()}get annotateTools(){return this.$$.ctx[21]}set annotateTools(t){this.$$set({annotateTools:t}),E()}get annotateToolShapes(){return this.$$.ctx[22]}set annotateToolShapes(t){this.$$set({annotateToolShapes:t}),E()}get annotateShapeControls(){return this.$$.ctx[23]}set annotateShapeControls(t){this.$$set({annotateShapeControls:t}),E()}get annotateActiveTool(){return this.$$.ctx[0]}set annotateActiveTool(t){this.$$set({annotateActiveTool:t}),E()}get annotateEnableButtonFlipVertical(){return this.$$.ctx[24]}set annotateEnableButtonFlipVertical(t){this.$$set({annotateEnableButtonFlipVertical:t}),E()}get annotateEnableSelectImagePreset(){return this.$$.ctx[25]}set annotateEnableSelectImagePreset(t){this.$$set({annotateEnableSelectImagePreset:t}),E()}get annotateEnableDropImagePreset(){return this.$$.ctx[26]}set annotateEnableDropImagePreset(t){this.$$set({annotateEnableDropImagePreset:t}),E()}get annotatePresets(){return this.$$.ctx[27]}set annotatePresets(t){this.$$set({annotatePresets:t}),E()}get annotateWillRenderShapePresetToolbar(){return this.$$.ctx[28]}set annotateWillRenderShapePresetToolbar(t){this.$$set({annotateWillRenderShapePresetToolbar:t}),E()}get annotateWillRenderShapeStyleControls(){return this.$$.ctx[29]}set annotateWillRenderShapeStyleControls(t){this.$$set({annotateWillRenderShapeStyleControls:t}),E()}get enableViewTool(){return this.$$.ctx[30]}set enableViewTool(t){this.$$set({enableViewTool:t}),E()}get enableSelectToolToAddShape(){return this.$$.ctx[31]}set enableSelectToolToAddShape(t){this.$$set({enableSelectToolToAddShape:t}),E()}get enableTapToAddText(){return this.$$.ctx[32]}set enableTapToAddText(t){this.$$set({enableTapToAddText:t}),E()}get enableAutoSelectMoveTool(){return this.$$.ctx[33]}set enableAutoSelectMoveTool(t){this.$$set({enableAutoSelectMoveTool:t}),E()}get enableMoveTool(){return this.$$.ctx[34]}set enableMoveTool(t){this.$$set({enableMoveTool:t}),E()}get willRenderShapeControls(){return this.$$.ctx[35]}set willRenderShapeControls(t){this.$$set({willRenderShapeControls:t}),E()}get willRenderShapeTextControls(){return this.$$.ctx[36]}set willRenderShapeTextControls(t){this.$$set({willRenderShapeTextControls:t}),E()}get beforeAddShape(){return this.$$.ctx[37]}set beforeAddShape(t){this.$$set({beforeAddShape:t}),E()}get beforeRemoveShape(){return this.$$.ctx[38]}set beforeRemoveShape(t){this.$$set({beforeRemoveShape:t}),E()}get beforeDeselectShape(){return this.$$.ctx[39]}set beforeDeselectShape(t){this.$$set({beforeDeselectShape:t}),E()}get beforeSelectShape(){return this.$$.ctx[40]}set beforeSelectShape(t){this.$$set({beforeSelectShape:t}),E()}get beforeUpdateShape(){return this.$$.ctx[41]}set beforeUpdateShape(t){this.$$set({beforeUpdateShape:t}),E()}}]};function R6(t){let e,i,n;function r(a){t[51](a)}let o={utilKey:t[1],stores:t[5],locale:t[6],isActive:t[2],isActiveFraction:t[3],isVisible:t[4],mapScreenPointToImagePoint:t[43],mapImagePointToScreenPoint:t[42],shapes:t[45],toolbar:t[20]||t[7],toolShapes:t[21]||t[8],toolRetainStyles:t[9],shapeControls:t[22]||t[10],shapePresets:t[26],enableSelectToolToAddShape:t[29],enableTapToAddText:t[30],enableViewTool:t[31],enableMoveTool:t[32],enableAutoSelectMoveTool:t[33],snapThreshold:t[16],gridSize:di(t[18])?t[18]:t[15],enableSnapToContext:Vl(t[19])?t[19]:t[17],enableToolShareStyles:t[13],enablePresetSelectImage:t[24],enablePresetDropImage:t[25],enableButtonFlipVertical:t[23],parentRect:t[44],toolSelectRadius:t[11],textInputMode:t[12],willStartInteraction:t[41],willRenderPresetToolbar:t[27]||t[14],willRenderShapeStyleControls:t[28],hooks:{willRenderShapeControls:t[34],willRenderShapeTextControls:t[35],beforeAddShape:t[36],beforeRemoveShape:t[37],beforeDeselectShape:t[38],beforeSelectShape:t[39],beforeUpdateShape:t[40]}};return t[0]!==void 0&&(o.toolActive=t[0]),e=new Bu({props:o}),Ai.push(()=>$o(e,"toolActive",r)),e.$on("measure",t[52]),{c(){Et(e.$$.fragment)},m(a,s){Rt(e,a,s),n=!0},p(a,s){const l={};32&s[0]&&(l.stores=a[5]),64&s[0]&&(l.locale=a[6]),4&s[0]&&(l.isActive=a[2]),8&s[0]&&(l.isActiveFraction=a[3]),16&s[0]&&(l.isVisible=a[4]),4096&s[1]&&(l.mapScreenPointToImagePoint=a[43]),2048&s[1]&&(l.mapImagePointToScreenPoint=a[42]),1048704&s[0]&&(l.toolbar=a[20]||a[7]),2097408&s[0]&&(l.toolShapes=a[21]||a[8]),512&s[0]&&(l.toolRetainStyles=a[9]),4195328&s[0]&&(l.shapeControls=a[22]||a[10]),67108864&s[0]&&(l.shapePresets=a[26]),536870912&s[0]&&(l.enableSelectToolToAddShape=a[29]),1073741824&s[0]&&(l.enableTapToAddText=a[30]),1&s[1]&&(l.enableViewTool=a[31]),2&s[1]&&(l.enableMoveTool=a[32]),4&s[1]&&(l.enableAutoSelectMoveTool=a[33]),65536&s[0]&&(l.snapThreshold=a[16]),294912&s[0]&&(l.gridSize=di(a[18])?a[18]:a[15]),655360&s[0]&&(l.enableSnapToContext=Vl(a[19])?a[19]:a[17]),8192&s[0]&&(l.enableToolShareStyles=a[13]),16777216&s[0]&&(l.enablePresetSelectImage=a[24]),33554432&s[0]&&(l.enablePresetDropImage=a[25]),8388608&s[0]&&(l.enableButtonFlipVertical=a[23]),2048&s[0]&&(l.toolSelectRadius=a[11]),4096&s[0]&&(l.textInputMode=a[12]),1024&s[1]&&(l.willStartInteraction=a[41]),134234112&s[0]&&(l.willRenderPresetToolbar=a[27]||a[14]),268435456&s[0]&&(l.willRenderShapeStyleControls=a[28]),1016&s[1]&&(l.hooks={willRenderShapeControls:a[34],willRenderShapeTextControls:a[35],beforeAddShape:a[36],beforeRemoveShape:a[37],beforeDeselectShape:a[38],beforeSelectShape:a[39],beforeUpdateShape:a[40]}),!i&&1&s[0]&&(i=!0,l.toolActive=a[0],ko(()=>i=!1)),e.$set(l)},i(a){n||(M(e.$$.fragment,a),n=!0)},o(a){z(e.$$.fragment,a),n=!1},d(a){It(e,a)}}}function I6(t,e,i){let n,r,o,a,s,{isActive:l}=e,{isActiveFraction:c}=e,{isVisible:d}=e,{stores:u}=e,{locale:p={}}=e,{markupEditorToolbar:h}=e,{markupEditorToolStyles:g}=e,{markupEditorToolRetainStyles:m}=e,{markupEditorShapeStyleControls:f}=e,{markupEditorToolSelectRadius:x}=e,{markupEditorTextInputMode:k}=e,{markupEditorToolShareStyles:w}=e,{willRenderShapePresetToolbar:C}=e,{markupEditorGridSize:P}=e,{markupEditorSnapThreshold:R}=e,{markupEditorSnapToContext:W=!0}=e,{decorateGridSize:T}=e,{decorateSnapToContext:F}=e,{decorateTools:D}=e,{decorateToolShapes:B}=e,{decorateShapeControls:y}=e,{decorateActiveTool:_}=e,{decorateEnableButtonFlipVertical:J=!1}=e,{decorateEnableSelectImagePreset:S=!1}=e,{decorateEnableDropImagePreset:j=!0}=e,{decoratePresets:Q=[]}=e,{decorateWillRenderShapePresetToolbar:ht}=e,{decorateWillRenderShapeStyleControls:at}=e,{enableSelectToolToAddShape:U}=e,{enableTapToAddText:yt}=e,{enableViewTool:$t}=e,{enableMoveTool:Mt}=e,{enableAutoSelectMoveTool:dt}=e,{willRenderShapeControls:Tt}=e,{willRenderShapeTextControls:K}=e,{beforeAddShape:q}=e,{beforeRemoveShape:Z}=e,{beforeDeselectShape:xt}=e,{beforeSelectShape:it}=e,{beforeUpdateShape:mt}=e,{markupEditorWillStartInteraction:Ft}=e;const{imageCropRect:ie,imageDecoration:Dt,imageSelectionRectPresentation:Ot,imageTransformsInterpolated:ae}=u;return A(t,Ot,G=>i(49,a=G)),A(t,ae,G=>i(50,s=G)),t.$$set=G=>{"isActive"in G&&i(2,l=G.isActive),"isActiveFraction"in G&&i(3,c=G.isActiveFraction),"isVisible"in G&&i(4,d=G.isVisible),"stores"in G&&i(5,u=G.stores),"locale"in G&&i(6,p=G.locale),"markupEditorToolbar"in G&&i(7,h=G.markupEditorToolbar),"markupEditorToolStyles"in G&&i(8,g=G.markupEditorToolStyles),"markupEditorToolRetainStyles"in G&&i(9,m=G.markupEditorToolRetainStyles),"markupEditorShapeStyleControls"in G&&i(10,f=G.markupEditorShapeStyleControls),"markupEditorToolSelectRadius"in G&&i(11,x=G.markupEditorToolSelectRadius),"markupEditorTextInputMode"in G&&i(12,k=G.markupEditorTextInputMode),"markupEditorToolShareStyles"in G&&i(13,w=G.markupEditorToolShareStyles),"willRenderShapePresetToolbar"in G&&i(14,C=G.willRenderShapePresetToolbar),"markupEditorGridSize"in G&&i(15,P=G.markupEditorGridSize),"markupEditorSnapThreshold"in G&&i(16,R=G.markupEditorSnapThreshold),"markupEditorSnapToContext"in G&&i(17,W=G.markupEditorSnapToContext),"decorateGridSize"in G&&i(18,T=G.decorateGridSize),"decorateSnapToContext"in G&&i(19,F=G.decorateSnapToContext),"decorateTools"in G&&i(20,D=G.decorateTools),"decorateToolShapes"in G&&i(21,B=G.decorateToolShapes),"decorateShapeControls"in G&&i(22,y=G.decorateShapeControls),"decorateActiveTool"in G&&i(0,_=G.decorateActiveTool),"decorateEnableButtonFlipVertical"in G&&i(23,J=G.decorateEnableButtonFlipVertical),"decorateEnableSelectImagePreset"in G&&i(24,S=G.decorateEnableSelectImagePreset),"decorateEnableDropImagePreset"in G&&i(25,j=G.decorateEnableDropImagePreset),"decoratePresets"in G&&i(26,Q=G.decoratePresets),"decorateWillRenderShapePresetToolbar"in G&&i(27,ht=G.decorateWillRenderShapePresetToolbar),"decorateWillRenderShapeStyleControls"in G&&i(28,at=G.decorateWillRenderShapeStyleControls),"enableSelectToolToAddShape"in G&&i(29,U=G.enableSelectToolToAddShape),"enableTapToAddText"in G&&i(30,yt=G.enableTapToAddText),"enableViewTool"in G&&i(31,$t=G.enableViewTool),"enableMoveTool"in G&&i(32,Mt=G.enableMoveTool),"enableAutoSelectMoveTool"in G&&i(33,dt=G.enableAutoSelectMoveTool),"willRenderShapeControls"in G&&i(34,Tt=G.willRenderShapeControls),"willRenderShapeTextControls"in G&&i(35,K=G.willRenderShapeTextControls),"beforeAddShape"in G&&i(36,q=G.beforeAddShape),"beforeRemoveShape"in G&&i(37,Z=G.beforeRemoveShape),"beforeDeselectShape"in G&&i(38,xt=G.beforeDeselectShape),"beforeSelectShape"in G&&i(39,it=G.beforeSelectShape),"beforeUpdateShape"in G&&i(40,mt=G.beforeUpdateShape),"markupEditorWillStartInteraction"in G&&i(41,Ft=G.markupEditorWillStartInteraction)},t.$$.update=()=>{524288&t.$$.dirty[1]&&i(48,n=s?s.scale:1),393216&t.$$.dirty[1]&&i(43,r=G=>{const wt=Oe(G);return wt.x-=a.x,wt.y-=a.y,wt.x/=n,wt.y/=n,wt}),393216&t.$$.dirty[1]&&i(42,o=G=>{const wt=Oe(G);return wt.x*=n,wt.y*=n,wt.x+=a.x,wt.y+=a.y,wt})},[_,"decorate",l,c,d,u,p,h,g,m,f,x,k,w,C,P,R,W,T,F,D,B,y,J,S,j,Q,ht,at,U,yt,$t,Mt,dt,Tt,K,q,Z,xt,it,mt,Ft,o,r,ie,Dt,Ot,ae,n,a,s,function(G){_=G,i(0,_)},function(G){Wr.call(this,t,G)}]}var E6={util:["decorate",class extends li{constructor(t){super(),si(this,t,I6,R6,ni,{name:1,isActive:2,isActiveFraction:3,isVisible:4,stores:5,locale:6,markupEditorToolbar:7,markupEditorToolStyles:8,markupEditorToolRetainStyles:9,markupEditorShapeStyleControls:10,markupEditorToolSelectRadius:11,markupEditorTextInputMode:12,markupEditorToolShareStyles:13,willRenderShapePresetToolbar:14,markupEditorGridSize:15,markupEditorSnapThreshold:16,markupEditorSnapToContext:17,decorateGridSize:18,decorateSnapToContext:19,decorateTools:20,decorateToolShapes:21,decorateShapeControls:22,decorateActiveTool:0,decorateEnableButtonFlipVertical:23,decorateEnableSelectImagePreset:24,decorateEnableDropImagePreset:25,decoratePresets:26,decorateWillRenderShapePresetToolbar:27,decorateWillRenderShapeStyleControls:28,enableSelectToolToAddShape:29,enableTapToAddText:30,enableViewTool:31,enableMoveTool:32,enableAutoSelectMoveTool:33,willRenderShapeControls:34,willRenderShapeTextControls:35,beforeAddShape:36,beforeRemoveShape:37,beforeDeselectShape:38,beforeSelectShape:39,beforeUpdateShape:40,markupEditorWillStartInteraction:41},null,[-1,-1])}get name(){return this.$$.ctx[1]}get isActive(){return this.$$.ctx[2]}set isActive(t){this.$$set({isActive:t}),E()}get isActiveFraction(){return this.$$.ctx[3]}set isActiveFraction(t){this.$$set({isActiveFraction:t}),E()}get isVisible(){return this.$$.ctx[4]}set isVisible(t){this.$$set({isVisible:t}),E()}get stores(){return this.$$.ctx[5]}set stores(t){this.$$set({stores:t}),E()}get locale(){return this.$$.ctx[6]}set locale(t){this.$$set({locale:t}),E()}get markupEditorToolbar(){return this.$$.ctx[7]}set markupEditorToolbar(t){this.$$set({markupEditorToolbar:t}),E()}get markupEditorToolStyles(){return this.$$.ctx[8]}set markupEditorToolStyles(t){this.$$set({markupEditorToolStyles:t}),E()}get markupEditorToolRetainStyles(){return this.$$.ctx[9]}set markupEditorToolRetainStyles(t){this.$$set({markupEditorToolRetainStyles:t}),E()}get markupEditorShapeStyleControls(){return this.$$.ctx[10]}set markupEditorShapeStyleControls(t){this.$$set({markupEditorShapeStyleControls:t}),E()}get markupEditorToolSelectRadius(){return this.$$.ctx[11]}set markupEditorToolSelectRadius(t){this.$$set({markupEditorToolSelectRadius:t}),E()}get markupEditorTextInputMode(){return this.$$.ctx[12]}set markupEditorTextInputMode(t){this.$$set({markupEditorTextInputMode:t}),E()}get markupEditorToolShareStyles(){return this.$$.ctx[13]}set markupEditorToolShareStyles(t){this.$$set({markupEditorToolShareStyles:t}),E()}get willRenderShapePresetToolbar(){return this.$$.ctx[14]}set willRenderShapePresetToolbar(t){this.$$set({willRenderShapePresetToolbar:t}),E()}get markupEditorGridSize(){return this.$$.ctx[15]}set markupEditorGridSize(t){this.$$set({markupEditorGridSize:t}),E()}get markupEditorSnapThreshold(){return this.$$.ctx[16]}set markupEditorSnapThreshold(t){this.$$set({markupEditorSnapThreshold:t}),E()}get markupEditorSnapToContext(){return this.$$.ctx[17]}set markupEditorSnapToContext(t){this.$$set({markupEditorSnapToContext:t}),E()}get decorateGridSize(){return this.$$.ctx[18]}set decorateGridSize(t){this.$$set({decorateGridSize:t}),E()}get decorateSnapToContext(){return this.$$.ctx[19]}set decorateSnapToContext(t){this.$$set({decorateSnapToContext:t}),E()}get decorateTools(){return this.$$.ctx[20]}set decorateTools(t){this.$$set({decorateTools:t}),E()}get decorateToolShapes(){return this.$$.ctx[21]}set decorateToolShapes(t){this.$$set({decorateToolShapes:t}),E()}get decorateShapeControls(){return this.$$.ctx[22]}set decorateShapeControls(t){this.$$set({decorateShapeControls:t}),E()}get decorateActiveTool(){return this.$$.ctx[0]}set decorateActiveTool(t){this.$$set({decorateActiveTool:t}),E()}get decorateEnableButtonFlipVertical(){return this.$$.ctx[23]}set decorateEnableButtonFlipVertical(t){this.$$set({decorateEnableButtonFlipVertical:t}),E()}get decorateEnableSelectImagePreset(){return this.$$.ctx[24]}set decorateEnableSelectImagePreset(t){this.$$set({decorateEnableSelectImagePreset:t}),E()}get decorateEnableDropImagePreset(){return this.$$.ctx[25]}set decorateEnableDropImagePreset(t){this.$$set({decorateEnableDropImagePreset:t}),E()}get decoratePresets(){return this.$$.ctx[26]}set decoratePresets(t){this.$$set({decoratePresets:t}),E()}get decorateWillRenderShapePresetToolbar(){return this.$$.ctx[27]}set decorateWillRenderShapePresetToolbar(t){this.$$set({decorateWillRenderShapePresetToolbar:t}),E()}get decorateWillRenderShapeStyleControls(){return this.$$.ctx[28]}set decorateWillRenderShapeStyleControls(t){this.$$set({decorateWillRenderShapeStyleControls:t}),E()}get enableSelectToolToAddShape(){return this.$$.ctx[29]}set enableSelectToolToAddShape(t){this.$$set({enableSelectToolToAddShape:t}),E()}get enableTapToAddText(){return this.$$.ctx[30]}set enableTapToAddText(t){this.$$set({enableTapToAddText:t}),E()}get enableViewTool(){return this.$$.ctx[31]}set enableViewTool(t){this.$$set({enableViewTool:t}),E()}get enableMoveTool(){return this.$$.ctx[32]}set enableMoveTool(t){this.$$set({enableMoveTool:t}),E()}get enableAutoSelectMoveTool(){return this.$$.ctx[33]}set enableAutoSelectMoveTool(t){this.$$set({enableAutoSelectMoveTool:t}),E()}get willRenderShapeControls(){return this.$$.ctx[34]}set willRenderShapeControls(t){this.$$set({willRenderShapeControls:t}),E()}get willRenderShapeTextControls(){return this.$$.ctx[35]}set willRenderShapeTextControls(t){this.$$set({willRenderShapeTextControls:t}),E()}get beforeAddShape(){return this.$$.ctx[36]}set beforeAddShape(t){this.$$set({beforeAddShape:t}),E()}get beforeRemoveShape(){return this.$$.ctx[37]}set beforeRemoveShape(t){this.$$set({beforeRemoveShape:t}),E()}get beforeDeselectShape(){return this.$$.ctx[38]}set beforeDeselectShape(t){this.$$set({beforeDeselectShape:t}),E()}get beforeSelectShape(){return this.$$.ctx[39]}set beforeSelectShape(t){this.$$set({beforeSelectShape:t}),E()}get beforeUpdateShape(){return this.$$.ctx[40]}set beforeUpdateShape(t){this.$$set({beforeUpdateShape:t}),E()}get markupEditorWillStartInteraction(){return this.$$.ctx[41]}set markupEditorWillStartInteraction(t){this.$$set({markupEditorWillStartInteraction:t}),E()}}]};function A6(t){let e,i;return e=new Bu({props:{stores:t[3],locale:t[4],isActive:t[0],isActiveFraction:t[1],isVisible:t[2],mapScreenPointToImagePoint:t[25],mapImagePointToScreenPoint:t[24],utilKey:"sticker",shapePresets:t[5],shapes:t[6]?t[34]:t[35],toolActive:"preset",imageFlipX:!!t[6]&&t[23],imageFlipY:!!t[6]&&t[22],imageRotation:t[6]?t[30]:0,parentRect:t[6]?t[36]:t[32],snapThreshold:t[28],gridSize:t[27],enableSnapToContext:t[26],enablePresetDropImage:t[7],enablePresetSelectImage:t[29],enableButtonFlipVertical:t[10]||t[8],toolSelectRadius:t[14],willStartInteraction:t[21],willRenderPresetToolbar:t[11]||t[9]||t[15],hooks:{willRenderShapeControls:t[12],willRenderShapeTextControls:t[13],beforeAddShape:t[16],beforeRemoveShape:t[17],beforeDeselectShape:t[18],beforeSelectShape:t[19],beforeUpdateShape:t[20]}}}),e.$on("measure",t[59]),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};8&r[0]&&(o.stores=n[3]),16&r[0]&&(o.locale=n[4]),1&r[0]&&(o.isActive=n[0]),2&r[0]&&(o.isActiveFraction=n[1]),4&r[0]&&(o.isVisible=n[2]),33554432&r[0]&&(o.mapScreenPointToImagePoint=n[25]),16777216&r[0]&&(o.mapImagePointToScreenPoint=n[24]),32&r[0]&&(o.shapePresets=n[5]),64&r[0]&&(o.shapes=n[6]?n[34]:n[35]),8388672&r[0]&&(o.imageFlipX=!!n[6]&&n[23]),4194368&r[0]&&(o.imageFlipY=!!n[6]&&n[22]),1073741888&r[0]&&(o.imageRotation=n[6]?n[30]:0),64&r[0]&&(o.parentRect=n[6]?n[36]:n[32]),268435456&r[0]&&(o.snapThreshold=n[28]),134217728&r[0]&&(o.gridSize=n[27]),67108864&r[0]&&(o.enableSnapToContext=n[26]),128&r[0]&&(o.enablePresetDropImage=n[7]),536870912&r[0]&&(o.enablePresetSelectImage=n[29]),1280&r[0]&&(o.enableButtonFlipVertical=n[10]||n[8]),16384&r[0]&&(o.toolSelectRadius=n[14]),2097152&r[0]&&(o.willStartInteraction=n[21]),35328&r[0]&&(o.willRenderPresetToolbar=n[11]||n[9]||n[15]),2043904&r[0]&&(o.hooks={willRenderShapeControls:n[12],willRenderShapeTextControls:n[13],beforeAddShape:n[16],beforeRemoveShape:n[17],beforeDeselectShape:n[18],beforeSelectShape:n[19],beforeUpdateShape:n[20]}),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function L6(t,e,i){let n,r,o,a,s,l,c,d,u,p,h,g,m,f,x,{isActive:k}=e,{isActiveFraction:w}=e,{isVisible:C}=e,{stores:P}=e,{locale:R={}}=e,{stickers:W=[]}=e,{stickerForceEnable:T=!1}=e,{stickerStickToImage:F=!1}=e,{stickerEnableSelectImagePreset:D=!0}=e,{stickerEnableDropImagePreset:B=!0}=e,{stickerEnableButtonFlipVertical:y=!1}=e,{stickerWillRenderShapePresetToolbar:_}=e,{stickerEnableSelectImage:J=!0}=e,{stickersEnableButtonFlipVertical:S=!1}=e,{stickersWillRenderShapePresetToolbar:j}=e,{markupEditorGridSize:Q=0}=e,{markupEditorSnapThreshold:ht=0}=e,{markupEditorSnapToContext:at=!1}=e,{annotateGridSize:U}=e,{annotateSnapToContext:yt}=e,{decorateGridSize:$t}=e,{decorateSnapToContext:Mt}=e,{willRenderShapeControls:dt}=e,{willRenderShapeTextControls:Tt}=e,{markupEditorToolSelectRadius:K}=e,{willRenderShapePresetToolbar:q}=e,{beforeAddShape:Z}=e,{beforeRemoveShape:xt}=e,{beforeDeselectShape:it}=e,{beforeSelectShape:mt}=e,{beforeUpdateShape:Ft}=e,{markupEditorWillStartInteraction:ie}=e;const{rootRect:Dt,imageCropRect:Ot,imageSelectionRectPresentation:ae,imageAnnotation:G,imageDecoration:wt,imageSize:ut,imageTransforms:Xt,imageTransformsInterpolated:ce,imageRotation:te,imageFlipX:ve,imageFlipY:me}=P;return A(t,Dt,V=>i(58,f=V)),A(t,ae,V=>i(54,d=V)),A(t,ut,V=>i(57,m=V)),A(t,Xt,V=>i(56,g=V)),A(t,ce,V=>i(55,h=V)),A(t,te,V=>i(30,x=V)),A(t,ve,V=>i(23,p=V)),A(t,me,V=>i(22,u=V)),t.$$set=V=>{"isActive"in V&&i(0,k=V.isActive),"isActiveFraction"in V&&i(1,w=V.isActiveFraction),"isVisible"in V&&i(2,C=V.isVisible),"stores"in V&&i(3,P=V.stores),"locale"in V&&i(4,R=V.locale),"stickers"in V&&i(5,W=V.stickers),"stickerForceEnable"in V&&i(43,T=V.stickerForceEnable),"stickerStickToImage"in V&&i(6,F=V.stickerStickToImage),"stickerEnableSelectImagePreset"in V&&i(44,D=V.stickerEnableSelectImagePreset),"stickerEnableDropImagePreset"in V&&i(7,B=V.stickerEnableDropImagePreset),"stickerEnableButtonFlipVertical"in V&&i(8,y=V.stickerEnableButtonFlipVertical),"stickerWillRenderShapePresetToolbar"in V&&i(9,_=V.stickerWillRenderShapePresetToolbar),"stickerEnableSelectImage"in V&&i(45,J=V.stickerEnableSelectImage),"stickersEnableButtonFlipVertical"in V&&i(10,S=V.stickersEnableButtonFlipVertical),"stickersWillRenderShapePresetToolbar"in V&&i(11,j=V.stickersWillRenderShapePresetToolbar),"markupEditorGridSize"in V&&i(46,Q=V.markupEditorGridSize),"markupEditorSnapThreshold"in V&&i(47,ht=V.markupEditorSnapThreshold),"markupEditorSnapToContext"in V&&i(48,at=V.markupEditorSnapToContext),"annotateGridSize"in V&&i(49,U=V.annotateGridSize),"annotateSnapToContext"in V&&i(50,yt=V.annotateSnapToContext),"decorateGridSize"in V&&i(51,$t=V.decorateGridSize),"decorateSnapToContext"in V&&i(52,Mt=V.decorateSnapToContext),"willRenderShapeControls"in V&&i(12,dt=V.willRenderShapeControls),"willRenderShapeTextControls"in V&&i(13,Tt=V.willRenderShapeTextControls),"markupEditorToolSelectRadius"in V&&i(14,K=V.markupEditorToolSelectRadius),"willRenderShapePresetToolbar"in V&&i(15,q=V.willRenderShapePresetToolbar),"beforeAddShape"in V&&i(16,Z=V.beforeAddShape),"beforeRemoveShape"in V&&i(17,xt=V.beforeRemoveShape),"beforeDeselectShape"in V&&i(18,it=V.beforeDeselectShape),"beforeSelectShape"in V&&i(19,mt=V.beforeSelectShape),"beforeUpdateShape"in V&&i(20,Ft=V.beforeUpdateShape),"markupEditorWillStartInteraction"in V&&i(21,ie=V.markupEditorWillStartInteraction)},t.$$.update=()=>{16777216&t.$$.dirty[1]&&i(53,n=h?h.scale:1),24576&t.$$.dirty[1]&&i(29,r=D!==!1&&J),65536&t.$$.dirty[1]&&i(28,o=ht),64&t.$$.dirty[0]|1343488&t.$$.dirty[1]&&i(27,a=F?di(U)?U:Q:di($t)?$t:Q),64&t.$$.dirty[0]|2752512&t.$$.dirty[1]&&i(26,s=F?Vl(yt)?yt:at:Vl(Mt)?Mt:at),12582976&t.$$.dirty[0]|264241152&t.$$.dirty[1]&&i(25,l=F?V=>o0(V,f,m,h.origin,h.translation,g.rotation.z,h.scale,p,u):V=>{const Ce=Oe(V);return Ce.x-=d.x,Ce.y-=d.y,Ce.x/=n,Ce.y/=n,Ce}),12582976&t.$$.dirty[0]|264241152&t.$$.dirty[1]&&i(24,c=F?V=>r0(V,f,m,h.origin,h.translation,g.rotation.z,h.scale,p,u):V=>{const Ce=Oe(V);return Ce.x*=n,Ce.y*=n,Ce.x+=d.x,Ce.y+=d.y,Ce})},[k,w,C,P,R,W,F,B,y,_,S,j,dt,Tt,K,q,Z,xt,it,mt,Ft,ie,u,p,c,l,s,a,o,r,x,Dt,Ot,ae,G,wt,ut,Xt,ce,te,ve,me,"sticker",T,D,J,Q,ht,at,U,yt,$t,Mt,n,d,h,g,m,f,function(V){Wr.call(this,t,V)}]}var z6={util:["sticker",class extends li{constructor(t){super(),si(this,t,L6,A6,ni,{name:42,isActive:0,isActiveFraction:1,isVisible:2,stores:3,locale:4,stickers:5,stickerForceEnable:43,stickerStickToImage:6,stickerEnableSelectImagePreset:44,stickerEnableDropImagePreset:7,stickerEnableButtonFlipVertical:8,stickerWillRenderShapePresetToolbar:9,stickerEnableSelectImage:45,stickersEnableButtonFlipVertical:10,stickersWillRenderShapePresetToolbar:11,markupEditorGridSize:46,markupEditorSnapThreshold:47,markupEditorSnapToContext:48,annotateGridSize:49,annotateSnapToContext:50,decorateGridSize:51,decorateSnapToContext:52,willRenderShapeControls:12,willRenderShapeTextControls:13,markupEditorToolSelectRadius:14,willRenderShapePresetToolbar:15,beforeAddShape:16,beforeRemoveShape:17,beforeDeselectShape:18,beforeSelectShape:19,beforeUpdateShape:20,markupEditorWillStartInteraction:21},null,[-1,-1])}get name(){return this.$$.ctx[42]}get isActive(){return this.$$.ctx[0]}set isActive(t){this.$$set({isActive:t}),E()}get isActiveFraction(){return this.$$.ctx[1]}set isActiveFraction(t){this.$$set({isActiveFraction:t}),E()}get isVisible(){return this.$$.ctx[2]}set isVisible(t){this.$$set({isVisible:t}),E()}get stores(){return this.$$.ctx[3]}set stores(t){this.$$set({stores:t}),E()}get locale(){return this.$$.ctx[4]}set locale(t){this.$$set({locale:t}),E()}get stickers(){return this.$$.ctx[5]}set stickers(t){this.$$set({stickers:t}),E()}get stickerForceEnable(){return this.$$.ctx[43]}set stickerForceEnable(t){this.$$set({stickerForceEnable:t}),E()}get stickerStickToImage(){return this.$$.ctx[6]}set stickerStickToImage(t){this.$$set({stickerStickToImage:t}),E()}get stickerEnableSelectImagePreset(){return this.$$.ctx[44]}set stickerEnableSelectImagePreset(t){this.$$set({stickerEnableSelectImagePreset:t}),E()}get stickerEnableDropImagePreset(){return this.$$.ctx[7]}set stickerEnableDropImagePreset(t){this.$$set({stickerEnableDropImagePreset:t}),E()}get stickerEnableButtonFlipVertical(){return this.$$.ctx[8]}set stickerEnableButtonFlipVertical(t){this.$$set({stickerEnableButtonFlipVertical:t}),E()}get stickerWillRenderShapePresetToolbar(){return this.$$.ctx[9]}set stickerWillRenderShapePresetToolbar(t){this.$$set({stickerWillRenderShapePresetToolbar:t}),E()}get stickerEnableSelectImage(){return this.$$.ctx[45]}set stickerEnableSelectImage(t){this.$$set({stickerEnableSelectImage:t}),E()}get stickersEnableButtonFlipVertical(){return this.$$.ctx[10]}set stickersEnableButtonFlipVertical(t){this.$$set({stickersEnableButtonFlipVertical:t}),E()}get stickersWillRenderShapePresetToolbar(){return this.$$.ctx[11]}set stickersWillRenderShapePresetToolbar(t){this.$$set({stickersWillRenderShapePresetToolbar:t}),E()}get markupEditorGridSize(){return this.$$.ctx[46]}set markupEditorGridSize(t){this.$$set({markupEditorGridSize:t}),E()}get markupEditorSnapThreshold(){return this.$$.ctx[47]}set markupEditorSnapThreshold(t){this.$$set({markupEditorSnapThreshold:t}),E()}get markupEditorSnapToContext(){return this.$$.ctx[48]}set markupEditorSnapToContext(t){this.$$set({markupEditorSnapToContext:t}),E()}get annotateGridSize(){return this.$$.ctx[49]}set annotateGridSize(t){this.$$set({annotateGridSize:t}),E()}get annotateSnapToContext(){return this.$$.ctx[50]}set annotateSnapToContext(t){this.$$set({annotateSnapToContext:t}),E()}get decorateGridSize(){return this.$$.ctx[51]}set decorateGridSize(t){this.$$set({decorateGridSize:t}),E()}get decorateSnapToContext(){return this.$$.ctx[52]}set decorateSnapToContext(t){this.$$set({decorateSnapToContext:t}),E()}get willRenderShapeControls(){return this.$$.ctx[12]}set willRenderShapeControls(t){this.$$set({willRenderShapeControls:t}),E()}get willRenderShapeTextControls(){return this.$$.ctx[13]}set willRenderShapeTextControls(t){this.$$set({willRenderShapeTextControls:t}),E()}get markupEditorToolSelectRadius(){return this.$$.ctx[14]}set markupEditorToolSelectRadius(t){this.$$set({markupEditorToolSelectRadius:t}),E()}get willRenderShapePresetToolbar(){return this.$$.ctx[15]}set willRenderShapePresetToolbar(t){this.$$set({willRenderShapePresetToolbar:t}),E()}get beforeAddShape(){return this.$$.ctx[16]}set beforeAddShape(t){this.$$set({beforeAddShape:t}),E()}get beforeRemoveShape(){return this.$$.ctx[17]}set beforeRemoveShape(t){this.$$set({beforeRemoveShape:t}),E()}get beforeDeselectShape(){return this.$$.ctx[18]}set beforeDeselectShape(t){this.$$set({beforeDeselectShape:t}),E()}get beforeSelectShape(){return this.$$.ctx[19]}set beforeSelectShape(t){this.$$set({beforeSelectShape:t}),E()}get beforeUpdateShape(){return this.$$.ctx[20]}set beforeUpdateShape(t){this.$$set({beforeUpdateShape:t}),E()}get markupEditorWillStartInteraction(){return this.$$.ctx[21]}set markupEditorWillStartInteraction(t){this.$$set({markupEditorWillStartInteraction:t}),E()}},({stickers:t,stickerEnableSelectImage:e,stickerEnableSelectImagePreset:i,stickerEnableDropImagePreset:n,stickerForceEnable:r})=>t&&t.length||e||i||n||r]};function F6(t){let e,i,n,r,o,a=(t[14](t[34].value)||"")+"",s=(on(t[34].label)?t[34].label(t[1]):t[34].label)+"";return{c(){e=pt("div"),i=new Pu(!1),n=he(),r=pt("span"),o=gn(s),i.a=n,v(e,"slot","option")},m(l,c){et(l,e,c),i.m(a,e),kt(e,n),kt(e,r),kt(r,o)},p(l,c){8&c[1]&&a!==(a=(l[14](l[34].value)||"")+"")&&i.p(a),2&c[0]|8&c[1]&&s!==(s=(on(l[34].label)?l[34].label(l[1]):l[34].label)+"")&&zn(o,s)},d(l){l&&tt(e)}}}function D6(t){let e,i;return e=new ss({props:{locale:t[1],class:"PinturaControlList",layout:"row",options:t[2],selectedIndex:t[6],onchange:t[12],$$slots:{option:[F6,({option:n})=>({34:n}),({option:n})=>[0,n?8:0]]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};2&r[0]&&(o.locale=n[1]),4&r[0]&&(o.options=n[2]),64&r[0]&&(o.selectedIndex=n[6]),2&r[0]|24&r[1]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function B6(t){let e,i,n,r,o;return i=new Du({props:{locale:t[1],class:"PinturaControlPanels",shape:t[4],onchange:t[13],controls:t[3],scrollElasticity:t[7]}}),r=new Ca({props:{elasticity:t[10],$$slots:{default:[D6]},$$scope:{ctx:t}}}),{c(){e=pt("div"),Et(i.$$.fragment),n=he(),Et(r.$$.fragment),v(e,"slot","footer"),v(e,"style",t[5])},m(a,s){et(a,e,s),Rt(i,e,null),kt(e,n),Rt(r,e,null),o=!0},p(a,s){const l={};2&s[0]&&(l.locale=a[1]),16&s[0]&&(l.shape=a[4]),8&s[0]&&(l.controls=a[3]),128&s[0]&&(l.scrollElasticity=a[7]),i.$set(l);const c={};70&s[0]|16&s[1]&&(c.$$scope={dirty:s,ctx:a}),r.$set(c),(!o||32&s[0])&&v(e,"style",a[5])},i(a){o||(M(i.$$.fragment,a),M(r.$$.fragment,a),o=!0)},o(a){z(i.$$.fragment,a),z(r.$$.fragment,a),o=!1},d(a){a&&tt(e),It(i),It(r)}}}function O6(t){let e,i;return e=new cl({props:{$$slots:{footer:[B6]},$$scope:{ctx:t}}}),e.$on("measure",t[23]),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};254&r[0]|16&r[1]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function W6(t,e,i){let n,r,o,a,s,l,c,d,u=Ke,p=()=>(u(),u=Br(h,S=>i(20,s=S)),h);t.$$.on_destroy.push(()=>u());let{isActive:h}=e;p();let{stores:g}=e,{locale:m={}}=e,{frameStyles:f={}}=e,{frameOptions:x=[]}=e,{markupEditorShapeStyleControls:k}=e;const w=dn("elasticityMultiplier");A(t,w,S=>i(22,d=S));const{history:C,animation:P,scrollElasticity:R,imageFrame:W,allowPan:T,allowZoom:F,allowZoomControls:D,allowPlayPause:B}=g;A(t,P,S=>i(21,l=S)),A(t,W,S=>i(4,c=S));let y={},_;const J=ci(l?20:0);return A(t,J,S=>i(19,a=S)),t.$$set=S=>{"isActive"in S&&p(i(0,h=S.isActive)),"stores"in S&&i(17,g=S.stores),"locale"in S&&i(1,m=S.locale),"frameStyles"in S&&i(18,f=S.frameStyles),"frameOptions"in S&&i(2,x=S.frameOptions),"markupEditorShapeStyleControls"in S&&i(3,k=S.markupEditorShapeStyleControls)},t.$$.update=()=>{1048576&t.$$.dirty[0]&&T.set(s),1048576&t.$$.dirty[0]&&F.set(s),1048576&t.$$.dirty[0]&&D.set(s),1048576&t.$$.dirty[0]&&s&&B.set(!0),4194304&t.$$.dirty[0]&&i(7,n=d*R),20&t.$$.dirty[0]&&i(6,r=c?x.findIndex(([S])=>S===c.id):0),3145728&t.$$.dirty[0]&&l&&J.set(s?0:20),524288&t.$$.dirty[0]&&i(5,o=a?`transform: translateY(${a}px)`:void 0)},[h,m,x,k,c,o,r,n,w,P,R,W,({value:S})=>{const j=f[S];if(!j||!j.shape)return W.set(void 0),void C.write();const{shape:Q}=j,ht={id:S,...Hn(Q),...Object.keys(y).reduce((at,U)=>(Q[U]&&(at[U]=y[U]),at),{})};W.set(ht),C.write()},function(S){Ae(S,"frameColor")&&(y.frameColor=S.frameColor),c&&(xa(c,S),W.set(c),clearTimeout(_),_=setTimeout(()=>{C.write()},200))},S=>{const j=f[S];var Q;if(j&&j.thumb)return Q=j.thumb,/div/i.test(Q)||K2(Q)?Q:/rect|path|circle|line|<g>/i.test(Q)?`<svg xmlns="http://www.w3.org/2000/svg" width="100%" height="100%" stroke-width="1" stroke="currentColor" fill="none" aria-hidden="true" focusable="false" stroke-linecap="round" stroke-linejoin="round">${Q}</svg>`:`<img src="${Q}" alt=""/>`},J,"frame",g,f,a,s,l,d,function(S){Wr.call(this,t,S)}]}var _6={util:["frame",class extends li{constructor(t){super(),si(this,t,W6,O6,ni,{name:16,isActive:0,stores:17,locale:1,frameStyles:18,frameOptions:2,markupEditorShapeStyleControls:3},null,[-1,-1])}get name(){return this.$$.ctx[16]}get isActive(){return this.$$.ctx[0]}set isActive(t){this.$$set({isActive:t}),E()}get stores(){return this.$$.ctx[17]}set stores(t){this.$$set({stores:t}),E()}get locale(){return this.$$.ctx[1]}set locale(t){this.$$set({locale:t}),E()}get frameStyles(){return this.$$.ctx[18]}set frameStyles(t){this.$$set({frameStyles:t}),E()}get frameOptions(){return this.$$.ctx[2]}set frameOptions(t){this.$$set({frameOptions:t}),E()}get markupEditorShapeStyleControls(){return this.$$.ctx[3]}set markupEditorShapeStyleControls(t){this.$$set({markupEditorShapeStyleControls:t}),E()}},({src:t})=>t&&!ll(t)]};function V6(t){let e,i,n,r,o,a,s,l;return{c(){e=pt("div"),i=pt("input"),r=he(),o=pt("label"),a=gn(t[1]),v(i,"id",t[0]),v(i,"type","number"),v(i,"min","1"),v(i,"inputmode","numeric"),v(i,"pattern","[0-9]*"),v(i,"data-state",t[3]),v(i,"autocomplete","off"),v(i,"placeholder",t[4]),i.value=n=t[5]===void 0?"":t[7](t[5]+""),v(o,"for",t[0]),v(o,"title",t[2]),v(o,"aria-label",t[2]),v(e,"class","PinturaInputDimension")},m(c,d){et(c,e,d),kt(e,i),kt(e,r),kt(e,o),kt(o,a),s||(l=Ct(i,"input",t[8]),s=!0)},p(c,[d]){1&d&&v(i,"id",c[0]),8&d&&v(i,"data-state",c[3]),16&d&&v(i,"placeholder",c[4]),160&d&&n!==(n=c[5]===void 0?"":c[7](c[5]+""))&&i.value!==n&&(i.value=n),2&d&&zn(a,c[1]),1&d&&v(o,"for",c[0]),4&d&&v(o,"title",c[2]),4&d&&v(o,"aria-label",c[2])},i:Ke,o:Ke,d(c){c&&tt(e),s=!1,l()}}}function N6(t,e,i){let{id:n}=e,{label:r}=e,{title:o}=e,{state:a}=e,{placeholder:s}=e,{value:l}=e,{onchange:c}=e,{format:d=u=>u.replace(/\D/g,"")}=e;return t.$$set=u=>{"id"in u&&i(0,n=u.id),"label"in u&&i(1,r=u.label),"title"in u&&i(2,o=u.title),"state"in u&&i(3,a=u.state),"placeholder"in u&&i(4,s=u.placeholder),"value"in u&&i(5,l=u.value),"onchange"in u&&i(6,c=u.onchange),"format"in u&&i(7,d=u.format)},[n,r,o,a,s,l,c,d,u=>c(d(u.currentTarget.value))]}class _f extends li{constructor(e){super(),si(this,e,N6,V6,ni,{id:0,label:1,title:2,state:3,placeholder:4,value:5,onchange:6,format:7})}}function H6(t){let e;return{c(){e=fr("g")},m(i,n){et(i,e,n),e.innerHTML=t[2]},p(i,n){4&n&&(e.innerHTML=i[2])},d(i){i&&tt(e)}}}function j6(t){let e,i,n,r,o,a,s,l;return o=new Co({props:{$$slots:{default:[H6]},$$scope:{ctx:t}}}),{c(){e=pt("div"),i=pt("input"),n=he(),r=pt("label"),Et(o.$$.fragment),v(i,"id",t[0]),v(i,"class","implicit"),v(i,"type","checkbox"),i.checked=t[1],v(r,"for",t[0]),v(r,"title",t[3])},m(c,d){et(c,e,d),kt(e,i),kt(e,n),kt(e,r),Rt(o,r,null),a=!0,s||(l=Ct(i,"change",t[5]),s=!0)},p(c,[d]){(!a||1&d)&&v(i,"id",c[0]),(!a||2&d)&&(i.checked=c[1]);const u={};68&d&&(u.$$scope={dirty:d,ctx:c}),o.$set(u),(!a||1&d)&&v(r,"for",c[0]),(!a||8&d)&&v(r,"title",c[3])},i(c){a||(M(o.$$.fragment,c),a=!0)},o(c){z(o.$$.fragment,c),a=!1},d(c){c&&tt(e),It(o),s=!1,l()}}}function U6(t,e,i){let{id:n}=e,{locked:r}=e,{icon:o}=e,{title:a}=e,{onchange:s}=e;return t.$$set=l=>{"id"in l&&i(0,n=l.id),"locked"in l&&i(1,r=l.locked),"icon"in l&&i(2,o=l.icon),"title"in l&&i(3,a=l.title),"onchange"in l&&i(4,s=l.onchange)},[n,r,o,a,s,l=>s(l.currentTarget.checked)]}class G6 extends li{constructor(e){super(),si(this,e,U6,j6,ni,{id:0,locked:1,icon:2,title:3,onchange:4})}}function Z6(t){let e;return{c(){e=gn("Save")},m(i,n){et(i,e,n)},d(i){i&&tt(e)}}}function X6(t){let e,i,n,r,o,a,s,l,c,d,u,p,h,g=t[1].resizeLabelFormCaption+"";return l=new oo({props:{items:t[4]}}),d=new Fs({props:{type:"submit",class:"implicit",$$slots:{default:[Z6]},$$scope:{ctx:t}}}),{c(){e=pt("form"),i=pt("div"),n=pt("fieldset"),r=pt("legend"),o=gn(g),a=he(),s=pt("div"),Et(l.$$.fragment),c=he(),Et(d.$$.fragment),v(r,"class","implicit"),v(s,"class","PinturaFieldsetInner"),v(i,"class","PinturaFormInner"),v(e,"slot","footer"),v(e,"style",t[3])},m(m,f){et(m,e,f),kt(e,i),kt(i,n),kt(n,r),kt(r,o),kt(n,a),kt(n,s),Rt(l,s,null),t[65](s),kt(i,c),Rt(d,i,null),u=!0,p||(h=[Ct(s,"focusin",t[15]),Ct(s,"focusout",t[16]),Ct(e,"submit",Ub(t[17]))],p=!0)},p(m,f){(!u||2&f[0])&&g!==(g=m[1].resizeLabelFormCaption+"")&&zn(o,g);const x={};16&f[0]&&(x.items=m[4]),l.$set(x);const k={};16&f[3]&&(k.$$scope={dirty:f,ctx:m}),d.$set(k),(!u||8&f[0])&&v(e,"style",m[3])},i(m){u||(M(l.$$.fragment,m),M(d.$$.fragment,m),u=!0)},o(m){z(l.$$.fragment,m),z(d.$$.fragment,m),u=!1},d(m){m&&tt(e),It(l),t[65](null),It(d),p=!1,Bi(h)}}}function Y6(t){let e,i;return e=new cl({props:{$$slots:{footer:[X6]},$$scope:{ctx:t}}}),e.$on("measure",t[66]),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};30&r[0]|16&r[3]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function q6(t,e,i){let n,r,o,a,s,l,c,d,u,p,h,g,m,f,x,k,w,C,P,R,W,T,F,D,B,y,_,J,S,j,Q=Ke,ht=()=>(Q(),Q=Br(U,nt=>i(49,h=nt)),U);t.$$.on_destroy.push(()=>Q());const at=(nt,Qt=0,Zt=9999)=>{if(We(nt)&&!(nt=nt.replace(/\D/g,"")).length)return;const Kt=Math.round(nt);return Number.isNaN(Kt)?void 0:Ji(Kt,Qt,Zt)};let{isActive:U}=e;ht();let{stores:yt}=e,{locale:$t={}}=e,{resizeMinSize:Mt=jn(1,1)}=e,{resizeMaxSize:dt=jn(9999,9999)}=e,{resizeAspectRatioLocked:Tt=!1}=e,{resizeEnableButtonLockAspectRatio:K=!0}=e,{resizeSizePresetOptions:q}=e,{resizeWidthPresetOptions:Z}=e,{resizeHeightPresetOptions:xt}=e,{resizeWillRenderFooter:it=Yi}=e;const mt=ci(0,{stiffness:.15,damping:.3});A(t,mt,nt=>i(54,k=nt));const{animation:Ft,imageSize:ie,imageCropRect:Dt,imageCropRectAspectRatio:Ot,imageCropAspectRatio:ae,imageOutputSize:G,imageSelectionZoom:wt,imageSelectionPan:ut,history:Xt,env:ce,allowPan:te,allowZoom:ve,allowZoomControls:me,allowPlayPause:V}=yt;A(t,Ft,nt=>i(50,g=nt)),A(t,ie,nt=>i(73,J=nt)),A(t,Dt,nt=>i(52,f=nt)),A(t,Ot,nt=>i(53,x=nt)),A(t,ae,nt=>i(72,D=nt)),A(t,G,nt=>i(61,F=nt)),A(t,wt,nt=>i(74,S=nt)),A(t,ut,nt=>i(75,j=nt)),A(t,ce,nt=>i(51,m=nt));const Ce=na();let yi,xe,_t,ze,Ie,Fe,hi=rn();const bt=(nt,Qt,Zt,Kt,Yt)=>nt!=null&&Zt!==Qt?nt>=Kt[Qt]&&nt<=Yt[Qt]?"valid":"invalid":"undetermined",ne=(nt,Qt,Zt)=>Math.round(nt!=null?nt/Qt:Zt.height),Ue=()=>{Tt&&xe&&_t&&(ze==="width"?i(39,_t=Math.round(xe/x)):ze==="height"?i(38,xe=Math.round(_t*x)):(Ie==="width"?i(39,_t=Math.round(xe/x)):Ie==="height"&&i(38,xe=Math.round(_t*x)),Ee()))},Ee=nt=>{let Qt=at(xe),Zt=at(_t),Kt=Qt,Yt=Zt,st=Kt&&Yt,le=nt||x;if(!Kt&&!Yt)return;Kt&&!Yt?Yt=Math.round(Kt/le):Yt&&!Kt&&(Kt=Math.round(Yt*le)),le=nt||st?Jo(Kt,Yt):x;let ee=jn(Kt,Yt);cu(dt,ee)||(ee=qr(dt,le)),cu(ee,Mt)||(ee=os(Mt,le)),i(38,xe=Qt!=null?Math.round(ee.width):void 0),i(39,_t=Zt!=null?Math.round(ee.height):void 0)},jt=()=>{Ee();const{width:nt,height:Qt}=F||{};nt===xe&&Qt===_t||(xe||_t?(xe&&_t&&vt(ae,D=xe/_t,D),vt(G,F=jn(xe,_t),F)):(vt(ae,D=J.width/J.height,D),vt(ae,D=void 0,D),vt(G,F=void 0,F)),Xt.write())},Ge=G.subscribe(nt=>{if(!nt)return i(38,xe=void 0),void i(39,_t=void 0);i(38,xe=nt.width),i(39,_t=nt.height),Ee()}),Qe=ae.subscribe(nt=>{(xe||_t)&&nt&&(xe&&_t&&Jo(xe,_t)!==nt?(i(39,_t=xe/nt),Ee(nt)):Ee())}),mi=nt=>We(nt[0])?(nt[1]=nt[1].map(mi),nt):di(nt)?[nt,""+nt]:nt,$i=nt=>{if(We(nt[0]))return nt[1]=nt[1].map($i),nt;let[Qt,Zt]=nt;if(di(Qt)&&di(Zt)){const[Kt,Yt]=[Qt,Zt];Zt=`${Kt} &times; ${Yt}`,Qt=[Kt,Yt]}return[Qt,Zt]},Li=pe();A(t,Li,nt=>i(60,T=nt));const X=pe();A(t,X,nt=>i(64,_=nt));const Ut=pe();A(t,Ut,nt=>i(58,R=nt));const H=pe();A(t,H,nt=>i(63,y=nt));const Bt=pe();A(t,Bt,nt=>i(56,C=nt));const be=pe();A(t,be,nt=>i(62,B=nt));const se=Ii([G,X],([nt,Qt],Zt)=>{if(!Qt)return Zt(-1);const Kt=Qt.findIndex(([Yt])=>{if(!Yt&&!nt)return!0;if(!Yt)return!1;const[st,le]=Yt;return nt.width===st&&nt.height===le});Zt(Kt<0?0:Kt)});A(t,se,nt=>i(59,W=nt));const At=Ii([G,H],([nt,Qt],Zt)=>{if(!Qt)return Zt(-1);const Kt=Qt.findIndex(([Yt])=>!Yt&&!nt||!!Yt&&nt.width===Yt);Zt(Kt<0?0:Kt)});A(t,At,nt=>i(57,P=nt));const re=Ii([G,be],([nt,Qt],Zt)=>{if(!Qt)return Zt(-1);const Kt=Qt.findIndex(([Yt])=>!Yt&&!nt||!!Yt&&nt.height===Yt);Zt(Kt<0?0:Kt)});A(t,re,nt=>i(55,w=nt));let Me,De;const _e=dn("redrawTrigger"),Ze=ci(g?20:0);return A(t,Ze,nt=>i(48,p=nt)),Vo(()=>{Ge(),Qe()}),t.$$set=nt=>{"isActive"in nt&&ht(i(0,U=nt.isActive)),"stores"in nt&&i(30,yt=nt.stores),"locale"in nt&&i(1,$t=nt.locale),"resizeMinSize"in nt&&i(31,Mt=nt.resizeMinSize),"resizeMaxSize"in nt&&i(32,dt=nt.resizeMaxSize),"resizeAspectRatioLocked"in nt&&i(28,Tt=nt.resizeAspectRatioLocked),"resizeEnableButtonLockAspectRatio"in nt&&i(33,K=nt.resizeEnableButtonLockAspectRatio),"resizeSizePresetOptions"in nt&&i(34,q=nt.resizeSizePresetOptions),"resizeWidthPresetOptions"in nt&&i(35,Z=nt.resizeWidthPresetOptions),"resizeHeightPresetOptions"in nt&&i(36,xt=nt.resizeHeightPresetOptions),"resizeWillRenderFooter"in nt&&i(37,it=nt.resizeWillRenderFooter)},t.$$.update=()=>{var nt;262144&t.$$.dirty[1]&&te.set(!h),262144&t.$$.dirty[1]&&ve.set(!h),262144&t.$$.dirty[1]&&me.set(!h),262144&t.$$.dirty[1]&&h&&V.set(!0),536870920&t.$$.dirty[1]&&q&&(vt(Li,T=q.map($i),T),vt(X,_=Ts(T),_)),536870912&t.$$.dirty[1]&&i(47,a=!!T),268435456&t.$$.dirty[1]|4&t.$$.dirty[2]&&i(46,n=W>-1&&_[W][1]),134217744&t.$$.dirty[1]&&Z&&(vt(Ut,R=Z.map(mi),R),vt(H,y=Ts(R),y)),134283264&t.$$.dirty[1]&&i(44,s=!a&&R),67108864&t.$$.dirty[1]|2&t.$$.dirty[2]&&i(45,r=P>-1&&y[P][1]),33554464&t.$$.dirty[1]&&xt&&(vt(Bt,C=xt.map(mi),C),vt(be,B=Ts(C),B)),33619968&t.$$.dirty[1]&&i(43,l=!a&&C),16777216&t.$$.dirty[1]|1&t.$$.dirty[2]&&i(42,o=w>-1&&B[w][1]),77824&t.$$.dirty[1]&&i(41,c=!a&&!s&&!l),268435458&t.$$.dirty[0]|1072824263&t.$$.dirty[1]&&i(4,d=_e&&_c(()=>{return it([a&&["Dropdown","size-presets",{label:n,options:T,onchange:Yt=>{return(st=Yt.value)&&!Me&&(Me={...f},De=D),st?(vt(ae,D=Jo(st[0],st[1]),D),vt(G,F=ey(st),F)):(vt(Dt,f=Me,f),vt(ae,D=De,D),vt(G,F=void 0,F),Me=void 0,De=void 0),void Xt.write();var st},selectedIndex:W}],s&&["Dropdown","width-presets",{label:r,options:R,onchange:Yt=>{i(38,xe=Yt.value),jt()},selectedIndex:P}],s&&l&&["span","times",{class:"PinturaResizeLabel",innerHTML:"&times;"}],l&&["Dropdown","height-presets",{label:o,options:C,onchange:Yt=>{i(39,_t=Yt.value),jt()},selectedIndex:w}],c&&[_f,"width-input",{id:"width-"+Ce,title:$t.resizeTitleInputWidth,label:$t.resizeLabelInputWidth,placeholder:(Qt=at(_t),Zt=x,Kt=f,Math.round(Qt!=null?Qt*Zt:Kt.width)),value:xe,state:bt(at(xe),"width",ze,Mt,dt),onchange:Yt=>{i(38,xe=Yt),Ue()}}],c&&K&&[G6,"aspect-ratio-lock",{id:"aspect-ratio-lock-"+Ce,title:$t.resizeTitleButtonMaintainAspectRatio,icon:We($t.resizeIconButtonMaintainAspectRatio)?$t.resizeIconButtonMaintainAspectRatio:$t.resizeIconButtonMaintainAspectRatio(Tt,k),locked:Tt,onchange:Yt=>{i(28,Tt=Yt),Ue()}}],c&&[_f,"height-input",{id:"height-"+Ce,title:$t.resizeTitleInputHeight,label:$t.resizeLabelInputHeight,placeholder:ne(at(xe),x,f),value:_t,state:bt(at(_t),"height",ze,Mt,dt),onchange:Yt=>{i(39,_t=Yt),Ue()}}]].filter(Boolean),{...m},()=>_e.set({}));var Qt,Zt,Kt}).filter(Boolean)),268435456&t.$$.dirty[0]&&mt.set(Tt?1:0),512&t.$$.dirty[1]&&ze&&(Ie=ze),262144&t.$$.dirty[1]&&h&&(hi=j,Fe=S),1074003968&t.$$.dirty[1]&&(h?(nt=F,vt(ut,j=rn(),j),vt(wt,S=nt&&f?nt.width/f.width||nt.height/f.height:1,S)):(vt(ut,j=hi,j),vt(wt,S=Fe,S))),786432&t.$$.dirty[1]&&g&&Ze.set(h?0:20),131072&t.$$.dirty[1]&&i(3,u=p?`transform: translateY(${p}px)`:void 0)},[U,$t,yi,u,d,mt,Ft,ie,Dt,Ot,ae,G,wt,ut,ce,nt=>{const Qt=nt.target.id;/width/.test(Qt)?i(40,ze="width"):/height/.test(Qt)?i(40,ze="height"):/aspectRatio/i.test(Qt)?i(40,ze="lock"):i(40,ze=void 0)},nt=>{yi.contains(nt.relatedTarget)||jt(),i(40,ze=void 0)},jt,Li,X,Ut,H,Bt,be,se,At,re,Ze,Tt,"resize",yt,Mt,dt,K,q,Z,xt,it,xe,_t,ze,c,o,l,s,r,n,a,p,h,g,m,f,x,k,w,C,P,R,W,T,F,B,y,_,function(nt){Ai[nt?"unshift":"push"](()=>{yi=nt,i(2,yi)})},function(nt){Wr.call(this,t,nt)}]}var K6={util:["resize",class extends li{constructor(t){super(),si(this,t,q6,Y6,ni,{name:29,isActive:0,stores:30,locale:1,resizeMinSize:31,resizeMaxSize:32,resizeAspectRatioLocked:28,resizeEnableButtonLockAspectRatio:33,resizeSizePresetOptions:34,resizeWidthPresetOptions:35,resizeHeightPresetOptions:36,resizeWillRenderFooter:37},null,[-1,-1,-1,-1])}get name(){return this.$$.ctx[29]}get isActive(){return this.$$.ctx[0]}set isActive(t){this.$$set({isActive:t}),E()}get stores(){return this.$$.ctx[30]}set stores(t){this.$$set({stores:t}),E()}get locale(){return this.$$.ctx[1]}set locale(t){this.$$set({locale:t}),E()}get resizeMinSize(){return this.$$.ctx[31]}set resizeMinSize(t){this.$$set({resizeMinSize:t}),E()}get resizeMaxSize(){return this.$$.ctx[32]}set resizeMaxSize(t){this.$$set({resizeMaxSize:t}),E()}get resizeAspectRatioLocked(){return this.$$.ctx[28]}set resizeAspectRatioLocked(t){this.$$set({resizeAspectRatioLocked:t}),E()}get resizeEnableButtonLockAspectRatio(){return this.$$.ctx[33]}set resizeEnableButtonLockAspectRatio(t){this.$$set({resizeEnableButtonLockAspectRatio:t}),E()}get resizeSizePresetOptions(){return this.$$.ctx[34]}set resizeSizePresetOptions(t){this.$$set({resizeSizePresetOptions:t}),E()}get resizeWidthPresetOptions(){return this.$$.ctx[35]}set resizeWidthPresetOptions(t){this.$$set({resizeWidthPresetOptions:t}),E()}get resizeHeightPresetOptions(){return this.$$.ctx[36]}set resizeHeightPresetOptions(t){this.$$set({resizeHeightPresetOptions:t}),E()}get resizeWillRenderFooter(){return this.$$.ctx[37]}set resizeWillRenderFooter(t){this.$$set({resizeWillRenderFooter:t}),E()}},({src:t})=>t&&!ll(t)]};function J6(t){let e,i;return e=new Bu({props:{stores:t[3],locale:t[4],isActive:t[0],isActiveFraction:t[1],isVisible:t[2],mapScreenPointToImagePoint:t[9],mapImagePointToScreenPoint:t[8],utilKey:"redact",imageRotation:t[10],imageFlipX:t[7],imageFlipY:t[6],shapes:t[11],toolbar:["rect"],toolShapes:{rectangle:[{x:0,y:0,width:0,height:0}]},toolActive:"rectangle",parentRect:t[13],enablePresetDropImage:!1,enablePresetSelectImage:!1,willStartInteraction:t[5],hooks:{willRenderShapeControls:t[24]}}}),e.$on("measure",t[25]),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,[r]){const o={};8&r&&(o.stores=n[3]),16&r&&(o.locale=n[4]),1&r&&(o.isActive=n[0]),2&r&&(o.isActiveFraction=n[1]),4&r&&(o.isVisible=n[2]),512&r&&(o.mapScreenPointToImagePoint=n[9]),256&r&&(o.mapImagePointToScreenPoint=n[8]),1024&r&&(o.imageRotation=n[10]),128&r&&(o.imageFlipX=n[7]),64&r&&(o.imageFlipY=n[6]),32&r&&(o.willStartInteraction=n[5]),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function Q6(t,e,i){let n,r,o,a,s,l,c,d,u,{isActive:p}=e,{isActiveFraction:h}=e,{isVisible:g}=e,{stores:m}=e,{locale:f={}}=e,{markupEditorWillStartInteraction:x}=e;const{imageRedaction:k,rootRect:w,imageSize:C,imageRotation:P,imageFlipX:R,imageFlipY:W,imageTransforms:T,imageTransformsInterpolated:F}=m;return A(t,w,D=>i(23,d=D)),A(t,C,D=>i(22,c=D)),A(t,P,D=>i(10,u=D)),A(t,R,D=>i(7,a=D)),A(t,W,D=>i(6,o=D)),A(t,T,D=>i(21,l=D)),A(t,F,D=>i(20,s=D)),t.$$set=D=>{"isActive"in D&&i(0,p=D.isActive),"isActiveFraction"in D&&i(1,h=D.isActiveFraction),"isVisible"in D&&i(2,g=D.isVisible),"stores"in D&&i(3,m=D.stores),"locale"in D&&i(4,f=D.locale),"markupEditorWillStartInteraction"in D&&i(5,x=D.markupEditorWillStartInteraction)},t.$$.update=()=>{15728832&t.$$.dirty&&i(9,n=D=>o0(D,d,c,s.origin,s.translation,l.rotation.z,s.scale,a,o)),15728832&t.$$.dirty&&i(8,r=D=>r0(D,d,c,s.origin,s.translation,l.rotation.z,s.scale,a,o))},[p,h,g,m,f,x,o,a,r,n,u,k,w,C,P,R,W,T,F,"redact",s,l,c,d,D=>{const B=uh(D[0]);return k3("to-front",B),D},function(D){Wr.call(this,t,D)}]}var t8={util:["redact",class extends li{constructor(t){super(),si(this,t,Q6,J6,ni,{name:19,isActive:0,isActiveFraction:1,isVisible:2,stores:3,locale:4,markupEditorWillStartInteraction:5})}get name(){return this.$$.ctx[19]}get isActive(){return this.$$.ctx[0]}set isActive(t){this.$$set({isActive:t}),E()}get isActiveFraction(){return this.$$.ctx[1]}set isActiveFraction(t){this.$$set({isActiveFraction:t}),E()}get isVisible(){return this.$$.ctx[2]}set isVisible(t){this.$$set({isVisible:t}),E()}get stores(){return this.$$.ctx[3]}set stores(t){this.$$set({stores:t}),E()}get locale(){return this.$$.ctx[4]}set locale(t){this.$$set({locale:t}),E()}get markupEditorWillStartInteraction(){return this.$$.ctx[5]}set markupEditorWillStartInteraction(t){this.$$set({markupEditorWillStartInteraction:t}),E()}},({src:t})=>t&&!ll(t)]};function Vf(t){let e,i,n=(on(t[32].label)?t[32].label(t[1]):t[32].label)+"";return{c(){e=pt("span"),i=gn(n)},m(r,o){et(r,e,o),kt(e,i)},p(r,o){2&o[0]|2&o[1]&&n!==(n=(on(r[32].label)?r[32].label(r[1]):r[32].label)+"")&&zn(i,n)},d(r){r&&tt(e)}}}function e8(t){let e,i,n,r=(t[11](t[32].value)||"")+"",o=t[32].label&&Vf(t);return{c(){e=pt("div"),i=new Pu(!1),n=he(),o&&o.c(),i.a=n,v(e,"slot","option")},m(a,s){et(a,e,s),i.m(r,e),kt(e,n),o&&o.m(e,null)},p(a,s){2&s[1]&&r!==(r=(a[11](a[32].value)||"")+"")&&i.p(r),a[32].label?o?o.p(a,s):(o=Vf(a),o.c(),o.m(e,null)):o&&(o.d(1),o=null)},d(a){a&&tt(e),o&&o.d()}}}function i8(t){let e,i;return e=new ss({props:{locale:t[1],class:"PinturaControlList",layout:"row",options:t[2],selectedIndex:t[4],onchange:t[10],$$slots:{option:[e8,({option:n})=>({32:n}),({option:n})=>[0,n?2:0]]},$$scope:{ctx:t}}}),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};2&r[0]&&(o.locale=n[1]),4&r[0]&&(o.options=n[2]),16&r[0]&&(o.selectedIndex=n[4]),2&r[0]|6&r[1]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function n8(t){let e,i,n;return i=new Ca({props:{elasticity:t[5],$$slots:{default:[i8]},$$scope:{ctx:t}}}),{c(){e=pt("div"),Et(i.$$.fragment),v(e,"slot","footer"),v(e,"style",t[3])},m(r,o){et(r,e,o),Rt(i,e,null),n=!0},p(r,o){const a={};32&o[0]&&(a.elasticity=r[5]),22&o[0]|4&o[1]&&(a.$$scope={dirty:o,ctx:r}),i.$set(a),(!n||8&o[0])&&v(e,"style",r[3])},i(r){n||(M(i.$$.fragment,r),n=!0)},o(r){z(i.$$.fragment,r),n=!1},d(r){r&&tt(e),It(i)}}}function r8(t){let e,i;return e=new cl({props:{$$slots:{footer:[n8]},$$scope:{ctx:t}}}),e.$on("measure",t[22]),{c(){Et(e.$$.fragment)},m(n,r){Rt(e,n,r),i=!0},p(n,r){const o={};62&r[0]|4&r[1]&&(o.$$scope={dirty:r,ctx:n}),e.$set(o)},i(n){i||(M(e.$$.fragment,n),i=!0)},o(n){z(e.$$.fragment,n),i=!1},d(n){It(e,n)}}}function o8(t,e,i){let n,r,o,a,s,l,c,d,u,p,h=Ke,g=()=>(h(),h=Br(m,S=>i(17,l=S)),m);t.$$.on_destroy.push(()=>h());let{isActive:m}=e;g();let{stores:f}=e,{locale:x={}}=e,{fillOptions:k=[]}=e;const w=S=>S.map(j=>(Q=>Ln(Q)&&We(Q[0])&&Ln(Q[1]))(j)?[j[0],w(j[1]),j[2]]:(Q=>[Array.isArray(Q)&&Q.length===3?[...Q,1]:Q,void 0,{disabled:!1}])(j)),C=dn("elasticityMultiplier");A(t,C,S=>i(21,p=S));const{history:P,animation:R,scrollElasticity:W,imageBackgroundColor:T,imageBackgroundImage:F,allowPan:D,allowZoom:B,allowZoomControls:y,allowPlayPause:_}=f;A(t,R,S=>i(18,c=S)),A(t,T,S=>i(20,u=S)),A(t,F,S=>i(19,d=S));const J=ci(c?20:0);return A(t,J,S=>i(16,s=S)),t.$$set=S=>{"isActive"in S&&g(i(0,m=S.isActive)),"stores"in S&&i(14,f=S.stores),"locale"in S&&i(1,x=S.locale),"fillOptions"in S&&i(15,k=S.fillOptions)},t.$$.update=()=>{32768&t.$$.dirty[0]&&i(2,n=w(k)),131072&t.$$.dirty[0]&&D.set(l),131072&t.$$.dirty[0]&&B.set(l),131072&t.$$.dirty[0]&&y.set(l),131072&t.$$.dirty[0]&&l&&_.set(!0),2097152&t.$$.dirty[0]&&i(5,r=p*W),1572868&t.$$.dirty[0]&&i(4,o=n.findIndex(([S])=>d?S===d:Array.isArray(S)?as(S,u):void 0)||0),393216&t.$$.dirty[0]&&c&&J.set(l?0:20),65536&t.$$.dirty[0]&&i(3,a=s?`transform: translateY(${s}px)`:void 0)},[m,x,n,a,o,r,C,R,T,F,({value:S})=>{We(S)&&(vt(T,u=void 0,u),vt(F,d=S,d)),Ln(S)&&(vt(T,u=S,u),vt(F,d=void 0,d)),P.write()},S=>{if(We(S))return`<div class="PinturaFillTile"><img src="${S}" alt="" width="48" height="64"/></div>`;if(Ln(S)){const[j,Q,ht,at]=S.map((U,yt)=>yt<3?Math.round(255*U):U);return`<div class="PinturaFillTile" data-transparent="${at<1}"><div style="background-color:rgba(${j},${Q},${ht},${at})"></div></div>`}return"<div></div>"},J,"fill",f,k,s,l,c,d,u,p,function(S){Wr.call(this,t,S)}]}var a8={util:["fill",class extends li{constructor(t){super(),si(this,t,o8,r8,ni,{name:13,isActive:0,stores:14,locale:1,fillOptions:15},null,[-1,-1])}get name(){return this.$$.ctx[13]}get isActive(){return this.$$.ctx[0]}set isActive(t){this.$$set({isActive:t}),E()}get stores(){return this.$$.ctx[14]}set stores(t){this.$$set({stores:t}),E()}get locale(){return this.$$.ctx[1]}set locale(t){this.$$set({locale:t}),E()}get fillOptions(){return this.$$.ctx[15]}set fillOptions(t){this.$$set({fillOptions:t}),E()}},({src:t,fillOptions:e})=>t&&!ll(t)&&e&&e.length]};const Nf='<g fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" stroke-width=".125em"><path d="M18 6L6 18M6 6l12 12"></path></path></g>',Hp='<path fill="none" d="M9 15 L12 9 L15 15 M10 13.5 h3" stroke="currentColor" stroke-width=".125em"/>';var s8={labelReset:"Reset",labelDefault:"Default",labelAuto:"Auto",labelNone:"None",labelEdit:"Edit",labelClose:"Close",labelSupportError:t=>t.join(", ")+" not supported on this browser",labelColor:"Color",labelWidth:"Width",labelSize:"Size",labelOffset:"Offset",labelAmount:"Amount",labelInset:"Inset",labelRadius:"Radius",labelColorPalette:"Color palette",labelSizeExtraSmall:"Extra small",labelSizeSmall:"Small",labelSizeMediumSmall:"Medium small",labelSizeMedium:"Medium",labelSizeMediumLarge:"Medium large",labelSizeLarge:"Large",labelSizeExtraLarge:"Extra large",labelButtonCancel:"Cancel",labelButtonUndo:"Undo",labelButtonRedo:"Redo",labelButtonRevert:"Revert",labelButtonExport:"Done",labelZoomIn:"Zoom in",labelZoomOut:"Zoom out",labelZoomFit:"Fit to view",labelZoomActual:"Actual size",iconZoomIn:'<path stroke="currentColor" stroke-width=".125em" d="M8 12 h8 M12 8 v8" />',iconZoomOut:'<path stroke="currentColor" stroke-width=".125em" d="M9 12 h6" />',iconSupportError:'<g fill="none" stroke="currentColor" stroke-width="2"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/><g><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></g>',iconButtonClose:Nf,iconButtonRevert:'<g fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" stroke-width=".125em"><path d="M7.388 18.538a8 8 0 10-2.992-9.03"/><path fill="currentColor" d="M2.794 11.696L2.37 6.714l5.088 3.18z"/><path d="M12 8v4M12 12l4 2"/></g>',iconButtonUndo:'<g fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" stroke-width=".125em"><path d="M10 8h4c2.485 0 5 2 5 5s-2.515 5-5 5h-4"/><path fill="currentColor" d="M5 8l4-3v6z"/></g>',iconButtonRedo:'<g fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" stroke-width=".125em"><path d="M14 8h-4c-2.485 0-5 2-5 5s2.515 5 5 5h4"/><path fill="currentColor" d="M19 8l-4-3v6z"/></g>',iconButtonExport:'<polyline points="20 6 9 17 4 12" fill="none" stroke="currentColor" stroke-width=".125em"></polyline>',statusLabelButtonClose:"Close",statusIconButtonClose:Nf,statusLabelLoadImage:t=>t&&t.task?t.error?t.error.code==="IMAGE_TOO_SMALL"?"Minimum image size is {minWidth} &times; {minHeight}":"Error loading image":t.task==="blob-to-bitmap"?"Preparing image&hellip;":"Loading image&hellip;":"Waiting for image",statusLabelProcessImage:t=>{if(t&&t.task)return t.task==="store"?t.error?"Error uploading image":"Uploading image&hellip;":t.error?"Error processing image":"Processing image&hellip;"}};const l8={shapeLabelButtonSelectSticker:"Select image",shapeIconButtonSelectSticker:'<g fill="none" stroke="currentColor" stroke-width="0.0625em"><path d="M8 21 L15 11 L19 15"/><path d="M15 2 v5 h5"/><path d="M8 2 h8 l4 4 v12 q0 4 -4 4 h-8 q-4 0 -4 -4 v-12 q0 -4 4 -4z"/></g><circle fill="currentColor" cx="10" cy="8" r="1.5"/>',shapeIconButtonFlipHorizontal:'<g stroke="currentColor" stroke-width=".125em"><path fill="none" d="M6 6.5h5v11H6z"/><path fill="currentColor" d="M15 6.5h3v11h-3z"/><path d="M11 4v16" fill="currentColor"/></g>',shapeIconButtonFlipVertical:'<g stroke="currentColor" stroke-width=".125em"><rect x="7" y="8" width="11" height="5" fill="none"/><rect x="7" y="17" width="11" height="2" fill="currentColor"/><line x1="5" y1="13" x2="20" y2="13"/></g>',shapeIconButtonRemove:'<g fill="none" fill-rule="evenodd"><path stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" d="M7.5 7h9z"/><path d="M7.916 9h8.168a1 1 0 01.99 1.14l-.972 6.862a2 2 0 01-1.473 1.653c-.877.23-1.753.345-2.629.345-.876 0-1.752-.115-2.628-.345a2 2 0 01-1.473-1.653l-.973-6.862A1 1 0 017.916 9z" fill="currentColor"/><rect fill="currentColor" x="10" y="5" width="4" height="3" rx="1"/></g>',shapeIconButtonDuplicate:'<g fill="none" fill-rule="evenodd"><path d="M15 13.994V16a2 2 0 01-2 2H8a2 2 0 01-2-2v-5a2 2 0 012-2h2.142" stroke="currentColor" stroke-width=".125em"/><path d="M15 9V8a1 1 0 00-2 0v1h-1a1 1 0 000 2h1v1a1 1 0 002 0v-1h1a1 1 0 000-2h-1zm-4-4h6a2 2 0 012 2v6a2 2 0 01-2 2h-6a2 2 0 01-2-2V7a2 2 0 012-2z" fill="currentColor"/></g>',shapeIconButtonMoveToFront:'<g fill="none" fill-rule="evenodd"><rect fill="currentColor" x="11" y="13" width="8" height="2" rx="1"/><rect fill="currentColor" x="9" y="17" width="10" height="2" rx="1"/><path d="M11.364 8H10a5 5 0 000 10M12 6.5L14.5 8 12 9.5z" stroke="currentColor" stroke-width=".125em" stroke-linecap="round"/></g>',shapeIconButtonTextLayoutAutoWidth:""+Hp,shapeIconButtonTextLayoutAutoHeight:'<g fill="currentColor"><circle cx="4" cy="12" r="1.5"/><circle cx="20" cy="12" r="1.5"/></g>'+Hp,shapeIconButtonTextLayoutFixedSize:'<g fill="currentColor"><circle cx="5" cy="6" r="1.5"/><circle cx="19" cy="6" r="1.5"/><circle cx="19" cy="19" r="1.5"/><circle cx="5" cy="19" r="1.5"/></g>'+Hp,shapeTitleButtonTextLayoutAutoWidth:"Auto width",shapeTitleButtonTextLayoutAutoHeight:"Auto height",shapeTitleButtonTextLayoutFixedSize:"Fixed size",shapeTitleButtonFlipHorizontal:"Flip Horizontal",shapeTitleButtonFlipVertical:"Flip Vertical",shapeTitleButtonRemove:"Remove",shapeTitleButtonDuplicate:"Duplicate",shapeTitleButtonMoveToFront:"Move to front",shapeLabelInputText:"Edit text",shapeIconInputCancel:'<g fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" stroke-width=".125em"><path d="M18 6L6 18M6 6l12 12"/></g>',shapeIconInputConfirm:'<g fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" stroke-width=".125em"><polyline points="20 6 9 17 4 12"/></g>',shapeLabelInputCancel:"Cancel",shapeLabelInputConfirm:"Confirm",shapeLabelStrokeNone:"No outline",shapeLabelFontStyleNormal:"Normal",shapeLabelFontStyleBold:"Bold",shapeLabelFontStyleItalic:"Italic",shapeLabelFontStyleItalicBold:"Bold Italic",shapeTitleBackgroundColor:"Fill color",shapeTitleCornerRadius:"Corner radius",shapeTitleFontFamily:"Font",shapeTitleFontSize:"Font size",shapeTitleFontStyle:"Font style",shapeTitleLineHeight:"Line height",shapeTitleLineStart:"Start",shapeTitleLineEnd:"End",shapeTitleStrokeWidth:"Line width",shapeTitleStrokeColor:"Line color",shapeTitleLineDecorationBar:"Bar",shapeTitleLineDecorationCircle:"Circle",shapeTitleLineDecorationSquare:"Square",shapeTitleLineDecorationArrow:"Arrow",shapeTitleLineDecorationCircleSolid:"Circle solid",shapeTitleLineDecorationSquareSolid:"Square solid",shapeTitleLineDecorationArrowSolid:"Arrow solid",shapeIconLineDecorationBar:'<g stroke="currentColor" stroke-linecap="round" stroke-width=".125em"><path d="M5,12 H16"/><path d="M16,8 V16"/></g>',shapeIconLineDecorationCircle:'<g stroke="currentColor" stroke-linecap="round"><path stroke-width=".125em" d="M5,12 H12"/><circle fill="none" stroke-width=".125em" cx="16" cy="12" r="4"/></g>',shapeIconLineDecorationSquare:'<g stroke="currentColor" stroke-linecap="round"><path stroke-width=".125em" d="M5,12 H12"/><rect fill="none" stroke-width=".125em" x="12" y="8" width="8" height="8"/></g>',shapeIconLineDecorationArrow:'<g stroke="currentColor" stroke-linecap="round" stroke-width=".125em"><path d="M5,12 H16 M13,7 l6,5 l-6,5" fill="none"/></g>',shapeIconLineDecorationCircleSolid:'<g stroke="currentColor" stroke-linecap="round"><path stroke-width=".125em" d="M5,12 H12"/><circle fill="currentColor" cx="16" cy="12" r="4"/></g>',shapeIconLineDecorationSquareSolid:'<g stroke="currentColor" stroke-linecap="round"><path stroke-width=".125em" d="M5,12 H12"/><rect fill="currentColor" x="12" y="8" width="8" height="8"/></g>',shapeIconLineDecorationArrowSolid:'<g stroke="currentColor" stroke-linecap="round" stroke-width=".125em"><path d="M5,12 H16"/><path d="M13,7 l6,5 l-6,5z" fill="currentColor"/></g>',shapeTitleColorTransparent:"Transparent",shapeTitleColorWhite:"White",shapeTitleColorSilver:"Silver",shapeTitleColorGray:"Gray",shapeTitleColorBlack:"Black",shapeTitleColorNavy:"Navy",shapeTitleColorBlue:"Blue",shapeTitleColorAqua:"Aqua",shapeTitleColorTeal:"Teal",shapeTitleColorOlive:"Olive",shapeTitleColorGreen:"Green",shapeTitleColorYellow:"Yellow",shapeTitleColorOrange:"Orange",shapeTitleColorRed:"Red",shapeTitleColorMaroon:"Maroon",shapeTitleColorFuchsia:"Fuchsia",shapeTitleColorPurple:"Purple",shapeTitleTextOutline:"Text outline",shapeTitleTextOutlineWidth:"Width",shapeTitleTextShadow:"Text shadow",shapeTitleTextShadowBlur:"Blur",shapeTitleTextColor:"Font color",shapeTitleTextAlign:"Text align",shapeTitleTextAlignLeft:"Left align text",shapeTitleTextAlignCenter:"Center align text",shapeTitleTextAlignRight:"Right align text",shapeIconTextAlignLeft:'<g stroke-width=".125em" stroke="currentColor"><line x1="5" y1="8" x2="15" y2="8"/><line x1="5" y1="12" x2="19" y2="12"/><line x1="5" y1="16" x2="14" y2="16"/></g>',shapeIconTextAlignCenter:'<g stroke-width=".125em" stroke="currentColor"><line x1="7" y1="8" x2="17" y2="8"/><line x1="5" y1="12" x2="19" y2="12"/><line x1="8" y1="16" x2="16" y2="16"/></g>',shapeIconTextAlignRight:'<g stroke-width=".125em" stroke="currentColor"><line x1="9" y1="8" x2="19" y2="8"/><line x1="5" y1="12" x2="19" y2="12"/><line x1="11" y1="16" x2="19" y2="16"/></g>',shapeLabelToolMove:"Move",shapeLabelToolView:"View",shapeLabelToolSharpie:"Sharpie",shapeLabelToolEraser:"Eraser",shapeLabelToolPath:"Path",shapeLabelToolRectangle:"Rectangle",shapeLabelToolEllipse:"Ellipse",shapeLabelToolArrow:"Arrow",shapeLabelToolLine:"Line",shapeLabelToolText:"Text",shapeLabelToolPreset:"Stickers",shapeIconToolView:'<g stroke-width=".125em" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path d="M10.98 9.703V2.567c0-1.19 1.19-1.785 1.784-1.785.595 0 1.784.595 1.784 1.785v3.568"/><path d="M14.548 9.703V4.35c0-1.19 1.19-1.784 1.784-1.784.595 0 1.784.594 1.784 1.784v2.973"/><path d="M18.116 10.244V7.271c0-1.19 1.19-1.784 1.784-1.784.595 0 1.785.595 1.785 1.784 0 1.19 0 8.92-1.19 12.488-1.19 3.569-10.704 4.758-13.678 0-2.973-4.757-2.973-4.757-4.163-6.541-1.189-1.784-1.153-2.974-.594-3.568.558-.595 1.784-1.19 2.973.594 1.277 1.916 2.07 2.907 2.379 2.974V5.487c0-1.19 1.19-1.784 1.784-1.784.595 0 1.784.595 1.784 1.784V8.46"/></g>',shapeIconToolMove:'<g stroke-width=".125em" stroke="currentColor" fill="none"><path d="M6 2 L6 19 L18 13 Z M13 18 L16 24" stroke="currentColor" stroke-width=".125em" fill="none" fill-rule="evenodd" stroke-linejoin="round"/></g>',shapeIconToolSharpie:'<g stroke-width=".125em" stroke="currentColor" fill="none"><path d="M2.025 5c5.616-2.732 8.833-3.857 9.65-3.374C12.903 2.351.518 12.666 2.026 14 3.534 15.334 16.536.566 17.73 2.566 18.924 4.566 3.98 17.187 4.831 18c.851.813 9.848-6 11.643-6 1.087 0-2.53 5.11-2.92 7-.086.41 3.323-1.498 4.773-1 .494.17.64 2.317 1.319 3 .439.443 1.332.776 2.679 1" stroke="currentColor" stroke-width=".125em" fill="none" fill-rule="evenodd" stroke-linejoin="round"/></g>',shapeIconToolEraser:'<g stroke-width=".125em" stroke="currentColor" stroke-linecap="round" fill="none"><g transform="translate(3, 15) rotate(-45)"><rect x="0" y="0" width="18" height="10" rx="3"/></g><line x1="11" y1="21" x2="18" y2="21"/><line x1="20" y1="21" x2="22" y2="21"/></g>',shapeIconToolPath:'<g stroke-width=".125em" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" fill="none"><circle cx="21" cy="3" r="2"/><circle cx="9" cy="9" r="2"/><circle cx="3" cy="21" r="2"/><path d="M19 4 11 8 M8 11 4 19"/></g>',shapeIconToolRectangle:'<g stroke-width=".125em" stroke="currentColor" fill="none"><rect x="1" y="1" width="22" height="22" rx="4"/></g>',shapeIconToolEllipse:'<g stroke-width=".125em" stroke="currentColor" fill="none"><circle cx="12" cy="12" r="11"/></g>',shapeIconToolArrow:'<g stroke-width=".125em" stroke="currentColor" fill="none"><line x1="20" y1="3" x2="6" y2="21"/><path d="m10 6 L21.5 1 L20 13.5" fill="currentColor" stroke="none"/></g>',shapeIconToolLine:'<g stroke-width=".125em" stroke="currentColor" fill="none"><line x1="20" y1="3" x2="6" y2="21"/></g>',shapeIconToolText:'<g stroke="none" fill="currentColor" transform="translate(6,0)"><path d="M8.14 20.085c.459 0 .901-.034 1.329-.102a8.597 8.597 0 001.015-.21v1.984c-.281.135-.695.247-1.242.336a9.328 9.328 0 01-1.477.133c-3.312 0-4.968-1.745-4.968-5.235V6.804H.344v-1.25l2.453-1.078L3.89.819h1.5v3.97h4.97v2.015H5.39v10.078c0 1.031.245 1.823.735 2.375s1.161.828 2.015.828z"/>',shapeIconToolPreset:'<g fill="none" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" stroke-width=".125em"><path d="M12 22c2.773 0 1.189-5.177 3-7 1.796-1.808 7-.25 7-3 0-5.523-4.477-10-10-10S2 6.477 2 12s4.477 10 10 10z"></path><path d="M20 17c-3 3-5 5-8 5"></path></g>',shapeTitleSelectionMode:"Selection mode",shapeTitleBrushSize:"Brush size",shapeLabelSelectionModeNew:"New",shapeLabelSelectionModeAdd:"Add",shapeLabelSelectionModeSubtract:"Remove",shapeLabelToolSelectionBrush:"Brush",shapeLabelToolSelectionLassoo:"Lassoo",shapeLabelToolSelectionRectangle:"Rectangle marquee",shapeLabelToolSelectionEllipse:"Ellipse marquee",shapeIconSelectionModeNew:'<g fill="none" fill-rule="evenodd" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round"><path d="M6.5 17H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v1.5"/><rect width="12" height="12" x="9" y="9" fill="currentColor" fill-opacity=".25" rx="2"/></g>',shapeIconSelectionModeAdd:'<g fill="none" fill-rule="evenodd" stroke="currentColor"><path fill="currentColor" fill-opacity=".25" stroke-linecap="round" stroke-linejoin="round" d="M15 3a2 2 0 0 1 2 2v4h2a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-8a2 2 0 0 1-2-2v-2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h10Z"/><path d="M13 15h4M15 13v4"/></g>',shapeIconSelectionModeSubtract:'<g fill="none" fill-rule="evenodd" stroke="currentColor"><path fill="currentColor" fill-opacity=".25" stroke-linecap="round" stroke-linejoin="round" d="M15 3a2 2 0 0 1 2 2v4h-6a2 2 0 0 0-1.995 1.85L9 11v6H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h10Z"/><rect width="12" height="12" x="9" y="9" stroke-linecap="round" stroke-linejoin="round" rx="2"/><path d="M13 15h4"/></g>',shapeIconToolSelectionBrush:'<g stroke-width=".125em" stroke="currentColor" fill="none"><path d="M2.025 5c5.616-2.732 8.833-3.857 9.65-3.374C12.903 2.351.518 12.666 2.026 14 3.534 15.334 16.536.566 17.73 2.566 18.924 4.566 3.98 17.187 4.831 18c.851.813 9.848-6 11.643-6 1.087 0-2.53 5.11-2.92 7-.086.41 3.323-1.498 4.773-1 .494.17.64 2.317 1.319 3 .439.443 1.332.776 2.679 1" stroke="currentColor" fill-rule="evenodd" stroke-linejoin="round"/></g>',shapeIconToolSelectionLassoo:'<g fill="none" fill-rule="evenodd" stroke-width=".125em" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M11.428 17.702a18.46 18.46 0 0 0 4.085-1.595c5.851-3.112 9.019-8.599 7.074-12.256-1.945-3.657-8.265-4.1-14.116-.988C2.619 5.974-.55 11.46 1.396 15.118c.63 1.186 1.72 2.033 3.105 2.532"/><ellipse cx="8" cy="18.5" rx="3.5" ry="2.833" transform="rotate(-15 8 18.5)"/><path stroke-linecap="round" d="M5 18c3.347 1.048 5.514 1.881 6.5 2.5.859.54 1.517.994 1.5 2.364"/></g>',shapeIconToolSelectionRectangle:'<g stroke-width=".125em" stroke="currentColor"><path d="M9 1 h6 m4 0 h4v4 m0 4 v6 m0 4 v4h-4 m-4 0 h-6 m-4 0 h-4v-4 m0 -4 v-6 m0 -4 v-4h4" fill="none" /></g>',shapeIconToolSelectionEllipse:'<path stroke-width=".125em" stroke="currentColor" d="M1.21 9.853a11.054 11.054 0 0 0 0 4.294m1.643 3.965a11.054 11.054 0 0 0 3.035 3.035m3.965 1.644a11.054 11.054 0 0 0 4.294 0m3.965-1.644a11.054 11.054 0 0 0 3.035-3.035m1.644-3.965a11.054 11.054 0 0 0 0-4.294m-1.644-3.965a11.054 11.054 0 0 0-3.035-3.035m-3.965-1.644a11.054 11.054 0 0 0-4.294 0M5.888 2.853a11.054 11.054 0 0 0-3.035 3.035"/>'};var c8={cropLabel:"Crop",cropIcon:'<g stroke-width=".125em" stroke="currentColor" fill="none"><path d="M23 17H9a2 2 0 0 1-2-2v-5m0-3V1 M1 7h14a2 2 0 0 1 2 2v7m0 4v3"/></g>',cropIconButtonRecenter:'<path stroke="currentColor" fill="none" stroke-width="2" stroke-linejoin="bevel" d="M1.5 7.5v-6h6M1.5 16.5v6h6M22.5 16.5v6h-6M22.5 7.5v-6h-6"/><circle cx="12" cy="12" r="3.5" fill="currentColor" stroke="none"/>',cropIconButtonRotateLeft:'<g stroke="none" fill="currentColor"><path fill="none" d="M-1-1h582v402H-1z"/><rect x="3" rx="1" height="12" width="12" y="9"/><path d="M15 5h-1a5 5 0 015 5 1 1 0 002 0 7 7 0 00-7-7h-1.374l.747-.747A1 1 0 0011.958.84L9.603 3.194a1 1 0 000 1.415l2.355 2.355a1 1 0 001.415-1.414l-.55-.55H15z"/></g>',cropIconButtonRotateRight:'<g stroke="none" fill="currentColor"><path fill="none" d="M-1-1h582v402H-1z"/><path d="M11.177 5H10a5 5 0 00-5 5 1 1 0 01-2 0 7 7 0 017-7h1.374l-.747-.747A1 1 0 0112.042.84l2.355 2.355a1 1 0 010 1.415l-2.355 2.354a1 1 0 01-1.415-1.414l.55-.55z"/><rect rx="1" height="12" width="12" y="9" x="9"/></g>',cropIconButtonFlipVertical:'<g stroke="none" fill="currentColor"><path d="M19.993 12.143H7a1 1 0 0 1-1-1V5.994a1 1 0 0 1 1.368-.93l12.993 5.15a1 1 0 0 1-.368 1.93z"/><path d="M19.993 14a1 1 0 0 1 .368 1.93L7.368 21.078A1 1 0 0 1 6 20.148V15a1 1 0 0 1 1-1h12.993z" opacity=".6"/></g>',cropIconButtonFlipHorizontal:'<g stroke="none" fill="currentColor"><path d="M11.93 7.007V20a1 1 0 0 1-1 1H5.78a1 1 0 0 1-.93-1.368l5.15-12.993a1 1 0 0 1 1.929.368z"/><path d="M14 7.007V20a1 1 0 0 0 1 1h5.149a1 1 0 0 0 .93-1.368l-5.15-12.993A1 1 0 0 0 14 7.007z" opacity=".6"/></g>',cropIconSelectPreset:(t,e)=>{const[i,n,r]=e?[e<1?1:.3,e===1?.85:.5,e>1?1:.3]:[.2,.3,.4];return`<g fill="currentColor">
            <rect opacity="${i}" x="2" y="4" width="10" height="18" rx="1"/>
            <rect opacity="${n}" x="4" y="8" width="14" height="14" rx="1"/>
            <rect opacity="${r}" x="6" y="12" width="17" height="10" rx="1"/>
        </g>`},cropIconCropBoundary:(t,e)=>{const[i,n,r,o]=e?[.3,1,0,0]:[0,0,.3,1];return`<g fill="currentColor">
            <rect opacity="${i}" x="2" y="3" width="20" height="20" rx="1"/>
            <rect opacity="${n}" x="7" y="8" width="10" height="10" rx="1"/>
            <rect opacity="${r}" x="4" y="8" width="14" height="14" rx="1"/>
            <rect opacity="${o}" x="12" y="4" width="10" height="10" rx="1"/>
        </g>`},cropLabelButtonRecenter:"Recenter",cropLabelButtonRotateLeft:"Rotate left",cropLabelButtonRotateRight:"Rotate right",cropLabelButtonFlipHorizontal:"Flip horizontal",cropLabelButtonFlipVertical:"Flip vertical",cropLabelSelectPreset:"Crop shape",cropLabelCropBoundary:"Crop boundary",cropLabelCropBoundaryEdge:"Edge of image",cropLabelCropBoundaryNone:"None",cropLabelTabRotation:"Rotation",cropLabelTabZoom:"Scale"},d8={fillLabel:"Fill",fillIcon:`
    <g fill="none" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" stroke-width=".125em">
        <g transform="rotate(60, 12, 12)">
            <rect x="4" y="4" width="14" height="16" rx="3"/>
        </g>
        <path d="M21 13 L21 21"></path>
        <path d="M4.5 12.5 L19 12.5"></path>
    </g>
    `},u8={frameLabel:"Frame",frameIcon:`<g fill="none" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" stroke-width=".125em">
            <rect x="2" y="2" width="20" height="20" rx="4"/>
            <rect x="6" y="6" width="12" height="12" rx="1"/>
        </g>`,frameLabelMatSharp:"Mat",frameLabelMatRound:"Bevel",frameLabelLineSingle:"Line",frameLabelLineMultiple:"Zebra",frameLabelEdgeSeparate:"Inset",frameLabelEdgeOverlap:"Plus",frameLabelEdgeCross:"Lumber",frameLabelCornerHooks:"Hook",frameLabelPolaroid:"Polaroid"},p8={redactLabel:"Redact",redactIcon:'<g fill="none" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" stroke-width=".125em"><path d="M 4 5 l 1 -1"/><path d="M 4 10 l 6 -6"/><path d="M 4 15 l 11 -11"/><path d="M 4 20 l 16 -16"/><path d="M 9 20 l 11 -11"/><path d="M 14 20 l 6 -6"/><path d="M 19 20 l 1 -1"/></g>'},mh=(t,e)=>{const i=Object.getOwnPropertyDescriptors(t);Object.keys(i).forEach(n=>{i[n].get?Object.defineProperty(e,n,{get:()=>t[n],set:r=>t[n]=r}):e[n]=t[n]})},Q2=t=>{const e={},{sub:i,pub:n}=rs();Mr()&&document.doctype!==null||console.warn("Browser is in quirks mode, add <!DOCTYPE html> to page to fix render issues");const r=i2();mh(r,e);const o=((c,d)=>{const u={},p=new Vg({target:c,props:{stores:d,pluginComponents:Array.from(dh)}});let h=!1;const g=()=>{h||(Mr()&&window.removeEventListener("pagehide",g),p&&(h=!0,p.$destroy()))};Op||(Op=new Set(Yh(Vg).filter(f=>!x3.includes(f)))),Op.forEach(f=>{Object.defineProperty(u,f,{get:()=>p[f],set:b3.includes(f)?x=>{p[f]={...p[f],...x}}:x=>p[f]=x})}),Object.defineProperty(u,"previewImageData",{get:()=>p.imagePreviewCurrent}),D2.forEach(f=>{const x=su[f],k=x[0];Object.defineProperty(u,f,{get:()=>p.pluginInterface[k][f],set:w=>{const C=x.reduce((P,R)=>(P[R]={...p.pluginOptions[R],[f]:w},P),{});p.pluginOptions={...p.pluginOptions,...C}}})}),Object.defineProperty(u,"element",{get:()=>p.root,set:()=>{}});const m=p.history;return bu(u,{on:(f,x)=>{if(h)return()=>{};if(/undo|redo|revert|writehistory/.test(f))return m.on(f,x);const k=[p.sub(f,x),p.$on(f,w=>x(w instanceof CustomEvent&&!w.detail?void 0:w))].filter(Boolean);return()=>k.forEach(w=>w())},updateImagePreview:f=>{p.imagePreviewSrc=f},close:()=>!h&&p.pub("close"),destroy:g}),Object.defineProperty(u,"history",{get:()=>({undo:()=>m.undo(),redo:()=>m.redo(),revert:()=>m.revert(),get:()=>m.get(),getCollapsed:()=>m.get().splice(0,m.index+1),set:f=>m.set(f),write:f=>m.write(f),get length(){return m.length()},get index(){return m.index},set index(f){m.index=f}})}),Mr()&&window.addEventListener("pagehide",g),u})(t,r.stores);mh(o,e);const a=["loadImage","processImage","abortProcessImage","abortLoadImage"].map(c=>o.on(c,d=>{const u=r[c](d&&d.detail);u instanceof Promise&&u.catch(ge)})),s=(c,d)=>{const u=i(c,d),p=r.on(c,d),h=o.on(c,d);return()=>{u(),p(),h()}};e.handleEvent=ge;const l=B2.map(c=>s(c,d=>e.handleEvent(c,d)));return bu(e,{on:s,updateImage:c=>new Promise((d,u)=>{const p=e.history.get(),h=e.history.index,g=e.imageState;r.loadImage(c).then(m=>{e.history.set(p),e.history.index=h,e.imageState=g,d(m)}).catch(u)}),close:()=>{n("close")},destroy:()=>{[...a,...l].forEach(c=>c()),o.destroy(),r.destroy(),n("destroy")}}),setTimeout(()=>n("init",e),0),e};Mr();var h8=(t,e={})=>{const i=We(t)?document.querySelector(t):t;if(!Bl(i))return;e.class=e.class?"pintura-editor "+e.class:"pintura-editor";const n=Q2(i);return Object.assign(n,e)};const Hf=(t,e,i,n)=>{const r=rt(e.x-t.x,e.y-t.y),o=ro(r),a=5*i;let s;s=n?.5*a:Math.ceil(.5*(a-1));const l=Tr(Oe(o),s);return{anchor:Oe(t),offset:l,normal:o,solid:n,size:a,sizeHalf:s}},m8=(t,e,i)=>{const{strokeWidth:n,strokeColor:r,strokeJoin:o,strokeCap:a,...s}=t,{anchor:l,offset:c,normal:d,solid:u,size:p,sizeHalf:h}=e,g=l.x,m=l.y,f=Tr(Oe(d),p),x=rt(g+f.x,m+f.y);if(Tr(f,.55),u){Dn(i,c);const k=Tr(Oe(d),.5*h);return[{...s,points:[rt(g-k.x,m-k.y),rt(x.x-f.y,x.y+f.x),rt(x.x+f.y,x.y-f.x)],pathClose:!0,backgroundColor:r}]}{const k=Tr((P=>{const R=P.x;return P.x=-P.y,P.y=R,P})(Oe(d)),.5),w=rt(g-k.x,m-k.y),C=rt(g+k.x,m+k.y);return[{...s,points:[rt(x.x+f.y,x.y-f.x),w,rt(g,m),C,rt(x.x-f.y,x.y+f.x)],pathClose:!1,strokeWidth:n,strokeColor:r,strokeJoin:o,strokeCap:a}]}},$8=(t,e,i)=>{const{strokeWidth:n,strokeColor:r,...o}=t,{anchor:a,solid:s,offset:l,normal:c,sizeHalf:d}=e;return Dn(i,l),s&&Dn(i,El(Oe(c))),[{...o,x:a.x,y:a.y,rx:d,ry:d,backgroundColor:s?r:void 0,strokeWidth:s?void 0:n,strokeColor:s?void 0:r}]},g8=(t,e)=>{const{strokeWidth:i,strokeColor:n,strokeJoin:r,strokeCap:o,...a}=t,{anchor:s,offset:l}=e;return[{...a,points:[rt(s.x-l.y,s.y+l.x),rt(s.x+l.y,s.y-l.x)],strokeWidth:i,strokeColor:n,strokeJoin:r,strokeCap:o}]},f8=(t,e,i)=>{const{strokeWidth:n,strokeColor:r,...o}=t,{anchor:a,solid:s,offset:l,normal:c,sizeHalf:d}=e;return Dn(i,l),[{...o,x:a.x-d,y:a.y-d,width:2*d,height:2*d,rotation:(u=c,Math.atan2(u.y,u.x)),backgroundColor:s?r:void 0,strokeWidth:s?void 0:n,strokeColor:s?void 0:r}];var u},y8=(t={})=>e=>{if(!e.lineStart&&!e.lineEnd)return;const i=[],{x1:n,y1:r,x2:o,y2:a,lineStart:s,lineEnd:l,strokeWidth:c,strokeColor:d,strokeJoin:u,strokeCap:p,_isFormatted:h,_prerender:g,_scale:m,_translate:f,isSelected:x,isEditing:k,disableErase:w,id:C,...P}=e,R=rt(n,r),W=rt(o,a),T=[R,W];if(s){const[F,D]=s.split("-"),B=t[F];if(B){const y=Hf(R,W,c,!!D);i.push(...B({...P,strokeColor:d,strokeWidth:c,strokeJoin:u,strokeCap:p},y,R))}}if(l){const[F,D]=l.split("-"),B=t[F];if(B){const y=Hf(W,R,c,!!D);i.push(...B({...P,strokeColor:d,strokeWidth:c,strokeJoin:u,strokeCap:p},y,W))}}return[{...P,points:T,strokeWidth:c,strokeColor:d,strokeJoin:u,strokeCap:p},...i]},x8=()=>({arrow:m8,circle:$8,square:f8,bar:g8}),$h=(t,e)=>{const i=parseFloat(t)*e;return We(t)?i+"%":i},ia=(t,e)=>We(t)?gu(t,e):t,b8=t=>[{...t,frameStyle:"line",frameInset:0,frameOffset:0,frameSize:t.frameSize?$h(t.frameSize,2):"2.5%",frameRadius:t.frameRound?$h(t.frameSize,2):0}],v8=({width:t,height:e,frameImage:i,frameSize:n="15%",frameOutset:r=0,frameSlices:o={x1:.15,y1:.15,x2:.85,y2:.85}},{isPreview:a})=>{if(!i)return[];const s=Math.sqrt(t*e),l=ia(n,s),c=a?l:Math.round(l),d=c,u=ia(r,s),p=2*u,{x1:h,x2:g,y1:m,y2:f}=o,x={x0:0,y0:0,x1:c,y1:d,x2:t-c,y2:e-d,x3:t,y3:e,cw:c,ch:d,ew:t-c-c,eh:e-d-d},k=a?1:0,w=2*k,C=u>0,P={expandsCanvas:C,width:x.cw,height:x.ch,backgroundImage:i};return[{expandsCanvas:C,x:x.x1-k-u,y:x.y0-u,width:x.ew+w+p,height:x.ch,backgroundCorners:[{x:h,y:0},{x:g,y:0},{x:g,y:m},{x:h,y:m}],backgroundImage:i},{expandsCanvas:C,x:x.x1-k-u,y:x.y2+u,width:x.ew+w+p,height:x.ch,backgroundCorners:[{x:h,y:f},{x:g,y:f},{x:g,y:1},{x:h,y:1}],backgroundImage:i},{expandsCanvas:C,x:x.x0-u,y:x.y1-k-u,width:x.cw,height:x.eh+w+p,backgroundCorners:[{x:0,y:m},{x:h,y:m},{x:h,y:f},{x:0,y:f}],backgroundImage:i},{expandsCanvas:C,x:x.x2+u,y:x.y1-k-u,width:x.cw,height:x.eh+w+p,backgroundCorners:[{x:g,y:m},{x:1,y:m},{x:1,y:f},{x:g,y:f}],backgroundImage:i},{...P,x:x.x0-u,y:x.y0-u,backgroundCorners:[{x:0,y:0},{x:h,y:0},{x:h,y:m},{x:0,y:m}]},{...P,x:x.x2+u,y:x.y0-u,backgroundCorners:[{x:g,y:0},{x:1,y:0},{x:1,y:m},{x:g,y:m}]},{...P,x:x.x2+u,y:x.y2+u,backgroundCorners:[{x:g,y:f},{x:1,y:f},{x:1,y:1},{x:g,y:1}]},{...P,x:x.x0-u,y:x.y2+u,backgroundCorners:[{x:0,y:f},{x:h,y:f},{x:h,y:1},{x:0,y:1}]}]},w8=({x:t,y:e,width:i,height:n,frameInset:r="3.5%",frameSize:o=".25%",frameColor:a=[1,1,1],frameOffset:s="5%",frameAmount:l=1,frameRadius:c=0,expandsCanvas:d=!1},{isPreview:u})=>{const p=Math.sqrt(i*n);let h=ia(o,p);const g=ia(r,p),m=ia(s,p);let f=0;u||(h=Math.max(1,Math.round(h)),f=h%2==0?0:.5);const x=ia($h(c,l),p);return new Array(l).fill(void 0).map((k,w)=>{const C=m*w;let P=t+g+C,R=e+g+C,W=t+i-g-C,T=e+n-g-C;return u||(P=Math.round(P),R=Math.round(R),W=Math.round(W),T=Math.round(T)),{x:P+f,y:R+f,width:W-P,height:T-R,cornerRadius:x>0?x-C:0,strokeWidth:h,strokeColor:a,expandsCanvas:d}})},S8=({x:t,y:e,width:i,height:n,frameSize:r=".25%",frameOffset:o=0,frameInset:a="2.5%",frameColor:s=[1,1,1]},{isPreview:l})=>{const c=Math.sqrt(i*n);let d=ia(r,c),u=ia(a,c),p=ia(o,c),h=0;l||(d=Math.max(1,Math.round(d)),u=Math.round(u),p=Math.round(p),h=d%2==0?0:.5);const g=p-u,m=t+u+h,f=e+u+h,x=t+i-u-h,k=e+n-u-h;return[{points:[rt(m+g,f),rt(x-g,f)]},{points:[rt(x,f+g),rt(x,k-g)]},{points:[rt(x-g,k),rt(m+g,k)]},{points:[rt(m,k-g),rt(m,f+g)]}].map(w=>(w.strokeWidth=d,w.strokeColor=s,w))},k8=({x:t,y:e,width:i,height:n,frameSize:r=".25%",frameInset:o="2.5%",frameLength:a="2.5%",frameColor:s=[1,1,1]},{isPreview:l})=>{const c=Math.sqrt(i*n);let d=ia(r,c),u=ia(o,c),p=ia(a,c),h=0;l||(d=Math.max(1,Math.round(d)),u=Math.round(u),p=Math.round(p),h=d%2==0?0:.5);const g=t+u+h,m=e+u+h,f=t+i-u-h,x=e+n-u-h;return[{points:[rt(g,m+p),rt(g,m),rt(g+p,m)]},{points:[rt(f-p,m),rt(f,m),rt(f,m+p)]},{points:[rt(f,x-p),rt(f,x),rt(f-p,x)]},{points:[rt(g+p,x),rt(g,x),rt(g,x-p)]}].map(k=>(k.strokeWidth=d,k.strokeColor=s,k))},C8=({x:t,y:e,width:i,height:n,frameColor:r=[1,1,1]},{isPreview:o})=>{const a=Math.sqrt(i*n),s=.1*a;let l=.2*a,c=0;const d=.5*s;return o?c=1:l=Math.ceil(l),r.length=3,[{id:"border",x:t-d+c,y:e-d+c,width:i+s-2*c,height:n+l-2*c,frameStyle:"line",frameInset:0,frameOffset:0,frameSize:s,frameColor:r,expandsCanvas:!0},{id:"chin",x:t-d,y:n-c,width:i+s,height:l,backgroundColor:r,expandsCanvas:!0}].filter(Boolean)},T8=(t={})=>(e,i)=>{if(!Ae(e,"frameStyle"))return;const n=e.frameStyle,r=t[n];if(!r)return;const{frameStyle:o,...a}=e;return r(a,i)},M8=()=>({solid:b8,hook:k8,line:w8,edge:S8,polaroid:C8,nine:v8}),P8=t=>{const e=(i,n={isPreview:!0})=>{const r=t.map(o=>{const a=o(i,n);if(a)return a.map(s=>e(s,n))}).filter(Boolean).flat();return r.length?r.flat().map((o,a)=>(o.id=i.id+"_"+a,o)):i};return e};typeof window<"u"&&(t=>{if(!t)return;const[e,i,n,r]=[[108,111,99,97,116,105,111,110],[82,101,103,69,120,112],[116,101,115,116],[112,113,105,110,97,92,46,110,108]].map(o=>o.map(a=>String.fromCharCode(a)).join(""));t._qnr6q7e=new t[i](r)[n](t[e])})(window);const R8=m2,jf=$2,I8=()=>({read:qx,apply:Xf}),E8=(t={})=>{const{blurAmount:e,dataSizeScalar:i,scrambleAmount:n,backgroundColor:r}=t;return(o,a)=>(async(s,l={})=>{if(!s)return;const{width:c,height:d}=s,{dataSize:u=96,dataSizeScalar:p=1,scrambleAmount:h=4,blurAmount:g=6,outputFormat:m="canvas",backgroundColor:f=[0,0,0]}=l,x=Math.round(u*p),k=Math.min(x/c,x/d),w=Math.floor(c*k),C=Math.floor(d*k),P=vn("canvas",{width:w,height:C}),R=P.getContext("2d",{willReadFrequently:!0});if(f.length=3,R.fillStyle=gr(f),R.fillRect(0,0,w,C),Fl(s)){const D=vn("canvas",{width:c,height:d});D.getContext("2d",{willReadFrequently:!0}).putImageData(s,0,0),R.drawImage(D,0,0,w,C),qn(D)}else R.drawImage(s,0,0,w,C);const W=R.getImageData(0,0,w,C),T=[];if(h>0&&T.push([Wv,{amount:h}]),g>0)for(let D=0;D<g;D++)T.push([yy,{matrix:_v}]);let F;if(T.length){const D=(_,J)=>`(err, imageData) => {
(${_[J][0].toString()})(Object.assign({ imageData: imageData }, filterInstructions[${J}]), 
${_[J+1]?D(_,J+1):"done"})
}`,B=`function (options, done) {
const filterInstructions = options.filterInstructions;
const imageData = options.imageData;
(${D(T,0)})(null, imageData)
}`,y=await Hc(B,[{imageData:W,filterInstructions:T.map(_=>_[1])}],[W.data.buffer]);F=Ph(y)}else F=W;return m==="canvas"?(R.putImageData(F,0,0),P):F})(o,{blurAmount:e,scrambleAmount:n,backgroundColor:r,...a,dataSizeScalar:i||a.dataSizeScalar})},A8=Z2,L8={markupEditorToolbar:cw(),markupEditorToolStyles:lw(),markupEditorShapeStyleControls:Z2()},z8=fS,F8=SS,D8=IS,B8=P6,O8=E6,W8=z6,_8=_6,V8=t8,N8=K6,H8=a8,j8=X3,U8=W3,G8=rw,Z8=s8,X8=l8,Y8=c8,q8=d8,K8={filterLabel:"Filter",filterIcon:'<g stroke-width=".125em" stroke="currentColor" fill="none"><path d="M18.347 9.907a6.5 6.5 0 1 0-1.872 3.306M3.26 11.574a6.5 6.5 0 1 0 2.815-1.417 M10.15 17.897A6.503 6.503 0 0 0 16.5 23a6.5 6.5 0 1 0-6.183-8.51"/></g>',filterLabelChrome:"Chrome",filterLabelFade:"Fade",filterLabelCold:"Cold",filterLabelWarm:"Warm",filterLabelPastel:"Pastel",filterLabelMonoDefault:"Mono",filterLabelMonoNoir:"Noir",filterLabelMonoWash:"Wash",filterLabelMonoStark:"Stark",filterLabelSepiaDefault:"Sepia",filterLabelSepiaBlues:"Blues",filterLabelSepiaRust:"Rust",filterLabelSepiaColor:"Color"},J8={finetuneLabel:"Finetune",finetuneIcon:'<g stroke-width=".125em" stroke="currentColor" fill="none"><path d="M4 1v5.5m0 3.503V23M12 1v10.5m0 3.5v8M20 1v15.5m0 3.5v3M2 7h4M10 12h4M18 17h4"/></g>',finetuneLabelBrightness:"Brightness",finetuneLabelContrast:"Contrast",finetuneLabelSaturation:"Saturation",finetuneLabelExposure:"Exposure",finetuneLabelTemperature:"Temperature",finetuneLabelGamma:"Gamma",finetuneLabelClarity:"Clarity",finetuneLabelVignette:"Vignette"},Q8={resizeLabel:"Resize",resizeIcon:'<g stroke-width=".125em" stroke="currentColor" fill="none"><rect x="2" y="12" width="10" height="10" rx="2"/><path d="M4 11.5V4a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-5.5"/><path d="M14 10l3.365-3.365M14 6h4v4"/></g>',resizeLabelFormCaption:"Image output size",resizeLabelInputWidth:"w",resizeTitleInputWidth:"Width",resizeLabelInputHeight:"h",resizeTitleInputHeight:"Height",resizeTitleButtonMaintainAspectRatio:"Maintain aspectratio",resizeIconButtonMaintainAspectRatio:(t,e)=>`<defs><mask id="mask1" x="0" y="0" width="24" height="24" ><rect x="0" y="0" width="24" height="10" fill="#fff" stroke="none"/></mask></defs><g fill="none" fill-rule="evenodd"><g  mask="url(#mask1)"><path transform="translate(0 ${3*(e-1)})" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" d="M9.401 10.205v-.804a2.599 2.599 0 0 1 5.198 0V17"/></g><rect fill="currentColor" x="7" y="10" width="10" height="7" rx="1.5"/></g>`},tk={decorateLabel:"Decorate",decorateIcon:'<g fill="none" fill-rule="evenodd"><path stroke="currentColor" stroke-width=".125em" stroke-linecap="round" stroke-linejoin="round" d="M12 18.5l-6.466 3.4 1.235-7.2-5.23-5.1 7.228-1.05L12 2l3.233 6.55 7.229 1.05-5.231 5.1 1.235 7.2z"/></g>'},ek={annotateLabel:"Annotate",annotateIcon:'<g stroke-width=".125em" stroke="currentColor" fill="none"><path d="M17.086 2.914a2.828 2.828 0 1 1 4 4l-14.5 14.5-5.5 1.5 1.5-5.5 14.5-14.5z"/></g>'},ik={stickerLabel:"Sticker",stickerIcon:'<g fill="none" stroke-linecap="round" stroke-linejoin="round" stroke="currentColor" stroke-width=".125em"><path d="M12 22c2.773 0 1.189-5.177 3-7 1.796-1.808 7-.25 7-3 0-5.523-4.477-10-10-10S2 6.477 2 12s4.477 10 10 10z"/><path d="M20 17c-3 3-5 5-8 5"/></g>'},nk=u8,rk=p8,ok=h8,ak=(t=[])=>P8([T8(M8()),y8(x8()),...t]),sk=(t={})=>{let e,i;Array.isArray(t.imageReader)||(i=t.imageReader,delete t.imageReader),Array.isArray(t.imageWriter)?e=jf():(e=on(t.imageWriter)?t.imageWriter:jf(t.imageWriter),delete t.imageWriter);let n;return on(t.imageScrambler)||(n=t.imageScrambler,delete t.imageScrambler),{imageReader:R8(i),imageWriter:e,imageOrienter:I8(),imageScrambler:E8(n)}},lk=(t={})=>{v3(z8,F8,D8,B8,O8,W8,_8,V8,N8,H8);const e=sk(t),i={...Z8,...X8,...Y8,...q8,...K8,...J8,...nk,...rk,...Q8,...tk,...ek,...ik,...t.locale};delete t.locale;const n=typeof t.shapePreprocessor=="function"?t.shapePreprocessor:ak(t.shapePreprocessor);return delete t.shapePreprocessor,t.markupEditorShapeStyleControls&&Object.entries(t.markupEditorShapeStyleControls).every(([r,o])=>/Options$/.test(r)||!Array.isArray(o))&&(t.markupEditorShapeStyleControls=A8({...t.markupEditorShapeStyleControls})),qy([{...e,shapePreprocessor:n,utils:["trim","crop","filter","finetune","retouch","annotate","decorate","sticker","fill","frame","redact","resize"],...j8,...U8,...G8,...L8,stickerStickToImage:!0,locale:i},t])},ck={mounted(){this.editor=ok(this.$refs.elementRef,Object.assign({},this.$attrs)),this.unsubs=O2(this.editor,this.$refs.elementRef)},beforeUpdate(){Object.assign(this.editor,Object.assign({},this.$attrs))},beforeUnmount(){this.editor&&(this.editor.destroy(),this.unsubs.forEach(t=>t()),this.unsubs=[],this.editor=void 0)},render(){return Ox("div",{className:"PinturaRootWrapper",ref:"elementRef"})}},dk=Wx({__name:"MediaImageEditor",props:{media:{}},async setup(t){let e,i;const n=t,r=lk({enableButtonClose:!0});n.media.fetch();const o=([e,i]=_x(()=>Dx(n.media)),e=await e,i(),e);function a(l){n.media.setMediaImage(l.detail.dest),n.media.setEditing(!1),n.media.setUniqueId()}function s(l){l||n.media.setEditing(!1)}return(l,c)=>(Vx(),Nx(Gx,{to:"#drawer-editor"},[cm(Zx,{width:500,"rail-width":500,touchless:"","model-value":!0,"disable-resize-watcher":!0,elevation:0,class:"ig-navigation-drawer-editor","onUpdate:modelValue":s},{default:Hx(()=>[cm(np(ck),jx(np(r),{src:np(o),"onPintura:process":c[0]||(c[0]=d=>a(d)),"onPintura:close":c[1]||(c[1]=d=>l.media.setEditing(!1)),onContextmenu:c[2]||(c[2]=Ux(()=>{},["stop"]))}),null,16,["src"])]),_:1})]))}}),Pk=Bx(dk,[["__scopeId","data-v-96e7af5e"]]);export{Pk as default};

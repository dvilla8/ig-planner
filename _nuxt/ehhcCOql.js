import{_ as pe}from"./XLl4Vj87.js";import{_ as ge}from"./DINaNLfh.js";import{_ as he}from"./CWSDSKrz.js";import{_ as ye}from"./jV5JrApm.js";import{aI as xe,q as Re,aJ as we,aK as _e}from"./DhfqOKzv.js";import{u as o,g as be,a as _,U as Oe,w as L,k as N,r as k,N as Ve,j as h,G as Ee,D as je,i as Z,y as W,n as H,d as Ce,o as Pe,Q as Le,R as Se,l as y,Z as w}from"./CBwktElb.js";import{a as b,V as P}from"./DA19LpLC.js";import{V as Ue}from"./CTIC8zXw.js";const A=e=>{if(e=o(e),Array.isArray(e))return!!e.length;if(e==null)return!1;if(e===!1)return!0;if(e instanceof Date)return!isNaN(e.getTime());if(typeof e=="object"){for(let s in e)return!0;return!1}return!!String(e).length},re=e=>(e=o(e),Array.isArray(e)?e.length:typeof e=="object"?Object.keys(e).length:String(e).length);function C(){for(var e=arguments.length,s=new Array(e),r=0;r<e;r++)s[r]=arguments[r];return t=>(t=o(t),!A(t)||s.every(a=>(a.lastIndex=0,a.test(t))))}C(/^[a-zA-Z]*$/);C(/^[a-zA-Z0-9]*$/);C(/^\d*(\.\d+)?$/);const Ae=/^(?:[A-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[A-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9]{2,}(?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])$/i;C(Ae);function ze(e){return s=>!A(s)||re(s)<=o(e)}function De(e){return{$validator:ze(e),$message:s=>{let{$params:r}=s;return`The maximum length allowed is ${r.max}`},$params:{max:e,type:"maxLength"}}}function Ie(e){return s=>!A(s)||re(s)>=o(e)}function Te(e){return{$validator:Ie(e),$message:s=>{let{$params:r}=s;return`This field should be at least ${r.min} characters long`},$params:{min:e,type:"minLength"}}}function Fe(e){return typeof e=="string"&&(e=e.trim()),A(e)}var Ne={$validator:Fe,$message:"Value is required",$params:{type:"required"}};const qe=/^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z0-9\u00a1-\uffff][a-z0-9\u00a1-\uffff_-]{0,62})?[a-z0-9\u00a1-\uffff]\.)+(?:[a-z\u00a1-\uffff]{2,}\.?))(?::\d{2,5})?(?:[/?#]\S*)?$/i;C(qe);C(/(^[0-9]*$)|(^-[0-9]+$)/);C(/^[-]?\d*(\.\d+)?$/);function J(e,s){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);s&&(t=t.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,t)}return r}function V(e){for(var s=1;s<arguments.length;s++){var r=arguments[s]!=null?arguments[s]:{};s%2?J(Object(r),!0).forEach(function(t){ke(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):J(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function ke(e,s,r){return s in e?Object.defineProperty(e,s,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[s]=r,e}function Q(e){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return Object.keys(e).reduce((r,t)=>(s.includes(t)||(r[t]=o(e[t])),r),{})}function U(e){return typeof e=="function"}function Ge(e){return Ee(e)||je(e)}function ne(e,s,r){let t=e;const a=s.split(".");for(let i=0;i<a.length;i++){if(!t[a[i]])return r;t=t[a[i]]}return t}function F(e,s,r){return h(()=>e.some(t=>ne(s,t,{[r]:!1})[r]))}function X(e,s,r){return h(()=>e.reduce((t,a)=>{const i=ne(s,a,{[r]:!1})[r]||[];return t.concat(i)},[]))}function ae(e,s,r,t){return e.call(t,o(s),o(r),t)}function se(e){return e.$valid!==void 0?!e.$valid:!e}function Be(e,s,r,t,a,i,g){let{$lazy:f,$rewardEarly:c}=a,l=arguments.length>7&&arguments[7]!==void 0?arguments[7]:[],p=arguments.length>8?arguments[8]:void 0,u=arguments.length>9?arguments[9]:void 0,v=arguments.length>10?arguments[10]:void 0;const d=_(!!t.value),n=_(0);r.value=!1;const m=L([s,t].concat(l,v),()=>{if(f&&!t.value||c&&!u.value&&!r.value)return;let $;try{$=ae(e,s,p,g)}catch(x){$=Promise.reject(x)}n.value++,r.value=!!n.value,d.value=!1,Promise.resolve($).then(x=>{n.value--,r.value=!!n.value,i.value=x,d.value=se(x)}).catch(x=>{n.value--,r.value=!!n.value,i.value=x,d.value=!0})},{immediate:!0,deep:typeof s=="object"});return{$invalid:d,$unwatch:m}}function Ke(e,s,r,t,a,i,g,f){let{$lazy:c,$rewardEarly:l}=t;const p=()=>({}),u=h(()=>{if(c&&!r.value||l&&!f.value)return!1;let v=!0;try{const d=ae(e,s,g,i);a.value=d,v=se(d)}catch(d){a.value=d}return v});return{$unwatch:p,$invalid:u}}function Me(e,s,r,t,a,i,g,f,c,l,p){const u=_(!1),v=e.$params||{},d=_(null);let n,m;e.$async?{$invalid:n,$unwatch:m}=Be(e.$validator,s,u,r,t,d,a,e.$watchTargets,c,l,p):{$invalid:n,$unwatch:m}=Ke(e.$validator,s,r,t,d,a,c,l);const $=e.$message;return{$message:U($)?h(()=>$(Q({$pending:u,$invalid:n,$params:Q(v),$model:s,$response:d,$validator:i,$propertyPath:f,$property:g}))):$||"",$params:v,$pending:u,$invalid:n,$response:d,$unwatch:m}}function Ze(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const s=o(e),r=Object.keys(s),t={},a={},i={};let g=null;return r.forEach(f=>{const c=s[f];switch(!0){case U(c.$validator):t[f]=c;break;case U(c):t[f]={$validator:c};break;case f==="$validationGroups":g=c;break;case f.startsWith("$"):i[f]=c;break;default:a[f]=c}}),{rules:t,nestedValidators:a,config:i,validationGroups:g}}const We="__root";function He(e,s,r,t,a,i,g,f,c){const l=Object.keys(e),p=t.get(a,e),u=_(!1),v=_(!1),d=_(0);if(p){if(!p.$partial)return p;p.$unwatch(),u.value=p.$dirty.value}const n={$dirty:u,$path:a,$touch:()=>{u.value||(u.value=!0)},$reset:()=>{u.value&&(u.value=!1)},$commit:()=>{}};return l.length?(l.forEach(m=>{n[m]=Me(e[m],s,n.$dirty,i,g,m,r,a,c,v,d)}),n.$externalResults=h(()=>f.value?[].concat(f.value).map((m,$)=>({$propertyPath:a,$property:r,$validator:"$externalResults",$uid:`${a}-externalResult-${$}`,$message:m,$params:{},$response:null,$pending:!1})):[]),n.$invalid=h(()=>{const m=l.some($=>o(n[$].$invalid));return v.value=m,!!n.$externalResults.value.length||m}),n.$pending=h(()=>l.some(m=>o(n[m].$pending))),n.$error=h(()=>n.$dirty.value?n.$pending.value||n.$invalid.value:!1),n.$silentErrors=h(()=>l.filter(m=>o(n[m].$invalid)).map(m=>{const $=n[m];return k({$propertyPath:a,$property:r,$validator:m,$uid:`${a}-${m}`,$message:$.$message,$params:$.$params,$response:$.$response,$pending:$.$pending})}).concat(n.$externalResults.value)),n.$errors=h(()=>n.$dirty.value?n.$silentErrors.value:[]),n.$unwatch=()=>l.forEach(m=>{n[m].$unwatch()}),n.$commit=()=>{v.value=!0,d.value=Date.now()},t.set(a,e,n),n):(p&&t.set(a,e,n),n)}function Je(e,s,r,t,a,i,g){const f=Object.keys(e);return f.length?f.reduce((c,l)=>(c[l]=q({validations:e[l],state:s,key:l,parentKey:r,resultsCache:t,globalConfig:a,instance:i,externalResults:g}),c),{}):{}}function Qe(e,s,r){const t=h(()=>[s,r].filter(n=>n).reduce((n,m)=>n.concat(Object.values(o(m))),[])),a=h({get(){return e.$dirty.value||(t.value.length?t.value.every(n=>n.$dirty):!1)},set(n){e.$dirty.value=n}}),i=h(()=>{const n=o(e.$silentErrors)||[],m=t.value.filter($=>(o($).$silentErrors||[]).length).reduce(($,x)=>$.concat(...x.$silentErrors),[]);return n.concat(m)}),g=h(()=>{const n=o(e.$errors)||[],m=t.value.filter($=>(o($).$errors||[]).length).reduce(($,x)=>$.concat(...x.$errors),[]);return n.concat(m)}),f=h(()=>t.value.some(n=>n.$invalid)||o(e.$invalid)||!1),c=h(()=>t.value.some(n=>o(n.$pending))||o(e.$pending)||!1),l=h(()=>t.value.some(n=>n.$dirty)||t.value.some(n=>n.$anyDirty)||a.value),p=h(()=>a.value?c.value||f.value:!1),u=()=>{e.$touch(),t.value.forEach(n=>{n.$touch()})},v=()=>{e.$commit(),t.value.forEach(n=>{n.$commit()})},d=()=>{e.$reset(),t.value.forEach(n=>{n.$reset()})};return t.value.length&&t.value.every(n=>n.$dirty)&&u(),{$dirty:a,$errors:g,$invalid:f,$anyDirty:l,$error:p,$pending:c,$touch:u,$reset:d,$silentErrors:i,$commit:v}}function q(e){let{validations:s,state:r,key:t,parentKey:a,childResults:i,resultsCache:g,globalConfig:f={},instance:c,externalResults:l}=e;const p=a?`${a}.${t}`:t,{rules:u,nestedValidators:v,config:d,validationGroups:n}=Ze(s),m=V(V({},f),d),$=t?h(()=>{const R=o(r);return R?o(R[t]):void 0}):r,x=V({},o(l)||{}),G=h(()=>{const R=o(l);return t?R?o(R[t]):void 0:R}),B=He(u,$,t,g,p,m,c,G,r),E=Je(v,$,p,g,m,c,G),K={};n&&Object.entries(n).forEach(R=>{let[j,O]=R;K[j]={$invalid:F(O,E,"$invalid"),$error:F(O,E,"$error"),$pending:F(O,E,"$pending"),$errors:X(O,E,"$errors"),$silentErrors:X(O,E,"$silentErrors")}});const{$dirty:z,$errors:oe,$invalid:D,$anyDirty:ie,$error:ue,$pending:I,$touch:T,$reset:ce,$silentErrors:de,$commit:M}=Qe(B,E,i),fe=t?h({get:()=>o($),set:R=>{z.value=!0;const j=o(r),O=o(l);O&&(O[t]=x[t]),N(j[t])?j[t].value=R:j[t]=R}}):null;t&&m.$autoDirty&&L($,()=>{z.value||T();const R=o(l);R&&(R[t]=x[t])},{flush:"sync"});async function me(){return T(),m.$rewardEarly&&(M(),await H()),await H(),new Promise(R=>{if(!I.value)return R(!D.value);const j=L(I,()=>{R(!D.value),j()})})}function $e(R){return(i.value||{})[R]}function ve(){N(l)?l.value=x:Object.keys(x).length===0?Object.keys(l).forEach(R=>{delete l[R]}):Object.assign(l,x)}return k(V(V(V({},B),{},{$model:fe,$dirty:z,$error:ue,$errors:oe,$invalid:D,$anyDirty:ie,$pending:I,$touch:T,$reset:ce,$path:p||We,$silentErrors:de,$validate:me,$commit:M},i&&{$getResultsForChild:$e,$clearExternalResults:ve,$validationGroups:K}),E))}class Xe{constructor(){this.storage=new Map}set(s,r,t){this.storage.set(s,{rules:r,result:t})}checkRulesValidity(s,r,t){const a=Object.keys(t),i=Object.keys(r);return i.length!==a.length||!i.every(f=>a.includes(f))?!1:i.every(f=>r[f].$params?Object.keys(r[f].$params).every(c=>o(t[f].$params[c])===o(r[f].$params[c])):!0)}get(s,r){const t=this.storage.get(s);if(!t)return;const{rules:a,result:i}=t,g=this.checkRulesValidity(s,r,a),f=i.$unwatch?i.$unwatch:()=>({});return g?i:{$dirty:i.$dirty,$partial:!0,$unwatch:f}}}const S={COLLECT_ALL:!0,COLLECT_NONE:!1},Y=Symbol("vuelidate#injectChildResults"),ee=Symbol("vuelidate#removeChildResults");function Ye(e){let{$scope:s,instance:r}=e;const t={},a=_([]),i=h(()=>a.value.reduce((p,u)=>(p[u]=o(t[u]),p),{}));function g(p,u){let{$registerAs:v,$scope:d,$stopPropagation:n}=u;n||s===S.COLLECT_NONE||d===S.COLLECT_NONE||s!==S.COLLECT_ALL&&s!==d||(t[v]=p,a.value.push(v))}r.__vuelidateInjectInstances=[].concat(r.__vuelidateInjectInstances||[],g);function f(p){a.value=a.value.filter(u=>u!==p),delete t[p]}r.__vuelidateRemoveInstances=[].concat(r.__vuelidateRemoveInstances||[],f);const c=Z(Y,[]);W(Y,r.__vuelidateInjectInstances);const l=Z(ee,[]);return W(ee,r.__vuelidateRemoveInstances),{childResults:i,sendValidationResultsToParent:c,removeValidationResultsFromParent:l}}function le(e){return new Proxy(e,{get(s,r){return typeof s[r]=="object"?le(s[r]):h(()=>s[r])}})}let te=0;function et(e,s){var r;let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};arguments.length===1&&(t=e,e=void 0,s=void 0);let{$registerAs:a,$scope:i=S.COLLECT_ALL,$stopPropagation:g,$externalResults:f,currentVueInstance:c}=t;const l=c||((r=be())===null||r===void 0?void 0:r.proxy),p=l?l.$options:{};a||(te+=1,a=`_vuelidate_${te}`);const u=_({}),v=new Xe,{childResults:d,sendValidationResultsToParent:n,removeValidationResultsFromParent:m}=l?Ye({$scope:i,instance:l}):{childResults:_({})};if(!e&&p.validations){const $=p.validations;s=_({}),Oe(()=>{s.value=l,L(()=>U($)?$.call(s.value,new le(s.value)):$,x=>{u.value=q({validations:x,state:s,childResults:d,resultsCache:v,globalConfig:t,instance:l,externalResults:f||l.vuelidateExternalResults})},{immediate:!0})}),t=p.validationsConfig||t}else{const $=N(e)||Ge(e)?e:k(e||{});L($,x=>{u.value=q({validations:x,state:s,childResults:d,resultsCache:v,globalConfig:t,instance:l??{},externalResults:f})},{immediate:!0})}return l&&(n.forEach($=>$(u,{$registerAs:a,$scope:i,$stopPropagation:g})),Ve(()=>m.forEach($=>$(a)))),h(()=>V(V({},o(u.value)),d.value))}const tt=xe("user/editor",()=>{const e=Re(),s=_(""),r={},t={},a={};let i=_();const g=h(()=>_e(s.value).user);function f(u,v){s.value=u;for(const[d,n]of Object.entries(g.value.profile.fields)){let m=v&&v.profile.hasOwnProperty(d)?v.profile[d]:"";n.type==="file"&&(m=void 0),r[d]=_(m),t[d]=n,a[d]={},n.validation&&(n.validation.required&&(a[d].required=Ne),n.validation.minLength&&(a[d].minLength=Te(n.validation.minLength)),n.validation.maxLength&&(a[d].maxLength=De(n.validation.maxLength)))}i.value=et(a,r,{$lazy:!0})}function c(){for(const[u,v]of Object.entries(g.value.profile.fields))r[u].value=""}async function l(){const u={profile:{},media:{}};for(const[v,d]of Object.entries(g.value.profile.fields))u.profile[v]=r[v].value;for(const[v,d]of Object.entries(g.value.collections))u.media[v]=[];return u.profile.username=we(u.profile.username,"_"),u.platform=s.value,await e.createUser(u,s.value),setTimeout(()=>c(),1e3),!0}async function p(u){const v={};for(const[d,n]of Object.entries(g.value.profile.fields))v[d]=r[d].value;await e.updateUser(u,v)}return{$v:i,fields:r,fieldsData:t,rules:a,create:l,update:p,generateFields:f}}),ct=Ce({__name:"InstagramUserEditorForm",props:{user:{}},emits:["close"],setup(e,{emit:s}){const r=e,t=s,a=tt();a.generateFields("instagram",r.user);const i=a.$v;function g(c){a.fields.avatar=c}async function f(c){c.preventDefault(),await i.value.$validate()&&(r.user?await a.update(r.user):await a.create(),t("close"))}return Pe(()=>{var c;(c=document.querySelector('.ig-user-editor-form [name="username"]'))==null||c.focus()}),(c,l)=>{const p=pe,u=ge,v=he,d=ye;return Le(),Se("form",{class:"ig-user-editor-form pa-12",onSubmit:f},[y(P,null,{default:w(()=>[y(b,{cols:12,md:4,class:"text-center pb-14"},{default:w(()=>[y(p,{user:c.user,onUpdate:g},null,8,["user"])]),_:1}),y(b,{cols:12,md:8},{default:w(()=>[y(P,null,{default:w(()=>[y(b,null,{default:w(()=>[y(u,{modelValue:o(a).fields.username,"onUpdate:modelValue":l[0]||(l[0]=n=>o(a).fields.username=n),data:o(a).fieldsData.username,error:o(i).username.$invalid,variant:"outlined"},null,8,["modelValue","data","error"])]),_:1})]),_:1}),y(P,null,{default:w(()=>[y(b,{cols:6},{default:w(()=>[y(u,{modelValue:o(a).fields.name,"onUpdate:modelValue":l[1]||(l[1]=n=>o(a).fields.name=n),data:o(a).fieldsData.name,error:o(i).name.$invalid,variant:"outlined"},null,8,["modelValue","data","error"])]),_:1}),y(b,{cols:3},{default:w(()=>[y(u,{modelValue:o(a).fields.followers_count,"onUpdate:modelValue":l[2]||(l[2]=n=>o(a).fields.followers_count=n),data:o(a).fieldsData.followers_count,error:o(i).followers_count.$invalid,variant:"outlined"},null,8,["modelValue","data","error"])]),_:1}),y(b,{cols:3},{default:w(()=>[y(u,{modelValue:o(a).fields.follows_count,"onUpdate:modelValue":l[3]||(l[3]=n=>o(a).fields.follows_count=n),data:o(a).fieldsData.follows_count,error:o(i).follows_count.$invalid,variant:"outlined"},null,8,["modelValue","data","error"])]),_:1})]),_:1}),y(P,null,{default:w(()=>[y(b,null,{default:w(()=>[y(v,{modelValue:o(a).fields.website,"onUpdate:modelValue":l[4]||(l[4]=n=>o(a).fields.website=n),data:o(a).fieldsData.website,error:o(i).website.$invalid,variant:"outlined"},null,8,["modelValue","data","error"])]),_:1})]),_:1}),y(P,null,{default:w(()=>[y(b,null,{default:w(()=>[y(d,{modelValue:o(a).fields.biography,"onUpdate:modelValue":l[5]||(l[5]=n=>o(a).fields.biography=n),data:o(a).fieldsData.biography,error:o(i).biography.$invalid,variant:"outlined"},null,8,["modelValue","data","error"])]),_:1})]),_:1}),y(P,null,{default:w(()=>[y(b,null,{default:w(()=>[y(Ue,{type:"submit",text:r.user?c.$t("common.actions.submit"):c.$t("common.actions.create"),color:"primary"},null,8,["text"])]),_:1})]),_:1})]),_:1})]),_:1})],32)}}});export{ct as _};

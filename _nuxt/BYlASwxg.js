import{_ as he}from"./q5Rkh7uf.js";import{_ as ye}from"./DTQbgBkp.js";import{_ as be}from"./C7w3jlUv.js";import{_ as xe}from"./BjmQGqfJ.js";import{g as o,Q as we,r as R,bp as Re,N as L,a5 as N,ag as B,s as _e,B as h,bI as Oe,bJ as Ee,af as W,ae as Z,as as H,bK as Ve,R as je,bL as Ce,bM as Pe,e as Le,n as Se,o as J,c as Ue,b as y,w,f as Ae,i as ze}from"./CZ8OrWeD.js";import{V as _,a as P}from"./GRyJPE_P.js";import{V as Q}from"./CivrCcyj.js";const A=e=>{if(e=o(e),Array.isArray(e))return!!e.length;if(e==null)return!1;if(e===!1)return!0;if(e instanceof Date)return!isNaN(e.getTime());if(typeof e=="object"){for(let s in e)return!0;return!1}return!!String(e).length},ae=e=>(e=o(e),Array.isArray(e)?e.length:typeof e=="object"?Object.keys(e).length:String(e).length);function C(){for(var e=arguments.length,s=new Array(e),r=0;r<e;r++)s[r]=arguments[r];return t=>(t=o(t),!A(t)||s.every(a=>(a.lastIndex=0,a.test(t))))}C(/^[a-zA-Z]*$/);C(/^[a-zA-Z0-9]*$/);C(/^\d*(\.\d+)?$/);const Te=/^(?:[A-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[A-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9]{2,}(?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])$/i;C(Te);function De(e){return s=>!A(s)||ae(s)<=o(e)}function Ie(e){return{$validator:De(e),$message:s=>{let{$params:r}=s;return`The maximum length allowed is ${r.max}`},$params:{max:e,type:"maxLength"}}}function Fe(e){return s=>!A(s)||ae(s)>=o(e)}function Ne(e){return{$validator:Fe(e),$message:s=>{let{$params:r}=s;return`This field should be at least ${r.min} characters long`},$params:{min:e,type:"minLength"}}}function ke(e){return typeof e=="string"&&(e=e.trim()),A(e)}var Be={$validator:ke,$message:"Value is required",$params:{type:"required"}};const qe=/^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z0-9\u00a1-\uffff][a-z0-9\u00a1-\uffff_-]{0,62})?[a-z0-9\u00a1-\uffff]\.)+(?:[a-z\u00a1-\uffff]{2,}\.?))(?::\d{2,5})?(?:[/?#]\S*)?$/i;C(qe);C(/(^[0-9]*$)|(^-[0-9]+$)/);C(/^[-]?\d*(\.\d+)?$/);function X(e,s){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);s&&(t=t.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,t)}return r}function E(e){for(var s=1;s<arguments.length;s++){var r=arguments[s]!=null?arguments[s]:{};s%2?X(Object(r),!0).forEach(function(t){Ge(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):X(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Ge(e,s,r){return s in e?Object.defineProperty(e,s,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[s]=r,e}function Y(e){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return Object.keys(e).reduce((r,t)=>(s.includes(t)||(r[t]=o(e[t])),r),{})}function U(e){return typeof e=="function"}function Ke(e){return Oe(e)||Ee(e)}function se(e,s,r){let t=e;const a=s.split(".");for(let i=0;i<a.length;i++){if(!t[a[i]])return r;t=t[a[i]]}return t}function F(e,s,r){return h(()=>e.some(t=>se(s,t,{[r]:!1})[r]))}function ee(e,s,r){return h(()=>e.reduce((t,a)=>{const i=se(s,a,{[r]:!1})[r]||[];return t.concat(i)},[]))}function le(e,s,r,t){return e.call(t,o(s),o(r),t)}function oe(e){return e.$valid!==void 0?!e.$valid:!e}function Me(e,s,r,t,a,i,g){let{$lazy:f,$rewardEarly:u}=a,l=arguments.length>7&&arguments[7]!==void 0?arguments[7]:[],p=arguments.length>8?arguments[8]:void 0,c=arguments.length>9?arguments[9]:void 0,v=arguments.length>10?arguments[10]:void 0;const d=R(!!t.value),n=R(0);r.value=!1;const m=L([s,t].concat(l,v),()=>{if(f&&!t.value||u&&!c.value&&!r.value)return;let $;try{$=le(e,s,p,g)}catch(b){$=Promise.reject(b)}n.value++,r.value=!!n.value,d.value=!1,Promise.resolve($).then(b=>{n.value--,r.value=!!n.value,i.value=b,d.value=oe(b)}).catch(b=>{n.value--,r.value=!!n.value,i.value=b,d.value=!0})},{immediate:!0,deep:typeof s=="object"});return{$invalid:d,$unwatch:m}}function We(e,s,r,t,a,i,g,f){let{$lazy:u,$rewardEarly:l}=t;const p=()=>({}),c=h(()=>{if(u&&!r.value||l&&!f.value)return!1;let v=!0;try{const d=le(e,s,g,i);a.value=d,v=oe(d)}catch(d){a.value=d}return v});return{$unwatch:p,$invalid:c}}function Ze(e,s,r,t,a,i,g,f,u,l,p){const c=R(!1),v=e.$params||{},d=R(null);let n,m;e.$async?{$invalid:n,$unwatch:m}=Me(e.$validator,s,c,r,t,d,a,e.$watchTargets,u,l,p):{$invalid:n,$unwatch:m}=We(e.$validator,s,r,t,d,a,u,l);const $=e.$message;return{$message:U($)?h(()=>$(Y({$pending:c,$invalid:n,$params:Y(v),$model:s,$response:d,$validator:i,$propertyPath:f,$property:g}))):$||"",$params:v,$pending:c,$invalid:n,$response:d,$unwatch:m}}function He(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const s=o(e),r=Object.keys(s),t={},a={},i={};let g=null;return r.forEach(f=>{const u=s[f];switch(!0){case U(u.$validator):t[f]=u;break;case U(u):t[f]={$validator:u};break;case f==="$validationGroups":g=u;break;case f.startsWith("$"):i[f]=u;break;default:a[f]=u}}),{rules:t,nestedValidators:a,config:i,validationGroups:g}}const Je="__root";function Qe(e,s,r,t,a,i,g,f,u){const l=Object.keys(e),p=t.get(a,e),c=R(!1),v=R(!1),d=R(0);if(p){if(!p.$partial)return p;p.$unwatch(),c.value=p.$dirty.value}const n={$dirty:c,$path:a,$touch:()=>{c.value||(c.value=!0)},$reset:()=>{c.value&&(c.value=!1)},$commit:()=>{}};return l.length?(l.forEach(m=>{n[m]=Ze(e[m],s,n.$dirty,i,g,m,r,a,u,v,d)}),n.$externalResults=h(()=>f.value?[].concat(f.value).map((m,$)=>({$propertyPath:a,$property:r,$validator:"$externalResults",$uid:`${a}-externalResult-${$}`,$message:m,$params:{},$response:null,$pending:!1})):[]),n.$invalid=h(()=>{const m=l.some($=>o(n[$].$invalid));return v.value=m,!!n.$externalResults.value.length||m}),n.$pending=h(()=>l.some(m=>o(n[m].$pending))),n.$error=h(()=>n.$dirty.value?n.$pending.value||n.$invalid.value:!1),n.$silentErrors=h(()=>l.filter(m=>o(n[m].$invalid)).map(m=>{const $=n[m];return B({$propertyPath:a,$property:r,$validator:m,$uid:`${a}-${m}`,$message:$.$message,$params:$.$params,$response:$.$response,$pending:$.$pending})}).concat(n.$externalResults.value)),n.$errors=h(()=>n.$dirty.value?n.$silentErrors.value:[]),n.$unwatch=()=>l.forEach(m=>{n[m].$unwatch()}),n.$commit=()=>{v.value=!0,d.value=Date.now()},t.set(a,e,n),n):(p&&t.set(a,e,n),n)}function Xe(e,s,r,t,a,i,g){const f=Object.keys(e);return f.length?f.reduce((u,l)=>(u[l]=k({validations:e[l],state:s,key:l,parentKey:r,resultsCache:t,globalConfig:a,instance:i,externalResults:g}),u),{}):{}}function Ye(e,s,r){const t=h(()=>[s,r].filter(n=>n).reduce((n,m)=>n.concat(Object.values(o(m))),[])),a=h({get(){return e.$dirty.value||(t.value.length?t.value.every(n=>n.$dirty):!1)},set(n){e.$dirty.value=n}}),i=h(()=>{const n=o(e.$silentErrors)||[],m=t.value.filter($=>(o($).$silentErrors||[]).length).reduce(($,b)=>$.concat(...b.$silentErrors),[]);return n.concat(m)}),g=h(()=>{const n=o(e.$errors)||[],m=t.value.filter($=>(o($).$errors||[]).length).reduce(($,b)=>$.concat(...b.$errors),[]);return n.concat(m)}),f=h(()=>t.value.some(n=>n.$invalid)||o(e.$invalid)||!1),u=h(()=>t.value.some(n=>o(n.$pending))||o(e.$pending)||!1),l=h(()=>t.value.some(n=>n.$dirty)||t.value.some(n=>n.$anyDirty)||a.value),p=h(()=>a.value?u.value||f.value:!1),c=()=>{e.$touch(),t.value.forEach(n=>{n.$touch()})},v=()=>{e.$commit(),t.value.forEach(n=>{n.$commit()})},d=()=>{e.$reset(),t.value.forEach(n=>{n.$reset()})};return t.value.length&&t.value.every(n=>n.$dirty)&&c(),{$dirty:a,$errors:g,$invalid:f,$anyDirty:l,$error:p,$pending:u,$touch:c,$reset:d,$silentErrors:i,$commit:v}}function k(e){let{validations:s,state:r,key:t,parentKey:a,childResults:i,resultsCache:g,globalConfig:f={},instance:u,externalResults:l}=e;const p=a?`${a}.${t}`:t,{rules:c,nestedValidators:v,config:d,validationGroups:n}=He(s),m=E(E({},f),d),$=t?h(()=>{const x=o(r);return x?o(x[t]):void 0}):r,b=E({},o(l)||{}),q=h(()=>{const x=o(l);return t?x?o(x[t]):void 0:x}),G=Qe(c,$,t,g,p,m,u,q,r),V=Xe(v,$,p,g,m,u,q),K={};n&&Object.entries(n).forEach(x=>{let[j,O]=x;K[j]={$invalid:F(O,V,"$invalid"),$error:F(O,V,"$error"),$pending:F(O,V,"$pending"),$errors:ee(O,V,"$errors"),$silentErrors:ee(O,V,"$silentErrors")}});const{$dirty:z,$errors:ue,$invalid:T,$anyDirty:ce,$error:de,$pending:D,$touch:I,$reset:fe,$silentErrors:me,$commit:M}=Ye(G,V,i),$e=t?h({get:()=>o($),set:x=>{z.value=!0;const j=o(r),O=o(l);O&&(O[t]=b[t]),N(j[t])?j[t].value=x:j[t]=x}}):null;t&&m.$autoDirty&&L($,()=>{z.value||I();const x=o(l);x&&(x[t]=b[t])},{flush:"sync"});async function ve(){return I(),m.$rewardEarly&&(M(),await H()),await H(),new Promise(x=>{if(!D.value)return x(!T.value);const j=L(D,()=>{x(!T.value),j()})})}function pe(x){return(i.value||{})[x]}function ge(){N(l)?l.value=b:Object.keys(b).length===0?Object.keys(l).forEach(x=>{delete l[x]}):Object.assign(l,b)}return B(E(E(E({},G),{},{$model:$e,$dirty:z,$error:de,$errors:ue,$invalid:T,$anyDirty:ce,$pending:D,$touch:I,$reset:fe,$path:p||Je,$silentErrors:me,$validate:ve,$commit:M},i&&{$getResultsForChild:pe,$clearExternalResults:ge,$validationGroups:K}),V))}class et{constructor(){this.storage=new Map}set(s,r,t){this.storage.set(s,{rules:r,result:t})}checkRulesValidity(s,r,t){const a=Object.keys(t),i=Object.keys(r);return i.length!==a.length||!i.every(f=>a.includes(f))?!1:i.every(f=>r[f].$params?Object.keys(r[f].$params).every(u=>o(t[f].$params[u])===o(r[f].$params[u])):!0)}get(s,r){const t=this.storage.get(s);if(!t)return;const{rules:a,result:i}=t,g=this.checkRulesValidity(s,r,a),f=i.$unwatch?i.$unwatch:()=>({});return g?i:{$dirty:i.$dirty,$partial:!0,$unwatch:f}}}const S={COLLECT_ALL:!0,COLLECT_NONE:!1},te=Symbol("vuelidate#injectChildResults"),re=Symbol("vuelidate#removeChildResults");function tt(e){let{$scope:s,instance:r}=e;const t={},a=R([]),i=h(()=>a.value.reduce((p,c)=>(p[c]=o(t[c]),p),{}));function g(p,c){let{$registerAs:v,$scope:d,$stopPropagation:n}=c;n||s===S.COLLECT_NONE||d===S.COLLECT_NONE||s!==S.COLLECT_ALL&&s!==d||(t[v]=p,a.value.push(v))}r.__vuelidateInjectInstances=[].concat(r.__vuelidateInjectInstances||[],g);function f(p){a.value=a.value.filter(c=>c!==p),delete t[p]}r.__vuelidateRemoveInstances=[].concat(r.__vuelidateRemoveInstances||[],f);const u=W(te,[]);Z(te,r.__vuelidateInjectInstances);const l=W(re,[]);return Z(re,r.__vuelidateRemoveInstances),{childResults:i,sendValidationResultsToParent:u,removeValidationResultsFromParent:l}}function ie(e){return new Proxy(e,{get(s,r){return typeof s[r]=="object"?ie(s[r]):h(()=>s[r])}})}let ne=0;function rt(e,s){var r;let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};arguments.length===1&&(t=e,e=void 0,s=void 0);let{$registerAs:a,$scope:i=S.COLLECT_ALL,$stopPropagation:g,$externalResults:f,currentVueInstance:u}=t;const l=u||((r=we())===null||r===void 0?void 0:r.proxy),p=l?l.$options:{};a||(ne+=1,a=`_vuelidate_${ne}`);const c=R({}),v=new et,{childResults:d,sendValidationResultsToParent:n,removeValidationResultsFromParent:m}=l?tt({$scope:i,instance:l}):{childResults:R({})};if(!e&&p.validations){const $=p.validations;s=R({}),Re(()=>{s.value=l,L(()=>U($)?$.call(s.value,new ie(s.value)):$,b=>{c.value=k({validations:b,state:s,childResults:d,resultsCache:v,globalConfig:t,instance:l,externalResults:f||l.vuelidateExternalResults})},{immediate:!0})}),t=p.validationsConfig||t}else{const $=N(e)||Ke(e)?e:B(e||{});L($,b=>{c.value=k({validations:b,state:s,childResults:d,resultsCache:v,globalConfig:t,instance:l??{},externalResults:f})},{immediate:!0})}return l&&(n.forEach($=>$(c,{$registerAs:a,$scope:i,$stopPropagation:g})),_e(()=>m.forEach($=>$(a)))),h(()=>E(E({},o(c.value)),d.value))}const nt=Ve("user/editor",()=>{const e=je(),s=R(""),r={},t={},a={};let i=R();const g=h(()=>Ce(s.value).user);function f(c,v){s.value=c;for(const[d,n]of Object.entries(g.value.profile.fields)){let m=v&&v.profile.hasOwnProperty(d)?v.profile[d]:"";switch(n.type==="file"&&(m=void 0),d){case"website":r[d]=R(m==null?void 0:m.href);break;default:r[d]=R(m);break}t[d]=n,a[d]={},n.validation&&(n.validation.required&&(a[d].required=Be),n.validation.minLength&&(a[d].minLength=Ne(n.validation.minLength)),n.validation.maxLength&&(a[d].maxLength=Ie(n.validation.maxLength)))}i.value=rt(a,r,{$lazy:!0})}function u(){for(const[c,v]of Object.entries(g.value.profile.fields))r[c].value=""}async function l(){const c={profile:{},media:{}};for(const[v,d]of Object.entries(g.value.profile.fields))c.profile[v]=r[v].value;for(const[v,d]of Object.entries(g.value.media.collections))c.media[v]=[];return c.profile.username=Pe(c.profile.username,"_"),c.platform=s.value,await e.createUser(c,s.value),setTimeout(()=>u(),1e3),!0}async function p(c){const v={};for(const[d,n]of Object.entries(g.value.profile.fields))v[d]=r[d].value;await e.updateUser(c,v)}return{$v:i,fields:r,fieldsData:t,rules:a,create:l,update:p,generateFields:f}}),dt=Le({__name:"InstagramUserEditorForm",props:{user:{},autosave:{type:Boolean}},emits:["close"],setup(e,{emit:s}){const r=e,t=s,a=nt();a.generateFields("instagram",r.user);const i=a.$v;function g(u){a.fields.avatar=u}async function f(u){u&&u.preventDefault(),await i.value.$validate()&&(r.user?await a.update(r.user):await a.create(),r.autosave||t("close"))}return Se(()=>{var u;(u=document.querySelector('.dx-user-editor-form [name="username"]'))==null||u.focus()}),L(()=>a.fields,u=>{r.autosave&&f()},{deep:!0}),(u,l)=>{const p=he,c=ye,v=be,d=xe;return J(),Ue("form",{class:"dx-user-editor-form py-7 py-md-12 px-md-12",onSubmit:f},[y(P,null,{default:w(()=>[y(_,{cols:12,md:4,class:"text-center pt-0 pb-6 pb-sm-12"},{default:w(()=>[y(p,{user:u.user,onUpdate:g},null,8,["user"])]),_:1}),y(_,{cols:12,md:8},{default:w(()=>[y(P,null,{default:w(()=>[y(_,null,{default:w(()=>[y(c,{modelValue:o(a).fields.username,"onUpdate:modelValue":l[0]||(l[0]=n=>o(a).fields.username=n),data:o(a).fieldsData.username,error:o(i).username.$invalid,variant:"outlined",class:"mb-3"},null,8,["modelValue","data","error"])]),_:1})]),_:1}),y(P,null,{default:w(()=>[y(_,{sm:6},{default:w(()=>[y(c,{modelValue:o(a).fields.name,"onUpdate:modelValue":l[1]||(l[1]=n=>o(a).fields.name=n),data:o(a).fieldsData.name,error:o(i).name.$invalid,variant:"outlined",class:"mb-3"},null,8,["modelValue","data","error"])]),_:1}),y(_,{cols:3,class:"hidden-xs"},{default:w(()=>[y(c,{modelValue:o(a).fields.followers_count,"onUpdate:modelValue":l[2]||(l[2]=n=>o(a).fields.followers_count=n),data:o(a).fieldsData.followers_count,error:o(i).followers_count.$invalid,variant:"outlined",class:"mb-3"},null,8,["modelValue","data","error"])]),_:1}),y(_,{cols:3,class:"hidden-xs"},{default:w(()=>[y(c,{modelValue:o(a).fields.follows_count,"onUpdate:modelValue":l[3]||(l[3]=n=>o(a).fields.follows_count=n),data:o(a).fieldsData.follows_count,error:o(i).follows_count.$invalid,variant:"outlined",class:"mb-3"},null,8,["modelValue","data","error"])]),_:1})]),_:1}),y(P,null,{default:w(()=>[y(_,null,{default:w(()=>[y(v,{modelValue:o(a).fields.website,"onUpdate:modelValue":l[4]||(l[4]=n=>o(a).fields.website=n),data:o(a).fieldsData.website,error:o(i).website.$invalid,variant:"outlined",class:"mb-3"},null,8,["modelValue","data","error"])]),_:1})]),_:1}),y(P,null,{default:w(()=>[y(_,null,{default:w(()=>[y(d,{modelValue:o(a).fields.biography,"onUpdate:modelValue":l[5]||(l[5]=n=>o(a).fields.biography=n),data:o(a).fieldsData.biography,error:o(i).biography.$invalid,variant:"outlined"},null,8,["modelValue","data","error"])]),_:1})]),_:1}),u.autosave?ze("",!0):(J(),Ae(P,{key:0,class:"mt-2"},{default:w(()=>[y(_,null,{default:w(()=>[y(Q,{type:"submit",text:r.user?u.$t("common.actions.submit"):u.$t("common.actions.create"),color:"primary"},null,8,["text"]),y(Q,{class:"ml-3",text:u.$t("common.actions.close"),onClick:l[6]||(l[6]=n=>t("close"))},null,8,["text"])]),_:1})]),_:1}))]),_:1})]),_:1})],32)}}});export{dt as _};
